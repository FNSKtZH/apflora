(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"./src/apflora.js":[function(require,module,exports){
// benötigte globale Variablen initialisieren
window.apf = window.apf || {};
window.apf.gmap = window.apf.gmap || {};
window.apf.olmap = window.apf.olmap || {};

window.apf.initiiere_index = function() {
	'use strict';
	// Versuch, damit $.ajax auch in IE funktioniert
	// jQuery hängt an jede Anfrage ein &_= und Zufahlszahl
	// AUSGESCHALTET, WEIL TPOPFELDKONTR_UPDATE_MULTIPLE.PHP NICHT MEHR FUNKTIONIERTE (UND MEHR?)
	//$.ajaxSetup({cache:false})

	// jQuery ui widgets initiieren
	$("#programm_wahl").buttonset({
		create: function() {
			// erst jetzt einblenden, weil sonst die normalen checkboxen aufblitzen
			$("#programm_wahl").show();
		}
	});
	$("#messen").buttonset();
	$("button").button();
	$("#tpopfeldkontr_tabs").tabs();
    $('.apf-resizable').resizable();

	// tooltip: Klasse zuweisen, damit gestylt werden kann
	$("#label_olmap_infos_abfragen, #label_olmap_distanz_messen, #label_olmap_flaeche_messen, #label_olmap_auswaehlen, #olmap_exportieren_div, .apf_tooltip").tooltip({
		tooltipClass: "tooltip-styling-hinterlegt",
		content: function() {
			return $(this).attr('title');
		}
	});

	$(".export_abschnitt").tooltip({
		tooltipClass: "export_abschnitt_tooltip_class",
		content: function() {
			return $(this).attr('title');
		}
	});

	$('#olmap_exportieren').button({
		icons: {
	        primary: "ui-icon-circle-arrow-s"
	    },
	    text: false,
        disabled: true
	});

	// Gemeindeliste erstellen (wenn nötig)
	window.apf.erstelleGemeindeliste();

	// Datumsfelder: Widget initiieren
	var monate = ["Januar", "Februar", "März", "April", "Mai", "Juni", "Juli", "August", "September", "Oktober", "November", "Dezember"],
        wochentageKurz = ["So", "Mo", "Di", "Mi", "Do", "Fr", "Sa"],
        wochentageLang = ["Sonntag", "Montag", "Dienstag", "Mittwoch", "Donnerstag", "Freitag", "Samstag"];
	$("#TPopKontrDatum").datepicker({ dateFormat: "dd.mm.yy", altField: "#TPopKontrJahr", altFormat: "yy", defaultDate: +0, showOn: "button", buttonImage: "style/images/calendar.gif", buttonImageOnly: true, monthNames: monate, dayNamesMin: wochentageKurz, dayNames: wochentageLang, firstDay: 1 });
	$("#TPopMassnDatum").datepicker({ dateFormat: "dd.mm.yy", altField: "#TPopMassnJahr", altFormat: "yy", defaultDate: +0, showOn: "button", buttonImage: "style/images/calendar.gif", buttonImageOnly: true, monthNames: monate, dayNamesMin: wochentageKurz, dayNames: wochentageLang, firstDay: 1 });
	$("#JBerDatum, #IbErstelldatum").datepicker({ dateFormat: "dd.mm.yy", defaultDate: +0, showOn: "button", buttonImage: "style/images/calendar.gif", buttonImageOnly: true, monthNames: monate, dayNamesMin: wochentageKurz, dayNames: wochentageLang, firstDay: 1 });

	// Variablen setzen für Formular Feldkontrollen, hier damit nur ein mal
	window.apf.feldliste_feldkontr = ['TPopKontrJahr', 'TPopKontrDatum', 'TPopKontrMethode1', 'TPopKontrAnz1', 'TPopKontrMethode2', 'TPopKontrAnz2', 'TPopKontrMethode3', 'TPopKontrAnz3', 'TPopKontrTxt', 'TPopKontrBearb', 'TPopKontrZaehleinheit1', 'TPopKontrZaehleinheit2', 'TPopKontrZaehleinheit3', 'TPopKontrTyp', 'TPopKontrJungpfl', 'TPopKontrVitalitaet', 'TPopKontrUeberleb', 'TPopKontrEntwicklung', 'TPopKontrUrsach', 'TPopKontrUrteil', 'TPopKontrAendUms', 'TPopKontrAendKontr', 'TPopKontrGuid', 'TPopKontrFlaeche', 'TPopKontrVegTyp', 'TPopKontrKonkurrenz', 'TPopKontrMoosschicht', 'TPopKontrKrautschicht', 'TPopKontrStrauchschicht', 'TPopKontrBaumschicht', 'TPopKontrBodenTyp', 'TPopKontrBodenKalkgehalt', 'TPopKontrBodenDurchlaessigkeit', 'TPopKontrBodenHumus', 'TPopKontrBodenNaehrstoffgehalt', 'TPopKontrBodenAbtrag', 'TPopKontrWasserhaushalt', 'TPopKontrHandlungsbedarf', 'TPopKontrIdealBiotopUebereinst', 'TPopKontrLeb', 'TPopKontrLebUmg'];
	window.apf.feldliste_freiwkontr = ['TPopKontrJahr', 'TPopKontrDatum', 'TPopKontrMethode1', 'TPopKontrAnz1', 'TPopKontrMethode2', 'TPopKontrAnz2', 'TPopKontrMethode3', 'TPopKontrAnz3', 'TPopKontrTxt', 'TPopKontrBearb', 'TPopKontrZaehleinheit1', 'TPopKontrZaehleinheit2', 'TPopKontrZaehleinheit3', 'TPopKontrPlan', 'TPopKontrUebFlaeche', 'TPopKontrUebPfl', 'TPopKontrNaBo', 'TPopKontrJungPflJN', 'TPopKontrVegHoeMax', 'TPopKontrVegHoeMit', 'TPopKontrGefaehrdung', 'TPopKontrGuid'];

	// Auswahllisten aufbauen
	$("#ap_loeschen").hide();
	window.apf.erstelle_artlisten();

	// HIER WIRD IN FIREFOX EINE ENDLOSSCHLAUFE AUSGELÖST
	$.when(window.apf.wähleApListe("programm_alle"))
		.then(function() {
			// falls eine Unteradresse angewählt wurde, diese öffnen
			window.apf.öffneUri();
		});
};

window.apf.initiiere_ap = function() {
	'use strict';
	if (!localStorage.ap_id) {
		// es fehlen benötigte Daten > zurück zum Anfang
		// LIEGT HIER DER WURM BEGRABEN?
		// ACHTUNG, DIESE ZEILE VERURSACHTE STARTABSTÜRZE IN FIREFOX UND ZT OFFENBAR AUCH IN CHROME, DA REKURSIV IMMER WIEDER INITIIERE_INDEX AUFGERUFEN WURDE
		//window.apf.initiiere_index();
		//history.replaceState({ap: "keinap"}, "keinap", "index.html");
		return;
	}
	// Programm-Wahl konfigurieren
	var programm_wahl;
	programm_wahl = $("[name='programm_wahl']:checked").attr("id");
	// Felder zurücksetzen
	window.apf.leereFelderVonFormular("ap");
	// Wenn ein ap ausgewählt ist: Seine Daten anzeigen
	if ($("#ap_waehlen").val() && programm_wahl !== "programm_neu") {
		// Daten für den ap aus der DB holen
		var getAp = $.ajax({
			type: 'get',
			url: 'ap=' + localStorage.ap_id,
			dataType: 'json'
		});
		getAp.always(function(data) {
			// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
			if (data && data[0]) {
				// ap bereitstellen
				window.apf.ap = data[0];
				// Felder mit Daten beliefern
				$("#ApStatus" + data[0].ApStatus).prop("checked", true);
				$("#ApUmsetzung" + data[0].ApUmsetzung).prop("checked", true);
				$("#ApJahr").val(data[0].ApJahr);
				$("#ApArtwert").val(data[0].ApArtwert);
				$("#Artname").val(data[0].Artname);
				// ApBearb: Daten holen - oder vorhandene nutzen
				if (!window.apf.adressen_html) {
					var getAdressen = $.ajax({
						type: 'get',
						url: 'api/adressen',
						dataType: 'json'
					});
					getAdressen.always(function(data2) {
						if (data2) {
							// Feld mit Daten beliefern
							var html;
							html = "<option></option>";
                            _.each(data2, function(adresse) {
                                html += "<option value=\"" + adresse.id + "\">" + adresse.AdrName + "</option>";
                            });
							window.apf.adressen_html = html;
							$("#ApBearb")
                                .html(html)
                                .val(window.apf.ApBearb);
						}
					});
				} else {
					$("#ApBearb")
                        .html(window.apf.adressen_html)
                        .val(window.apf.ApBearb);
				}
				// Formulare blenden
				window.apf.zeigeFormular("ap");
				history.replaceState({ap: "ap"}, "ap", "index.html?ap=" + data.ApArtId);
			}
		});
	} else if ($("#ap_waehlen").val() && programm_wahl === "programm_neu") {
		// Formulare blenden
		window.apf.zeigeFormular("ap");
	}
};

// setzt window.apf und localStorage.ap_id
// wird benötigt, wenn beim App-Start direkt ein deep link geöffnet wird
window.apf.setzeWindowAp = function(id) {
	'use strict';
	localStorage.ap_id = id;
	var getAp = $.ajax({
		type: 'get',
		url: 'ap=' + localStorage.ap_id,
		dataType: 'json'
	});
	getAp.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data && data[0]) {
			// ap bereitstellen
			window.apf.ap = data[0];
		}
	});
};

window.apf.hole_artliste_html = function() {
	'use strict';
	var liste_geholt = $.Deferred();
	// wird benutzt von function window.apf.erstelle_artlisten und window.apf.initiiere_tpopmassn
	// baut eine vollständige Artliste auf
	if (!window.apf.artliste_html) {
		var getArtliste = $.ajax({
			type: 'get',
			url: 'api/artliste',
			dataType: 'json'
		});
		getArtliste.always(function(data) {
			var html;
			html = "<option></option>";
            _.each(data, function(art) {
                html += "<option value=\"" + art.TaxonomieId + "\">" + art.Artname + "</option>";
            });
			window.apf.artliste_html = html;
			liste_geholt.resolve();
		});
	} else {
		liste_geholt.resolve();
	}
	return liste_geholt.promise();
};

// wird benutzt von Formular ap, pop und TPopMassn
// setzt vollständige Artlisten în Select-Felder
window.apf.erstelle_artlisten = function() {
	'use strict';
	var liste_erstellt = $.Deferred();
	$.when(window.apf.hole_artliste_html())
		.then(function() {
			$("#AaSisfNr").html(window.apf.artliste_html);
			$("#TPopMassnAnsiedWirtspfl").html(window.apf.artliste_html);
			liste_erstellt.resolve();
		});
	return liste_erstellt.promise();
};

window.apf.initiiere_pop = function(ohne_zu_zeigen) {
	'use strict';
	if (!localStorage.pop_id) {
		// es fehlen benötigte Daten > eine Ebene höher
		window.apf.initiiere_ap();
		return;
	}
	// Felder zurücksetzen
	window.apf.leereFelderVonFormular("pop");
	// Daten für die pop aus der DB holen
	var getPop = $.ajax({
            type: 'get',
            url: 'php/pop.php',
            dataType: 'json',
            data: {
                "id": localStorage.pop_id
            }
        }),
        $PopName = $("#PopName"),
        $PopNr = $("#PopNr");
	getPop.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// pop bereitstellen
			window.apf.pop = data;
			// Felder mit Daten beliefern
			$("#PopHerkunft" + data.PopHerkunft).prop("checked", true);
			if (data.PopHerkunftUnklar == 1) {
				$("#PopHerkunftUnklar").prop("checked", true);
			} else {
				$("#PopHerkunftUnklar").prop("checked", false);
			}
			$("#PopHerkunftUnklarBegruendung")
                .val(data.PopHerkunftUnklarBegruendung)
                .limiter(255, $("#PopHerkunftUnklarBegruendung_limit"));
            $PopName
                .val(data.PopName)
                .limiter(150, $("#PopName_limit"));
            $PopNr.val(data.PopNr);
			$("#PopBekanntSeit").val(data.PopBekanntSeit);
			$("#PopXKoord").val(data.PopXKoord);
			$("#PopYKoord").val(data.PopYKoord);
			// Formulare blenden
			// nur, wenn ohne_zu_zeigen nicht true ist (true, um in dialog anzuzeigen)
			if (!ohne_zu_zeigen) {
				window.apf.zeigeFormular("pop");
				history.replaceState({pop: "pop"}, "pop", "index.html?ap=" + localStorage.ap_id + "&pop=" + localStorage.pop_id);
				// bei neuen Datensätzen Fokus steuern
				if (!$PopName.val()) {
	                $PopNr.focus();
				}
			}
		}
	});
};

// setzt window.apf.pop und localStorage.pop_id
// wird benötigt, wenn beim App-Start direkt ein deep link geöffnet wird
window.apf.setzeWindowPop = function(id) {
	'use strict';
	localStorage.pop_id = id;
	var getPop = $.ajax({
		type: 'get',
		url: 'php/pop.php',
		dataType: 'json',
		data: {
			"id": localStorage.pop_id
		}
	});
	getPop.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// pop bereitstellen
			window.apf.pop = data;
		}
	});
};

window.apf.initiiere_apziel = function() {
	'use strict';
	if (!localStorage.apziel_id) {
		// es fehlen benötigte Daten > eine Ebene höher
		window.apf.initiiere_ap();
		return;
	}
	var apziel_initiiert = $.Deferred(),
        $ZielJahr = $("#ZielJahr");
	// Felder zurücksetzen
	window.apf.leereFelderVonFormular("apziel");
	// Daten für die apziel aus der DB holen
	var getApZiel = $.ajax({
		type: 'get',
		url: 'php/apziel.php',
		dataType: 'json',
		data: {
			"id": localStorage.apziel_id
		}
	});
	getApZiel.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// apziel bereitstellen
			window.apf.apziel = data;
			// Felder mit Daten beliefern
            $ZielJahr.val(data.ZielJahr);
			$("#ZielTyp" + data.ZielTyp).prop("checked", true);
			$("#ZielBezeichnung").val(data.ZielBezeichnung);
			// Formulare blenden
			window.apf.zeigeFormular("apziel");
			history.replaceState({apziel: "apziel"}, "apziel", "index.html?ap=" + localStorage.ap_id + "&apziel=" + localStorage.apziel_id);
			// bei neuen Datensätzen Fokus steuern
			if (!$ZielJahr.val()) {
                $ZielJahr.focus();
			}
			apziel_initiiert.resolve();
		}
	});
	return apziel_initiiert.promise();
};

// setzt window.apf.apziel und localStorage.apziel_id
// wird benötigt, wenn beim App-Start direkt ein deep link geöffnet wird
window.apf.setzeWindowApziel = function(id) {
	'use strict';
	localStorage.apziel_id = id;
	var getApziel = $.ajax({
		type: 'get',
		url: 'php/apziel.php',
		dataType: 'json',
		data: {
			"id": localStorage.apziel_id
		}
	});
	getApziel.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// apziel bereitstellen
			window.apf.apziel = data;
		}
	});
};

window.apf.initiiere_zielber = function() {
	'use strict';
	if (!localStorage.zielber_id) {
		// es fehlen benötigte Daten > eine Ebene höher
		window.apf.initiiere_ap();
		return;
	}
	// Felder zurücksetzen
	window.apf.leereFelderVonFormular("zielber");
	// Daten für die zielber aus der DB holen
	var getZielBer = $.ajax({
            type: 'get',
            url: 'php/zielber.php',
            dataType: 'json',
            data: {
                "id": localStorage.zielber_id
            }
        }),
        $ZielBerJahr = $("#ZielBerJahr");
	getZielBer.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// zeilber bereitstellen
			window.apf.zielber = data;
			// Felder mit Daten beliefern
            $ZielBerJahr.val(data.ZielBerJahr);
			$("#ZielBerErreichung").val(data.ZielBerErreichung);
			$("#ZielBerTxt").val(data.ZielBerTxt);
			// Formulare blenden
			window.apf.zeigeFormular("zielber");
			history.replaceState({zielber: "zielber"}, "zielber", "index.html?ap=" + localStorage.ap_id + "&apziel=" + localStorage.apziel_id + "&zielber=" + localStorage.zielber_id);
			// bei neuen Datensätzen Fokus steuern
			if (!$ZielBerJahr.val()) {
                $ZielBerJahr.focus();
			}
		}
	});
};

// setzt window.apf.zielber und localStorage.zielber_id
// wird benötigt, wenn beim App-Start direkt ein deep link geöffnet wird
window.apf.setzeWindowZielber = function(id) {
	'use strict';
	localStorage.zielber_id = id;
	var getZielber = $.ajax({
		type: 'get',
		url: 'php/zielber.php',
		dataType: 'json',
		data: {
			"id": localStorage.zielber_id
		}
	});
	getZielber.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// zielber bereitstellen
			window.apf.zielber = data;
		}
	});
};

window.apf.initiiere_erfkrit = function() {
	'use strict';
	if (!localStorage.erfkrit_id) {
		// es fehlen benötigte Daten > eine Ebene höher
		window.apf.initiiere_ap();
		return;
	}
	// Felder zurücksetzen
	window.apf.leereFelderVonFormular("erfkrit");
	// Daten für die erfkrit aus der DB holen
	var getErfkrit = $.ajax({
            type: 'get',
            url: 'php/erfkrit.php',
            dataType: 'json',
            data: {
                "id": localStorage.erfkrit_id
            }
        }),
        $ErfkritErreichungsgrad = $("#ErfkritErreichungsgrad");
	getErfkrit.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// erfkrit bereitstellen
			window.apf.erfkrit = data;
			// Felder mit Daten beliefern
			$("#ErfkritErreichungsgrad" + data.ErfkritErreichungsgrad).prop("checked", true);
			$("#ErfkritTxt")
                .val(data.ErfkritTxt)
                .limiter(255, $("#ErfkritTxt_limit"));
			// Formulare blenden
			window.apf.zeigeFormular("erfkrit");
			history.replaceState({erfkrit: "erfkrit"}, "erfkrit", "index.html?ap=" + localStorage.ap_id + "&erfkrit=" + localStorage.erfkrit_id);
			// bei neuen Datensätzen Fokus steuern
			if (!$ErfkritErreichungsgrad.val()) {
                $ErfkritErreichungsgrad.focus();
			}
		}
	});
};

// setzt window.apf.erfkrit und localStorage.erfkrit_id
// wird benötigt, wenn beim App-Start direkt ein deep link geöffnet wird
window.apf.setzeWindowErfkrit = function(id) {
	'use strict';
	localStorage.erfkrit_id = id;
	var getErfkrit = $.ajax({
		type: 'get',
		url: 'php/erfkrit.php',
		dataType: 'json',
		data: {
			"id": localStorage.erfkrit_id
		}
	});
	getErfkrit.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// erfkrit bereitstellen
			window.apf.erfkrit = data;
		}
	});
};

window.apf.initiiere_jber = function() {
	'use strict';
	if (!localStorage.jber_id) {
		// es fehlen benötigte Daten > eine Ebene höher
		window.apf.initiiere_ap();
		return;
	}
	// Felder zurücksetzen
	window.apf.leereFelderVonFormular("jber");
	// Daten für die jber aus der DB holen
	var getJber = $.ajax({
            type: 'get',
            url: 'php/jber.php',
            dataType: 'json',
            data: {
                "id": localStorage.jber_id
            }
        }),
        $JBerJahr = $("#JBerJahr");
	getJber.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// jber bereitstellen
			window.apf.jber = data;
			// Felder mit Daten beliefern
            $JBerJahr.val(data.JBerJahr);
			$("#JBerSituation").val(data.JBerSituation);
			$("#JBerVergleichVorjahrGesamtziel").val(data.JBerVergleichVorjahrGesamtziel);
			$("#JBerBeurteilung" + data.JBerBeurteilung).prop("checked", true);
			// escapen, + und - werden sonst verändert
			$("#JBerVeraenGegenVorjahr\\" + data.JBerVeraenGegenVorjahr).prop("checked", true);
			$("#JBerAnalyse")
                .val(data.JBerAnalyse)
                .limiter(255, $("#JBerAnalyse_limit"));
			$("#JBerUmsetzung").val(data.JBerUmsetzung);
			$("#JBerErfko").val(data.JBerErfko);
			$("#JBerATxt").val(data.JBerATxt);
			$("#JBerBTxt").val(data.JBerBTxt);
			$("#JBerCTxt").val(data.JBerCTxt);
			$("#JBerDTxt").val(data.JBerDTxt);
			if (data.JBerDatum !== "01.01.1970") {
				// php macht aus einem Nullwert im Datum den 1.1.1970!!!
				$("#JBerDatum").val(data.JBerDatum);
			} else {
				$("#JBerDatum").val("");
			}
			// JBerBearb: Daten holen - oder vorhandene nutzen
			if (!window.apf.adressen_html) {
				var getAdressen = $.ajax({
					type: 'get',
					url: 'api/adressen',
					dataType: 'json'
				});
				getAdressen.always(function(data2) {
					if (data2) {
						// adressen bereitstellen
						// Feld mit Daten beliefern
						var html;
						html = "<option></option>";
                        _.each(data2, function(adresse) {
                            html += "<option value=\"" + adresse.id + "\">" + adresse.AdrName + "</option>";
                        });
						window.apf.adressen_html = html;
						$("#JBerBearb")
                            .html(html)
                            .val(window.apf.jber.JBerBearb);
					}
				});
			} else {
				$("#JBerBearb")
                    .html(window.apf.adressen_html)
                    .val(window.apf.jber.JBerBearb);
			}
			// Formulare blenden
			window.apf.zeigeFormular("jber");
			history.replaceState({jber: "jber"}, "jber", "index.html?ap=" + localStorage.ap_id + "&jber=" + localStorage.jber_id);
			// bei neuen Datensätzen Fokus steuern
			if (!$JBerJahr.val()) {
                $JBerJahr.focus();
			}
		}
	});
};

// setzt window.apf.jber und localStorage.jber_id
// wird benötigt, wenn beim App-Start direkt ein deep link geöffnet wird
window.apf.setzeWindowJber = function(id) {
	'use strict';
	localStorage.jber_id = id;
	var getJber = $.ajax({
		type: 'get',
		url: 'php/jber.php',
		dataType: 'json',
		data: {
			"id": localStorage.jber_id
		}
	});
	getJber.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// jber bereitstellen
			window.apf.jber = data;
		}
	});
};

window.apf.initiiere_jber_uebersicht = function() {
	'use strict';
	if (!localStorage.jber_uebersicht_id) {
		// es fehlen benötigte Daten > eine Ebene höher
		window.apf.initiiere_ap();
		return;
	}
	// Felder zurücksetzen
	window.apf.leereFelderVonFormular("jber_uebersicht");
	// Daten für die jber_uebersicht aus der DB holen
	var getJberÜbersicht = $.ajax({
            type: 'get',
            url: 'php/jber_uebersicht.php',
            dataType: 'json',
            data: {
                "JbuJahr": localStorage.jber_uebersicht_id
            }
        }),
        $JbuJahr = $("#JbuJahr");
	getJberÜbersicht.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// jber_uebersicht bereitstellen
			window.apf.jber_übersicht = data;
			// Felder mit Daten beliefern
            $JbuJahr.val(data.JbuJahr);
			$("#JbuBemerkungen").val(data.JbuBemerkungen);
			// window.apf.fitTextareaToContent("Bemerkungen", document.documentElement.clientHeight);
			// Formulare blenden
			window.apf.zeigeFormular("jber_uebersicht");
			history.replaceState({jber_uebersicht: "jber_uebersicht"}, "jber_uebersicht", "index.html?ap=" + localStorage.ap_id + "&jber_uebersicht=" + localStorage.jber_uebersicht_id);
			// bei neuen Datensätzen Fokus steuern
			if (!$JbuJahr.val()) {
                $JbuJahr.focus();
			}
		}
	});
};

// setzt window.apf.jber_übersicht und localStorage.jber_uebersicht_id
// wird benötigt, wenn beim App-Start direkt ein deep link geöffnet wird
window.apf.setzeWindowJberUebersicht = function(id) {
	'use strict';
	localStorage.jber_uebersicht_id = id;
	var getJberUebersicht = $.ajax({
		type: 'get',
		url: 'php/jber_uebersicht.php',
		dataType: 'json',
		data: {
			"id": localStorage.jber_uebersicht_id
		}
	});
	getJberUebersicht.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// jber_uebersicht bereitstellen
			window.apf.jber_übersicht = data;
		}
	});
};

window.apf.initiiere_ber = function() {
	'use strict';
	if (!localStorage.ber_id) {
		// es fehlen benötigte Daten > eine Ebene höher
		window.apf.initiiere_ap();
		return;
	}
	// Felder zurücksetzen
	window.apf.leereFelderVonFormular("ber");
	// Daten für die ber aus der DB holen
	var getBer = $.ajax({
            type: 'get',
            url: 'php/ber.php',
            dataType: 'json',
            data: {
                "id": localStorage.ber_id
            }
        }),
        $BerAutor = $("#BerAutor"),
        $BerJahr = $("#BerJahr"),
        $BerTitel = $("#BerTitel"),
        $BerURL = $("#BerURL");
	getBer.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// ber bereitstellen
			window.apf.ber = data;
			// Felder mit Daten beliefern
            $BerAutor.val(data.BerAutor);
            $BerJahr.val(data.BerJahr);
            $BerTitel
                .val(data.BerTitel)
                .limiter(255, $("#BerTitel_limit"));
            $BerURL
                .val(data.BerURL)
                .limiter(255, $("#BerURL_limit"));
			// URL-Link initialisieren, wird bei Änderung der URL in index.html angepasst
			$('#BerURLHref').attr('onClick', "window.open('" + data.BerURL + "', target='_blank')");
			// Formulare blenden
			window.apf.zeigeFormular("ber");
			history.replaceState({ber: "ber"}, "ber", "index.html?ap=" + localStorage.ap_id + "&ber=" + localStorage.ber_id);
			// bei neuen Datensätzen Fokus steuern
			if (!$BerAutor.val()) {
                $BerAutor.focus();
			} else if (!$BerJahr.val()) {
                $BerJahr.focus();
			} else if (!$BerTitel.val()) {
                $BerTitel.focus();
			} else if (!$BerURL.val()) {
                $BerURL.focus();
			}
		}
	});
};

// setzt window.apf.ber und localStorage.ber_id
// wird benötigt, wenn beim App-Start direkt ein deep link geöffnet wird
window.apf.setzeWindowBer = function(id) {
	'use strict';
	localStorage.ber_id = id;
	var getBer = $.ajax({
		type: 'get',
		url: 'php/ber.php',
		dataType: 'json',
		data: {
			"id": localStorage.ber_id
		}
	});
	getBer.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// ber bereitstellen
			window.apf.ber = data;
		}
	});
};

window.apf.initiiere_idealbiotop = function() {
	'use strict';
	if (!localStorage.ap_id) {
		// es fehlen benötigte Daten > eine Ebene höher
		window.apf.initiiere_ap();
		return;
	}
	// Felder zurücksetzen
	window.apf.leereFelderVonFormular("idealbiotop");
	// Daten für die idealbiotop aus der DB holen
	var getIdealbiotop = $.ajax({
            type: 'get',
            url: 'ap=' + localStorage.ap_id + '/idealbiotop',
            dataType: 'json'
        }),
        $IbErstelldatum = $("#IbErstelldatum");
	getIdealbiotop.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data && data[0]) {
            data = data[0];
			// idealbiotop bereitstellen
			localStorage.idealbiotop_id = data.IbApArtId;
			window.apf.idealbiotop = data;
			// Felder mit Daten beliefern
			if (data.IbErstelldatum !== "01.01.1970") {
				// php macht aus einem Nullwert im Datum den 1.1.1970!!!
				$("#IbErstelldatum").val(data.IbErstelldatum);
			}
			$("#IbHoehenlage").val(data.IbHoehenlage);
			$("#IbRegion").val(data.IbRegion);
			$("#IbExposition").val(data.IbExposition);
			$("#IbBesonnung").val(data.IbBesonnung);
			$("#IbHangneigung").val(data.IbHangneigung);
			$("#IbBodenTyp").val(data.IbBodenTyp);
			$("#IbBodenKalkgehalt").val(data.IbBodenKalkgehalt);
			$("#IbBodenDurchlaessigkeit").val(data.IbBodenDurchlaessigkeit);
			$("#IbBodenHumus").val(data.IbBodenHumus);
			$("#IbBodenNaehrstoffgehalt").val(data.IbBodenNaehrstoffgehalt);
			$("#IbWasserhaushalt").val(data.IbWasserhaushalt);
			$("#IbKonkurrenz").val(data.IbKonkurrenz);
			$("#IbMoosschicht").val(data.IbMoosschicht);
			$("#IbKrautschicht").val(data.IbKrautschicht);
			$("#IbStrauchschicht").val(data.IbStrauchschicht);
			$("#IbBaumschicht").val(data.IbBaumschicht);
			$("#IbBemerkungen").val(data.IbBemerkungen);
			// Formulare blenden
			window.apf.zeigeFormular("idealbiotop");
			history.replaceState({idealbiotop: "idealbiotop"}, "idealbiotop", "index.html?ap=" + localStorage.ap_id + "&idealbiotop=" + localStorage.idealbiotop_id);
			// bei neuen Datensätzen Fokus steuern
			if (!$IbErstelldatum.val()) {
                $IbErstelldatum.focus();
			}
		} else {
			// nur aktualisieren, wenn Schreibrechte bestehen
			if (!window.apf.prüfeSchreibvoraussetzungen()) {
				return;
			}

			// null zurückgekommen > Datesatz schaffen
			var insertIdealbiotop = $.ajax({
				type: 'post',
				url: 'php/idealbiotop_insert.php',
				dataType: 'json',
				data: {
					"id": localStorage.ap_id,
					"user": sessionStorage.User
				}
			});
			insertIdealbiotop.always(function(data) {
				localStorage.idealbiotop_id = data.IbApArtId;
				window.apf.initiiere_idealbiotop();
			});
			insertIdealbiotop.fail(function() {
				//window.apf.melde("Fehler: Kein Idealbiotop erstellt");
				console.log("Fehler: Kein Idealbiotop erstellt");
			});
		}
	});
};

// setzt window.apf.idealbiotop und localStorage.idealbiotop_id
// wird benötigt, wenn beim App-Start direkt ein deep link geöffnet wird
window.apf.setzeWindowIdealbiotop = function(id) {
	'use strict';
	localStorage.idealbiotop_id = id;
	var getIdealbiotop = $.ajax({
		type: 'get',
		url: 'ap=' + localStorage.idealbiotop_id + '/idealbiotop.php',
		dataType: 'json'
	});
	getIdealbiotop.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data && data[0]) {
			// idealbiotop bereitstellen
			window.apf.idealbiotop = data[0];
		}
	});
};

window.apf.initiiere_assozarten = function() {
	'use strict';
	if (!localStorage.assozarten_id) {
		// es fehlen benötigte Daten > eine Ebene höher
		window.apf.initiiere_ap();
		return;
	}
	// Felder zurücksetzen
	window.apf.leereFelderVonFormular("assozarten");
	// Daten für die assozarten aus der DB holen
	var getAssozarten = $.ajax({
            type: 'get',
            url: 'ap=' + localStorage.ap_id + '/assozart=' + localStorage.assozarten_id,
            dataType: 'json'
        }),
        $AaSisfNr = $("#AaSisfNr");
	getAssozarten.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data && data.length > 0) {
			// assozarten bereitstellen
			window.apf.assozarten = data[0];
			// Felder mit Daten beliefern
            $AaSisfNr.val(data[0].AaSisfNr);
			$("#AaBem").val(data[0].AaBem);
			// Formulare blenden
			window.apf.zeigeFormular("assozarten");
			history.replaceState({assozarten: "assozarten"}, "assozarten", "index.html?ap=" + localStorage.ap_id + "&assozarten=" + localStorage.assozarten_id);
			// bei neuen Datensätzen Fokus steuern
			if (!$AaSisfNr.val()) {
                $AaSisfNr.focus();
			}
		}
	});
};

// setzt window.apf.assozarten und localStorage.assozarten_id
// wird benötigt, wenn beim App-Start direkt ein deep link geöffnet wird
window.apf.setzeWindowAssozarten = function(id) {
	'use strict';
	localStorage.assozarten_id = id;
	var getAssozarten = $.ajax({
		type: 'get',
		url: 'ap=' + localStorage.ap_id + '/assozart=' + localStorage.assozarten_id,
		dataType: 'json'
	});
	getAssozarten.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// assozarten bereitstellen
			window.apf.assozarten = data;
		}
	});
};

window.apf.initiiere_popmassnber = function() {
	'use strict';
	if (!localStorage.popmassnber_id) {
		// es fehlen benötigte Daten > eine Ebene höher
		window.apf.initiiere_pop();
		return;
	}
	// Felder zurücksetzen
	window.apf.leereFelderVonFormular("popmassnber");
	// Daten für die pop aus der DB holen
	var getPopmassnber = $.ajax({
		type: 'get',
		url: 'php/popmassnber.php',
		dataType: 'json',
		data: {
			"id": localStorage.popmassnber_id
		}
	});
	getPopmassnber.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// popmassnber bereitstellen
			window.apf.popmassnber = data;
			// Felder mit Daten beliefern
			$("#PopMassnBerJahr").val(data.PopMassnBerJahr);
			$("#PopMassnBerErfolgsbeurteilung" + data.PopMassnBerErfolgsbeurteilung).prop("checked", true);
			$("#PopMassnBerTxt").val(data.PopMassnBerTxt);
			// Formulare blenden
			window.apf.zeigeFormular("popmassnber");
			history.replaceState({popmassnber: "popmassnber"}, "popmassnber", "index.html?ap=" + localStorage.ap_id + "&pop=" + localStorage.pop_id + "&popmassnber=" + localStorage.popmassnber_id);
			// bei neuen Datensätzen Fokus steuern
			$('#PopMassnBerJahr').focus();
		}
	});
};

// setzt window.apf.popmassnber und localStorage.popmassnber_id
// wird benötigt, wenn beim App-Start direkt ein deep link geöffnet wird
window.apf.setzeWindowPopmassnber = function(id) {
	'use strict';
	localStorage.popmassnber_id = id;
	var getPopmassnber = $.ajax({
		type: 'get',
		url: 'php/popmassnber.php',
		dataType: 'json',
		data: {
			"id": localStorage.popmassnber_id
		}
	});
	getPopmassnber.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// popmassnber bereitstellen
			window.apf.popmassnber = data;
		}
	});
};

window.apf.initiiere_tpop = function(ohne_zu_zeigen) {
	'use strict';
	var $TPopFlurname = $("#TPopFlurname");
	if (!localStorage.tpop_id) {
		// es fehlen benötigte Daten > eine Ebene höher
		window.apf.initiiere_pop();
		return;
	}
	// Felder zurücksetzen
	window.apf.leereFelderVonFormular("tpop");
	// Daten für die pop aus der DB holen
	var getTPop = $.ajax({
        type: 'get',
        url: 'php/tpop.php',
        dataType: 'json',
        data: {
            "id": localStorage.tpop_id
        }
    });
	getTPop.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// tpop bereitstellen
			window.apf.tpop = data;
			// Felder mit Daten beliefern
            $TPopFlurname
                .val(data.TPopFlurname)
                .limiter(255, $("#TPopFlurname_limit"));
			$("#TPopNr").val(data.TPopNr);
			$("#TPopHerkunft" + data.TPopHerkunft).prop("checked", true);
			if (data.TPopHerkunftUnklar == 1) {
				$("#TPopHerkunftUnklar").prop("checked", true);
			} else {
				$("#TPopHerkunftUnklar").prop("checked", false);
			}
			$("#TPopHerkunftUnklarBegruendung")
                .val(data.TPopHerkunftUnklarBegruendung)
                .limiter(255, $("#TPopHerkunftUnklarBegruendung_limit"));
			$("#TPopApBerichtRelevant" + data.TPopApBerichtRelevant).prop("checked", true);
			$("#TPopBekanntSeit").val(data.TPopBekanntSeit);
			$("#TPopGemeinde")
                .val(data.TPopGemeinde)
                .limiter(255, $("#TPopGemeinde_limit"));
			$("#TPopXKoord").val(data.TPopXKoord);
			$("#TPopYKoord").val(data.TPopYKoord);
			$("#TPopRadius").val(data.TPopRadius);
			$("#TPopHoehe").val(data.TPopHoehe);
			$("#TPopExposition")
                .val(data.TPopExposition)
                .limiter(50, $("#TPopExposition_limit"));
			$("#TPopKlima")
                .val(data.TPopKlima)
                .limiter(50, $("#TPopKlima_limit"));
			$("#TPopNeigung")
                .val(data.TPopNeigung)
                .limiter(50, $("#TPopNeigung_limit"));
			$("#TPopBeschr")
                .val(data.TPopBeschr)
                .limiter(255, $("#TPopBeschr_limit"));
			$("#TPopKatNr")
                .val(data.TPopKatNr)
                .limiter(255, $("#TPopKatNr_limit"));
			$("#TPopEigen")
                .val(data.TPopEigen)
                .limiter(255, $("#TPopEigen_limit"));
			$("#TPopKontakt")
                .val(data.TPopKontakt)
                .limiter(255, $("#TPopKontakt_limit"));
			$("#TPopNutzungszone")
                .val(data.TPopNutzungszone)
                .limiter(255, $("#TPopNutzungszone_limit"));
			$("#TPopBewirtschafterIn")
                .val(data.TPopBewirtschafterIn)
                .limiter(255, $("#TPopBewirtschafterIn_limit"));
			$("#TPopBewirtschaftung")
                .val(data.TPopBewirtschaftung)
                .limiter(255, $("#TPopBewirtschaftung_limit"));
			$("#TPopTxt").val(data.TPopTxt);
			// für select Daten holen - oder vorhandene nutzen
			if (!window.apf.adressen_html) {
				var getAdressen = $.ajax({
					type: 'get',
					url: 'api/adressen',
					dataType: 'json'
				});
				getAdressen.always(function(data2) {
					if (data2) {
						// adressen bereitstellen
						window.apf.adressen = data2;
						localStorage.adressen = JSON.stringify(data2);
						// Feld mit Daten beliefern
						var html;
						html = "<option></option>";
                        _.each(data2, function(adresse) {
                            html += "<option value=\"" + adresse.id + "\">" + adresse.AdrName + "</option>";
                        });
						window.apf.adressen_html = html;
						$("#TPopVerantw")
                            .html(html)
                            .val(window.apf.tpop.TPopVerantw);
					}
				});
			} else {
				$("#TPopVerantw")
                    .html(window.apf.adressen_html)
                    .val(window.apf.tpop.TPopVerantw);
			}
			// Formulare blenden
			// nur, wenn ohne_zu_zeigen nicht true ist (true, um in dialog anzuzeigen)
			if (!ohne_zu_zeigen) {
				window.apf.zeigeFormular("tpop");
				history.replaceState({tpop: "tpop"}, "tpop", "index.html?ap=" + localStorage.ap_id + "&pop=" + localStorage.pop_id + "&tpop=" + localStorage.tpop_id);
				// bei neuen Datensätzen Fokus steuern
				if (!$TPopFlurname.val()) {
					$('#TPopNr').focus();
				}
			}
		}
	});
	getTPop.fail(function() {
		//window.apf.melde('Fehler: keine Daten für die Teilpopulation erhalten');
		console.log('Fehler: keine Daten für die Teilpopulation erhalten');
	});
};

// setzt window.apf.tpop und localStorage.tpop_id
// wird benötigt, wenn beim App-Start direkt ein deep link geöffnet wird
window.apf.setzeWindowTpop = function(id) {
	'use strict';
	localStorage.tpop_id = id;
	var getTPop = $.ajax({
		type: 'get',
		url: 'php/tpop.php',
		dataType: 'json',
		data: {
			"id": localStorage.tpop_id
		}
	});
	getTPop.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// tpop bereitstellen
			window.apf.tpop = data;
		}
	});
};

window.apf.initiiere_popber = function() {
	'use strict';
	if (!localStorage.popber_id) {
		// es fehlen benötigte Daten > eine Ebene höher
		window.apf.initiiere_pop();
		return;
	}
	// Felder zurücksetzen
	window.apf.leereFelderVonFormular("popber");
	// Daten für die popber aus der DB holen
	var getPopber = $.ajax({
		type: 'get',
		url: 'php/popber.php',
		dataType: 'json',
		data: {
			"id": localStorage.popber_id
		}
	});
	getPopber.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// popber bereitstellen
			window.apf.popber = data;
			// Felder mit Daten beliefern
			$("#PopBerJahr").val(data.PopBerJahr);
			$("#PopBerEntwicklung" + data.PopBerEntwicklung).prop("checked", true);
			$("#PopBerTxt").val(data.PopBerTxt);
			// Formulare blenden
			window.apf.zeigeFormular("popber");
			history.replaceState({tpopber: "popber"}, "popber", "index.html?ap=" + localStorage.ap_id + "&pop=" + localStorage.pop_id + "&popber=" + localStorage.popber_id);
			// bei neuen Datensätzen Fokus steuern
			$('#PopBerJahr').focus();
		}
	});
};

// setzt window.apf.popber und localStorage.popber_id
// wird benötigt, wenn beim App-Start direkt ein deep link geöffnet wird
window.apf.setzeWindowPopber = function(id) {
	'use strict';
	localStorage.popber_id = id;
	var getPopber = $.ajax({
		type: 'get',
		url: 'php/popber.php',
		dataType: 'json',
		data: {
			"id": localStorage.popber_id
		}
	});
	getPopber.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// popber bereitstellen
			window.apf.popber = data;
		}
	});
};

window.apf.initiiere_tpopfeldkontr = function() {
	'use strict';
	// wird gemeinsam für Feld- und Freiwilligenkontrollen verwendet
	// Feldkontrollen: Felder der Freiwilligenkontrollen ausblenden
	// Freiwilligenkontrollen: Felder der Feldkontrollen ausblenen plus Register Biotop
	if (!localStorage.tpopfeldkontr_id) {
		// es fehlen benötigte Daten > eine Ebene höher
		window.apf.initiiere_pop();
		return;
	}
	// Felder zurücksetzen
	window.apf.leereFelderVonFormular("tpopfeldkontr");
	// alle Felder ausblenden. Später werden die benötigten eingeblendet
	$('.feld_tpopfeldkontr').each(function() {
		$(this).hide();
	});
	// Daten für die tpopfeldkontr aus der DB holen
	var getTpopfeldkontr = $.ajax({
            type: 'get',
            url: 'php/tpopfeldkontr.php',
            dataType: 'json',
            data: {
                "id": localStorage.tpopfeldkontr_id
            }
        }),
        $TPopKontrJahr = $("#TPopKontrJahr"),
        $TPopKontrJungPflJN_ja = $("#TPopKontrJungPflJN_ja"),
        $TPopKontrJungPflJN_nein = $("#TPopKontrJungPflJN_nein"),
        $TPopKontrJungPflJN_leer = $("#TPopKontrJungPflJN_leer");
	getTpopfeldkontr.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// tpopfeldkontr bereitstellen
			window.apf.tpopfeldkontr = data;
			// gemeinsame Felder
			// mit Daten beliefern
            $TPopKontrJahr.val(data.TPopKontrJahr);
			if (data.TPopKontrDatum !== "01.01.1970") {
				// php macht aus einem Nullwert im Datum den 1.1.1970!!!
				$("#TPopKontrDatum").val(data.TPopKontrDatum);
			} else {
				$("#TPopKontrDatum").val("");
			}
			$("#TPopKontrMethode1" + data.TPopKontrMethode1).prop("checked", true);
			$("#TPopKontrAnz1").val(data.TPopKontrAnz1);
			$("#TPopKontrMethode2" + data.TPopKontrMethode2).prop("checked", true);
			$("#TPopKontrAnz2").val(data.TPopKontrAnz2);
			$("#TPopKontrMethode3" + data.TPopKontrMethode3).prop("checked", true);
			$("#TPopKontrAnz3").val(data.TPopKontrAnz3);
			$("#TPopKontrTxt").val(data.TPopKontrTxt);
			$("#TPopKontrGuid").val(data.TPopKontrGuid);
			// TPopKontrBearb: Daten holen - oder vorhandene nutzen
			if (!window.apf.adressen_html) {
				var getAdressen = $.ajax({
					type: 'get',
					url: 'api/adressen',
					dataType: 'json'
				});
				getAdressen.always(function(data2) {
					if (data2) {
						// Feld mit Daten beliefern
						var html;
						html = "<option></option>";
                        _.each(data2, function(adresse) {
                            html += "<option value=\"" + adresse.id + "\">" + adresse.AdrName + "</option>";
                        });
						window.apf.adressen_html = html;
						$("#TPopKontrBearb")
                            .html(html)
                            .val(window.apf.tpopfeldkontr.TPopKontrBearb);
					}
				});
			} else {
				$("#TPopKontrBearb")
                    .html(window.apf.adressen_html)
                    .val(window.apf.tpopfeldkontr.TPopKontrBearb);
			}
			// für 3 selectfelder TPopKontrZaehleinheit Daten holen - oder vorhandene nutzen
			if (!window.apf.TPopKontrZähleinheit_html) {
				var getTpopfeldkontrZaehleinheit = $.ajax({
					type: 'get',
					url: 'php/tpopfeldkontr_zaehleinheit.php',
					dataType: 'json'
				});
				getTpopfeldkontrZaehleinheit.always(function(data3) {
					if (data3) {
						// Feld mit Daten beliefern
						var html;
						html = "<option></option>";
                        _.each(data3.rows, function(zähleinheit) {
                            html += "<option value=\"" + zähleinheit.id + "\">" + zähleinheit.ZaehleinheitTxt + "</option>";
                        });
						window.apf.TPopKontrZähleinheit_html = html;
						// alle 3 Felder setzen
						$("#TPopKontrZaehleinheit1")
                            .html(html)
                            .val(window.apf.tpopfeldkontr.TPopKontrZaehleinheit1);
						$("#TPopKontrZaehleinheit2")
                            .html(html)
                            .val(window.apf.tpopfeldkontr.TPopKontrZaehleinheit2);
						$("#TPopKontrZaehleinheit3")
                            .html(html)
                            .val(window.apf.tpopfeldkontr.TPopKontrZaehleinheit3);
					}
				});
			} else {
				// alle 3 Felder setzen
				$("#TPopKontrZaehleinheit1")
                    .html(window.apf.TPopKontrZähleinheit_html)
                    .val(window.apf.tpopfeldkontr.TPopKontrZaehleinheit1);
				$("#TPopKontrZaehleinheit2")
                    .html(window.apf.TPopKontrZähleinheit_html)
                    .val(window.apf.tpopfeldkontr.TPopKontrZaehleinheit2);
				$("#TPopKontrZaehleinheit3")
                    .html(window.apf.TPopKontrZähleinheit_html)
                    .val(window.apf.tpopfeldkontr.TPopKontrZaehleinheit3);
			}
			// Felder, die nur in der Feldkontrolle vorkommen
			if (!localStorage.tpopfreiwkontr) {
				$("#TPopKontrTyp" + data.TPopKontrTyp).prop("checked", true);
				$("#TPopKontrJungpfl").val(data.TPopKontrJungpfl);
				$("#TPopKontrVitalitaet")
                    .val(data.TPopKontrVitalitaet)
                    .limiter(255, $("#TPopKontrVitalitaet_limit"));
				$("#TPopKontrUeberleb").val(data.TPopKontrUeberleb);
				$("#TPopKontrEntwicklung" + data.TPopKontrEntwicklung).prop("checked", true);
				$("#TPopKontrUrsach")
                    .val(data.TPopKontrUrsach)
                    .limiter(255, $("#TPopKontrUrsach_limit"));
				$("#TPopKontrUrteil")
                    .val(data.TPopKontrUrteil)
                    .limiter(255, $("#TPopKontrUrteil_limit"));
				$("#TPopKontrAendUms")
                    .val(data.TPopKontrAendUms)
                    .limiter(255, $("#TPopKontrAendUms_limit"));
				$("#TPopKontrAendKontr")
                    .val(data.TPopKontrAendKontr)
                    .limiter(255, $("#TPopKontrAendKontr_limit"));
				// Biotop
				$("#TPopKontrFlaeche").val(data.TPopKontrFlaeche);
				$("#TPopKontrVegTyp")
                    .val(data.TPopKontrVegTyp)
                    .limiter(100, $("#TPopKontrVegTyp_limit"));
				$("#TPopKontrKonkurrenz")
                    .val(data.TPopKontrKonkurrenz)
                    .limiter(100, $("#TPopKontrKonkurrenz_limit"));
				$("#TPopKontrMoosschicht")
                    .val(data.TPopKontrMoosschicht)
                    .limiter(100, $("#TPopKontrMoosschicht_limit"));
				$("#TPopKontrKrautschicht")
                    .val(data.TPopKontrKrautschicht)
                    .limiter(100, $("#TPopKontrKrautschicht_limit"));
				$("#TPopKontrStrauchschicht")
                    .val(data.TPopKontrStrauchschicht)
                    .limiter(255, $("#TPopKontrStrauchschicht_limit"));
				$("#TPopKontrBaumschicht")
                    .val(data.TPopKontrBaumschicht)
                    .limiter(100, $("#TPopKontrBaumschicht_limit"));
				$("#TPopKontrBodenTyp")
                    .val(data.TPopKontrBodenTyp)
                    .limiter(255, $("#TPopKontrBodenTyp_limit"));
				$("#TPopKontrBodenKalkgehalt")
                    .val(data.TPopKontrBodenKalkgehalt)
                    .limiter(100, $("#TPopKontrBodenKalkgehalt_limit"));
				$("#TPopKontrBodenDurchlaessigkeit")
                    .val(data.TPopKontrBodenDurchlaessigkeit)
                    .limiter(100, $("#TPopKontrBodenDurchlaessigkeit_limit"));
				$("#TPopKontrBodenHumus")
                    .val(data.TPopKontrBodenHumus)
                    .limiter(100, $("#TPopKontrBodenHumus_limit"));
				$("#TPopKontrBodenNaehrstoffgehalt")
                    .val(data.TPopKontrBodenNaehrstoffgehalt)
                    .limiter(100, $("#TPopKontrBodenNaehrstoffgehalt_limit"));
				$("#TPopKontrBodenAbtrag")
                    .val(data.TPopKontrBodenAbtrag)
                    .limiter(255, $("#TPopKontrBodenAbtrag_limit"));
				$("#TPopKontrWasserhaushalt")
                    .val(data.TPopKontrWasserhaushalt)
                    .limiter(255, $("#TPopKontrWasserhaushalt_limit"));
				$("#TPopKontrHandlungsbedarf").val(data.TPopKontrHandlungsbedarf);
				$("#TPopKontrIdealBiotopUebereinst" + data.TPopKontrIdealBiotopUebereinst).prop("checked", true);
				// TPopKontrLeb: Daten holen - oder vorhandene nutzen
				if (!window.apf.lrdelarze_html) {
					var getLrDelarze = $.ajax({
						type: 'get',
						url: 'php/lrdelarze.php',
						dataType: 'json'
					});
					getLrDelarze.always(function(data4) {
						if (data4) {
							// Feld mit Daten beliefern
							var html;
							html = "<option></option>";
                            _.each(data4.rows, function(lr) {
                                html += "<option value=\"" + lr.id + "\">" + lr.Einheit + "</option>";
                            });
							window.apf.lrdelarze_html = html;
							$("#TPopKontrLeb")
                                .html(html)
                                .val(window.apf.tpopfeldkontr.TPopKontrLeb);
							$("#TPopKontrLebUmg")
                                .html(html)
                                .val(window.apf.tpopfeldkontr.TPopKontrLebUmg);
						}
					});
				} else {
					$("#TPopKontrLeb")
                        .html(window.apf.lrdelarze_html)
                        .val(window.apf.tpopfeldkontr.TPopKontrLeb);
					$("#TPopKontrLebUmg")
                        .html(window.apf.lrdelarze_html)
                        .val(window.apf.tpopfeldkontr.TPopKontrLebUmg);
				}
			}
			// TPopKontrIdealBiotopUebereinst: Daten holen - oder vorhandene nutzen
			if (!window.apf.IdealBiotopÜbereinst_html) {
				var getIdealbiotopübereinst = $.ajax({
					type: 'get',
					url: 'php/idealbiotopuebereinst.php',
					dataType: 'json'
				});
				getIdealbiotopübereinst.always(function(data5) {
					if (data5) {
						// Feld mit Daten beliefern
						var html;
						html = "<option></option>";
                        _.each(data5.rows, function(übereinst) {
                            html += "<option value=\"" + übereinst.id + "\">" + übereinst.DomainTxt + "</option>";
                        });
						window.apf.IdealBiotopÜbereinst_html = html;
						$("#TPopKontrIdealBiotopUebereinst")
                            .html(html)
                            .val(window.apf.tpopfeldkontr.TPopKontrIdealBiotopUebereinst);
					}
				});
			} else {
				$("#TPopKontrIdealBiotopUebereinst")
                    .html(window.apf.IdealBiotopÜbereinst_html)
                    .val(window.apf.tpopfeldkontr.TPopKontrIdealBiotopUebereinst);
			}
			// Felder, die nur in freiwkontr vorkommen
			if (localStorage.tpopfreiwkontr) {
				if (data.TPopKontrPlan == 1) {
					$("#TPopKontrPlan").prop("checked", true);
				} else {
					$("#TPopKontrPlan").prop("checked", false);
				}
				$("#TPopKontrUebFlaeche").val(data.TPopKontrUebFlaeche);
				$("#TPopKontrUebPfl").val(data.TPopKontrUebPfl);
				$("#TPopKontrNaBo").val(data.TPopKontrNaBo);
				$TPopKontrJungPflJN_ja.prop("checked", false);
				$TPopKontrJungPflJN_nein.prop("checked", false);
				$TPopKontrJungPflJN_leer.prop("checked", false);
				if (data.TPopKontrJungPflJN == 1) {
					$TPopKontrJungPflJN_ja.prop("checked", true);
				} else if (data.TPopKontrJungPflJN == 0) {
					$TPopKontrJungPflJN_nein.prop("checked", true);
				} else {
					$TPopKontrJungPflJN_leer.prop("checked", true);
				}
				$("#TPopKontrVegHoeMax").val(data.TPopKontrVegHoeMax);
				$("#TPopKontrVegHoeMit").val(data.TPopKontrVegHoeMit);
				$("#TPopKontrGefaehrdung")
                    .val(data.TPopKontrGefaehrdung)
                    .limiter(255, $("#TPopKontrGefaehrdung_limit"));
			}
			// fieldcontain-divs der benötigten Felder einblenden
			if (localStorage.tpopfreiwkontr) {
                _.each(window.apf.feldliste_freiwkontr, function(feld) {
                    $("#fieldcontain_" + feld).show();
                });
			} else {
                _.each(window.apf.feldliste_feldkontr, function(feld) {
                    $("#fieldcontain_" + feld).show();
                });
			}
			// Formulare blenden
			window.apf.zeigeFormular("tpopfeldkontr");
			if (!localStorage.tpopfreiwkontr) {
				history.replaceState({tpopfeldkontr: "tpopfeldkontr"}, "tpopfeldkontr", "index.html?ap=" + localStorage.ap_id + "&pop=" + localStorage.pop_id + "&tpop=" + localStorage.tpop_id + "&tpopfeldkontr=" + localStorage.tpopfeldkontr_id);
			} else {
				history.replaceState({tpopfreiwkontr: "tpopfreiwkontr"}, "tpopfreiwkontr", "index.html?ap=" + localStorage.ap_id + "&pop=" + localStorage.pop_id + "&tpop=" + localStorage.tpop_id + "&tpopfreiwkontr=" + localStorage.tpopfeldkontr_id);
			}
			// Register in Feldkontr blenden
			if (localStorage.tpopfreiwkontr) {
				$("#tpopfeldkontr_tabs_biotop").hide();
				$("#biotop_tab_li").hide();
				$("#tpopfeldkontr_tabs").tabs("option", "active", 0);
			} else {
				$("#tpopfeldkontr_tabs_biotop").show();
				$("#biotop_tab_li").show();
				// Dieses Element wird fälschlicherweise in Entwicklung eingeblendet
				// keine Ahnung wieso
				// ausblenden!
				$("#tpopfeldkontr_tabs_biotop").hide();
			}
			// Fokus steuern
            $TPopKontrJahr.focus();
			$(window).scrollTop(0);
		}
	});
};

// setzt window.apf.tpopfeldkontr und localStorage.tpopfeldkontr_id
// wird benötigt, wenn beim App-Start direkt ein deep link geöffnet wird
window.apf.setzeWindowTpopfeldkontr = function(id) {
	'use strict';
	localStorage.tpopfeldkontr_id = id;
	var getTpopfeldkontr = $.ajax({
		type: 'get',
		url: 'php/tpopfeldkontr.php',
		dataType: 'json',
		data: {
			"id": localStorage.tpopfeldkontr_id
		}
	});
	getTpopfeldkontr.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// tpopfeldkontr bereitstellen
			window.apf.tpopfeldkontr = data;
		}
	});
};

window.apf.initiiere_tpopmassn = function() {
	'use strict';
	if (!localStorage.tpopmassn_id) {
		// es fehlen benötigte Daten > eine Ebene höher
		window.apf.initiiere_pop();
		return;
	}
	// Felder zurücksetzen
	window.apf.leereFelderVonFormular("tpopmassn");
	// Daten für die pop aus der DB holen
	var getTPopMassn = $.ajax({
		type: 'get',
		url: 'php/tpopmassn.php',
		dataType: 'json',
		data: {
			"id": localStorage.tpopmassn_id
		}
	});
	getTPopMassn.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// tpopmassn bereitstellen
			window.apf.tpopmassn = data;
			// Felder mit Daten beliefern
			// für select TPopMassnTyp Daten holen - oder vorhandene nutzen
			if (!window.apf.tpopmassntyp_html) {
				var getTPopMassnTyp = $.ajax({
					type: 'get',
					url: 'php/tpopmassn_typ.php',
					dataType: 'json'
				});
				getTPopMassnTyp.always(function(data2) {
					if (data2) {
						// tpopmassn_typ bereitstellen
						window.apf.tpopmassn_typ = data2;
						// Feld mit Daten beliefern
						var html;
						html = "<option></option>";
                        _.each(data2.rows, function(tpopmassn_typ) {
                            html += "<option value=\"" + tpopmassn_typ.id + "\">" + tpopmassn_typ.MassnTypTxt + "</option>";
                        });
						window.apf.tpopmassntyp_html = html;
						$("#TPopMassnTyp")
                            .html(html)
                            .val(window.apf.tpopmassn.TPopMassnTyp);
					}
				});
			} else {
				$("#TPopMassnTyp")
                    .html(window.apf.tpopmassntyp_html)
                    .val(window.apf.tpopmassn.TPopMassnTyp);
			}
			$("#TPopMassnTxt")
                .val(data.TPopMassnTxt)
                .limiter(255, $("#TPopMassnTxt_limit"));
			$("#TPopMassnJahr").val(data.TPopMassnJahr);
			if (data.TPopMassnDatum !== "01.01.1970") {
				// php macht aus einem Nullwert im Datum den 1.1.1970!!!
				$("#TPopMassnDatum").val(data.TPopMassnDatum);
			} else {
				$("#TPopMassnDatum").val("");
			}
			// TPopMassnBearb: Daten holen - oder vorhandene nutzen
			if (!window.apf.adressen_html) {
				var getAdressen = $.ajax({
					type: 'get',
					url: 'api/adressen',
					dataType: 'json'
				});
				getAdressen.always(function(data2) {
					if (data2) {
						// Feld mit Daten beliefern
						var html;
						html = "<option></option>";
                        _.each(data2, function(adresse) {
                            html += "<option value=\"" + adresse.id + "\">" + adresse.AdrName + "</option>";
                        });
						window.apf.adressen_html = html;
						$("#TPopMassnBearb")
                            .html(html)
                            .val(window.apf.tpopmassn.TPopMassnBearb);
					}
				});
			} else {
				$("#TPopMassnBearb")
                    .html(window.apf.adressen_html)
                    .val(window.apf.tpopmassn.TPopMassnBearb);
			}
			$("#TPopMassnBemTxt").val(data.TPopMassnBemTxt);
			if (data.TPopMassnPlan == 1) {
				$("#TPopMassnPlan").prop("checked", true);
			} else {
				$("#TPopMassnPlan").prop("checked", false);
			}
			$("#TPopMassnPlanBez")
                .val(data.TPopMassnPlanBez)
                .limiter(255, $("#TPopMassnPlanBez_limit"));
			$("#TPopMassnFlaeche").val(data.TPopMassnFlaeche);
			$("#TPopMassnAnsiedForm")
                .val(data.TPopMassnAnsiedForm)
                .limiter(255, $("#TPopMassnAnsiedForm_limit"));
			$("#TPopMassnAnsiedPflanzanordnung")
                .val(data.TPopMassnAnsiedPflanzanordnung)
                .limiter(255, $("#TPopMassnAnsiedPflanzanordnung_limit"));
			$("#TPopMassnMarkierung")
                .val(data.TPopMassnMarkierung)
                .limiter(255, $("#TPopMassnMarkierung_limit"));
			$("#TPopMassnAnsiedAnzTriebe").val(data.TPopMassnAnsiedAnzTriebe);
			$("#TPopMassnAnsiedAnzPfl").val(data.TPopMassnAnsiedAnzPfl);
			$("#TPopMassnAnzPflanzstellen").val(data.TPopMassnAnzPflanzstellen);
			// für TPopMassnAnsiedWirtspfl wurde die Artliste schon bereitgestellt
			// wenn die Anwendung direkt auf einer TPopMassn geöffnet wird, ist die Liste noch nicht bereit
			// darum hier nochmals holen
			$.when(window.apf.erstelle_artlisten())
				.then(function() {
					$("#TPopMassnAnsiedWirtspfl").val(data.TPopMassnAnsiedWirtspfl);
					$("#TPopMassnAnsiedHerkunftPop")
                        .val(data.TPopMassnAnsiedHerkunftPop)
                        .limiter(255, $("#TPopMassnAnsiedHerkunftPop_limit"));
					$("#TPopMassnAnsiedDatSamm")
                        .val(data.TPopMassnAnsiedDatSamm)
                        .limiter(50, $("#TPopMassnAnsiedDatSamm_limit"));
					$("#TPopMassnGuid").val(data.TPopMassnGuid);
					// Formulare blenden
					window.apf.zeigeFormular("tpopmassn");
					history.replaceState({tpopmassn: "tpopmassn"}, "tpopmassn", "index.html?ap=" + localStorage.ap_id + "&pop=" + localStorage.pop_id + "&tpop=" + localStorage.tpop_id + "&tpopmassn=" + localStorage.tpopmassn_id);
					// bei neuen Datensätzen Fokus steuern
					$('#TPopMassnJahr').focus();
				});	
		}
	});
};

// setzt window.apf.tpopmassn und localStorage.tpopmassn_id
// wird benötigt, wenn beim App-Start direkt ein deep link geöffnet wird
window.apf.setzeWindowTpopmassn = function(id) {
	'use strict';
	localStorage.tpopmassn_id = id;
	var getTPopMassn = $.ajax({
		type: 'get',
		url: 'php/tpopmassn.php',
		dataType: 'json',
		data: {
			"id": localStorage.tpopmassn_id
		}
	});
	getTPopMassn.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// tpopmassn bereitstellen
			window.apf.tpopmassn = data;
		}
	});
};

window.apf.initiiere_tpopmassnber = function() {
	'use strict';
	if (!localStorage.tpopmassnber_id) {
		// es fehlen benötigte Daten > eine Ebene höher
		window.apf.initiiere_pop();
		return;
	}
	// Felder zurücksetzen
	window.apf.leereFelderVonFormular("tpopmassnber");
	// Daten für die pop aus der DB holen
	var getTPopMassnBer = $.ajax({
		type: 'get',
		url: 'php/tpopmassnber.php',
		dataType: 'json',
		data: {
			"id": localStorage.tpopmassnber_id
		}
	});
	getTPopMassnBer.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// tpopmassnber bereitstellen
			window.apf.tpopmassnber = data;
			// Felder mit Daten beliefern
			$("#TPopMassnBerJahr").val(data.TPopMassnBerJahr);
			$("#TPopMassnBerErfolgsbeurteilung" + data.TPopMassnBerErfolgsbeurteilung).prop("checked", true);
			$("#TPopMassnBerTxt").val(data.TPopMassnBerTxt);
			// Formulare blenden
			window.apf.zeigeFormular("tpopmassnber");
			history.replaceState({tpopmassnber: "tpopmassnber"}, "tpopmassnber", "index.html?ap=" + localStorage.ap_id + "&pop=" + localStorage.pop_id + "&tpop=" + localStorage.tpop_id + "&tpopmassnber=" + localStorage.tpopmassnber_id);
			// bei neuen Datensätzen Fokus steuern
			$('#TPopMassnBerJahr').focus();
		}
	});
};

// setzt window.apf.tpopmassnber und localStorage.tpopmassnber_id
// wird benötigt, wenn beim App-Start direkt ein deep link geöffnet wird
window.apf.setzeWindowTpopmassnber = function(id) {
	'use strict';
	localStorage.tpopmassnber_id = id;
	var getTPopMassnBer = $.ajax({
		type: 'get',
		url: 'php/tpopmassnber.php',
		dataType: 'json',
		data: {
			"id": localStorage.tpopmassnber_id
		}
	});
	getTPopMassnBer.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// tpopmassnber bereitstellen
			window.apf.tpopmassnber = data;
		}
	});
};

window.apf.initiiereTpopber = function() {
	'use strict';
	if (!localStorage.tpopber_id) {
		// es fehlen benötigte Daten > eine Ebene höher
		window.apf.initiiere_pop();
		return;
	}
	// Felder zurücksetzen
	window.apf.leereFelderVonFormular("tpopber");
	// Daten für die tpopber aus der DB holen
	var getTPopBer = $.ajax({
		type: 'get',
		url: 'php/tpopber.php',
		dataType: 'json',
		data: {
			"id": localStorage.tpopber_id
		}
	});
	getTPopBer.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// tpopber bereitstellen
			window.apf.tpopber = data;
			// Felder mit Daten beliefern
			$("#TPopBerJahr").val(data.TPopBerJahr);
			$("#TPopBerEntwicklung" + data.TPopBerEntwicklung).prop("checked", true);
			$("#TPopBerTxt").val(data.TPopBerTxt);
			// Formulare blenden
			window.apf.zeigeFormular("tpopber");
			history.replaceState({tpopber: "tpopber"}, "tpopber", "index.html?ap=" + localStorage.ap_id + "&pop=" + localStorage.pop_id + "&tpop=" + localStorage.tpop_id + "&tpopber=" + localStorage.tpopber_id);
			// bei neuen Datensätzen Fokus steuern
			$('#TPopBerJahr').focus();
		}
	});
};

// setzt window.apf.tpopber und localStorage.tpopber_id
// wird benötigt, wenn beim App-Start direkt ein deep link geöffnet wird
window.apf.setzeWindowTpopber = function(id) {
	'use strict';
	localStorage.tpopber_id = id;
	var getTPopBer = $.ajax({
		type: 'get',
		url: 'php/tpopber.php',
		dataType: 'json',
		data: {
			"id": localStorage.tpopber_id
		}
	});
	getTPopBer.always(function(data) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data) {
			// tpopber bereitstellen
			window.apf.tpopber = data;
		}
	});
};

window.apf.initiiere_beob = function(beobtyp, beobid, beob_status, ohne_zu_zeigen) {
	'use strict';
	// beob_status markiert, ob die Beobachtung:
	// - schon zugewiesen ist (zugeordnet)
	// - noch nicht beurteilt ist (nicht_beurteilt)
	// - nicht zuzuordnen ist (nicht_zuzuordnen)
	// beob_status muss gespeichert werden, damit bei Datenänderungen bekannt ist, ob ein bestehender Datensatz bearbeitet oder ein neuer geschaffen werden muss
	localStorage.beob_status = beob_status;
	// sicherstellen, dass beobtyp immer bekannt ist
	localStorage.beobtyp = beobtyp;

	var url, url_distzutpop;
	if (!beobid && !ohne_zu_zeigen) {
		// es fehlen benötigte Daten > eine Ebene höher
		if (beob_status === "nicht_beurteilt" || beob_status === "nicht_zuzuordnen") {
			window.apf.initiiere_ap();
		} else {
			window.apf.initiiere_pop();
		}
		return;
	}

    // beobid hat meist 'beob' vorangestellt - entfernen!
    if (beobid.indexOf('beob') > -1) {
        beobid = beobid.replace('beob', '');
    }
    // beobid bereitstellen
    localStorage.beob_id = beobid;
	
	// EvAB oder Infospezies? > entsprechende url zusammensetzen
	url = 'php/beob_' + beobtyp + '.php';
	
	// Daten für die beob aus der DB holen
	var getBeob = $.ajax({
            type: 'get',
            url: url,
            dataType: 'json',
            data: {
                "id": beobid
            }
        }),
        $BeobBemerkungen = $("#BeobBemerkungen");

	getBeob.always(function(data_beob) {
		// Rückgabewert null wird offenbar auch als success gewertet, gibt weiter unten Fehler, also Ausführung verhindern
		if (data_beob) {

			// boebfelder bereitstellen
			var html_beobfelder = window.apf.erstelleFelderFürBeob(data_beob, beobtyp);
			$("#beob_table").html(html_beobfelder);
			
			// Abstand zu TPop aus der DB holen
			url_distzutpop = 'php/beob_distzutpop_' + beobtyp + '.php';
			var getDistZuTPop = $.ajax({
				type: 'get',
				url: url_distzutpop,
				dataType: 'json',
				data: {
					"beobid": beobid
				}
			});
			getDistZuTPop.always(function(data) {
				// Tabellenzeile beginnen
				var html_distzutpop = '<tr class="fieldcontain DistZuTPop"><td class="label"><label id="DistZuTPop_label" for="DistZuTPop">Einer Teilpopulation zuordnen:</label></td><td class="Datenfelder"><div class="Datenfelder" id="DistZuTPop_Felder">';
				if (data) {
                    _.each(data, function(beob, index) {
                        if (index>0) {
                            html_distzutpop += "<br>";
                        }
                        html_distzutpop += '<input type="radio" name="DistZuTPop" id="DistZuTPop';
                        html_distzutpop += beob.TPopId;
                        html_distzutpop += '" class="DistZuTPop" formular="beob" value="';
                        html_distzutpop += beob.TPopId;
                        html_distzutpop += '" DistZuTPop="';
                        html_distzutpop += beob.DistZuTPop;
                        html_distzutpop += '">';
                        // Wenn TPop keine Koordinaten haben, dies anzeigen und Anzeige von NAN verhindern
                        if (parseInt(beob.DistZuTPop, 10) >= 0) {
                            html_distzutpop += parseInt(beob.DistZuTPop) + "m: " + beob.TPopFlurname;
                        } else {
                            html_distzutpop += beob.TPopFlurname;
                        }
                    });
					// Tabellenzeile abschliessen
					html_distzutpop += '</div></td></tr>';

					// distzutpop bereitstellen
					$("#beob_zuordnungsfelder").html(html_distzutpop);

                    $BeobBemerkungen.attr("placeholder", "");

					if (beob_status !== "nicht_beurteilt") {
						// Daten der Zuordnung holen
						var getBeobZuordnung = $.ajax({
							type: 'get',
							url: 'php/beob_zuordnung.php',
							dataType: 'json',
							data: {
								"id": beobid
							}
						});
						getBeobZuordnung.always(function(data) {
							// Felder mit Daten beliefern
							$("#BeobNichtBeurteilt").prop("checked", false);
							if (data.BeobNichtZuordnen == 1) {
								$("#BeobNichtZuordnen").prop("checked", true);
							} else {
								$("#BeobNichtZuordnen").prop("checked", false);
							}
							$("#DistZuTPop"+data.TPopId).prop("checked", true);
							$("#BeobBemerkungen").val(data.BeobBemerkungen);
							$("#BeobMutWann").val(data.BeobMutWann);
							$("#BeobMutWer").val(data.BeobMutWer);

							// Formulare blenden
							// nur, wenn ohne_zu_zeigen nicht true ist (true, um in dialog anzuzeigen)
							if (!ohne_zu_zeigen) {
								window.apf.zeigeFormular("beob");
								if (beob_status === "zugeordnet") {
									history.replaceState({beob_zugeordnet: "beob_zugeordnet"}, "beob_zugeordnet", "index.html?ap=" + localStorage.ap_id + "&pop=" + localStorage.pop_id + "&tpop=" + localStorage.tpop_id + "&beob_zugeordnet=" + beobid);
								} else if (beob_status === "nicht_zuzuordnen") {
									history.replaceState({beob_nicht_zuzuordnen: "beob_nicht_zuzuordnen"}, "beob_nicht_zuzuordnen", "index.html?ap=" + localStorage.ap_id + "&beob_nicht_zuzuordnen=" + beobid);
								}
							}
						});
					} else {
						// beob_status ist "nicht beurteilt"
						$("#BeobNichtBeurteilt").prop("checked", true);
						$("#BeobNichtZuordnen").prop("checked", false);
						// allfällige im letzen beob enthaltene Werte entfernen
                        $BeobBemerkungen
                            .val("")
                            .attr("placeholder", "Bemerkungen sind nur in zugeordneten oder nicht zuzuordnenden Beobachtungen möglich");
						// Formulare blenden
						// nur, wenn ohne_zu_zeigen nicht true ist (true, um in dialog anzuzeigen)
						if (!ohne_zu_zeigen) {
							window.apf.zeigeFormular("beob");
							history.replaceState({beob_nicht_beurteilt: "beob_nicht_beurteilt"}, "beob_nicht_beurteilt", "index.html?ap=" + localStorage.ap_id + "&beob_nicht_beurteilt=" + beobid);
						}
					}
				}
			});
		}
	});
};

window.apf.initiiere_exporte = function(anchor) {
	'use strict';
	$("#testart_div").hide();
	$("#forms_titelzeile").hide();
	window.apf.zeigeFormular("exporte");
	history.replaceState({ex: "ex"}, "ex", "index.html?exporte=true");
	if (anchor) {
		location.hash = "#" + anchor;
	}
};

// managed die Sichtbarkeit von Formularen
// wird von allen initiiere_-Funktionen verwendet
// wird ein Formularname übergeben, wird dieses Formular gezeigt
// und alle anderen ausgeblendet
// zusätzlich wird die Höhe von textinput-Feldern an den Textinhalt angepasst
window.apf.zeigeFormular = function(Formularname) {
	'use strict';
	var formular_angezeigt = $.Deferred(),
        $forms = $("#forms"),
        $form = $('form'),
        $testart_div = $("#testart_div"),
        $forms_titelzeile = $("#forms_titelzeile"),
        $ap_waehlen = $("#ap_waehlen"),
        $Formularname;
	// zuerst alle Formulare ausblenden
    $forms.hide();
    $form.each(function() {
		$(this).hide();
	});
	// Karten sind in div statt form
	$('.karte').each(function() {
		$(this).hide();
	});

	// damit kann bei Grössenänderung die Formularhöhe von Karten gemanagt werden
	window.apf.kartenhöhe_manuell = false;
	// höhe von forms auf auto setzen, weil dies von den Kartenansichten verändert wird
    $forms.height('auto');
    $testart_div.hide();
    $forms_titelzeile.hide();
	// Titelzeile anzeigen, weil sie für die Kartenanzeige entfernt wird
	//$("#forms_titelzeile").css("display", "inline-block");
	// Bei Testarten Hinweis anzeigen
	if ($ap_waehlen.val()) {
		// titelzeile inline, sonst gibt es einen unschönen Abstand nach oben
		//$("#forms_titelzeile").css("display", "inline");
        $forms_titelzeile.css("display", "none");
		if ($ap_waehlen.val() <= 150 && Formularname !== "jber_uebersicht" && Formularname !== "exporte" && Formularname !== "GeoAdminKarte") {
            // titelzeile inline-block, sonst werden Tabs nach rechts verschoben
            $("#forms_titelzeile").css("display", "inline-block");
            $testart_div
                .css("color", "#03970F")
                .show()
                .html("Das ist eine Testart - hier kann man alles ausprobieren!");
		} else if ($("#ap_waehlen").val() <= 150 && Formularname === "jber_uebersicht") {
            $("#forms_titelzeile").css("display", "inline-block");
            $testart_div
                .css("color", "#DF0303")
                .show()
                .html("Vorsicht: Die Übericht ist für alle Arten, daher HIER NICHT TESTEN");
		}
	}

	if (Formularname) {
        $forms.show();
		$("#ap_loeschen").show();
		$("#exportieren_1").hide();
		if (Formularname === "google_karte" || Formularname === "GeoAdminKarte") {
			// Titelzeile entfernen
			$("#forms_titelzeile").css("display", "none");
			// höhe einstellen
            $Formularname = $("#" + Formularname);
            $Formularname.css("height", $(window).height()-17 + "px");
			// markieren, dass die Formularhöhe anders gesetzt werden soll
			window.apf.kartenhöhe_manuell = true;
			window.apf.setzeKartenhöhe();
            $Formularname.show();
			if (Formularname === "GeoAdminKarte") {
				window.apf.initiiereOlmap();
			}
		} else {
            $forms.css("background-color", "#FFE");
            $form.each(function() {
				$(this).hide();
				if ($(this).attr("id") === Formularname) {
					$(this).show();
					$('textarea').each(function() {
						window.apf.fitTextareaToContent(this, document.documentElement.clientHeight);
					});
				}
			});
			$(window).scrollTop(0);
		}
		formular_angezeigt.resolve();
	}
	return formular_angezeigt.promise();
};

// leert alle Felder und stellt ihre Breite ein
window.apf.leereFelderVonFormular = function(Formular) {
	'use strict';
	$('#' + Formular + ' input[type="text"]').each(function(){
		$(this).val("");
	});
	$('#' + Formular + ' input[type="radio"]:checked').each(function(){
		$(this).prop('checked', false);
	});
	$('#' + Formular + ' select').each(function(){
		$(this).val("");
	});
};

// begrenzt die maximale Höhe des Baums auf die Seitenhöhe, wenn nötig
window.apf.setzeTreehöhe = function() {
	'use strict';
	if ($(window).width() > 1000) {
		if (($(".jstree-no-icons").height() + 157) > $(window).height()) {
			$("#tree").css("max-height", $(window).height() - 139);
		}
	} else {
		// Spalten sind untereinander. Baum 75px weniger hoch, damit Formulare immer erreicht werden können
		if (($(".jstree-no-icons").height() + 157) > $(window).height()-75) {
			$("#tree").css("max-height", $(window).height() - 220);
		}
	}
};

window.apf.setzeKartenhöhe = function() {
	'use strict';
    var lyt_max_height = window.apf.berechneOlmapLayertreeMaxhöhe,
    	forms_height,
    	max_width;
	// Formulare sind unbegrenzt hoch aber Karten sollen das nicht sein
	if (window.apf.kartenhöhe_manuell) {
		forms_height = $(window).height() - 17;
		max_width = $("#forms").width();
        // resizable neu rechnen lassen, sonst bleibt ga_karten_div in falscher Grösse
        // leider funktioniert das nicht wie gewünscht:
        // wenn der Benutzer die Grösse verändert hat, passt sich ga_karten_div nicht mehr richtig an Veränderungen des Bildschirms an...
        //$('.apf-resizable').resizable('destroy');
        //$('.apf-resizable').resizable();
        /*$('.apf-resizable').resizable({
        	maxWidth: max_width,
			maxHeight: forms_height
        });*/
		$("#forms").height(forms_height);
		$('#ga_karten_div')
			//.css('width', max_width)
			.css('max-width', max_width)
			//.css('height', forms_height)
			.css('max-height', forms_height);
		$('.apf-resizable').resizable();
		if (window.apf.olmap && window.apf.olmap.map) {
			window.apf.olmap.map.updateSize();
			// Maximalgrösse des Layertree begrenzen
            $('#olmap_layertree_layers').css('max-height', lyt_max_height);
        }
		if (typeof google !== "undefined" && google.maps && window.apf.gmap && window.apf.gmap.map !== undefined) {
			google.maps.event.trigger(window.apf.gmap.map, 'resize');
		}
	} else {
		$("#forms").height('auto');
	}
};

window.apf.olmap.blendeOlmapExportieren = function() {
    'use strict';
    var map_size,
        anz_kartenpixel,
        tooltip_title;
    map_size = window.apf.olmap.map.getSize();
    // resolution nicht berücksichtigen - das funktionierte nicht zuverlässig und gab Probleme
    anz_kartenpixel = /*window.apf.olmap.map.getView().getResolution() * */map_size[0] * map_size[1];
    if (anz_kartenpixel > 500000) {
        $('#olmap_exportieren').button("disable");
        tooltip_title = 'Karte als png herunterladen<br>Diese Funktion ist inaktiv<br>Um sie zu aktivieren, müssen Sie die Karte verkleinern<br>Packen Sie dazu die untere rechte Ecke und ziehen Sie sie nach oben links';
    } else {
        $('#olmap_exportieren').button("enable");
        tooltip_title = 'Karte als png herunterladen';
    }
    $("#olmap_exportieren_div").tooltip({
        tooltipClass: "tooltip-styling-hinterlegt",
        content: tooltip_title
    });
};

window.apf.berechneOlmapLayertreeMaxhöhe = function() {
    var lyt_max_height;
    if ($(window).width() > 1000) {
        lyt_max_height = $(window).height() - 115;
    } else {
        // Spalten sind untereinander
        lyt_max_height = 200;
    }
    return lyt_max_height;
};

(function($) {
	$.fn.hasScrollBar = function() {
		return this.get(0).scrollHeight > this.height();
	}
})(jQuery);

// setzt die Höhe von textareas so, dass der Text genau rein passt
window.apf.fitTextareaToContent = function(id, maxHeight) {
	'use strict';
   var text = id && id.style ? id : document.getElementById(id);
   if (!text)
	  return;

   /* Accounts for rows being deleted, pixel value may need adjusting */
   if (text.clientHeight == text.scrollHeight) {
	  text.style.height = "30px";
   }	   

   var adjustedHeight = text.clientHeight;
   if (!maxHeight || maxHeight > adjustedHeight) {
	  adjustedHeight = Math.max(text.scrollHeight, adjustedHeight);
	  if (maxHeight)
		 adjustedHeight = Math.min(maxHeight, adjustedHeight);
	  if (adjustedHeight > text.clientHeight)
		 text.style.height = adjustedHeight + "px";
   }
};

window.apf.erstelle_ap_liste = function(programm) {
	'use strict';
	var apliste_erstellt = $.Deferred(),
		getApliste = $.ajax({
			type: 'get',
			url: 'api/apliste/programm=' + programm,
			dataType: 'json'
		});
	getApliste.always(function(data) {
		var html;
		html = "<option></option>";
        _.each(data, function(ap) {
            html += "<option value=\"" + ap.id + "\">" + ap.ap_name + "</option>";
        });
		$("#ap_waehlen").html(html);
		apliste_erstellt.resolve();
	});
	return apliste_erstellt.promise();
};

window.apf.wähleApListe = function(programm) {
	'use strict';
	var apliste_gewählt = $.Deferred(),
        $ap_waehlen_label = $("#ap_waehlen_label"),
        $ap_waehlen = $("#ap_waehlen");
    $ap_waehlen_label.html("Daten werden aufbereitet...");
    $ap_waehlen.html("");
	$("#ap").hide();
	$("#forms").hide();
	$('#tree').hide();
	$("#suchen").hide();
	$("#exportieren_2").hide();
	$("#hilfe").hide();
	$("#ap_loeschen").hide();
	$("#exportieren_1").show();
    $ap_waehlen.val("");
	window.apf.initiiere_ap();
	$.when(window.apf.erstelle_ap_liste(programm))
		.then(function() {
            var $programm_wahl_checked = $("[name='programm_wahl']:checked");
			if ($programm_wahl_checked.attr("id") === "programm_neu") {
                $ap_waehlen_label.html("Art für neues Förderprogramm wählen:");
			} else if ($programm_wahl_checked.attr("id") === "programm_ap") {
                $ap_waehlen_label.html("Aktionsplan wählen:");
			} else {
                $ap_waehlen_label.html("Artförderprogramm wählen:");
			}
            $ap_waehlen_label.show();
			apliste_gewählt.resolve();
		});
	return apliste_gewählt.promise();
};

window.apf.erstelle_tree = function(ApArtId) {
	'use strict';
	var jstree_erstellt = $.Deferred();
	$("#tree").jstree({
		"json_data": {
			"ajax": {
				"url": "api/tree/ap=" + ApArtId,
				"progressive_render": true
			}
		},
		"core": {
			"open_parents": true,	// wird ein node programmatisch geöffnet, öffnen sich alle parents
			"strings": {	// Deutsche Übersetzungen
				"loading": "hole Daten...",
				"new_node": "neuer Knoten"
			}
		},
		"ui": {
			"select_limit": 1,	// nur ein Datensatz kann aufs mal gewählt werden
			"selected_parent_open": true,	// wenn Code einen node wählt, werden alle parents geöffnet
			"select_prev_on_delete": true
		},
		"search": {
			"case_insensitive": true
		},
		"sort": function(a, b) {
			if ($(a).attr("sort") && $(b).attr("sort")) {
				return parseInt($(a).attr("sort"), 10) > parseInt($(b).attr("sort"), 10) ? 1 : -1;
			}
		},
		"themes": {
			"icons": false
		},
		"contextmenu": {
			"items": window.apf.treeKontextmenu,
			"select_node": true
		},
		"crrm": {
			"move": {
				"default_position": "first",
				"check_move": function(m) {
					// hier wird bestimmt, welche drag-drop-Kombinationen zulässig sind
					if (m.o.attr("typ") === "pop") {
						if (m.r.attr("typ") === "pop") {
							return {
								after: true,
								before: true,
								inside: false
							};
						} else {
							return false;
						}
					} else if (m.o.attr("typ") === "tpop") {
						if (m.r.attr("typ") === "tpop") {
							return {
								after: true,
								before: true,
								inside: false
							};
						} else if (m.r.attr("typ") === "pop_ordner_tpop") {
							return {
								after: false,
								before: false,
								inside: true
							};
						} else {
							return false;
						}
					} else if (m.o.attr("typ") === "tpopmassn") {
						if (m.r.attr("typ") === "tpopmassn") {
							return {
								after: true,
								before: true,
								inside: false
							};
						} else if (m.r.attr("typ") === "tpop_ordner_massn") {
							return {
								after: false,
								before: false,
								inside: true
							};
						} else {
							return false;
						}
					} else if (m.o.attr("typ") === "tpopfeldkontr") {
						if (m.r.attr("typ") === "tpopfeldkontr") {
							return {
								after: true,
								before: true,
								inside: false
							};
						} else if (m.r.attr("typ") === "tpop_ordner_feldkontr") {
							return {
								after: false,
								before: false,
								inside: true
							};
						} else {
							return false;
						}
					} else if (m.o.attr("typ") === "tpopfreiwkontr") {
						if (m.r.attr("typ") === "tpopfreiwkontr") {
							return {
								after: true,
								before: true,
								inside: false
							};
						} else if (m.r.attr("typ") === "tpop_ordner_freiwkontr") {
							return {
								after: false,
								before: false,
								inside: true
							};
						} else {
							return false;
						}
					} else if (m.o.attr("typ") === "beob_zugeordnet") {
						if (m.r.attr("typ") === "beob_zugeordnet") {
							return {
								after: true,
								before: true,
								inside: false
							};
						} else if (m.r.attr("typ") === "tpop_ordner_beob_zugeordnet") {
							return {
								after: false,
								before: false,
								inside: true
							};
						} else if (m.r.attr("typ") === "ap_ordner_beob_nicht_beurteilt") {
							return {
								after: false,
								before: false,
								inside: true
							};
						} else if (m.r.attr("typ") === "beob_nicht_beurteilt") {
							return {
								after: true,
								before: true,
								inside: false
							};
						} else if (m.r.attr("typ") === "ap_ordner_beob_nicht_zuzuordnen") {
							return {
								after: false,
								before: false,
								inside: true
							};
						} else if (m.r.attr("typ") === "beob_nicht_zuzuordnen") {
							return {
								after: true,
								before: true,
								inside: false
							};
						} else {
							return false;
						}
					} else if (m.o.attr("typ") === "beob_nicht_beurteilt") {
						if (m.r.attr("typ") === "beob_zugeordnet") {
							return {
								after: true,
								before: true,
								inside: false
							};
						} else if (m.r.attr("typ") === "tpop_ordner_beob_zugeordnet") {
							return {
								after: false,
								before: false,
								inside: true
							};
						} else if (m.r.attr("typ") === "ap_ordner_beob_nicht_beurteilt") {
							return {
								after: false,
								before: false,
								inside: true
							};
						} else if (m.r.attr("typ") === "beob_nicht_beurteilt") {
							return {
								after: true,
								before: true,
								inside: false
							};
						} else if (m.r.attr("typ") === "ap_ordner_beob_nicht_zuzuordnen") {
							return {
								after: false,
								before: false,
								inside: true
							};
						} else if (m.r.attr("typ") === "beob_nicht_zuzuordnen") {
							return {
								after: true,
								before: true,
								inside: false
							};
						} else {
							return false;
						}
					} else if (m.o.attr("typ") === "beob_nicht_zuzuordnen") {
						if (m.r.attr("typ") === "beob_zugeordnet") {
							return {
								after: true,
								before: true,
								inside: false
							};
						} else if (m.r.attr("typ") === "tpop_ordner_beob_zugeordnet") {
							return {
								after: false,
								before: false,
								inside: true
							};
						} else if (m.r.attr("typ") === "ap_ordner_beob_nicht_beurteilt") {
							return {
								after: false,
								before: false,
								inside: true
							};
						} else if (m.r.attr("typ") === "beob_nicht_beurteilt") {
							return {
								after: true,
								before: true,
								inside: false
							};
						} else if (m.r.attr("typ") === "ap_ordner_beob_nicht_zuzuordnen") {
							return {
								after: false,
								before: false,
								inside: true
							};
						} else if (m.r.attr("typ") === "beob_nicht_zuzuordnen") {
							return {
								after: true,
								before: true,
								inside: false
							};
						} else {
							return false;
						}
					}
					return false;
				}
			}
		},
		"types": {
			"type_attr": "typ",
			"max_children": -2,
			"max_depth": -2,
			"valid_children": ["ap_ordner_pop", "ap_ordner_apziel", "ap_ordner_erfkrit", "ap_ordner_jber", "ap_ordner_ber", "ap_ordner_beob_nicht_beurteilt", "ap_ordner_beob_nicht_zuzuordnen", "idealbiotop", "ap_ordner_assozarten"],
			"types": {
				"ap_ordner_pop": {
					"valid_children": "pop"
				},
				"pop": {
					"valid_children": ["pop_ordner_tpop", "pop_ordner_popber", "pop_ordner_massnber"],
					"new_node": "neue Population"
				},
				"pop_ordner_tpop": {
					"valid_children": "tpop"
				},
				"tpop": {
					"valid_children": ["tpop_ordner_massn", "tpop_ordner_massnber", "tpop_ordner_feldkontr", "tpop_ordner_freiwkontr", "tpop_ordner_tpopber", "tpop_ordner_beob_zugeordnet"],
					"new_node": "neue Teilpopulation"
				},
				"tpop_ordner_massn": {
					"valid_children": "tpopmassn"
				},
				"tpopmassn": {
					"valid_children": "none",
					"new_node": "neue Massnahme"
				},
				"tpop_ordner_massnber": {
					"valid_children": "tpopmassnber"
				},
				"tpopmassnber": {
					"valid_children": "none",
					"new_node": "neuer Massnahmen-Bericht"
				},
				"tpop_ordner_feldkontr": {
					"valid_children": "tpopfeldkontr"
				},
				"tpopfeldkontr": {
					"valid_children": "none",
					"new_node": "neue Feldkontrolle"
				},
				"tpop_ordner_freiwkontr": {
					"valid_children": "tpopfreiwkontr"
				},
				"tpopfreiwkontr": {
					"valid_children": "none",
					"new_node": "neue Freiwilligen-Kontrolle"
				},
				"tpop_ordner_tpopber": {
					"valid_children": "tpopber"
				},
				"tpopber": {
					"valid_children": "none",
					"new_node": "neuer Teilpopulations-Bericht"
				},
				"tpop_ordner_beob_zugeordnet": {
					"valid_children": "beob_zugeordnet"
				},
				"beob_zugeordnet": {
					"valid_children": "none"
				},
				"pop_ordner_popber": {
					"valid_children": "popber"
				},
				"popber": {
					"valid_children": "none",
					"new_node": "neuer Populations-Bericht"
				},
				"pop_ordner_massnber": {
					"valid_children": "massnber"
				},
				"massnber": {
					"valid_children": "none",
					"new_node": "neuer Massnahmen-Bericht"
				},
				"ap_ordner_apziel": {
					"valid_children": "apzieljahr"
				},
				"apzieljahr": {
					"valid_children": "apziel"
				},
				"apziel": {
					"valid_children": "zielber_ordner",
					"new_node": "neues AP-Ziel"
				},
				"zielber_ordner": {
					"valid_children": "zielber"
				},
				"zielber": {
					"valid_children": "none",
					"new_node": "neuer Ziel-Bericht"
				},
				"ap_ordner_erfkrit": {
					"valid_children": "erfkrit"
				},
				"erfkrit": {
					"valid_children": "none",
					"new_node": "neues Erfolgskriterium"
				},
				"ap_ordner_jber": {
					"valid_children": "jber"
				},
				"jber": {
					"valid_children": "jber_uebersicht",
					"new_node": "neuer AP-Bericht"
				},
				"jber_uebersicht": {
					"valid_children": "none",
					"new_node": "neue Übersicht zu allen Arten"
				},
				"ap_ordner_ber": {
					"valid_children": "ber"
				},
				"ber": {
					"valid_children": "none",
					"new_node": "neuer Bericht"
				},
				"ap_ordner_beob_nicht_beurteilt": {
					"valid_children": "beob_nicht_beurteilt"
				},
				"beob_nicht_beurteilt": {
					"valid_children": "none"
				},
				"ap_ordner_beob_nicht_zuzuordnen": {
					"valid_children": "beob_nicht_zuzuordnen"
				},
				"beob_nicht_zuzuordnen": {
					"valid_children": "none"
				},
				"idealbiotop": {
					"valid_children": "none"
				},
				"ap_ordner_assozarten": {
					"valid_children": "assozarten"
				},
				"assozarten": {
					"valid_children": "none",
					"new_node": "neue assoziierte Art"
				}
			}
		},
		"plugins" : ["themes", "json_data", "ui", "hotkeys", "search", "contextmenu", "crrm", "types"]
		//"plugins" : ["themes", "json_data", "ui", "hotkeys", "search", "contextmenu", "crrm", "dnd", "types"]   // dnd ausgeschaltet, weil es Speichern verhindert im letzten Feld vor Klick in Baum
	})
	.show()
	.bind("loaded.jstree", function(event, data) {
		jstree_erstellt.resolve();
		window.apf.setzeTreehöhe();
		$("#suchen").show();
		$("#exportieren_2").show();
		$("#exportieren_1").hide();
		$("#hilfe").show();
		if (window.apf.pop_zeigen) {
			$("#tree").jstree("select_node", "[typ='pop']#" + localStorage.pop_id);
			// diese Markierung entfernen, damit das nächste mal nicht mehr diese Pop geöffnet wird
			delete window.apf.pop_zeigen;
		}
		if (window.apf.popber_zeigen) {
			$("#tree").jstree("select_node", "[typ='popber']#" + localStorage.popber_id);
			// diese Markierung entfernen, damit das nächste mal nicht mehr diese Popber geöffnet wird
			delete window.apf.popber_zeigen;
		}
		if (window.apf.popmassnber_zeigen) {
			$("#tree").jstree("select_node", "[typ='popmassnber']#" + localStorage.popmassnber_id);
			// diese Markierung entfernen, damit das nächste mal nicht mehr diese popmassnber geöffnet wird
			delete window.apf.popmassnber_zeigen;
		}
		if (window.apf.tpop_zeigen) {
			$("#tree").jstree("select_node", "[typ='tpop']#" + localStorage.tpop_id);
			// diese Markierung entfernen, damit das nächste mal nicht mehr diese TPop geöffnet wird
			delete window.apf.tpop_zeigen;
		}
		if (window.apf.tpopfeldkontr_zeigen) {
			$("#tree").jstree("select_node", "[typ='tpopfeldkontr']#" + localStorage.tpopfeldkontr_id);
			// diese Markierung entfernen, damit das nächste mal nicht mehr diese tpopfeldkontr geöffnet wird
			delete window.apf.tpopfeldkontr_zeigen;
		}
		if (window.apf.tpopfreiwkontr_zeigen) {
			$("#tree").jstree("select_node", "[typ='tpopfreiwkontr']#" + localStorage.tpopfeldkontr_id);
			// diese Markierung entfernen, damit das nächste mal nicht mehr diese tpopfreiwkontr geöffnet wird
			delete window.apf.tpopfreiwkontr_zeigen;
		}
		if (window.apf.tpopmassn_zeigen) {
			$("#tree").jstree("select_node", "[typ='tpopmassn']#" + localStorage.tpopmassn_id);
			// diese Markierung entfernen, damit das nächste mal nicht mehr diese tpopmassn geöffnet wird
			delete window.apf.tpopmassn_zeigen;
		}
		if (window.apf.tpopber_zeigen) {
			$("#tree").jstree("select_node", "[typ='tpopber']#" + localStorage.tpopber_id);
			// diese Markierung entfernen, damit das nächste mal nicht mehr diese tpopber geöffnet wird
			delete window.apf.tpopber_zeigen;
		}
		if (window.apf.beob_zugeordnet_zeigen) {
			$("#tree").jstree("select_node", "#beob" + localStorage.beob_id);
			// diese Markierung entfernen, damit das nächste mal nicht mehr diese beob_zugeordnet geöffnet wird
			delete window.apf.beob_zugeordnet_zeigen;
		}
		if (window.apf.tpopmassnber_zeigen) {
			$("#tree").jstree("select_node", "[typ='tpopmassnber']#" + localStorage.tpopmassnber_id);
			// diese Markierung entfernen, damit das nächste mal nicht mehr diese tpopmassnber geöffnet wird
			delete window.apf.tpopmassnber_zeigen;
		}
		if (window.apf.apziel_zeigen) {
			$("#tree").jstree("select_node", "[typ='apziel']#" + localStorage.apziel_id);
			// diese Markierung entfernen, damit das nächste mal nicht mehr diese apziel geöffnet wird
			delete window.apf.apziel_zeigen;
		}
		if (window.apf.zielber_zeigen) {
			$("#tree").jstree("select_node", "[typ='zielber']#" + localStorage.zielber_id);
			// diese Markierung entfernen, damit das nächste mal nicht mehr diese zielber geöffnet wird
			delete window.apf.zielber_zeigen;
		}
		if (window.apf.erfkrit_zeigen) {
			$("#tree").jstree("select_node", "[typ='erfkrit']#" + localStorage.erfkrit_id);
			// diese Markierung entfernen, damit das nächste mal nicht mehr diese erfkrit geöffnet wird
			delete window.apf.erfkrit_zeigen;
		}
		if (window.apf.jber_zeigen) {
			$("#tree").jstree("select_node", "[typ='jber']#" + localStorage.jber_id);
			// diese Markierung entfernen, damit das nächste mal nicht mehr diese jber geöffnet wird
			delete window.apf.jber_zeigen;
		}
		if (window.apf.jber_übersicht_zeigen) {
			$("#tree").jstree("select_node", "[typ='jber_uebersicht']#" + localStorage.jber_uebersicht_id);
			// diese Markierung entfernen, damit das nächste mal nicht mehr diese jber_uebersicht geöffnet wird
			delete window.apf.jber_übersicht_zeigen;
		}
		if (window.apf.ber_zeigen) {
			$("#tree").jstree("select_node", "[typ='ber']#" + localStorage.ber_id);
			// diese Markierung entfernen, damit das nächste mal nicht mehr diese ber geöffnet wird
			delete window.apf.ber_zeigen;
		}
		if (window.apf.idealbiotop_zeigen) {
			$("#tree").jstree("select_node", "[typ='idealbiotop']#" + localStorage.idealbiotop_id);
			// diese Markierung entfernen, damit das nächste mal nicht mehr diese idealbiotop geöffnet wird
			delete window.apf.idealbiotop_zeigen;
		}
		if (window.apf.assozarten_zeigen) {
			$("#tree").jstree("select_node", "[typ='assozarten']#" + localStorage.assozarten_id);
			// diese Markierung entfernen, damit das nächste mal nicht mehr diese assozarten geöffnet wird
			delete window.apf.assozarten_zeigen;
		}
		if (window.apf.beob_nicht_beurteilt_zeigen) {
			$("#tree").jstree("select_node", "#beob" + localStorage.beob_id);
			// diese Markierung entfernen, damit das nächste mal nicht mehr diese beob geöffnet wird
			delete window.apf.beob_nicht_beurteilt_zeigen;
		}
		if (window.apf.beob_nicht_zuzuordnen_zeigen) {
			$("#tree").jstree("select_node", "#beob" + localStorage.beob_id);
			// diese Markierung entfernen, damit das nächste mal nicht mehr diese beob geöffnet wird
			delete window.apf.beob_nicht_zuzuordnen_zeigen;
		}
		if (window.apf.ap_zeigen) {
			window.apf.initiiere_ap();
			// diese Markierung entfernen, damit das nächste mal nicht mehr dieser AP geöffnet wird
			delete window.apf.ap_zeigen;
		}
	})
	// auch auf Mobilgeräten soll das Kontextmenü zugänglich sein!
	.hammer().bind("hold doubletap", function(event) {
		// auf PC's verhindern: Menu erscheint sonst beim Scrollen
		if ($(window).width() < 1000) {
			setTimeout(function() {
				$("#tree").jstree('get_selected').children('a').trigger('contextmenu');
			}, 500);
		}
	})
	.bind("select_node.jstree", function(e, data) {
		var node;	
		delete localStorage.tpopfreiwkontr;	// Erinnerung an letzten Klick im Baum löschen
		node = data.rslt.obj;
		var node_typ = node.attr("typ");
		// in der ID des Nodes enthaltene Texte müssen entfernt werden
		var node_id = window.apf.erstelleIdAusDomAttributId(node.attr("id"));
		$.jstree._reference(node).open_node(node);
		if (node_typ.slice(0, 3) === "ap_" || node_typ === "apzieljahr") {
			// verhindern, dass bereits offene Seiten nochmals geöffnet werden
			if (!$("#ap").is(':visible') || localStorage.ap_id !== node_id) {
				localStorage.ap_id = node_id;
				delete localStorage.pop_id;
				window.apf.initiiere_ap();
			}
		} else if (node_typ === "pop" || node_typ.slice(0, 4) === "pop_") {
			// verhindern, dass bereits offene Seiten nochmals geöffnet werden
			if (!$("#pop").is(':visible') || localStorage.pop_id !== node_id) {
				localStorage.pop_id = node_id;
				window.apf.initiiere_pop();
			}
		} else if (node_typ === "apziel" || node_typ === "zielber_ordner") {
			// verhindern, dass bereits offene Seiten nochmals geöffnet werden
			if (!$("#apziel").is(':visible') || localStorage.apziel_id !== node_id) {
				localStorage.apziel_id = node_id;
				window.apf.initiiere_apziel();
			}
		} else if (node_typ === "zielber") {
			// verhindern, dass bereits offene Seiten nochmals geöffnet werden
			if (!$("#zielber").is(':visible') || localStorage.zielber_id !== node_id) {
				localStorage.zielber_id = node_id;
				window.apf.initiiere_zielber();
			}
		} else if (node_typ === "erfkrit") {
			// verhindern, dass bereits offene Seiten nochmals geöffnet werden
			if (!$("#erfkrit").is(':visible') || localStorage.erfkrit_id !== node_id) {
				localStorage.erfkrit_id = node_id;
				window.apf.initiiere_erfkrit();
			}
		} else if (node_typ === "jber") {
			// verhindern, dass bereits offene Seiten nochmals geöffnet werden
			if (!$("#jber").is(':visible') || localStorage.jber_id !== node_id) {
				localStorage.jber_id = node_id;
				window.apf.initiiere_jber();
			}
		} else if (node_typ === "jber_uebersicht") {
			// verhindern, dass bereits offene Seiten nochmals geöffnet werden
			if (!$("#jber_uebersicht").is(':visible') || localStorage.jber_uebersicht_id !== node_id) {
				localStorage.jber_uebersicht_id = node_id;
				window.apf.initiiere_jber_uebersicht();
			}
		} else if (node_typ === "ber") {
			// verhindern, dass bereits offene Seiten nochmals geöffnet werden
			if (!$("#ber").is(':visible') || localStorage.ber_id !== node_id) {
				localStorage.ber_id = node_id;
				window.apf.initiiere_ber();
			}
		} else if (node_typ === "idealbiotop") {
			// verhindern, dass bereits offene Seiten nochmals geöffnet werden
			if (!$("#idealbiotop").is(':visible')) {
				// eigene id nicht nötig
				// 1:1 mit ap verbunden, gleich id
				// wenn noch kein Datensatz existiert erstellt ihn window.apf.initiiere_idealbiotop
				window.apf.initiiere_idealbiotop();
			}
		} else if (node_typ === "assozarten") {
			// verhindern, dass bereits offene Seiten nochmals geöffnet werden
			if (!$("#assozarten").is(':visible') || localStorage.assozarten_id !== node_id) {
				localStorage.assozarten_id = node_id;
				window.apf.initiiere_assozarten();
			}
		} else if (node_typ === "popber") {
			// verhindern, dass bereits offene Seiten nochmals geöffnet werden
			if (!$("#popber").is(':visible') || localStorage.popber_id !== node_id) {
				localStorage.popber_id = node_id;
				window.apf.initiiere_popber();
			}
		} else if (node_typ === "popmassnber") {
			// verhindern, dass bereits offene Seiten nochmals geöffnet werden
			if (!$("#popmassnber").is(':visible') || localStorage.popmassnber_id !== node_id) {
				localStorage.popmassnber_id = node_id;
				window.apf.initiiere_popmassnber();
			}
		} else if (node_typ === "tpop" || node_typ.slice(0, 5) === "tpop_") {
			// verhindern, dass bereits offene Seiten nochmals geöffnet werden
			if (!$("#tpop").is(':visible') || localStorage.tpop_id !== node_id) {
				localStorage.tpop_id = node_id;
				window.apf.initiiere_tpop();
			}
		} else if (node_typ === "tpopfeldkontr") {
			// verhindern, dass bereits offene Seiten nochmals geöffnet werden
			if (!$("#tpopfeldkontr").is(':visible') || localStorage.tpopfeldkontr_id !== node_id) {
				localStorage.tpopfeldkontr_id = node_id;
				window.apf.initiiere_tpopfeldkontr();
			}
		} else if (node_typ === "tpopfreiwkontr") {
			// verhindern, dass bereits offene Seiten nochmals geöffnet werden
			if (!$("#tpopfeldkontr").is(':visible') || localStorage.tpopfeldkontr_id !== node_id) {
				localStorage.tpopfeldkontr_id = node_id;
				localStorage.tpopfreiwkontr = true;
				window.apf.initiiere_tpopfeldkontr();
			}
		} else if (node_typ === "tpopmassn") {
			// verhindern, dass bereits offene Seiten nochmals geöffnet werden
			if (!$("#tpopmassn").is(':visible') || localStorage.tpopmassn_id !== node_id) {
				localStorage.tpopmassn_id = node_id;
				window.apf.initiiere_tpopmassn();
			}
		} else if (node_typ === "tpopber") {
			// verhindern, dass bereits offene Seiten nochmals geöffnet werden
			if (!$("#tpopber").is(':visible') || localStorage.tpopber_id !== node_id) {
				localStorage.tpopber_id = node_id;
				window.apf.initiiereTpopber();
			}
		} else if (node_typ === "beob_zugeordnet") {
			// verhindern, dass bereits offene Seiten nochmals geöffnet werden
			if (!$("#beob").is(':visible') || localStorage.beob_id !== node_id || localStorage.beob_status !== "zugeordnet") {
				localStorage.beob_id = node_id;
				localStorage.beobtyp = node.attr("beobtyp");
				window.apf.initiiere_beob(node.attr("beobtyp"), node_id, "zugeordnet");
			}
		} else if (node_typ === "beob_nicht_beurteilt") {
			// verhindern, dass bereits offene Seiten nochmals geöffnet werden
			if (!$("#beob").is(':visible') || localStorage.beob_id !== node_id || localStorage.beob_status !== "nicht_beurteilt") {
				localStorage.beob_id = node_id;
				localStorage.beobtyp = node.attr("beobtyp");
				// den Beobtyp mitgeben
				window.apf.initiiere_beob(node.attr("beobtyp"), node_id, "nicht_beurteilt");
			}
		} else if (node_typ === "beob_nicht_zuzuordnen") {
			// verhindern, dass bereits offene Seiten nochmals geöffnet werden
			if (!$("#beob").is(':visible') || localStorage.beob_id !== node_id || localStorage.beob_status !== "nicht_zuzuordnen") {
				localStorage.beob_id = node_id;
				localStorage.beobtyp = node.attr("beobtyp");
				// den Beobtyp mitgeben
				window.apf.initiiere_beob(node.attr("beobtyp"), node_id, "nicht_zuzuordnen");
			}
		} else if (node_typ === "tpopmassnber") {
			// verhindern, dass bereits offene Seiten nochmals geöffnet werden
			if (!$("#tpopmassnber").is(':visible') || localStorage.tpopmassnber_id !== node_id) {
				localStorage.tpopmassnber_id = node_id;
				window.apf.initiiere_tpopmassnber();
			}
		}
	})
	.bind("after_open.jstree", function(e, data) {
		window.apf.setzeTreehöhe();
	})
	.bind("after_close.jstree", function(e, data) {
		window.apf.setzeTreehöhe();
	})
	.bind("prepare_move.jstree", function(e, data) {
		// herkunft_parent_node muss vor dem move ermittelt werden - danach ist der parent ein anderer!
		window.apf.herkunft_parent_node = $.jstree._reference(data.rslt.o)._get_parent(data.rslt.o);
	})
	.bind("create_node.jstree", function(e, data) {
		if (data.rslt.parent[0].attributes.typ.nodeValue === "apzieljahr") {
			var Objekt = {};
			Objekt.name = "ZielJahr";
			Objekt.formular = "apziel";
			window.apf.speichern(Objekt);
            $("#ZielJahr")
                .val(data.rslt.parent[0].innerText.slice(1, 5))
                .focus();
		}
	})
	.bind("move_node.jstree", function(e, data) {
		var herkunft_node,
			herkunft_node_id,
			herkunft_node_typ,
			ziel_node,
			ziel_node_id,
			ziel_node_typ,
			ziel_parent_node,
			ziel_parent_node_id;
		
		// nur aktualisieren, wenn Schreibrechte bestehen
		if (!window.apf.prüfeSchreibvoraussetzungen()) {
			return;
		}

		// Variablen setzen
		herkunft_node = data.rslt.o;
		herkunft_node_id = window.apf.erstelleIdAusDomAttributId($(herkunft_node).attr("id"));
		herkunft_node_typ = herkunft_node.attr("typ");
		ziel_node = data.rslt.r;
		ziel_node_id = window.apf.erstelleIdAusDomAttributId($(ziel_node).attr("id"));
		ziel_node_typ = ziel_node.attr("typ");
		ziel_parent_node = $.jstree._reference(data.rslt.r)._get_parent(data.rslt.r);
		if ($(ziel_parent_node).attr("id")) {
			ziel_parent_node_id = window.apf.erstelleIdAusDomAttributId($(ziel_parent_node).attr("id"));
		}

		if (herkunft_node_typ === "pop") {
			if (ziel_node_typ === "pop") {
				var fügePopEin = $.ajax({
					type: 'post',
					url: 'php/pop_einfuegen.php',
					dataType: 'json',
					data: {
						"ap_art_id": ziel_parent_node_id,
						"pop_id": ziel_node_id,
						"user": sessionStorage.User
					}
				});
				fügePopEin.always(function() {
					// Anzahlen anpassen der parent-nodes am Herkunfts- und Zielort
					window.apf.beschrifte_ordner_pop(ziel_parent_node);
					window.apf.beschrifte_ordner_pop(window.apf.herkunft_parent_node);
					// selection steuern
					$.jstree._reference(ziel_node).deselect_all();
					$.jstree._reference(herkunft_node).select_node(herkunft_node);
					// Variablen aufräumen
					localStorage.pop_id = herkunft_node_id;
					delete window.apf.pop;
					delete window.apf.herkunft_parent_node;
					window.apf.initiiere_pop();
				});
				fügePopEin.fail(function(data) {
					//window.apf.melde("Fehler: Die Teilpopulation wurde nicht verschoben");
					console.log("Fehler: Die Teilpopulation wurde nicht verschoben");
				});
			}
			if (ziel_node_typ === "tpop") {
				var fügeTPopEin = $.ajax({
					type: 'post',
					url: 'php/tpop_einfuegen.php',
					dataType: 'json',
					data: {
						"pop_id": ziel_parent_node_id,
						"tpop_id": ziel_node_id,
						"user": sessionStorage.User
					}
				});
				fügeTPopEin.always(function() {
					// Anzahlen anpassen der parent-nodes am Herkunfts- und Zielort
					window.apf.beschrifte_ordner_tpop(ziel_parent_node);
					window.apf.beschrifte_ordner_tpop(window.apf.herkunft_parent_node);
					// selection steuern
					$.jstree._reference(ziel_node).deselect_all();
					$.jstree._reference(herkunft_node).select_node(herkunft_node);
					// Variablen aufräumen
					localStorage.tpop_id = herkunft_node_id;
					delete window.apf.tpop;
					delete window.apf.tpop_node_ausgeschnitten;
					delete window.apf.herkunft_parent_node;
					window.apf.initiiere_tpop();
				});
				fügeTPopEin.fail(function(data) {
					//window.apf.melde("Fehler: Die Teilpopulation wurde nicht verschoben");
					console.log("Fehler: Die Teilpopulation wurde nicht verschoben");
				});
			}
			if (ziel_node_typ === "pop_ordner_tpop") {
				var fügeTPopEin_2 = $.ajax({
					type: 'post',
					url: 'php/tpop_einfuegen.php',
					dataType: 'json',
					data: {
						"pop_id": ziel_node_id,
						"tpop_id": herkunft_node_id,
						"user": sessionStorage.User
					}
				});
				fügeTPopEin_2.always(function() {
					// Anzahlen anpassen der parent-nodes am Herkunfts- und Zielort
					window.apf.beschrifte_ordner_tpop(ziel_node);
					window.apf.beschrifte_ordner_tpop(window.apf.herkunft_parent_node);
					// select steuern
					$.jstree._reference(ziel_node).deselect_all();
					$.jstree._reference(ziel_node).select_node(herkunft_node);
					// Variablen aufräumen
					localStorage.tpop_id = herkunft_node_id;
					delete window.apf.tpop;
					delete window.apf.tpop_node_ausgeschnitten;
					window.apf.initiiere_tpop();
				});
				fügeTPopEin_2.fail(function(data) {
					//window.apf.melde("Fehler: Die Teilpopulation wurde nicht verschoben");
					console.log("Fehler: Die Teilpopulation wurde nicht verschoben");
				});
			}
		}
		if (herkunft_node_typ === "tpop") {
			if (ziel_node_typ === "tpop") {
				var fügeTPopEin_3 = $.ajax({
					type: 'post',
					url: 'php/tpop_einfuegen.php',
					dataType: 'json',
					data: {
						"pop_id": ziel_parent_node_id,
						"tpop_id": herkunft_node_id,
						"user": sessionStorage.User
					}
				});
				fügeTPopEin_3.always(function() {
					// Anzahlen anpassen der parent-nodes am Herkunfts- und Zielort
					window.apf.beschrifte_ordner_tpop(ziel_parent_node);
					window.apf.beschrifte_ordner_tpop(window.apf.herkunft_parent_node);
					// selection steuern
					$.jstree._reference(herkunft_node).deselect_all();
					$.jstree._reference(ziel_parent_node).select_node(herkunft_node);
					// Variablen aufräumen
					localStorage.tpop_id = herkunft_node_id;
					delete window.apf.tpop;
					delete window.apf.tpop_node_ausgeschnitten;
					delete window.apf.herkunft_parent_node;
					window.apf.initiiere_tpop();
				});
				fügeTPopEin_3.fail(function(data) {
					//window.apf.melde("Fehler: Die Teilpopulation wurde nicht verschoben");
					console.log("Fehler: Die Teilpopulation wurde nicht verschoben");
				});
			}
			if (ziel_node_typ === "pop_ordner_tpop") {
				var fügeTPopEin_4 = $.ajax({
					type: 'post',
					url: 'php/tpop_einfuegen.php',
					dataType: 'json',
					data: {
						"pop_id": ziel_node_id,
						"tpop_id": herkunft_node_id,
						"user": sessionStorage.User
					}
				});
				fügeTPopEin_4.always(function() {
					// Anzahlen anpassen der parent-nodes am Herkunfts- und Zielort
					window.apf.beschrifte_ordner_tpop(ziel_node);
					window.apf.beschrifte_ordner_tpop(window.apf.herkunft_parent_node);
					// selection steuern
					$.jstree._reference(herkunft_node).deselect_all();
					$.jstree._reference(herkunft_node).select_node(herkunft_node);
					// Variablen aufräumen
					localStorage.tpop_id = herkunft_node_id;
					delete window.apf.tpop;
					delete window.apf.tpop_node_ausgeschnitten;
					delete window.apf.herkunft_parent_node;
					window.apf.initiiere_tpop();
				});
				fügeTPopEin_4.fail(function(data) {
					//window.apf.melde("Fehler: Die Teilpopulation wurde nicht verschoben");
					console.log("Fehler: Die Teilpopulation wurde nicht verschoben");
				});
			}
		}
		if (herkunft_node_typ === "tpopmassn") {
			if (ziel_node_typ === "tpopmassn") {
				var fügeTPopMassnEin = $.ajax({
					type: 'post',
					url: 'php/tpopmassn_einfuegen.php',
					dataType: 'json',
					data: {
						"tpop_id": ziel_parent_node_id,
						"tpopmassn_id": herkunft_node_id,
						"user": sessionStorage.User
					}
				});
				fügeTPopMassnEin.always(function() {
					// Anzahlen anpassen der parent-nodes am Herkunfts- und Zielort
					window.apf.beschrifte_ordner_tpopmassn(ziel_parent_node);
					window.apf.beschrifte_ordner_tpopmassn(window.apf.herkunft_parent_node);
					// selection steuern
					$.jstree._reference(herkunft_node).deselect_all();
					$.jstree._reference(ziel_parent_node).select_node(herkunft_node);
					// Variablen aufräumen
					localStorage.tpopmassn_id = herkunft_node_id;
					delete window.apf.tpopmassn;
					delete window.apf.tpopmassn_node_ausgeschnitten;
					delete window.apf.herkunft_parent_node;
					window.apf.initiiere_tpopmassn();
				});
				fügeTPopMassnEin.fail(function(data) {
					//window.apf.melde("Fehler: Die Massnahme wurde nicht verschoben");
					console.log("Fehler: Die Massnahme wurde nicht verschoben");
				});
			}
			if (ziel_node_typ === "tpop_ordner_massn") {
				var fügeTPopMassnEin_2 = $.ajax({
					type: 'post',
					url: 'php/tpopmassn_einfuegen.php',
					dataType: 'json',
					data: {
						"tpop_id": ziel_node_id,
						"tpopmassn_id": herkunft_node_id,
						"user": sessionStorage.User
					}
				});
				fügeTPopMassnEin_2.always(function() {
					// Anzahlen anpassen der parent-nodes am Herkunfts- und Zielort
					window.apf.beschrifte_ordner_tpopmassn(ziel_node);
					window.apf.beschrifte_ordner_tpopmassn(window.apf.herkunft_parent_node);
					// selection steuern
					$.jstree._reference(herkunft_node).deselect_all();
					$.jstree._reference(herkunft_node).select_node(herkunft_node);
					// Variablen aufräumen
					localStorage.tpopmassn_id = herkunft_node_id;
					delete window.apf.tpopmassn;
					delete window.apf.tpopmassn_node_ausgeschnitten;
					delete window.apf.herkunft_parent_node;
					window.apf.initiiere_tpopmassn();
				});
				fügeTPopMassnEin_2.fail(function(data) {
					//window.apf.melde("Fehler: Die Massnahme wurde nicht verschoben");
					console.log("Fehler: Die Massnahme wurde nicht verschoben");
				});
			}
		}
		if (herkunft_node_typ === "tpopfeldkontr") {
			if (ziel_node_typ === "tpopfeldkontr") {
				var fügeTPopFeldkontrEin = $.ajax({
					type: 'post',
					url: 'php/tpopfeldkontr_einfuegen.php',
					dataType: 'json',
					data: {
						"tpop_id": ziel_parent_node_id,
						"tpopfeldkontr_id": herkunft_node_id,
						"user": sessionStorage.User
					}
				});
				fügeTPopFeldkontrEin.always(function() {
					// Anzahlen anpassen der parent-nodes am Herkunfts- und Zielort
					window.apf.beschrifte_ordner_tpopfeldkontr(ziel_parent_node);
					window.apf.beschrifte_ordner_tpopfeldkontr(window.apf.herkunft_parent_node);
					// selection steuern
					$.jstree._reference(herkunft_node).deselect_all();
					$.jstree._reference(herkunft_node).select_node(herkunft_node);
					// Variablen aufräumen
					localStorage.tpopfeldkontr_id = herkunft_node_id;
					delete window.apf.tpopfeldkontr;
					delete window.apf.tpopfeldkontr_node_ausgeschnitten;
					delete window.apf.herkunft_parent_node;
					window.apf.initiiere_tpopfeldkontr();
				});
				fügeTPopFeldkontrEin.fail(function(data) {
					//window.apf.melde("Fehler: Die Feldkontrolle wurde nicht verschoben");
					console.log('Fehler: Die Feldkontrolle wurde nicht verschoben');
				});
			}
			if (ziel_node_typ === "tpop_ordner_feldkontr") {
				var fügeTPopFeldkontrEin_2 = $.ajax({
					type: 'post',
					url: 'php/tpopfeldkontr_einfuegen.php',
					dataType: 'json',
					data: {
						"tpop_id": ziel_node_id,
						"tpopfeldkontr_id": herkunft_node_id,
						"user": sessionStorage.User
					}
				});
				fügeTPopFeldkontrEin_2.always(function() {
					// Anzahlen anpassen der parent-nodes am Herkunfts- und Zielort
					window.apf.beschrifte_ordner_tpopfeldkontr(ziel_node);
					window.apf.beschrifte_ordner_tpopfeldkontr(window.apf.herkunft_parent_node);
					// selection steuern
					$.jstree._reference(herkunft_node).deselect_all();
					$.jstree._reference(herkunft_node).select_node(herkunft_node);
					// Variablen aufräumen
					localStorage.tpopfeldkontr_id = herkunft_node_id;
					delete window.apf.tpopfeldkontr;
					delete window.apf.tpopfeldkontr_node_ausgeschnitten;
					delete window.apf.herkunft_parent_node;
					window.apf.initiiere_tpopfeldkontr();
				});
				fügeTPopFeldkontrEin_2.fail(function() {
					//window.apf.melde("Fehler: Die Feldkontrolle wurde nicht verschoben");
					console.log('Fehler: Die Feldkontrolle wurde nicht verschoben');
				});
			}
		}
		if (herkunft_node_typ === "tpopfreiwkontr") {
			if (ziel_node_typ === "tpopfreiwkontr") {
				var fügeTPopFeldkontrEin_3 = $.ajax({
					type: 'post',
					url: 'php/tpopfeldkontr_einfuegen.php',
					dataType: 'json',
					data: {
						"tpop_id": ziel_parent_node_id,
						"tpopfeldkontr_id": herkunft_node_id,
						"user": sessionStorage.User
					}
				});
				fügeTPopFeldkontrEin_3.always(function() {
					// Anzahlen anpassen der parent-nodes am Herkunfts- und Zielort
					window.apf.beschrifte_ordner_tpopfreiwkontr(ziel_parent_node);
					window.apf.beschrifte_ordner_tpopfreiwkontr(window.apf.herkunft_parent_node);
					// selection steuern
					$.jstree._reference(herkunft_node).deselect_all();
					$.jstree._reference(herkunft_node).select_node(herkunft_node);
					// Variablen aufräumen
					localStorage.tpopfeldkontr_id = herkunft_node_id;
					delete window.apf.tpopfeldkontr;
					delete window.apf.tpopfreiwkontr_node_ausgeschnitten;
					delete window.apf.herkunft_parent_node;
					localStorage.tpopfreiwkontr = true;
					window.apf.initiiere_tpopfeldkontr();
				});
				fügeTPopFeldkontrEin_3.fail(function() {
					//window.apf.melde("Fehler: Die Freiwilligen-Kontrolle wurde nicht verschoben");
					console.log('Fehler: Die Freiwilligen-Kontrolle wurde nicht verschoben');
				});
			}
			if (ziel_node_typ === "tpop_ordner_freiwkontr") {
				var fügeTPopFeldkontrEin_4 = $.ajax({
					type: 'post',
					url: 'php/tpopfeldkontr_einfuegen.php',
					dataType: 'json',
					data: {
						"tpop_id": ziel_node_id,
						"tpopfeldkontr_id": herkunft_node_id,
						"user": sessionStorage.User
					}
				});
				fügeTPopFeldkontrEin_4.always(function() {
					// Anzahlen anpassen der parent-nodes am Herkunfts- und Zielort
					window.apf.beschrifte_ordner_tpopfreiwkontr(ziel_node);
					window.apf.beschrifte_ordner_tpopfreiwkontr(window.apf.herkunft_parent_node);
					// selection steuern
					$.jstree._reference(herkunft_node).deselect_all();
					$.jstree._reference(herkunft_node).select_node(herkunft_node);
					// Variablen aufräumen
					localStorage.tpopfeldkontr_id = herkunft_node_id;
					delete window.apf.tpopfeldkontr;
					delete window.apf.tpopfreiwkontr_node_ausgeschnitten;
					delete window.apf.herkunft_parent_node;
					localStorage.tpopfreiwkontr = true;
					window.apf.initiiere_tpopfeldkontr();
				});
				fügeTPopFeldkontrEin_4.fail(function() {
					//window.apf.melde("Fehler: Die Freiwilligen-Kontrolle wurde nicht verschoben");
					console.log('Fehler: Die Freiwilligen-Kontrolle wurde nicht verschoben');
				});
			}
		}
		if (herkunft_node_typ === "beob_zugeordnet") {
			// zugeordnet
			if (ziel_node_typ === "beob_nicht_beurteilt" || ziel_node_typ === "ap_ordner_beob_nicht_beurteilt") {
				// zugeordnet > nicht beurteilt
				var ordneBeobachtungZu = $.ajax({
					type: 'post',
					url: 'php/beob_zuordnung_delete.php',
					dataType: 'json',
					data: {
						"id": herkunft_node_id
					}
				});
				ordneBeobachtungZu.always(function() {
					// typ des nodes anpassen
					herkunft_node.attr("typ", "beob_nicht_beurteilt");
					localStorage.beobtyp = "beob_nicht_beurteilt";
					// Anzahlen anpassen der parent-nodes am Herkunfts- und Zielort
					if (ziel_node_typ === "beob_nicht_beurteilt") {
						window.apf.beschrifte_ordner_beob_nicht_beurteilt(ziel_parent_node);
					} else {
						window.apf.beschrifte_ordner_beob_nicht_beurteilt(ziel_node);
					}
					window.apf.beschrifte_ordner_beob_zugeordnet(window.apf.herkunft_parent_node);
					// beob initiieren
					window.apf.initiiere_beob(herkunft_node.attr("beobtyp"), herkunft_node_id, "nicht_beurteilt");
					// Variablen aufräumen
					delete window.apf.beob_zugeordnet_node_ausgeschnitten;
					delete window.apf.herkunft_parent_node;
				});
				ordneBeobachtungZu.fail(function() {
					//window.apf.melde("Fehler: Die Beobachtung wurde nicht auf 'nicht beurteilt' gesetzt");
					console.log("Fehler: Die Beobachtung wurde nicht auf 'nicht beurteilt' gesetzt");
				});
			}
			if (ziel_node_typ === "beob_zugeordnet" || ziel_node_typ === "tpop_ordner_beob_zugeordnet") {
				// zugeordnet > zugeordnet
				if (ziel_node_typ === "tpop_ordner_beob_zugeordnet") {
					neue_tpop_id = ziel_node_id;
				} else {
					neue_tpop_id = ziel_parent_node_id;
				}
				var ordneBeobachtungZu_2 = $.ajax({
					type: 'post',
					url: 'php/beob_update.php',
					dataType: 'json',
					data: {
						"id": localStorage.beob_id,
						"Feld": "TPopId",
						"Wert": neue_tpop_id,
						"user": sessionStorage.User
					}
				});
				ordneBeobachtungZu_2.always(function() {
					// Anzahlen anpassen der parent-nodes am Herkunfts- und Zielort
					if (ziel_node_typ === "tpop_ordner_beob_zugeordnet") {
						window.apf.beschrifte_ordner_beob_zugeordnet(ziel_node);
					} else {
						window.apf.beschrifte_ordner_beob_zugeordnet(ziel_parent_node);
					}
					window.apf.beschrifte_ordner_beob_zugeordnet(window.apf.herkunft_parent_node);
					// selection steuern
					if (!localStorage.karte_fokussieren) {
						window.apf.initiiere_beob(herkunft_node.attr("beobtyp"), herkunft_node_id, "zugeordnet");
					} else {
						delete localStorage.karte_fokussieren;
					}
					// Variablen aufräumen
					delete window.apf.beob_zugeordnet_node_ausgeschnitten;
					delete window.apf.herkunft_parent_node;
				});
				ordneBeobachtungZu_2.fail(function() {
					//window.apf.melde("Fehler: Die Beobachtung wurde nicht verschoben");
					console.log('Fehler: Die Beobachtung wurde nicht verschoben');
				});
			}
			if (ziel_node_typ === "beob_nicht_zuzuordnen" || ziel_node_typ === "ap_ordner_beob_nicht_zuzuordnen") {
				// zugeordnet > nicht zuzuordnen
				var ordneBeobachtungZu_3 = $.ajax({
					type: 'post',
					url: 'php/beob_update.php',
					dataType: 'json',
					data: {
						"id": herkunft_node_id,
						"Feld": "BeobNichtZuordnen",
						"Wert": 1,
						"user": sessionStorage.User
					} 
				});
				ordneBeobachtungZu_3.always(function() {
					// TPopId null setzen
					var setzeTpopid = $.ajax({
						type: 'post',
						url: 'php/beob_update.php',
						dataType: 'json',
						data: {
							"id": herkunft_node_id,
							"Feld": "TPopId",
							"Wert": "",
							"user": sessionStorage.User
						}
					});
					setzeTpopid.always(function() {
						// aus unerfindlichen Gründen läuft der success callback nicht, darum done
						// typ des nodes anpassen
						herkunft_node.attr("typ", "beob_nicht_zuzuordnen");
						localStorage.beobtyp = "beob_nicht_zuzuordnen";
						// Anzahlen anpassen der parent-nodes am Herkunfts- und Zielort
						if (ziel_node_typ === "ap_ordner_beob_nicht_zuzuordnen") {
							window.apf.beschrifte_ordner_beob_nicht_zuzuordnen(ziel_node);
						} else {
							window.apf.beschrifte_ordner_beob_nicht_zuzuordnen(ziel_parent_node);
						}
						window.apf.beschrifte_ordner_beob_zugeordnet(window.apf.herkunft_parent_node);
						// Beob initiieren
						window.apf.initiiere_beob(herkunft_node.attr("beobtyp"), herkunft_node_id, "nicht_zuzuordnen");
						// Variablen aufräumen
						delete window.apf.beob_node_ausgeschnitten;
						delete window.apf.herkunft_parent_node;
					});
					setzeTpopid.fail(function() {
						console.log("fehler beim Leeren von TPopId");
					});
				});
				ordneBeobachtungZu_3.fail(function() {
					//window.apf.melde("Fehler: Die Beobachtung wurde nicht verschoben");
					console.log('Fehler: Die Beobachtung wurde nicht verschoben');
				});
			}
		}
		if (herkunft_node_typ === "beob_nicht_beurteilt") {
			// nicht beurteilt
			if (ziel_node_typ === "beob_zugeordnet" || ziel_node_typ === "tpop_ordner_beob_zugeordnet") {
				// nicht beurteilt > zugeordnet
				if (ziel_node_typ === "tpop_ordner_beob_zugeordnet") {
					neue_tpop_id = ziel_node_id;
				} else {
					neue_tpop_id = ziel_parent_node_id;
				}
				// Zuerst eine neue Zuordnung erstellen
				var insertZuordnung = $.ajax({
					type: 'post',
					url: 'php/beob_zuordnung_insert.php',
					dataType: 'json',
					data: {
						"no_note": herkunft_node_id,
						"user": sessionStorage.User
					}
				});
				insertZuordnung.always(function() {
					// jetzt aktualisieren
					var updateBeob = $.ajax({
						type: 'post',
						url: 'php/beob_update.php',
						dataType: 'json',
						data: {
							"id": herkunft_node_id,
							"Feld": "TPopId",
							"Wert": neue_tpop_id,
							"user": sessionStorage.User
						}
					});
					updateBeob.always(function() {
						// typ des nodes anpassen
						herkunft_node.attr("typ", "beob_zugeordnet");
						localStorage.beobtyp = "beob_zugeordnet";
						// Parent Node-Beschriftung am Herkunft- und Zielort: Anzahl anpassen
						window.apf.beschrifte_ordner_beob_nicht_beurteilt(window.apf.herkunft_parent_node);
						if (ziel_node_typ === "tpop_ordner_beob_zugeordnet") {
							window.apf.beschrifte_ordner_beob_zugeordnet(ziel_node);
						} else {
							window.apf.beschrifte_ordner_beob_zugeordnet(ziel_parent_node);
						}
						// selection steuern
						if (!localStorage.karte_fokussieren) {
							window.apf.initiiere_beob(herkunft_node.attr("beobtyp"), herkunft_node_id, "zugeordnet");
						} else {
							delete localStorage.karte_fokussieren;
						}
						// Variablen aufräumen
						delete window.apf.beob_node_ausgeschnitten;
						delete window.apf.herkunft_parent_node;
					});
					updateBeob.fail(function() {
						//window.apf.melde("Fehler: Die Beobachtung wurde nicht zugeordnet");
						console.log('Fehler: Die Beobachtung wurde nicht zugeordnet');
					});
				});
				insertZuordnung.fail(function() {
					//window.apf.melde("Fehler: Die Beobachtung wurde nicht zugeordnet");
					console.log('Fehler: Die Beobachtung wurde nicht zugeordnet');
				});
			}
			if (ziel_node_typ === "beob_nicht_zuzuordnen" || ziel_node_typ === "ap_ordner_beob_nicht_zuzuordnen") {
				// nicht beurteilt > nicht zuordnen
				var insertZuordnung_2 = $.ajax({
					type: 'post',
					url: 'php/beob_zuordnung_insert.php',
					dataType: 'json',
					data: {
						"no_note": herkunft_node_id,
						"user": sessionStorage.User
					}
				});
				insertZuordnung_2.always(function() {
					// jetzt aktualisieren
					var updateBeob_2 = $.ajax({
						type: 'post',
						url: 'php/beob_update.php',
						dataType: 'json',
						data: {
							"id": herkunft_node_id,
							"Feld": "BeobNichtZuordnen",
							"Wert": 1,
							"user": sessionStorage.User
						}
					});
					updateBeob_2.always(function() {
						// typ des nodes anpassen
						$(herkunft_node).attr("typ", "beob_nicht_zuzuordnen");
						localStorage.beobtyp = "beob_nicht_zuzuordnen";
						// Parent Node-Beschriftung am Herkunft- und Zielort: Anzahl anpassen
						window.apf.beschrifte_ordner_beob_nicht_beurteilt(window.apf.herkunft_parent_node);
						if (ziel_node_typ === "ap_ordner_beob_nicht_zuzuordnen") {
							window.apf.beschrifte_ordner_beob_nicht_zuzuordnen(ziel_node);
						} else {
							window.apf.beschrifte_ordner_beob_nicht_zuzuordnen(ziel_parent_node);
						}
						// Beob initiieren
						window.apf.initiiere_beob(herkunft_node.attr("beobtyp"), herkunft_node_id, "nicht_zuzuordnen");
						// Variablen aufräumen
						delete window.apf.beob_node_ausgeschnitten;
						delete window.apf.herkunft_parent_node;
					});
					updateBeob_2.fail(function() {
						console.log("Fehler: Die Beobachtung wurde nicht zugeordnet");
					});
				});
				insertZuordnung_2.fail(function() {
					//window.apf.melde("Fehler: Die Beobachtung wurde nicht zugeordnet");
					console.log("Fehler: Die Beobachtung wurde nicht zugeordnet");
				});
			}
		}
		if (herkunft_node_typ === "beob_nicht_zuzuordnen") {
			// nicht zuzuordnen
			if (ziel_node_typ === "beob_nicht_beurteilt" || ziel_node_typ === "ap_ordner_beob_nicht_beurteilt") {
				// nicht zuzuordnen > nicht beurteilt
				var deleteZuordnung = $.ajax({
					type: 'post',
					url: 'php/beob_zuordnung_delete.php',
					dataType: 'json',
					data: {
						"id": herkunft_node_id
					}
				});
				deleteZuordnung.always(function() {
					// typ des nodes anpassen
					$(herkunft_node).attr("typ", "beob_nicht_beurteilt");
					localStorage.beobtyp = "beob_nicht_beurteilt";
					// Parent Node-Beschriftung am Herkunft- und Zielort: Anzahl anpassen
					window.apf.beschrifte_ordner_beob_nicht_zuzuordnen(window.apf.herkunft_parent_node);
					if (ziel_node_typ === "ap_ordner_beob_nicht_beurteilt") {
						window.apf.beschrifte_ordner_beob_nicht_beurteilt(ziel_node);
					} else {
						window.apf.beschrifte_ordner_beob_nicht_beurteilt(ziel_parent_node);
					}
					// selektieren
					window.apf.initiiere_beob(herkunft_node.attr("beobtyp"), herkunft_node_id, "nicht_beurteilt");
					// Variablen aufräumen
					delete window.apf.beob_node_ausgeschnitten;
					delete window.apf.herkunft_parent_node;
				});
				deleteZuordnung.fail(function() {
					//window.apf.melde("Fehler: Die Zuordnung der Beobachtung wurde nicht entfernt");
					console.log('Fehler: Die Zuordnung der Beobachtung wurde nicht entfernt');
				});
			}
			if (ziel_node_typ === "beob_zugeordnet" || ziel_node_typ === "tpop_ordner_beob_zugeordnet") {
				// nicht zuzuordnen > zugeordnet
				var neue_tpop_id;
				if (ziel_node_typ === "tpop_ordner_beob_zugeordnet") {
					neue_tpop_id = ziel_node_id;
				} else {
					neue_tpop_id = ziel_parent_node_id;
				}
				var updateBeob_3 = $.ajax({
					type: 'post',
					url: 'php/beob_update.php',
						dataType: 'json',
						data: {
							"id": herkunft_node_id,
							"Feld": "BeobNichtZuordnen",
							"Wert": "",
							"user": sessionStorage.User
					}
				});
				updateBeob_3.always(function() {
					var updateBeob_4 = $.ajax({
						type: 'post',
						url: 'php/beob_update.php',
						dataType: 'json',
						data: {
							"id": herkunft_node_id,
							"Feld": "TPopId",
							"Wert": neue_tpop_id,
							"user": sessionStorage.User
						}
					});
					updateBeob_4.always(function() {
						// typ des nodes anpassen
						$(herkunft_node).attr("typ", "beob_zugeordnet");
						localStorage.beobtyp = "beob_zugeordnet";
						// Parent Node-Beschriftung am Herkunft- und Zielort: Anzahl anpassen
						window.apf.beschrifte_ordner_beob_nicht_zuzuordnen(window.apf.herkunft_parent_node);
						if (ziel_node_typ === "tpop_ordner_beob_zugeordnet") {
							window.apf.beschrifte_ordner_beob_zugeordnet(ziel_node);
						} else {
							window.apf.beschrifte_ordner_beob_zugeordnet(ziel_parent_node);
						}
						// selection steuern
						window.apf.initiiere_beob(herkunft_node.attr("beobtyp"), herkunft_node_id, "zugeordnet");
						// Variablen aufräumen
						delete window.apf.beob_node_ausgeschnitten;
						delete window.apf.herkunft_parent_node;
					});
					updateBeob_4.fail(function() {
						//window.apf.melde("Fehler: Die Beobachtung wurde nicht zugeordnet");
						console.log('Fehler: Die Beobachtung wurde nicht zugeordnet');
					});
				});
				updateBeob_3.fail(function() {
					//window.apf.melde("Fehler: Die Beobachtung wurde nicht zugeordnet");
					console.log('Fehler: Die Beobachtung wurde nicht zugeordnet');
				});
			}
		}
	});
	return jstree_erstellt.promise();
};

// übernimmt einen node
// zählt dessen children und passt die Beschriftung an
window.apf.beschrifte_ordner_pop = function(node) {
	'use strict';
	var anz = $(node).find("> ul > li").length,
		anzTxt = "Populationen (" + anz + ")";
	$.jstree._reference(node).rename_node(node, anzTxt);
};

// übernimmt einen node
// zählt dessen children und passt die Beschriftung an
window.apf.beschrifte_ordner_apziel = function(node) {
	'use strict';
	var anz = 0,
		anzTxt;
	$($.jstree._reference(node)._get_children(node)).each(function(index) {
		$($(this).find("> ul > li")).each(function(index) {
			anz += 1;
		});
	});
	anzTxt = "AP-Ziele (" + anz + ")";
	$.jstree._reference(node).rename_node(node, anzTxt);
};

// übernimmt einen node
// zählt dessen children und passt die Beschriftung an
window.apf.beschrifte_ordner_apzieljahr = function(node) {
	'use strict';
	var anz = $(node).find("> ul > li").length,
		anzTxt;
	anzTxt = $.jstree._reference(node).get_text(node).slice(0, 6);
	anzTxt += anz + ")";
	$.jstree._reference(node).rename_node(node, anzTxt);
};

// übernimmt einen node
// zählt dessen children und passt die Beschriftung an
window.apf.beschrifte_ordner_zielber = function(node) {
	'use strict';
	var anz = $(node).find("> ul > li").length,
		anzTxt = "Ziel-Berichte (" + anz + ")";
	$.jstree._reference(node).rename_node(node, anzTxt);
};

// übernimmt einen node
// zählt dessen children und passt die Beschriftung an
window.apf.beschrifte_ordner_erfkrit = function(node) {
	'use strict';
	var anz = $(node).find("> ul > li").length,
		anzTxt = "AP-Erfolgskriterien (" + anz + ")";
	$.jstree._reference(node).rename_node(node, anzTxt);
};

// übernimmt einen node
// zählt dessen children und passt die Beschriftung an
window.apf.beschrifte_ordner_jber = function(node) {
	'use strict';
	var anz = $(node).find("> ul > li").length,
		anzTxt = "AP-Berichte (" + anz + ")";
	$.jstree._reference(node).rename_node(node, anzTxt);
};

// übernimmt einen node
// zählt dessen children und passt die Beschriftung an
window.apf.beschrifte_ordner_ber = function(node) {
	'use strict';
	var anz = $(node).find("> ul > li").length,
		anzTxt = "Berichte (" + anz + ")";
	$.jstree._reference(node).rename_node(node, anzTxt);
};

// übernimmt einen node
// zählt dessen children und passt die Beschriftung an
window.apf.beschrifte_ordner_assozarten = function(node) {
	'use strict';
	var anz = $(node).find("> ul > li").length,
		anzTxt = "assoziierte Arten (" + anz + ")";
	$.jstree._reference(node).rename_node(node, anzTxt);
};

// übernimmt einen node
// zählt dessen children und passt die Beschriftung an
window.apf.beschrifte_ordner_tpop = function(node) {
	'use strict';
	var anz = $(node).find("> ul > li").length,
		anzTxt = "Teilpopulationen (" + anz + ")";
	$.jstree._reference(node).rename_node(node, anzTxt);
};

// übernimmt einen node
// zählt dessen children und passt die Beschriftung an
window.apf.beschrifte_ordner_popber = function(node) {
	'use strict';
	var anz = $(node).find("> ul > li").length,
		anzTxt = "Populations-Berichte (" + anz + ")";
	$.jstree._reference(node).rename_node(node, anzTxt);
};

// übernimmt einen node
// zählt dessen children und passt die Beschriftung an
window.apf.beschrifte_ordner_popmassnber = function(node) {
	'use strict';
	var anz = $(node).find("> ul > li").length,
		anzTxt = "Massnahmen-Berichte (" + anz + ")";
	$.jstree._reference(node).rename_node(node, anzTxt);
};

// übernimmt einen node
// zählt dessen children und passt die Beschriftung an
window.apf.beschrifte_ordner_tpopmassnber = function(node) {
	'use strict';
	var anz = $(node).find("> ul > li").length,
		anzTxt = "Massnahmen-Berichte (" + anz + ")";
	$.jstree._reference(node).rename_node(node, anzTxt);
};

// übernimmt einen node
// zählt dessen children und passt die Beschriftung an
window.apf.beschrifte_ordner_tpopmassn = function(node) {
	'use strict';
	var anz = $(node).find("> ul > li").length,
		anzTxt = "Massnahmen (" + anz + ")";
	$.jstree._reference(node).rename_node(node, anzTxt);
};

// übernimmt einen node
// zählt dessen children und passt die Beschriftung an
window.apf.beschrifte_ordner_tpopber = function(node) {
	'use strict';
	var anz = $(node).find("> ul > li").length,
		anzTxt = "Teilpopulations-Berichte (" + anz + ")";
	$.jstree._reference(node).rename_node(node, anzTxt);
};

// übernimmt einen node
// zählt dessen children und passt die Beschriftung an
window.apf.beschrifte_ordner_tpopfeldkontr = function(node) {
	'use strict';
	var anz = $(node).find("> ul > li").length,
		anzTxt = "Feldkontrollen (" + anz + ")";
	$.jstree._reference(node).rename_node(node, anzTxt);
};

// übernimmt einen node
// zählt dessen children und passt die Beschriftung an
window.apf.beschrifte_ordner_tpopfreiwkontr = function(node) {
	'use strict';
	var anz = $(node).find("> ul > li").length,
		anzTxt = "Freiwilligen-Kontrollen (" + anz + ")";
	$.jstree._reference(node).rename_node(node, anzTxt);
};

// übernimmt einen node
// zählt dessen children und passt die Beschriftung an
window.apf.beschrifte_ordner_beob_zugeordnet = function(node) {
	'use strict';
	var anz = $(node).find("> ul > li").length,
		anzTxt = "Beobachtungen (" + anz + ")";
	$.jstree._reference(node).rename_node(node, anzTxt);
};

// übernimmt einen node
// zählt dessen children und passt die Beschriftung an
window.apf.beschrifte_ordner_beob_nicht_beurteilt = function(node) {
	'use strict';
	var anz = $(node).find("> ul > li").length,
		anzTxt = "nicht beurteilte Beobachtungen (" + anz + ")";
	$.jstree._reference(node).rename_node(node, anzTxt);
};

// übernimmt einen node
// zählt dessen children und passt die Beschriftung an
window.apf.beschrifte_ordner_beob_nicht_zuzuordnen = function(node) {
	'use strict';
	var anz = $(node).find("> ul > li").length,
		anzTxt = "nicht zuzuordnende Beobachtungen (" + anz + ")";
	$.jstree._reference(node).rename_node(node, anzTxt);
};

window.apf.treeKontextmenu = function(node) {
	'use strict';
	var items,
		aktiver_node,
		aktiver_nodeText,
		parent_node,
		parent_nodeText,
		grandparent_node,
		neue_apziele_node;
	// relevante nodes zwischenspeichern
	// aktiver_node = node;	 das hat auch funktioniert
	aktiver_node = $("#tree").jstree('get_selected');
	aktiver_nodeText = $.jstree._reference(aktiver_node).get_text(aktiver_node);
	// parent nur ermitteln, wenn parents exisiteren - sonst gibt es einen Fehler
	if ($(aktiver_node).attr("typ").slice(0, 9) !== "ap_ordner" && $(aktiver_node).attr("typ") !== "idealbiotop") {
		parent_node = $.jstree._reference(aktiver_node)._get_parent(aktiver_node);
		parent_nodeText = $.jstree._reference(parent_node).get_text(parent_node);
	}
	switch($(aktiver_node).attr("typ")) {
        case "ap_ordner_pop":
		items = {
			"untergeordneteKnotenOeffnen": {
				"label": "untergeordnete Knoten öffnen",
				"icon": "style/images/tree16x16.png",
				"action": function() {
					$.jstree._reference(node).open_all(node);
				}
			},
			"neu": {
				"label": "neue Population",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertPop = $.ajax({
						type: 'post',
						url: 'php/pop_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id")),
							"typ": "pop",
							"user": sessionStorage.User
						}
					});
					insertPop.always(function(id) {
						var strukturtyp = "pop",
							beschriftung = "neue Population";
						window.apf.insertNeuenNodeEineHierarchiestufeTiefer(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertPop.fail(function() {
						//window.apf.melde("Fehler: Keine neue Population erstellt");
						console.log('Fehler: Keine neue Population erstellt');
					});
				}
			},
			"GeoAdminMaps": {
				"label": "auf CH-Karten zeigen",
				"separator_before": true,
				"icon": "style/images/flora_icon_gelb.png",
				"action": function() {
					var getPopsChKarte = $.ajax({
						type: 'get',
						url: 'php/pops_ch_karte.php',
						dataType: 'json',
						data: {
							"ApArtId": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
						}
					});
					getPopsChKarte.always(function(data) {
						if (data.rows.length > 0) {
							window.apf.zeigePopAufOlmap();
							//window.apf.zeigePopAufOlmap(data);
						} else {
							window.apf.melde("Die Population hat keine Koordinaten", "Aktion abgebrochen");
						}
					});
					getPopsChKarte.fail(function() {
						//window.apf.melde("Fehler: Keine Daten erhalten");
						console.log('Fehler: Keine Daten erhalten');
					});
				}
			},
			"GoogleMaps": {
				"label": "auf Google-Karten zeigen",
				"separator_before": true,
				"icon": "style/images/flora_icon.png",
				"action": function() {
					var getApKarte = $.ajax({
						type: 'get',
						url: 'php/ap_karte.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
						}
					});
					getApKarte.always(function(data) {
						if (data.rows.length > 0) {
							window.apf.gmap.zeigeTPop(data);
						} else {
							window.apf.melde("Es gibt keine Teilpopulation mit Koordinaten", "Aktion abgebrochen");
						}
					});
					getApKarte.fail(function() {
						//window.apf.melde("Fehler: Keine Daten erhalten");
						console.log('Fehler: Keine Daten erhalten');
					});
				}
			}
		};
		if (window.apf.pop_zum_verschieben_gemerkt) {
			items.einfuegen = {
				"label": "'" + window.apf.pop_bezeichnung + "' einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					// db aktualisieren
					var updatePop = $.ajax({
						type: 'post',
						url: 'php/pop_update.php',
						dataType: 'json',
						data: {
							"id": window.apf.pop_id,
							"Feld": "ApArtId",
							"Wert": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id")),
							"user": sessionStorage.User
						}
					});
					updatePop.always(function() {
						// Baum neu aufbauen
						$.when(window.apf.erstelle_tree(window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))))
							.then(function() {
								// dann den eingefügten Node wählen
								$("#tree").jstree("select_node", "[typ='pop']#" + localStorage.pop_id); 
							});
						// einfügen soll nicht mehr angezeigt werden
						delete window.apf.pop_zum_verschieben_gemerkt;
						// nicht mehr benötigte Variablen entfernen
						delete window.apf.pop_bezeichnung;
						delete window.apf.pop_id;
					});
					updatePop.fail(function() {
						//window.apf.melde("Fehler: Die Population wurde nicht verschoben");
						console.log('Fehler: Die Population wurde nicht verschoben');
					});
				}
			}
		}
		return items;
	case "ap_ordner_apziel":
		items = {
			"untergeordneteKnotenOeffnen": {
				"label": "untergeordnete Knoten öffnen",
				"icon": "style/images/tree16x16.png",
				"action": function() {
					$.jstree._reference(node).open_all(node);
				}
			},
			"neu": {
				"label": "neues Ziel",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertApziel = $.ajax({
						type: 'post',
						url: 'php/apziel_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id")),
							"typ": "apziel",
							"user": sessionStorage.User
						}
					});
					insertApziel.always(function(id) {
						var strukturtyp = "apziel",
							beschriftung = "neues Ziel";
						// mitteilen, dass von ganz oben ein apziel erstellt wird und daher noch ein Zwischenordner erstellt werden muss
						localStorage.apziel_von_ordner_apziel = true;
						// zur Sicherheit den anderen Zeiger löschen
						delete localStorage.apziel_von_apzieljahr;
						window.apf.insertNeuenNodeEineHierarchiestufeTiefer(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertApziel.fail(function() {
						//window.apf.melde("Fehler: Keine neues AP-Ziel erstellt");
						console.log('Fehler: Keine neues AP-Ziel erstellt');
					});
				}
			}
		};
		return items;
	case "apzieljahr":
		items = {
			"untergeordneteKnotenOeffnen": {
				"label": "untergeordnete Knoten öffnen",
				"icon": "style/images/tree16x16.png",
				"action": function() {
					$.jstree._reference(node).open_all(node);
				}
			},
			"neu": {
				"label": "neues Ziel",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertApziel_2 = $.ajax({
						type: 'post',
						url: 'php/apziel_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(parent_node).attr("id")),
							"typ": "apziel",
							"user": sessionStorage.User
						}
					});
					insertApziel_2.always(function(id) {
						var strukturtyp = "apziel",
							beschriftung = "neues Ziel";
						localStorage.apziel_von_apzieljahr = true;
						// zur Sicherheit den anderen Zeiger löschen
						delete localStorage.apziel_von_ordner_apziel;
						window.apf.insertNeuenNodeEineHierarchiestufeTiefer(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertApziel_2.fail(function() {
						//window.apf.melde("Fehler: Keine neues Ziel erstellt");
						console.log('Fehler: Keine neues Ziel erstellt');
					});
				}
			}
		};
		return items;
	case "apziel":
		items = {
			"neu": {
				"label": "neues Ziel",
				"icon": "style/images/neu.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					grandparent_node = $.jstree._reference(parent_node)._get_parent(parent_node);
					var insertApziel_3 = $.ajax( {
						type: 'post',
						url: 'php/apziel_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(grandparent_node).attr("id")),
							"user": sessionStorage.User
						}
					});
					insertApziel_3.always(function(id) {
						var strukturtyp = "apziel",
							beschriftung = "neues Ziel";
						window.apf.insertNeuenNodeAufGleicherHierarchiestufe(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertApziel_3.fail(function() {
						//window.apf.melde("Fehler: Kein neues AP-Ziel erstellt");
						console.log('Fehler: Kein neues AP-Ziel erstellt');
					});
				}
			},
			"loeschen": {
				"label": "löschen",
				"separator_before": true,
				"icon": "style/images/loeschen.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					// selektieren, falls direkt mit der rechten Maustaste gewählt wurde
					$.jstree._reference(aktiver_node).deselect_all();
					// alle tieferen Knoten öffnen um zu zeigen, was mit gelöscht wird
					$.jstree._reference(aktiver_node).open_all(aktiver_node);
					$.jstree._reference(aktiver_node).deselect_all();
					$.jstree._reference(aktiver_node).select_node(aktiver_node);
					var bezeichnung = $.jstree._reference(aktiver_node).get_text(aktiver_node);
					$("#loeschen_dialog_mitteilung").html("Das AP-Ziel '" + bezeichnung + "' wird gelöscht.");
					$("#loeschen_dialog").dialog({
						resizable: false,
						height:'auto',
						width: 400,
						modal: true,
						buttons: {
							"ja, löschen!": function() {
								$(this).dialog("close");
								// Variable zum rückgängig machen erstellen
								window.apf.deleted = window.apf.apziel;
								window.apf.deleted.typ = "apziel";
								var deleteApziel = $.ajax({
									type: 'post',
									url: 'php/apziel_delete.php',
									dataType: 'json',
									data: {
										"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
									}
								});
								deleteApziel.always(function() {
									delete localStorage.apziel_id;
									delete window.apf.apziel;
									$.jstree._reference(aktiver_node).delete_node(aktiver_node);
									// grandparent Node-Beschriftung: Anzahl anpassen
									grandparent_node = $.jstree._reference(parent_node)._get_parent(parent_node);
									window.apf.beschrifte_ordner_apziel(grandparent_node);
									// parent Node-Beschriftung: Anzahl anpassen
									if ($.jstree._reference(parent_node).get_text(parent_node) !== "neue AP-Ziele") {
										window.apf.beschrifte_ordner_apzieljahr(parent_node);
									}
									// Hinweis zum rückgängig machen anzeigen
									window.apf.frageObAktionRückgängigGemachtWerdenSoll("Das AP-Ziel '" + bezeichnung + "' wurde gelöscht.");
								});
								deleteApziel.fail(function() {
									//window.apf.melde("Fehler: Das AP-Ziel wurde nicht gelöscht");
									console.log('Fehler: Das AP-Ziel wurde nicht gelöscht');
								});
							},
							"abbrechen": function() {
								$(this).dialog("close");
							}
						}
					});
				}
			}
		};
		return items;
	case "zielber_ordner":
		items = {
			"neu": {
				"label": "neuer Ziel-Bericht",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertZielber = $.ajax({
						type: 'post',
						url: 'php/zielber_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id")),
							"user": sessionStorage.User
						}
					});
					insertZielber.always(function(id) {
						var strukturtyp = "zielber",
							beschriftung = "neuer Ziel-Bericht";
						window.apf.insertNeuenNodeEineHierarchiestufeTiefer(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertZielber.fail(function() {
						//window.apf.melde("Fehler: Keinen neuen Ziel-Bericht erstellt");
						console.log('Fehler: Keinen neuen Ziel-Bericht erstellt');
					});
				}
			}
		};
		return items;
	case "zielber":
		items = {
			"neu": {
				"label": "neuer Ziel-Bericht",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertZielber_2 = $.ajax({
						type: 'post',
						url: 'php/zielber_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(parent_node).attr("id")),
							"typ": "zielber",
							"user": sessionStorage.User
						}
					});
					insertZielber_2.always(function(id) {
						var strukturtyp = "zielber",
							beschriftung = "neuer Ziel-Bericht";
						window.apf.insertNeuenNodeAufGleicherHierarchiestufe(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertZielber_2.fail(function() {
						//window.apf.melde("Fehler: Keinen neuen Ziel-Bericht erstellt");
						console.log('Fehler: Keinen neuen Ziel-Bericht erstellt');
					});
				}
			},
			"loeschen": {
				"label": "löschen",
				"separator_before": true,
				"icon": "style/images/loeschen.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					// selektieren, falls direkt mit der rechten Maustaste gewählt wurde
					$.jstree._reference(aktiver_node).deselect_all();
					// alle tieferen Knoten öffnen um zu zeigen, was mit gelöscht wird
					$.jstree._reference(aktiver_node).open_all(aktiver_node);
					$.jstree._reference(aktiver_node).deselect_all();
					$.jstree._reference(aktiver_node).select_node(aktiver_node);
					var bezeichnung = $.jstree._reference(aktiver_node).get_text(aktiver_node);
					$("#loeschen_dialog_mitteilung").html("Der Ziel-Bericht '" + bezeichnung + "' wird gelöscht.");
					$("#loeschen_dialog").dialog({
						resizable: false,
						height:'auto',
						width: 400,
						modal: true,
						buttons: {
							"ja, löschen!": function() {
								$(this).dialog("close");
								// Variable zum rückgängig machen erstellen
								window.apf.deleted = window.apf.zielber;
								window.apf.deleted.typ = "zielber";
								var deleteZielber = $.ajax({
									type: 'post',
									url: 'php/zielber_delete.php',
									dataType: 'json',
									data: {
										"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
									}
								});
								deleteZielber.always(function() {
									delete localStorage.zielber_id;
									delete window.apf.zielber;
									$.jstree._reference(aktiver_node).delete_node(aktiver_node);
									// Parent Node-Beschriftung: Anzahl anpassen
									window.apf.beschrifte_ordner_zielber(parent_node);
									// Hinweis zum rückgängig machen anzeigen
									window.apf.frageObAktionRückgängigGemachtWerdenSoll("Der Ziel-Bericht '" + bezeichnung + "' wurde gelöscht.");
								});
								deleteZielber.fail(function() {
									//window.apf.melde("Fehler: Der Ziel-Bericht wurde nicht gelöscht");
									console.log('Fehler: Der Ziel-Bericht wurde nicht gelöscht');
								});
							},
							"abbrechen": function() {
								$(this).dialog("close");
							}
						}
					});			
				}
			}
		};
		return items;
	case "ap_ordner_erfkrit":
		items = {
			"neu": {
				"label": "neues Erfolgskriterium",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertErfkrit = $.ajax({
						type: 'post',
						url: 'php/erfkrit_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id")),
							"user": sessionStorage.User
						}
					});
					insertErfkrit.always(function(id) {
						var strukturtyp = "erfkrit",
							beschriftung = "neues Erfolgskriterium";
						window.apf.insertNeuenNodeEineHierarchiestufeTiefer(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertErfkrit.fail(function() {
						//window.apf.melde("Fehler: Kein neues Erfolgskriterium erstellt");
						console.log('Fehler: Kein neues Erfolgskriterium erstellt');
					});
				}
			}
		};
		return items;
	case "erfkrit":
		items = {
			"neu": {
				"label": "neues Erfolgskriterium",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertErfkrit_2 = $.ajax({
						type: 'post',
						url: 'php/erfkrit_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(parent_node).attr("id")),
							"typ": "erfkrit",
							"user": sessionStorage.User
						}
					});
					insertErfkrit_2.always(function(id) {
						var strukturtyp = "erfkrit",
							beschriftung = "neues Erfolgskriterium";
						window.apf.insertNeuenNodeAufGleicherHierarchiestufe(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertErfkrit_2.fail(function() {
						//window.apf.melde("Fehler: Kein neues Erfolgskriterium erstellt");
						console.log('Fehler: Kein neues Erfolgskriterium erstellt');
					});
				}
			},
			"loeschen": {
				"label": "löschen",
				"separator_before": true,
				"icon": "style/images/loeschen.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					// selektieren, falls direkt mit der rechten Maustaste gewählt wurde
					$.jstree._reference(aktiver_node).deselect_all();
					// alle tieferen Knoten öffnen um zu zeigen, was mit gelöscht wird
					$.jstree._reference(aktiver_node).open_all(aktiver_node);
					$.jstree._reference(aktiver_node).deselect_all();
					$.jstree._reference(aktiver_node).select_node(aktiver_node);
					var bezeichnung = $.jstree._reference(aktiver_node).get_text(aktiver_node);
					$("#loeschen_dialog_mitteilung").html("Das Erfolgskriterium '" + bezeichnung + "' wird gelöscht.");
					$("#loeschen_dialog").dialog({
						resizable: false,
						height:'auto',
						width: 400,
						modal: true,
						buttons: {
							"ja, löschen!": function() {
								$(this).dialog("close");
								// Variable zum rückgängig machen erstellen
								window.apf.deleted = window.apf.erfkrit;
								window.apf.deleted.typ = "erfkrit";
								var deleteErfkrit = $.ajax({
									type: 'post',
									url: 'php/erfkrit_delete.php',
									dataType: 'json',
									data: {
										"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
									}
								});
								deleteErfkrit.always(function() {
									delete localStorage.erfkrit_id;
									delete window.apf.erfkrit;
									$.jstree._reference(aktiver_node).delete_node(aktiver_node);
									// Parent Node-Beschriftung: Anzahl anpassen
									window.apf.beschrifte_ordner_erfkrit(parent_node);
									// Hinweis zum rückgängig machen anzeigen
									window.apf.frageObAktionRückgängigGemachtWerdenSoll("Das Erfolgskriterium '" + bezeichnung + "' wurde gelöscht.");
								});
								deleteErfkrit.fail(function() {
									//window.apf.melde("Fehler: Das Erfolgskriterium wurde nicht gelöscht");
									console.log('Fehler: Das Erfolgskriterium wurde nicht gelöscht');
								});
							},
							"abbrechen": function() {
								$(this).dialog("close");
							}
						}
					});			
				}
			}
		};
		return items;
	case "ap_ordner_jber":
		items = {
			"untergeordneteKnotenOeffnen": {
				"label": "untergeordnete Knoten öffnen",
				"icon": "style/images/tree16x16.png",
				"action": function() {
					$.jstree._reference(node).open_all(node);
				}
			},
			"neu": {
				"label": "neuer AP-Bericht",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertJber = $.ajax({
						type: 'post',
						url: 'php/jber_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id")),
							"user": sessionStorage.User
						}
					});
					insertJber.always(function(id) {
						var strukturtyp = "jber",
							beschriftung = "neuer AP-Bericht";
						window.apf.insertNeuenNodeEineHierarchiestufeTiefer(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertJber.fail(function() {
						//window.apf.melde("Fehler: Keinen neuen AP-Bericht erstellt");
						console.log('Fehler: Keinen neuen AP-Bericht erstellt');
					});
				}
			}
		};
		return items;
	case "jber":
		items = {
			"neu": {
				"label": "neuer AP-Bericht",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertJber_2 = $.ajax({
						type: 'post',
						url: 'php/jber_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(parent_node).attr("id")),
							"typ": "jber",
							"user": sessionStorage.User
						}
					});
					insertJber_2.always(function(id) {
						var strukturtyp = "jber",
							beschriftung = "neuer AP-Bericht";
						window.apf.insertNeuenNodeAufGleicherHierarchiestufe(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertJber_2.fail(function() {
						//window.apf.melde("Fehler: Keinen neuen AP-Bericht erstellt");
						console.log('Fehler: Keinen neuen AP-Bericht erstellt');
					});
				}
			},
			"loeschen": {
				"label": "löschen",
				"separator_before": true,
				"icon": "style/images/loeschen.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					// selektieren, falls direkt mit der rechten Maustaste gewählt wurde
					$.jstree._reference(aktiver_node).deselect_all();
					// alle tieferen Knoten öffnen um zu zeigen, was mit gelöscht wird
					$.jstree._reference(aktiver_node).open_all(aktiver_node);
					$.jstree._reference(aktiver_node).deselect_all();
					$.jstree._reference(aktiver_node).select_node(aktiver_node);
					var bezeichnung = $.jstree._reference(aktiver_node).get_text(aktiver_node);
					$("#loeschen_dialog_mitteilung").html("Der AP-Bericht '" + bezeichnung + "' wird gelöscht.");
					$("#loeschen_dialog").dialog({
						resizable: false,
						height:'auto',
						width: 400,
						modal: true,
						buttons: {
							"ja, löschen!": function() {
								$(this).dialog("close");
								// Variable zum rückgängig machen erstellen
								window.apf.deleted = window.apf.jber;
								window.apf.deleted.typ = "jber";
								var deleteJber = $.ajax({
									type: 'post',
									url: 'php/jber_delete.php',
									dataType: 'json',
									data: {
										"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
									}
								});
								deleteJber.always(function() {
									delete localStorage.jber_id;
									delete window.apf.jber;
									$.jstree._reference(aktiver_node).delete_node(aktiver_node);
									// Parent Node-Beschriftung: Anzahl anpassen
									window.apf.beschrifte_ordner_jber(parent_node);
									// Hinweis zum rückgängig machen anzeigen
									window.apf.frageObAktionRückgängigGemachtWerdenSoll("Der AP-Bericht '" + bezeichnung + "' wurde gelöscht.");
								});
								deleteJber.fail(function() {
									//window.apf.melde("Fehler: Der AP-Bericht wurde nicht gelöscht");
									console.log('Fehler: Der AP-Bericht wurde nicht gelöscht');
								});
							},
							"abbrechen": function() {
								$(this).dialog("close");
							}
						}
					});
				}
			}
		};
		// Wenn noch keine existiert, kann einen neue Übersicht zu allen Arten erstellt werden
		if ($.jstree._reference(aktiver_node)._get_children(aktiver_node).length === 0) {
			items.neu_jber_uebersicht = {
				"label": "neue Übersicht zu allen Arten",
				"separator_before": true,
				"icon": "style/images/neu.png",
				"action": function() {
					var insertJberUebersicht = $.ajax({
						type: 'post',
						url: 'php/jber_uebersicht_insert.php',
						dataType: 'json',
						data: {
							"JbuJahr": $.jstree._reference(aktiver_node).get_text(aktiver_node),
							"user": sessionStorage.User
						}
					});
					insertJberUebersicht.always(function(data) {
						var strukturtyp = "jber_uebersicht",
							ds_id = $.jstree._reference(aktiver_node).get_text(aktiver_node),
							beschriftung = "neue Übersicht zu allen Arten";
						window.apf.insertNeuenNodeEineHierarchiestufeTiefer(aktiver_node, parent_node, strukturtyp, ds_id, beschriftung);
					});
					insertJberUebersicht.fail(function() {
						//window.apf.melde("Fehler: Keine Übersicht zu allen Arten erstellt");
						console.log('Fehler: Keine Übersicht zu allen Arten erstellt');
					});
				}
			}
		}
		return items;
	case "jber_uebersicht":
		items = {
			"loeschen": {
				"label": "lösche Übersicht zu allen Arten",
				"icon": "style/images/loeschen.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					// selektieren, falls direkt mit der rechten Maustaste gewählt wurde
					$.jstree._reference(aktiver_node).deselect_all();
					// alle tieferen Knoten öffnen um zu zeigen, was mit gelöscht wird
					$.jstree._reference(aktiver_node).open_all(aktiver_node);
					$.jstree._reference(aktiver_node).deselect_all();
					$.jstree._reference(aktiver_node).select_node(aktiver_node);
					$("#loeschen_dialog_mitteilung").html("Die Übersicht zu allen Arten wird gelöscht");
					$("#loeschen_dialog").dialog({
						resizable: false,
						height:'auto',
						width: 400,
						modal: true,
						buttons: {
							"ja, löschen!": function() {
								$(this).dialog("close");
								// Variable zum rückgängig machen erstellen
								window.apf.deleted = window.apf.jber_übersicht;
								window.apf.deleted.typ = "jber_uebersicht";
								var deleteJberUebersicht = $.ajax({
									type: 'post',
									url: 'php/jber_uebersicht_delete.php',
									dataType: 'json',
									data: {
										"jahr": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
									}
								});
								deleteJberUebersicht.always(function() {
									delete localStorage.jber_uebersicht_id;
									delete window.apf.jber_übersicht;
									$.jstree._reference(aktiver_node).delete_node(aktiver_node);
									// Hinweis zum rückgängig machen anzeigen
									window.apf.frageObAktionRückgängigGemachtWerdenSoll("Die Übersicht für den AP-Bericht des Jahrs \"" + window.apf.deleted.JbuJahr + "\" wurde gelöscht.");
								});
								deleteJberUebersicht.fail(function() {
									//window.apf.melde("Fehler: Die Übersicht zu allen Arten wurde nicht gelöscht");
									console.log('Fehler: Die Übersicht zu allen Arten wurde nicht gelöscht');
								});
							},
							"abbrechen": function() {
								$(this).dialog("close");
							}
						}
					});			
				}
			}
		};
		return items;
	case "ap_ordner_ber":
		items = {
			"neu": {
				"label": "neuer Bericht",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertBer = $.ajax({
						type: 'post',
						url: 'php/ber_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id")),
							"user": sessionStorage.User
						}
					});
					insertBer.always(function(id) {
						var strukturtyp = "ber",
							beschriftung = "neuer Bericht";
						window.apf.insertNeuenNodeEineHierarchiestufeTiefer(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertBer.fail(function() {
						//window.apf.melde("Fehler: Keinen neuen Bericht erstellt");
						console.log('Fehler: Keinen neuen Bericht erstellt');
					});
				}
			}
		};
		return items;
	case "ber":
		items = {
			"neu": {
				"label": "Neuer Bericht",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertBer_2 = $.ajax({
						type: 'post',
						url: 'php/ber_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(parent_node).attr("id")),
							"typ": "ber",
							"user": sessionStorage.User
						}
					});
					insertBer_2.always(function(id) {
						var strukturtyp = "ber",
							beschriftung = "neuer Bericht";
						window.apf.insertNeuenNodeAufGleicherHierarchiestufe(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertBer_2.fail(function() {
						//window.apf.melde("Fehler: Keinen neuen Bericht erstellt");
						console.log('Fehler: Keinen neuen Bericht erstellt');
					});
				}
			},
			"loeschen": {
				"label": "löschen",
				"separator_before": true,
				"icon": "style/images/loeschen.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					// selektieren, falls direkt mit der rechten Maustaste gewählt wurde
					$.jstree._reference(aktiver_node).deselect_all();
					// alle tieferen Knoten öffnen um zu zeigen, was mit gelöscht wird
					$.jstree._reference(aktiver_node).open_all(aktiver_node);
					$.jstree._reference(aktiver_node).deselect_all();
					$.jstree._reference(aktiver_node).select_node(aktiver_node);
					var bezeichnung = $.jstree._reference(aktiver_node).get_text(aktiver_node);
					$("#loeschen_dialog_mitteilung").html("Der Bericht '" + bezeichnung + "' wird gelöscht.");
					$("#loeschen_dialog").dialog({
						resizable: false,
						height:'auto',
						width: 400,
						modal: true,
						buttons: {
							"ja, löschen!": function() {
								$(this).dialog("close");
								// Variable zum rückgängig machen erstellen
								window.apf.deleted = window.apf.ber;
								window.apf.deleted.typ = "ber";
								var deleteBer = $.ajax({
									type: 'post',
									url: 'php/ber_delete.php',
									dataType: 'json',
									data: {
										"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
									}
								});
								deleteBer.always(function() {
									delete localStorage.ber_id;
									delete window.apf.ber;
									$.jstree._reference(aktiver_node).delete_node(aktiver_node);
									// Parent Node-Beschriftung: Anzahl anpassen
									window.apf.beschrifte_ordner_ber(parent_node);
									// Hinweis zum rückgängig machen anzeigen
									window.apf.frageObAktionRückgängigGemachtWerdenSoll("Der Bericht '" + bezeichnung + "' wurde gelöscht.");
								});
								deleteBer.fail(function() {
									//window.apf.melde("Fehler: Der Bericht wurde nicht gelöscht");
									console.log('Fehler: Der Bericht wurde nicht gelöscht');
								});
							},
							"abbrechen": function() {
								$(this).dialog("close");
							}
						}
					});			
				}
			}
		};
		return items;
	case "ap_ordner_assozarten":
		items = {
			"neu": {
				"label": "neue assoziierte Art",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertAssozarten = $.ajax({
						type: 'post',
						url: 'api/ap=' + window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id")) + '/assozart-neu/user=' + sessionStorage.User,
						dataType: 'json'
					});
					insertAssozarten.always(function(id) {
						var strukturtyp = "assozarten",
							beschriftung = "neue assoziierte Art";
						window.apf.insertNeuenNodeEineHierarchiestufeTiefer(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertAssozarten.fail(function() {
						//window.apf.melde("Fehler: keine assoziierte Art erstellt");
						console.log('Fehler: keine assoziierte Art erstellt');
					});
				}
			}
		};
		return items;
	case "assozarten":
		items = {
			"neu": {
				"label": "neue assoziierte Art",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertAssozarten_2 = $.ajax({
						type: 'post',
						url: 'api/ap=' + window.apf.erstelleIdAusDomAttributId($(parent_node).attr("id")) + '/assozart-neu/user=' + sessionStorage.User,
						dataType: 'json'
					});
					insertAssozarten_2.always(function(id) {
						var strukturtyp = "assozarten",
							beschriftung = "neue assoziierte Art";
						window.apf.insertNeuenNodeAufGleicherHierarchiestufe(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertAssozarten_2.fail(function() {
						//window.apf.melde("Fehler: Keine assoziierte Art erstellt");
						console.log('Fehler: Keine assoziierte Art erstellt');
					});
				}
			},
			"loeschen": {
				"label": "löschen",
				"separator_before": true,
				"icon": "style/images/loeschen.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					// selektieren, falls direkt mit der rechten Maustaste gewählt wurde
					$.jstree._reference(aktiver_node).deselect_all();
					// alle tieferen Knoten öffnen um zu zeigen, was mit gelöscht wird
					$.jstree._reference(aktiver_node).open_all(aktiver_node);
					$.jstree._reference(aktiver_node).deselect_all();
					$.jstree._reference(aktiver_node).select_node(aktiver_node);
					var bezeichnung = $.jstree._reference(aktiver_node).get_text(aktiver_node);
					$("#loeschen_dialog_mitteilung").html("Die assoziierte Art '" + bezeichnung + "' wird gelöscht.");
					$("#loeschen_dialog").dialog({
						resizable: false,
						height:'auto',
						width: 400,
						modal: true,
						buttons: {
							"ja, löschen!": function() {
								$(this).dialog("close");
								// Variable zum rückgängig machen erstellen
								window.apf.deleted = window.apf.assozarten;
								window.apf.deleted.typ = "assozarten";
								var deleteAssozarten = $.ajax({
									type: 'post',
									url: 'php/assozarten_delete.php',
									dataType: 'json',
									data: {
										"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
									}
								});
								deleteAssozarten.always(function() {
									delete localStorage.assozarten_id;
									delete window.apf.assozarten;
									$.jstree._reference(aktiver_node).delete_node(aktiver_node);
									// Parent Node-Beschriftung: Anzahl anpassen
									window.apf.beschrifte_ordner_assozarten(parent_node);
									// Hinweis zum rückgängig machen anzeigen
									window.apf.frageObAktionRückgängigGemachtWerdenSoll("Die assoziierte Art '" + bezeichnung + "' wurde gelöscht.");
								});
								deleteAssozarten.fail(function() {
									//window.apf.melde("Fehler: Die assoziierte Art wurde nicht gelöscht");
									console.log('Fehler: Die assoziierte Art wurde nicht gelöscht');
								});
							},
							"abbrechen": function() {
								$(this).dialog("close");
							}
						}
					});			
				}
			}
		};
		return items;
	case "pop":
		items = {
			"neu": {
				"label": "neue Population",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertPop_2 = $.ajax( {
						type: 'post',
						url: 'php/pop_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(parent_node).attr("id")),
							"typ": "pop",
							"user": sessionStorage.User
						}
					});
					insertPop_2.always(function(id) {
						var strukturtyp = "pop",
							beschriftung = "neue Population";
						window.apf.insertNeuenNodeAufGleicherHierarchiestufe(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertPop_2.fail(function() {
						//window.apf.melde("Fehler: Keine neue Population erstellt");
						console.log('Fehler: Keine neue Population erstellt');
					});
				}
			},
			"loeschen": {
				"label": "löschen",
				"separator_before": true,
				"icon": "style/images/loeschen.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					// selektieren, falls direkt mit der rechten Maustaste gewählt wurde
					$.jstree._reference(aktiver_node).deselect_all();
					// alle tieferen Knoten öffnen um zu zeigen, was mit gelöscht wird
					$.jstree._reference(aktiver_node).open_all(aktiver_node);
					$.jstree._reference(aktiver_node).deselect_all();
					$.jstree._reference(aktiver_node).select_node(aktiver_node);
					var bezeichnung = $.jstree._reference(aktiver_node).get_text(aktiver_node);
					$("#loeschen_dialog_mitteilung").html("Die Population '" + bezeichnung + "' wird gelöscht.");
					$("#loeschen_dialog").dialog({
						resizable: false,
						height:'auto',
						width: 400,
						modal: true,
						buttons: {
							"ja, löschen!": function() {
								$(this).dialog("close");
								// Variable zum rückgängig machen erstellen
								window.apf.deleted = window.apf.pop;
								window.apf.deleted.typ = "pop";
								var deletePop = $.ajax({
									type: 'post',
									url: 'php/pop_delete.php',
									dataType: 'json',
									data: {
										"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
									}
								});
								deletePop.always(function() {
									delete localStorage.pop_id;
									delete window.apf.pop;
									$.jstree._reference(aktiver_node).delete_node(aktiver_node);
									// Parent Node-Beschriftung: Anzahl anpassen
									window.apf.beschrifte_ordner_pop(parent_node);
									// Hinweis zum rückgängig machen anzeigen
									window.apf.frageObAktionRückgängigGemachtWerdenSoll("Population '" + bezeichnung + "' wurde gelöscht.");
								});
								deletePop.fail(function() {
									//window.apf.melde("Fehler: Die Population wurde nicht gelöscht");
									console.log('Fehler: Die Population wurde nicht gelöscht');
								});
							},
							"abbrechen": function() {
								$(this).dialog("close");
							}
						}
					});
				}
			},
			"GeoAdminMaps": {
				"label": "auf CH-Karten zeigen",
				"separator_before": true,
				"icon": "style/images/flora_icon_gelb.png",
				"action": function() {
					var getPopChKarte_2 = $.ajax({
						type: 'get',
						url: 'php/pop_ch_karte.php',
						dataType: 'json',
						data: {
							"pop_id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
						}
					});
					getPopChKarte_2.always(function(data) {
						if (data.rows.length > 0) {
							window.apf.zeigePopAufOlmap(data);
						} else {
							window.apf.melde("Die Population hat keine Koordinaten", "Aktion abgebrochen");
						}
					});
					getPopChKarte_2.fail(function() {
						//window.apf.melde("Fehler: Keine Populationen erhalten");
						console.log('Fehler: Keine Populationen erhalten');
					});
				}
			},
			"GoogleMaps": {
				"label": "auf Google-Karten zeigen",
				"separator_before": true,
				"icon": "style/images/flora_icon.png",
				"action": function() {
					var getPopKarte = $.ajax({
						type: 'get',
						url: 'php/pop_karte.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
						}
					});
					getPopKarte.always(function(data) {
						if (data.rows.length > 0) {
							window.apf.gmap.zeigeTPop(data);
						} else {
							window.apf.melde("Es gibt keine Teilpopulation mit Koordinaten", "Aktion abgebrochen");
						}
					});
					getPopKarte.fail(function() {
						//window.apf.melde("Fehler: Keine Teilpopulationen erhalten");
						console.log('Fehler: Keine Teilpopulationen erhalten');
					});
				}
			}
		};
		if (!window.apf.pop_zum_verschieben_gemerkt) {
			items.ausschneiden = {
				"label": "zum Verschieben merken",
				"separator_before": true,
				"icon": "style/images/ausschneiden.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					// Jetzt die PopId merken - ihr muss danach eine andere ApArtId zugeteilt werden
					window.apf.pop_id = window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"));
					// merken, dass ein node ausgeschnitten wurde
					window.apf.pop_zum_verschieben_gemerkt = true;
					// und wie er heisst (um es später im Kontextmenü anzuzeigen)
					window.apf.pop_bezeichnung = $("#PopNr").val() + " " + $("#PopName").val();

				}
			}
		}
		if (window.apf.pop_zum_verschieben_gemerkt) {
			items.einfuegen = {
				"label": "'" + window.apf.pop_bezeichnung + "' einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					var popid = window.apf.pop_id;
					var apartid = window.apf.erstelleIdAusDomAttributId($(parent_node).attr("id"));
					// db aktualisieren
					var updatePop_2 = $.ajax({
						type: 'post',
						url: 'php/pop_update.php',
						dataType: 'json',
						data: {
							"id": popid,
							"Feld": "ApArtId",
							"Wert": apartid,
							"user": sessionStorage.User
						}
					});
					updatePop_2.always(function() {
						// Baum wieder aufbauen
						$.when(window.apf.erstelle_tree(apartid))
							.then(function() {
								// dann den eingefügten Node wählen
								$("#tree").jstree("select_node", "[typ='pop']#" + popid); 
							});
						// einfügen soll nicht mehr angezeigt werden
						delete window.apf.pop_zum_verschieben_gemerkt;
						// nicht mehr benötigte Variablen entfernen
						delete window.apf.pop_bezeichnung;
						delete window.apf.pop_id;
					});
					updatePop_2.fail(function() {
						//window.apf.melde("Fehler: Die Population wurde nicht verschoben");
						console.log('Fehler: Die Population wurde nicht verschoben');
					});
				}
			}
		}
		return items;
	case "pop_ordner_tpop":
		items = {
			"untergeordneteKnotenOeffnen": {
				"label": "untergeordnete Knoten öffnen",
				"icon": "style/images/tree16x16.png",
				"action": function() {
					$.jstree._reference(node).open_all(node);
				}
			},
			"neu": {
				"label": "neue Teilpopulation",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertTPop = $.ajax({
						type: 'post',
						url: 'php/tpop_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id")),
							"typ": "tpop",
							"user": sessionStorage.User
						}
					});
					insertTPop.always(function(id) {
						var strukturtyp = "tpop",
							beschriftung = "neue Teilpopulation";
						window.apf.insertNeuenNodeEineHierarchiestufeTiefer(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertTPop.fail(function() {
						//window.apf.melde("Fehler: Keine neue Teilpopulation erstellt");
						console.log('Fehler: Keine neue Teilpopulation erstellt');
					});
				}
			},
			"GeoAdminMaps": {
				"label": "auf CH-Karten zeigen",
				"separator_before": true,
				"icon": "style/images/flora_icon_gelb.png",
				"action": function() {
					var getTpopsKarte = $.ajax({
						type: 'get',
						url: 'php/tpops_karte.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
						}
					});
					getTpopsKarte.always(function(data) {
						if (data.rows.length > 0) {
							window.apf.zeigeTPopAufOlmap(data);
						} else {
							window.apf.melde("Es gibt keine Teilpopulation mit Koordinaten", "Aktion abgebrochen");
						}
					});
					getTpopsKarte.fail(function() {
						//window.apf.melde("Fehler: Keine Teilpopulationen erhalten");
						console.log('Fehler: Keine Teilpopulationen erhalten');
					});
				}
			},
			"GoogleMaps": {
				"label": "auf Google-Karten zeigen",
				"separator_before": true,
				"icon": "style/images/flora_icon.png",
				"action": function() {
					var getPopKarte_2 = $.ajax({
						type: 'get',
						url: 'php/pop_karte.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
						}
					});
					getPopKarte_2.always(function(data) {
						if (data.rows.length > 0) {
							window.apf.gmap.zeigeTPop(data);
						} else {
							window.apf.melde("Es gibt keine Teilpopulation mit Koordinaten", "Aktion abgebrochen");
						}
					});
					getPopKarte_2.fail(function() {
						//window.apf.melde("Fehler: Keine Teilpopulationen erhalten");
						console.log('Fehler: Keine Teilpopulationen erhalten');
					});
				}
			}
		};
		if (window.apf.tpop_node_ausgeschnitten) {
			items.einfuegen = {
				"label": $.jstree._reference(window.apf.tpop_node_ausgeschnitten).get_text(window.apf.tpop_node_ausgeschnitten) + " einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					$.jstree._reference(aktiver_node).move_node(window.apf.tpop_node_ausgeschnitten, aktiver_node, "first", false);
				}
			}
		}
		if (window.apf.tpop_node_kopiert) {
			label = "";
			if (window.apf.tpop_objekt_kopiert.TPopNr) {
				label += window.apf.tpop_objekt_kopiert.TPopNr;
			} else {
				label += "(keine Nr.)";
			}
			label += ": ";
			if (window.apf.tpop_objekt_kopiert.TPopFlurname) {
				label += window.apf.tpop_objekt_kopiert.TPopFlurname;
			} else {
				label += "(kein Flurname)";
			}
			items.einfuegen = {
				//"label": $.jstree._reference(window.apf.tpop_node_kopiert).get_text(window.apf.tpop_node_kopiert) + " einfügen",
				"label": label + " einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					window.apf.tpopKopiertInPopOrdnerTpopEinfügen(aktiver_node);
				}
			}
		}
		return items;
	case "tpop":
		items = {
			"untergeordneteKnotenOeffnen": {
				"label": "untergeordnete Knoten öffnen",
				"icon": "style/images/tree16x16.png",
				"action": function() {
					$.jstree._reference(node).open_all(node);
				}
			},
			"neu": {
				"label": "neue Teilpopulation",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertTPop_2 = $.ajax({
						type: 'post',
						url: 'php/tpop_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(parent_node).attr("id")),
							"typ": "tpop",
							"user": sessionStorage.User
						}
					});
					insertTPop_2.always(function(id) {
						var strukturtyp = "tpop",
							beschriftung = "neue Teilpopulation";
						window.apf.insertNeuenNodeAufGleicherHierarchiestufe(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertTPop_2.fail(function() {
						//window.apf.melde("Fehler: Keine neue Teilpopulation erstellt");
						console.log('Fehler: Keine neue Teilpopulation erstellt');
					});
				}
			},
			"loeschen": {
				"label": "löschen",
				"separator_before": true,
				"icon": "style/images/loeschen.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					// selektieren, falls direkt mit der rechten Maustaste gewählt wurde
					$.jstree._reference(aktiver_node).deselect_all();
					// alle tieferen Knoten öffnen um zu zeigen, was mit gelöscht wird
					$.jstree._reference(aktiver_node).open_all(aktiver_node);
					$.jstree._reference(aktiver_node).deselect_all();
					$.jstree._reference(aktiver_node).select_node(aktiver_node);
					var bezeichnung = $.jstree._reference(aktiver_node).get_text(aktiver_node);
					$("#loeschen_dialog_mitteilung").html("Die Teilpopulation '" + bezeichnung + "' wird gelöscht.");
					$("#loeschen_dialog").dialog({
						resizable: false,
						height:'auto',
						width: 400,
						modal: true,
						buttons: {
							"ja, löschen!": function() {
								$(this).dialog("close");
								// Variable zum rückgängig machen erstellen
								window.apf.deleted = window.apf.tpop;
								window.apf.deleted.typ = "tpop";
								// löschen
								var deleteTPop = $.ajax({
									type: 'post',
									url: 'php/tpop_delete.php',
									dataType: 'json',
									data: {
										"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
									}
								});
								deleteTPop.always(function() {
									delete localStorage.tpop_id;
									delete window.apf.tpop;
									$.jstree._reference(aktiver_node).delete_node(aktiver_node);
									// Parent Node-Beschriftung: Anzahl anpassen
									window.apf.beschrifte_ordner_tpop(parent_node);
									// Hinweis zum rückgängig machen anzeigen
									window.apf.frageObAktionRückgängigGemachtWerdenSoll("Teilpopulation '" + bezeichnung + "' wurde gelöscht.");
								});
								deleteTPop.fail(function() {
									//window.apf.melde("Fehler: Die Teilpopulation wurde nicht gelöscht");
									console.log('Fehler: Die Teilpopulation wurde nicht gelöscht');
								});
							},
							"abbrechen": function() {
								$(this).dialog("close");
							}
						}
					});			
				}
			},
			"GeoAdminMaps": {
				"label": "auf CH-Karten zeigen",
				"separator_before": true,
				"icon": "style/images/flora_icon_gelb.png",
				"action": function() {
					var getTPopKarte_2 = $.ajax({
						type: 'get',
						url: 'php/tpop_karte.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
						}
					});
					getTPopKarte_2.always(function(data) {
						if (data.rows.length > 0) {
							window.apf.zeigeTPopAufOlmap(data);
						} else {
							window.apf.melde("Die Teilpopulation hat keine Koordinaten", "Aktion abgebrochen");
						}
					});
					getTPopKarte_2.fail(function() {
						//window.apf.melde("Fehler: Keine Teilpopulationen erhalten");
						console.log('Fehler: Keine Teilpopulationen erhalten');
					});
				}
			},
			"verortenGeoAdmin": {
				"label": "auf CH-Karten verorten",
				"separator_before": true,
				"icon": "style/images/flora_icon_rot.png",
				"action": function() {
					var getTPop_2 = $.ajax({
						type: 'get',
						url: 'php/tpop.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
						}
					});
					getTPop_2.always(function(data) {
						window.apf.verorteTPopAufOlmap(data);
					});
					getTPop_2.fail(function() {
						//window.apf.melde("Fehler: Keine Teilpopulation erhalten");
						console.log('Fehler: Keine Teilpopulation erhalten');
					});
				}
			},
			"GoogleMaps": {
				"label": "auf Google-Karten zeigen",
				"separator_before": true,
				"icon": "style/images/flora_icon.png",
				"action": function() {
					var getTPopKarte_3 = $.ajax({
						type: 'get',
						url: 'php/tpop_karte.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
						}
					});
					getTPopKarte_3.always(function(data) {
						if (data.rows.length > 0) {
							window.apf.gmap.zeigeTPop(data);
						} else {
							window.apf.melde("Die Teilpopulation hat keine Koordinaten", "Aktion abgebrochen");
						}
					});
					getTPopKarte_3.fail(function() {
						//window.apf.melde("Fehler: Keine Daten erhalten");
						console.log('Fehler: Keine Daten erhalten');
					});
				}
			},		
			"verorten": {
				"label": "auf Google-Karten verorten",
				"separator_before": true,
				"icon": "style/images/flora_icon_rot.png",
				"action": function() {
					var getTPop_3 = $.ajax({
						type: 'get',
						url: 'php/tpop.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
						}
					});
					getTPop_3.always(function(data) {
						window.apf.gmap.verorteTPop(data);
					});
					getTPop_3.fail(function() {
						//window.apf.melde("Fehler: Keine Daten erhalten");
						console.log('Fehler: Keine Daten erhalten');
					});
				}
			},
			"GisBrowser": {
				"label": "im GIS-Browser zeigen",
				"separator_before": true,
				"icon": "style/images/wappen_zuerich.png",
				"action": function() {
					window.apf.zeigeBeobKoordinatenImGisBrowser();
				}
			}
		};
		if (!window.apf.tpop_node_ausgeschnitten) {
			items.ausschneiden = {
				//"label": "ausschneiden<br>&nbsp;&nbsp;&nbsp;Tipp: drag and drop me!",
				"label": "ausschneiden",
				"separator_before": true,
				"icon": "style/images/ausschneiden.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					window.apf.tpop_node_ausgeschnitten = aktiver_node;
					// es macht keinen Sinn mehr, den kopierten node zu behalten
					// und stellt sicher, dass nun der ausgeschnittene mit "einfügen" angeboten wird
					delete window.apf.tpop_node_kopiert;
					delete window.apf.tpop_objekt_kopiert;
				}
			}
		}
		if (!window.apf.tpop_node_ausgeschnitten) {
			items.kopieren = {
				"label": "kopieren",
				"separator_before": true,
				"icon": "style/images/kopieren.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					window.apf.tpop_node_kopiert = aktiver_node;
					// Daten des Objekts holen
					var getTPop_4 = $.ajax({
						type: 'get',
						url: 'php/tpop.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(window.apf.tpop_node_kopiert).attr("id"))
						}
					});
					getTPop_4.always(function(data) {
						window.apf.tpop_objekt_kopiert = data;
					});
					getTPop_4.fail(function() {
						//window.apf.melde("Fehler: Die Teilpopulation wurde nicht kopiert");
						console.log('Fehler: Die Teilpopulation wurde nicht kopiert');
					});
				}
			}
		}
		if (window.apf.tpop_node_kopiert) {
			var label = "";
			if (window.apf.tpop_objekt_kopiert.TPopNr) {
				label += window.apf.tpop_objekt_kopiert.TPopNr;
			} else {
				label += "(keine Nr.)";
			}
			label += ": ";
			if (window.apf.tpop_objekt_kopiert.TPopFlurname) {
				label += window.apf.tpop_objekt_kopiert.TPopFlurname;
			} else {
				label += "(kein Flurname)";
			}
			items.einfuegen = {
				"label": label + " einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					window.apf.tpopKopiertInPopOrdnerTpopEinfügen(parent_node);
				}
			}
		}
		if (window.apf.tpop_node_ausgeschnitten) {
			items.einfuegen = {
				"label": $.jstree._reference(window.apf.tpop_node_ausgeschnitten).get_text(window.apf.tpop_node_ausgeschnitten) + " einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					$.jstree._reference(parent_node).move_node(window.apf.tpop_node_ausgeschnitten, parent_node, "first", false);
				}
			}
		}
		return items;
	case "pop_ordner_popber":
		items = {
			"neu": {
				"label": "neuer Populations-Bericht",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertPopber = $.ajax({
						type: 'post',
						url: 'php/popber_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id")),
							"user": sessionStorage.User
						}
					});
					insertPopber.always(function(id) {
						var strukturtyp = "popber",
							beschriftung = "neuer Populations-Bericht";
						window.apf.insertNeuenNodeEineHierarchiestufeTiefer(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertPopber.fail(function() {
						//window.apf.melde("Fehler: Keinen neuen Populations-Bericht erstellt");
						console.log('Fehler: Keinen neuen Populations-Bericht erstellt');
					});
				}
			}
		};
		return items;
	case "popber":
		items = {
			"neu": {
				"label": "neuer Populations-Bericht",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertPopber_2 = $.ajax({
						type: 'post',
						url: 'php/popber_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(parent_node).attr("id")),
							"typ": "popber",
							"user": sessionStorage.User
						}
					});
					insertPopber_2.always(function(id) {
						var strukturtyp = "popber",
							beschriftung = "neuer Populations-Bericht";
						window.apf.insertNeuenNodeAufGleicherHierarchiestufe(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertPopber_2.fail(function() {
						//window.apf.melde("Fehler: Keinen neuen Populations-Bericht erstellt");
						console.log('Fehler: Keinen neuen Populations-Bericht erstellt');
					});
				}
			},
			"loeschen": {
				"label": "löschen",
				"separator_before": true,
				"icon": "style/images/loeschen.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					var bezeichnung = $.jstree._reference(aktiver_node).get_text(aktiver_node);
					$("#loeschen_dialog_mitteilung").html("Der Populations-Bericht '" + bezeichnung + "' wird gelöscht.");
					$("#loeschen_dialog").dialog({
						resizable: false,
						height:'auto',
						width: 400,
						modal: true,
						buttons: {
							"ja, löschen!": function() {
								$(this).dialog("close");
								// Variable zum rückgängig machen erstellen
								window.apf.deleted = window.apf.popber;
								window.apf.deleted.typ = "popber";
								var deletePopber = $.ajax({
									type: 'post',
									url: 'php/popber_delete.php',
									dataType: 'json',
									data: {
										"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
									}
								});
								deletePopber.always(function() {
									delete localStorage.popber_id;
									delete window.apf.popber;
									$.jstree._reference(aktiver_node).delete_node(aktiver_node);
									// Parent Node-Beschriftung: Anzahl anpassen
									window.apf.beschrifte_ordner_popber(parent_node);
									// Hinweis zum rückgängig machen anzeigen
									window.apf.frageObAktionRückgängigGemachtWerdenSoll("Der Populations-Bericht '" + bezeichnung + "' wurde gelöscht.");
								});
								deletePopber.fail(function() {
									//window.apf.melde("Fehler: Der Populations-Bericht wurde nicht gelöscht");
									console.log('Fehler: Der Populations-Bericht wurde nicht gelöscht');
								});
							},
							"abbrechen": function() {
								$(this).dialog("close");
							}
						}
					});
				}
			}
		};
		return items;
	case "pop_ordner_massnber":
		items = {
			"neu": {
				"label": "neuer Massnahmen-Bericht",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertPopMassnBer = $.ajax({
						type: 'post',
						url: 'php/popmassnber_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id")),
							"user": sessionStorage.User
						}
					});
					insertPopMassnBer.always(function(id) {
						var strukturtyp = "popmassnber",
							beschriftung = "neuer Massnahmen-Bericht";
						window.apf.insertNeuenNodeEineHierarchiestufeTiefer(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertPopMassnBer.fail(function() {
						//window.apf.melde("Fehler: Es wurde kein neuer Massnahmen-Bericht erstellt");
						console.log('Fehler: Es wurde kein neuer Massnahmen-Bericht erstellt');
					});
				}
			}
		};
		return items;
	case "popmassnber":
		items = {
			"neu": {
				"label": "neuer Massnahmen-Bericht",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertPopMassnBer_2 = $.ajax({
						type: 'post',
						url: 'php/popmassnber_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(parent_node).attr("id")),
							"typ": "popmassnber",
							"user": sessionStorage.User
						}
					});
					insertPopMassnBer_2.always(function(id) {
						var strukturtyp = "popmassnber",
							beschriftung = "neuer Massnahmen-Bericht";
						window.apf.insertNeuenNodeAufGleicherHierarchiestufe(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertPopMassnBer_2.fail(function() {
						//window.apf.melde("Fehler: Es wurde kein neuer Massnahmen-Bericht erstellt");
						console.log('Fehler: Es wurde kein neuer Massnahmen-Bericht erstellt');
					});
				}
			},
			"loeschen": {
				"label": "löschen",
				"separator_before": true,
				"icon": "style/images/loeschen.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					var bezeichnung = $.jstree._reference(aktiver_node).get_text(aktiver_node);
					$("#loeschen_dialog_mitteilung").html("Der Massnahmen-Bericht '" + bezeichnung + "' wird gelöscht.");
					$("#loeschen_dialog").dialog({
						resizable: false,
						height:'auto',
						width: 400,
						modal: true,
						buttons: {
							"ja, löschen!": function() {
								$(this).dialog("close");
								// Variable zum rückgängig machen erstellen
								window.apf.deleted = window.apf.popmassnber;
								window.apf.deleted.typ = "popmassnber";
								var deletePopMassnBer = $.ajax({
									type: 'post',
									url: 'php/popmassnber_delete.php',
									dataType: 'json',
									data: {
										"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
									}
								});
								deletePopMassnBer.always(function() {
									delete localStorage.popmassnber_id;
									delete window.apf.popmassnber;
									$.jstree._reference(aktiver_node).delete_node(aktiver_node);
									// Parent Node-Beschriftung: Anzahl anpassen
									window.apf.beschrifte_ordner_popmassnber(parent_node);
									// Hinweis zum rückgängig machen anzeigen
									window.apf.frageObAktionRückgängigGemachtWerdenSoll("Der Massnahmen-Bericht '" + bezeichnung + "' wurde gelöscht.");
								});
								deletePopMassnBer.fail(function() {
									//window.apf.melde("Fehler: Der Massnahmen-Bericht wurde nicht gelöscht");
									console.log('Fehler: Der Massnahmen-Bericht wurde nicht gelöscht');
								});
							},
							"abbrechen": function() {
								$(this).dialog("close");
							}
						}
					});
				}
			}
		};
		return items;
	case "tpop_ordner_feldkontr":
		items = {
			"neu": {
				"label": "neue Feldkontrolle",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertTPopFeldKontr = $.ajax({
						type: 'post',
						url: 'php/tpopfeldkontr_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id")),
							"typ": "tpopfeldkontr",
							"user": sessionStorage.User
						}
					});
					insertTPopFeldKontr.always(function(id) {
						var strukturtyp = "tpopfeldkontr",
							beschriftung = "neue Feldkontrolle";
						window.apf.insertNeuenNodeEineHierarchiestufeTiefer(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertTPopFeldKontr.fail(function() {
						//window.apf.melde("Fehler: Keine neue Feldkontrolle erstellt");
						console.log('Fehler: Keine neue Feldkontrolle erstellt');
					});
				}
			}
		};
		if (window.apf.tpopfeldkontr_node_ausgeschnitten) {
			items.einfuegen = {
				"label": $.jstree._reference(window.apf.tpopfeldkontr_node_ausgeschnitten).get_text(window.apf.tpopfeldkontr_node_ausgeschnitten) + " einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					$.jstree._reference(aktiver_node).move_node(window.apf.tpopfeldkontr_node_ausgeschnitten, aktiver_node, "first", false);
				}
			}
		}
		if (window.apf.tpopfeldkontr_node_kopiert) {
			items.einfuegen = {
				"label": $.jstree._reference(window.apf.tpopfeldkontr_node_kopiert).get_text(window.apf.tpopfeldkontr_node_kopiert) + " einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					// und an die DB schicken
					var insertTPopFeldKontrKopie = $.ajax({
						type: 'post',
						url: 'php/tpopfeldkontr_insert_kopie.php',
						dataType: 'json',
						data: {
							"user": sessionStorage.User,
							"TPopId": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id")),
							"TPopKontrId": window.apf.erstelleIdAusDomAttributId($(window.apf.tpopfeldkontr_node_kopiert).attr("id"))
						}
					});
					insertTPopFeldKontrKopie.always(function(id) {
						var strukturtyp = "tpopfeldkontr",
							beschriftung = window.apf.erstelleLabelFürFeldkontrolle(window.apf.tpopfeldkontr_objekt_kopiert.TPopKontrJahr, window.apf.tpopfeldkontr_objekt_kopiert.TPopKontrTyp);
						window.apf.insertNeuenNodeEineHierarchiestufeTiefer(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertTPopFeldKontrKopie.fail(function() {
						//window.apf.melde("Fehler: Die Feldkontrolle wurde nicht erstellt");
						console.log('Fehler: Die Feldkontrolle wurde nicht erstellt');
					});
				}
			}
		}
		return items;
	case "tpopfeldkontr":
		items = {
			"neu": {
				"label": "neue Feldkontrolle",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertTPopFeldKontr_2 = $.ajax({
						type: 'post',
						url: 'php/tpopfeldkontr_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(parent_node).attr("id")),
							"typ": "tpopfeldkontr",
							"user": sessionStorage.User
						}
					});
					insertTPopFeldKontr_2.always(function(id) {
						var strukturtyp = "tpopfeldkontr",
							beschriftung = "neue Feldkontrolle";
						window.apf.insertNeuenNodeAufGleicherHierarchiestufe(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertTPopFeldKontr_2.fail(function() {
						//window.apf.melde("Fehler: Keine neue Feldkontrolle erstellt");
						console.log('Fehler: Keine neue Feldkontrolle erstellt');
					});
				}
			},
			"loeschen": {
				"label": "löschen",
				"separator_before": true,
				"icon": "style/images/loeschen.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					var bezeichnung = $.jstree._reference(aktiver_node).get_text(aktiver_node);
					$("#loeschen_dialog_mitteilung").html("Die Feldkontrolle '" + bezeichnung + "' wird gelöscht.");
					$("#loeschen_dialog").dialog({
						resizable: false,
						height:'auto',
						width: 400,
						modal: true,
						buttons: {
							"ja, löschen!": function() {
								$(this).dialog("close");
								// Variable zum rückgängig machen erstellen
								window.apf.deleted = window.apf.tpopfeldkontr;
								window.apf.deleted.typ = "tpopfeldkontr";
								var deleteTPopFeldKontr = $.ajax({
									type: 'post',
									url: 'php/tpopfeldkontr_delete.php',
									dataType: 'json',
									data: {
										"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
									}
								});
								deleteTPopFeldKontr.always(function() {
									delete localStorage.tpopfeldkontr_id;
									delete window.apf.tpopfeldkontr;
									$.jstree._reference(aktiver_node).delete_node(aktiver_node);
									// Parent Node-Beschriftung: Anzahl anpassen
									window.apf.beschrifte_ordner_tpopfeldkontr(parent_node);
									// Hinweis zum rückgängig machen anzeigen
									window.apf.frageObAktionRückgängigGemachtWerdenSoll("Die Feldkontrolle '" + bezeichnung + "' wurde gelöscht.");
								});
								deleteTPopFeldKontr.fail(function() {
									//window.apf.melde("Fehler: Die Feldkontrolle wurde nicht gelöscht");
									console.log('Fehler: Die Feldkontrolle wurde nicht gelöscht');
								});
							},
							"abbrechen": function() {
								$(this).dialog("close");
							}
						}
					});
				}
			},
			"biotop_kopieren": {
				"label": "Biotop kopieren",
				"separator_before": true,
				"icon": "style/images/kopieren.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					delete window.apf.feldkontr_biotop;
					window.apf.feldkontr_biotop = {};
                    var $TPopKontrFlaeche = $("#TPopKontrFlaeche");
					if ($TPopKontrFlaeche.val()) {
						window.apf.feldkontr_biotop.TPopKontrFlaeche = $TPopKontrFlaeche.val();
					}
                    var $TPopKontrLeb = $("#TPopKontrLeb");
					if ($TPopKontrLeb.val()) {
						window.apf.feldkontr_biotop.TPopKontrLeb = $TPopKontrLeb.val();
					}
                    var $TPopKontrLebUmg = $("#TPopKontrLebUmg");
					if ($TPopKontrLebUmg.val()) {
						window.apf.feldkontr_biotop.TPopKontrLebUmg = $TPopKontrLebUmg.val();
					}
                    var $TPopKontrVegTyp = $("#TPopKontrVegTyp");
					if ($TPopKontrVegTyp.val()) {
						window.apf.feldkontr_biotop.TPopKontrVegTyp = $TPopKontrVegTyp.val();
					}
                    var $TPopKontrKonkurrenz = $("#TPopKontrKonkurrenz");
					if ($TPopKontrKonkurrenz.val()) {
						window.apf.feldkontr_biotop.TPopKontrKonkurrenz = $TPopKontrKonkurrenz.val();
					}
                    var $TPopKontrMoosschicht = $("#TPopKontrMoosschicht");
					if ($TPopKontrMoosschicht.val()) {
						window.apf.feldkontr_biotop.TPopKontrMoosschicht = $TPopKontrMoosschicht.val();
					}
                    var $TPopKontrKrautschicht = $("#TPopKontrKrautschicht");
					if ($TPopKontrKrautschicht.val()) {
						window.apf.feldkontr_biotop.TPopKontrKrautschicht = $TPopKontrKrautschicht.val();
					}
                    var $TPopKontrStrauchschicht = $("#TPopKontrStrauchschicht");
					if ($TPopKontrStrauchschicht.val()) {
						window.apf.feldkontr_biotop.TPopKontrStrauchschicht = $TPopKontrStrauchschicht.val();
					}
                    var $TPopKontrBaumschicht = $("#TPopKontrBaumschicht");
					if ($TPopKontrBaumschicht.val()) {
						window.apf.feldkontr_biotop.TPopKontrBaumschicht = $TPopKontrBaumschicht.val();
					}
                    var $TPopKontrBodenTyp = $("#TPopKontrBodenTyp");
					if ($TPopKontrBodenTyp.val()) {
						window.apf.feldkontr_biotop.TPopKontrBodenTyp = $TPopKontrBodenTyp.val();
					}
                    var $TPopKontrBodenKalkgehalt = $("#TPopKontrBodenKalkgehalt");
					if ($TPopKontrBodenKalkgehalt.val()) {
						window.apf.feldkontr_biotop.TPopKontrBodenKalkgehalt = $TPopKontrBodenKalkgehalt.val();
					}
					if ($("#TPopKontrBodenDurchlaessigkeit").val()) {
						window.apf.feldkontr_biotop.TPopKontrBodenDurchlaessigkeit = $("#TPopKontrBodenDurchlaessigkeit").val();
					}
					if ($("#TPopKontrBodenHumus").val()) {
						window.apf.feldkontr_biotop.TPopKontrBodenHumus = $("#TPopKontrBodenHumus").val();
					}
					if ($("#TPopKontrBodenNaehrstoffgehalt").val()) {
						window.apf.feldkontr_biotop.TPopKontrBodenNaehrstoffgehalt = $("#TPopKontrBodenNaehrstoffgehalt").val();
					}
					if ($("#TPopKontrBodenAbtrag").val()) {
						window.apf.feldkontr_biotop.TPopKontrBodenAbtrag = $("#TPopKontrBodenAbtrag").val();
					}
					if ($("#TPopKontrWasserhaushalt").val()) {
						window.apf.feldkontr_biotop.TPopKontrWasserhaushalt = $("#TPopKontrWasserhaushalt").val();
					}
					if ($("#TPopKontrHandlungsbedarf").val()) {
						window.apf.feldkontr_biotop.TPopKontrHandlungsbedarf = $("#TPopKontrHandlungsbedarf").val();
					}
				}
			}
		};
		if (window.apf.feldkontr_biotop) {
			items.biotop_einfuegen = {
				"label": "Biotop einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					var data = {};
					data.id = window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"));
					data.user = sessionStorage.User;
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
                    _.each(window.apf.feldkontr_biotop, function(value, key) {
                        $("#" + key).val(value);
                        data[key] = value;
                    });
					// jetzt alles speichern
					var updateTPopFeldKontrMultiple = $.ajax({
						type: 'post',
						url: 'php/tpopfeldkontr_update_multiple.php',
						dataType: 'json',
						data: data
					});
					updateTPopFeldKontrMultiple.fail(function() {
						//window.apf.melde("Fehler: Das kopierte Biotop wurde nicht eingefügt");
						console.log('Fehler: Das kopierte Biotop wurde nicht eingefügt');
					});
				}
			}
		}
		if (!window.apf.tpopfeldkontr_node_ausgeschnitten) {
			items.ausschneiden = {
				//"label": "Feldkontrolle ausschneiden<br>&nbsp;&nbsp;&nbsp;Tipp: drag and drop me!",
				"label": "ausschneiden",
				"separator_before": true,
				"icon": "style/images/ausschneiden.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					window.apf.tpopfeldkontr_node_ausgeschnitten = aktiver_node;
					// es macht keinen Sinn mehr, den kopierten node zu behalten
					// und stellt sicher, dass nun der ausgeschnittene mit "einfügen" angeboten wird
					delete window.apf.tpopfeldkontr_node_kopiert;
					delete window.apf.tpopfeldkontr_objekt_kopiert;
				}
			}
		}
		if (!window.apf.tpopfeldkontr_node_ausgeschnitten) {
			items.kopieren = {
				"label": "kopieren",
				"separator_before": true,
				"icon": "style/images/kopieren.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					window.apf.tpopfeldkontr_node_kopiert = aktiver_node;
					// Daten des Objekts holen
					var getTPopFeldkontr_2 = $.ajax({
						type: 'get',
						url: 'php/tpopfeldkontr.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(window.apf.tpopfeldkontr_node_kopiert).attr("id"))
						}
					});
					getTPopFeldkontr_2.always(function(data) {
						window.apf.tpopfeldkontr_objekt_kopiert = data;
					});
					getTPopFeldkontr_2.fail(function() {
						//window.apf.melde("Fehler: Die Feldkontrolle wurde nicht kopiert");
						console.log('Fehler: Die Feldkontrolle wurde nicht kopiert');
					});
				}
			}
		}
		if (window.apf.tpopfeldkontr_node_ausgeschnitten) {
			items.einfuegen = {
				"label": $.jstree._reference(window.apf.tpopfeldkontr_node_ausgeschnitten).get_text(window.apf.tpopfeldkontr_node_ausgeschnitten) + " einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					$.jstree._reference(parent_node).move_node(window.apf.tpopfeldkontr_node_ausgeschnitten, parent_node, "first", false);
				}
			}
		}
		if (window.apf.tpopfeldkontr_node_kopiert) {
			items.einfuegen = {
				"label": $.jstree._reference(window.apf.tpopfeldkontr_node_kopiert).get_text(window.apf.tpopfeldkontr_node_kopiert) + " einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					// und an die DB schicken
					var insertTPopFeldKontrKopie_2 = $.ajax({
						type: 'post',
						url: 'php/tpopfeldkontr_insert_kopie.php',
						dataType: 'json',
						data: {
							"user": sessionStorage.User,
							"TPopId": window.apf.erstelleIdAusDomAttributId($(parent_node).attr("id")),
							"TPopKontrId": window.apf.erstelleIdAusDomAttributId($(window.apf.tpopfeldkontr_node_kopiert).attr("id"))
						}
					});
					insertTPopFeldKontrKopie_2.always(function(id) {
						var strukturtyp = "tpopfeldkontr",
							beschriftung = window.apf.erstelleLabelFürFeldkontrolle(window.apf.tpopfeldkontr_objekt_kopiert.TPopKontrJahr, window.apf.tpopfeldkontr_objekt_kopiert.TPopKontrTyp);
						window.apf.insertNeuenNodeAufGleicherHierarchiestufe(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertTPopFeldKontrKopie_2.fail(function() {
						//window.apf.melde("Fehler: Die Feldkontrolle wurde nicht erstellt");
						console.log('Fehler: Die Feldkontrolle wurde nicht erstellt');
					});
				}
			}
		}
		return items;
	case "tpop_ordner_freiwkontr":
		items = {
			"neu": {
				"label": "neue Freiwilligen-Kontrolle",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertTPopFeldKontr_3 = $.ajax({
						type: 'post',
						url: 'php/tpopfeldkontr_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id")),
							"user": sessionStorage.User,
							"typ": "Freiwilligen-Erfolgskontrolle"
						}
					});
					insertTPopFeldKontr_3.always(function(id) {
						var strukturtyp = "tpopfreiwkontr",
							beschriftung = "neue Freiwilligen-Kontrolle";
						window.apf.insertNeuenNodeEineHierarchiestufeTiefer(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertTPopFeldKontr_3.fail(function() {
						//window.apf.melde("Fehler: Keine neue Freiwilligen-Kontrolle erstellt");
						console.log('Fehler: Keine neue Freiwilligen-Kontrolle erstellt');
					});
				}
			}
		};
		if (window.apf.tpopfreiwkontr_node_ausgeschnitten) {
			items.einfuegen = {
				"label": $.jstree._reference(window.apf.tpopfreiwkontr_node_ausgeschnitten).get_text(window.apf.tpopfreiwkontr_node_ausgeschnitten) + " einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					$.jstree._reference(aktiver_node).move_node(window.apf.tpopfreiwkontr_node_ausgeschnitten, aktiver_node, "first", false);
				}
			}
		}
		if (window.apf.tpopfreiwkontr_node_kopiert) {
			items.einfuegen = {
				"label": $.jstree._reference(window.apf.tpopfreiwkontr_node_kopiert).get_text(window.apf.tpopfreiwkontr_node_kopiert) + " einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					// und an die DB schicken
					var insertTPopFeldKontrKopie_3 = $.ajax({
						type: 'post',
						url: 'php/tpopfeldkontr_insert_kopie.php',
						dataType: 'json',
						data: {
							"user": sessionStorage.User,
							"TPopId": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id")),
							"TPopKontrId": window.apf.erstelleIdAusDomAttributId($(window.apf.tpopfreiwkontr_node_kopiert).attr("id"))
						}
					});
					insertTPopFeldKontrKopie_3.always(function(id) {
						var strukturtyp = "tpopfreiwkontr",
							beschriftung = window.apf.tpopfreiwkontr_objekt_kopiert.TPopKontrJahr;
						window.apf.insertNeuenNodeEineHierarchiestufeTiefer(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertTPopFeldKontrKopie_3.fail(function() {
						//window.apf.melde("Fehler: Die Freiwilligen-Kontrolle wurde nicht erstellt");
						console.log('Fehler: Die Freiwilligen-Kontrolle wurde nicht erstellt');
					});
				}
			}
		}
		return items;
	case "tpopfreiwkontr":
		items = {
			"neu": {
				"label": "neue Freiwilligen-Kontrolle",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertTPopFeldKontr_4 = $.ajax({
						type: 'post',
						url: 'php/tpopfeldkontr_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(parent_node).attr("id")),
							"user": sessionStorage.User,
							"typ": "Freiwilligen-Erfolgskontrolle"
						}
					});
					insertTPopFeldKontr_4.always(function(id) {
						var strukturtyp = "tpopfreiwkontr",
							beschriftung = "neue Freiwilligen-Kontrolle";
						window.apf.insertNeuenNodeAufGleicherHierarchiestufe(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertTPopFeldKontr_4.fail(function() {
						//window.apf.melde("Fehler: Keine neue Freiwilligen-Kontrolle erstellt");
						console.log('Fehler: Keine neue Freiwilligen-Kontrolle erstellt');
					});
				}
			},
			"loeschen": {
				"label": "löschen",
				"separator_before": true,
				"icon": "style/images/loeschen.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					var bezeichnung = $.jstree._reference(aktiver_node).get_text(aktiver_node);
					$("#loeschen_dialog_mitteilung").html("Die Freiwilligen-Kontrolle '" + bezeichnung + "' wird gelöscht.");
					$("#loeschen_dialog").dialog({
						resizable: false,
						height:'auto',
						width: 400,
						modal: true,
						buttons: {
							"ja, löschen!": function() {
								$(this).dialog("close");
								// Variable zum rückgängig machen erstellen
								window.apf.deleted = window.apf.tpopfeldkontr;
								window.apf.deleted.typ = "tpopfreiwkontr";
								var deleteTPopFeldKontr_2 = $.ajax({
									type: 'post',
									url: 'php/tpopfeldkontr_delete.php',
									dataType: 'json',
									data: {
										"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
									}
								});
								deleteTPopFeldKontr_2.always(function() {
									delete localStorage.tpopfeldkontr_id;
									delete localStorage.tpopfreiwkontr;
									delete window.apf.tpopfeldkontr;
									$.jstree._reference(aktiver_node).delete_node(aktiver_node);
									// Parent Node-Beschriftung: Anzahl anpassen
									window.apf.beschrifte_ordner_tpopfreiwkontr(parent_node);
									// Hinweis zum rückgängig machen anzeigen
									window.apf.frageObAktionRückgängigGemachtWerdenSoll("Die Freiwilligen-Kontrolle '" + bezeichnung + "' wurde gelöscht.");
								});
								deleteTPopFeldKontr_2.fail(function() {
									//window.apf.melde("Fehler: Die Freiwilligen-Kontrolle wurde nicht gelöscht");
									console.log('Fehler: Die Freiwilligen-Kontrolle wurde nicht gelöscht');
								});
							},
							"abbrechen": function() {
								$(this).dialog("close");
							}
						}
					});
				}
			}
		};
		if (!window.apf.tpopfreiwkontr_node_ausgeschnitten) {
			items.ausschneiden = {
				//"label": "ausschneiden<br>&nbsp;&nbsp;&nbsp;Tipp: drag and drop me!",
				"label": "ausschneiden",
				"separator_before": true,
				"icon": "style/images/ausschneiden.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					window.apf.tpopfreiwkontr_node_ausgeschnitten = aktiver_node;
					// es macht keinen Sinn mehr, den kopierten node zu behalten
					// und stellt sicher, dass nun der ausgeschnittene mit "einfügen" angeboten wird
					delete window.apf.tpopfreiwkontr_node_kopiert;
					delete window.apf.tpopfreiwkontr_objekt_kopiert;
				}
			}
		}
		if (!window.apf.tpopfreiwkontr_node_ausgeschnitten) {
			items.kopieren = {
				"label": "kopieren",
				"separator_before": true,
				"icon": "style/images/kopieren.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					window.apf.tpopfreiwkontr_node_kopiert = aktiver_node;
					// Daten des Objekts holen
					var getTPopFeldkontr_3 = $.ajax({
						type: 'get',
						url: 'php/tpopfeldkontr.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(window.apf.tpopfreiwkontr_node_kopiert).attr("id"))
						}
					});
					getTPopFeldkontr_3.always(function(data) {
						window.apf.tpopfreiwkontr_objekt_kopiert = data;
					});
					getTPopFeldkontr_3.fail(function() {
						//window.apf.melde("Fehler: Die Freiwilligen-Kontrolle wurde nicht kopiert");
						console.log('Fehler: Die Freiwilligen-Kontrolle wurde nicht kopiert');
					});
				}
			}
		}
		if (window.apf.tpopfreiwkontr_node_ausgeschnitten) {
			items.einfuegen = {
				"label": $.jstree._reference(window.apf.tpopfreiwkontr_node_ausgeschnitten).get_text(window.apf.tpopfreiwkontr_node_ausgeschnitten) + " einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					$.jstree._reference(parent_node).move_node(window.apf.tpopfreiwkontr_node_ausgeschnitten, parent_node, "first", false);
					localStorage.tpopfreiwkontr = true;
				}
			}
		}
		if (window.apf.tpopfreiwkontr_node_kopiert) {
			items.einfuegen = {
				"label": $.jstree._reference(window.apf.tpopfreiwkontr_node_kopiert).get_text(window.apf.tpopfreiwkontr_node_kopiert) + " einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					var insertTPopFeldKontrKopie_4 = $.ajax({
						type: 'post',
						url: 'php/tpopfeldkontr_insert_kopie.php',
						dataType: 'json',
						data: {
							"user": sessionStorage.User,
							"TPopId": window.apf.erstelleIdAusDomAttributId($(parent_node).attr("id")),
							"TPopKontrId": window.apf.erstelleIdAusDomAttributId($(window.apf.tpopfreiwkontr_node_kopiert).attr("id"))
						}
					});
					insertTPopFeldKontrKopie_4.always(function(id) {
						var strukturtyp = "tpopfreiwkontr",
							beschriftung = window.apf.tpopfreiwkontr_objekt_kopiert.TPopKontrJahr;
						window.apf.insertNeuenNodeAufGleicherHierarchiestufe(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertTPopFeldKontrKopie_4.fail(function() {
						//window.apf.melde("Fehler: Die Freiwilligen-Kontrolle wurde nicht erstellt");
						console.log('Fehler: Die Freiwilligen-Kontrolle wurde nicht erstellt');
					});
				}
			}
		}
		return items;
	case "tpop_ordner_massn":
		items = {
			"neu": {
				"label": "neue Massnahme",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertTPopMassn = $.ajax({
						type: 'post',
						url: 'php/tpopmassn_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id")),
							"typ": "tpopmassn",
							"user": sessionStorage.User
						}
					});
					insertTPopMassn.always(function(id) {
						var strukturtyp = "tpopmassn",
							beschriftung = "neue Massnahme";
						window.apf.insertNeuenNodeEineHierarchiestufeTiefer(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertTPopMassn.fail(function() {
						//window.apf.melde("Fehler: Keine neue Massnahme erstellt");
						console.log('Fehler: Keine neue Massnahme erstellt');
					});
				}
			}
		};
		if (window.apf.tpopmassn_node_ausgeschnitten) {
			items.einfuegen = {
				"label": $.jstree._reference(window.apf.tpopmassn_node_ausgeschnitten).get_text(window.apf.tpopmassn_node_ausgeschnitten) + " einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					$.jstree._reference(aktiver_node).move_node(window.apf.tpopmassn_node_ausgeschnitten, aktiver_node, "first", false);
				}
			}
		}
		if (window.apf.tpopmassn_node_kopiert) {
			items.einfuegen = {
				"label": $.jstree._reference(window.apf.tpopmassn_node_kopiert).get_text(window.apf.tpopmassn_node_kopiert) + " einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					var insertTPopMassnKopie = $.ajax({
						type: 'post',
						url: 'php/tpopmassn_insert_kopie.php',
						dataType: 'json',
						data: {
							"user": sessionStorage.User,
							"TPopId": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id")),
							"TPopMassnId": window.apf.erstelleIdAusDomAttributId($(window.apf.tpopmassn_node_kopiert).attr("id"))
						}
					});
					insertTPopMassnKopie.always(function(id) {
						var strukturtyp = "tpopmassn",
							beschriftung = window.apf.erstelleLabelFürMassnahme(window.apf.tpopmassn_objekt_kopiert.TPopMassnJahr, window.apf.tpopmassn_objekt_kopiert.TPopMassnBerErfolgsbeurteilung_txt);
						window.apf.insertNeuenNodeEineHierarchiestufeTiefer(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertTPopMassnKopie.fail(function() {
						//window.apf.melde("Fehler: Die Massnahme wurde nicht erstellt");
						console.log('Fehler: Die Massnahme wurde nicht erstellt');
					});
				}
			}
		}
		return items;
	case "tpopmassn":
		items = {
			"neu": {
				"label": "neue Massnahme",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertTPopMassn_2 = $.ajax({
						type: 'post',
						url: 'php/tpopmassn_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(parent_node).attr("id")),
							"typ": "tpopmassn",
							"user": sessionStorage.User
						}
					});
					insertTPopMassn_2.always(function(id) {
						var strukturtyp = "tpopmassn",
							beschriftung = "neue Massnahme";
						window.apf.insertNeuenNodeAufGleicherHierarchiestufe(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertTPopMassn_2.fail(function() {
						//window.apf.melde("Fehler: Keine neue Massnahme erstellt");
						console.log('Fehler: Keine neue Massnahme erstellt');
					});
				}
			},
			"loeschen": {
				"label": "löschen",
				"separator_before": true,
				"icon": "style/images/loeschen.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					var bezeichnung = $.jstree._reference(aktiver_node).get_text(aktiver_node);
					$("#loeschen_dialog_mitteilung").html("Die Massnahme '" + bezeichnung + "' wird gelöscht.");
					$("#loeschen_dialog").dialog({
						resizable: false,
						height:'auto',
						width: 400,
						modal: true,
						buttons: {
							"ja, löschen!": function() {
								$(this).dialog("close");
								// Variable zum rückgängig machen erstellen
								window.apf.deleted = window.apf.tpopmassn;
								window.apf.deleted.typ = "tpopmassn";
								var deleteTPopMassn = $.ajax({
									type: 'post',
									url: 'php/tpopmassn_delete.php',
									dataType: 'json',
									data: {
										"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
									}
								});
								deleteTPopMassn.always(function() {
									delete localStorage.tpopmassn_id;
									delete window.apf.tpopmassn;
									$.jstree._reference(aktiver_node).delete_node(aktiver_node);
									// Parent Node-Beschriftung: Anzahl anpassen
									window.apf.beschrifte_ordner_tpopmassn(parent_node);
									// Hinweis zum rückgängig machen anzeigen
									window.apf.frageObAktionRückgängigGemachtWerdenSoll("Die Massnahme '" + bezeichnung + "' wurde gelöscht.");
								});
								deleteTPopMassn.fail(function() {
									//window.apf.melde("Fehler: Die Massnahme wurde nicht gelöscht");
									console.log('Fehler: Die Massnahme wurde nicht gelöscht');
								});
							},
							"abbrechen": function() {
								$(this).dialog("close");
							}
						}
					});
				}
			}
		};
		if (!window.apf.tpopmassn_node_ausgeschnitten) {
			items.ausschneiden = {
				//"label": "ausschneiden<br>&nbsp;&nbsp;&nbsp;Tipp: drag and drop me!",
				"label": "ausschneiden",
				"separator_before": true,
				"icon": "style/images/ausschneiden.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					window.apf.tpopmassn_node_ausgeschnitten = aktiver_node;
					// es macht keinen Sinn mehr, den kopierten node zu behalten
					// und stellt sicher, dass nun der ausgeschnittene mit "einfügen" angeboten wird
					delete window.apf.tpopmassn_node_kopiert;
					delete window.apf.tpopmassn_objekt_kopiert;
				}
			}
		}
		if (!window.apf.tpopmassn_node_ausgeschnitten) {
			items.kopieren = {
				"label": "kopieren",
				"separator_before": true,
				"icon": "style/images/kopieren.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					window.apf.tpopmassn_node_kopiert = aktiver_node;
					// Daten des Objekts holen
					var getTPopMassn_2 = $.ajax({
                            type: 'get',
                            url: 'php/tpopmassn.php',
                            dataType: 'json',
                            data: {
                                "id": window.apf.erstelleIdAusDomAttributId($(window.apf.tpopmassn_node_kopiert).attr("id"))
                            }
                        }),
                        $TPopMassnTypChecked = $("#TPopMassnTyp option:checked");
					getTPopMassn_2.always(function(data) {
						window.apf.tpopmassn_objekt_kopiert = data;
						// den Beurteilungstext holen - ist nur mühsam aus der DB zu holen
						window.apf.tpopmassn_objekt_kopiert.TPopMassnBerErfolgsbeurteilung_txt = "";
						if ($TPopMassnTypChecked.text()) {
							window.apf.tpopmassn_objekt_kopiert.TPopMassnBerErfolgsbeurteilung_txt = $TPopMassnTypChecked.text();
						}
					});
					getTPopMassn_2.fail(function() {
						//window.apf.melde("Fehler: Die Massnahme wurde nicht kopiert");
						console.log('Fehler: Die Massnahme wurde nicht kopiert');
					});
				}
			}
		}
		if (window.apf.tpopmassn_node_ausgeschnitten) {
			items.einfuegen = {
				"label": $.jstree._reference(window.apf.tpopmassn_node_ausgeschnitten).get_text(window.apf.tpopmassn_node_ausgeschnitten) + " einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					$.jstree._reference(parent_node).move_node(window.apf.tpopmassn_node_ausgeschnitten, parent_node, "first", false);
				}
			}
		}
		if (window.apf.tpopmassn_node_kopiert) {
			items.einfuegen = {
				"label": $.jstree._reference(window.apf.tpopmassn_node_kopiert).get_text(window.apf.tpopmassn_node_kopiert) + " einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					var insertTPopMassnKopie_2 = $.ajax({
						type: 'post',
						url: 'php/tpopmassn_insert_kopie.php',
						dataType: 'json',
						data: {
							"user": sessionStorage.User,
							"TPopId": window.apf.erstelleIdAusDomAttributId($(parent_node).attr("id")),
							"TPopMassnId": window.apf.erstelleIdAusDomAttributId($(window.apf.tpopmassn_node_kopiert).attr("id"))
						}
					});
					insertTPopMassnKopie_2.always(function(id) {
						var strukturtyp = "tpopmassn",
							beschriftung = window.apf.erstelleLabelFürMassnahme(window.apf.tpopmassn_objekt_kopiert.TPopMassnJahr, window.apf.tpopmassn_objekt_kopiert.TPopMassnBerErfolgsbeurteilung_txt);
						window.apf.insertNeuenNodeAufGleicherHierarchiestufe(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertTPopMassnKopie_2.fail(function() {
						//window.apf.melde("Fehler: Die Massnahme wurde nicht erstellt");
						console.log('Fehler: Die Massnahme wurde nicht erstellt');
					});
				}
			}
		}
		return items;
	case "tpop_ordner_tpopber":
		items = {
			"neu": {
				"label": "neuer Teilpopulations-Bericht",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertTPopBer = $.ajax({
						type: 'post',
						url: 'php/tpopber_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id")),
							"user": sessionStorage.User
						}
					});
					insertTPopBer.always(function(id) {
						var strukturtyp = "tpopber",
							beschriftung = "neuer Teilpopulations-Bericht";
						window.apf.insertNeuenNodeEineHierarchiestufeTiefer(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertTPopBer.fail(function() {
						//window.apf.melde("Fehler: Keinen neuen Teilpopulations-Bericht erstellt");
						console.log('Fehler: Keinen neuen Teilpopulations-Bericht erstellt');
					});
				}
			}
		};
		return items;
	case "tpopber":
		items = {
			"neu": {
				"label": "neuer Teilpopulations-Bericht",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertTPopBer_2 = $.ajax({
						type: 'post',
						url: 'php/tpopber_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(parent_node).attr("id")),
							"typ": "tpopber",
							"user": sessionStorage.User
						}
					});
					insertTPopBer_2.always(function(id) {
						var strukturtyp = "tpopber",
							beschriftung = "neuer Teilpopulations-Bericht";
						window.apf.insertNeuenNodeAufGleicherHierarchiestufe(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertTPopBer_2.fail(function() {
						//window.apf.melde("Fehler: Keinen neuen Teilpopulations-Bericht erstellt");
						console.log('Fehler: Keinen neuen Teilpopulations-Bericht erstellt');
					});
				}
			},
			"loeschen": {
				"label": "löschen",
				"separator_before": true,
				"icon": "style/images/loeschen.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					var bezeichnung = $.jstree._reference(aktiver_node).get_text(aktiver_node);
					$("#loeschen_dialog_mitteilung").html("Der Teilpopulations-Bericht '" + bezeichnung + "' wird gelöscht.");
					$("#loeschen_dialog").dialog({
						resizable: false,
						height:'auto',
						width: 400,
						modal: true,
						buttons: {
							"ja, löschen!": function() {
								$(this).dialog("close");
								// Variable zum rückgängig machen erstellen
								window.apf.deleted = window.apf.tpopber;
								window.apf.deleted.typ = "tpopber";
								var deleteTPopBer = $.ajax({
									type: 'post',
									url: 'php/tpopber_delete.php',
									dataType: 'json',
									data: {
										"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
									}
								});
								deleteTPopBer.always(function() {
									delete localStorage.tpopber_id;
									delete window.apf.tpopber;
									$.jstree._reference(aktiver_node).delete_node(aktiver_node);
									// Parent Node-Beschriftung: Anzahl anpassen
									window.apf.beschrifte_ordner_tpopber(parent_node);
									// Hinweis zum rückgängig machen anzeigen
									window.apf.frageObAktionRückgängigGemachtWerdenSoll("Der Teilpopulations-Bericht '" + bezeichnung + "' wurde gelöscht.");
								});
								deleteTPopBer.fail(function() {
									//window.apf.melde("Fehler: Der Teilpopulations-Bericht wurde nicht gelöscht");
									console.log('Fehler: Der Teilpopulations-Bericht wurde nicht gelöscht');
								});
							},
							"abbrechen": function() {
								$(this).dialog("close");
							}
						}
					});
				}
			}
		};
		return items;
	case "tpop_ordner_beob_zugeordnet":
		items = {
			"GoogleMaps": {
				"label": "auf Luftbild zeigen",
				"separator_before": true,
				"icon": "style/images/flora_icon.png",
				"action": function() {
					var getBeobKarte = $.ajax({
						type: 'get',
						url: 'php/beob_karte.php',
						dataType: 'json',
						data: {
							"tpop_id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
						}
					});
					getBeobKarte.always(function(data) {
						if (data.rows.length > 0) {
							window.apf.gmap.zeigeTPopBeob(data);
						} else {
							window.apf.melde("Es gibt keine Beobachtungen mit Koordinaten", "Aktion abgebrochen");
						}
					});
					getBeobKarte.fail(function() {
						//window.apf.melde("Fehler: Keine Daten erhalten");
						console.log('Fehler: Keine Daten erhalten');
					});
				}
			}
		};
		if (window.apf.beob_zugeordnet_node_ausgeschnitten) {
			items = {};
			items.einfuegen = {
				"label": $.jstree._reference(window.apf.beob_zugeordnet_node_ausgeschnitten).get_text(window.apf.beob_zugeordnet_node_ausgeschnitten) + " einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					$.jstree._reference(aktiver_node).move_node(window.apf.beob_zugeordnet_node_ausgeschnitten, aktiver_node, "first", false);
				}
			}
		}
		if (window.apf.beob_node_ausgeschnitten) {
			items.einfuegen = {
				"label": $.jstree._reference(window.apf.beob_node_ausgeschnitten).get_text(window.apf.beob_node_ausgeschnitten) + " einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					$("#tree").jstree("move_node", window.apf.beob_node_ausgeschnitten, aktiver_node, "first");
				}
			}
		}
		return items;
	case "beob_zugeordnet":
		items = {
			"GoogleMaps": {
				"label": "auf Luftbild zeigen",
				"separator_before": true,
				"icon": "style/images/flora_icon.png",
				"action": function() {
					var getBeobKarte_2 = $.ajax({
						type: 'get',
						url: 'php/beob_karte.php',
						dataType: 'json',
						data: {
							"beobid": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
						}
					});
					getBeobKarte_2.always(function(data) {
						if (data.rows.length > 0) {
							window.apf.gmap.zeigeTPopBeob(data);
						} else {
							window.apf.melde("Die Beobachtung hat keine Koordinaten", "Aktion abgebrochen");
						}
					});
					getBeobKarte_2.fail(function() {
						//window.apf.melde("Fehler: Keine Daten erhalten");
						console.log('Fehler: Keine Daten erhalten');
					});
				}
			},
			"GoogleMapsMitTPopTPopBeob": {
				"label": "auf Luftbild einer neuen<br>&nbsp;&nbsp;&nbsp;Teilpopulation zuordnen",
				"separator_before": true,
				"icon": "style/images/flora_icon_violett.png",
				"action": function() {
					var getBeobKarte_3 = $.ajax({
						type: 'get',
						url: 'php/beob_karte.php',
						dataType: 'json',
						data: {
							"beobid": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
						}
					});
					getBeobKarte_3.always(function(beob) {
						if (beob.rows.length > 0) {
							var getApKarte = $.ajax({
								type: 'get',
								url: 'php/ap_karte.php',
								dataType: 'json',
								data: {
									"id": localStorage.ap_id
								}
							});
							getApKarte.always(function(tpop) {
								if (tpop.rows.length > 0) {
									window.apf.gmap.zeigeBeobUndTPop(beob, tpop);
								} else {
									window.apf.gmap.zeigeBeob(beob);
								}
							});
						} else {
							window.apf.melde("Die Beobachtung hat keine Koordinaten<br>Bitte im Formular zuordnen", "Aktion abgebrochen");
						}
					});
					getBeobKarte_3.fail(function() {
						//window.apf.melde("Fehler: Keine Daten erhalten");
						console.log('Fehler: Keine Daten erhalten');
					});
				}
			},
			"GisBrowser": {
				"label": "im GIS-Browser zeigen",
				"separator_before": true,
				"icon": "style/images/wappen_zuerich.png",
				"action": function() {
					window.apf.zeigeBeobKoordinatenImGisBrowser();
				}
			}
		};
		if (!window.apf.beob_zugeordnet_node_ausgeschnitten) {
			items.ausschneiden = {
				//"label": "ausschneiden<br>&nbsp;&nbsp;&nbsp;Tipp: drag and drop me!",
				"label": "ausschneiden",
				"separator_before": true,
				"icon": "style/images/ausschneiden.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					window.apf.beob_zugeordnet_node_ausgeschnitten = aktiver_node;
				}
			}
		}
		if (window.apf.beob_zugeordnet_node_ausgeschnitten) {
			items.einfuegen_beob_zugeordnet = {
				"label": $.jstree._reference(window.apf.beob_zugeordnet_node_ausgeschnitten).get_text(window.apf.beob_zugeordnet_node_ausgeschnitten) + " einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					$.jstree._reference(parent_node).move_node(window.apf.beob_zugeordnet_node_ausgeschnitten, parent_node, "first", false);
				}
			}
		}
		if (window.apf.beob_node_ausgeschnitten) {
			items.einfuegen_beob = {
				"label": $.jstree._reference(window.apf.beob_node_ausgeschnitten).get_text(window.apf.beob_node_ausgeschnitten) + " einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					$.jstree._reference(parent_node).move_node(window.apf.beob_node_ausgeschnitten, parent_node, "first", false);
				}
			}
		}
		return items;
	case "tpop_ordner_massnber":
		items = {
			"neu": {
				"label": "neuer Massnahmen-Bericht",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertTPopMassnBer = $.ajax({
						type: 'post',
						url: 'php/tpopmassnber_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id")),
							"user": sessionStorage.User
						}
					});
					insertTPopMassnBer.always(function(id) {
						var strukturtyp = "tpopmassnber",
							beschriftung = "neuer Massnahmen-Bericht";
						window.apf.insertNeuenNodeEineHierarchiestufeTiefer(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertTPopMassnBer.fail(function() {
						//window.apf.melde("Fehler: Keinen neuen Massnahmen-Bericht erstellt");
						console.log('Fehler: Keinen neuen Massnahmen-Bericht erstellt');
					});
				}
			}
		};
		return items;
	case "tpopmassnber":
		items = {
			"neu": {
				"label": "neuer Massnahmen-Bericht",
				"icon": "style/images/neu.png",
				"action": function() {
					var insertTPopMassBer_2 = $.ajax({
						type: 'post',
						url: 'php/tpopmassnber_insert.php',
						dataType: 'json',
						data: {
							"id": window.apf.erstelleIdAusDomAttributId($(parent_node).attr("id")),
							"typ": "tpopmassnber",
							"user": sessionStorage.User
						}
					});
					insertTPopMassBer_2.always(function(id) {
						var strukturtyp = "tpopmassnber",
							beschriftung = "neuer Massnahmen-Bericht";
						window.apf.insertNeuenNodeAufGleicherHierarchiestufe(aktiver_node, parent_node, strukturtyp, id, beschriftung);
					});
					insertTPopMassBer_2.fail(function() {
						//window.apf.melde("Fehler: Keinen neuen Massnahmen-Bericht erstellt");
						console.log('Fehler: Keinen neuen Massnahmen-Bericht erstellt');
					});
				}
			},
			"loeschen": {
				"label": "löschen",
				"separator_before": true,
				"icon": "style/images/loeschen.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					var bezeichnung = $.jstree._reference(aktiver_node).get_text(aktiver_node);
					$("#loeschen_dialog_mitteilung").html("Der Massnahmen-Bericht '" + bezeichnung + "' wird gelöscht.");
					$("#loeschen_dialog").dialog({
						resizable: false,
						height:'auto',
						width: 400,
						modal: true,
						buttons: {
							"ja, löschen!": function() {
								$(this).dialog("close");
								// Variable zum rückgängig machen erstellen
								window.apf.deleted = window.apf.tpopmassnber;
								window.apf.deleted.typ = "tpopmassnber";
								var deleteTPopMassnBer = $.ajax({
									type: 'post',
									url: 'php/tpopmassnber_delete.php',
									dataType: 'json',
									data: {
										"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
									}
								});
								deleteTPopMassnBer.always(function() {
									delete localStorage.tpopmassnber_id;
									delete window.apf.tpopmassnber;
									$.jstree._reference(aktiver_node).delete_node(aktiver_node);
									// Parent Node-Beschriftung: Anzahl anpassen
									window.apf.beschrifte_ordner_popmassnber(parent_node);
									// Hinweis zum rückgängig machen anzeigen
									window.apf.frageObAktionRückgängigGemachtWerdenSoll("Der Massnahmen-Bericht '" + bezeichnung + "' wurde gelöscht.");
								});
								deleteTPopMassnBer.fail(function() {
									//window.apf.melde("Fehler: Der Massnahmen-Bericht wurde nicht gelöscht");
									console.log('Fehler: Der Massnahmen-Bericht wurde nicht gelöscht');
								});
							},
							"abbrechen": function() {
								$(this).dialog("close");
							}
						}
					});
				}
			}
		};
		return items;
	case "ap_ordner_beob_nicht_beurteilt":
		items = {
			"GoogleMaps": {
				"label": "auf Luftbild zeigen",
				"separator_before": true,
				"icon": "style/images/flora_icon_violett.png",
				"action": function() {
					var getBeobKarte_4 = $.ajax({
						type: 'get',
						url: 'php/beob_karte.php',
						dataType: 'json',
						data: {
							"apart_id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
						}
					});
					getBeobKarte_4.always(function(data) {
						if (data.rows.length > 0) {
							window.apf.gmap.zeigeBeob(data);
						} else {
							window.apf.melde("Es gibt keine Beobachtung mit Koordinaten", "Aktion abgebrochen");
						}
					});
					getBeobKarte_4.fail(function() {
						//window.apf.melde("Fehler: Keine Daten erhalten");
						console.log('Fehler: Keine Daten erhalten');
					});
				}
			},
			"GoogleMapsMitTPop": {
				"label": "auf Luftbild Teilpopulationen<br>&nbsp;&nbsp;&nbsp;zuordnen<br>&nbsp;&nbsp;&nbsp;Tipp: Beobachtungen auf<br>&nbsp;&nbsp;&nbsp;Teilpopulationen ziehen!",
				"separator_before": true,
				"icon": "style/images/flora_icon_violett.png",
				"action": function() {
					var getBeobKarte_5 = $.ajax({
						type: 'get',
						url: 'php/beob_karte.php',
						dataType: 'json',
						data: {
							"apart_id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
						}
					});
					getBeobKarte_5.always(function(beob) {
						if (beob.rows.length > 0) {
							$.ajax({
								type: 'get',
								url: 'php/ap_karte.php',
								dataType: 'json',
								data: {
									"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
								},
								success: function(tpop) {
									if (tpop.rows.length > 0) {
										window.apf.gmap.zeigeBeobUndTPop(beob, tpop);
									} else {
										window.apf.gmap.zeigeBeob(beob);
									}
								}
							});
						} else {
							window.apf.melde("Es gibt keine Beobachtung mit Koordinaten", "Aktion abgebrochen");
						}
					});
					getBeobKarte_5.fail(function() {
						//window.apf.melde("Fehler: Keine Daten erhalten");
						console.log('Fehler: Keine Daten erhalten');
					});
				}
			}
		};
		if (window.apf.beob_zugeordnet_node_ausgeschnitten) {
			items.einfuegen = {
				"label": $.jstree._reference(window.apf.beob_zugeordnet_node_ausgeschnitten).get_text(window.apf.beob_zugeordnet_node_ausgeschnitten) + " einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					$("#tree").jstree("move_node", window.apf.beob_zugeordnet_node_ausgeschnitten, aktiver_node, "first");
				}
			}
		}
		return items;
	case "beob_nicht_beurteilt":
		items = {
			"GoogleMaps": {
				"label": "auf Luftbild zeigen",
				"separator_before": true,
				"icon": "style/images/flora_icon_violett.png",
				"action": function() {
					var getBeobKarte_6 = $.ajax({
						type: 'get',
						url: 'php/beob_karte.php',
						dataType: 'json',
						data: {
							"beobid": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
						}
					});
					getBeobKarte_6.always(function(data) {
						if (data.rows.length > 0) {
							window.apf.gmap.zeigeBeob(data);
						} else {
							window.apf.melde("Es gibt keine Beobachtung mit Koordinaten", "Aktion abgebrochen");
						}
					});
					getBeobKarte_6.fail(function() {
						//window.apf.melde("Fehler: Keine Daten erhalten");
						console.log('Fehler: Keine Daten erhalten');
					});
				}
			},
			"GoogleMapsMitTPopBeob": {
				"label": "auf Luftbild einer Teilpopulation<br>&nbsp;&nbsp;&nbsp;zuordnen",
				"separator_before": true,
				"icon": "style/images/flora_icon_violett.png",
				"action": function() {
					var getBeobKarte_7 = $.ajax({
						type: 'get',
						url: 'php/beob_karte.php',
						dataType: 'json',
						data: {
							"beobid": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
						}
					});
					getBeobKarte_7.always(function(beob) {
						if (beob.rows.length > 0) {
							var getApKarte_2 = $.ajax({
								type: 'get',
								url: 'php/ap_karte.php',
								dataType: 'json',
								data: {
									"id": window.apf.erstelleIdAusDomAttributId($(parent_node).attr("id"))
								}
							});
							getApKarte_2.always(function(tpop) {
								if (tpop.rows.length > 0) {
									window.apf.gmap.zeigeBeobUndTPop(beob, tpop);
								} else {
									window.apf.gmap.zeigeBeob(beob);
								}
							});
						} else {
							window.apf.melde("Die Beobachtung hat keine Koordinaten<br>Bitte im Formular zuordnen", "Aktion abgebrochen");
						}
					});
					getBeobKarte_7.fail(function() {
						//window.apf.melde("Fehler: Keine Daten erhalten");
						console.log('Fehler: Keine Daten erhalten');
					});
				}
			},
			"GisBrowser": {
				"label": "im GIS-Browser zeigen",
				"separator_before": true,
				"icon": "style/images/wappen_zuerich.png",
				"action": function() {
					window.apf.zeigeBeobKoordinatenImGisBrowser();
				}
			}
		};
		if (!window.apf.beob_node_ausgeschnitten) {
			items.ausschneiden = {
				//"label": "ausschneiden<br>&nbsp;&nbsp;&nbsp;Tipp: drag and drop me!",
				"label": "ausschneiden",
				"separator_before": true,
				"icon": "style/images/ausschneiden.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					window.apf.beob_node_ausgeschnitten = aktiver_node;
				}
			}
		}
		if (window.apf.beob_zugeordnet_node_ausgeschnitten) {
			items.einfuegen = {
				"label": $.jstree._reference(window.apf.beob_zugeordnet_node_ausgeschnitten).get_text(window.apf.beob_zugeordnet_node_ausgeschnitten) + " einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					$("#tree").jstree("move_node", window.apf.beob_zugeordnet_node_ausgeschnitten, parent_node, "first");
				}
			}
		}
		return items;
	case "ap_ordner_beob_nicht_zuzuordnen":
		items = {
			"GoogleMaps": {
				"label": "auf Luftbild zeigen",
				"separator_before": true,
				"icon": "style/images/flora_icon_violett.png",
				"action": function() {
					var getBeobKarte_8 = $.ajax({
						type: 'get',
						url: 'php/beob_karte.php',
						dataType: 'json',
						data: {
							"apart_id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id")),
							"nicht_zuzuordnen": "1"
						}
					});
					getBeobKarte_8.always(function(data) {
						if (data.rows.length > 0) {
							window.apf.gmap.zeigeBeob(data);
						} else {
							window.apf.melde("Es gibt keine Beobachtung mit Koordinaten", "Aktion abgebrochen");
						}
					});
					getBeobKarte_8.fail(function() {
						//window.apf.melde("Fehler: Keine Daten erhalten");
						console.log('Fehler: Keine Daten erhalten');
					});
				}
			}
		};
		if (window.apf.beob_zugeordnet_node_ausgeschnitten) {
			items.einfuegen = {
				"label": $.jstree._reference(window.apf.beob_zugeordnet_node_ausgeschnitten).get_text(window.apf.beob_zugeordnet_node_ausgeschnitten) + " einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					$("#tree").jstree("move_node", window.apf.beob_zugeordnet_node_ausgeschnitten, aktiver_node, "first");
				}
			}
		}
		return items;
	case "beob_nicht_zuzuordnen":
		items = {
			"GoogleMaps": {
				"label": "auf Luftbild zeigen",
				"separator_before": true,
				"icon": "style/images/flora_icon_violett.png",
				"action": function() {
					var getBeobKarte_9 = $.ajax({
						type: 'get',
						url: 'php/beob_karte.php',
						dataType: 'json',
						data: {
							"beobid": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id"))
						}
					});
					getBeobKarte_9.always(function(data) {
						if (data.rows.length > 0) {
							window.apf.gmap.zeigeBeob(data);
						} else {
							window.apf.melde("Es gibt keine Beobachtung mit Koordinaten", "Aktion abgebrochen");
						}
					});
					getBeobKarte_9.fail(function() {
						//window.apf.melde("Fehler: Keine Daten erhalten");
						console.log('Fehler: Keine Daten erhalten');
					});
				}
			},
			"GisBrowser": {
				"label": "im GIS-Browser zeigen",
				"separator_before": true,
				"icon": "style/images/wappen_zuerich.png",
				"action": function() {
					window.apf.zeigeBeobKoordinatenImGisBrowser();
				}
			}
		};
		if (!window.apf.beob_node_ausgeschnitten) {
			items.ausschneiden = {
				//"label": "ausschneiden<br>&nbsp;&nbsp;&nbsp;Tipp: drag and drop me!",
				"label": "ausschneiden",
				"separator_before": true,
				"icon": "style/images/ausschneiden.png",
				"action": function() {
					// nur aktualisieren, wenn Schreibrechte bestehen
					if (!window.apf.prüfeSchreibvoraussetzungen()) {
						return;
					}
					window.apf.beob_node_ausgeschnitten = aktiver_node;
				}
			}
		}
		if (window.apf.beob_zugeordnet_node_ausgeschnitten) {
			items.einfuegen = {
				"label": $.jstree._reference(window.apf.beob_zugeordnet_node_ausgeschnitten).get_text(window.apf.beob_zugeordnet_node_ausgeschnitten) + " einfügen",
				"separator_before": true,
				"icon": "style/images/einfuegen.png",
				"action": function() {
					$("#tree").jstree("move_node", window.apf.beob_zugeordnet_node_ausgeschnitten, parent_node, "first");
				}
			}
		}
		return items;
	}
};

window.apf.tpopKopiertInPopOrdnerTpopEinfügen = function(aktiver_node) {
	'use strict';
	var insertTPopKopie = $.ajax({
		type: 'post',
		url: 'php/tpop_insert_kopie.php',
		dataType: 'json',
		data: {
			"user": sessionStorage.User,
			"PopId": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id")),
			"TPopId": window.apf.erstelleIdAusDomAttributId($(window.apf.tpop_node_kopiert).attr("id"))
		}
	});
	insertTPopKopie.always(function(id) {
		var strukturtyp = "tpop",
			beschriftung = window.apf.tpop_objekt_kopiert.TPopFlurname;
		if (window.apf.tpop_objekt_kopiert.TPopNr) {
			beschriftung = window.apf.tpop_objekt_kopiert.TPopNr + ': ' + window.apf.tpop_objekt_kopiert.TPopFlurname
		}
		window.apf.insertNeuenNodeEineHierarchiestufeTiefer(aktiver_node, "", strukturtyp, id, beschriftung);
	});
	insertTPopKopie.fail(function() {
		//window.apf.melde("Fehler: Die Teilpopulation wurde nicht erstellt");
		console.log('Fehler: Die Teilpopulation wurde nicht erstellt');
	});
};

// wird offenbar momentan nicht verwendet
/*window.apf.popKopiertInPopEinfügen = function(aktiver_node, parent_node) {
	'use strict';
	var data = {};
	// nur aktualisieren, wenn Schreibrechte bestehen
	if (!window.apf.prüfeSchreibvoraussetzungen()) {
		return;
	}
	// drop kennt den parent nicht
	if (!parent_node) {
		parent_node = $.jstree._reference(aktiver_node)._get_parent(aktiver_node);
	}
	// User und neue ApArtId mitgeben
	data.MutWer = sessionStorage.User;
	data.ApArtId = window.apf.erstelleIdAusDomAttributId($(parent_node).attr("id"));
	// die alten id's entfernen
	delete window.apf.pop_objekt_kopiert.ApArtId;
	delete window.apf.pop_objekt_kopiert.PopId;
	// das wird gleich neu gesetzt, alte Werte verwerfen
	delete window.apf.pop_objekt_kopiert.MutWann;
	delete window.apf.pop_objekt_kopiert.MutWer;
	// alle verbliebenen Felder an die url hängen
    _.each(window.apf.pop_objekt_kopiert, function(value, key) {
        // Nullwerte ausschliessen
        if (value !== null) {
            data[key] = value;
        }
    });
	// und an die DB schicken
	var insertPopKopie_2 = $.ajax({
		type: 'post',
		url: 'php/pop_insert_kopie.php',
		dataType: 'json',
		data: data
	});
	insertPopKopie_2.always(function(pop_id) {
		var strukturtyp = "pop",
			beschriftung = window.apf.pop_objekt_kopiert.PopNr + " " + window.apf.pop_objekt_kopiert.PopName;
		window.apf.insertNeuenNodeAufGleicherHierarchiestufe(aktiver_node, parent_node, strukturtyp, pop_id, beschriftung);
	});
	insertPopKopie_2.fail(function() {
		//window.apf.melde("Fehler: Die Population wurde nicht erstellt");
		console.log('Die Population wurde nicht erstellt');
	});
};*/

// wird offenbar momentan nicht verwendet
window.apf.tpopKopiertInTpopEinfügen = function(aktiver_node, parent_node) {
	'use strict';
	var data = {};
	// nur aktualisieren, wenn Schreibrechte bestehen
	if (!window.apf.prüfeSchreibvoraussetzungen()) {
		return;
	}
	// drop kennt den parent nicht
	if (!parent_node) {
		parent_node = $.jstree._reference(aktiver_node)._get_parent(aktiver_node);
	}
	// User und neue PopId mitgeben
	data.MutWer = sessionStorage.User;
	data.PopId = window.apf.erstelleIdAusDomAttributId($(parent_node).attr("id"));
	// die alten id's entfernen
	delete window.apf.tpop_objekt_kopiert.PopId;
	delete window.apf.tpop_objekt_kopiert.TPopId;
	// das wird gleich neu gesetzt, alte Werte verwerfen
	delete window.apf.tpop_objekt_kopiert.MutWann;
	delete window.apf.tpop_objekt_kopiert.MutWer;
	// alle verbliebenen Felder an die url hängen
    _.each(window.apf.tpop_objekt_kopiert, function(value, key) {
        // Nullwerte ausschliessen
        if (value !== null) {
            data[key] = value;
        }
    });
	// und an die DB schicken
	var insertTPopKopie_2 = $.ajax({
		type: 'post',
		url: 'php/tpop_insert_kopie.php',
		dataType: 'json',
		data: data
	});
	insertTPopKopie_2.always(function(tpop_id) {
		var strukturtyp = "tpop",
			beschriftung = window.apf.tpop_objekt_kopiert.TPopNr + " " + window.apf.tpop_objekt_kopiert.TPopFlurname;
		window.apf.insertNeuenNodeAufGleicherHierarchiestufe(aktiver_node, parent_node, strukturtyp, tpop_id, beschriftung);
	});
	insertTPopKopie_2.fail(function() {
		//window.apf.melde("Fehler: Die Teilpopulation wurde nicht erstellt");
		console.log('Fehler: Die Teilpopulation wurde nicht erstellt');
	});
};

window.apf.prüfeLesevoraussetzungen = function() {
	'use strict';
	// kontrollieren, ob der User offline ist
	if (!navigator.onLine) {
		console.log('offline');
		$("#offline_dialog")
            .show()
            .dialog({
                modal: true,
                width: 400,
                buttons: {
                    Ok: function() {
                        $(this).dialog("close");
                    }
                }
            });
		return false;
	} else {
		return true;
	}
};

window.apf.prüfeSchreibvoraussetzungen = function() {
	'use strict';
	// kontrollieren, ob der User online ist
	if (window.apf.prüfeLesevoraussetzungen()) {
		// kontrollieren, ob der User Schreibrechte hat
		if (sessionStorage.NurLesen) {
			window.apf.melde("Sie haben keine Schreibrechte", "Speichern abgebrochen");
			return false;
		} else {
			return true;
		}
	}
};

// wird von allen Formularen benutzt
// speichert den Wert eines Feldes in einem Formular
// übernimmt das Objekt, in dem geändert wurde
window.apf.speichern = function(that) {
	'use strict';
	var feldtyp,
        formular,
        tabelleInDb,
        idInTabelle,
        feldname,
        feldwert,
        objekt,
        $PopName = $("#PopName"),
        $PopNr = $("#PopNr"),
        $tree = $("#tree"),
        $PopBerJahr = $("#PopBerJahr"),
        $PopBerEntwicklungChecked = $('input[name="PopBerEntwicklung"]:checked'),
        $spanPopBerEntwicklungPlus$PopBerEntwicklungChecked = $("#spanPopBerEntwicklung" + $PopBerEntwicklungChecked.val()),
        $spanPopMassnBerErfolgsbeurteilungPlusPopMassnBerErfolgsbeurteilungChecked = $("#spanPopMassnBerErfolgsbeurteilung" + $('input[name="PopMassnBerErfolgsbeurteilung"]:checked').val()),
        $PopMassnBerJahr = $("#PopMassnBerJahr"),
        $TPopNr = $("#TPopNr"),
        $TPopFlurname = $("#TPopFlurname"),
        $TPopBerJahr = $("#TPopBerJahr"),
        $spanTPopBerEntwicklungPlusTPopBerEntwicklungChecked = $("#spanTPopBerEntwicklung" + $('input[name="TPopBerEntwicklung"]:checked').val()),
        $TPopMassnJahr = $("#TPopMassnJahr"),
        $TPopMassnTypChecked = $("#TPopMassnTyp option:checked"),
        $TPopMassnBerJahr = $("#TPopMassnBerJahr"),
        $spanTPopMassnBerErfolgsbeurteilungPlusTPopMassnBerErfolgsbeurteilungChecked = $("#spanTPopMassnBerErfolgsbeurteilung" + $('input[name="TPopMassnBerErfolgsbeurteilung"]:checked').val()),
        $ZielBerJahr = $("#ZielBerJahr"),
        $ZielBerErreichung = $("#ZielBerErreichung"),
        $SpanErfkritErreichungsgradPlusErfkritErreichungsgradChecked = $("#SpanErfkritErreichungsgrad" + $("input:radio[name='ErfkritErreichungsgrad']:checked").val()),
        $BerJahr = $("#BerJahr"),
        $BerTitel = $("#BerTitel"),
        configuration = require('./modules/configuration');

	if (window.apf.prüfeSchreibvoraussetzungen()) {
		formular = $(that).attr("formular");
        // die zu aktualisierende Tabelle in der DB
        tabelleInDb = configuration.forms[formular].tabelleInDb;
        idInTabelle = configuration.forms[formular].idInTabelle;
		feldname = that.name;
		feldtyp = $(that).attr("type") || null;
		// Feldwert ermitteln
		if (feldtyp && feldtyp === "checkbox") {
			feldwert = $('input:checkbox[name=' + feldname + ']:checked').val();
		} else if (feldtyp && feldtyp === "radio") {
			feldwert = $('input:radio[name=' + feldname + ']:checked').val();
		} else {
			// textarea, input, select
			feldwert = $("#" + feldname).val();
		}
		// ja/nein Felder zu boolean umbauen
		if (feldname === "PopHerkunftUnklar" || feldname === "TPopHerkunftUnklar" || feldname === "TPopMassnPlan" || feldname === "TPopKontrPlan") {
			if (feldwert) {
				feldwert = 1;
			} else {
				feldwert = "";
			}
		}
		if (feldname === "BeobBemerkungen" && localStorage.beob_status === "nicht_beurteilt") {
			// hier soll nicht gespeichert werden
			$("#BeobBemerkungen").val("");
			window.apf.melde("Bemerkungen sind nur in zugeordneten oder nicht zuzuordnenden Beobachtungen möglich", "Aktion abgebrochen");
			return;
		}
		var updateFormular = $.ajax({
			type: 'post',
			url: 'api/ap=' + localStorage.ap_id + '/tabelle=' + tabelleInDb + '/tabelle-id=' + idInTabelle + '/feld=' + feldname + '/wert=' + feldwert + '/user=' + sessionStorage.User,
			dataType: 'json'
		});
		updateFormular.always(function() {
			// Variable für Objekt nachführen
			window.apf[formular][feldname] = feldwert;
			// Wenn ApArtId verändert wurde: Formular aktualisieren
			if (feldname === "ApArtId" && feldwert) {
				window.apf.wähleAp(feldwert);
				return;
			}
			// Wenn in feldkontr Datum erfasst, auch Jahr speichern
			if (feldname === "TPopKontrDatum" && feldwert) {
				objekt = {};
				objekt.name = "TPopKontrJahr";
				objekt.formular = "tpopfeldkontr";
				window.apf.speichern(objekt);
			}
			// dito bei tpopmassn
			if (feldname === "TPopMassnDatum" && feldwert) {
				objekt = {};
				objekt.name = "TPopMassnJahr";
				objekt.formular = "tpopmassn";
				window.apf.speichern(objekt);
			}
			// wenn in TPopKontrZaehleinheit 1 bis 3 ein Leerwert eingeführt wurde
			// sollen auch die Felder TPopKontrMethode 1 bis 3 und TPopKontrAnz 1 bis 3 Leerwerte erhalten
			if (!feldwert) {
				if (feldname === "TPopKontrZaehleinheit1") {
					// UI aktualisieren
					if (window.apf.tpopfeldkontr.TPopKontrMethode1) {
						$("#TPopKontrMethode1" + window.apf.tpopfeldkontr.TPopKontrMethode1).prop("checked", false);
					}
					$("#TPopKontrAnz1").val("");
					// Datenbank aktualisieren
					// Feld TPopKontrMethode1
					objekt = {};
					objekt.name = "TPopKontrMethode1";
					objekt.formular = formular;
					window.apf.speichern(objekt);
					// Feld TPopKontrAnz1
					objekt = {};
					objekt.name = "TPopKontrAnz1";
					objekt.formular = formular;
					window.apf.speichern(objekt);
				}
				if (feldname === "TPopKontrZaehleinheit2") {
					// UI aktualisieren
					if (window.apf.tpopfeldkontr.TPopKontrMethode2) {
						$("#TPopKontrMethode2" + window.apf.tpopfeldkontr.TPopKontrMethode2).prop("checked", false);
					}
					$("#TPopKontrAnz2").val("");
					// Datenbank aktualisieren
					// Feld TPopKontrMethode2
					objekt = {};
					objekt.name = "TPopKontrMethode2";
					objekt.formular = formular;
					window.apf.speichern(objekt);
					// Feld TPopKontrAnz2
					objekt = {};
					objekt.name = "TPopKontrAnz2";
					objekt.formular = formular;
					window.apf.speichern(objekt);
				}
				if (feldname === "TPopKontrZaehleinheit3") {
					// UI aktualisieren
					if (window.apf.tpopfeldkontr.TPopKontrMethode3) {
						$("#TPopKontrMethode3" + window.apf.tpopfeldkontr.TPopKontrMethode3).prop("checked", false);
					}
					$("#TPopKontrAnz3").val("");
					// Datenbank aktualisieren
					// Feld TPopKontrMethode3
					objekt = {};
					objekt.name = "TPopKontrMethode3";
					objekt.formular = formular;
					window.apf.speichern(objekt);
					// Feld TPopKontrAnz3
					objekt = {};
					objekt.name = "TPopKontrAnz3";
					objekt.formular = formular;
					window.apf.speichern(objekt);
				}
			}
		});
		updateFormular.fail(function() {
			//window.apf.melde("Fehler: Die letzte Änderung wurde nicht gespeichert");
			console.log('Fehler: Die letzte Änderung wurde nicht gespeichert');
		});
		// nodes im Tree updaten, wenn deren Bezeichnung ändert
		switch(feldname) {
			case "PopNr":
			case "PopName":
				var popbeschriftung;
				if ($PopName.val() && $PopNr.val()) {
					popbeschriftung = $PopNr.val() + ": " + $PopName.val();
				} else if ($PopName.val()) {
					popbeschriftung = "(keine Nr): " + $PopName.val();
				} else if ($PopNr.val()) {
					popbeschriftung = $PopNr.val() + ": (kein Name)";
				} else {
					popbeschriftung = "(keine Nr, kein Name)";
				}
				$tree.jstree("rename_node", "[typ='ap_ordner_pop'] #" + localStorage.pop_id, popbeschriftung);
				break;
			case "PopBerJahr":
			case "PopBerEntwicklung":
				var popberbeschriftung;
				if ($PopBerJahr.val() && $spanPopBerEntwicklungPlus$PopBerEntwicklungChecked.text()) {
					popberbeschriftung = $PopBerJahr.val() + ": " + $spanPopBerEntwicklungPlus$PopBerEntwicklungChecked.text();
				} else if ($PopBerJahr.val()) {
					popberbeschriftung = $PopBerJahr.val() + ": (kein Status)";
				} else if ($spanPopBerEntwicklungPlus$PopBerEntwicklungChecked.text()) {
					popberbeschriftung = "(kein Jahr): " + $spanPopBerEntwicklungPlus$PopBerEntwicklungChecked.text();
				} else {
					popberbeschriftung = "(kein Jahr): (kein Status)";
				}
				$tree.jstree("rename_node", "[typ='pop_ordner_popber'] #" + localStorage.popber_id, popberbeschriftung);
				break;
			case "PopMassnBerJahr":
			case "PopMassnBerErfolgsbeurteilung":
				var popmassnberbeschriftung;
				if ($PopMassnBerJahr.val() && $spanPopMassnBerErfolgsbeurteilungPlusPopMassnBerErfolgsbeurteilungChecked.text()) {
					popmassnberbeschriftung = $PopMassnBerJahr.val() + ": " + $spanPopMassnBerErfolgsbeurteilungPlusPopMassnBerErfolgsbeurteilungChecked.text();
				} else if ($PopMassnBerJahr.val()) {
					popmassnberbeschriftung = $PopMassnBerJahr.val() + ": (nicht beurteilt)";
				} else if ($spanPopMassnBerErfolgsbeurteilungPlusPopMassnBerErfolgsbeurteilungChecked.text()) {
					popmassnberbeschriftung = "(kein Jahr): " + $spanPopMassnBerErfolgsbeurteilungPlusPopMassnBerErfolgsbeurteilungChecked.text();
				} else {
					popmassnberbeschriftung = "(kein Jahr): (nicht beurteilt)";
				}
				$tree.jstree("rename_node", "[typ='pop_ordner_massnber'] #" + localStorage.popmassnber_id, popmassnberbeschriftung);
				break;
			case "TPopNr":
			case "TPopFlurname":
				var tpopbeschriftung;
				if ($TPopNr.val() && $TPopFlurname.val()) {
					tpopbeschriftung = $TPopNr.val() + ": " + $TPopFlurname.val();
				} else if ($TPopFlurname.val()) {
					tpopbeschriftung = "(keine Nr): " + $TPopFlurname.val();
				} else if ($TPopNr.val()) {
					tpopbeschriftung = $TPopNr.val() + ": (kein Flurname)";
				} else {
					tpopbeschriftung = "(keine Nr, kein Flurname)";
				}
				$tree.jstree("rename_node", "[typ='pop_ordner_tpop'] #" + localStorage.tpop_id, tpopbeschriftung);
				break;
			case "TPopKontrTyp":
			case "TPopKontrJahr":
				// wenn kein Typ/Jahr gewählt: "(kein Typ/Jahr)"
				var tpopkontrjahr = "(kein Jahr)",
					tpopfeldkontr_label,
					$TPopKontrJahr = $("#TPopKontrJahr").val();
				if ($TPopKontrJahr) {
					tpopkontrjahr = $TPopKontrJahr;
				}
				// Problem: Es ist nicht bekannt, ob eine Freiwilligenkontrolle umbennant wird oder eine Feldkontrolle
				// Lösung: Beide nodes umbenennen. Nur eine davon hat die richtige id
				$tree.jstree("rename_node", "[typ='tpop_ordner_freiwkontr'] #" + localStorage.tpopfeldkontr_id, tpopkontrjahr);
				tpopfeldkontr_label = window.apf.erstelleLabelFürFeldkontrolle($TPopKontrJahr, $("#spanTPopKontrTyp" + $('input[name="TPopKontrTyp"]:checked').val()).text());
				$tree.jstree("rename_node", "[typ='tpop_ordner_feldkontr'] #" + localStorage.tpopfeldkontr_id, tpopfeldkontr_label);
				break;
			case "TPopBerJahr":
			case "TPopBerEntwicklung":
				// wenn kein Jahr/Entwicklung gewählt: "(kein Jahr/Entwicklung)"
				var tpopberjahr, tpopberentwicklung;
				if ($TPopBerJahr.val()) {
					tpopberjahr = $TPopBerJahr.val();
				} else {
					tpopberjahr = "(kein Jahr)";
				}
				if ($spanTPopBerEntwicklungPlusTPopBerEntwicklungChecked.text()) {
					tpopberentwicklung = $spanTPopBerEntwicklungPlusTPopBerEntwicklungChecked.text();
				} else {
					tpopberentwicklung = "(keine Beurteilung)";
				}
				$tree.jstree("rename_node", "[typ='tpop_ordner_tpopber'] #" + localStorage.tpopber_id, tpopberjahr + ": " + tpopberentwicklung);
				break;
			case "TPopMassnJahr":
			case "TPopMassnTyp":
				// wenn kein Typ/Jahr gewählt: "(kein Typ/Jahr)"
				var tpopmassnbezeichnung;
				if ($TPopMassnJahr.val() && $TPopMassnTypChecked.text()) {
					tpopmassnbezeichnung = $TPopMassnJahr.val() + ": " + $TPopMassnTypChecked.text();
				} else if ($TPopMassnJahr.val()) {
					tpopmassnbezeichnung = $TPopMassnJahr.val() + ": (kein Typ)";
				} else if ($TPopMassnTypChecked.text()) {
					tpopmassnbezeichnung = "(kein Jahr): " + $TPopMassnTypChecked.text();
				} else {
					tpopmassnbezeichnung = "(kein Jahr): (kein Typ)";
				}
				tpopmassnbezeichnung = window.apf.erstelleLabelFürMassnahme($TPopMassnJahr.val(), $TPopMassnTypChecked.text());
				$tree.jstree("rename_node", "[typ='tpop_ordner_massn'] #" + localStorage.tpopmassn_id, tpopmassnbezeichnung);
				break;
			case "TPopMassnBerJahr":
			case "TPopMassnBerErfolgsbeurteilung":
				// wenn kein Jahr/Beurteilung: "(kein Jahr/Beurteilung)"
				var tpopmassberbeschriftung;
				if ($TPopMassnBerJahr.val() && $spanTPopMassnBerErfolgsbeurteilungPlusTPopMassnBerErfolgsbeurteilungChecked.text()) {
					tpopmassberbeschriftung = $TPopMassnBerJahr.val() + ": " + $spanTPopMassnBerErfolgsbeurteilungPlusTPopMassnBerErfolgsbeurteilungChecked.text();
				} else if ($TPopMassnBerJahr.val()) {
					tpopmassberbeschriftung = $TPopMassnBerJahr.val() + ": (keine Beurteilung)";
				} else if ($spanTPopMassnBerErfolgsbeurteilungPlusTPopMassnBerErfolgsbeurteilungChecked.text()) {
					tpopmassberbeschriftung = "(kein Jahr): " + $spanTPopMassnBerErfolgsbeurteilungPlusTPopMassnBerErfolgsbeurteilungChecked.text();
				} else {
					tpopmassberbeschriftung = "(kein Jahr): (keine Beurteilung)";
				}
				$tree.jstree("rename_node", "[typ='tpop_ordner_massnber'] #" + localStorage.tpopmassnber_id, tpopmassberbeschriftung);
				break;
			case "ZielBezeichnung":
				var zielbeschriftung;
				if (feldwert) {
					zielbeschriftung = feldwert;
				} else {
					zielbeschriftung = "(Ziel nicht beschrieben)";
				}
				$tree.jstree("rename_node", "[typ='apzieljahr'] #" + localStorage.apziel_id, zielbeschriftung);
				break;
			case "ZielBerJahr":
			case "ZielBerErreichung":
				var zielberbeschriftung;
				if ($ZielBerJahr.val() && $ZielBerErreichung.val()) {
					zielberbeschriftung = $ZielBerJahr.val() + ": " + $ZielBerErreichung.val();
				} else if ($ZielBerJahr.val()) {
					zielberbeschriftung = $ZielBerJahr.val() + ": (keine Beurteilung)";
				} else if ($ZielBerErreichung.val()) {
					zielberbeschriftung = "(kein Jahr): " + $ZielBerErreichung.val();
				} else {
					zielberbeschriftung = "(kein Jahr): (keine Beurteilung)";
				}
				$tree.jstree("rename_node", "[typ='zielber_ordner'] #" + localStorage.zielber_id, zielberbeschriftung);
				break;
			case "ErfkritErreichungsgrad":
			case "ErfkritTxt":
				var erfkritbeschriftung;
				if ($SpanErfkritErreichungsgradPlusErfkritErreichungsgradChecked.text() && $("#ErfkritTxt").val()) {
					erfkritbeschriftung = $SpanErfkritErreichungsgradPlusErfkritErreichungsgradChecked.text() + ": " + $("#ErfkritTxt").val();
				} else if ($SpanErfkritErreichungsgradPlusErfkritErreichungsgradChecked.text()) {
					erfkritbeschriftung = $SpanErfkritErreichungsgradPlusErfkritErreichungsgradChecked.text() + ": (kein Kriterium)";
				} else if ($("#ErfkritTxt").val()) {
					erfkritbeschriftung = "(keine Beurteilung): " + $("#ErfkritTxt").val();
				} else {
					erfkritbeschriftung = "(keine Beurteilung): (kein Kriterium)";
				}
				$tree.jstree("rename_node", "[typ='ap_ordner_erfkrit'] #" + localStorage.erfkrit_id, erfkritbeschriftung);
				break;
			case "JBerJahr":
				var jberbeschriftung;
				if (feldwert) {
					jberbeschriftung = feldwert;
				} else {
					jberbeschriftung = "(kein Jahr)";
				}
				$tree.jstree("rename_node", "[typ='ap_ordner_jber'] #" + localStorage.jber_id, jberbeschriftung);
				break;
			case "BerTitel":
			case "BerJahr":
				var berbeschriftung;
				if ($BerJahr.val() && $BerTitel.val()) {
					berbeschriftung = $BerJahr.val() + ": " + $BerTitel.val();
				} else if ($BerJahr.val()) {
					berbeschriftung = $BerJahr.val() + ": (kein Titel)";
				} else if ($BerTitel.val()) {
					berbeschriftung = "(kein Jahr): " + $BerTitel.val();
				} else {
					berbeschriftung = "(kein Jahr): (kein Titel)";
				}
				$tree.jstree("rename_node", "[typ='ap_ordner_ber'] #" + localStorage.ber_id, berbeschriftung);
				break;
			case "AaSisfNr":
				var aabeschriftung;
				if (feldwert) {
					aabeschriftung = $("#AaSisfNr option[value='" + feldwert + "']").text();
				} else {
					aabeschriftung = "(kein Artname)";
				}
				$tree.jstree("rename_node", "[typ='ap_ordner_assozarten'] #" + localStorage.assozarten_id, aabeschriftung);
				break;
		}
	}
};

(function($) {
	// friendly helper //tinyurl.com/6aow6yn
	// Läuft durch alle Felder im Formular
	// Wenn ein Wert enthalten ist, wird Feldname und Wert ins Objekt geschrieben
	// nicht vergessen: Typ, _id und _rev dazu geben, um zu speichern
	$.fn.serializeObject = function() {
		var o, a;
		o = {};
		a = this.serializeArray();
		$.each(a, function() {
			if (this.value) {
				if (o[this.name]) {
					if (!o[this.name].push) {
						o[this.name] = [o[this.name]];
					}
					o[this.name].push(this.value);
				} else {
					o[this.name] = this.value;
				}
			}
		});
		return o;
	};
})(jQuery);

// wandelt decimal degrees (vom GPS) in WGS84 um
window.apf.DdInWgs84BreiteGrad = function(Breite) {
	'use strict';
	var BreiteGrad = Math.floor(Breite);
	return BreiteGrad;
};

window.apf.DdInWgs84BreiteMin = function(Breite) {
	'use strict';
	var BreiteGrad = Math.floor(Breite),
		BreiteMin = Math.floor((Breite - BreiteGrad) * 60);
	return BreiteMin;
};

window.apf.DdInWgs84BreiteSec = function(Breite) {
	'use strict';
	var BreiteGrad = Math.floor(Breite),
		BreiteMin = Math.floor((Breite - BreiteGrad)*60),
		BreiteSec = Math.round((((Breite - BreiteGrad) - (BreiteMin / 60)) * 60 * 60) * 100) / 100;
	return BreiteSec;
};

window.apf.DdInWgs84LängeGrad = function(Länge) {
	'use strict';
	var LängeGrad = Math.floor(Länge);
	return LängeGrad;
};

window.apf.DdInWgs84LängeMin = function(Länge) {
	'use strict';
	var LängeGrad = Math.floor(Länge),
		LängeMin = Math.floor((Länge - LängeGrad) * 60);
	return LängeMin;
};

window.apf.DdInWgs84LängeSec = function(Länge) {
	'use strict';
	var LängeGrad = Math.floor(Länge),
		LängeMin = Math.floor((Länge - LängeGrad) * 60),
		LängeSec = Math.round((((Länge - LängeGrad) - (LängeMin / 60)) * 60 * 60) * 100) / 100;
	return LängeSec;
};

// Wandelt WGS84 lat/long (° dec) in CH-Landeskoordinaten um
window.apf.Wgs84InChX = function(BreiteGrad, BreiteMin, BreiteSec, LängeGrad, LängeMin, LängeSec) {
	'use strict';
	var lat = BreiteSec + BreiteMin * 60 + BreiteGrad * 3600,
		lng = LängeSec + LängeMin * 60 + LängeGrad * 3600,
		// Auxiliary values (% Bern)
		lat_aux = (lat - 169028.66) / 10000,
		lng_aux = (lng - 26782.5) / 10000,
		x = 200147.07
		  + 308807.95 * lat_aux 
		  +   3745.25 * Math.pow(lng_aux, 2)
		  +	 76.63 * Math.pow(lat_aux, 2)
		  -	194.56 * Math.pow(lng_aux, 2) * lat_aux
		  +	119.79 * Math.pow(lat_aux, 3);
	return x;
};

// Wandelt WGS84 in CH-Landeskoordinaten um
window.apf.Wgs84InChY = function(BreiteGrad, BreiteMin, BreiteSec, LängeGrad, LängeMin, LängeSec) {
	'use strict';
	// Converts degrees dec to sex
	var lat = BreiteSec + BreiteMin * 60 + BreiteGrad * 3600,
		lng = LängeSec + LängeMin * 60 + LängeGrad * 3600,
		// Auxiliary values (% Bern)
		lat_aux = (lat - 169028.66) / 10000,
		lng_aux = (lng - 26782.5) / 10000,
		// Process Y
		y = 600072.37 
		  + 211455.93 * lng_aux 
		  -  10938.51 * lng_aux * lat_aux
		  -	  0.36 * lng_aux * Math.pow(lat_aux, 2)
		  -	 44.54 * Math.pow(lng_aux, 3);
	return y;
};

// wandelt decimal degrees (vom GPS) in CH-Landeskoordinaten um
window.apf.DdInChX = function(Breite, Länge) {
	'use strict';
	var BreiteGrad = window.apf.DdInWgs84BreiteGrad(Breite),
		BreiteMin = window.apf.DdInWgs84BreiteMin(Breite),
		BreiteSec = window.apf.DdInWgs84BreiteSec(Breite),
		LängeGrad = window.apf.DdInWgs84LängeGrad(Länge),
		LängeMin = window.apf.DdInWgs84LängeMin(Länge),
		LängeSec = window.apf.DdInWgs84LängeSec(Länge),
		x = Math.floor(window.apf.Wgs84InChX(BreiteGrad, BreiteMin, BreiteSec, LängeGrad, LängeMin, LängeSec));
	return x;
};

window.apf.DdInChY = function(Breite, Länge) {
	'use strict';
	var BreiteGrad = window.apf.DdInWgs84BreiteGrad(Breite),
		BreiteMin = window.apf.DdInWgs84BreiteMin(Breite),
		BreiteSec = window.apf.DdInWgs84BreiteSec(Breite),
		LängeGrad = window.apf.DdInWgs84LängeGrad(Länge),
		LängeMin = window.apf.DdInWgs84LängeMin(Länge),
		LängeSec = window.apf.DdInWgs84LängeSec(Länge),
		y = Math.floor(window.apf.Wgs84InChY(BreiteGrad, BreiteMin, BreiteSec, LängeGrad, LängeMin, LängeSec));
	return y;
};

// von CH-Landeskoord zu DecDeg

// Convert CH y/x to WGS lat
window.apf.CHtoWGSlat = function(y, x) {
	'use strict';
	// Converts militar to civil and to unit = 1000km
	// Auxiliary values (% Bern)
	var y_aux = (y - 600000) / 1000000,
		x_aux = (x - 200000) / 1000000,
		// Process lat
		lat = 16.9023892
			 +  3.238272 * x_aux
			 -  0.270978 * Math.pow(y_aux, 2)
			 -  0.002528 * Math.pow(x_aux, 2)
			 -  0.0447   * Math.pow(y_aux, 2) * x_aux
			 -  0.0140   * Math.pow(x_aux, 3);
	// Unit 10000" to 1 " and converts seconds to degrees (dec)
	lat = lat * 100 / 36;
	return lat;
};

// Convert CH y/x to WGS long
window.apf.CHtoWGSlng = function(y, x) {
	'use strict';
	// Converts militar to civil and to unit = 1000km
	// Auxiliary values (% Bern)
	var y_aux = (y - 600000) / 1000000,
		x_aux = (x - 200000) / 1000000,
		// Process long
		lng = 2.6779094
			+ 4.728982 * y_aux
			+ 0.791484 * y_aux * x_aux
			+ 0.1306   * y_aux * Math.pow(x_aux, 2)
			- 0.0436   * Math.pow(y_aux, 3);
	// Unit 10000" to 1 " and converts seconds to degrees (dec)
	lng = lng * 100 / 36;
	return lng;
};

window.apf.gmap.zeigeTPop = function(tpop_liste) {
	'use strict';
	var anz_tpop,
        infowindow,
        tpop_beschriftung,
        lat,
        lng,
        latlng,
        options,
        map,
        bounds,
        markers,
        tpop_id,
        latlng2,
        marker,
        contentString,
        marker_options,
        marker_cluster,
        my_flurname;
	// vor Erneuerung zeigen - sonst klappt Wiederaufruf nicht, wenn die Karte schon angezeigt ist
	window.apf.zeigeFormular("google_karte");
	window.apf.gmap.markers_array = [];
	window.apf.gmap.info_window_array = [];
	infowindow = new google.maps.InfoWindow();
	// TPopListe bearbeiten:
	// Objekte löschen, die keine Koordinaten haben
	// Lat und Lng ergänzen
    _.each(tpop_liste.rows, function(tpop, index) {
        if (!tpop.TPopXKoord || !tpop.TPopYKoord) {
            // tpop einsetzen geht nicht, weil Chrome Fehler meldet
            delete tpop_liste.rows[index];
        } else {
            tpop.Lat = window.apf.CHtoWGSlat(parseInt(tpop.TPopXKoord), parseInt(tpop.TPopYKoord));
            tpop.Lng = window.apf.CHtoWGSlng(parseInt(tpop.TPopXKoord), parseInt(tpop.TPopYKoord));
        }
    });
	// TPop zählen
	anz_tpop = tpop_liste.rows.length;
	// Karte mal auf Zürich zentrieren, falls in den TPopListe.rows keine Koordinaten kommen
	// auf die die Karte ausgerichtet werden kann
	lat = 47.383333;
	lng = 8.533333;
	latlng = new google.maps.LatLng(lat, lng);
	options = {
		zoom: 15,
		center: latlng,
		streetViewControl: false,
		mapTypeId: google.maps.MapTypeId.SATELLITE
	};
	map = new google.maps.Map(document.getElementById("google_karten_div"), options);
	window.apf.gmap.map = map;
	bounds = new google.maps.LatLngBounds();
	// für alle TPop Marker erstellen
	markers = [];
    _.each(tpop_liste.rows, function(tpop) {
        tpop_id = tpop.TPopId;
        tpop_beschriftung = window.apf.beschrifteTPopMitNrFürKarte(tpop.PopNr, tpop.TPopNr);
        latlng2 = new google.maps.LatLng(tpop.Lat, tpop.Lng);
        if (anz_tpop === 1) {
            // map.fitbounds setzt zu hohen zoom, wenn nur eine TPop Koordinaten hat > verhindern
            latlng = latlng2;
        } else {
            // Kartenausschnitt um diese Koordinate erweitern
            bounds.extend(latlng2);
        }
        marker = new MarkerWithLabel({
            map: map,
            position: latlng2,
            title: tpop_beschriftung,
            labelContent: tpop_beschriftung,
            labelAnchor: new google.maps.Point(75, 0),
            labelClass: "MapLabel",
            icon: "img/flora_icon.png"
        });
        markers.push(marker);
        my_flurname = tpop.TPopFlurname || '(kein Flurname)';
        contentString = '<div id="content">'+
            '<div id="siteNotice">'+
            '</div>'+
            '<div id="bodyContent" class="GmInfowindow">'+
            '<h3>' + tpop.Artname + '</h3>'+
            '<p>Population: ' + tpop.PopName + '</p>'+
            '<p>TPop: ' + my_flurname + '</p>'+
            '<p>Koordinaten: ' + tpop.TPopXKoord + ' / ' + tpop.TPopYKoord + '</p>'+
            "<p><a href=\"#\" onclick=\"window.apf.öffneTPop('" + tpop.TPopId + "')\">Formular anstelle Karte öffnen<\/a></p>"+
            '<p><a href="#" onclick=\"window.apf.öffneFormularAlsPopup(\'tpop\', ' + tpop.TPopId + ')\">Formular neben der Karte öffnen<\/a></p>'+
            "<p><a href=\"#\" onclick=\"window.apf.öffneTPopInNeuemTab('" + tpop.TPopId + "')\">Formular in neuem Fenster öffnen<\/a></p>"+
            '</div>'+
            '</div>';
        makeListener(map, marker, contentString);
    });
	marker_options = {
		maxZoom: 17, 
		styles: [{
				height: 53,
				url: "img/m8.png",
				width: 53
			}]
	};
	// globale Variable verwenden, damit ein Klick auf die Checkbox die Ebene einblenden kann
	window.apf.google_karte_detailpläne = new google.maps.KmlLayer({
	    //url: '//www.apflora.ch/kml/rueteren.kmz',
        url: 'kml/rueteren.kmz',
	    preserveViewport: true
	});
	window.apf.google_karte_detailpläne.setMap(null);
	marker_cluster = new MarkerClusterer(map, markers, marker_options);
	if (anz_tpop === 1) {
		// map.fitbounds setzt zu hohen zoom, wenn nur eine Beobachtung erfasst wurde > verhindern
		map.setCenter(latlng);
		map.setZoom(18);
	} else {
		// Karte auf Ausschnitt anpassen
		map.fitBounds(bounds);
	}
	// diese Funktion muss hier sein, damit infowindow bekannt ist
	function makeListener(map, marker, contentString) {
		google.maps.event.addListener(marker, 'click', function() {
			infowindow.setContent(contentString);
			infowindow.open(map, marker);
		});
	}
};

window.apf.olmap.getLayerNames = function() {
	var layer_objekt_array = window.apf.olmap.map.getLayers().getArray(),
		layers = _.map(layer_objekt_array, function(layer_objekt) {
			if (layer_objekt.values_ && layer_objekt.values_.title) {
	 			return layer_objekt.values_.title;
			}
		});
	return layers;
};

window.apf.olmap.getLayersWithTitle = function() {
	var layers_array = window.apf.olmap.map.getLayers().getArray(),
		layers = _.map(layers_array, function(layer) {
			if (layer.get('title')) {
	 			return layer;
			}
		});
	return layers || [];
};

window.apf.olmap.entferneLayerNachName = function(name) {
	var layers_array = window.apf.olmap.getLayersWithTitle(),
		layername,
		layer_kategorie;
	_.each(layers_array, function(layer) {
		layername = layer.get('title');
		layer_kategorie = layer.get('kategorie');
		if (layername === name) {
			window.apf.olmap.map.removeLayer(layer);
			if (layer_kategorie === 'Eigene Ebenen') {
				// ebene aus localStorage entfernen
				console.log('entferneLayerNachName meldet: lasse entfernen layer mit title ' + layername);
				window.apf.olmap.aktualisiereEbeneInLocalStorage(layer, true);
			}
		}
	});
};

window.apf.olmap.entferneAlleApfloraLayer = function() {
	'use strict';
	if (window.apf.olmap && window.apf.olmap.map) {
		// getLayers retourniert ein Objekt!!!
		// um die eigentlichen Layers zu erhalten, muss man .getLayers().getArray() aufrufen!!!
		var layers_array = window.apf.olmap.map.getLayers().getArray(),
			kategorie,
			title,
			zu_löschende_layer = [];
		// zuerst nur einen Array mit den zu löschenden Layern erstellen
		// wenn man sofort löscht, wird nur der erste entfernt!
		_.each(layers_array, function(layer) {
			kategorie = layer.get('kategorie');
			title = layer.get('title');
			if (kategorie && kategorie === 'AP Flora' && title !== 'Detailpläne') {
				zu_löschende_layer.push(layer);
			}
		});
		_.each(zu_löschende_layer, function(layer) {
			window.apf.olmap.map.removeLayer(layer);
		});
		window.apf.olmap.initiiereLayertree();
	}
};

window.apf.aktualisiereKoordinatenVonTPop = function(tpop) {
    var koord_aktualisiert = $.Deferred();
    // Datensatz updaten
    var updateTPop = $.ajax({
        type: 'post',
        url: 'php/tpop_update.php',
        dataType: 'json',
        data: {
            "id": tpop.TPopId,
            "Feld": "TPopXKoord",
            "Wert": tpop.TPopXKoord,
            "user": sessionStorage.User
        }
    });
    updateTPop.always(function() {
        var updateTPop_2 = $.ajax({
            type: 'post',
            url: 'php/tpop_update.php',
            dataType: 'json',
            data: {
                "id": tpop.TPopId,
                "Feld": "TPopYKoord",
                "Wert": tpop.TPopYKoord,
                "user": sessionStorage.User
            }
        });
        updateTPop_2.always(function() {
            koord_aktualisiert.resolve();
        });
    });
    return koord_aktualisiert.promise();
};

window.apf.olmap.stapleLayerZuoberst = function(layer_title) {
    var layers = window.apf.olmap.map.getLayers(),
        layers_array = window.apf.olmap.map.getLayers().getArray(),
        top_layer;
    _.each(layers_array, function(layer, index) {
        if (layer.get('title') === layer_title) {
            top_layer = layers.removeAt(index);
            layers.insertAt(layers_array.length, top_layer);
        }
    });
    window.apf.olmap.initiiereLayertree();
};

window.apf.verorteTPopAufOlmap = function(tpop) {
	'use strict';
	var bounds,
        x_max,
        x_min,
        y_max,
        y_min;

    // tpop hat keine PopNr
    // Infos von Pop müssen ergänzt werden, weil sie als Label angezeigt werden
    tpop.PopNr = window.apf.pop.PopNr;
    tpop.PopName = window.apf.pop.PopName;
    tpop.Artname = window.apf.ap.Artname;

	//$.when(window.apf.zeigeFormular("GeoAdminKarte"))
	$.when(window.apf.zeigeTPopAufOlmap())
		.then(function() {
            window.apf.olmap.deactivateMenuItems();

             // modify-layer erstellen
             window.apf.olmap.modify_source = new ol.source.Vector();
             var modify_layer = new ol.layer.Vector({
                 title: 'verortende Teilpopulation',
                 kategorie: 'AP Flora',
                 source: window.apf.olmap.modify_source,
                 style: function(feature, resolution) {
                    return window.apf.olmap.tpopStyle(feature, resolution, false, true);
                 }
             });
            window.apf.olmap.map.addLayer(modify_layer);

            if (tpop && tpop.TPopXKoord && tpop.TPopYKoord) {
                // bounds vernünftig erweitern, damit Punkt nicht in eine Ecke zu liegen kommt
                x_max = parseInt(tpop.TPopXKoord) + 200;
                x_min = parseInt(tpop.TPopXKoord) - 200;
                y_max = parseInt(tpop.TPopYKoord) + 200;
                y_min = parseInt(tpop.TPopYKoord) - 200;
                bounds = [x_min, y_min, x_max, y_max];
                // wenn schon eine Koordinate existiert:
                // tpop als feature zum modify hinzufügen
                var new_feature = new ol.Feature(new ol.geom.Point([tpop.TPopXKoord, tpop.TPopYKoord]));
                window.apf.olmap.modify_source.addFeature(new_feature);
                // modify-handler erstellen
                window.apf.olmap.erstelleModifyInteractionFürTPop();
                // Karte zum richtigen Ausschnitt zoomen
                window.apf.olmap.map.updateSize();
                window.apf.olmap.map.getView().fitExtent(bounds, window.apf.olmap.map.getSize());
                // verzögern, sonst funktioniert es nicht
                setTimeout(function() {
                    window.apf.olmap.stapleLayerZuoberst('verortende Teilpopulation');
                }, 200);
            } else {
                // wenn keine Koordinate existiert:
                window.apf.olmap.draw_interaction = new ol.interaction.Draw({
                	source: window.apf.olmap.modify_source,
                    type: /** @type {ol.geom.GeometryType} */ ('Point')
                });
            	window.apf.olmap.map.addInteraction(window.apf.olmap.draw_interaction);
            	
                window.apf.olmap.draw_interaction.once('drawend', function(event) {
        			var coordinates = event.feature.getGeometry().getCoordinates();
                    // Koordinaten in tpop ergänzen
                    tpop.TPopXKoord  = parseInt(coordinates[0]);
                    tpop.TPopYKoord = parseInt(coordinates[1]);
                    $.when(window.apf.aktualisiereKoordinatenVonTPop(tpop))
                        .then(function() {
                            // marker in tpop_layer ergänzen
                            // tpop_layer holen
                            var layers = window.apf.olmap.map.getLayers().getArray(),
                                tpop_layer_nr = $('#olmap_layertree_Teilpopulationen').val(),
                                tpop_layer = layers[tpop_layer_nr],
                                tpop_layer_source = tpop_layer.getSource();
                            // marker ergänzen
                            tpop_layer_source.addFeature(window.apf.olmap.erstelleMarkerFürTPopLayer(tpop));
                            // selects entfernen - aus unerfindlichem Grund ist der neue Marker selektiert
                            window.apf.olmap.removeSelectFeaturesInSelectableLayers();
                        });
                    window.apf.olmap.map.removeInteraction(window.apf.olmap.draw_interaction);
                    // modify-interaction erstellen
                    window.apf.olmap.erstelleModifyInteractionFürTPop();
                }, this);
                // verzögern, sonst funktioniert es nicht
                setTimeout(function() {
                    window.apf.olmap.stapleLayerZuoberst('verortende Teilpopulation');
                }, 200);
            }
		});
};

window.apf.olmap.entferneModifyInteractionFürTpop = function() {
    'use strict';
    if (window.apf.olmap.modify_interaction) {
        window.apf.olmap.map.removeInteraction(window.apf.olmap.modify_interaction);
        delete window.apf.olmap.modify_interaction;
    }
};

window.apf.olmap.erstelleModifyInteractionFürTPop = function() {
    'use strict';
    // allfällige bestehende Interaction entfernen
    window.apf.olmap.entferneModifyInteractionFürTpop();
    // feature-overlay erstellen
    window.apf.olmap.modify_overlay = new ol.FeatureOverlay({
        style: function(feature, resolution) {
            return window.apf.olmap.tpopStyle(feature, resolution, false, true);
        }
    });
    // neues oder gewähltes feature hinzufügen
    window.apf.olmap.modify_overlay.addFeature(window.apf.olmap.modify_source.getFeatures()[0]);
    // modify-interaction erstellen
    window.apf.olmap.modify_interaction = new ol.interaction.Modify({
        features: window.apf.olmap.modify_overlay.getFeatures()
    });
    // zählt, wieviele male .on('change') ausgelöst wurde
    window.apf.olmap.modify_interaction.zähler = 0;
    // interaction.Modify meldet nicht, wenn etwas verändert wurde
    // daher muss registriert werden, wann das feature geändert wird
    window.apf.olmap.modify_overlay.getFeatures().getArray()[0].on('change', function() {
        // funktioniert zwar, wird aber beim Verschieben Dutzende bis hunderte Male ausgelöst
        var zähler,
            coordinates = this.getGeometry().getCoordinates(),
            feature = this;
        window.apf.olmap.modify_interaction.zähler++;
        // speichert, wieviele male .on('change') ausgelöst wurde, bis setTimout aufgerufen wurde
        zähler = window.apf.olmap.modify_interaction.zähler;
        setTimeout(function() {
            if (zähler === window.apf.olmap.modify_interaction.zähler) {
                // in den letzten 200 Millisekunden hat sich nichts geändert > speichern
                // Koordinaten in tpop ergänzen
                window.apf.tpop.TPopXKoord  = parseInt(coordinates[0]);
                window.apf.tpop.TPopYKoord = parseInt(coordinates[1]);
                $.when(window.apf.aktualisiereKoordinatenVonTPop(window.apf.tpop))
                    .then(function() {
                        // marker in tpop_layer ergänzen
                        // tpop_layer neu zeichnen
                        var layers = window.apf.olmap.map.getLayers().getArray(),
                            tpop_layer_nr = $('#olmap_layertree_Teilpopulationen').val(),
                            tpop_layer = layers[tpop_layer_nr],
                            tpop_layer_source = tpop_layer.getSource(),
                            tpop_layer_features = tpop_layer_source.getFeatures(),
                            aktuelles_feature = _.find(tpop_layer_features, function(feature) {
                                return feature.get('myId') === window.apf.tpop.TPopId;
                            });
                        aktuelles_feature.getGeometry().setCoordinates(coordinates);
                        // abhängige Eigenschaften aktualisieren
                        aktuelles_feature.set('xkoord', window.apf.tpop.TPopXKoord);
                        aktuelles_feature.set('ykoord', window.apf.tpop.TPopYKoord);
                        aktuelles_feature.set('popup_content', window.apf.olmap.erstelleContentFürTPop(window.apf.tpop));
                    });
            }
        }, 200);
    });
    /*
    // change scheint nicht zu passieren. Probiert: change, pointerdrag, click, drawend
    window.apf.olmap.modify_interaction.on('move', function(event) {
        console.log('jetzt die Koordinaten aktualisieren');

    });*/
    window.apf.olmap.map.addInteraction(window.apf.olmap.modify_interaction);
};

// input_div: div des Layers, das jetzt aktiviert wird
window.apf.olmap.entferneModifyInteractionFürVectorLayer = function(input_div) {
    'use strict';
    var $modify_layer = $('.modify_layer');
    input_div = input_div || null;
    if (window.apf.olmap.modify_interaction_für_vectorlayer) {
        window.apf.olmap.map.removeInteraction(window.apf.olmap.modify_interaction_für_vectorlayer);
        window.apf.olmap.map.removeInteraction(window.apf.olmap.select_interaction_für_vectorlayer);
        window.apf.olmap.map.removeInteraction(window.apf.olmap.draw_interaction_für_vectorlayer);
        delete window.apf.olmap.modify_interaction_für_vectorlayer;
        delete window.apf.olmap.select_interaction_für_vectorlayer;
        delete window.apf.olmap.draw_interaction_für_vectorlayer;
    }
    // alle buttons im layer-tool zurückstellen
    $modify_layer
        .button({
            icons: {primary: 'ui-icon-locked'},
            text: false
        })
        .button('refresh');
    // tooltip zurücksetzen
    $('.modify_layer_label')
    	.attr('title', 'Ebene bearbeiten')
    	.tooltip({
            tooltipClass: "tooltip-styling-hinterlegt",
            content: 'Ebene bearbeiten'
        });
    // geom_select ausblenden
    $('.modify_layer_geom_type').hide();
    // übrige Layer deaktivieren
    $modify_layer.each(function() {
    	// sicherstellen, dass der jetzt zu aktivierende Layer nicht deaktiviert wird
    	if ($(this).prop('checked') && !$(this).is(input_div)) {
    		$(this).prop("checked", false).change();
    	}
    })
};

window.apf.olmap.erstelleModifyInteractionFürVectorLayer = function(vectorlayer) {
    'use strict';

    var defaultStyle = {
        'Point': [new ol.style.Style({
            image: new ol.style.Circle({
                fill: new ol.style.Fill({
                    color: 'rgba(255,255,0,0.5)'
                }),
                radius: 5,
                stroke: new ol.style.Stroke({
                    color: '#ff0',
                    width: 1
                })
            })
        })],
        'LineString': [new ol.style.Style({
            stroke: new ol.style.Stroke({
                color: '#f00',
                width: 3
            })
        })],
        'Polygon': [new ol.style.Style({
            fill: new ol.style.Fill({
                color: 'rgba(0,255,255,0.5)'
            }),
            stroke: new ol.style.Stroke({
                color: '#0ff',
                width: 1
            })
        })],
        'MultiPoint': [new ol.style.Style({
            image: new ol.style.Circle({
                fill: new ol.style.Fill({
                    color: 'rgba(255,0,255,0.5)'
                }),
                radius: 5,
                stroke: new ol.style.Stroke({
                    color: '#f0f',
                    width: 1
                })
            })
        })],
        'MultiLineString': [new ol.style.Style({
            stroke: new ol.style.Stroke({
                color: '#0f0',
                width: 3
            })
        })],
        'MultiPolygon': [new ol.style.Style({
            fill: new ol.style.Fill({
                color: 'rgba(0,0,255,0.5)'
            }),
            stroke: new ol.style.Stroke({
                color: '#00f',
                width: 1
            })
        })]
    };

    if (vectorlayer === 'neuer_layer') {
        vectorlayer = new ol.layer.Vector({
        	guid: window.apf.erstelleGuid(),
            source: new ol.source.Vector(),
            title: 'neue Ebene',
            kategorie: 'Eigene Ebenen',
            style: function(feature, resolution) {
                return defaultStyle[feature.getGeometry().getType()];
            }
        });
        window.apf.olmap.map.addLayer(vectorlayer);
        // umbenennen, dann ModifyInteraction erstellen
        window.apf.olmap.frageNameFürEbene(vectorlayer);
        return;
    }

    var layer_title = vectorlayer.get('title'),
        $geom_type_select = $('#modify_layer_geom_type_' + layer_title.replace(" ", "_"));

    // darin werden die ids von selectierten features gespeichert
    window.apf.olmap.modified_features = [];

    // allfällige bestehende Interaction entfernen
    window.apf.olmap.entferneModifyInteractionFürVectorLayer();

    // select interaction erstellen
    window.apf.olmap.select_interaction_für_vectorlayer = new ol.interaction.Select({
        layers: function(layer) {
        	// selectable sind nur features aus dem gewählten layer
            return layer.get('title') === layer_title;
        }
    });

    // selected features sollen modifiziert werden können
    window.apf.olmap.selected_features = window.apf.olmap.select_interaction_für_vectorlayer.getFeatures();

    window.apf.olmap.selected_features.on('add', function(event) {
        // now listen if the feature is changed
        var feature = event.element,
            feature_id = feature.getId();
        // wenn jemand eine eigene Ebene ergänzt hat, kann es sein, dass die features keine id's haben
        // also wenn nötig ergänzen
        if (!feature_id) {
            feature.setId(_.uniqueId());
        }
        feature.on('change', function(event) {
            var feature = event.target,
                feature_id = feature.getId();
            window.apf.olmap.modified_features = window.apf.olmap.modified_features || [];
            // id in modified_features ergänzen
            window.apf.olmap.modified_features = _.union(window.apf.olmap.modified_features, [feature_id]);
            // speichern
            window.apf.olmap.aktualisiereEbeneInLocalStorage(vectorlayer);
        });

        // listen to pressing of delete key, then delete selected features
        $(document).on('keyup', function(event) {
            if (event.keyCode == 46) {
                // alle gewählten features aus select_interaction und source entfernen
                window.apf.olmap.selected_features.forEach(function(selected_feature) {
                    var selected_feature_id = selected_feature.getId();
                    window.apf.olmap.selected_features.remove(selected_feature);
                    // features aus vectorlayer_source entfernen
                    var vectorlayer_features = vectorlayer.getSource().getFeatures();
                    vectorlayer_features.forEach(function(source_feature) {
                        var source_feature_id = source_feature.getId();
                        if (source_feature_id === selected_feature_id) {
                            vectorlayer.getSource().removeFeature(source_feature);
			                // speichern
			                window.apf.olmap.aktualisiereEbeneInLocalStorage(vectorlayer);
                        }
                    });
                });
                $(document).off('keyup');
            }
        });

        // verhindern, dass Knoten im Strukturbaum entfernt werden
        $.jstree._reference("[typ='ap_ordner_pop']").deselect_all();
    });

    window.apf.olmap.selected_features.on('remove', function(event) {
        var feature = event.element,
            feature_id = feature.getId(),
            feature_index = window.apf.olmap.modified_features.indexOf(feature_id);
        if (feature_index > -1) {
            // speichern
            window.apf.olmap.aktualisiereEbeneInLocalStorage(vectorlayer);
            // erst wieder speichern, wenn neu verändert wurde
            window.apf.olmap.modified_features.splice(feature_index, 1);
        }
    });

    // global definieren: wird benötigt, um später (beim Klick auf 'Ebene bearbeiten') festzustellen, ob eine modify-interaction existiert
    window.apf.olmap.modify_interaction_für_vectorlayer = new ol.interaction.Modify({
        features: window.apf.olmap.select_interaction_für_vectorlayer.getFeatures(),
        // the SHIFT key must be pressed to delete vertices, so
        // that new vertices can be drawn at the same position
        // of existing vertices
        deleteCondition: function(event) {
            return ol.events.condition.shiftKeyOnly(event) &&
                ol.events.condition.singleClick(event);
        }
    });

    $geom_type_select.on('selectmenuchange', function(event) {
        window.apf.olmap.map.removeInteraction(window.apf.olmap.draw_interaction_für_vectorlayer);
        addDrawInteraction();
    });

    function addDrawInteraction() {
        if ($geom_type_select.val() !== 'leerwert') {
            window.apf.olmap.draw_interaction_für_vectorlayer = new ol.interaction.Draw({
                source: vectorlayer.getSource(),
                type: /** @type {ol.geom.GeometryType} */ ($geom_type_select.val())
            });
            window.apf.olmap.map.addInteraction(window.apf.olmap.draw_interaction_für_vectorlayer);
            // bei 'drawend' würde man Änderungen in die DB schreiben
            window.apf.olmap.draw_interaction_für_vectorlayer.on('drawend', function(event) {
                var id = _.uniqueId();
                event.feature.setId(id);
                window.apf.olmap.modified_features = window.apf.olmap.modified_features || [];
                // id in modified_features ergänzen
                window.apf.olmap.modified_features = _.union(window.apf.olmap.modified_features, [id]);
                // speichern
                window.apf.olmap.aktualisiereEbeneInLocalStorage(vectorlayer);
            });
        }
    }

    addDrawInteraction();
    window.apf.olmap.map.addInteraction(window.apf.olmap.select_interaction_für_vectorlayer);
    window.apf.olmap.map.addInteraction(window.apf.olmap.modify_interaction_für_vectorlayer);
};

window.apf.olmap.exportiereLayer = function(layer, selected_value) {
	'use strict';
	var layer_name = layer.get('title') || 'Eigene_Ebene',
		allFeatures = layer.getSource().getFeatures(),
        format = new ol.format[selected_value](),
        data_parsed,
        data_stringified;
    layer_name += '.' + selected_value;
    try {
        data_parsed = format.writeFeatures(allFeatures);
    } catch (e) {
        window.apf.melde('Sorry, das kann Open Layers 3 noch nicht richtig', 'Fehler beim Export');
        return;
    }
    if (selected_value === 'GeoJSON') {
    	try {
        	data_stringified = JSON.stringify(data_parsed, null, 4);
    	}
    	catch (e) {
    		window.apf.melde('Sorry, das kann Open Layers 3 noch nicht richtig', 'Fehler beim Export');
    	}
    } else {
        var serializer = new XMLSerializer();
        try {
        	data_stringified = serializer.serializeToString(data_parsed);
    	}
    	catch (e) {
    		window.apf.melde('Sorry, das kann Open Layers 3 noch nicht richtig', 'Fehler beim Export');
    	}
    }
    window.apf.download(layer_name, data_stringified);
};

window.apf.download = function(filename, text) {
	'use strict';
    var pom = document.createElement('a');
    pom.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
    pom.setAttribute('download', filename);
    pom.click();
};

window.apf.olmap.istLayerSichtbarNachName = function(layername) {
	'use strict';
	var layer_objekt_array,
		layer_ist_sichtbar;
	// prüfen, ob eine map existiert
	if (window.apf.olmap.map) {
		layer_objekt_array = window.apf.olmap.map.getLayers().getArray();
		layer_ist_sichtbar = _.find(layer_objekt_array, function(layer_objekt) {
			return layer_objekt.get('title') === layername && layer_objekt.get('visible');
		});
		if (layer_ist_sichtbar) {
			return true;
		}
	}
	return false;
};

window.apf.zeigeTPopAufOlmap = function(TPopListeMarkiert) {
	'use strict';
	// wenn layer "Populationen" sichtbar ist, sichtbar behalten
	var overlay_pop_visible = window.apf.olmap.istLayerSichtbarNachName("Populationen");
	// wenn layer "Populationen Namen" sichtbar ist, sichtbar behalten
	var overlay_popnr_visible = window.apf.olmap.istLayerSichtbarNachName("Populationen Nummern");
	
	var markierte_tpop = window.apf.olmap.wähleAusschnittFürÜbergebeneTPop(TPopListeMarkiert);

	// Grundkarte aufbauen
	$.when(window.apf.zeigeFormular("GeoAdminKarte"))
		.then(function() {
			// Karte zum richtigen Ausschnitt zoomen
            window.apf.olmap.map.updateSize();
            window.apf.olmap.map.getView().fitExtent(markierte_tpop.bounds, window.apf.olmap.map.getSize());
			// tpop und pop ergänzen
			// alle tpop holen
			var getTPopKarteAlle = $.ajax({
				type: 'get',
				url: 'php/tpop_karte_alle.php',
				dataType: 'json',
				data: {
					"ApArtId": window.apf.ap.ApArtId
				}
			});

			getTPopKarteAlle.always(function(tpop_liste) {
				$.when(
					// Layer für Symbole und Beschriftung erstellen
					window.apf.olmap.erstelleTPopLayer(tpop_liste, markierte_tpop.tpopid_markiert, true),
					// alle Pop holen
					window.apf.olmap.zeigePopInTPop(overlay_pop_visible, overlay_popnr_visible)
				)
				.then(function() {
					// layertree neu aufbauen
					window.apf.olmap.initiiereLayertree();
				});
			});

			getTPopKarteAlle.fail(function() {
				//window.apf.melde("Fehler: Es konnten keine Teilpopulationen aus der Datenbank abgerufen werden");
				console.log('Fehler: Es konnten keine Teilpopulationen aus der Datenbank abgerufen werden');
			});
	});
};

window.apf.zeigePopAufOlmap = function(PopListeMarkiert) {
	'use strict';
	// falls noch aus dem Verorten ein Klick-Handler besteht: deaktivieren
	if (window.apf.olmap.LetzterKlickHandler) {
		window.apf.olmap.LetzterKlickHandler.deactivate();
	}
	
	var markierte_pop = window.apf.olmap.wähleAusschnittFürÜbergebenePop(PopListeMarkiert),
		extent;

	// Grundkarte aufbauen
	$.when(window.apf.zeigeFormular("GeoAdminKarte"))
		.then(function() {
			// Karte zum richtigen Ausschnitt zoomen
			// aber nur, wenn keine Auswahl aktiv
			if (window.apf.olmap.auswahlPolygonLayer && window.apf.olmap.auswahlPolygonLayer.features.length > 0) {
				// Auswahl aktiv, Zoomstufe belassen
			} else {
				window.apf.olmap.map.updateSize();
                window.apf.olmap.map.getView().fitExtent(markierte_pop.bounds, window.apf.olmap.map.getSize());
			}
			// tpop und pop ergänzen
			// alle tpop holen
			var getTPopKarteAlle_2 = $.ajax({
				type: 'get',
				url: 'php/tpop_karte_alle.php',
				dataType: 'json',
				data: {
					"ApArtId": window.apf.ap.ApArtId
				}
			});

			getTPopKarteAlle_2.always(function(TPopListe) {
				$.when(
					// Layer für Symbole und Beschriftung erstellen
                    window.apf.olmap.erstelleTPopLayer(TPopListe),
					// alle Pop holen, symbole und nr sichtbar schalten, Markierung übergeben
					window.apf.olmap.zeigePopInTPop(true, true, markierte_pop.popid_markiert)
				)
				.then(function() {
					// layertree neu aufbauen
					window.apf.olmap.initiiereLayertree();
				});
			});

			getTPopKarteAlle_2.fail(function() {
				//window.apf.melde("Fehler: Es konnten keine Daten aus der Datenbank abgerufen werden");
				console.log('Fehler: Es konnten keine Daten aus der Datenbank abgerufen werden');
			});
	});
};

// übernimmt eine Liste von (markierten) TPop
// retourniert den Ausschnitt = bounds der angezeigt werden soll
// und einen array mit den tpop_id's der liste
window.apf.olmap.wähleAusschnittFürÜbergebeneTPop = function(tpop_liste_markiert) {
	'use strict';
	var bounds,
		xkoord_array = [],
		ykoord_array = [],
        x_max,
        y_max,
        x_min,
        y_min;

	// bounds der anzuzeigenden bestimmen
	var tpopid_markiert = [];
	if (tpop_liste_markiert && tpop_liste_markiert.rows && tpop_liste_markiert.rows.length > 0) {
        _.each(tpop_liste_markiert.rows, function(tpop) {
            tpopid_markiert.push(tpop.TPopId);
            xkoord_array.push(tpop.TPopXKoord);
	        ykoord_array.push(tpop.TPopYKoord);
        });
        // extent berechnen
	    // puffern, damit immer alles sichtbar ist
	    // underscore retourniert strings, also in Zahlen umwandeln
	    x_max = parseInt(_.max(xkoord_array)) + 70;
	    x_min = parseInt(_.min(xkoord_array)) - 70;
	    y_max = parseInt(_.max(ykoord_array)) + 70;
	    y_min = parseInt(_.min(ykoord_array)) - 70;
	    bounds = [x_min, y_min, x_max, y_max];
	} else {
		// keine tpop übergeben, Kanton anzeigen
        bounds = [669000, 222000, 717000, 284000];
	}
	return {bounds: bounds, tpopid_markiert: tpopid_markiert};
};

// übernimmt eine Liste von (markierten) Pop
// retourniert den Ausschnitt = bounds der angezeigt werden soll
// und einen array mit den tpop_id's der liste
window.apf.olmap.wähleAusschnittFürÜbergebenePop = function(pop_liste_markiert) {
	'use strict';
	var bounds,
		xkoord_array = [],
		ykoord_array = [],
        x_max,
        y_max,
        x_min,
        y_min,
        // bounds der anzuzeigenden bestimmen
		popid_markiert = [];
	if (pop_liste_markiert && pop_liste_markiert.rows.length > 0) {
        _.each(pop_liste_markiert.rows, function(pop) {
            popid_markiert.push(pop.PopId);
            xkoord_array.push(pop.PopXKoord);
	        ykoord_array.push(pop.PopYKoord);
        });
        // extent berechnen
	    // puffern, damit immer alles sichtbar ist
	    // underscore retourniert strings, also in Zahlen umwandeln
	    x_max = parseInt(_.max(xkoord_array)) + 70;
	    x_min = parseInt(_.min(xkoord_array)) - 70;
	    y_max = parseInt(_.max(ykoord_array)) + 70;
	    y_min = parseInt(_.min(ykoord_array)) - 70;
	    bounds = [x_min, y_min, x_max, y_max];
	} else {
		// keine tpop übergeben, Kanton anzeigen
        bounds = [669000, 222000, 717000, 284000];
	}
	return {bounds: bounds, popid_markiert: popid_markiert};
};

window.apf.olmap.zeigePopInTPop = function(overlay_pop_visible, overlay_popnr_visible, popid_markiert) {
	'use strict';
	var pop_gezeigt = $.Deferred(),
		getPopKarteAlle = $.ajax({
			type: 'get',
			url: 'php/pop_karte_alle.php',
			dataType: 'json',
			data: {
				"ApArtId": window.apf.ap.ApArtId
			}
		});
	getPopKarteAlle.always(function(PopListe) {
		// Layer für Symbole und Beschriftung erstellen
		$.when(
			window.apf.olmap.erstellePopLayer(PopListe, popid_markiert, overlay_pop_visible)
		)
		.then(function() {
			// layertree neu aufbauen
			window.apf.olmap.initiiereLayertree();
			pop_gezeigt.resolve();
		});
	});
	getPopKarteAlle.fail(function() {
		//window.apf.melde("Fehler: Es konnten keine Populationen aus der Datenbank abgerufen werden");
		console.log('Fehler: Es konnten keine Daten aus der Datenbank abgerufen werden');
		pop_gezeigt.resolve();
	});
	return pop_gezeigt.promise();
};

window.apf.olmap.erstelleTPopulation = function(TPop) {
	'use strict';
	// styles für overlay_top definieren
	var defaultStyle = new OpenLayers.Style({
			externalGraphic: '//www.apflora.ch/img/flora_icon_rot.png',
			graphicWidth: 32, graphicHeight: 37, graphicYOffset: -37,
			title: '${tooltip}'
		}),
		selectStyle = new OpenLayers.Style({
			externalGraphic: '//www.apflora.ch/img/flora_icon_gelb.png'
		}),
		// overlay layer für Marker vorbereiten
		overlay_tpopulation = new OpenLayers.Layer.Vector('Teilpopulation', {
			styleMap: new OpenLayers.StyleMap({
				'default': defaultStyle,
				'select': defaultStyle
			})
		}),
		myLocation = new OpenLayers.Geometry.Point(TPop.TPopXKoord, TPop.TPopYKoord),
		myTPopFlurname = TPop.TPopFlurname || '(kein Flurname)',
		// tooltip bzw. label vorbereiten: nullwerte ausblenden
		myTooltip;
	if (window.apf.pop.PopNr && TPop.TPopNr) {
		myTooltip = window.apf.pop.PopNr + '/' + TPop.TPopNr + ' ' + myTPopFlurname;
	} else if (window.apf.pop.PopNr) {
		myTooltip = window.apf.pop.PopNr + '/?' + ' ' + myTPopFlurname;
	} else if (TPop.TPopNr) {
		myTooltip = '?/' + TPop.TPopNr + ' ' + myTPopFlurname;
	} else {
		myTooltip = '?/?' + ' ' + myTPopFlurname;
	}

	// marker erstellen...
	// gewählte erhalten style gelb und zuoberst
	var marker = new OpenLayers.Feature.Vector(myLocation, {
		tooltip: myTooltip
	});

	// die marker der Ebene hinzufügen
	overlay_tpopulation.addFeatures(marker);

	// die marker sollen verschoben werden können
	var dragControl = new OpenLayers.Control.DragFeature(overlay_tpopulation, {
		onComplete: function(feature) {
			// x und y merken
			TPop.TPopXKoord = feature.geometry.x;
			TPop.TPopYKoord = feature.geometry.y;
			// Datensatz updaten
			window.apf.speichereWert('tpop', localStorage.tpop_id, 'TPopXKoord', TPop.TPopXKoord);
			window.apf.speichereWert('tpop', localStorage.tpop_id, 'TPopYKoord', TPop.TPopYKoord);
		}
	});
	window.apf.olmap.addControl(dragControl);
	dragControl.activate();

	// overlay zur Karte hinzufügen
	window.apf.olmap.addLayer(overlay_tpopulation);

	// control zur Karte hinzufügen
	window.selectControlTPop = new OpenLayers.Control.SelectFeature(overlay_tpopulation, {clickout: true});
	window.apf.olmap.addControl(window.selectControlTPop);
	window.selectControlTPop.activate();
};

// dieser Funktion kann man einen Wert zum speichern übergeben
window.apf.speichereWert = function(tabelle, id, feld, wert) {
	'use strict';
	var updateTabelle = $.ajax({
		type: 'post',
		url: 'php/' + tabelle + '_update.php',
		dataType: 'json',
		data: {
			"id": id,
			"Feld": feld,
			"Wert": wert,
			"user": sessionStorage.User
		}
	});
	updateTabelle.fail(function() {
		//window.apf.melde("Fehler: Die letzte Änderung wurde nicht gespeichert");
		console.log('Fehler: Die letzte Änderung wurde nicht gespeichert');
	});
};

window.apf.olmap.erstelleContentFürTPop = function(tpop) {
    'use strict';
    var my_flurname = tpop.TPopFlurname || '(kein Flurname)';
    return '<table>'+
        '<tr><td><p>Typ:</p></td><td><p>Teilpopulation</p></td></tr>'+
        '<tr><td><p>Population:</p></td><td><p>' + tpop.PopName + '</p></td></tr>'+
        '<tr><td><p>Teilpopulation:</p></td><td><p>' + my_flurname + '</p></td></tr>'+
        '<tr><td><p>Koordinaten:</p></td><td><p>' + tpop.TPopXKoord + ' / ' + tpop.TPopYKoord + '</p></td></tr>'+
        '</table>'+
        "<p><a href=\"#\" onclick=\"window.apf.öffneTPop('" + tpop.TPopId + "')\">Formular anstelle Karte öffnen<\/a></p>"+
        '<p><a href="#" onclick=\"window.apf.öffneFormularAlsPopup(\'tpop\', ' + tpop.TPopId + ')\">Formular neben der Karte öffnen<\/a></p>'+
        "<p><a href=\"#\" onclick=\"window.apf.öffneTPopInNeuemTab('" + tpop.TPopId + "')\">Formular in neuem Fenster öffnen<\/a></p>";
};

// retourniert features
// übergibt man einen Typ, werden nur features dieses Typs retourniert
window.apf.olmap.listSelectedFeatures = function(typ) {
    'use strict';
	var selected_features = window.apf.olmap.map.olmap_select_interaction.getFeatures().getArray(),
		features_to_return;
	features_to_return = _.filter(selected_features, function(feature) {
		if (typ) {
			return feature.get('myTyp') === typ;
		} else {
			return feature.get('myTyp');
		}
	});
	return features_to_return;
};

window.apf.olmap.erstelleListeDerAusgewähltenPopTPop = function(pop_selected, tpop_selected) {
	'use strict';
	// rückmelden, welche Objekte gewählt wurden
	var rückmeldung = "",
		pop_id,
        tpop_id;

    // globale Variabeln anlegen, damit die Exportfunktionen sie später nutzen können
    window.apf.olmap.pop_selected = pop_selected;
    window.apf.olmap.tpop_selected = tpop_selected;

	if (pop_selected.length > 0) {
        // pop nach nr sortieren
        pop_selected = _.sortBy(pop_selected, function(pop) {
            var pop_nr = pop.get('pop_nr');
            return parseInt(pop_nr);
        });
		if (tpop_selected.length > 0) {
			// tpop und pop betitteln
			rückmeldung += "<p class='ergebnisAuswahlListeTitel'>" + pop_selected.length + " Populationen: </p>";
		}
		rückmeldung += "<table>";
        _.each(pop_selected, function(pop) {
        	pop_id = pop.get('myId');
            rückmeldung += "<tr><td><a href=\"#\" onclick=\"window.apf.öffnePop('" + pop_id + "')\">";
            rückmeldung += pop.get('pop_nr') + ":<\/a></td><td><a href=\"#\" onclick=\"window.apf.öffnePop('" + pop_id + "')\">" + pop.get('pop_name') + "<\/a></td></tr>";
        });
		rückmeldung += "</table>";
	}
	if (tpop_selected.length > 0) {
        // tpop nach nr dann tpopnr sortieren
        tpop_selected = _.sortBy(tpop_selected, function(tpop) {
            var pop_nr = tpop.get('pop_nr') || 0,
                tpop_nr = tpop.get('tpop_nr') || 0,
                pop_tpop_nr = parseFloat(parseInt(pop_nr) + '.' + parseInt(tpop_nr));
            return pop_tpop_nr;
        });
		if (pop_selected.length > 0) {
			// tpop und pop betitteln
			rückmeldung += "<p class='ergebnisAuswahlListeTitel ergebnisAuswahlListeTitelTPop'>" + tpop_selected.length + " Teilpopulationen: </p>";
		}
		rückmeldung += "<table>";
        _.each(tpop_selected, function(tpop) {
            tpop_id = tpop.get('myId');
            rückmeldung += "<tr><td><a href=\"#\" onclick=\"window.apf.öffneTPopInNeuemTab('" + tpop_id + "')\">";
            rückmeldung += tpop.get('tpop_nr_label') + ":<\/a></td><td><a href=\"#\" onclick=\"window.apf.öffneTPopInNeuemTab('" + tpop_id + "')\">";
            rückmeldung += tpop.get('tpop_name') + "<\/a></td></tr>";
        });
		rückmeldung += "</table>";
	}
	// Höhe der Meldung begrenzen. Leider funktioniert maxHeight nicht
	var height = "auto";
	if (tpop_selected.length > 25) {
		height = 650;
	}

	// Listentitel erstellen
	var listentitel,
		exportieren = "Exportieren: ",
		exportierenPop = "<a href='#' class='export_pop'>Populationen</a>",
		exportierenTPop = "<a href='#' class='export_tpop'>Teilpopulationen</a>, <a href='#' class='export_kontr'>Kontrollen</a>, <a href='#' class='export_massn'>Massnahmen</a>";
	if (pop_selected.length > 0 && tpop_selected.length > 0) {
		listentitel = "Gewählt wurden " + pop_selected.length + " Populationen und " + tpop_selected.length + " Teilpopulationen";
		exportieren += exportierenPop + ", " + exportierenTPop;
	} else if (pop_selected.length > 0) {
		listentitel = "Gewählt wurden " + pop_selected.length + " Populationen:";
		exportieren += exportierenPop;
	} else if (tpop_selected.length > 0) {
		listentitel = "Gewählt wurden " + tpop_selected.length + " Teilpopulationen:";
		exportieren += exportierenTPop;
	} else {
		listentitel = "Keine Populationen/Teilpopulationen gewählt";
		exportieren = "";
	}
	$("#ergebnisAuswahlHeaderText").html(listentitel);
	$("#ergebnisAuswahlListe").html(rückmeldung);
	$("#ergebnisAuswahlFooter").html(exportieren);
	// Ergebnis-Div einblenden
	$("#ergebnisAuswahl").css("display", "block");
};

// sucht features an einem Ort in der Karte
window.apf.olmap.sucheFeatures = function(pixel) {
	var features = [];
	window.apf.olmap.map.forEachFeatureAtPixel(pixel, function(feature, layer) {
		features.push(feature);
	});
	return features;
};

window.apf.olmap.entfernePopupOverlays = function() {
	var overlays = window.apf.olmap.map.getOverlays().getArray(),
		zu_löschender_overlay = [];
	_.each(overlays, function(overlay) {
		if (overlay.get('typ') === 'popup') {
			zu_löschender_overlay.push(overlay);
		}
	});
	_.each(zu_löschender_overlay, function(overlay) {
		window.apf.olmap.map.removeOverlay(overlay);
	});
	// alle qtips entfernen
	$('.qtip').each(function() {
		$(this).qtip('destroy', true);
	});
};

window.apf.olmap.zeigeFeatureInfo = function(pixel, coordinate) {
	var features = window.apf.olmap.sucheFeatures(pixel),
		overlay,
		popup_id,
		popup_id_array = [],
		koordinaten,
		popup_title,
		popup_text = '',
		features_mit_typ;
	// es scheint auch weitere Features zu geben (z.B. wenn man genau auf die Koordinate einer Pop klickt)
	// nur die gewollten behalten
	features_mit_typ = _.filter(features, function(feature) {
		return feature.get('myTyp') ||  feature.get('popup_title');
	});
	if (features_mit_typ && features_mit_typ.length > 0) {
		// wenn mehrere features_mit_typ vorkommen: die Infos aller sammeln und anzeigen
		if (features_mit_typ.length > 1) {
			_.each(features_mit_typ, function(feature, index) {
				if (feature.get('myTyp') === 'Detailplan') {
					popup_text += '<h3>Objekt ID: ' + feature.get('OBJECTID') + '</h3>';
				    popup_text += '<table><tr><td><p>Typ:</p></td><td><p>Detailplan</p></td></tr>'+
		    			'<tr><td><p>Fläche:</p></td><td><p>' + parseInt(feature.get('SHAPE_Area') / 10) + '</p></td></tr>'+
		    			'<tr><td><p>Bemerkunge:</p></td><td><p>' + (feature.get('Bemerkunge') || "") + '</p></td></tr>'+
		    			'<tr><td><p>Bemerkun_1:</p></td><td><p>' + (feature.get('Bemerkun_1') || "") + '</p></td></tr></table>';
				} else {
					popup_text += '<h3>' + feature.get('popup_title') + '</h3>';
					popup_text += feature.get('popup_content');
				}
				if (index + 1 < features_mit_typ.length) {
					popup_text += '<hr>';
				}
			});
			popup_title = features_mit_typ.length + ' Treffer';
			// als Koordinaten den Ort des Klicks nehmen
			koordinaten = coordinate;
		} else {
			// es gibt nur einen feature
			if (features_mit_typ[0].get('myTyp') === 'Detailplan') {
			    popup_text = '<table><tr><td><p>Typ:</p></td><td><p>Detailplan</p></td></tr>'+
	    			'<tr><td><p>Fläche:</p></td><td><p>' + parseInt(features_mit_typ[0].get('SHAPE_Area') / 10) + '</p></td></tr>'+
	    			'<tr><td><p>Bemerkunge:</p></td><td><p>' + (features_mit_typ[0].get('Bemerkunge') || "") + '</p></td></tr>'+
	    			'<tr><td><p>Bemerkun_1:</p></td><td><p>' + (features_mit_typ[0].get('Bemerkun_1') || "") + '</p></td></tr></table>';
				popup_title = 'Objekt ID: ' + features_mit_typ[0].get('OBJECTID');
			} else {
				popup_text = features_mit_typ[0].get('popup_content');
				popup_title = features_mit_typ[0].get('popup_title');
			}
			// als Koordinaten die Koordinate des popups nehmen
			if (features_mit_typ[0].get('xkoord') && features_mit_typ[0].get('ykoord')) {
				koordinaten = [features_mit_typ[0].get('xkoord'), features_mit_typ[0].get('ykoord')];
			} else {
				koordinaten = coordinate;
			}
		}

		// zuerst mit gtip einen popup erzeugen
		$('.olmap_popup').each(function() {
			$(this).qtip({
				content: {
		            text: popup_text,
		            title: popup_title,
		            button: 'Close'
		        },
		        style: {
		            // Use the jQuery UI widget classes
		            widget: true,
		            // Remove the default styling
		            def: false,
		            classes: 'olmap_popup_styling',
			        tip: {
			        	width: 20,
			        	height: 20
			        }
		        },
		        position: {
		            my: 'top left',
		            at: 'bottom right',
		            target: $(this),
		            viewport: $('#GeoAdminKarte')
		        }
	        });
	        $(this).qtip('toggle', true);
		});

		// id des popups ermitteln
		$('.qtip').each(function() {
			popup_id_array.push($(this).attr('data-qtip-id'));
		});
		popup_id = _.max(popup_id_array);

		// die mit qtip erzeugte div dem overlay übergeben
		overlay = new ol.Overlay({
			element: $('#qtip-' + popup_id)
		});
		window.apf.olmap.map.addOverlay(overlay);
		overlay.setPosition(koordinaten);
		overlay.set('typ', 'popup');
	} else {
		// alle popups entfernen
		window.apf.olmap.entfernePopupOverlays();
	}
};

window.apf.olmap.erstelleContentFürPop = function(pop) {
    'use strict';
    return '<table>'+
        '<tr><td><p>Typ:</p></td><td><p>Population</p></td></tr>'+
        '<tr><td><p>Koordinaten:</p></td><td><p>' + pop.PopXKoord + ' / ' + pop.PopYKoord + '</p></td></tr>'+
        '</table>'+
        "<p><a href=\"#\" onclick=\"window.apf.öffnePop('" + pop.PopId + "')\">Formular anstelle Karte öffnen<\/a></p>"+
        '<p><a href="#" onclick=\"window.apf.öffneFormularAlsPopup(\'pop\', ' + pop.PopId + ')\">Formular neben der Karte öffnen<\/a></p>'+
        "<p><a href=\"#\" onclick=\"window.apf.öffnePopInNeuemTab('" + pop.PopId + "')\">Formular in neuem Fenster öffnen<\/a></p>";
};

// übernimmt drei Variablen: popliste ist das Objekt mit den Populationen
// popid_markiert der Array mit den ausgewählten Pop
// visible: Ob die Ebene sichtbar geschaltet wird (oder bloss im Layertree verfügbar ist)
window.apf.olmap.erstellePopLayer = function(popliste, popid_markiert, visible) {
    'use strict';
    var pop_layer_erstellt = $.Deferred(),
        markers = [],
        marker,
        my_label,
        my_name,
        popup_content,
        pop_mit_nr_layer,
        selected_features;

    if (window.apf.olmap.map && window.apf.olmap.map.olmap_select_interaction && popid_markiert) {
    	selected_features = window.apf.olmap.map.olmap_select_interaction.getFeatures().getArray();
    } else if (popid_markiert) {
    	window.apf.olmap.addSelectFeaturesInSelectableLayers();
    	selected_features = window.apf.olmap.map.olmap_select_interaction.getFeatures().getArray();
    }

    if (visible === null) {
        visible = true;
    }

    _.each(popliste.rows, function(pop) {
        my_name = pop.PopName || '(kein Name)';
        popup_content = window.apf.olmap.erstelleContentFürPop(pop);

        // tooltip bzw. label vorbereiten: nullwerte ausblenden
        if (pop.PopNr) {
            my_label = pop.PopNr.toString();
        } else {
            my_label = '?';
        }

        // marker erstellen...
        marker = new ol.Feature({
            geometry: new ol.geom.Point([pop.PopXKoord, pop.PopYKoord]),
            pop_nr: my_label,
            pop_name: my_name,
            name: my_label, // noch benötigt? TODO: entfernen
            popup_content: popup_content,
            popup_title: my_name,
            // Koordinaten werden gebraucht, damit das popup richtig platziert werden kann
            xkoord: pop.PopXKoord,
            ykoord: pop.PopYKoord,
            myTyp: 'pop',
            myId: pop.PopId
        });

        // marker in Array speichern
        markers.push(marker);

        // markierte in window.apf.olmap.map.olmap_select_interaction ergänzen
        if (popid_markiert && popid_markiert.indexOf(pop.PopId) !== -1) {
        	selected_features.push(marker);
        }
    });

    // layer für Marker erstellen
    pop_mit_nr_layer = new ol.layer.Vector({
        title: 'Populationen',
        selectable: true,
        source: new ol.source.Vector({
            features: markers
        }),
        style: function(feature, resolution) {
            return window.apf.olmap.popStyle(feature, resolution);
        }
    });
    pop_mit_nr_layer.set('visible', visible);
    pop_mit_nr_layer.set('kategorie', 'AP Flora');
    window.apf.olmap.map.addLayer(pop_mit_nr_layer);

    if (selected_features && selected_features.length > 0) {
	    setTimeout(function() {
	        window.apf.olmap.prüfeObPopTpopGewähltWurden();
	    }, 100);
	    // Schaltfläche olmap_auswaehlen aktivieren
	    $('#olmap_auswaehlen')
            .prop('checked', true)
            .button("refresh");
    }

    pop_layer_erstellt.resolve();
    return pop_layer_erstellt.promise();
};


// ermöglicht es, nach dem toolip zu sortieren
window.apf.vergleicheTPopZumSortierenNachTooltip = function(a,b) {
	'use strict';
	if (a.tooltip < b.tooltip)
		 return -1;
	if (a.tooltip > b.tooltip)
		return 1;
	return 0;
};

window.apf.deaktiviereGeoAdminAuswahl = function() {
	'use strict';
	if (window.apf.olmap.auswahlPolygonLayer) {
		window.apf.olmap.auswahlPolygonLayer.removeAllFeatures();
	}
	if (window.drawControl) {
		window.drawControl.deactivate();
	}
	$("#ergebnisAuswahl").css("display", "none");
	delete window.apf.tpop_id_array;
	delete window.tpop_id_liste;
	delete window.apf.pop_id_array;
	delete window.pop_id_liste;
};

window.apf.erstelleTPopNrLabel = function(popnr, tpopnr) {
    'use strict';
    // tooltip bzw. label vorbereiten: nullwerte ausblenden
    if (popnr && tpopnr) {
        return popnr + '/' + tpopnr;
    } else if (popnr) {
        return popnr + '/?';
    } else if (tpopnr) {
        return '?/' + tpopnr;
    } else {
        return '?/?';
    }
};

window.apf.olmap.erstelleMarkerFürTPopLayer = function(tpop) {
	return new ol.Feature({
		geometry: new ol.geom.Point([tpop.TPopXKoord, tpop.TPopYKoord]),
        tpop_nr: tpop.TPopNr,
        pop_nr: tpop.PopNr,
        tpop_nr_label: window.apf.erstelleTPopNrLabel(tpop.PopNr, tpop.TPopNr),
        tpop_name: tpop.TPopFlurname || '(kein Name)',
		name: window.apf.erstelleTPopNrLabel(tpop.PopNr, tpop.TPopNr),  // brauchts das noch? TODO: entfernen
        popup_content: window.apf.olmap.erstelleContentFürTPop(tpop),
        popup_title: tpop.Artname,
        // koordinaten werden benötigt damit das popup am richtigen Ort verankert wird
        xkoord: tpop.TPopXKoord,
        ykoord: tpop.TPopYKoord,
        myTyp: 'tpop',
        myId: tpop.TPopId
	});
};

// nimmt drei Variablen entgegen:
// tpop_liste: Die Liste der darzustellenden Teilpopulationen
// tpopid_markiert: die ID der zu markierenden TPop
// visible: Ob das Layer sichtbar sein soll
window.apf.olmap.erstelleTPopLayer = function(tpop_liste, tpopid_markiert, visible) {
	'use strict';

	var tpop_layer_erstellt = $.Deferred(),
		tpop_layer,
		markers = [],
		marker,
        selected_features;

    if (window.apf.olmap.map.olmap_select_interaction && tpopid_markiert) {
        selected_features = window.apf.olmap.map.olmap_select_interaction.getFeatures().getArray();
    } else if (tpopid_markiert) {
        window.apf.olmap.addSelectFeaturesInSelectableLayers();
        selected_features = window.apf.olmap.map.olmap_select_interaction.getFeatures().getArray();
    }

    if (visible === null) {
        visible = true;
    }

    _.each(tpop_liste.rows, function(tpop) {
        // marker erstellen...
        marker = window.apf.olmap.erstelleMarkerFürTPopLayer(tpop);

        // ...und in Array speichern
        markers.push(marker);

        // markierte in window.apf.olmap.map.olmap_select_interaction ergänzen
        if (tpopid_markiert && tpopid_markiert.indexOf(tpop.TPopId) !== -1) {
            selected_features.push(marker);
        }
    });

    // layer für Marker erstellen
	tpop_layer = new ol.layer.Vector({
		title: 'Teilpopulationen',
		source: new ol.source.Vector({
				features: markers
			}),
		style: function(feature, resolution) {
            return window.apf.olmap.tpopStyle(feature, resolution);
        }
	});
    tpop_layer.set('visible', visible);
    tpop_layer.set('kategorie', 'AP Flora');
    
    // ...und der Karte hinzufügen
    window.apf.olmap.map.addLayer(tpop_layer);

    if (selected_features && selected_features.length > 0) {
        setTimeout(function() {
            window.apf.olmap.prüfeObPopTpopGewähltWurden();
        }, 100);
        // Schaltfläche olmap_auswaehlen aktivieren
        $('#olmap_auswaehlen')
            .prop('checked', true)
            .button("refresh");
    }

	tpop_layer_erstellt.resolve();
	return tpop_layer_erstellt.promise();
};

window.apf.olmap.onFeatureSelect = function(feature) {
	'use strict';
	var popup = new OpenLayers.Popup.FramedCloud("popup",
			feature.geometry.getBounds().getCenterLonLat(),
			null,
			feature.attributes.message,
			null,
			false	// true zeigt Schliess-Schalftläche an. Schliessen zerstört aber event-listener > popup kann nur ein mal angezeigt werden!
		);
	popup.autoSize = true;
	popup.maxSize = new OpenLayers.Size(600,600);
	popup.fixedRelativePosition = true;
	feature.popup = popup;
	window.apf.gmap.addPopup(popup);
};

window.apf.olmap.onFeatureUnselect = function(feature) {
	'use strict';
	feature.popup.hide();
};

window.apf.gmap.zeigeBeobUndTPop = function(beob_liste, tpop_liste) {
	'use strict';
	window.tpop_liste = tpop_liste;
	var anz_beob,
        anz_tpop,
        infowindow_beob,
        infowindow_tpop,
        tpop,
        lat,
        lng,
        latlng,
        options,
        map,
        bounds,
        markers_tpop,
        tpop_id,
        latlng2,
        marker_beob,
        marker_tpop,
        contentstring_beob,
        contentstring_tpop,
        marker_options_beob,
        marker_options_tpop,
        marker_cluster_beob,
        marker_cluster_tpop,
        datum,
        titel_beob,
        tpop_beschriftung,
        a_note,
        my_flurname;
	// vor Erneuerung zeigen - sonst klappt Wiederaufruf nicht, wenn die Karte schon angezeigt ist
	window.apf.zeigeFormular("google_karte");
	window.apf.gmap.markers_array = [];
	window.apf.gmap.info_window_array = [];
	infowindow_beob = new google.maps.InfoWindow();
	infowindow_tpop = new google.maps.InfoWindow();
	// Lat und Lng in BeobListe ergänzen
    _.each(beob_liste.rows, function(beob) {
        beob.Lat = window.apf.CHtoWGSlat(parseInt(beob.X), parseInt(beob.Y));
        beob.Lng = window.apf.CHtoWGSlng(parseInt(beob.X), parseInt(beob.Y));
    });
	// dito in TPopListe
    _.each(tpop_liste.rows, function(tpop, index) {
        if (!tpop.TPopXKoord || !tpop.TPopYKoord) {
            // tpop gibt in Chrome Fehler
            delete tpop_liste.rows[index];
        } else {
            tpop.Lat = window.apf.CHtoWGSlat(parseInt(tpop.TPopXKoord), parseInt(tpop.TPopYKoord));
            tpop.Lng = window.apf.CHtoWGSlng(parseInt(tpop.TPopXKoord), parseInt(tpop.TPopYKoord));
        }
    });
	// Beob zählen
	anz_beob = beob_liste.rows.length;
	// TPop zählen
	anz_tpop = tpop_liste.rows.length;
	// Karte mal auf Zürich zentrieren, falls in den BeobListe.rows keine Koordinaten kommen
	// auf die die Karte ausgerichtet werden kann
	lat = 47.383333;
	lng = 8.533333;
	latlng = new google.maps.LatLng(lat, lng);
	options = {
		zoom: 15,
		center: latlng,
		streetViewControl: false,
		mapTypeId: google.maps.MapTypeId.SATELLITE
	};
	map = new google.maps.Map(document.getElementById("google_karten_div"), options);
	window.apf.gmap.map = map;
	bounds = new google.maps.LatLngBounds();

	// für alle TPop Marker erstellen
	markers_tpop = [];
    _.each(tpop_liste.rows, function(tpop) {
        tpop_id = tpop.TPopId;
        latlng2 = new google.maps.LatLng(tpop.Lat, tpop.Lng);
        // Kartenausschnitt um diese Koordinate erweitern
        bounds.extend(latlng2);
        tpop_beschriftung = window.apf.beschrifteTPopMitNrFürKarte(tpop.PopNr, tpop.TPopNr);
        marker_tpop = new MarkerWithLabel({
            map: map,
            position: latlng2,
            title: tpop_beschriftung,
            labelContent: tpop_beschriftung,
            labelAnchor: new google.maps.Point(75, 0),
            labelClass: "MapLabel",
            icon: "img/flora_icon.png"
        });
        markers_tpop.push(marker_tpop);
        my_flurname = tpop.TPopFlurname || '(kein Flurname)';
        contentstring_tpop = '<div id="content">'+
            '<div id="siteNotice">'+
            '</div>'+
            '<div id="bodyContent" class="GmInfowindow">'+
            '<h3>' + tpop.Artname + '</h3>'+
            '<p>Population: ' + tpop.PopName + '</p>'+
            '<p>TPop: ' + my_flurname + '</p>'+
            '<p>Koordinaten: ' + tpop.TPopXKoord + ' / ' + tpop.TPopYKoord + '</p>'+
            "<p><a href=\"#\" onclick=\"window.apf.öffneTPop('" + tpop.TPopId + "')\">Formular anstelle Karte öffnen<\/a></p>"+
            '<p><a href="#" onclick=\"window.apf.öffneFormularAlsPopup(\'tpop\', ' + tpop.TPopId + ')\">Formular neben der Karte öffnen<\/a></p>'+
            "<p><a href=\"#\" onclick=\"window.apf.öffneTPopInNeuemTab('" + tpop.TPopId + "')\">Formular in neuem Fenster öffnen<\/a></p>"+
            '</div>'+
            '</div>';
        makeListener(map, marker_tpop, contentstring_tpop);
    });
	marker_options_tpop = {
		maxZoom: 17, 
		styles: [{
				height: 53,
				url: "img/m8.png",
				width: 53
			}]
	};
	marker_cluster_tpop = new MarkerClusterer(map, markers_tpop, marker_options_tpop);
	
	// diese Funktion muss hier sein, damit infowindow bekannt ist
	function makeListener(map, markerTPop, contentStringTPop) {
		google.maps.event.addListener(markerTPop, 'click', function() {
			infowindow_tpop.setContent(contentStringTPop);
			infowindow_tpop.open(map, markerTPop);
		});
	}

	// für alle Beob Marker erstellen
	window.markersBeob = [];
    _.each(beob_liste.rows, function(beob) {
        datum = beob.Datum;
        latlng2 = new google.maps.LatLng(beob.Lat, beob.Lng);
        if (anz_beob === 1) {
            // map.fitbounds setzt zu hohen zoom, wenn nur eine Beob Koordinaten hat > verhindern
            latlng = latlng2;
        } else {
            // Kartenausschnitt um diese Koordinate erweitern
            bounds.extend(latlng2);
        }
        // title muss String sein
        if (datum) {
            titel_beob = datum.toString();
        } else {
            titel_beob = "";
        }
        // A_NOTE muss String sein
        if (beob.A_NOTE) {
            a_note = beob.A_NOTE.toString();
        } else {
            a_note = "";
        }
        marker_beob = new MarkerWithLabel({
            map: map,
            position: latlng2,
            title: titel_beob,
            labelContent: a_note,
            labelAnchor: new google.maps.Point(75, 0),
            labelClass: "MapLabel",
            icon: "img/flora_icon_violett.png",
            draggable: true
        });
        window.markersBeob.push(marker_beob);
        makeListenerMarkerBeobDragend(marker_beob, beob);
        var Autor = beob.Autor || "(keiner)";
        var Projekt = beob.PROJET || "(keines)";
        var Ort = beob.DESC_LOCALITE || "(keiner)";
        contentstring_beob = '<div id="content">'+
            '<div id="siteNotice">'+
            '</div>'+
            '<div id="bodyContent" class="GmInfowindow">'+
            '<h3>' + datum + '</h3>'+
            '<p>Autor: ' + Autor + '</p>'+
            '<p>Projekt: ' + Projekt + '</p>'+
            '<p>Ort: ' + Ort + '</p>'+
            '<p>Koordinaten: ' + beob.X + ' / ' + beob.Y + '</p>'+
            "<p><a href=\"#\" onclick=\"window.apf.öffneBeob('" + beob.NO_NOTE + "')\">Formular anstelle Karte öffnen<\/a></p>"+
            //'<p><a href="#" onclick=\"window.apf.öffneFormularAlsPopup(\'beob\', ' + beob.NO_NOTE + ')\">Formular neben der Karte öffnen<\/a></p>'+
            "<p><a href=\"#\" onclick=\"window.apf.öffneBeobInNeuemTab('" + beob.NO_NOTE + "')\">Formular in neuem Fenster öffnen<\/a></p>"+
            '</div>'+
            '</div>';
        makeListenerBeob(map, marker_beob, contentstring_beob);
    });
	// KEIN MARKERCLUSTERER: er verhindert das Entfernen einzelner Marker!
	// ausserdem macht er es schwierig, eng liegende Marker zuzuordnen
	
	// diese Funktion muss hier sein, damit infowindow bekannt ist
	function makeListenerBeob(map, markerBeob, contentStringBeob) {
		google.maps.event.addListener(markerBeob, 'click', function() {
			infowindow_beob.setContent(contentStringBeob);
			infowindow_beob.open(map, markerBeob);
		});
	}

	function makeListenerMarkerBeobDragend(markerBeob, Beob) {
		google.maps.event.addListener(markerBeob, "dragend", function(event) {
			var lat, lng, X, Y, that;
			that = this;
			// Koordinaten berechnen
			lat = event.latLng.lat();
			lng = event.latLng.lng();
			X = window.apf.DdInChY(lat, lng);
			Y = window.apf.DdInChX(lat, lng);
			// nächstgelegene TPop aus DB holen
			var BeobNächsteTPop = $.ajax({
				type: 'get',
				url: 'php/beob_naechste_tpop.php',
				data: {
					"ApArtId": Beob.NO_ISFS,
					"X": X,
					"Y": Y
				},
				dataType: 'json'
			});
			BeobNächsteTPop.always(function(data) {
				var beobtxt;
				if (Beob.Autor) {
					beobtxt = "Beobachtung von " + Beob.Autor + " aus dem Jahr " + Beob.A_NOTE;
				} else {
					beobtxt = "Beobachtung ohne Autor aus dem Jahr " + Beob.A_NOTE;
				}
				// rückfragen
				$("#Meldung")
                    .html("Soll die " + beobtxt + "<br>der Teilpopulation '" + data[0].TPopFlurname + "' zugeordnet werden?")
                    .dialog({
					modal: true,
					title: "Zuordnung bestätigen",
					width: 600,
					buttons: {
						Ja: function() {
							$(this).dialog("close");
							// dem bind.move_node mitteilen, dass das Formular nicht initiiert werden soll
							localStorage.karte_fokussieren = true;
							// Beob der TPop zuweisen
							$("#tree").jstree("move_node", "#beob" + Beob.NO_NOTE, "#tpop_ordner_beob_zugeordnet" + data[0].TPopId, "first");
							// Den Marker der zugewiesenen Beobachtung entfernen
							that.setMap(null);
						},
						Nein: function() {
							$(this).dialog("close");
							// drag rückgängig machen
							lng = window.apf.CHtoWGSlng(Beob.X, Beob.Y);
							lat = window.apf.CHtoWGSlat(Beob.X, Beob.Y);
							var latlng3 = new google.maps.LatLng(lat, lng);
							that.setPosition(latlng3);
						}
					}
				});
			});
			BeobNächsteTPop.fail(function() {
				//window.apf.melde("Fehler: Die Beobachtung wurde nicht zugeordnet");
				console.log('Fehler: Die Beobachtung wurde nicht zugeordnet');
			});
		});
	}

	if (anz_tpop + anz_beob === 1) {
		// map.fitbounds setzt zu hohen zoom, wenn nur ein Punkt dargestellt wird > verhindern
		map.setCenter(latlng);
		map.setZoom(18);
	} else {
		// Karte auf Ausschnitt anpassen
		map.fitBounds(bounds);
	}
};

window.apf.gmap.zeigeBeob = function(beob_liste) {
	'use strict';
	var anz_beob,
        infowindow,
        lat,
        lng,
        latlng,
        options,
        map,
        bounds,
        markers,
        latlng2,
        marker,
        contentString,
        marker_options,
        marker_cluster,
        datum,
        titel,
        a_note;
	// vor Erneuerung zeigen - sonst klappt Wiederaufruf nicht, wenn die Karte schon angezeigt ist
	window.apf.zeigeFormular("google_karte");
	window.apf.gmap.markers_array = [];
	window.apf.gmap.info_window_array = [];
	infowindow = new google.maps.InfoWindow();
	// Lat und Lng in BeobListe ergänzen
    _.each(beob_liste.rows, function(beob) {
        beob.Lat = window.apf.CHtoWGSlat(parseInt(beob.X), parseInt(beob.Y));
        beob.Lng = window.apf.CHtoWGSlng(parseInt(beob.X), parseInt(beob.Y));
    });
	// TPop zählen
	anz_beob = beob_liste.rows.length;
	// Karte mal auf Zürich zentrieren, falls in den BeobListe.rows keine Koordinaten kommen
	// auf die die Karte ausgerichtet werden kann
	lat = 47.383333;
	lng = 8.533333;
	latlng = new google.maps.LatLng(lat, lng);
	options = {
		zoom: 15,
		center: latlng,
		streetViewControl: false,
		mapTypeId: google.maps.MapTypeId.SATELLITE,
		mapTypeControlOptions: {
			mapTypeIds: [
			google.maps.MapTypeId.ROADMAP,
			google.maps.MapTypeId.TERRAIN,
			google.maps.MapTypeId.SATELLITE,
			google.maps.MapTypeId.HYBRID
			]
		}
	};
	map = new google.maps.Map(document.getElementById("google_karten_div"), options);
	window.apf.gmap.map = map;
	bounds = new google.maps.LatLngBounds();
	// für alle Orte Marker erstellen
	markers = [];
    _.each(beob_liste.rows, function(beob) {
        datum = beob.Datum;
        latlng2 = new google.maps.LatLng(beob.Lat, beob.Lng);
        if (anz_beob === 1) {
            // map.fitbounds setzt zu hohen zoom, wenn nur eine Beob Koordinaten hat > verhindern
            latlng = latlng2;
        } else {
            // Kartenausschnitt um diese Koordinate erweitern
            bounds.extend(latlng2);
        }
        // title muss String sein
        if (datum) {
            titel = datum.toString();
        } else {
            titel = "";
        }
        // A_NOTE muss String sein
        if (beob.A_NOTE) {
            a_note = beob.A_NOTE.toString();
        } else {
            a_note = "";
        }
        marker = new MarkerWithLabel({
            map: map,
            position: latlng2,
            title: titel,
            labelContent: a_note,
            labelAnchor: new google.maps.Point(75, 0),
            labelClass: "MapLabel",
            icon: "img/flora_icon_violett.png"
        });
        // dem Marker einen Typ und eine id geben
        // damit drag and drop möglich werden soll
        // marker.set("typ", "beob");
        // marker.set("id", Beob.BeobId);
        marker.metadata = {typ: "beob_nicht_beurteilt", id: beob.NO_NOTE};
        markers.push(marker);
        var Autor = beob.Autor || "(keiner)";
        var Projekt = beob.PROJET || "(keines)";
        var Ort = beob.DESC_LOCALITE || "(keiner)";
        contentString = '<div id="content">'+
            '<div id="siteNotice">'+
            '</div>'+
            '<div id="bodyContent" class="GmInfowindow">'+
            '<h3>' + datum + '</h3>'+
            '<p>Autor: ' + Autor + '</p>'+
            '<p>Projekt: ' + Projekt + '</p>'+
            '<p>Ort: ' + Ort + '</p>'+
            '<p>Koordinaten: ' + beob.X + ' / ' + beob.Y + '</p>'+
            "<p><a href=\"#\" onclick=\"window.apf.öffneBeob('" + beob.NO_NOTE + "')\">Formular anstelle Karte öffnen<\/a></p>"+
            "<p><a href=\"#\" onclick=\"window.apf.öffneBeobInNeuemTab('" + beob.NO_NOTE + "')\">Formular in neuem Fenster öffnen<\/a></p>"+
            '</div>'+
            '</div>';
        makeListener(map, marker, contentString);
    });
	marker_options = {
		maxZoom: 17, 
		styles: [{
				height: 53,
				url: "img/m5.png",
				width: 53
			}]
	};
	marker_cluster = new MarkerClusterer(map, markers, marker_options);
	if (anz_beob === 1) {
		// map.fitbounds setzt zu hohen zoom, wenn nur eine Beobachtung erfasst wurde > verhindern
		map.setCenter(latlng);
		map.setZoom(18);
	} else {
		// Karte auf Ausschnitt anpassen
		map.fitBounds(bounds);
	}
	// diese Funktion muss hier sein, damit infowindow bekannt ist
	function makeListener(map, marker, contentString) {
		google.maps.event.addListener(marker, 'click', function() {
			infowindow.setContent(contentString);
			infowindow.open(map, marker);
		});
	}
};

window.apf.gmap.zeigeTPopBeob = function(tpop_beob_liste) {
	'use strict';
	var anz_tpop_beob,
        infowindow,
        lat,
        lng,
        latlng,
        options,
        map,
        bounds,
        markers,
        latlng2,
        marker,
        contentString,
        marker_options,
        marker_cluster,
        datum,
        titel;
	// vor Erneuerung zeigen - sonst klappt Wiederaufruf nicht, wenn die Karte schon angezeigt ist
	window.apf.zeigeFormular("google_karte");
	window.apf.gmap.markers_array = [];
	window.apf.gmap.info_window_array = [];
	infowindow = new google.maps.InfoWindow();
	// TPopListe bearbeiten:
	// Objekte löschen, die keine Koordinaten haben
	// Lat und Lng ergänzen
    _.each(tpop_beob_liste.rows, function(tpop_beob) {
        tpop_beob.Lat = window.apf.CHtoWGSlat(parseInt(tpop_beob.X), parseInt(tpop_beob.Y));
        tpop_beob.Lng = window.apf.CHtoWGSlng(parseInt(tpop_beob.X), parseInt(tpop_beob.Y));
    });
	// TPop zählen
	anz_tpop_beob = tpop_beob_liste.rows.length;
	// Karte mal auf Zürich zentrieren, falls in den TPopBeobListe.rows keine Koordinaten kommen
	// auf die die Karte ausgerichtet werden kann
	lat = 47.383333;
	lng = 8.533333;
	latlng = new google.maps.LatLng(lat, lng);
	options = {
		zoom: 15,
		center: latlng,
		streetViewControl: false,
		mapTypeId: google.maps.MapTypeId.SATELLITE,
		mapTypeControlOptions: {
			mapTypeIds: [
			google.maps.MapTypeId.ROADMAP,
			google.maps.MapTypeId.TERRAIN,
			google.maps.MapTypeId.SATELLITE,
			google.maps.MapTypeId.HYBRID
			]
		}
	};
	map = new google.maps.Map(document.getElementById("google_karten_div"), options);
	window.apf.gmap.map = map;
	// Versuch: SVO einblenden
	//loadWMS(map, "//wms.zh.ch/FnsSVOZHWMS?");
	//loadWMS(map, "//www.gis.zh.ch/scripts/wmsfnssvo2.asp?");
	// Versuch: AV einblenden
	//loadWMS(map, "//wms.zh.ch/avwms?");
	bounds = new google.maps.LatLngBounds();
	// für alle Orte Marker erstellen
	markers = [];
    _.each(tpop_beob_liste.rows, function(tpop_beob) {
        datum = tpop_beob.Datum;
        latlng2 = new google.maps.LatLng(tpop_beob.Lat, tpop_beob.Lng);
        if (anz_tpop_beob === 1) {
            // map.fitbounds setzt zu hohen zoom, wenn nur eine TPopBeob Koordinaten hat > verhindern
            latlng = latlng2;
        } else {
            // Kartenausschnitt um diese Koordinate erweitern
            bounds.extend(latlng2);
        }
        // title muss String sein
        if (datum) {
            titel = datum.toString();
        } else {
            titel = "";
        }
        marker = new MarkerWithLabel({
            map: map,
            position: latlng2,
            // title muss String sein
            title: titel,
            labelContent: titel,
            labelAnchor: new google.maps.Point(75, 0),
            labelClass: "MapLabel",
            icon: "img/flora_icon_violett.png"
        });
        markers.push(marker);
        var Autor = tpop_beob.Autor || "(keiner)";
        var Projekt = tpop_beob.PROJET || "(keines)";
        var Ort = tpop_beob.DESC_LOCALITE || "(keiner)";
        contentString = '<div id="content">'+
            '<div id="siteNotice">'+
            '</div>'+
            '<div id="bodyContent" class="GmInfowindow">'+
            '<h3>' + datum + '</h3>'+
            '<p>Autor: ' + Autor + '</p>'+
            '<p>Projekt: ' + Projekt + '</p>'+
            '<p>Ort: ' + Ort + '</p>'+
            '<p>Koordinaten: ' + tpop_beob.X + ' / ' + tpop_beob.Y + '</p>'+
            "<p><a href=\"#\" onclick=\"window.apf.öffneTPopBeob('" + tpop_beob.NO_NOTE + "')\">Formular anstelle Karte öffnen<\/a></p>"+
            "<p><a href=\"#\" onclick=\"window.apf.öffneTPopBeobInNeuemTab('" + tpop_beob.NO_NOTE + "')\">Formular in neuem Fenster öffnen<\/a></p>"+
            '</div>'+
            '</div>';
        makeListener(map, marker, contentString);
    });
	marker_options = {
		maxZoom: 17, 
		styles: [{
				height: 53,
				url: "img/m5.png",
				width: 53
			}]
	};
	marker_cluster = new MarkerClusterer(map, markers, marker_options);
	if (anz_tpop_beob === 1) {
		// map.fitbounds setzt zu hohen zoom, wenn nur eine Beobachtung erfasst wurde > verhindern
		map.setCenter(latlng);
		map.setZoom(18);
	} else {
		// Karte auf Ausschnitt anpassen
		map.fitBounds(bounds);
	}
	// diese Funktion muss hier sein, damit infowindow bekannt ist
	function makeListener(map, marker, contentString) {
		google.maps.event.addListener(marker, 'click', function() {
			infowindow.setContent(contentString);
			infowindow.open(map, marker);
		});
	}
};

window.apf.gmap.verorteTPop = function(tpop) {
	'use strict';
	var infowindow = new google.maps.InfoWindow(),
        lat,
        lng,
        latlng,
        zoom_level,
        options,
        map,
        map_canvas = $('#google_karten_div'),
        verorted,
        marker,
        content_string,
        tpop_beschriftung,
        my_flurname;
    window.apf.gmap.markers_array = [];

	// vor Erneuerung zeigen - sonst klappt Wiederaufruf nicht, wenn die Karte schon angezeigt ist
	window.apf.zeigeFormular("google_karte");

    // Optionen für die Anzeige
	if (tpop && tpop.TPopXKoord && tpop.TPopYKoord) {
		// Wenn Koordinaten vorhanden, Lat und Lng ergänzen
		lat = window.apf.CHtoWGSlat(parseInt(tpop.TPopXKoord), parseInt(tpop.TPopYKoord));
		lng = window.apf.CHtoWGSlng(parseInt(tpop.TPopXKoord), parseInt(tpop.TPopYKoord));
		zoom_level = 15;
		verorted = true;
	} else {
		// sonst auf Zürich zentrieren
		lat = 47.360566;
		lng = 8.542829;
		zoom_level = 12;
		verorted = false;
	}
	latlng = new google.maps.LatLng(lat, lng);
	options = {
		zoom: zoom_level,
		center: latlng,
		streetViewControl: false,
		mapTypeId: google.maps.MapTypeId.SATELLITE
	};

    // Karte gründen
	map = new google.maps.Map(map_canvas[0], options);
	window.apf.gmap.map = map;

	if (verorted) {
        // marker erstellen
		tpop_beschriftung = window.apf.beschrifteTPopMitNrFürKarte(tpop.PopNr, tpop.TPopNr);
		marker = new google.maps.Marker({
			position: latlng, 
			map: map,
			title: tpop_beschriftung,
			icon: "img/flora_icon_rot.png",
			draggable: true
		});
		// Marker in Array speichern, damit er gelöscht werden kann
		window.apf.gmap.markers_array.push(marker);

        // infowindow erstellen
		my_flurname = tpop.TPopFlurname || '(kein Flurname)';
		content_string = '<div id="content">'+
			'<div id="siteNotice">'+
			'</div>'+
			'<div id="bodyContent" class="GmInfowindow">'+
			'<h3>' + my_flurname + '</h3>'+
			'<p>Koordinaten: ' + tpop.TPopXKoord + ' / ' + tpop.TPopYKoord + '</p>'+
			"<p><a href=\"#\" onclick=\"window.apf.öffneTPop('" + tpop.TPopId + "')\">Formular anstelle Karte öffnen<\/a></p>"+
            '<p><a href="#" onclick=\"window.apf.öffneFormularAlsPopup(\'tpop\', ' + tpop.TPopId + ')\">Formular neben der Karte öffnen<\/a></p>'+
			"<p><a href=\"#\" onclick=\"window.apf.öffneTPopInNeuemTab('" + tpop.TPopId + "')\">Formular in neuem Fenster öffnen<\/a></p>"+
			'</div>'+
			'</div>';
		infowindow = new google.maps.InfoWindow({
			content: content_string
		});
		if (!window.apf.gmap.info_window_array) {
			window.apf.gmap.info_window_array = [];
		}
		window.apf.gmap.info_window_array.push(infowindow);

		google.maps.event.addListener(marker, 'click', function() {
			infowindow.open(map, marker);
		});
		google.maps.event.addListener(marker, "dragend", function(event) {
			window.apf.gmap.SetLocationTPop(event.latLng, map, marker, tpop);
		});
	}

    // listener bei klick in Karte
    // entfernt bestehenden marker, erstellt neuen und aktualisiert Koordinaten
	google.maps.event.addListener(map, 'click', function(event) {
		window.apf.gmap.erstelleMarker(event.latLng, map, marker, tpop);
	});
};

window.apf.gmap.erstelleMarker = function(location, map, marker, tpop) {
	'use strict';
	var title;

	// title muss String sein
	if (tpop && tpop.TPopFlurname) {
		title = tpop.TPopFlurname;
	} else {
		title = "neue Teilpopulation";
	}
	// zuerst bisherigen Marker löschen
	window.apf.gmap.clearMarkers();
	var marker = new google.maps.Marker({
		position: location, 
		map: map,
		title: title,
		icon: "img/flora_icon_rot.png",
		draggable: true
	});
	// Marker in Array speichern, damit er gelöscht werden kann
	window.apf.gmap.markers_array.push(marker);
	google.maps.event.addListener(marker, "dragend", function(event) {
		window.apf.gmap.SetLocationTPop(event.latLng, map, marker, tpop);
	});
	window.apf.gmap.SetLocationTPop(location, map, marker);
};

window.apf.gmap.SetLocationTPop = function(LatLng, map, marker, TPop) {
	'use strict';
	var lat,
		lng,
		contentString,
		infowindow,
		Objekt,
		title,
		X,
		Y;
	// nur aktualisieren, wenn Schreibrechte bestehen
	if (!window.apf.prüfeSchreibvoraussetzungen()) {
		return;
	}
	if (TPop && TPop.TPopFlurname) {
		title = TPop.TPopFlurname;
	} else {
		title = "neue Teilpopulation";
	}
	lat = LatLng.lat();
	lng = LatLng.lng();
	X = window.apf.DdInChY(lat, lng);
	Y = window.apf.DdInChX(lat, lng);
	var updateTPop_3 = $.ajax({
		type: 'post',
		url: 'php/tpop_update.php',
		dataType: 'json',
		data: {
			"id": localStorage.tpop_id,
			"Feld": "TPopXKoord",
			"Wert": X,
			"user": sessionStorage.User
		}
	});
	updateTPop_3.always(function() {
		var updateTPop_4 = $.ajax({
			type: 'post',
			url: 'php/tpop_update.php',
			dataType: 'json',
			data: {
				"id": localStorage.tpop_id,
				"Feld": "TPopYKoord",
				"Wert": Y,
				"user": sessionStorage.User
			}
		});
		updateTPop_4.always(function() {
			window.apf.gmap.clearInfoWindows();
			contentString = '<div id="content">'+
				'<div id="siteNotice">'+
				'</div>'+
				'<div id="bodyContent" class="GmInfowindow">'+
				'<h3>' + title + '</h3>'+
				'<p>Koordinaten: ' + X + ' / ' + Y + '</p>'+
				"<p><a href=\"#\" onclick=\"window.apf.öffneTPop('" + localStorage.tpop_id + "')\">Formular anstelle Karte öffnen<\/a></p>"+
                '<p><a href="#" onclick=\"window.apf.öffneFormularAlsPopup(\'tpop\', ' + localStorage.tpop_id + ')\">Formular neben der Karte öffnen<\/a></p>'+
				"<p><a href=\"#\" onclick=\"window.apf.öffneTPopInNeuemTab('" + localStorage.tpop_id + "')\">Formular in neuem Fenster öffnen<\/a></p>"+
				'</div>'+
				'</div>';
			infowindow = new google.maps.InfoWindow({
				content: contentString
			});
			if (!window.apf.gmap.info_window_array) {
				window.apf.gmap.info_window_array = [];
			}
			window.apf.gmap.info_window_array.push(infowindow);
			google.maps.event.addListener(marker, 'click', function() {
				infowindow.open(map, marker);
			});
		});
		updateTPop_4.fail(function() {
			//window.apf.melde("Fehler: Die Y-Koordinate wurde nicht übernommen (die X-Koordinate offenbar schon)");
			console.log('Fehler: Die Y-Koordinate wurde nicht übernommen (die X-Koordinate offenbar schon)');
		});
	});
	updateTPop_3.fail(function() {
		//window.apf.melde("Fehler: Die Koordinaten wurden nicht übernommen");
		console.log('Fehler: Die Koordinaten wurden nicht übernommen');
	});
};

// GoogleMap: alle Marker löschen
// benutzt wo in GoogleMaps Marker gesetzt und verschoben werden
window.apf.gmap.clearMarkers = function() {
	'use strict';
    _.each(window.apf.gmap.markers_array, function(marker) {
        marker.setMap(null);
    });
};

// GoogleMap: alle InfoWindows löschen
// benutzt wo in GoogleMaps Infowindows neu gesetzt werden müssen, weil die Daten verändert wurden
window.apf.gmap.clearInfoWindows = function() {
	'use strict';
    _.each(window.apf.gmap.info_window_array, function(info_window) {
        info_window.setMap(null);
    });
};

window.apf.öffneTPop = function(tpop_id) {
	'use strict';
	localStorage.tpop_id = tpop_id;
	$.jstree._reference("[typ='tpop']#" + tpop_id).deselect_all();
	$("#tree").jstree("select_node", "[typ='tpop']#" + tpop_id);
};

window.apf.öffneTPopInNeuemTab = function(tpop_id) {
	'use strict';
	window.open("index.html?ap="+localStorage.ap_id+"&pop=" + localStorage.pop_id+"&tpop="+tpop_id, "_blank");
};

window.apf.öffnePop = function(pop_id) {
	'use strict';
	localStorage.pop_id = pop_id;
	$.jstree._reference("[typ='pop']#" + pop_id).deselect_all();
	$("#tree").jstree("select_node", "[typ='pop']#" + pop_id);
};

window.apf.öffnePopInNeuemTab = function(pop_id) {
	'use strict';
	window.open("index.html?ap="+localStorage.ap_id+"&pop=" + pop_id, "_blank");
};

window.apf.öffneBeob = function(beob_id) {
	'use strict';
	localStorage.beob_id = beob_id;
	$.jstree._reference("[typ='beob_nicht_beurteilt']#beob" + beob_id).deselect_all();
	$("#tree").jstree("select_node", "[typ='beob_nicht_beurteilt']#beob" + beob_id);
};

window.apf.öffneBeobInNeuemTab = function(beob_id) {
	'use strict';
	window.open("index.html?ap="+localStorage.ap_id+"&beob_nicht_beurteilt=" + beob_id, "_blank");
};

window.apf.öffneTPopBeob = function(beob_id) {
	'use strict';
	localStorage.beob_id = beob_id;
	$.jstree._reference("[typ='beob_zugeordnet']#beob" + beob_id).deselect_all();
	$("#tree").jstree("select_node", "[typ='beob_zugeordnet']#beob" + beob_id);
};

window.apf.öffneTPopBeobInNeuemTab = function(beob_id) {
	'use strict';
	window.open("index.html?ap="+localStorage.ap_id+"&beob_nicht_beurteilt=" + beob_id, "_blank");
};





/* 
	Document   : wms.js
	Created on : Feb 16, 2011, 3:25:27 PM
	Author	 : "Gavin Jackson <Gavin.Jackson@csiro.au>"

	Refactored code from //lyceum.massgis.state.ma.us/wiki/doku.php?id=googlemapsv3:home

	example: loadWMS(map, "//spatial.ala.org.au/geoserver/wms?", customParams);

	You can easily add a WMS overlay by calling the loadWMS(map, baseURL, customParams) function, where:

	map - is an instance of Google.maps.Map
	baseURL - is the base URL of your WMS server (eg geoserver)
	customParams - Additional WMS parameters
*/

function bound(value, opt_min, opt_max) {
	if (opt_min != null) value = Math.max(value, opt_min);
	if (opt_max != null) value = Math.min(value, opt_max);
	return value;
}

function degreesToRadians(deg) {
	return deg * (Math.PI / 180);
}

function radiansToDegrees(rad) {
	return rad / (Math.PI / 180);
}

function MercatorProjection() {
	var MERCATOR_RANGE = 256;
	this.pixelOrigin_ = new google.maps.Point(
		MERCATOR_RANGE / 2, MERCATOR_RANGE / 2);
	this.pixelsPerLonDegree_ = MERCATOR_RANGE / 360;
	this.pixelsPerLonRadian_ = MERCATOR_RANGE / (2 * Math.PI);
}

MercatorProjection.prototype.fromLatLngToPoint = function(latLng, opt_point) {
	var me = this,
		point = opt_point || new google.maps.Point(0, 0),
		origin = me.pixelOrigin_;
	point.x = origin.x + latLng.lng() * me.pixelsPerLonDegree_;
	// NOTE(appleton): Truncating to 0.9999 effectively limits latitude to
	// 89.189.  This is about a third of a tile past the edge of the world tile.
	var siny = bound(Math.sin(degreesToRadians(latLng.lat())), -0.9999, 0.9999);
	point.y = origin.y + 0.5 * Math.log((1 + siny) / (1 - siny)) * -me.pixelsPerLonRadian_;
	return point;
};

MercatorProjection.prototype.fromDivPixelToLatLng = function(pixel, zoom) {
	var me = this,
		origin = me.pixelOrigin_,
		scale = Math.pow(2, zoom),
		lng = (pixel.x / scale - origin.x) / me.pixelsPerLonDegree_,
		latRadians = (pixel.y / scale - origin.y) / -me.pixelsPerLonRadian_,
		lat = radiansToDegrees(2 * Math.atan(Math.exp(latRadians)) - Math.PI / 2);
	return new google.maps.LatLng(lat, lng);
};

MercatorProjection.prototype.fromDivPixelToSphericalMercator = function(pixel, zoom) {
	var me = this,
		coord = me.fromDivPixelToLatLng(pixel, zoom),
		r = 6378137.0,
		x = r * degreesToRadians(coord.lng()),
		latRad = degreesToRadians(coord.lat()),
		y = (r / 2) * Math.log((1 + Math.sin(latRad)) / (1 - Math.sin(latRad)));
	return new google.maps.Point(x,y);
};

function loadWMS(map, baseURL, customParams){
	var tileHeight = 256,
		tileWidth = 256,
		opacityLevel = 0.75,
		isPng = true,
		minZoomLevel = 2,
		maxZoomLevel = 28;

	//var baseURL = "";
	// für SVO
	var wmsParams = [
	"REQUEST=GetMap",
	"SERVICE=WMS",
	"VERSION=1.1.1",
	//"WIDTH=512",
	//"HEIGHT=512",
	//"SRS=EPSG:4326",
	//"LAYERS=zonen-schutzverordnungen",
	"STYLES=default",
	"TRANSPARENT=TRUE",
	"FORMAT=image/gif"
	];
	// für av
	/*var wmsParams = [
	//"REQUEST=GetCapabilities",
	//"SERVICE=WMS",
	//"VERSION=1.3.0",
	"WIDTH="+ tileWidth,
	"HEIGHT="+ tileHeight
	];*/

	// add additional parameters
	wmsParams = wmsParams.concat(customParams);

	var overlayOptions = {
		getTileUrl: function(coord, zoom) {
			var lULP = new google.maps.Point(coord.x*256,(coord.y+1)*256);
			var lLRP = new google.maps.Point((coord.x+1)*256,coord.y*256);

			var projectionMap = new MercatorProjection();

			var lULg = projectionMap.fromDivPixelToSphericalMercator(lULP, zoom);
			var lLRg  = projectionMap.fromDivPixelToSphericalMercator(lLRP, zoom);

			var lUL_Latitude = lULg.y;
			var lUL_Longitude = lULg.x;
			var lLR_Latitude = lLRg.y;
			var lLR_Longitude = lLRg.x;
			// GJ: there is a bug when crossing the -180 longitude border (tile does not render) - this check seems to fix it
			if (lLR_Longitude < lUL_Longitude){
			  lLR_Longitude = Math.abs(lLR_Longitude);
			}
			var urlResult = baseURL + wmsParams.join("&") + "&bbox=" + lUL_Longitude + "," + lUL_Latitude + "," + lLR_Longitude + "," + lLR_Latitude;

			return urlResult;
		},

		tileSize: new google.maps.Size(tileHeight, tileWidth),

		minZoom: minZoomLevel,
		maxZoom: maxZoomLevel,

		opacity: opacityLevel,

		isPng: isPng
	};

	var overlayWMS = new google.maps.ImageMapType(overlayOptions);

	map.overlayMapTypes.insertAt(0, overlayWMS);

	map.setOptions({
		mapTypeControlOptions: {
			mapTypeIds: [
				google.maps.MapTypeId.ROADMAP,
				google.maps.MapTypeId.TERRAIN,
				google.maps.MapTypeId.SATELLITE,
				google.maps.MapTypeId.HYBRID
			],
			style: google.maps.MapTypeControlStyle.DROPDOWN_MENU
		}
	});
}

/*! Copyright (c) 2011 Brandon Aaron (//brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: //adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(//www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.6
 * 
 * Requires: 1.2.2+
 *
 * Benutzt, um Mouswheel-Scrollen abzufangen und den event zu verhindern (unbeabsichtigte Änderung von Zahlen in number-Feldern verhindern)
 *
 */

(function($) {

var types = ['DOMMouseScroll', 'mousewheel'];

if ($.event.fixHooks) {
	for ( var i=types.length; i; ) {
		$.event.fixHooks[ types[--i] ] = $.event.mouseHooks;
	}
}

$.event.special.mousewheel = {
	setup: function() {
		if ( this.addEventListener ) {
			for ( var i=types.length; i; ) {
				this.addEventListener( types[--i], handler, false );
			}
		} else {
			this.onmousewheel = handler;
		}
	},
	
	teardown: function() {
		if ( this.removeEventListener ) {
			for ( var i=types.length; i; ) {
				this.removeEventListener( types[--i], handler, false );
			}
		} else {
			this.onmousewheel = null;
		}
	}
};

$.fn.extend({
	mousewheel: function(fn) {
		return fn ? this.bind("mousewheel", fn) : this.trigger("mousewheel");
	},
	
	unmousewheel: function(fn) {
		return this.unbind("mousewheel", fn);
	}
});


function handler(event) {
	var orgEvent = event || window.event, args = [].slice.call( arguments, 1 ), delta = 0, returnValue = true, deltaX = 0, deltaY = 0;
	event = $.event.fix(orgEvent);
	event.type = "mousewheel";
	
	// Old school scrollwheel delta
	if ( orgEvent.wheelDelta ) { delta = orgEvent.wheelDelta/120; }
	if ( orgEvent.detail	 ) { delta = -orgEvent.detail/3; }
	
	// New school multidimensional scroll (touchpads) deltas
	deltaY = delta;
	
	// Gecko
	if ( orgEvent.axis !== undefined && orgEvent.axis === orgEvent.HORIZONTAL_AXIS ) {
		deltaY = 0;
		deltaX = -1*delta;
	}
	
	// Webkit
	if ( orgEvent.wheelDeltaY !== undefined ) { deltaY = orgEvent.wheelDeltaY/120; }
	if ( orgEvent.wheelDeltaX !== undefined ) { deltaX = -1*orgEvent.wheelDeltaX/120; }
	
	// Add event and delta to the front of the arguments
	args.unshift(event, delta, deltaX, deltaY);
	
	return ($.event.dispatch || $.event.handle).apply(this, args);
}

})(jQuery);

window.apf.öffneUri = function() {
	'use strict';
	var uri = new Uri($(location).attr('href')),
		anchor = uri.anchor() || null,
		ap_id = uri.getQueryParamValue('ap');
	if (ap_id) {
		// globale Variablen setzen
		window.apf.setzeWindowAp(ap_id);
		// Dem Feld im Formular den Wert zuweisen
		$("#ap_waehlen").val(ap_id);
		if (uri.getQueryParamValue('tpop')) {
			// globale Variablen setzen
			window.apf.setzeWindowPop(uri.getQueryParamValue('pop'));
			window.apf.setzeWindowTpop(uri.getQueryParamValue('tpop'));
			var tpopfeldkontr_id = uri.getQueryParamValue('tpopfeldkontr');
			if (tpopfeldkontr_id) {
				// globale Variablen setzen
				window.apf.setzeWindowTpopfeldkontr(tpopfeldkontr_id);
				// markieren, dass nach dem loaded-event im Tree die TPopkontr angezeigt werden soll 
				// Die Markierung wird im load-Event wieder entfernt
				window.apf.tpopfeldkontr_zeigen = true;
				// direkt initiieren, nicht erst, wenn baum fertig aufgebaut ist
				window.apf.initiiere_tpopfeldkontr();
			} else if (uri.getQueryParamValue('tpopfreiwkontr')) {
				// globale Variablen setzen
				window.apf.setzeWindowTpopfeldkontr(uri.getQueryParamValue('tpopfreiwkontr'));
				// markieren, dass nach dem loaded-event im Tree die TPopkontr angezeigt werden soll 
				// Die Markierung wird im load-Event wieder entfernt
				window.apf.tpopfreiwkontr_zeigen = true;
				// direkt initiieren, nicht erst, wenn baum fertig aufgebaut ist
				localStorage.tpopfreiwkontr = true;
				window.apf.initiiere_tpopfeldkontr();
			} else if (uri.getQueryParamValue('tpopmassn')) {
				// globale Variablen setzen
				window.apf.setzeWindowTpopmassn(uri.getQueryParamValue('tpopmassn'));
				// markieren, dass nach dem loaded-event im Tree die TPopkontr angezeigt werden soll 
				// Die Markierung wird im load-Event wieder entfernt
				window.apf.tpopmassn_zeigen = true;
				// direkt initiieren, nicht erst, wenn baum fertig aufgebaut ist
				window.apf.initiiere_tpopmassn();
			} else if (uri.getQueryParamValue('tpopber')) {
				// globale Variablen setzen
				window.apf.setzeWindowTpopber(uri.getQueryParamValue('tpopber'));
				// markieren, dass nach dem loaded-event im Tree die tpopber angezeigt werden soll 
				// Die Markierung wird im load-Event wieder entfernt
				window.apf.tpopber_zeigen = true;
				// direkt initiieren, nicht erst, wenn baum fertig aufgebaut ist
				window.apf.initiiereTpopber();
			} else if (uri.getQueryParamValue('beob_zugeordnet')) {
				// markieren, dass nach dem loaded-event im Tree die beob_zugeordnet angezeigt werden soll 
				// Die Markierung wird im load-Event wieder entfernt
				window.apf.beob_zugeordnet_zeigen = true;
				// direkt initiieren, nicht erst, wenn baum fertig aufgebaut ist
				/*ausgeschaltet - funktioniert nicht! vermutlich, weil tree.php und beob_distzutpop sich in quere kommen
				// herausfinden, ob beobtyp infospezies oder evab ist
				localStorage.beob_id = uri.getQueryParamValue('beob_zugeordnet');
				if (isNaN(uri.getQueryParamValue('beob_zugeordnet'))) {
					// evab
					localStorage.beobtyp = "evab";
					window.apf.initiiere_beob("evab", localStorage.beob_id, "zugeordnet");
				} else {
					localStorage.beobtyp = "infospezies";
					window.apf.initiiere_beob("infospezies", localStorage.beob_id, "zugeordnet");
				}*/
			} else if (uri.getQueryParamValue('tpopmassnber')) {
				// globale Variablen setzen
				window.apf.setzeWindowTpopmassnber(uri.getQueryParamValue('tpopmassnber'));
				// markieren, dass nach dem loaded-event im Tree die tpopmassnber angezeigt werden soll 
				// Die Markierung wird im load-Event wieder entfernt
				window.apf.tpopmassnber_zeigen = true;
				// direkt initiieren, nicht erst, wenn baum fertig aufgebaut ist
				window.apf.initiiere_tpopmassnber();
			} else {
				// muss tpop sein
				// markieren, dass nach dem loaded-event im Tree die TPop angezeigt werden soll 
				// Die Markierung wird im load-Event wieder entfernt
				window.apf.tpop_zeigen = true;
				// direkt initiieren, nicht erst, wenn baum fertig aufgebaut ist
				window.apf.initiiere_tpop();
			}
		} else if (uri.getQueryParamValue('pop')) {
			// globale Variablen setzen
			window.apf.setzeWindowPop(uri.getQueryParamValue('pop'));
			if (uri.getQueryParamValue('popber')) {
				// globale Variablen setzen
				window.apf.setzeWindowPopber(uri.getQueryParamValue('popber'));
				// markieren, dass nach dem loaded-event im Tree die Pop angezeigt werden soll 
				// Die Markierung wird im load-Event wieder entfernt
				window.apf.popber_zeigen = true;
				// direkt initiieren, nicht erst, wenn baum fertig aufgebaut ist
				window.apf.initiiere_popber();
			} else if (uri.getQueryParamValue('popmassnber')) {
				// globale Variablen setzen
				window.apf.setzeWindowPopmassnber(uri.getQueryParamValue('popmassnber'));
				// markieren, dass nach dem loaded-event im Tree die popmassnber angezeigt werden soll 
				// Die Markierung wird im load-Event wieder entfernt
				window.apf.popmassnber_zeigen = true;
				// direkt initiieren, nicht erst, wenn baum fertig aufgebaut ist
				window.apf.initiiere_popmassnber();
			} else {
				// muss pop sein
				// markieren, dass nach dem loaded-event im Tree die Pop angezeigt werden soll 
				// Die Markierung wird im load-Event wieder entfernt
				window.apf.pop_zeigen = true;
				// direkt initiieren, nicht erst, wenn baum fertig aufgebaut ist
				localStorage.pop_id = uri.getQueryParamValue('pop');
				window.apf.initiiere_pop();
			}
		} else if (uri.getQueryParamValue('apziel')) {
			// globale Variablen setzen
			window.apf.setzeWindowApziel(uri.getQueryParamValue('apziel'));
			if (uri.getQueryParamValue('zielber')) {
				// globale Variablen setzen
				window.apf.setzeWindowZielber(uri.getQueryParamValue('zielber'));
				// markieren, dass nach dem loaded-event im Tree die zielber angezeigt werden soll 
				// Die Markierung wird im load-Event wieder entfernt
				window.apf.zielber_zeigen = true;
				// direkt initiieren, nicht erst, wenn baum fertig aufgebaut ist
				window.apf.initiiere_zielber();
			} else {
				// muss ein apziel sein
				// markieren, dass nach dem loaded-event im Tree die apziel angezeigt werden soll 
				// Die Markierung wird im load-Event wieder entfernt
				window.apf.apziel_zeigen = true;
				// direkt initiieren, nicht erst, wenn baum fertig aufgebaut ist
				localStorage.apziel_id = uri.getQueryParamValue('apziel');
				window.apf.initiiere_apziel();
			}
		} else if (uri.getQueryParamValue('erfkrit')) {
			// globale Variablen setzen
			window.apf.setzeWindowErfkrit(uri.getQueryParamValue('erfkrit'));
			// markieren, dass nach dem loaded-event im Tree die erfkrit angezeigt werden soll 
			// Die Markierung wird im load-Event wieder entfernt
			window.apf.erfkrit_zeigen = true;
		} else if (uri.getQueryParamValue('jber')) {
			// globale Variablen setzen
			window.apf.setzeWindowJber(uri.getQueryParamValue('jber'));
			// markieren, dass nach dem loaded-event im Tree die jber angezeigt werden soll 
			// Die Markierung wird im load-Event wieder entfernt
			window.apf.jber_zeigen = true;
			// direkt initiieren, nicht erst, wenn baum fertig aufgebaut ist
			window.apf.initiiere_jber();
		} else if (uri.getQueryParamValue('jber_uebersicht')) {
			// globale Variablen setzen
			window.apf.setzeWindowJberUebersicht(uri.getQueryParamValue('jber_uebersicht'));
			// markieren, dass nach dem loaded-event im Tree die jber_uebersicht angezeigt werden soll 
			// Die Markierung wird im load-Event wieder entfernt
			window.apf.jber_übersicht_zeigen = true;
			// direkt initiieren, nicht erst, wenn baum fertig aufgebaut ist
			window.apf.initiiere_jber_uebersicht();
		} else if (uri.getQueryParamValue('ber')) {
			// globale Variablen setzen
			window.apf.setzeWindowBer(uri.getQueryParamValue('ber'));
			// markieren, dass nach dem loaded-event im Tree die ber angezeigt werden soll 
			// Die Markierung wird im load-Event wieder entfernt
			window.apf.ber_zeigen = true;
			// direkt initiieren, nicht erst, wenn baum fertig aufgebaut ist
			window.apf.initiiere_ber();
		} else if (uri.getQueryParamValue('idealbiotop')) {
			// globale Variablen setzen
			window.apf.setzeWindowIdealbiotop(uri.getQueryParamValue('idealbiotop'));
			// markieren, dass nach dem loaded-event im Tree die idealbiotop angezeigt werden soll 
			// Die Markierung wird im load-Event wieder entfernt
			window.apf.idealbiotop_zeigen = true;
			// direkt initiieren, nicht erst, wenn baum fertig aufgebaut ist
			window.apf.initiiere_idealbiotop();
		} else if (uri.getQueryParamValue('assozarten')) {
			// globale Variablen setzen
			window.apf.setzeWindowAssozarten(uri.getQueryParamValue('assozarten'));
			// markieren, dass nach dem loaded-event im Tree die assozarten angezeigt werden soll 
			// Die Markierung wird im load-Event wieder entfernt
			window.apf.assozarten_zeigen = true;
			// NICHT direkt initiieren, weil sonst die Artliste noch nicht existiert
		} else if (uri.getQueryParamValue('beob_nicht_beurteilt')) {
			// markieren, dass nach dem loaded-event im Tree die beob angezeigt werden soll 
			// Die Markierung wird im load-Event wieder entfernt
			window.apf.beob_nicht_beurteilt_zeigen = true;
		} else if (uri.getQueryParamValue('beob_nicht_zuzuordnen')) {
			// markieren, dass nach dem loaded-event im Tree die beob angezeigt werden soll 
			// Die Markierung wird im load-Event wieder entfernt
			window.apf.beob_nicht_zuzuordnen_zeigen = true;
		} else {
			// muss ap sein
			// markieren, dass nach dem loaded-event im Tree die Pop angezeigt werden soll 
			// Die Markierung wird im load-Event wieder entfernt
			window.apf.ap_zeigen = true;
			// direkt initiieren, nicht erst, wenn baum fertig aufgebaut ist
			localStorage.ap_id = ap_id;
			window.apf.initiiere_ap();
		}
		window.apf.erstelle_tree(ap_id);
		$("#ap_waehlen_label").hide();
	} else {
		var exporte = uri.getQueryParamValue('exporte');
		if (exporte) {
			window.apf.initiiere_exporte(anchor);
		}
	}
};

window.apf.getInternetExplorerVersion = function() {
	'use strict';
// Returns the version of Internet Explorer or a -1
// (indicating the use of another browser).
  var rv = -1; // Return value assumes failure.
  if (navigator.appName == 'Microsoft Internet Explorer') {
	var ua = navigator.userAgent,
		re  = new RegExp("MSIE ([0-9]{1,}[\.0-9]{0,})");
	if (re.exec(ua) != null)
	  rv = parseFloat(RegExp.$1);
  }
  return rv;
};

window.apf.olmap.createLayersForOlmap = function() {
    'use strict';
    // bing-maps wäre schön
    // ol3 can't reproject raster tiles yet though
    // daher werden die Layer noch nicht angezeigt
    var bing_styles_object = {
            'Aerial': 'Bing Luftbild',
            'AerialWithLabels': 'Bing Luftbild beschriftet',
            'Road': 'Bing Strassenkarte'
        },
        bing_styles = _.keys(bing_styles_object),
        bing_layers = [];
    _.each(bing_styles, function(bing_style) {
        bing_layers.push(new ol.layer.Tile({
            title: bing_styles_object[bing_style],
            kategorie: 'Welt Hintergrund',
            visible: false,
            preload: Infinity,
            source: new ol.source.BingMaps({
                //projection: new ol.proj.EPSG21781(),
                //projection: projection,
                projection: 'EPSG:21781',
                key: 'AjGOtB_ygBplpxXtKiiHtm-GERjSg9TFEoCmuBI_Yz4VWy0unRGUDo9GOZHA46Pf',
                imagerySet: bing_style
            })
        }));
    });

    var ch_ortholuftbild_layer = ga.layer.create('ch.swisstopo.swissimage');
    ch_ortholuftbild_layer.set('title', 'Luftbild CH');
    ch_ortholuftbild_layer.set('visible', false);
    ch_ortholuftbild_layer.set('kategorie', 'Hintergrund');

    var ch_lk_grau_layer = ga.layer.create('ch.swisstopo.pixelkarte-grau');
    ch_lk_grau_layer.set('title', 'Landeskarten CH grau');
    ch_lk_grau_layer.set('visible', false);
    ch_lk_grau_layer.set('kategorie', 'Hintergrund');

    var ch_lk_farbe_layer = ga.layer.create('ch.swisstopo.pixelkarte-farbe');
    ch_lk_farbe_layer.set('title', 'Landeskarten CH farbig');
    ch_lk_farbe_layer.set('visible', true);
    ch_lk_farbe_layer.set('kategorie', 'Hintergrund');

    var ch_siegriedkarte_layer = ga.layer.create('ch.swisstopo.hiks-siegfried');
    ch_siegriedkarte_layer.set('title', 'Siegfriedkarte 1881');
    ch_siegriedkarte_layer.set('visible', false);
    ch_siegriedkarte_layer.set('kategorie', 'Hintergrund');

    var ch_gemeinden_layer = ga.layer.create('ch.swisstopo-vd.geometa-gemeinde');
    ch_gemeinden_layer.set('title', 'Gemeinden');
    ch_gemeinden_layer.set('visible', false);
    ch_gemeinden_layer.set('kategorie', 'CH Sachinformationen');

    var ch_kantone_layer = ga.layer.create('ch.swisstopo.swissboundaries3d-kanton-flaeche.fill');
    ch_kantone_layer.set('title', 'Kantone');
    ch_kantone_layer.set('visible', false);
    ch_kantone_layer.set('crossOrigin', null);
    ch_kantone_layer.set('kategorie', 'CH Sachinformationen');

    var ch_parzellen_layer = ga.layer.create('ch.kantone.cadastralwebmap-farbe');
    ch_parzellen_layer.set('title', 'Parzellen');
    ch_parzellen_layer.set('visible', false);
    ch_kantone_layer.set('crossOrigin', null);
    ch_parzellen_layer.set('kategorie', 'CH Sachinformationen');

    var ch_am_layer = ga.layer.create('ch.bafu.bundesinventare-amphibien');
    ch_am_layer.set('title', 'Amphibien');
    ch_am_layer.set('visible', false);
    ch_am_layer.set('kategorie', 'CH Biotopinventare');

    var ch_am_wander_layer = ga.layer.create('ch.bafu.bundesinventare-amphibien_wanderobjekte');
    ch_am_wander_layer.set('title', 'Amphibien Wanderobjekte');
    ch_am_wander_layer.set('visible', false);
    ch_am_wander_layer.set('kategorie', 'CH Biotopinventare');

    var ch_auen_layer = ga.layer.create('ch.bafu.bundesinventare-auen');
    ch_auen_layer.set('title', 'Auen');
    ch_auen_layer.set('visible', false);
    ch_auen_layer.set('kategorie', 'CH Biotopinventare');

    var ch_fm_layer = ga.layer.create('ch.bafu.bundesinventare-flachmoore');
    ch_fm_layer.set('title', 'Flachmoore');
    ch_fm_layer.set('visible', false);
    ch_fm_layer.set('kategorie', 'CH Biotopinventare');

    var ch_hm_layer = ga.layer.create('ch.bafu.bundesinventare-hochmoore');
    ch_hm_layer.set('title', 'Hochchmoore');
    ch_hm_layer.set('visible', false);
    ch_hm_layer.set('kategorie', 'CH Biotopinventare');

    var ch_tww_layer = ga.layer.create('ch.bafu.bundesinventare-trockenwiesen_trockenweiden');
    ch_tww_layer.set('title', 'Trockenwiesen und -weiden');
    ch_tww_layer.set('visible', false);
    ch_tww_layer.set('kategorie', 'CH Biotopinventare');

    var ch_vogelreservate_layer = ga.layer.create('ch.bafu.bundesinventare-vogelreservate');
    ch_vogelreservate_layer.set('title', 'Vogelreservate');
    ch_vogelreservate_layer.set('visible', false);
    ch_vogelreservate_layer.set('kategorie', 'CH Biotopinventare');

    var detailpläne_layer_source = new ol.source.GeoJSON({
        url: 'geojson/detailplaene.geojson'/*,
         myTyp: 'Detailplan'*/	// funktioniert nicht
    });
    /* funktioniert nicht:
     detailpläne_layer_source.forEachFeature(function(feature) {
     feature.setValues('myTyp', 'Detailplan');
     });*/

    var detailpläne_layer = new ol.layer.Vector({
        title: 'Detailpläne',
        opacity: 1,
        visible: false,
        kategorie: 'AP Flora',
        selectable: true,
        source: detailpläne_layer_source,
        style: window.apf.olmap.detailplanStyle()
    });

    // ausgeschaltet, da es nicht funktioniert (authorization required)
    var zh_av_layer = new ol.layer.Tile({
        title: 'Amtliche Vermessung',
        visible: false,
        kategorie: 'ZH Sachinformationen',
        source: new ol.source.TileWMS({
            url: '//agabriel:4zC6MgjM@wms.zh.ch/avwms',
            //url: '//wms.zh.ch/avwms',
            crossOrigin: null,
            params: {
                'layers': 'liegenschaften'
            }
        })
    });

    // OL3 hat noch Probleme und bereinigt die Methoden für WFS - zuwarten
    var zh_kartierungen_layer_source = new ol.source.ServerVector({
    	//format: new ol.format.GeoJSON(),	// holt nicht mal die Daten
    	format: new ol.format.WFS({	// holt die Daten - sollte aber bald die Attrribute nicht mehr benötigen
    		featureNS: '//maps.zh.ch',
    		featureType: 'polygon'
    	}),
    	//format: new ol.format.GML(),
    	loader: function(extent, resolution, projection) {
			$.ajax({
				type: GET,
				url: '//maps.zh.ch/wfs/FnsNSWFS',
				data: {
					SERVICE: 'WFS',
					VERSION: '1.0.0',
					REQUEST: 'GetFeature',
					TYPENAME: 'lrm_veg',
					SRSNAME: 'EPSG:21781',
					bbox: extent.join(',') + ',EPSG:21781'
				},
				dataType: 'jsonp',
				jsonpCallback: 'load_zh_kartierungen_layer_source'
			});
    	},
		strategy: ol.loadingstrategy.createTile(new ol.tilegrid.XYZ({
			maxZoom: 19
		})),
		projection: 'EPSG:21781'
    });

    var load_zh_kartierungen_layer_source = function(response) {
    	//console.log('response', response);
	  	zh_kartierungen_layer_source.addFeatures(zh_kartierungen_layer_source.readFeatures(response));	// funktioniert nicht!
	};

    var zh_kartierungen_layer = new ol.layer.Vector({
        title: 'Lebensraum-Kartierungen',
        opacity: 0.7,
        visible: false,
        kategorie: 'ZH Sachinformationen',
        source: zh_kartierungen_layer_source,
        style: new ol.style.Style({
			stroke: new ol.style.Stroke({
				color: 'rgba(0, 0, 255, 1.0)',
				width: 2
			})
		})
    });

    var zh_svo_farbig_layer = new ol.layer.Tile({
        title: 'SVO farbig',
        opacity: 0.7,
        visible: false,
        kategorie: 'ZH Sachinformationen',
        legende: true,
        legende_url: 'http://wms.zh.ch/FnsSVOZHWMS?version=1.3.0&service=WMS&request=GetLegendGraphic&sld_version=1.1.0&layer=zonen-schutzverordnungen&format=image/png&STYLE=default',
        source: new ol.source.TileWMS({
            url: '//wms.zh.ch/FnsSVOZHWMS',
            crossOrigin: null,
            params: {
                'layers': 'zonen-schutzverordnungen,ueberlagernde-schutzzonen,schutzverordnungsobjekte,svo-zonen-labels,schutzverordnungsobjekt-nr'
            }
        })
    });

    var zh_svo_grau_layer = new ol.layer.Tile({
        title: 'SVO schwarz/weiss',
        visible: false,
        kategorie: 'ZH Sachinformationen',
        legende: true,
        legende_url: 'http://wms.zh.ch/FnsSVOZHWMS?version=1.3.0&service=WMS&request=GetLegendGraphic&sld_version=1.1.0&layer=zonen-schutzverordnungen-raster&format=image/png&STYLE=default',
        source: new ol.source.TileWMS({
            url: '//wms.zh.ch/FnsSVOZHWMS',
            crossOrigin: null,
            params: {
                'layers': 'zonen-schutzverordnungen-raster,ueberlagernde-schutzzonen,schutzverordnungsobjekte,svo-zonen-labels,schutzverordnungsobjekt-nr',
                'singleTile': true
            }
        })
    });

    var zh_lichte_wälder_layer = new ol.layer.Tile({
        title: 'Wälder: lichte',
        visible: false,
        kategorie: 'ZH Sachinformationen',
        legende: true,
        legende_url: 'http://wms.zh.ch/FnsLWZHWMS?version=1.3.0&service=WMS&request=GetLegendGraphic&sld_version=1.1.0&layer=objekte-lichte-waelder-kanton-zuerich&format=image/png&STYLE=default',
        source: new ol.source.TileWMS({
            url: '//maps.zh.ch/wms/FnsLWZH',
            crossOrigin: null,
            params: {
                'layers': 'objekte-lichte-waelder-kanton-zuerich',
                'singleTile': true
            }
        })
    });

    // nicht eingeschaltet, da ohne Legende wenig brauchbar
    var zh_waldkartierung_layer = new ol.layer.Tile({
        title: 'Wälder: Vegetation',
        visible: false,
        kategorie: 'ZH Sachinformationen',
        legende: true,
        legende_url: 'http://wms.zh.ch/WaldVKWMS?version=1.3.0&service=WMS&request=GetLegendGraphic&sld_version=1.1.0&layer=waldgesellschaften&format=image/png&STYLE=default',
        source: new ol.source.TileWMS({
            url: '//maps.zh.ch/wms/WaldVKWMS',
            crossOrigin: null,
            params: {
                'layers': 'waldgesellschaften',
                'singleTile': true
            }
        })
    });

    // nicht im Gebrauch
    var zh_gemeinden_layer = new ol.layer.Tile({
        title: 'Kanton',
        visible: false,
        kategorie: 'ZH Sachinformationen',
        source: new ol.source.TileWMS({
            url: '//maps.zh.ch/wms/BASISKARTEZH',
            crossOrigin: null,
            params: {
                'layers': 'grenzen,gemeindegrenzen',
                'singleTile': true
            }
        })
    });

    // error 401 (Authorization required)
    var zh_ortholuftbild_layer_1 = new ol.layer.Tile({
        title: 'Luftbild',
        visible: false,
        kategorie: 'Hintergrund',
        source: new ol.source.TileWMS({
            url: '//agabriel:4zC6MgjM@wms.zh.ch/OrthoZHWMS',
            crossOrigin: null,
            params: {
                'layers': 'orthophotos',
                'singleTile': true
            }
        })
    });

    // error 401 (Authorization required)
    var zh_ortholuftbild_layer = new ol.layer.Tile({
        title: 'Luftbild ZH',
        visible: false,
        kategorie: 'Hintergrund',
        source: new ol.source.TileWMS({
            url: '//maps.zh.ch/wms/OrthoBackgroundZH',
            crossOrigin: null,
            params: {
                'layers': 'orthoaktuell',
                'singleTile': true
            }
        })
    });

    var zh_üp_layer = new ol.layer.Tile({
        title: 'Übersichtsplan ZH',
        visible: false,
        kategorie: 'Hintergrund',
        source: new ol.source.TileWMS({
            url: 'http://wms.zh.ch/upwms',
            crossOrigin: null,
            params: {
                'layers': 'upwms',
                'singleTile': true
            }
        })
    });

    var zh_basiskarten_layer = new ol.layer.Tile({
        title: 'Landeskarten ZH',
        visible: false,
        kategorie: 'Hintergrund',
        source: new ol.source.TileWMS({
            url: '//maps.zh.ch/wms/BASISKARTEZH',
            crossOrigin: null,
            params: {
                'layers': 'wald,seen,lk500,lk200,lk100,lk50,lk25,up8,up24',
                'singleTile': true
            }
        })
    });

    var zh_höhenmodell_layer = new ol.layer.Tile({
        title: 'Höhenmodell ZH',
        visible: false,
        kategorie: 'Hintergrund',
        source: new ol.source.TileWMS({
            url: '//maps.zh.ch/wms/DTMBackgroundZH',
            crossOrigin: null,
            params: {
                'layers': 'dtm',
                'singleTile': true
            }
        })
    });

    // Zunächst alle Layer definieren
    var layers_prov = [
    	zh_höhenmodell_layer,
        zh_ortholuftbild_layer,
        ch_ortholuftbild_layer,
        zh_basiskarten_layer,
        ch_lk_grau_layer,
        ch_lk_farbe_layer,
        ch_siegriedkarte_layer,
        ch_parzellen_layer,
        ch_gemeinden_layer,
        ch_am_layer,
        ch_am_wander_layer,
        ch_auen_layer,
        ch_fm_layer,
        ch_hm_layer,
        ch_tww_layer,
        ch_vogelreservate_layer,
        ch_kantone_layer,
        zh_üp_layer,
        zh_svo_farbig_layer,
        zh_svo_grau_layer,
        //zh_kartierungen_layer,	// warten, das OL3 mit WFS noch nicht funktioniert
        zh_lichte_wälder_layer,
        zh_waldkartierung_layer,
        detailpläne_layer
    ];

    // bing-layers vorne setzen
    // bing-maps wäre schön
    // ol3 can't reproject raster tiles yet though
    // daher werden die Layer noch nicht angezeigt
    //var layers = layers_prov.concat(bing_layers);
    var layers = layers_prov;

    // prüfen, ob in localStorage eigene Layer existieren
    // ausgeschaltet, weil die LayerObjekte von OL3 rekursiv sind und nicht für die localStorage stringified werden können
    if (localStorage.olmap_eigene_ebenen) {
        // drag and drop geo-files
        var defaultStyle = {
            'Point': [new ol.style.Style({
                image: new ol.style.Circle({
                    fill: new ol.style.Fill({
                        color: 'rgba(255,255,0,0.5)'
                    }),
                    radius: 5,
                    stroke: new ol.style.Stroke({
                        color: '#ff0',
                        width: 1
                    })
                })
            })],
            'LineString': [new ol.style.Style({
                stroke: new ol.style.Stroke({
                    color: '#f00',
                    width: 3
                })
            })],
            'Polygon': [new ol.style.Style({
                fill: new ol.style.Fill({
                    color: 'rgba(0,255,255,0.5)'
                }),
                stroke: new ol.style.Stroke({
                    color: '#0ff',
                    width: 1
                })
            })],
            'MultiPoint': [new ol.style.Style({
                image: new ol.style.Circle({
                    fill: new ol.style.Fill({
                        color: 'rgba(255,0,255,0.5)'
                    }),
                    radius: 5,
                    stroke: new ol.style.Stroke({
                        color: '#f0f',
                        width: 1
                    })
                })
            })],
            'MultiLineString': [new ol.style.Style({
                stroke: new ol.style.Stroke({
                    color: '#0f0',
                    width: 3
                })
            })],
            'MultiPolygon': [new ol.style.Style({
                fill: new ol.style.Fill({
                    color: 'rgba(0,0,255,0.5)'
                }),
                stroke: new ol.style.Stroke({
                    color: '#00f',
                    width: 1
                })
            })]
        };
        var styleFunction = function(feature, resolution) {
            var featureStyleFunction = feature.getStyleFunction();
            if (featureStyleFunction) {
                return featureStyleFunction.call(feature, resolution);
            } else {
                return defaultStyle[feature.getGeometry().getType()];
            }
        };
        // diese hinzufügen
        var eigene_ebenen = JSON.parse(localStorage.olmap_eigene_ebenen),
            eigene_ebenen_layers = [];
        _.each(eigene_ebenen, function(ebene) {
            var format = new ol.format.GeoJSON(),
                features = format.readFeatures(ebene);
            //window.eigene_ebenen.push(features);
            var vectorSource = new ol.source.Vector({
                features: features
            });
            var layer = new ol.layer.Vector({
                guid: ebene.guid,
                source: vectorSource,
                style: styleFunction,
                title: ebene.title,
                kategorie: ebene.kategorie
            });
            eigene_ebenen_layers.push(layer);
        });
        layers = layers.concat(eigene_ebenen_layers);
    }

    return layers;
};

// aktualisiert eine Kopie eigener Ebenen in localStorage
// remove: wenn vorhanden, wird die Ebene entfernt
// sonst wird die enthaltene Version durch die aktuelle ersetzt
// geschrieben wird GeoJSON. Grund: Die Layerobjekte sind rekursiv und können daher nicht stringified werden
window.apf.olmap.aktualisiereEbeneInLocalStorage = function(layer, remove) {
    'use strict';
    // mit der guid kontrollieren, ob die Ebene schon existiert
    var guid = layer.get('guid'),
        index_to_remove,
        eigene_ebenen = [];

    if (localStorage.olmap_eigene_ebenen) {
        eigene_ebenen = JSON.parse(localStorage.olmap_eigene_ebenen);
    }

    if (guid) {
    	// den layer entfernen
    	// wenn er nicht entfernt werden soll, wird er im nächsten Schritt mit den aktuellen Daten ersetzt
    	eigene_ebenen = _.reject(eigene_ebenen, function(ebene) {
    		return ebene.guid && ebene.guid === guid;
    	});
        // wenn die Ebene nicht entfernt werden sollte, mit den aktuellen Daten ergänzen
        if (!remove) {
            var format = new ol.format.GeoJSON(),
                data_parsed = format.writeFeatures(layer.getSource().getFeatures());
            // alle zugefügten Eigenschaften anfügen
            data_parsed.title = layer.get('title');
            data_parsed.guid = guid;
            data_parsed.kategorie = layer.get('kategorie');
            eigene_ebenen.push(data_parsed);
        }
        try {
        	// TODO: wenn rueteren.kml importiert wurde erscheint Fehler 'Converting circular structure to JSON'
            localStorage.olmap_eigene_ebenen = JSON.stringify(eigene_ebenen);
        }
        catch (e) {
            console.log('Ebene konnte nicht in localStorage gespeichert werden. Fehlermeldung: ' + e);
            $('#eigene_layer_meldung_' + layer.get('title').replace(" ", "_"))
            	.html('Ebene kann nicht im Cache des Browsers gespeichert werden')
            	.show();
        }
    }
};

window.apf.initiiereOlmap = function() {
	'use strict';
	// Proxy Host for Ajax Requests to overcome Cross-Domain HTTTP Requests
	//OpenLayers.ProxyHost = "../cgi-bin/proxy.cgi?url=";
	//var zh_bbox_1903 = new ol.Extent(669000, 222000, 717000, 284000);

	// allfällige Apflora-Ebenen entfernen
	window.apf.olmap.entferneAlleApfloraLayer();
    // allfällige Modify-Interaktion entfernen
    window.apf.olmap.entferneModifyInteractionFürTpop();

	// Karte nur aufbauen, wenn dies nicht schon passiert ist
	if (!window.apf.olmap.map) {

        window.apf.olmap.map = new ga.Map({
            target: 'ga_karten_div',
            layers: window.apf.olmap.createLayersForOlmap(),
            view: new ol.View2D({
                resolution: 4,
                center: [693000, 253000]
            })
        });

        // diverse features und Fähigkeiten ergänzen
        window.apf.olmap.addDragAndDropGeofiles();
        window.apf.olmap.addShowFeatureInfoOnClick();
        window.apf.olmap.changeCursorOverFeature();
        window.apf.olmap.initiiereLayertree();
        window.apf.olmap.addMousePositionControl();
        window.apf.olmap.addFullScreenControl();

        window.apf.olmap.map.on('change:size', function() {
            // steuern, ob das Export-Tool sichtbar ist
            // wenn es bei hoher Pixelzahl sichtbar ist, gibt es Probleme
            window.apf.olmap.blendeOlmapExportieren();
        });
	}
};

// deaktiviert Messen und Auswählen
window.apf.olmap.deactivateMenuItems = function() {
    // messen deaktivieren
    window.apf.olmap.removeMeasureInteraction();
    // Auswählen deaktivieren
    window.apf.olmap.removeSelectFeaturesInSelectableLayers();
    // allfällige popups schliessen
    window.apf.olmap.entfernePopupOverlays();
    // allfällige tooltips von ga-karten verstecken
    $('div.ga-tooltip').hide();
    // allfällige modify-interaction entfernen
    window.apf.olmap.entferneModifyInteractionFürTpop();
};

window.apf.olmap.removeSelectFeaturesInSelectableLayers = function() {
    'use strict';
    if (window.apf.olmap.map.olmap_select_interaction) {
        window.apf.olmap.map.removeInteraction(window.apf.olmap.map.olmap_select_interaction);
        delete window.apf.olmap.map.olmap_select_interaction;
        window.apf.olmap.removeDragBox();
        $("#ergebnisAuswahl").hide();
    }
};

window.apf.olmap.addSelectFeaturesInSelectableLayers = function() {
    'use strict';
    window.apf.olmap.map.olmap_select_interaction = new ol.interaction.Select({
        // TODO: 'layerFilter' will soon be deprecated > change to 'layers' when deprecated
        layerFilter: function(layer) {
            return layer.get('selectable') === true;
        },
        style: function(feature, resolution) {
            switch(feature.get('myTyp')) {
                case 'pop':
                	return window.apf.olmap.popStyle(feature, resolution, true);
                    break;
                case 'tpop':
                	return window.apf.olmap.tpopStyle(feature, resolution, true);
                    break;
                case 'Detailplan':
                    return window.apf.olmap.detailplanStyleSelected(feature, resolution);
                    break;
            }
        }
        /*,
         // wenn man das feature zum zweiten mal klickt, soll es nicht mehr selected sein
         toggleCondition: function(event) {
         return event === 'click';
         }*/
    });
    window.apf.olmap.map.addInteraction(window.apf.olmap.map.olmap_select_interaction);
    // man soll auch mit dragbox selecten können
    window.apf.olmap.addDragBoxForPopTpop();
};

window.apf.olmap.getSelectedFeatures = function() {
    if (window.apf.olmap.map.olmap_select_interaction) {
        return window.apf.olmap.map.olmap_select_interaction.getFeatures().getArray();
    } else {
        return [];
    }
};

window.apf.olmap.getSelectedFeaturesOfType = function(type) {
    var features_array = window.apf.olmap.getSelectedFeatures(),
        return_array = [],
        feature_type;
    if (features_array.length === 0) {
        return [];
    }
    _.each(features_array, function(feature) {
        feature_type = feature.get('myTyp');
        if (feature_type === type) {
            return_array.push(feature);
        }
    });
    return return_array;
};

window.apf.olmap.removeDragBox = function() {
    'use strict';
    if (window.apf.olmap.drag_box_interaction) {
        window.apf.olmap.map.removeInteraction(window.apf.olmap.drag_box_interaction);
        //window.apf.olmap.drag_box_interaction.off('boxend');
        delete window.apf.olmap.drag_box_interaction;
    }
};

window.apf.olmap.addDragBoxForPopTpop = function() {
    'use strict';
    window.apf.olmap.drag_box_interaction = new ol.interaction.DragBox({
        /* dragbox interaction is active only if alt key is pressed */
        condition: ol.events.condition.altKeyOnly,
        /* style the box */
        style: new ol.style.Style({
            fill: new ol.style.Fill({
                color: 'rgba(255,0,0,0.1)'
            }),
            stroke: new ol.style.Stroke({
                color: [255, 0, 0, 1],
                width: 3
            })
        })
    });
    window.apf.olmap.drag_box_interaction.on('boxend', function(event) {
        var geometry = window.apf.olmap.drag_box_interaction.getGeometry(),
            extent = geometry.getExtent(),
            layers = window.apf.olmap.map.getLayers().getArray(),
            pop_layer_nr = $('#olmap_layertree_Populationen').val(),
            pop_layer = layers[pop_layer_nr],
            tpop_layer_nr = $('#olmap_layertree_Teilpopulationen').val(),
            tpop_layer = layers[tpop_layer_nr],
            pop_layer_source = pop_layer.getSource(),
            tpop_layer_source = tpop_layer.getSource(),
            selected_features = window.apf.olmap.map.olmap_select_interaction.getFeatures().getArray();
        if (pop_layer.get('visible') === true) {
            pop_layer_source.forEachFeatureInExtent(extent, function (feature) {
                selected_features.push(feature);
            });
        }
        if (tpop_layer.get('visible') === true) {
            tpop_layer_source.forEachFeatureInExtent(extent, function (feature) {
                selected_features.push(feature);
            });
        }
        setTimeout(function() {
            window.apf.olmap.prüfeObPopTpopGewähltWurden();
        }, 100);
    });
    window.apf.olmap.map.addInteraction(window.apf.olmap.drag_box_interaction);
};

window.apf.olmap.addShowFeatureInfoOnClick = function() {
    'use strict';
    window.apf.olmap.map.on('singleclick', function(event) {
        var pixel = event.pixel,
            coordinate = event.coordinate;
        // nur machen, wenn nicht selektiert wird
        if (!window.apf.olmap.map.olmap_select_interaction) {
            window.apf.olmap.zeigeFeatureInfo(pixel, coordinate);
        }
        // prüfen, ob pop / tpop gewählt wurden
        // verzögern, weil die neuste selection sonst nicht erfasst wird
        setTimeout(function() {
            window.apf.olmap.prüfeObPopTpopGewähltWurden();
        }, 100);
    });
};

window.apf.olmap.prüfeObPopTpopGewähltWurden = function() {
    var pop_selected = [],
        tpop_selected = [];
    // prüfen, ob pop / tpop gewählt wurden
    pop_selected = window.apf.olmap.getSelectedFeaturesOfType('pop');
    tpop_selected = window.apf.olmap.getSelectedFeaturesOfType('tpop');
    // wenn ja: anzeigen
    if (pop_selected.length > 0 || tpop_selected.length > 0) {
        window.apf.olmap.erstelleListeDerAusgewähltenPopTPop(pop_selected, tpop_selected);
    } else {
        $("#ergebnisAuswahl").hide();
    }
};

window.apf.olmap.changeCursorOverFeature = function() {
    'use strict';
    $(window.apf.olmap.map.getViewport()).on('mousemove', function(e) {
        var pixel = window.apf.olmap.map.getEventPixel(e.originalEvent),
            hit = window.apf.olmap.map.forEachFeatureAtPixel(pixel, function(feature, layer) {
                return true;
            });
        if (hit) {
            $('#ga_karten_div').css('cursor', 'pointer');
        } else {
            $('#ga_karten_div').css('cursor', '');
        }
    });
};

window.apf.olmap.addMousePositionControl = function() {
    'use strict';
    var mousePositionControl = new ol.control.MousePosition({
        //This is the format we want the coordinate in
        //The number argument in createStringXY is the number of decimal places
        coordinateFormat: ol.coordinate.createStringXY(0),
        projection: "EPSG:21781",
        undefinedHTML: '&nbsp;' //what openlayers will use if the map returns undefined for a map coordinate
    });
    window.apf.olmap.map.addControl(mousePositionControl);
};

window.apf.olmap.addFullScreenControl = function() {
    'use strict';
    var myFullScreenControl = new ol.control.FullScreen();
    window.apf.olmap.map.addControl(myFullScreenControl);
    // auf Deutsch beschriften
    $('#ga_karten_div').find('.ol-full-screen').find('span[role="tooltip"]').html('Vollbild wechseln');
};

window.apf.olmap.addDragAndDropGeofiles = function() {
    'use strict';
    // drag and drop geo-files
    var drag_and_drop_defaultStyle = {
        'Point': [new ol.style.Style({
            image: new ol.style.Circle({
                fill: new ol.style.Fill({
                    color: 'rgba(255,255,0,0.5)'
                }),
                radius: 5,
                stroke: new ol.style.Stroke({
                    color: '#ff0',
                    width: 1
                })
            })
        })],
        'LineString': [new ol.style.Style({
            stroke: new ol.style.Stroke({
                color: '#f00',
                width: 3
            })
        })],
        'Polygon': [new ol.style.Style({
            fill: new ol.style.Fill({
                color: 'rgba(0,255,255,0.5)'
            }),
            stroke: new ol.style.Stroke({
                color: '#0ff',
                width: 1
            })
        })],
        'MultiPoint': [new ol.style.Style({
            image: new ol.style.Circle({
                fill: new ol.style.Fill({
                    color: 'rgba(255,0,255,0.5)'
                }),
                radius: 5,
                stroke: new ol.style.Stroke({
                    color: '#f0f',
                    width: 1
                })
            })
        })],
        'MultiLineString': [new ol.style.Style({
            stroke: new ol.style.Stroke({
                color: '#0f0',
                width: 3
            })
        })],
        'MultiPolygon': [new ol.style.Style({
            fill: new ol.style.Fill({
                color: 'rgba(0,0,255,0.5)'
            }),
            stroke: new ol.style.Stroke({
                color: '#00f',
                width: 1
            })
        })]
    };
    var drag_and_drop_styleFunction = function(feature, resolution) {
        var featureStyleFunction = feature.getStyleFunction();
        if (featureStyleFunction) {
            return featureStyleFunction.call(feature, resolution);
        } else {
            return drag_and_drop_defaultStyle[feature.getGeometry().getType()];
        }
    };
    var drag_and_drop_interaction = new ol.interaction.DragAndDrop({
        formatConstructors: [
            ol.format.GPX,
            ol.format.GeoJSON,
            ol.format.IGC,
            ol.format.KML,
            ol.format.TopoJSON
        ]
    });

    window.apf.olmap.map.addInteraction(drag_and_drop_interaction);

    drag_and_drop_interaction.on('addfeatures', function(event) {
        var vectorSource = new ol.source.Vector({
            features: event.features
        });
        var drag_and_drop_layer = new ol.layer.Vector({
        	guid: window.apf.erstelleGuid(),
            source: vectorSource,
            style: drag_and_drop_styleFunction,
            title: 'eigene Ebene',
            kategorie: 'Eigene Ebenen'
        });
        window.apf.olmap.map.addLayer(drag_and_drop_layer);
        var view = window.apf.olmap.map.getView();
        view.fitExtent(vectorSource.getExtent(), /** @type {ol.Size} */ (window.apf.olmap.map.getSize()));
        // layertree aktualisieren
        window.apf.olmap.initiiereLayertree('Eigene Ebenen');
        window.apf.olmap.frageNameFürEbene(drag_and_drop_layer);
    });
};

window.apf.olmap.frageNameFürEbene = function(eigene_ebene) {
    'use strict';
    var name_erfragt = $.Deferred(),
    	$eigene_ebene_name = $('#eigene_ebene_name'),
        $eigene_ebene_name_container = $('#eigene_ebene_name_container');
    // eigene Ebene global speichern, damit der eventhandler darauf zugreifen kann
    window.apf.olmap.eigene_ebene = eigene_ebene;
    $eigene_ebene_name_container
        .dialog({
            title: 'Ebene taufen',
            modal: true,
            position: {
                my: 'center',
                at: 'center',
                of: $('#ga_karten_div')
            },
            buttons: [
                {
                    text: "speichern",
                    click: function() {
                        // umbenennen
                        window.apf.olmap.nenneEbeneUm(eigene_ebene, $eigene_ebene_name.val());
                        // Namen zurücksetzen
                        $eigene_ebene_name.val('');
                        $(this).dialog( "close" );
                        name_erfragt.resolve();
                    }
                },
                {
                    text: "abbrechen",
                    click: function() {
                        $(this).dialog( "close" );
                    }
                }
            ]
        })
        .dialog('open');
    $eigene_ebene_name.on('keyup', function(event) {
        if (event.which == 13 && window.apf.olmap.eigene_ebene) {
            // enter pressed
            // umbenennen
            window.apf.olmap.nenneEbeneUm(window.apf.olmap.eigene_ebene, event.target.value);
            // Namen zurücksetzen
            $eigene_ebene_name.val('');
            $('#eigene_ebene_name_container').dialog( "close" );
            $('#GeoAdminKarte').off('keyup', '#eigene_ebene_name');
            delete window.apf.olmap.eigene_ebene;
            name_erfragt.resolve();
        }
    });
    return name_erfragt.promise();
};

window.apf.olmap.nenneEbeneUm = function(layer, title) {
    'use strict';
    layer.set('title', title);
    window.apf.olmap.initiiereLayertree('Eigene Ebenen');
    // layer in localStorage speichern
    window.apf.olmap.aktualisiereEbeneInLocalStorage(layer);
};

// baut das html für den layertree auf
// Muster:
// <li><input type="checkbox" id="olmap_layertree_Ebene 1"><label for="olmap_layertree_Ebene 1">Ebene 1</label></li><hr>
// active_kategorie: der Bereich dieser Kategorie soll offen sein
window.apf.olmap.initiiereLayertree = function(active_kategorie) {
	'use strict';
    var layertitel,
        visible,
        kategorie,
        //html_welt_hintergrund = '<h3>Welt Hintergrund</h3><div>',
        html_ch_hintergrund = '<h3>Hintergrund</h3><div>',
        html_ch_sachinfos = '<h3>CH Sachinformationen</h3><div>',
        html_ch_biotopinv = '<h3>CH Biotopinventare</h3><div>',
        html_zh_sachinfos = '<h3>ZH Sachinformationen</h3><div>',
        html_apflora = '<h3>ZH AP Flora</h3><div>',
        html_prov,
        html,
        $olmap_layertree_layers = $('#olmap_layertree_layers'),
        $ga_karten_div_accordion = $("#ga_karten_div").find(".accordion"),
        layers = window.apf.olmap.map.getLayers().getArray(),
        html_eigene_layer_text,
        html_eigene_layer = '<hr>',
        eigene_layer_zähler = 0,
        initialize_modify_layer = false,
        active,
        export_layer_select_ids = [],
        legende,
        legende_url,
        initialize_legende = false;

    html_eigene_layer_text = '<h3>Eigene Ebenen</h3>';
    html_eigene_layer_text += '<div>';
    html_eigene_layer_text += '<p>Einfach eine der folgenden Dateitypen auf die Karte ziehen:</p>';
    html_eigene_layer_text += '<ul>';
    html_eigene_layer_text += '<li>GPX</li>';
    html_eigene_layer_text += '<li>GeoJSON</li>';
    html_eigene_layer_text += '<li>IGC</li>';
    html_eigene_layer_text += '<li>KML</li>';
    html_eigene_layer_text += '<li>TopoJSON</li>';
    html_eigene_layer_text += '</ul>';
    html_eigene_layer_text += '<div id="olmap_eigene_ebenen_beta_container">';
    html_eigene_layer_text += '<p style="font-size:10px; line-height:0.9em;">Open Layers 3 ist noch in der Beta-Phase.<br>Daher funktionieren eigene Layer nicht immer fehlerfrei.</p>';
    html_eigene_layer_text += '</div>';
    html_eigene_layer_text += '<div id="olmap_neues_layer_container">';
    html_eigene_layer_text += '<input type="checkbox" class="neues_layer" id="olmap_neues_layer">';
    html_eigene_layer_text += '<label for="olmap_neues_layer" class="neues_layer_label">neue Ebene erstellen</label>';
    html_eigene_layer_text += '</div>';

    // accordion zerstören, damit es neu aufgebaut werden kann
    // um es zu zerstören muss es initiiert sein!
	$ga_karten_div_accordion
		.accordion({collapsible:true, active: false, heightStyle: 'content'})
		.accordion("destroy");

    _.each(layers, function(layer, index) {
        layertitel = layer.get('title') || '(Ebene ohne Titel)';
        visible = layer.get('visible');
        kategorie = layer.get('kategorie');
        legende = layer.get('legende') || false;
        legende_url = layer.get('legende_url') || null;

        if (layertitel !== 'messen') {
	        html_prov = '<li><input type="checkbox" class="olmap_layertree_checkbox" id="olmap_layertree_' + layertitel + '" value="' + index + '"';
	        // sichtbare Layer sollen gecheckt sein
	        if (visible) {
	            html_prov += ' checked="checked"';
	        }
	        html_prov += '>';
	        html_prov += '<label for="olmap_layertree_' + layertitel + '">' + layertitel + '</label>';
            // bei pop und tpop muss style gewählt werden können
            if (layertitel === 'Populationen') {
                html_prov += '<div class="layeroptionen">';
                html_prov += '<label for="layertree_pop_nr" class="layertree_pop_style pop_nr">Nr.</label>';
                html_prov += '<input type="checkbox" id="layertree_pop_nr" class="layertree_pop_style pop_nr" checked="checked"> ';
                html_prov += '<label for="layertree_pop_name" class="layertree_pop_style pop_name">Namen</label>';
                html_prov += '<input type="checkbox" id="layertree_pop_name" class="layertree_pop_style pop_name">';
                html_prov += '</div>';
            }
            if (layertitel === 'Teilpopulationen') {
                html_prov += '<div class="layeroptionen">';
                html_prov += '<label for="layertree_tpop_nr" class="layertree_tpop_style tpop_nr">Nr.</label>';
                html_prov += '<input type="checkbox" id="layertree_tpop_nr" class="layertree_tpop_style tpop_nr" checked="checked"> ';
                html_prov += '<label for="layertree_tpop_name" class="layertree_tpop_style tpop_name">Namen</label>';
                html_prov += '<input type="checkbox" id="layertree_tpop_name" class="layertree_tpop_style tpop_name">';
                html_prov += '</div>';
            }
            if (kategorie === 'Eigene Ebenen') {
                html_prov += '<div class="layeroptionen">';
                html_prov += '<input type="checkbox" class="modify_layer" id="modify_layer_' + layertitel.replace(" ", "_") + '">';
                html_prov += '<label for="modify_layer_' + layertitel.replace(" ", "_") + '" title="Ebene bearbeiten" class="modify_layer_label"></label>';
                html_prov += '<select id="modify_layer_geom_type_' + layertitel.replace(" ", "_") + '" class="modify_layer_geom_type apf_tooltip" title="Neue Objekte zeichnen oder<br>bestehende Objekte auswählen, um sie zu verändern"><option id="modify_layer_geom_type_leerwert" value="leerwert" selected>Objekt auswählen</option><option value="Point">Punkt zeichnen</option><option value="LineString">Linie zeichnen</option><option value="Polygon">Polygon zeichnen</option></select>';
                html_prov += '<div class="non_modify_options">';
                    html_prov += '<select id="export2_layer_geom_type_' + layertitel.replace(" ", "_") + '" class="export_layer_select apf_tooltip" title="Ebene exportieren<br>Wählen Sie ein Format"><option value="leerwert" selected>exportieren</option><option value="GeoJSON">GeoJSON</option><option value="KML">KML</option><option value="GPX">GPX</option></select>';
                html_prov += '<input type="checkbox" class="rename_layer" id="rename_layer_' + layertitel.replace(" ", "_") + '">';
                html_prov += '<label for="rename_layer_' + layertitel.replace(" ", "_") + '" title="Ebene umbenennen" class="rename_layer_label"></label>';
                html_prov += '<input type="checkbox" class="entferne_layer" id="entferne_layer_' + layertitel.replace(" ", "_") + '">';
                html_prov += '<label for="entferne_layer_' + layertitel.replace(" ", "_") + '" title="Ebene entfernen" class="entferne_layer_label"></label>';
                html_prov += '</div>';
                html_prov += '<div id="eigene_layer_meldung_' + layertitel.replace(" ", "_") + '" class="eigene_layer_meldung"></div>';
                html_prov += '</div>';
                initialize_modify_layer = true;
                // diese ids werden gebraucht, um tooltips zu erstellen
                export_layer_select_ids.push('export2_layer_geom_type_' + layertitel.replace(" ", "_"));
            }
            if (legende && legende_url) {
            	// Symbol ergänzen
            	// beim hovern erscheint popup mit Legende
            	html_prov += '<a class="ui-icon ui-icon-info olmap_layertreee_legende" href="' + legende_url + '" target="_blank" title="' + legende_url + '"></a>';
            	initialize_legende = true;
            }
            html_prov += '</li>';
	        html_prov += '<hr>';
	        switch (kategorie) {
                /*case "Welt Hintergrund":
                    html_welt_hintergrund += html_prov;
                    break;*/
	            case "Hintergrund":
	                html_ch_hintergrund += html_prov;
	                break;
	            case "CH Sachinformationen":
	                html_ch_sachinfos += html_prov;
	                break;
	            case "CH Biotopinventare":
	                html_ch_biotopinv += html_prov;
	                break;
	            case "ZH Sachinformationen":
	                html_zh_sachinfos += html_prov;
	                break;
	            case "AP Flora":
	                html_apflora += html_prov;
	                break;
                case "Eigene Ebenen":
                    html_eigene_layer += html_prov;
                    eigene_layer_zähler++;
                    break;
	            default:
                    //html_eigene_layer += html_prov;
                    //eigene_layer_zähler++;
                    break;
	        }
	    }
    });

    // letztes <hr> abschneiden
    // aber nur, wenn layers ergänzt wurden
    // wenn keine Layers ergänzt wurden: Layertitel nicht anzeigen (nur bei html_apflora von Bedeutung)
    //html_welt_hintergrund = html_welt_hintergrund.substring(0, (html_welt_hintergrund.length - 4));
    html_ch_hintergrund = html_ch_hintergrund.substring(0, (html_ch_hintergrund.length - 4));
    html_ch_sachinfos = html_ch_sachinfos.substring(0, (html_ch_sachinfos.length - 4));
    html_ch_biotopinv = html_ch_biotopinv.substring(0, (html_ch_biotopinv.length - 4));
    html_zh_sachinfos = html_zh_sachinfos.substring(0, (html_zh_sachinfos.length - 4));
    if (eigene_layer_zähler > 0) {
        html_eigene_layer = html_eigene_layer.substring(0, (html_eigene_layer.length - 4));
    }
    if (html_apflora !== '<h3>ZH AP Flora</h3><div>') {
    	html_apflora = html_apflora.substring(0, (html_apflora.length - 4));
    } else {
    	html_apflora = '';
    }
    // unteraccordions abschliessen
    //html_welt_hintergrund += '</div>';
    html_ch_hintergrund += '</div>';
    html_ch_sachinfos += '</div>';
    html_ch_biotopinv += '</div>';
    html_zh_sachinfos += '</div>';
    html_apflora += '</div>';
    if (eigene_layer_zähler > 0) {
        html_eigene_layer_text += html_eigene_layer;
    }
    html_eigene_layer_text += '</div>';
    // alles zusammensetzen
    html = /*html_welt_hintergrund + */html_ch_hintergrund + html_ch_sachinfos + html_ch_biotopinv + html_zh_sachinfos + html_apflora + html_eigene_layer_text;
    // und einsetzen
    $olmap_layertree_layers.html(html);
    // erst jetzt initiieren, sonst stimmt die Höhe nicht
    if (active_kategorie) {
        // ohne die erste Aktivierung funktioniert es nicht
        $ga_karten_div_accordion.accordion({
            collapsible: true,
            active: false,
            heightStyle: 'content'
        });
        $ga_karten_div_accordion.accordion({
            collapsible: true,
            active: 0,
            heightStyle: 'content'
        });
        if (active_kategorie === 'Eigene Ebenen') {
            active = 5;
        }
        $('#olmap_layertree_layers').accordion({
            collapsible: true,
            active: active,
            heightStyle: 'content'
        });
    } else {
        $ga_karten_div_accordion.accordion({
            collapsible: true,
            active: false,
            heightStyle: 'content'
        });
    }

    // Maximalgrösse des Layertree begrenzen
    $olmap_layertree_layers.css('max-height', window.apf.berechneOlmapLayertreeMaxhöhe);
    // buttons initiieren
    $('.neues_layer')
        .button({
            icons: {primary: 'ui-icon-plusthick'}
        })
        .button('refresh');
    $('.export_layer_select').selectmenu();
    // jetzt tooltips erstellen
    _.each(export_layer_select_ids, function(id) {
        // give the selectmenu a tooltip
        $('#' + id + '-button').tooltip({
            tooltipClass: "tooltip-styling-hinterlegt",
            items: 'span',
            content: 'Ebene exportieren<br>Wählen Sie ein Format'
        });
    });
    if (initialize_modify_layer) {
        $('.modify_layer')
            .button({
                icons: {primary: 'ui-icon-locked'},
                text: false
            })
            .button('refresh');
        $('.modify_layer_label, .export_layer_select_label, .rename_layer_label, .entferne_layer_label, .apf_tooltip')
            .tooltip({
                tooltipClass: "tooltip-styling-hinterlegt",
                content: function() {
                    return $(this).attr('title');
                }
            });
        $('.rename_layer')
            .button({
                icons: {primary: 'ui-icon-tag'},
                text: false
            })
            .button('refresh');
        $('.entferne_layer')
            .button({
                icons: {primary: 'ui-icon-closethick'},
                text: false
            })
            .button('refresh');
    }
    if (initialize_legende) {
		$(".olmap_layertreee_legende").tooltip({
			tooltipClass: "tooltip_olmap_layertree_legende"
			,position: {
				my: "right top+15"
				,at: "right bottom"
				,collision: "flipfit"
			}
			,content: function() {
				var url = $(this).attr('href');
				return "<img src='" + url + "'>";
			}
		});
		// die tooltips sind beim ersten Öffnen zu weit rechts > nicht sichtbar!
		// darum alle einmal öffnen
		// ab dem zweiten mal liegen sie am richtigen Ort
		$(".olmap_layertreee_legende").each(function() {
			$(this).tooltip('open');
			$(this).tooltip('close');
		});
	}
};

// das ist der Versuch, existierende Formulare als dialog zu öffnen
// braucht die id des Formulars
// und die id des Datensatzes, der anzuzeigen ist
window.apf.öffneFormularAlsPopup = function(formularname, id) {
    var $formularname = $('#' + formularname),
    	title;
	// titel bestimmen
	switch (formularname) {
		case 'pop':
			title = 'Population';
			break;
		case 'tpop':
			title = 'Teilpopulation';
			break;
		case 'beob':
			title = 'Beobachtung';
			break;
		default:
			title = '';
	}
    // id setzen
    localStorage[formularname + '_id'] = id;
    // formular initiieren, ohne anzuzeigen
    if (formularname === 'beob') {
    	window.apf['initiiere_' + formularname]('beob_nicht_beurteilt', id, 'nicht_beurteilt', true);
    } else {
    	window.apf['initiiere_' + formularname](true);
    }
    // dialog öffnen
    $formularname.dialog({
        close: function() {
            $formularname.dialog("destroy");
        },
      	//height: 600,
        width: 600,
        maxHeight: $('#menu').height(),
        resizable: true,
        position: {
        	my: 'left top',
        	at: 'left top',
        	of: $('#menu')
        },
        title: title
    });
    $formularname.dialog("open");
};

window.apf.olmap.detailplanStyle = function(feature, resolution) {
    'use strict';
    return new ol.style.Style({
        fill: new ol.style.Fill({
            color: 'rgba(250, 58, 15, 0.1)'
        }),
        stroke: new ol.style.Stroke({
            color: '#fa3a0f',
            width: 1
        })
    });
};

window.apf.olmap.detailplanStyleSelected = function(feature, resolution) {
    'use strict';
    return new ol.style.Style({
        fill: new ol.style.Fill({
            color: 'rgba(15, 85, 250, 0.1)'
        }),
        stroke: new ol.style.Stroke({
            color: '#0F55FA',
            width: 1
        })
    });
};

// steuert den style von pop
// selected: mit der Maus oder drag_box markierte
window.apf.olmap.popStyle = function(feature, resolution, selected) {
    'use strict';
    
    var icon = 'img/flora_icon_braun.png',
        popid = feature.get('myId'),
	    style,
	    image_style,
        text_inhalt,
        text_style,
        stroke_color = 'white',
	    style_with_text,
	    style_without_text,
        $layertree_pop_nr = $('#layertree_pop_nr');

    // markierte: icon ist orange und Text hat roten Hintergrund
    if (selected) {
        icon = 'img/flora_icon_orange.png';
        stroke_color = 'red';
    }

    image_style = new ol.style.Icon(/** @type {olx.style.IconOptions} */ ({
        anchor: [0.5, 46],
        anchorXUnits: 'fraction',
        anchorYUnits: 'pixels',
        opacity: 1,
        src: icon
    }));

    // text bestimmen, abhängig von der Einstellung im Layertree
    if ($layertree_pop_nr.is(':checked')) {
    	text_inhalt = feature.get('pop_nr');
    } else if ($('#layertree_pop_name').is(':checked')) {
    	text_inhalt = feature.get('pop_name');
    }

    text_style = new ol.style.Text({
        font: 'bold 11px Arial, Verdana, Helvetica, sans-serif',
        text: text_inhalt,
        fill: new ol.style.Fill({
            color: 'black'
        }),
        stroke: new ol.style.Stroke({
            color: stroke_color,
            width: 7
        })
    });

    style_with_text = new ol.style.Style({
        image: image_style,
        text: text_style
    });
    style_without_text = new ol.style.Style({
        image: image_style
    });

    // style bestimmen
    if ($layertree_pop_nr.is(':checked')) {
        style = style_with_text;
    } else if ($('#layertree_pop_name').is(':checked')) {
        style = style_with_text;
    } else {
        style = style_without_text;
    }
    
    return [style];
};

// steuert den style von tpop
// tpopid_markiert: beim Aufbau des Layers werden markierte mitgegeben
// selected: mit der Maus oder drag_box markierte
// verorten: beim Verorten soll das Symbol rot sein
window.apf.olmap.tpopStyle = function(feature, resolution, selected, verorten) {
    'use strict';

    var icon = 'img/flora_icon.png',
        tpopid = feature.get('myId'),
        style,
        image_style,
        text_inhalt,
        text_style,
        stroke_color = 'white',
        style_with_text,
        style_without_text,
        $layertree_tpop_nr = $('#layertree_tpop_nr');

    // markierte: icon ist gelb
    if (selected) {
        icon = 'img/flora_icon_gelb.png';
        stroke_color = 'red';
    }

    if (verorten) {
    	icon = 'img/flora_icon_rot.png';
    }

    image_style = new ol.style.Icon(/** @type {olx.style.IconOptions} */ ({
        anchor: [0.5, 46],
        anchorXUnits: 'fraction',
        anchorYUnits: 'pixels',
        opacity: 1,
        src: icon
    }));

    // text bestimmen, abhängig von der Einstellung im Layertree
    if ($layertree_tpop_nr.is(':checked')) {
        text_inhalt = feature.get('tpop_nr_label');
    } else if ($('#layertree_tpop_name').is(':checked')) {
        text_inhalt = feature.get('tpop_name');
    }

    text_style = new ol.style.Text({
        font: 'bold 11px Arial, Verdana, Helvetica, sans-serif',
        text: text_inhalt,
        fill: new ol.style.Fill({
            color: 'black'
        }),
        stroke: new ol.style.Stroke({
            color: stroke_color,
            width: 7
        })
    });

    style_with_text = new ol.style.Style({
        image: image_style,
        text: text_style
    });
    style_without_text = new ol.style.Style({
        image: image_style
    });

    // style bestimmen
    if ($layertree_tpop_nr.is(':checked')) {
        style = style_with_text;
    } else if ($('#layertree_tpop_name').is(':checked')) {
        style = style_with_text;
    } else {
        style = style_without_text;
    }

    return [style];
};

window.apf.olmap.messe = function(element) {
	'use strict';
    window.apf.olmap.deactivateMenuItems();
	if (element.value === 'line' && element.checked) {
		window.apf.olmap.addMeasureInteraction('LineString');
	} else if (element.value === 'polygon' && element.checked) {
		window.apf.olmap.addMeasureInteraction('Polygon');
	} else {
		window.apf.olmap.removeMeasureInteraction();
	}
};

window.apf.olmap.removeMeasureInteraction = function() {
	window.apf.olmap.entferneLayerNachName('messen');
	window.apf.olmap.map.removeInteraction(window.apf.olmap.drawMeasure);
	delete window.apf.olmap.drawMeasure;
	$("#ergebnisMessung").text("");
	$(window.apf.olmap.map.getViewport()).off('mousemove');
};

// erhält den Typ der Interaktion: 'Polygon' oder 'LineString'
window.apf.olmap.addMeasureInteraction = function(type) {
	// allfällige Resten entfernen
	window.apf.olmap.removeMeasureInteraction();
	// neu aufbauen
	var source = new ol.source.Vector();
	var messen_layer = new ol.layer.Vector({
		title: 'messen',
        source: source,
        style: new ol.style.Style({
            fill: new ol.style.Fill({
                color: 'rgba(255, 255, 255, 0.2)'
            }),
            stroke: new ol.style.Stroke({
                color: 'rgba(255, 0, 0, 1)',
                width: 3,
                lineDash: [2, 2],
                lineCap: 'square'
            }),
            image: new ol.style.Circle({
                radius: 7,
                fill: new ol.style.Fill({
                    color: '#ffcc33'
                })
            })
        })
    });

    window.apf.olmap.map.addLayer(messen_layer);

    // Currently drawed feature
    // @type {ol.Feature}
    var sketch = null;

    // Element for currently drawed feature
    // @type {Element}
    var sketchElement;

    // handle pointer move
    // @param {Event} evt
    var mouseMoveHandler = function(evt) {
        if (sketch) {
            var output,
            	geom = (sketch.getGeometry());
            if (geom instanceof ol.geom.Polygon) {
                output = window.apf.olmap.formatArea(/** @type {ol.geom.Polygon} */ (geom));

            } else if (geom instanceof ol.geom.LineString) {
                output = window.apf.olmap.formatLength( /** @type {ol.geom.LineString} */ (geom));
            }
            sketchElement.innerHTML = output;
        }
    };

    $(window.apf.olmap.map.getViewport()).on('mousemove', mouseMoveHandler);

    window.apf.olmap.drawMeasure = new ol.interaction.Draw({
        source: source,
        type: /** @type {ol.geom.GeometryType} */ (type)
    });
    window.apf.olmap.map.addInteraction(window.apf.olmap.drawMeasure);

    window.apf.olmap.drawMeasure.on('drawstart',
        function(evt) {
            // set sketch
            sketch = evt.feature;
            sketchElement = document.createElement('li');
            var outputList = document.getElementById('ergebnisMessung');
            if (outputList.childNodes) {
                outputList.insertBefore(sketchElement, outputList.firstChild);
            } else {
                outputList.appendChild(sketchElement);
            }
        }, this);

    window.apf.olmap.drawMeasure.on('drawend',
        function(evt) {
            // unset sketch
            sketch = null;
            sketchElement = null;
        }, this);
};

/**
 * format length output
 * @param {ol.geom.LineString} line
 * @return {string}
*/
window.apf.olmap.formatLength = function(line) {
    var length = Math.round(line.getLength() * 100) / 100,
    	output;
    if (length > 100) {
        output = (Math.round(length / 1000 * 100) / 100) + ' km';
    } else {
        output = (Math.round(length * 100) / 100) + ' m';
    }
    return output;
};

/**
 * format length output
 * @param {ol.geom.Polygon} polygon
 * @return {string}
*/
window.apf.olmap.formatArea = function(polygon) {
    var area = polygon.getArea(),
    	output;
    if (area > 10000) {
        output = (Math.round(area / 1000000 * 100) / 100) + ' km<sup>2</sup>';
    } else {
        output = (Math.round(area * 100) / 100) + ' m<sup>2</sup>';
    }
    return output;
};

window.apf.olmap.wähleAus = function() {
    window.apf.olmap.deactivateMenuItems();
    window.apf.olmap.addSelectFeaturesInSelectableLayers();
};

window.apf.olmap.schliesseLayeroptionen = function() {
	'use strict';
    $("#olmap_layertree").accordion("option", "active", false);
};

window.apf.erstelleGemeindeliste = function() {
	'use strict';
	if (!window.apf.gemeinden) {
		var getGemeinden = $.ajax({
			type: 'get',
			url: 'api/gemeinden',
			dataType: 'json'
		});
		getGemeinden.always(function(data) {
			if (data) {
				// Gemeinden bereitstellen
				// Feld mit Daten beliefern
                var gemeinden = _.map(data, function(gemeinde) {
                    if (gemeinde.GmdName) {
                        return gemeinde.GmdName;
                    }
                });
				window.apf.gemeinden = gemeinden;
				// autocomplete-widget für Gemeinden initiieren
				$("#TPopGemeinde").autocomplete({
					source: gemeinden,
					delay: 0,
					// Change-Event wird nicht ausgelöst > hier aufrufen
					change: function(event, ui) {
						window.apf.speichern(event.target);
					}
				});
			}
		});
		getGemeinden.fail(function() {
			//window.apf.melde("Fehler: Die Liste der Gemeinden konnte nicht bereitgestellt werden");
			console.log('Fehler: Die Liste der Gemeinden konnte nicht bereitgestellt werden');
		});
	}
};

window.apf.wähleAp = function(ap_id) {
	'use strict';
	if (ap_id) {
		// einen AP gewählt
		$("#ap_waehlen_label").hide();
		localStorage.ap_id = ap_id;
		if ($("[name='programm_wahl']:checked").attr("id") === "programm_neu") {
			// zuerst einen neuen Datensatz anlegen
			var insertAp = $.ajax({
				type: 'post',
				url: 'php/ap_insert.php',
				dataType: 'json',
				data: {
					"id": localStorage.ap_id,
					"user": sessionStorage.User
				}
			});
			insertAp.always(function() {
				// nachdem ein neues Programm erstellt wurde, soll nicht mehr "neu" zur Wahl stehen, sondern "alle"
				$("#programm_neu").attr("checked", false);
				$("#programm_alle").attr("checked", true);
				$("#programm_wahl").buttonset();
				// Auswahlliste für Programme updaten
				$.when(window.apf.wähleApListe("programm_alle"))
					.then(function() {
						// Strukturbaum updaten
						$.when(window.apf.erstelle_tree(localStorage.ap_id))
							.then(function() {
								// gewählte Art in Auswahlliste anzeigen
								$('#ap_waehlen').val(localStorage.ap_id);
								$('#ap_waehlen option[value =' + localStorage.ap_id + ']').attr('selected', true);
								$("#ApArtId").val(localStorage.ap_id);
								// gewählte Art in Formular anzeigen
								window.apf.initiiere_ap();
							});
				});
			});
			insertAp.fail(function() {
				//window.apf.melde("Fehler: Keine Daten für Programme erhalten");
				console.log('Fehler: Keine Daten für Programme erhalten');
			});
		} else {
			window.apf.erstelle_tree(ap_id);
			$("#ap").show();
			window.apf.initiiere_ap();
		}
	} else {
		// leeren Wert gewählt
		$("#ap_waehlen_label").html("Artförderprogramm wählen:").show();
		$("#tree").hide();
		$("#suchen").hide();
		$("#exportieren_2").hide();
		$("#hilfe").hide();
		$("#ap_loeschen").hide();
		$("#exportieren_1").show();
		$("#ap").hide();
		window.apf.zeigeFormular();
		history.replaceState({ap: "ap"}, "ap", "index.html");
	}
};

window.apf.kopiereKoordinatenInPop = function(x_koord, y_koord) {
	'use strict';
	// prüfen, ob X- und Y-Koordinaten vergeben sind
	if (x_koord > 100000 && y_koord > 100000) {
		// Koordinaten der Pop nachführen
		var update_pop = $.ajax({
			type: 'post',
			url: 'php/pop_update.php',
			dataType: 'json',
			data: {
				"id": localStorage.pop_id,
				"Feld": "PopXKoord",
				"Wert": x_koord,
				"user": sessionStorage.User
			}
		});
		update_pop.always(function() {
			var updatePop_4 = $.ajax({
				type: 'post',
				url: 'php/pop_update.php',
				dataType: 'json',
				data: {
					"id": localStorage.pop_id,
					"Feld": "PopYKoord",
					"Wert": y_koord,
					"user": sessionStorage.User
				}
			});
			updatePop_4.always(function() {
				$("#kopiereKoordinatenInPopRueckmeldung").fadeIn('slow');
				setTimeout(function() {
					$("#kopiereKoordinatenInPopRueckmeldung").fadeOut('slow');
				}, 3000);
			});
			updatePop_4.fail(function() {
				//window.apf.melde("Fehler: Y-Koordinate wurde nicht kopiert (die X-Koordinate offenbar schon)");
				console.log('Fehler: Y-Koordinate wurde nicht kopiert (die X-Koordinate offenbar schon)');
			});
		});
		update_pop.fail(function() {
			//window.apf.melde("Fehler: Koordinaten wurden nicht kopiert");
			console.log('Fehler: Koordinaten wurden nicht kopiert');
		});
	} else {
		// auffordern, die Koordinaten zu vergeben und Speichern abbrechen
		window.apf.melde("Sie müssen zuerst Koordinaten erfassen", "Koordinaten nicht kopiert");
	}
};

window.apf.prüfeAnmeldung = function() {
	'use strict';
    var $anmeldung_name = $("#anmeldung_name").val(),
        $anmeldung_passwort = $("#anmeldung_passwort").val();
	// Leserechte zurücksetzen
	delete sessionStorage.NurLesen;
	if ($anmeldung_name && $anmeldung_passwort) {
		var getAnmeldung = $.ajax({
			type: 'get',
			url: 'api/anmeldung/name=' + $anmeldung_name + '/pwd=' + $anmeldung_passwort,
			dataType: 'json'
		});
		getAnmeldung.always(function(data) {
			if (data && data.length > 0) {
				sessionStorage.User = $anmeldung_name;
				// wenn NurLesen, globale Variable setzen
				if (data[0].NurLesen === -1) {
					sessionStorage.NurLesen = true;
				}
				$("#anmeldung_rueckmeldung")
                    .html("Willkommen " + $anmeldung_name)
                    .addClass("ui-state-highlight");
				setTimeout(function() {
					$("#anmelde_dialog").dialog("close", 2000);
				}, 1000);
			} else {
				$("#anmeldung_rueckmeldung")
                    .html("Anmeldung gescheitert")
                    .addClass("ui-state-highlight");
				setTimeout(function() {
					$("#anmeldung_rueckmeldung").removeClass("ui-state-highlight", 1500);
				}, 500);
			}
		});
		getAnmeldung.fail(function() {
			window.apf.melde("Anmeldung gescheitert", "Oops!");
			//console.log('Anmeldung gescheitert');
		});
	} else {
		$("#anmeldung_rueckmeldung")
            .html("Bitte Name und Passwort ausfüllen")
            .addClass( "ui-state-highlight" );
		setTimeout(function() {
			$("#anmeldung_rueckmeldung").removeClass("ui-state-highlight", 1500);
		}, 500);
	}
};

// erwartet aktuelle Werte für jahr und typ
// erstellt den label für den Baum
window.apf.erstelleLabelFürFeldkontrolle = function(jahr, typ) {
	'use strict';
	if (typeof jahr === "undefined") {
		jahr = "(kein Jahr)";
	}
	if (typeof typ === "undefined") {
		typ = "(kein Typ)";
	}
	return jahr + ": " + typ;
};

// erwartet aktuelle Werte für jahr und beurteilung
// erstellt den label für den Baum
window.apf.erstelleLabelFürMassnahme = function(jahr, beurteilung) {
	'use strict';
	if (typeof jahr === "undefined") {
		jahr = "(kein Jahr)";
	}
	if (typeof beurteilung === "undefined") {
		beurteilung = "(keine Beurteilung)";
	}
	return jahr + ": " + beurteilung;
};

// gibt HTML zurück, mit dem die Informationen über eine Beobachtung dargestellt werden
// erwartet die Daten der Beobachtung
window.apf.erstelleFelderFürBeob = function(data, beobtyp) {
	'use strict';
	// Titel für Beob im Formular erstellen
	var beobtitel = "<h1>Informationen aus ";
	if (beobtyp === "infospezies") {
		beobtitel += "Info Spezies";
	} else {
		beobtitel += "EvAB";
	}
	beobtitel += " (nicht veränderbar)</h1>";
	// Beob-Felder dynamisch aufbauen
	var html_beobfelder = "<table>",
		html_beobfeld,
		nichtAnzuzeigendeFelder = ["NO_ISFS", "ESPECE", "CUSTOM_TEXT_5_", "OBJECTID", "FNS_GISLAYER", "FNS_ISFS", "ID", "FNS_JAHR", "NOM_COMPLET", "FAMILLE"];
	$.each(data, function(index, value) {
		if ((value || value === 0) && nichtAnzuzeigendeFelder.indexOf(index) === -1) {
			// TODO: Zahlen, text und Memofelder unterscheiden
			// TODO: Felder durch externe Funktion erstellen lassen
			// ID: beobfelder_ voranstellen, um Namens-Kollisionen zu vermeiden
			html_beobfeld = '<tr class="fieldcontain"><td class="label" style="padding-bottom:3px;"><label for="beobfelder_';
			html_beobfeld += index;
			html_beobfeld += '">';
			html_beobfeld += index;
			html_beobfeld += ':</label></td><td class="Datenfelder" style="padding-bottom:3px;"><input id="beobfelder_';
			html_beobfeld += index;
			html_beobfeld += '" class="Datenfelder" type="text" readonly="readonly" value="';
			html_beobfeld += value;
			html_beobfeld += '""></td></tr>';
			html_beobfelder += html_beobfeld;
		}
	});
	html_beobfelder += "</table>";
	return beobtitel + html_beobfelder;
};

// in DOM-Objekten sind viele ID's der Name des DOM-Elements vorangestellt, damit die ID eindeutig ist
// ACHTUNG auf die Reihenfolge der Ersatzbefehle. Sonst wird z.B. in 'tpopber' 'popber' ersetzt und es bleibt 't'
window.apf.erstelleIdAusDomAttributId = function(domAttributId) {
	'use strict';
	var returnWert = domAttributId.replace('ap_ordner_pop', '').replace('ap_ordner_apziel', '').replace('ap_ordner_erfkrit', '').replace('ap_ordner_jber', '').replace('ap_ordner_ber', '').replace('ap_ordner_beob_nicht_beurteilt', '').replace('ap_ordner_beob_nicht_zuzuordnen', '').replace('idealbiotop', '').replace('ap_ordner_assozarten', '').replace('tpop_ordner_massnber', '').replace('tpop_ordner_massn', '').replace('tpopmassnber', '').replace('pop_ordner_massnber', '').replace('popmassnber', '').replace('tpop_ordner_feldkontr', '').replace('tpop_ordner_freiwkontr', '').replace('tpop_ordner_tpopber', '').replace('tpopber', '').replace('pop_ordner_popber', '').replace('popber', '').replace('tpop_ordner_beob_zugeordnet', '').replace('beob', '').replace('ber', '');
	if (domAttributId == returnWert && parseInt(returnWert) && parseInt(returnWert) != returnWert) {
		console.log('window.apf.erstelleIdAusDomAttributId meldet: erhalten ' + domAttributId + ', zurückgegeben: ' + returnWert + '. Die Regel in der function muss wohl angepasst werden');
	}
	return returnWert;
};

window.apf.zeigeBeobKoordinatenImGisBrowser = function() {
	'use strict';
	var URL,
        target,
        $beobfelder_FNS_XGIS = $("#beobfelder_FNS_XGIS"),
        $beobfelder_FNS_YGIS = $("#beobfelder_FNS_YGIS"),
        $beobfelder_COORDONNEE_FED_E = $("#beobfelder_COORDONNEE_FED_E"),
        $beobfelder_COORDONNEE_FED_N = $("#beobfelder_COORDONNEE_FED_N"),
        $TPopXKoord = $("#TPopXKoord"),
        $TPopYKoord = $("#TPopYKoord"),
        $PopXKoord = $("#PopXKoord"),
        $PopYKoord = $("#PopYKoord");
	if ($beobfelder_FNS_XGIS.val() && $beobfelder_FNS_YGIS.val()) {
		URL = "//www.maps.zh.ch/?x=" + $beobfelder_FNS_XGIS.val() + "&y=" + $beobfelder_FNS_YGIS.val() + "&scale=3000&markers=ring";
		window.open(URL, target="_blank");
	} else if ($beobfelder_COORDONNEE_FED_E.val() && $beobfelder_COORDONNEE_FED_N.val()) {
		URL = "//www.maps.zh.ch/?x=" + $beobfelder_COORDONNEE_FED_E.val() + "&y=" + $beobfelder_COORDONNEE_FED_N.val() + "&scale=3000&markers=ring";
		window.open(URL, target="_blank");
	} else if ($TPopXKoord.val() && $TPopYKoord.val()) {
		URL = "//www.maps.zh.ch/?x=" + $TPopXKoord.val() + "&y=" + $TPopYKoord.val() + "&scale=3000&markers=ring";
		window.open(URL, target="_blank");
	} else if ($PopXKoord.val() && $PopYKoord.val()) {
		URL = "//www.maps.zh.ch/?x=" + $PopXKoord.val() + "&y=" + $PopYKoord.val() + "&scale=3000&markers=ring";
		window.open(URL, target="_blank");
	} else {
		window.apf.melde("Fehler: Keine Koordinaten zum Anzeigen", "Aktion abgebrochen");
	}
};

// retourniert die Beschriftung für TPop auf Karten
// Wenn TPop mit ihrer Nummer beschriftet sein sollen
// tpop_nr und pop_nr wird übernommen
window.apf.beschrifteTPopMitNrFürKarte = function(pop_nr, tpop_nr) {
	'use strict';
	var tpop_beschriftung;
	pop_nr = pop_nr || "?";
	if (tpop_nr) {
		tpop_beschriftung = pop_nr + "/" + tpop_nr;
	} else {
		tpop_beschriftung = pop_nr + "/?";
	}
	return tpop_beschriftung;
};

//öffnet ein modal und teilt etwas mit
window.apf.melde = function(meldung, title) {
	'use strict';
    var title = title || ' ';
	$("#Meldung")
		.html(meldung)
        .attr('title', title)
		.dialog({
			modal: true,
			buttons: {
				Ok: function() {
					$(this).dialog("close");
				}
			}
		});
};

// zeigt während 25 Sekunden einen Hinweis an und einen Link, mit dem eine Aktion rückgängig gemacht werden kann
// erwartet die Mitteilung, was passiert ist
window.apf.frageObAktionRückgängigGemachtWerdenSoll = function(wasIstPassiert) {
	'use strict';
	// Hinweis zum rückgängig machen anzeigen
	$("#undelete_div").html(wasIstPassiert + " <a href='#' id='undelete'>Rückgängig machen?</a>");
	$(".undelete").show();
	if ($( window ).width() > 1000) {
		$("#forms").css("top", "37px");
	}
	setTimeout(function() {
		$("#undelete_div").html("");
		$(".undelete").hide();
		$("#forms").css("top", "");
	}, 30000);
};


// Baut einen neuen Knoten auf derselben Hierarchiestufe, von welcher der Befehl aufgerufen wurde
window.apf.insertNeuenNodeAufGleicherHierarchiestufe = function(aktiver_node, parent_node, strukturtyp, ds_id, beschriftung) {
	'use strict';
	var NeuerNode;
	// id global verfügbar machen
	localStorage[strukturtyp + "_id"] = ds_id;
	// letzte globale Variable entfernen
	delete window.apf[strukturtyp];
	// neuen Node bauen
	NeuerNode = $.jstree._reference(parent_node).create_node(parent_node, "last", {
		"data": beschriftung,
		"attr": {
			"id": ds_id,
			"typ": strukturtyp
		}
	});
	// allfällige Unterordner anlegen
	if (strukturtyp === "pop") {
		window.apf.insertOrdnerVonPop(NeuerNode, ds_id);
	}
	if (strukturtyp === "tpop") {
		window.apf.insertOrdnerVonTPop(NeuerNode, ds_id);
	}
	if (strukturtyp === "apziel") {
		$.jstree._reference(NeuerNode).create_node(NeuerNode, "last", {
			"data": "0 Ziel-Berichte",
			"attr": {
				"id": ds_id,
				"typ": "zielber_ordner"
			}
		});
	}

	// Parent Node-Beschriftung: Anzahl anpassen
	if (strukturtyp === "apziel") {
		var grandparent_node = $.jstree._reference(parent_node)._get_parent(parent_node);
		// grandparent Node-Beschriftung: Anzahl anpassen
		window.apf.beschrifte_ordner_apziel(grandparent_node);
		// parent Node-Beschriftung: Anzahl anpassen
		// nur, wenn es nicht der Ordner ist, der "neue AP-Ziele" heisst
		if ($.jstree._reference(parent_node).get_text(parent_node) !== "neue AP-Ziele") {
			window.apf.beschrifte_ordner_apzieljahr(parent_node);
		}
	} else {
		// Normalfall
		window.apf["beschrifte_ordner_"+strukturtyp](parent_node);
	}
	
	// node selecten
	$.jstree._reference(aktiver_node).deselect_all();
	$.jstree._reference(NeuerNode).select_node(NeuerNode);
	// Formular initiieren
	if (strukturtyp === "tpopfreiwkontr") {
		// der Initiierung mitteilen, dass es eine Freiwilligenkontrolle ist und keine Feldkontrolle
		localStorage.tpopfreiwkontr = true;
		// Freiwilligen-Kontrollen werden von derselben Funktion initiiert, wie Feldkontrollen
		window.apf["initiiere_tpopfeldkontr"]();
	} else {
		window.apf["initiiere_"+strukturtyp]();
	}
};

// Baut einen neuen Knoten auf der näcshttieferen Hierarchiestufe, als der Befehl aufgerufen wurde
// parent_node wird nur von Strukturtyp apziel benutzt
window.apf.insertNeuenNodeEineHierarchiestufeTiefer = function(aktiver_node, parent_node, strukturtyp, ds_id, beschriftung) {
	'use strict';
	var NeuerNode;
	// id global verfügbar machen
	localStorage[strukturtyp + "_id"] = ds_id;
	// letzte globale Variable entfernen
	delete window.apf[strukturtyp];
	if (strukturtyp === "apziel" && localStorage.apziel_von_ordner_apziel) {
		// localStorage.apziel_von_ordner_apziel sagt: apziel wird vom ordner_apziel aus angelegt > temporären Unterordner anlegen
		var neue_apziele_node = $.jstree._reference(aktiver_node).create_node(aktiver_node, "last", {
			"data": "neue AP-Ziele",
			"attr": {
				"id": window.apf.erstelleIdAusDomAttributId($(aktiver_node).attr("id")),
				"typ": "apzieljahr"
			}
		});
		// darunter neuen Node bauen
		NeuerNode = $.jstree._reference(neue_apziele_node).create_node(neue_apziele_node, "last", {
			"data": beschriftung,
			"attr": {
				"id": ds_id,
				"typ": strukturtyp
			}
		});
		delete localStorage.apziel_von_ordner_apziel;
	} else {
		// Normalfall
		// neuen Node bauen
		NeuerNode = $.jstree._reference(aktiver_node).create_node(aktiver_node, "last", {
			"data": beschriftung,
			"attr": {
				"id": ds_id,
				"typ": strukturtyp
			}
		});
	}
	// allfällige Unterordner anlegen
	if (strukturtyp === "pop") {
		window.apf.insertOrdnerVonPop(NeuerNode, ds_id);
	}
	if (strukturtyp === "tpop") {
		window.apf.insertOrdnerVonTPop(NeuerNode, ds_id);
	}
	if (strukturtyp === "apziel") {
		$.jstree._reference(NeuerNode).create_node(NeuerNode, "last", {
			"data": "0 Ziel-Berichte",
			"attr": {
				"id": ds_id,
				"typ": "zielber_ordner"
			}
		});
		// im create_node-Event von jstree wird Jahr eingefügt und gespeichert
	}
	// Node-Beschriftung: Anzahl anpassen
	if (strukturtyp === "apziel" && localStorage.apziel_von_apzieljahr) {
		// hier ist ein Ordner zwischengeschaltet
		// Parent Node-Beschriftung: Anzahl anpassen, wenns nicht der neue Ordner ist
		if ($.jstree._reference(parent_node).get_text(parent_node) !== "neue AP-Ziele") {
			window.apf.beschrifte_ordner_apziel(parent_node);
		}
		// aktiver Node-Beschriftung: Anzahl anpassen
		window.apf.beschrifte_ordner_apzieljahr(aktiver_node);
		delete localStorage.apziel_von_apzieljahr;
	} else if (strukturtyp !== "jber_uebersicht") {
		window.apf["beschrifte_ordner_"+strukturtyp](aktiver_node);
	}
	// node selecten
	$.jstree._reference(aktiver_node).deselect_all();
	$.jstree._reference(NeuerNode).select_node(NeuerNode);
	// Formular initiieren
	if (strukturtyp === "tpopfreiwkontr") {
		// der Initiierung mitteilen, dass es eine Freiwilligenkontrolle ist und keine Feldkontrolle
		localStorage.tpopfreiwkontr = true;
		// Freiwilligen-Kontrollen werden von derselben Funktion initiiert, wie Feldkontrollen
		window.apf["initiiere_tpopfeldkontr"]();
	} else {
		window.apf["initiiere_"+strukturtyp]();
	}
};

// erstellt alle Unterordner des Ordners vom Typ pop
// erwartet den node des pop-ordners
window.apf.insertOrdnerVonPop = function(pop_node, pop_id) {
	'use strict';
	$.jstree._reference(pop_node).create_node(pop_node, "last", {
		"data": "Teilpopulationen",
		"attr": {
			"id": pop_id,
			"typ": "pop_ordner_tpop"
		}
	});
	$.jstree._reference(pop_node).create_node(pop_node, "last", {
		"data": "Populations-Berichte",
		"attr": {
			"id": pop_id,
			"typ": "pop_ordner_popber"
		}
	});
	$.jstree._reference(pop_node).create_node(pop_node, "last", {
		"data": "Massnahmen-Berichte",
		"attr": {
			"id": pop_id,
			"typ": "pop_ordner_massnber"
		}
	});
};

// erstellt alle Unterordner des Ordners vom Typ tpop
// erwartet den node des tpop-ordners
window.apf.insertOrdnerVonTPop = function(TPopNode, tpop_id) {
	'use strict';
	$.jstree._reference(TPopNode).create_node(TPopNode, "last", {
		"data": "Massnahmen",
		"attr": {
			"id": tpop_id,
			"typ": "tpop_ordner_massn"
		}
	});
	$.jstree._reference(TPopNode).create_node(TPopNode, "last", {
		"data": "Massnahmen-Berichte",
		"attr": {
			"id": tpop_id,
			"typ": "tpop_ordner_massnber"
		}
	});
	$.jstree._reference(TPopNode).create_node(TPopNode, "last", {
		"data": "Feldkontrollen",
		"attr": {
			"id": tpop_id,
			"typ": "tpop_ordner_feldkontr"
		}
	});
	$.jstree._reference(TPopNode).create_node(TPopNode, "last", {
		"data": "Freiwilligen-Kontrollen",
		"attr": {
			"id": tpop_id,
			"typ": "tpop_ordner_freiwkontr"
		}
	});
	$.jstree._reference(TPopNode).create_node(TPopNode, "last", {
		"data": "Teilpopulations-Berichte",
		"attr": {
			"id": tpop_id,
			"typ": "tpop_ordner_tpopber"
		}
	});
	$.jstree._reference(TPopNode).create_node(TPopNode, "last", {
		"data": "Beobachtungen",
		"attr": {
			"id": tpop_id,
			"typ": "tpop_ordner_beob_zugeordnet"
		}
	});
};

window.apf.löscheAp = function(ap_id) {
	'use strict';
	//Variable zum rückgängig machen erstellen
	window.apf.deleted = window.apf;
	window.apf.deleted.typ = "ap";
	//Artname in Textform merken
	window.apf.deleted.Artname = $("#ap_waehlen option[value='" + $("#ap_waehlen").val() + "']").text();
	var deleteAp = $.ajax({
		type: 'post',
		url: 'php/ap_delete.php',
		dataType: 'json',
		data: {
			"id": ap_id
		}
	});
	deleteAp.always(function() {
        var $exportieren_2 = $("#exportieren_2");
		delete localStorage.ap_id;
		delete window.apf.ap;
		delete localStorage.ap;
		$("#programm_neu").attr("checked", false);
		$("#programm_alle").attr("checked", true);
		$("#programm_wahl").buttonset();
		window.apf.erstelle_ap_liste("programm_alle");
		$('#ap_waehlen').val('');
		$("#ap_waehlen_label").html("Artförderprogramm wählen:").show();
		$("#tree").hide();
		$("#suchen").hide();
		$exportieren_2.hide();
		$("#hilfe").hide();
		$("#ap_loeschen").hide();
		$exportieren_2.show();
		$("#ap").hide();
		$("#forms").hide();
		//Hinweis zum rückgängig machen anzeigen
		window.apf.frageObAktionRückgängigGemachtWerdenSoll("Das Programm der Art '" + window.apf.deleted.Artname + "' wurde gelöscht.");
		//Artname wird nicht mehr gebraucht und soll später nicht in Datensatz eingefügt werden
		delete window.apf.deleted.Artname;
		//forms muss eingeblendet sein, weil undelete_div darin ist
		window.apf.zeigeFormular("keines");
	});
	deleteAp.fail(function(data) {
		//window.apf.melde("Fehler: Das Programm wurde nicht gelöscht");
		console.log('Fehler: Das Programm wurde nicht gelöscht');
	});
};

// Stellt einen Datensatz aus window.apf.deleted wieder her
/*
** TODO
** Idee: $.data() auf #undelete nutzen
** in einen Schlüssel "undelete" einen Array von Objekten verstauen
** dann können ALLE Änderungen rückgängig gemacht werden:
** Formular zeigt Inhalt von $("#undelete").data("undelete") an
** jeder Datensatz hat Schaltfläche
** bei Klick: Ja nach Typ der Daten Wiederherstellung starten und Erfolg melden
*/
window.apf.undeleteDatensatz = function() {
	'use strict';
	var tabelle,
		data = {},
		typ,
		id;
	
	if (!window.apf.deleted) {
		window.apf.melde("Wiederherstellung gescheitert", "Fehler");
		return false;
	}
	
	//Artname wurde für die Anzeige in undelete_div gespeichert - entfernen, da kein Feld in Tabelle
	delete window.apf.deleted.Artname;
	
	// tabelle setzen
	typ = window.apf.deleted.typ;
	// typ gehört nicht zum Datensatz > löschen
	delete window.apf.deleted.typ;

	switch (typ) {
		case "ap":
			tabelle = "tblAktionsplan";
			id = window.apf.deleted.ApArtId;
			//Artname wurde für die Anzeige in undelete_div gespeichert - entfernen, da kein Feld in Tabelle
			delete window.apf.deleted.Artname;
			break;
		case "apziel":
			tabelle = "tblZiel";
			id = window.apf.deleted.ZielId;
			break;
		case "zielber":
			tabelle = "tblZielBericht";
			id = window.apf.deleted.ZielBerId;
			break;
		case "erfkrit":
			tabelle = "tblErfKrit";
			id = window.apf.deleted.ErfkritId;
			break;
		case "pop":
			tabelle = "tblPopulation";
			id = window.apf.deleted.PopId;
			break;
		case "popber":
			tabelle = "tblPopBericht";
			id = window.apf.deleted.PopBerId;
			break;
		case "popmassnber":
			tabelle = "tblPopMassnBericht";
			id = window.apf.deleted.PopMassnBerId;
			break;
		case "tpop":
			tabelle = "tblTeilpopulation";
			id = window.apf.deleted.TPopId;
			break;
		case "tpopmassn":
			tabelle = "tblTeilPopMassnahme";
			id = window.apf.deleted.TPopMassnId;
			break;
		case "tpopmassnber":
			tabelle = "tblTeilPopMassnBericht";
			id = window.apf.deleted.TPopMassnBerId;
			break;
		case "tpopber":
			tabelle = "tblTeilPopBericht";
			id = window.apf.deleted.TPopBerId;
			break;
		case "tpopfeldkontr":
		case "tpopfreiwkontr":
			tabelle = "tblTeilPopFeldkontrolle";
			id = window.apf.deleted.TPopKontrId;
			break;
		case "jber":
			tabelle = "tblJBer";
			id = window.apf.deleted.JBerId;
			break;
		case "jber_uebersicht":
			tabelle = "tblJBerUebersicht";
			id = window.apf.deleted.JbuJahr;
			break;
		case "ber":
			tabelle = "tblBer";
			id = window.apf.deleted.BerId;
			break;
		case "assozarten":
			tabelle = "tblAssozArten";
			id = window.apf.deleted.AaId;
			break;
		default:
			window.apf.melde("Wiederherstellung gescheitert", "Fehler");
	}

	// tabelle wird in php benutzt, um zu wissen, in welche Tabelle der Datensatz eingefügt werden soll
	// wird danach aus dem Felderarray entfernt
	data.tabelle = tabelle;

	// window.apf.deleted enthält alle Feldnamen - viele können leer sein
	// daher nur solche mit Werten übernehmen
    _.each(window.apf.deleted, function(feldwert, feldname) {
        if (feldwert) {
            data[feldname] = feldwert;
        }
    });

	// Datensatz hinzufügen
	var insertMultiple = $.ajax({
		type: 'post',
		url: 'php/insert_multiple.php',
		dataType: 'json',
		data: data
	});

	insertMultiple.always(function() {
		$(".undelete").hide();
		$("#forms").css("top", "");
		// ap kann nicht via Strukturbaum gewählt werden
		if (typ === "ap") {
			//Formulare ausblenden
			window.apf.zeigeFormular();
			//neu initiieren, damit die gelöschte Art gewählt werden kann
			window.apf.initiiere_index();
			// TODO: DAS TESTEN
			// Formulare blenden
			window.apf.zeigeFormular("ap");
			history.replaceState({ap: "ap"}, "ap", "index.html?ap=" + id);
		} else {
			//tree neu aufbauen
			$.when(window.apf.erstelle_tree(window.apf.olmap.erstellePopLayer))
				.then(function() {
					$("#tree").jstree("select_node", "[typ='" + typ + "']#" + id);
				});
		}
	});

	insertMultiple.fail(function() {
		//window.apf.melde("Fehler: Wiederherstellung gescheitert");
		console.log('Fehler: Wiederherstellung gescheitert');
	});
};

window.apf.olmap.exportiereKarte = function(event) {
	'use strict';
	var exportPNGElement = document.getElementById('olmap_exportieren');
	if ('download' in exportPNGElement) {
	  	exportPNGElement.addEventListener('click', function(e) {
		    window.apf.olmap.map.once('postcompose', function(event) {
	    		var canvas = event.context.canvas;
	    		exportPNGElement.href = canvas.toDataURL('image/png');
		    });
	    	window.apf.olmap.map.renderSync();
	  	}, false);
        if (!window.apf.olmap.recentlyClicked) {
            // beim ersten mal soll der Event gleich wiederholt werden
            window.apf.olmap.recentlyClicked = true;
            // warten, sonst kommen zwei Downloads
            setTimeout(function() {
                exportPNGElement.click();
            }, 200);
        }
	} else {
		var info = 'Der Download ist nur möglich, wenn Ihr Browser das moderne Download-Attribut unterstützt <a href="http://caniuse.com/#feat=download">(hier eine aktuelle Liste der unterstützenden Browser)</a>';
		window.apf.melde(info, "Export abgebrochen");
	}
};

// damit kann man die verbleibende Anzahl Zeichen, die in einem Feld erfasst werden, anzeigen
// Quelle: https://www.scriptiny.com/2012/09/jquery-input-textarea-limiter/
(function($) {
	$.fn.extend( {
		limiter: function(limit, elem) {
			$(this).on("keyup focus", function() {
				setCount(this, elem);
			});
			function setCount(src, elem) {
				var chars = src.value.length;
				if (chars > limit) {
					src.value = src.value.substr(0, limit);
					chars = limit;
				}
				elem.html( limit - chars );
			}
			setCount($(this)[0], elem);
		}
	});
})(jQuery);

// erstellt einen guid
// Quelle: http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript
window.apf.erstelleGuid = function() {
	'use strict';
	return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
	    var r = Math.random()*16|0, v = c == 'x' ? r : (r&0x3|0x8);
	    return v.toString(16);
	});
};
},{"./modules/configuration":"C:\\Users\\alex\\apflora\\src\\modules\\configuration.js"}],"C:\\Users\\alex\\apflora\\src\\modules\\configuration.js":[function(require,module,exports){
/**
 * Hier werden zentral alle Konfigurationsparameter gesammelt
 */

'use strict';

var config = {}
    , dbPassfile = require('./dbPass')
    ;

config.db = {};
config.db.userName = dbPassfile.user;
config.db.passWord = dbPassfile.pass;

// für alle Formulare auflisten:
// Formularname, Name der entsprechenden Tabelle in der DB, Name der ID dieser Tabelle
// wird benutzt, um mit denselben Abfragen in diesen Tabelle durchzuführen: update, insert, delete
config.forms = {
    ap: {
        tabelleInDb: 'tblAktionsplan',
        idInTabelle: 'ApArtId'
    },
    pop: {
        tabelleInDb: 'tblPopulation',
        idInTabelle: 'PopId'
    },
    tpop: {
        tabelleInDb: 'tblTeilpopulation',
        idInTabelle: 'TPopId'
    },
    tpopfeldkontr: {
        tabelleInDb: 'tblTeilPopFeldkontrolle',
        idInTabelle: 'TPopKontrId'
    },
    tpopmassn: {
        tabelleInDb: 'tblTeilPopMassnahme',
        idInTabelle: 'TPopMassnId'
    },
    apziel: {
        tabelleInDb: 'tblZiel',
        idInTabelle: 'ZielId'
    },
    zielber: {
        tabelleInDb: 'tblZielBericht',
        idInTabelle: 'ZielBerId'
    },
    erfkrit: {
        tabelleInDb: 'tblErfKrit',
        idInTabelle: 'ErfkritId'
    },
    jber: {
        tabelleInDb: 'tblJBer',
        idInTabelle: 'JBerId'
    },
    jber_uebersicht: {
        tabelleInDb: 'tblJBerUebersicht',
        idInTabelle: 'JbuJahr'
    },
    ber: {
        tabelleInDb: 'tblBer',
        idInTabelle: 'BerId'
    },
    idealbiotop: {
        tabelleInDb: 'tblIdealbiotop',
        idInTabelle: 'IbApArtId'
    },
    assozarten: {
        tabelleInDb: 'tblAssozArten',
        idInTabelle: 'AaId'
    },
    popber: {
        tabelleInDb: 'tblPopBericht',
        idInTabelle: 'PopBerId'
    },
    popmassnber: {
        tabelleInDb: 'tblPopMassnBericht',
        idInTabelle: 'PopMassnBerId'
    },
    tpopber: {
        tabelleInDb: 'tblTeilPopBericht',
        idInTabelle: 'TPopBerId'
    },
    tpopmassnber: {
        tabelleInDb: 'tblPopMassnBericht',
        idInTabelle: 'PopMassnBerId'
    },
    beob: {
        tabelleInDb: 'tblBeobZuordnung',
        idInTabelle: 'NO_NOTE'
    }
};

module.exports = config;
},{"./dbPass":"C:\\Users\\alex\\apflora\\src\\modules\\dbPass.json"}],"C:\\Users\\alex\\apflora\\src\\modules\\dbPass.json":[function(require,module,exports){
module.exports={
    "user": "alexande",
    "pass": "y3oYksFsQL49es9x"
}
},{}]},{},["./src/apflora.js"])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcYWxleFxcYXBmbG9yYVxcbm9kZV9tb2R1bGVzXFxicm93c2VyaWZ5XFxub2RlX21vZHVsZXNcXGJyb3dzZXItcGFja1xcX3ByZWx1ZGUuanMiLCIuL3NyYy9hcGZsb3JhLmpzIiwiQzovVXNlcnMvYWxleC9hcGZsb3JhL3NyYy9tb2R1bGVzL2NvbmZpZ3VyYXRpb24uanMiLCJDOi9Vc2Vycy9hbGV4L2FwZmxvcmEvc3JjL21vZHVsZXMvZGJQYXNzLmpzb24iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2o3WUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVGQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvLyBiZW7DtnRpZ3RlIGdsb2JhbGUgVmFyaWFibGVuIGluaXRpYWxpc2llcmVuXHJcbndpbmRvdy5hcGYgPSB3aW5kb3cuYXBmIHx8IHt9O1xyXG53aW5kb3cuYXBmLmdtYXAgPSB3aW5kb3cuYXBmLmdtYXAgfHwge307XHJcbndpbmRvdy5hcGYub2xtYXAgPSB3aW5kb3cuYXBmLm9sbWFwIHx8IHt9O1xyXG5cclxud2luZG93LmFwZi5pbml0aWllcmVfaW5kZXggPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gVmVyc3VjaCwgZGFtaXQgJC5hamF4IGF1Y2ggaW4gSUUgZnVua3Rpb25pZXJ0XHJcblx0Ly8galF1ZXJ5IGjDpG5ndCBhbiBqZWRlIEFuZnJhZ2UgZWluICZfPSB1bmQgWnVmYWhsc3phaGxcclxuXHQvLyBBVVNHRVNDSEFMVEVULCBXRUlMIFRQT1BGRUxES09OVFJfVVBEQVRFX01VTFRJUExFLlBIUCBOSUNIVCBNRUhSIEZVTktUSU9OSUVSVEUgKFVORCBNRUhSPylcclxuXHQvLyQuYWpheFNldHVwKHtjYWNoZTpmYWxzZX0pXHJcblxyXG5cdC8vIGpRdWVyeSB1aSB3aWRnZXRzIGluaXRpaWVyZW5cclxuXHQkKFwiI3Byb2dyYW1tX3dhaGxcIikuYnV0dG9uc2V0KHtcclxuXHRcdGNyZWF0ZTogZnVuY3Rpb24oKSB7XHJcblx0XHRcdC8vIGVyc3QgamV0enQgZWluYmxlbmRlbiwgd2VpbCBzb25zdCBkaWUgbm9ybWFsZW4gY2hlY2tib3hlbiBhdWZibGl0emVuXHJcblx0XHRcdCQoXCIjcHJvZ3JhbW1fd2FobFwiKS5zaG93KCk7XHJcblx0XHR9XHJcblx0fSk7XHJcblx0JChcIiNtZXNzZW5cIikuYnV0dG9uc2V0KCk7XHJcblx0JChcImJ1dHRvblwiKS5idXR0b24oKTtcclxuXHQkKFwiI3Rwb3BmZWxka29udHJfdGFic1wiKS50YWJzKCk7XHJcbiAgICAkKCcuYXBmLXJlc2l6YWJsZScpLnJlc2l6YWJsZSgpO1xyXG5cclxuXHQvLyB0b29sdGlwOiBLbGFzc2UgenV3ZWlzZW4sIGRhbWl0IGdlc3R5bHQgd2VyZGVuIGthbm5cclxuXHQkKFwiI2xhYmVsX29sbWFwX2luZm9zX2FiZnJhZ2VuLCAjbGFiZWxfb2xtYXBfZGlzdGFuel9tZXNzZW4sICNsYWJlbF9vbG1hcF9mbGFlY2hlX21lc3NlbiwgI2xhYmVsX29sbWFwX2F1c3dhZWhsZW4sICNvbG1hcF9leHBvcnRpZXJlbl9kaXYsIC5hcGZfdG9vbHRpcFwiKS50b29sdGlwKHtcclxuXHRcdHRvb2x0aXBDbGFzczogXCJ0b29sdGlwLXN0eWxpbmctaGludGVybGVndFwiLFxyXG5cdFx0Y29udGVudDogZnVuY3Rpb24oKSB7XHJcblx0XHRcdHJldHVybiAkKHRoaXMpLmF0dHIoJ3RpdGxlJyk7XHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG5cdCQoXCIuZXhwb3J0X2Fic2Nobml0dFwiKS50b29sdGlwKHtcclxuXHRcdHRvb2x0aXBDbGFzczogXCJleHBvcnRfYWJzY2huaXR0X3Rvb2x0aXBfY2xhc3NcIixcclxuXHRcdGNvbnRlbnQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRyZXR1cm4gJCh0aGlzKS5hdHRyKCd0aXRsZScpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cclxuXHQkKCcjb2xtYXBfZXhwb3J0aWVyZW4nKS5idXR0b24oe1xyXG5cdFx0aWNvbnM6IHtcclxuXHQgICAgICAgIHByaW1hcnk6IFwidWktaWNvbi1jaXJjbGUtYXJyb3ctc1wiXHJcblx0ICAgIH0sXHJcblx0ICAgIHRleHQ6IGZhbHNlLFxyXG4gICAgICAgIGRpc2FibGVkOiB0cnVlXHJcblx0fSk7XHJcblxyXG5cdC8vIEdlbWVpbmRlbGlzdGUgZXJzdGVsbGVuICh3ZW5uIG7DtnRpZylcclxuXHR3aW5kb3cuYXBmLmVyc3RlbGxlR2VtZWluZGVsaXN0ZSgpO1xyXG5cclxuXHQvLyBEYXR1bXNmZWxkZXI6IFdpZGdldCBpbml0aWllcmVuXHJcblx0dmFyIG1vbmF0ZSA9IFtcIkphbnVhclwiLCBcIkZlYnJ1YXJcIiwgXCJNw6RyelwiLCBcIkFwcmlsXCIsIFwiTWFpXCIsIFwiSnVuaVwiLCBcIkp1bGlcIiwgXCJBdWd1c3RcIiwgXCJTZXB0ZW1iZXJcIiwgXCJPa3RvYmVyXCIsIFwiTm92ZW1iZXJcIiwgXCJEZXplbWJlclwiXSxcclxuICAgICAgICB3b2NoZW50YWdlS3VyeiA9IFtcIlNvXCIsIFwiTW9cIiwgXCJEaVwiLCBcIk1pXCIsIFwiRG9cIiwgXCJGclwiLCBcIlNhXCJdLFxyXG4gICAgICAgIHdvY2hlbnRhZ2VMYW5nID0gW1wiU29ubnRhZ1wiLCBcIk1vbnRhZ1wiLCBcIkRpZW5zdGFnXCIsIFwiTWl0dHdvY2hcIiwgXCJEb25uZXJzdGFnXCIsIFwiRnJlaXRhZ1wiLCBcIlNhbXN0YWdcIl07XHJcblx0JChcIiNUUG9wS29udHJEYXR1bVwiKS5kYXRlcGlja2VyKHsgZGF0ZUZvcm1hdDogXCJkZC5tbS55eVwiLCBhbHRGaWVsZDogXCIjVFBvcEtvbnRySmFoclwiLCBhbHRGb3JtYXQ6IFwieXlcIiwgZGVmYXVsdERhdGU6ICswLCBzaG93T246IFwiYnV0dG9uXCIsIGJ1dHRvbkltYWdlOiBcInN0eWxlL2ltYWdlcy9jYWxlbmRhci5naWZcIiwgYnV0dG9uSW1hZ2VPbmx5OiB0cnVlLCBtb250aE5hbWVzOiBtb25hdGUsIGRheU5hbWVzTWluOiB3b2NoZW50YWdlS3VyeiwgZGF5TmFtZXM6IHdvY2hlbnRhZ2VMYW5nLCBmaXJzdERheTogMSB9KTtcclxuXHQkKFwiI1RQb3BNYXNzbkRhdHVtXCIpLmRhdGVwaWNrZXIoeyBkYXRlRm9ybWF0OiBcImRkLm1tLnl5XCIsIGFsdEZpZWxkOiBcIiNUUG9wTWFzc25KYWhyXCIsIGFsdEZvcm1hdDogXCJ5eVwiLCBkZWZhdWx0RGF0ZTogKzAsIHNob3dPbjogXCJidXR0b25cIiwgYnV0dG9uSW1hZ2U6IFwic3R5bGUvaW1hZ2VzL2NhbGVuZGFyLmdpZlwiLCBidXR0b25JbWFnZU9ubHk6IHRydWUsIG1vbnRoTmFtZXM6IG1vbmF0ZSwgZGF5TmFtZXNNaW46IHdvY2hlbnRhZ2VLdXJ6LCBkYXlOYW1lczogd29jaGVudGFnZUxhbmcsIGZpcnN0RGF5OiAxIH0pO1xyXG5cdCQoXCIjSkJlckRhdHVtLCAjSWJFcnN0ZWxsZGF0dW1cIikuZGF0ZXBpY2tlcih7IGRhdGVGb3JtYXQ6IFwiZGQubW0ueXlcIiwgZGVmYXVsdERhdGU6ICswLCBzaG93T246IFwiYnV0dG9uXCIsIGJ1dHRvbkltYWdlOiBcInN0eWxlL2ltYWdlcy9jYWxlbmRhci5naWZcIiwgYnV0dG9uSW1hZ2VPbmx5OiB0cnVlLCBtb250aE5hbWVzOiBtb25hdGUsIGRheU5hbWVzTWluOiB3b2NoZW50YWdlS3VyeiwgZGF5TmFtZXM6IHdvY2hlbnRhZ2VMYW5nLCBmaXJzdERheTogMSB9KTtcclxuXHJcblx0Ly8gVmFyaWFibGVuIHNldHplbiBmw7xyIEZvcm11bGFyIEZlbGRrb250cm9sbGVuLCBoaWVyIGRhbWl0IG51ciBlaW4gbWFsXHJcblx0d2luZG93LmFwZi5mZWxkbGlzdGVfZmVsZGtvbnRyID0gWydUUG9wS29udHJKYWhyJywgJ1RQb3BLb250ckRhdHVtJywgJ1RQb3BLb250ck1ldGhvZGUxJywgJ1RQb3BLb250ckFuejEnLCAnVFBvcEtvbnRyTWV0aG9kZTInLCAnVFBvcEtvbnRyQW56MicsICdUUG9wS29udHJNZXRob2RlMycsICdUUG9wS29udHJBbnozJywgJ1RQb3BLb250clR4dCcsICdUUG9wS29udHJCZWFyYicsICdUUG9wS29udHJaYWVobGVpbmhlaXQxJywgJ1RQb3BLb250clphZWhsZWluaGVpdDInLCAnVFBvcEtvbnRyWmFlaGxlaW5oZWl0MycsICdUUG9wS29udHJUeXAnLCAnVFBvcEtvbnRySnVuZ3BmbCcsICdUUG9wS29udHJWaXRhbGl0YWV0JywgJ1RQb3BLb250clVlYmVybGViJywgJ1RQb3BLb250ckVudHdpY2tsdW5nJywgJ1RQb3BLb250clVyc2FjaCcsICdUUG9wS29udHJVcnRlaWwnLCAnVFBvcEtvbnRyQWVuZFVtcycsICdUUG9wS29udHJBZW5kS29udHInLCAnVFBvcEtvbnRyR3VpZCcsICdUUG9wS29udHJGbGFlY2hlJywgJ1RQb3BLb250clZlZ1R5cCcsICdUUG9wS29udHJLb25rdXJyZW56JywgJ1RQb3BLb250ck1vb3NzY2hpY2h0JywgJ1RQb3BLb250cktyYXV0c2NoaWNodCcsICdUUG9wS29udHJTdHJhdWNoc2NoaWNodCcsICdUUG9wS29udHJCYXVtc2NoaWNodCcsICdUUG9wS29udHJCb2RlblR5cCcsICdUUG9wS29udHJCb2RlbkthbGtnZWhhbHQnLCAnVFBvcEtvbnRyQm9kZW5EdXJjaGxhZXNzaWdrZWl0JywgJ1RQb3BLb250ckJvZGVuSHVtdXMnLCAnVFBvcEtvbnRyQm9kZW5OYWVocnN0b2ZmZ2VoYWx0JywgJ1RQb3BLb250ckJvZGVuQWJ0cmFnJywgJ1RQb3BLb250cldhc3NlcmhhdXNoYWx0JywgJ1RQb3BLb250ckhhbmRsdW5nc2JlZGFyZicsICdUUG9wS29udHJJZGVhbEJpb3RvcFVlYmVyZWluc3QnLCAnVFBvcEtvbnRyTGViJywgJ1RQb3BLb250ckxlYlVtZyddO1xyXG5cdHdpbmRvdy5hcGYuZmVsZGxpc3RlX2ZyZWl3a29udHIgPSBbJ1RQb3BLb250ckphaHInLCAnVFBvcEtvbnRyRGF0dW0nLCAnVFBvcEtvbnRyTWV0aG9kZTEnLCAnVFBvcEtvbnRyQW56MScsICdUUG9wS29udHJNZXRob2RlMicsICdUUG9wS29udHJBbnoyJywgJ1RQb3BLb250ck1ldGhvZGUzJywgJ1RQb3BLb250ckFuejMnLCAnVFBvcEtvbnRyVHh0JywgJ1RQb3BLb250ckJlYXJiJywgJ1RQb3BLb250clphZWhsZWluaGVpdDEnLCAnVFBvcEtvbnRyWmFlaGxlaW5oZWl0MicsICdUUG9wS29udHJaYWVobGVpbmhlaXQzJywgJ1RQb3BLb250clBsYW4nLCAnVFBvcEtvbnRyVWViRmxhZWNoZScsICdUUG9wS29udHJVZWJQZmwnLCAnVFBvcEtvbnRyTmFCbycsICdUUG9wS29udHJKdW5nUGZsSk4nLCAnVFBvcEtvbnRyVmVnSG9lTWF4JywgJ1RQb3BLb250clZlZ0hvZU1pdCcsICdUUG9wS29udHJHZWZhZWhyZHVuZycsICdUUG9wS29udHJHdWlkJ107XHJcblxyXG5cdC8vIEF1c3dhaGxsaXN0ZW4gYXVmYmF1ZW5cclxuXHQkKFwiI2FwX2xvZXNjaGVuXCIpLmhpZGUoKTtcclxuXHR3aW5kb3cuYXBmLmVyc3RlbGxlX2FydGxpc3RlbigpO1xyXG5cclxuXHQvLyBISUVSIFdJUkQgSU4gRklSRUZPWCBFSU5FIEVORExPU1NDSExBVUZFIEFVU0dFTMOWU1RcclxuXHQkLndoZW4od2luZG93LmFwZi53w6RobGVBcExpc3RlKFwicHJvZ3JhbW1fYWxsZVwiKSlcclxuXHRcdC50aGVuKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHQvLyBmYWxscyBlaW5lIFVudGVyYWRyZXNzZSBhbmdld8OkaGx0IHd1cmRlLCBkaWVzZSDDtmZmbmVuXHJcblx0XHRcdHdpbmRvdy5hcGYuw7ZmZm5lVXJpKCk7XHJcblx0XHR9KTtcclxufTtcclxuXHJcbndpbmRvdy5hcGYuaW5pdGlpZXJlX2FwID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICghbG9jYWxTdG9yYWdlLmFwX2lkKSB7XHJcblx0XHQvLyBlcyBmZWhsZW4gYmVuw7Z0aWd0ZSBEYXRlbiA+IHp1csO8Y2sgenVtIEFuZmFuZ1xyXG5cdFx0Ly8gTElFR1QgSElFUiBERVIgV1VSTSBCRUdSQUJFTj9cclxuXHRcdC8vIEFDSFRVTkcsIERJRVNFIFpFSUxFIFZFUlVSU0FDSFRFIFNUQVJUQUJTVMOcUlpFIElOIEZJUkVGT1ggVU5EIFpUIE9GRkVOQkFSIEFVQ0ggSU4gQ0hST01FLCBEQSBSRUtVUlNJViBJTU1FUiBXSUVERVIgSU5JVElJRVJFX0lOREVYIEFVRkdFUlVGRU4gV1VSREVcclxuXHRcdC8vd2luZG93LmFwZi5pbml0aWllcmVfaW5kZXgoKTtcclxuXHRcdC8vaGlzdG9yeS5yZXBsYWNlU3RhdGUoe2FwOiBcImtlaW5hcFwifSwgXCJrZWluYXBcIiwgXCJpbmRleC5odG1sXCIpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHQvLyBQcm9ncmFtbS1XYWhsIGtvbmZpZ3VyaWVyZW5cclxuXHR2YXIgcHJvZ3JhbW1fd2FobDtcclxuXHRwcm9ncmFtbV93YWhsID0gJChcIltuYW1lPSdwcm9ncmFtbV93YWhsJ106Y2hlY2tlZFwiKS5hdHRyKFwiaWRcIik7XHJcblx0Ly8gRmVsZGVyIHp1csO8Y2tzZXR6ZW5cclxuXHR3aW5kb3cuYXBmLmxlZXJlRmVsZGVyVm9uRm9ybXVsYXIoXCJhcFwiKTtcclxuXHQvLyBXZW5uIGVpbiBhcCBhdXNnZXfDpGhsdCBpc3Q6IFNlaW5lIERhdGVuIGFuemVpZ2VuXHJcblx0aWYgKCQoXCIjYXBfd2FlaGxlblwiKS52YWwoKSAmJiBwcm9ncmFtbV93YWhsICE9PSBcInByb2dyYW1tX25ldVwiKSB7XHJcblx0XHQvLyBEYXRlbiBmw7xyIGRlbiBhcCBhdXMgZGVyIERCIGhvbGVuXHJcblx0XHR2YXIgZ2V0QXAgPSAkLmFqYXgoe1xyXG5cdFx0XHR0eXBlOiAnZ2V0JyxcclxuXHRcdFx0dXJsOiAnYXA9JyArIGxvY2FsU3RvcmFnZS5hcF9pZCxcclxuXHRcdFx0ZGF0YVR5cGU6ICdqc29uJ1xyXG5cdFx0fSk7XHJcblx0XHRnZXRBcC5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHQvLyBSw7xja2dhYmV3ZXJ0IG51bGwgd2lyZCBvZmZlbmJhciBhdWNoIGFscyBzdWNjZXNzIGdld2VydGV0LCBnaWJ0IHdlaXRlciB1bnRlbiBGZWhsZXIsIGFsc28gQXVzZsO8aHJ1bmcgdmVyaGluZGVyblxyXG5cdFx0XHRpZiAoZGF0YSAmJiBkYXRhWzBdKSB7XHJcblx0XHRcdFx0Ly8gYXAgYmVyZWl0c3RlbGxlblxyXG5cdFx0XHRcdHdpbmRvdy5hcGYuYXAgPSBkYXRhWzBdO1xyXG5cdFx0XHRcdC8vIEZlbGRlciBtaXQgRGF0ZW4gYmVsaWVmZXJuXHJcblx0XHRcdFx0JChcIiNBcFN0YXR1c1wiICsgZGF0YVswXS5BcFN0YXR1cykucHJvcChcImNoZWNrZWRcIiwgdHJ1ZSk7XHJcblx0XHRcdFx0JChcIiNBcFVtc2V0enVuZ1wiICsgZGF0YVswXS5BcFVtc2V0enVuZykucHJvcChcImNoZWNrZWRcIiwgdHJ1ZSk7XHJcblx0XHRcdFx0JChcIiNBcEphaHJcIikudmFsKGRhdGFbMF0uQXBKYWhyKTtcclxuXHRcdFx0XHQkKFwiI0FwQXJ0d2VydFwiKS52YWwoZGF0YVswXS5BcEFydHdlcnQpO1xyXG5cdFx0XHRcdCQoXCIjQXJ0bmFtZVwiKS52YWwoZGF0YVswXS5BcnRuYW1lKTtcclxuXHRcdFx0XHQvLyBBcEJlYXJiOiBEYXRlbiBob2xlbiAtIG9kZXIgdm9yaGFuZGVuZSBudXR6ZW5cclxuXHRcdFx0XHRpZiAoIXdpbmRvdy5hcGYuYWRyZXNzZW5faHRtbCkge1xyXG5cdFx0XHRcdFx0dmFyIGdldEFkcmVzc2VuID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ2dldCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ2FwaS9hZHJlc3NlbicsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbidcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Z2V0QWRyZXNzZW4uYWx3YXlzKGZ1bmN0aW9uKGRhdGEyKSB7XHJcblx0XHRcdFx0XHRcdGlmIChkYXRhMikge1xyXG5cdFx0XHRcdFx0XHRcdC8vIEZlbGQgbWl0IERhdGVuIGJlbGllZmVyblxyXG5cdFx0XHRcdFx0XHRcdHZhciBodG1sO1xyXG5cdFx0XHRcdFx0XHRcdGh0bWwgPSBcIjxvcHRpb24+PC9vcHRpb24+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmVhY2goZGF0YTIsIGZ1bmN0aW9uKGFkcmVzc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9IFwiPG9wdGlvbiB2YWx1ZT1cXFwiXCIgKyBhZHJlc3NlLmlkICsgXCJcXFwiPlwiICsgYWRyZXNzZS5BZHJOYW1lICsgXCI8L29wdGlvbj5cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuYWRyZXNzZW5faHRtbCA9IGh0bWw7XHJcblx0XHRcdFx0XHRcdFx0JChcIiNBcEJlYXJiXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmh0bWwoaHRtbClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudmFsKHdpbmRvdy5hcGYuQXBCZWFyYik7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHQkKFwiI0FwQmVhcmJcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmh0bWwod2luZG93LmFwZi5hZHJlc3Nlbl9odG1sKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudmFsKHdpbmRvdy5hcGYuQXBCZWFyYik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdC8vIEZvcm11bGFyZSBibGVuZGVuXHJcblx0XHRcdFx0d2luZG93LmFwZi56ZWlnZUZvcm11bGFyKFwiYXBcIik7XHJcblx0XHRcdFx0aGlzdG9yeS5yZXBsYWNlU3RhdGUoe2FwOiBcImFwXCJ9LCBcImFwXCIsIFwiaW5kZXguaHRtbD9hcD1cIiArIGRhdGEuQXBBcnRJZCk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH0gZWxzZSBpZiAoJChcIiNhcF93YWVobGVuXCIpLnZhbCgpICYmIHByb2dyYW1tX3dhaGwgPT09IFwicHJvZ3JhbW1fbmV1XCIpIHtcclxuXHRcdC8vIEZvcm11bGFyZSBibGVuZGVuXHJcblx0XHR3aW5kb3cuYXBmLnplaWdlRm9ybXVsYXIoXCJhcFwiKTtcclxuXHR9XHJcbn07XHJcblxyXG4vLyBzZXR6dCB3aW5kb3cuYXBmIHVuZCBsb2NhbFN0b3JhZ2UuYXBfaWRcclxuLy8gd2lyZCBiZW7DtnRpZ3QsIHdlbm4gYmVpbSBBcHAtU3RhcnQgZGlyZWt0IGVpbiBkZWVwIGxpbmsgZ2XDtmZmbmV0IHdpcmRcclxud2luZG93LmFwZi5zZXR6ZVdpbmRvd0FwID0gZnVuY3Rpb24oaWQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0bG9jYWxTdG9yYWdlLmFwX2lkID0gaWQ7XHJcblx0dmFyIGdldEFwID0gJC5hamF4KHtcclxuXHRcdHR5cGU6ICdnZXQnLFxyXG5cdFx0dXJsOiAnYXA9JyArIGxvY2FsU3RvcmFnZS5hcF9pZCxcclxuXHRcdGRhdGFUeXBlOiAnanNvbidcclxuXHR9KTtcclxuXHRnZXRBcC5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0Ly8gUsO8Y2tnYWJld2VydCBudWxsIHdpcmQgb2ZmZW5iYXIgYXVjaCBhbHMgc3VjY2VzcyBnZXdlcnRldCwgZ2lidCB3ZWl0ZXIgdW50ZW4gRmVobGVyLCBhbHNvIEF1c2bDvGhydW5nIHZlcmhpbmRlcm5cclxuXHRcdGlmIChkYXRhICYmIGRhdGFbMF0pIHtcclxuXHRcdFx0Ly8gYXAgYmVyZWl0c3RlbGxlblxyXG5cdFx0XHR3aW5kb3cuYXBmLmFwID0gZGF0YVswXTtcclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbndpbmRvdy5hcGYuaG9sZV9hcnRsaXN0ZV9odG1sID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBsaXN0ZV9nZWhvbHQgPSAkLkRlZmVycmVkKCk7XHJcblx0Ly8gd2lyZCBiZW51dHp0IHZvbiBmdW5jdGlvbiB3aW5kb3cuYXBmLmVyc3RlbGxlX2FydGxpc3RlbiB1bmQgd2luZG93LmFwZi5pbml0aWllcmVfdHBvcG1hc3NuXHJcblx0Ly8gYmF1dCBlaW5lIHZvbGxzdMOkbmRpZ2UgQXJ0bGlzdGUgYXVmXHJcblx0aWYgKCF3aW5kb3cuYXBmLmFydGxpc3RlX2h0bWwpIHtcclxuXHRcdHZhciBnZXRBcnRsaXN0ZSA9ICQuYWpheCh7XHJcblx0XHRcdHR5cGU6ICdnZXQnLFxyXG5cdFx0XHR1cmw6ICdhcGkvYXJ0bGlzdGUnLFxyXG5cdFx0XHRkYXRhVHlwZTogJ2pzb24nXHJcblx0XHR9KTtcclxuXHRcdGdldEFydGxpc3RlLmFsd2F5cyhmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdHZhciBodG1sO1xyXG5cdFx0XHRodG1sID0gXCI8b3B0aW9uPjwvb3B0aW9uPlwiO1xyXG4gICAgICAgICAgICBfLmVhY2goZGF0YSwgZnVuY3Rpb24oYXJ0KSB7XHJcbiAgICAgICAgICAgICAgICBodG1sICs9IFwiPG9wdGlvbiB2YWx1ZT1cXFwiXCIgKyBhcnQuVGF4b25vbWllSWQgKyBcIlxcXCI+XCIgKyBhcnQuQXJ0bmFtZSArIFwiPC9vcHRpb24+XCI7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cdFx0XHR3aW5kb3cuYXBmLmFydGxpc3RlX2h0bWwgPSBodG1sO1xyXG5cdFx0XHRsaXN0ZV9nZWhvbHQucmVzb2x2ZSgpO1xyXG5cdFx0fSk7XHJcblx0fSBlbHNlIHtcclxuXHRcdGxpc3RlX2dlaG9sdC5yZXNvbHZlKCk7XHJcblx0fVxyXG5cdHJldHVybiBsaXN0ZV9nZWhvbHQucHJvbWlzZSgpO1xyXG59O1xyXG5cclxuLy8gd2lyZCBiZW51dHp0IHZvbiBGb3JtdWxhciBhcCwgcG9wIHVuZCBUUG9wTWFzc25cclxuLy8gc2V0enQgdm9sbHN0w6RuZGlnZSBBcnRsaXN0ZW4gw65uIFNlbGVjdC1GZWxkZXJcclxud2luZG93LmFwZi5lcnN0ZWxsZV9hcnRsaXN0ZW4gPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGxpc3RlX2Vyc3RlbGx0ID0gJC5EZWZlcnJlZCgpO1xyXG5cdCQud2hlbih3aW5kb3cuYXBmLmhvbGVfYXJ0bGlzdGVfaHRtbCgpKVxyXG5cdFx0LnRoZW4oZnVuY3Rpb24oKSB7XHJcblx0XHRcdCQoXCIjQWFTaXNmTnJcIikuaHRtbCh3aW5kb3cuYXBmLmFydGxpc3RlX2h0bWwpO1xyXG5cdFx0XHQkKFwiI1RQb3BNYXNzbkFuc2llZFdpcnRzcGZsXCIpLmh0bWwod2luZG93LmFwZi5hcnRsaXN0ZV9odG1sKTtcclxuXHRcdFx0bGlzdGVfZXJzdGVsbHQucmVzb2x2ZSgpO1xyXG5cdFx0fSk7XHJcblx0cmV0dXJuIGxpc3RlX2Vyc3RlbGx0LnByb21pc2UoKTtcclxufTtcclxuXHJcbndpbmRvdy5hcGYuaW5pdGlpZXJlX3BvcCA9IGZ1bmN0aW9uKG9obmVfenVfemVpZ2VuKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICghbG9jYWxTdG9yYWdlLnBvcF9pZCkge1xyXG5cdFx0Ly8gZXMgZmVobGVuIGJlbsO2dGlndGUgRGF0ZW4gPiBlaW5lIEViZW5lIGjDtmhlclxyXG5cdFx0d2luZG93LmFwZi5pbml0aWllcmVfYXAoKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblx0Ly8gRmVsZGVyIHp1csO8Y2tzZXR6ZW5cclxuXHR3aW5kb3cuYXBmLmxlZXJlRmVsZGVyVm9uRm9ybXVsYXIoXCJwb3BcIik7XHJcblx0Ly8gRGF0ZW4gZsO8ciBkaWUgcG9wIGF1cyBkZXIgREIgaG9sZW5cclxuXHR2YXIgZ2V0UG9wID0gJC5hamF4KHtcclxuICAgICAgICAgICAgdHlwZTogJ2dldCcsXHJcbiAgICAgICAgICAgIHVybDogJ3BocC9wb3AucGhwJyxcclxuICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgXCJpZFwiOiBsb2NhbFN0b3JhZ2UucG9wX2lkXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KSxcclxuICAgICAgICAkUG9wTmFtZSA9ICQoXCIjUG9wTmFtZVwiKSxcclxuICAgICAgICAkUG9wTnIgPSAkKFwiI1BvcE5yXCIpO1xyXG5cdGdldFBvcC5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0Ly8gUsO8Y2tnYWJld2VydCBudWxsIHdpcmQgb2ZmZW5iYXIgYXVjaCBhbHMgc3VjY2VzcyBnZXdlcnRldCwgZ2lidCB3ZWl0ZXIgdW50ZW4gRmVobGVyLCBhbHNvIEF1c2bDvGhydW5nIHZlcmhpbmRlcm5cclxuXHRcdGlmIChkYXRhKSB7XHJcblx0XHRcdC8vIHBvcCBiZXJlaXRzdGVsbGVuXHJcblx0XHRcdHdpbmRvdy5hcGYucG9wID0gZGF0YTtcclxuXHRcdFx0Ly8gRmVsZGVyIG1pdCBEYXRlbiBiZWxpZWZlcm5cclxuXHRcdFx0JChcIiNQb3BIZXJrdW5mdFwiICsgZGF0YS5Qb3BIZXJrdW5mdCkucHJvcChcImNoZWNrZWRcIiwgdHJ1ZSk7XHJcblx0XHRcdGlmIChkYXRhLlBvcEhlcmt1bmZ0VW5rbGFyID09IDEpIHtcclxuXHRcdFx0XHQkKFwiI1BvcEhlcmt1bmZ0VW5rbGFyXCIpLnByb3AoXCJjaGVja2VkXCIsIHRydWUpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdCQoXCIjUG9wSGVya3VuZnRVbmtsYXJcIikucHJvcChcImNoZWNrZWRcIiwgZmFsc2UpO1xyXG5cdFx0XHR9XHJcblx0XHRcdCQoXCIjUG9wSGVya3VuZnRVbmtsYXJCZWdydWVuZHVuZ1wiKVxyXG4gICAgICAgICAgICAgICAgLnZhbChkYXRhLlBvcEhlcmt1bmZ0VW5rbGFyQmVncnVlbmR1bmcpXHJcbiAgICAgICAgICAgICAgICAubGltaXRlcigyNTUsICQoXCIjUG9wSGVya3VuZnRVbmtsYXJCZWdydWVuZHVuZ19saW1pdFwiKSk7XHJcbiAgICAgICAgICAgICRQb3BOYW1lXHJcbiAgICAgICAgICAgICAgICAudmFsKGRhdGEuUG9wTmFtZSlcclxuICAgICAgICAgICAgICAgIC5saW1pdGVyKDE1MCwgJChcIiNQb3BOYW1lX2xpbWl0XCIpKTtcclxuICAgICAgICAgICAgJFBvcE5yLnZhbChkYXRhLlBvcE5yKTtcclxuXHRcdFx0JChcIiNQb3BCZWthbm50U2VpdFwiKS52YWwoZGF0YS5Qb3BCZWthbm50U2VpdCk7XHJcblx0XHRcdCQoXCIjUG9wWEtvb3JkXCIpLnZhbChkYXRhLlBvcFhLb29yZCk7XHJcblx0XHRcdCQoXCIjUG9wWUtvb3JkXCIpLnZhbChkYXRhLlBvcFlLb29yZCk7XHJcblx0XHRcdC8vIEZvcm11bGFyZSBibGVuZGVuXHJcblx0XHRcdC8vIG51ciwgd2VubiBvaG5lX3p1X3plaWdlbiBuaWNodCB0cnVlIGlzdCAodHJ1ZSwgdW0gaW4gZGlhbG9nIGFuenV6ZWlnZW4pXHJcblx0XHRcdGlmICghb2huZV96dV96ZWlnZW4pIHtcclxuXHRcdFx0XHR3aW5kb3cuYXBmLnplaWdlRm9ybXVsYXIoXCJwb3BcIik7XHJcblx0XHRcdFx0aGlzdG9yeS5yZXBsYWNlU3RhdGUoe3BvcDogXCJwb3BcIn0sIFwicG9wXCIsIFwiaW5kZXguaHRtbD9hcD1cIiArIGxvY2FsU3RvcmFnZS5hcF9pZCArIFwiJnBvcD1cIiArIGxvY2FsU3RvcmFnZS5wb3BfaWQpO1xyXG5cdFx0XHRcdC8vIGJlaSBuZXVlbiBEYXRlbnPDpHR6ZW4gRm9rdXMgc3RldWVyblxyXG5cdFx0XHRcdGlmICghJFBvcE5hbWUudmFsKCkpIHtcclxuXHQgICAgICAgICAgICAgICAgJFBvcE5yLmZvY3VzKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG4vLyBzZXR6dCB3aW5kb3cuYXBmLnBvcCB1bmQgbG9jYWxTdG9yYWdlLnBvcF9pZFxyXG4vLyB3aXJkIGJlbsO2dGlndCwgd2VubiBiZWltIEFwcC1TdGFydCBkaXJla3QgZWluIGRlZXAgbGluayBnZcO2ZmZuZXQgd2lyZFxyXG53aW5kb3cuYXBmLnNldHplV2luZG93UG9wID0gZnVuY3Rpb24oaWQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0bG9jYWxTdG9yYWdlLnBvcF9pZCA9IGlkO1xyXG5cdHZhciBnZXRQb3AgPSAkLmFqYXgoe1xyXG5cdFx0dHlwZTogJ2dldCcsXHJcblx0XHR1cmw6ICdwaHAvcG9wLnBocCcsXHJcblx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0ZGF0YToge1xyXG5cdFx0XHRcImlkXCI6IGxvY2FsU3RvcmFnZS5wb3BfaWRcclxuXHRcdH1cclxuXHR9KTtcclxuXHRnZXRQb3AuYWx3YXlzKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdC8vIFLDvGNrZ2FiZXdlcnQgbnVsbCB3aXJkIG9mZmVuYmFyIGF1Y2ggYWxzIHN1Y2Nlc3MgZ2V3ZXJ0ZXQsIGdpYnQgd2VpdGVyIHVudGVuIEZlaGxlciwgYWxzbyBBdXNmw7xocnVuZyB2ZXJoaW5kZXJuXHJcblx0XHRpZiAoZGF0YSkge1xyXG5cdFx0XHQvLyBwb3AgYmVyZWl0c3RlbGxlblxyXG5cdFx0XHR3aW5kb3cuYXBmLnBvcCA9IGRhdGE7XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLmluaXRpaWVyZV9hcHppZWwgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0aWYgKCFsb2NhbFN0b3JhZ2UuYXB6aWVsX2lkKSB7XHJcblx0XHQvLyBlcyBmZWhsZW4gYmVuw7Z0aWd0ZSBEYXRlbiA+IGVpbmUgRWJlbmUgaMO2aGVyXHJcblx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV9hcCgpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHR2YXIgYXB6aWVsX2luaXRpaWVydCA9ICQuRGVmZXJyZWQoKSxcclxuICAgICAgICAkWmllbEphaHIgPSAkKFwiI1ppZWxKYWhyXCIpO1xyXG5cdC8vIEZlbGRlciB6dXLDvGNrc2V0emVuXHJcblx0d2luZG93LmFwZi5sZWVyZUZlbGRlclZvbkZvcm11bGFyKFwiYXB6aWVsXCIpO1xyXG5cdC8vIERhdGVuIGbDvHIgZGllIGFwemllbCBhdXMgZGVyIERCIGhvbGVuXHJcblx0dmFyIGdldEFwWmllbCA9ICQuYWpheCh7XHJcblx0XHR0eXBlOiAnZ2V0JyxcclxuXHRcdHVybDogJ3BocC9hcHppZWwucGhwJyxcclxuXHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRkYXRhOiB7XHJcblx0XHRcdFwiaWRcIjogbG9jYWxTdG9yYWdlLmFwemllbF9pZFxyXG5cdFx0fVxyXG5cdH0pO1xyXG5cdGdldEFwWmllbC5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0Ly8gUsO8Y2tnYWJld2VydCBudWxsIHdpcmQgb2ZmZW5iYXIgYXVjaCBhbHMgc3VjY2VzcyBnZXdlcnRldCwgZ2lidCB3ZWl0ZXIgdW50ZW4gRmVobGVyLCBhbHNvIEF1c2bDvGhydW5nIHZlcmhpbmRlcm5cclxuXHRcdGlmIChkYXRhKSB7XHJcblx0XHRcdC8vIGFwemllbCBiZXJlaXRzdGVsbGVuXHJcblx0XHRcdHdpbmRvdy5hcGYuYXB6aWVsID0gZGF0YTtcclxuXHRcdFx0Ly8gRmVsZGVyIG1pdCBEYXRlbiBiZWxpZWZlcm5cclxuICAgICAgICAgICAgJFppZWxKYWhyLnZhbChkYXRhLlppZWxKYWhyKTtcclxuXHRcdFx0JChcIiNaaWVsVHlwXCIgKyBkYXRhLlppZWxUeXApLnByb3AoXCJjaGVja2VkXCIsIHRydWUpO1xyXG5cdFx0XHQkKFwiI1ppZWxCZXplaWNobnVuZ1wiKS52YWwoZGF0YS5aaWVsQmV6ZWljaG51bmcpO1xyXG5cdFx0XHQvLyBGb3JtdWxhcmUgYmxlbmRlblxyXG5cdFx0XHR3aW5kb3cuYXBmLnplaWdlRm9ybXVsYXIoXCJhcHppZWxcIik7XHJcblx0XHRcdGhpc3RvcnkucmVwbGFjZVN0YXRlKHthcHppZWw6IFwiYXB6aWVsXCJ9LCBcImFwemllbFwiLCBcImluZGV4Lmh0bWw/YXA9XCIgKyBsb2NhbFN0b3JhZ2UuYXBfaWQgKyBcIiZhcHppZWw9XCIgKyBsb2NhbFN0b3JhZ2UuYXB6aWVsX2lkKTtcclxuXHRcdFx0Ly8gYmVpIG5ldWVuIERhdGVuc8OkdHplbiBGb2t1cyBzdGV1ZXJuXHJcblx0XHRcdGlmICghJFppZWxKYWhyLnZhbCgpKSB7XHJcbiAgICAgICAgICAgICAgICAkWmllbEphaHIuZm9jdXMoKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRhcHppZWxfaW5pdGlpZXJ0LnJlc29sdmUoKTtcclxuXHRcdH1cclxuXHR9KTtcclxuXHRyZXR1cm4gYXB6aWVsX2luaXRpaWVydC5wcm9taXNlKCk7XHJcbn07XHJcblxyXG4vLyBzZXR6dCB3aW5kb3cuYXBmLmFwemllbCB1bmQgbG9jYWxTdG9yYWdlLmFwemllbF9pZFxyXG4vLyB3aXJkIGJlbsO2dGlndCwgd2VubiBiZWltIEFwcC1TdGFydCBkaXJla3QgZWluIGRlZXAgbGluayBnZcO2ZmZuZXQgd2lyZFxyXG53aW5kb3cuYXBmLnNldHplV2luZG93QXB6aWVsID0gZnVuY3Rpb24oaWQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0bG9jYWxTdG9yYWdlLmFwemllbF9pZCA9IGlkO1xyXG5cdHZhciBnZXRBcHppZWwgPSAkLmFqYXgoe1xyXG5cdFx0dHlwZTogJ2dldCcsXHJcblx0XHR1cmw6ICdwaHAvYXB6aWVsLnBocCcsXHJcblx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0ZGF0YToge1xyXG5cdFx0XHRcImlkXCI6IGxvY2FsU3RvcmFnZS5hcHppZWxfaWRcclxuXHRcdH1cclxuXHR9KTtcclxuXHRnZXRBcHppZWwuYWx3YXlzKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdC8vIFLDvGNrZ2FiZXdlcnQgbnVsbCB3aXJkIG9mZmVuYmFyIGF1Y2ggYWxzIHN1Y2Nlc3MgZ2V3ZXJ0ZXQsIGdpYnQgd2VpdGVyIHVudGVuIEZlaGxlciwgYWxzbyBBdXNmw7xocnVuZyB2ZXJoaW5kZXJuXHJcblx0XHRpZiAoZGF0YSkge1xyXG5cdFx0XHQvLyBhcHppZWwgYmVyZWl0c3RlbGxlblxyXG5cdFx0XHR3aW5kb3cuYXBmLmFwemllbCA9IGRhdGE7XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLmluaXRpaWVyZV96aWVsYmVyID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICghbG9jYWxTdG9yYWdlLnppZWxiZXJfaWQpIHtcclxuXHRcdC8vIGVzIGZlaGxlbiBiZW7DtnRpZ3RlIERhdGVuID4gZWluZSBFYmVuZSBow7ZoZXJcclxuXHRcdHdpbmRvdy5hcGYuaW5pdGlpZXJlX2FwKCk7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cdC8vIEZlbGRlciB6dXLDvGNrc2V0emVuXHJcblx0d2luZG93LmFwZi5sZWVyZUZlbGRlclZvbkZvcm11bGFyKFwiemllbGJlclwiKTtcclxuXHQvLyBEYXRlbiBmw7xyIGRpZSB6aWVsYmVyIGF1cyBkZXIgREIgaG9sZW5cclxuXHR2YXIgZ2V0WmllbEJlciA9ICQuYWpheCh7XHJcbiAgICAgICAgICAgIHR5cGU6ICdnZXQnLFxyXG4gICAgICAgICAgICB1cmw6ICdwaHAvemllbGJlci5waHAnLFxyXG4gICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nLFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBcImlkXCI6IGxvY2FsU3RvcmFnZS56aWVsYmVyX2lkXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KSxcclxuICAgICAgICAkWmllbEJlckphaHIgPSAkKFwiI1ppZWxCZXJKYWhyXCIpO1xyXG5cdGdldFppZWxCZXIuYWx3YXlzKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdC8vIFLDvGNrZ2FiZXdlcnQgbnVsbCB3aXJkIG9mZmVuYmFyIGF1Y2ggYWxzIHN1Y2Nlc3MgZ2V3ZXJ0ZXQsIGdpYnQgd2VpdGVyIHVudGVuIEZlaGxlciwgYWxzbyBBdXNmw7xocnVuZyB2ZXJoaW5kZXJuXHJcblx0XHRpZiAoZGF0YSkge1xyXG5cdFx0XHQvLyB6ZWlsYmVyIGJlcmVpdHN0ZWxsZW5cclxuXHRcdFx0d2luZG93LmFwZi56aWVsYmVyID0gZGF0YTtcclxuXHRcdFx0Ly8gRmVsZGVyIG1pdCBEYXRlbiBiZWxpZWZlcm5cclxuICAgICAgICAgICAgJFppZWxCZXJKYWhyLnZhbChkYXRhLlppZWxCZXJKYWhyKTtcclxuXHRcdFx0JChcIiNaaWVsQmVyRXJyZWljaHVuZ1wiKS52YWwoZGF0YS5aaWVsQmVyRXJyZWljaHVuZyk7XHJcblx0XHRcdCQoXCIjWmllbEJlclR4dFwiKS52YWwoZGF0YS5aaWVsQmVyVHh0KTtcclxuXHRcdFx0Ly8gRm9ybXVsYXJlIGJsZW5kZW5cclxuXHRcdFx0d2luZG93LmFwZi56ZWlnZUZvcm11bGFyKFwiemllbGJlclwiKTtcclxuXHRcdFx0aGlzdG9yeS5yZXBsYWNlU3RhdGUoe3ppZWxiZXI6IFwiemllbGJlclwifSwgXCJ6aWVsYmVyXCIsIFwiaW5kZXguaHRtbD9hcD1cIiArIGxvY2FsU3RvcmFnZS5hcF9pZCArIFwiJmFwemllbD1cIiArIGxvY2FsU3RvcmFnZS5hcHppZWxfaWQgKyBcIiZ6aWVsYmVyPVwiICsgbG9jYWxTdG9yYWdlLnppZWxiZXJfaWQpO1xyXG5cdFx0XHQvLyBiZWkgbmV1ZW4gRGF0ZW5zw6R0emVuIEZva3VzIHN0ZXVlcm5cclxuXHRcdFx0aWYgKCEkWmllbEJlckphaHIudmFsKCkpIHtcclxuICAgICAgICAgICAgICAgICRaaWVsQmVySmFoci5mb2N1cygpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG4vLyBzZXR6dCB3aW5kb3cuYXBmLnppZWxiZXIgdW5kIGxvY2FsU3RvcmFnZS56aWVsYmVyX2lkXHJcbi8vIHdpcmQgYmVuw7Z0aWd0LCB3ZW5uIGJlaW0gQXBwLVN0YXJ0IGRpcmVrdCBlaW4gZGVlcCBsaW5rIGdlw7ZmZm5ldCB3aXJkXHJcbndpbmRvdy5hcGYuc2V0emVXaW5kb3daaWVsYmVyID0gZnVuY3Rpb24oaWQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0bG9jYWxTdG9yYWdlLnppZWxiZXJfaWQgPSBpZDtcclxuXHR2YXIgZ2V0WmllbGJlciA9ICQuYWpheCh7XHJcblx0XHR0eXBlOiAnZ2V0JyxcclxuXHRcdHVybDogJ3BocC96aWVsYmVyLnBocCcsXHJcblx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0ZGF0YToge1xyXG5cdFx0XHRcImlkXCI6IGxvY2FsU3RvcmFnZS56aWVsYmVyX2lkXHJcblx0XHR9XHJcblx0fSk7XHJcblx0Z2V0WmllbGJlci5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0Ly8gUsO8Y2tnYWJld2VydCBudWxsIHdpcmQgb2ZmZW5iYXIgYXVjaCBhbHMgc3VjY2VzcyBnZXdlcnRldCwgZ2lidCB3ZWl0ZXIgdW50ZW4gRmVobGVyLCBhbHNvIEF1c2bDvGhydW5nIHZlcmhpbmRlcm5cclxuXHRcdGlmIChkYXRhKSB7XHJcblx0XHRcdC8vIHppZWxiZXIgYmVyZWl0c3RlbGxlblxyXG5cdFx0XHR3aW5kb3cuYXBmLnppZWxiZXIgPSBkYXRhO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59O1xyXG5cclxud2luZG93LmFwZi5pbml0aWllcmVfZXJma3JpdCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRpZiAoIWxvY2FsU3RvcmFnZS5lcmZrcml0X2lkKSB7XHJcblx0XHQvLyBlcyBmZWhsZW4gYmVuw7Z0aWd0ZSBEYXRlbiA+IGVpbmUgRWJlbmUgaMO2aGVyXHJcblx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV9hcCgpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHQvLyBGZWxkZXIgenVyw7xja3NldHplblxyXG5cdHdpbmRvdy5hcGYubGVlcmVGZWxkZXJWb25Gb3JtdWxhcihcImVyZmtyaXRcIik7XHJcblx0Ly8gRGF0ZW4gZsO8ciBkaWUgZXJma3JpdCBhdXMgZGVyIERCIGhvbGVuXHJcblx0dmFyIGdldEVyZmtyaXQgPSAkLmFqYXgoe1xyXG4gICAgICAgICAgICB0eXBlOiAnZ2V0JyxcclxuICAgICAgICAgICAgdXJsOiAncGhwL2VyZmtyaXQucGhwJyxcclxuICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgXCJpZFwiOiBsb2NhbFN0b3JhZ2UuZXJma3JpdF9pZFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSksXHJcbiAgICAgICAgJEVyZmtyaXRFcnJlaWNodW5nc2dyYWQgPSAkKFwiI0VyZmtyaXRFcnJlaWNodW5nc2dyYWRcIik7XHJcblx0Z2V0RXJma3JpdC5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0Ly8gUsO8Y2tnYWJld2VydCBudWxsIHdpcmQgb2ZmZW5iYXIgYXVjaCBhbHMgc3VjY2VzcyBnZXdlcnRldCwgZ2lidCB3ZWl0ZXIgdW50ZW4gRmVobGVyLCBhbHNvIEF1c2bDvGhydW5nIHZlcmhpbmRlcm5cclxuXHRcdGlmIChkYXRhKSB7XHJcblx0XHRcdC8vIGVyZmtyaXQgYmVyZWl0c3RlbGxlblxyXG5cdFx0XHR3aW5kb3cuYXBmLmVyZmtyaXQgPSBkYXRhO1xyXG5cdFx0XHQvLyBGZWxkZXIgbWl0IERhdGVuIGJlbGllZmVyblxyXG5cdFx0XHQkKFwiI0VyZmtyaXRFcnJlaWNodW5nc2dyYWRcIiArIGRhdGEuRXJma3JpdEVycmVpY2h1bmdzZ3JhZCkucHJvcChcImNoZWNrZWRcIiwgdHJ1ZSk7XHJcblx0XHRcdCQoXCIjRXJma3JpdFR4dFwiKVxyXG4gICAgICAgICAgICAgICAgLnZhbChkYXRhLkVyZmtyaXRUeHQpXHJcbiAgICAgICAgICAgICAgICAubGltaXRlcigyNTUsICQoXCIjRXJma3JpdFR4dF9saW1pdFwiKSk7XHJcblx0XHRcdC8vIEZvcm11bGFyZSBibGVuZGVuXHJcblx0XHRcdHdpbmRvdy5hcGYuemVpZ2VGb3JtdWxhcihcImVyZmtyaXRcIik7XHJcblx0XHRcdGhpc3RvcnkucmVwbGFjZVN0YXRlKHtlcmZrcml0OiBcImVyZmtyaXRcIn0sIFwiZXJma3JpdFwiLCBcImluZGV4Lmh0bWw/YXA9XCIgKyBsb2NhbFN0b3JhZ2UuYXBfaWQgKyBcIiZlcmZrcml0PVwiICsgbG9jYWxTdG9yYWdlLmVyZmtyaXRfaWQpO1xyXG5cdFx0XHQvLyBiZWkgbmV1ZW4gRGF0ZW5zw6R0emVuIEZva3VzIHN0ZXVlcm5cclxuXHRcdFx0aWYgKCEkRXJma3JpdEVycmVpY2h1bmdzZ3JhZC52YWwoKSkge1xyXG4gICAgICAgICAgICAgICAgJEVyZmtyaXRFcnJlaWNodW5nc2dyYWQuZm9jdXMoKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0pO1xyXG59O1xyXG5cclxuLy8gc2V0enQgd2luZG93LmFwZi5lcmZrcml0IHVuZCBsb2NhbFN0b3JhZ2UuZXJma3JpdF9pZFxyXG4vLyB3aXJkIGJlbsO2dGlndCwgd2VubiBiZWltIEFwcC1TdGFydCBkaXJla3QgZWluIGRlZXAgbGluayBnZcO2ZmZuZXQgd2lyZFxyXG53aW5kb3cuYXBmLnNldHplV2luZG93RXJma3JpdCA9IGZ1bmN0aW9uKGlkKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS5lcmZrcml0X2lkID0gaWQ7XHJcblx0dmFyIGdldEVyZmtyaXQgPSAkLmFqYXgoe1xyXG5cdFx0dHlwZTogJ2dldCcsXHJcblx0XHR1cmw6ICdwaHAvZXJma3JpdC5waHAnLFxyXG5cdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdGRhdGE6IHtcclxuXHRcdFx0XCJpZFwiOiBsb2NhbFN0b3JhZ2UuZXJma3JpdF9pZFxyXG5cdFx0fVxyXG5cdH0pO1xyXG5cdGdldEVyZmtyaXQuYWx3YXlzKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdC8vIFLDvGNrZ2FiZXdlcnQgbnVsbCB3aXJkIG9mZmVuYmFyIGF1Y2ggYWxzIHN1Y2Nlc3MgZ2V3ZXJ0ZXQsIGdpYnQgd2VpdGVyIHVudGVuIEZlaGxlciwgYWxzbyBBdXNmw7xocnVuZyB2ZXJoaW5kZXJuXHJcblx0XHRpZiAoZGF0YSkge1xyXG5cdFx0XHQvLyBlcmZrcml0IGJlcmVpdHN0ZWxsZW5cclxuXHRcdFx0d2luZG93LmFwZi5lcmZrcml0ID0gZGF0YTtcclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbndpbmRvdy5hcGYuaW5pdGlpZXJlX2piZXIgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0aWYgKCFsb2NhbFN0b3JhZ2UuamJlcl9pZCkge1xyXG5cdFx0Ly8gZXMgZmVobGVuIGJlbsO2dGlndGUgRGF0ZW4gPiBlaW5lIEViZW5lIGjDtmhlclxyXG5cdFx0d2luZG93LmFwZi5pbml0aWllcmVfYXAoKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblx0Ly8gRmVsZGVyIHp1csO8Y2tzZXR6ZW5cclxuXHR3aW5kb3cuYXBmLmxlZXJlRmVsZGVyVm9uRm9ybXVsYXIoXCJqYmVyXCIpO1xyXG5cdC8vIERhdGVuIGbDvHIgZGllIGpiZXIgYXVzIGRlciBEQiBob2xlblxyXG5cdHZhciBnZXRKYmVyID0gJC5hamF4KHtcclxuICAgICAgICAgICAgdHlwZTogJ2dldCcsXHJcbiAgICAgICAgICAgIHVybDogJ3BocC9qYmVyLnBocCcsXHJcbiAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIFwiaWRcIjogbG9jYWxTdG9yYWdlLmpiZXJfaWRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pLFxyXG4gICAgICAgICRKQmVySmFociA9ICQoXCIjSkJlckphaHJcIik7XHJcblx0Z2V0SmJlci5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0Ly8gUsO8Y2tnYWJld2VydCBudWxsIHdpcmQgb2ZmZW5iYXIgYXVjaCBhbHMgc3VjY2VzcyBnZXdlcnRldCwgZ2lidCB3ZWl0ZXIgdW50ZW4gRmVobGVyLCBhbHNvIEF1c2bDvGhydW5nIHZlcmhpbmRlcm5cclxuXHRcdGlmIChkYXRhKSB7XHJcblx0XHRcdC8vIGpiZXIgYmVyZWl0c3RlbGxlblxyXG5cdFx0XHR3aW5kb3cuYXBmLmpiZXIgPSBkYXRhO1xyXG5cdFx0XHQvLyBGZWxkZXIgbWl0IERhdGVuIGJlbGllZmVyblxyXG4gICAgICAgICAgICAkSkJlckphaHIudmFsKGRhdGEuSkJlckphaHIpO1xyXG5cdFx0XHQkKFwiI0pCZXJTaXR1YXRpb25cIikudmFsKGRhdGEuSkJlclNpdHVhdGlvbik7XHJcblx0XHRcdCQoXCIjSkJlclZlcmdsZWljaFZvcmphaHJHZXNhbXR6aWVsXCIpLnZhbChkYXRhLkpCZXJWZXJnbGVpY2hWb3JqYWhyR2VzYW10emllbCk7XHJcblx0XHRcdCQoXCIjSkJlckJldXJ0ZWlsdW5nXCIgKyBkYXRhLkpCZXJCZXVydGVpbHVuZykucHJvcChcImNoZWNrZWRcIiwgdHJ1ZSk7XHJcblx0XHRcdC8vIGVzY2FwZW4sICsgdW5kIC0gd2VyZGVuIHNvbnN0IHZlcsOkbmRlcnRcclxuXHRcdFx0JChcIiNKQmVyVmVyYWVuR2VnZW5Wb3JqYWhyXFxcXFwiICsgZGF0YS5KQmVyVmVyYWVuR2VnZW5Wb3JqYWhyKS5wcm9wKFwiY2hlY2tlZFwiLCB0cnVlKTtcclxuXHRcdFx0JChcIiNKQmVyQW5hbHlzZVwiKVxyXG4gICAgICAgICAgICAgICAgLnZhbChkYXRhLkpCZXJBbmFseXNlKVxyXG4gICAgICAgICAgICAgICAgLmxpbWl0ZXIoMjU1LCAkKFwiI0pCZXJBbmFseXNlX2xpbWl0XCIpKTtcclxuXHRcdFx0JChcIiNKQmVyVW1zZXR6dW5nXCIpLnZhbChkYXRhLkpCZXJVbXNldHp1bmcpO1xyXG5cdFx0XHQkKFwiI0pCZXJFcmZrb1wiKS52YWwoZGF0YS5KQmVyRXJma28pO1xyXG5cdFx0XHQkKFwiI0pCZXJBVHh0XCIpLnZhbChkYXRhLkpCZXJBVHh0KTtcclxuXHRcdFx0JChcIiNKQmVyQlR4dFwiKS52YWwoZGF0YS5KQmVyQlR4dCk7XHJcblx0XHRcdCQoXCIjSkJlckNUeHRcIikudmFsKGRhdGEuSkJlckNUeHQpO1xyXG5cdFx0XHQkKFwiI0pCZXJEVHh0XCIpLnZhbChkYXRhLkpCZXJEVHh0KTtcclxuXHRcdFx0aWYgKGRhdGEuSkJlckRhdHVtICE9PSBcIjAxLjAxLjE5NzBcIikge1xyXG5cdFx0XHRcdC8vIHBocCBtYWNodCBhdXMgZWluZW0gTnVsbHdlcnQgaW0gRGF0dW0gZGVuIDEuMS4xOTcwISEhXHJcblx0XHRcdFx0JChcIiNKQmVyRGF0dW1cIikudmFsKGRhdGEuSkJlckRhdHVtKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQkKFwiI0pCZXJEYXR1bVwiKS52YWwoXCJcIik7XHJcblx0XHRcdH1cclxuXHRcdFx0Ly8gSkJlckJlYXJiOiBEYXRlbiBob2xlbiAtIG9kZXIgdm9yaGFuZGVuZSBudXR6ZW5cclxuXHRcdFx0aWYgKCF3aW5kb3cuYXBmLmFkcmVzc2VuX2h0bWwpIHtcclxuXHRcdFx0XHR2YXIgZ2V0QWRyZXNzZW4gPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0dHlwZTogJ2dldCcsXHJcblx0XHRcdFx0XHR1cmw6ICdhcGkvYWRyZXNzZW4nLFxyXG5cdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJ1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdGdldEFkcmVzc2VuLmFsd2F5cyhmdW5jdGlvbihkYXRhMikge1xyXG5cdFx0XHRcdFx0aWYgKGRhdGEyKSB7XHJcblx0XHRcdFx0XHRcdC8vIGFkcmVzc2VuIGJlcmVpdHN0ZWxsZW5cclxuXHRcdFx0XHRcdFx0Ly8gRmVsZCBtaXQgRGF0ZW4gYmVsaWVmZXJuXHJcblx0XHRcdFx0XHRcdHZhciBodG1sO1xyXG5cdFx0XHRcdFx0XHRodG1sID0gXCI8b3B0aW9uPjwvb3B0aW9uPlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfLmVhY2goZGF0YTIsIGZ1bmN0aW9uKGFkcmVzc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gXCI8b3B0aW9uIHZhbHVlPVxcXCJcIiArIGFkcmVzc2UuaWQgKyBcIlxcXCI+XCIgKyBhZHJlc3NlLkFkck5hbWUgKyBcIjwvb3B0aW9uPlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi5hZHJlc3Nlbl9odG1sID0gaHRtbDtcclxuXHRcdFx0XHRcdFx0JChcIiNKQmVyQmVhcmJcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5odG1sKGh0bWwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudmFsKHdpbmRvdy5hcGYuamJlci5KQmVyQmVhcmIpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdCQoXCIjSkJlckJlYXJiXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLmh0bWwod2luZG93LmFwZi5hZHJlc3Nlbl9odG1sKVxyXG4gICAgICAgICAgICAgICAgICAgIC52YWwod2luZG93LmFwZi5qYmVyLkpCZXJCZWFyYik7XHJcblx0XHRcdH1cclxuXHRcdFx0Ly8gRm9ybXVsYXJlIGJsZW5kZW5cclxuXHRcdFx0d2luZG93LmFwZi56ZWlnZUZvcm11bGFyKFwiamJlclwiKTtcclxuXHRcdFx0aGlzdG9yeS5yZXBsYWNlU3RhdGUoe2piZXI6IFwiamJlclwifSwgXCJqYmVyXCIsIFwiaW5kZXguaHRtbD9hcD1cIiArIGxvY2FsU3RvcmFnZS5hcF9pZCArIFwiJmpiZXI9XCIgKyBsb2NhbFN0b3JhZ2UuamJlcl9pZCk7XHJcblx0XHRcdC8vIGJlaSBuZXVlbiBEYXRlbnPDpHR6ZW4gRm9rdXMgc3RldWVyblxyXG5cdFx0XHRpZiAoISRKQmVySmFoci52YWwoKSkge1xyXG4gICAgICAgICAgICAgICAgJEpCZXJKYWhyLmZvY3VzKCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbi8vIHNldHp0IHdpbmRvdy5hcGYuamJlciB1bmQgbG9jYWxTdG9yYWdlLmpiZXJfaWRcclxuLy8gd2lyZCBiZW7DtnRpZ3QsIHdlbm4gYmVpbSBBcHAtU3RhcnQgZGlyZWt0IGVpbiBkZWVwIGxpbmsgZ2XDtmZmbmV0IHdpcmRcclxud2luZG93LmFwZi5zZXR6ZVdpbmRvd0piZXIgPSBmdW5jdGlvbihpZCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuamJlcl9pZCA9IGlkO1xyXG5cdHZhciBnZXRKYmVyID0gJC5hamF4KHtcclxuXHRcdHR5cGU6ICdnZXQnLFxyXG5cdFx0dXJsOiAncGhwL2piZXIucGhwJyxcclxuXHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRkYXRhOiB7XHJcblx0XHRcdFwiaWRcIjogbG9jYWxTdG9yYWdlLmpiZXJfaWRcclxuXHRcdH1cclxuXHR9KTtcclxuXHRnZXRKYmVyLmFsd2F5cyhmdW5jdGlvbihkYXRhKSB7XHJcblx0XHQvLyBSw7xja2dhYmV3ZXJ0IG51bGwgd2lyZCBvZmZlbmJhciBhdWNoIGFscyBzdWNjZXNzIGdld2VydGV0LCBnaWJ0IHdlaXRlciB1bnRlbiBGZWhsZXIsIGFsc28gQXVzZsO8aHJ1bmcgdmVyaGluZGVyblxyXG5cdFx0aWYgKGRhdGEpIHtcclxuXHRcdFx0Ly8gamJlciBiZXJlaXRzdGVsbGVuXHJcblx0XHRcdHdpbmRvdy5hcGYuamJlciA9IGRhdGE7XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLmluaXRpaWVyZV9qYmVyX3VlYmVyc2ljaHQgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0aWYgKCFsb2NhbFN0b3JhZ2UuamJlcl91ZWJlcnNpY2h0X2lkKSB7XHJcblx0XHQvLyBlcyBmZWhsZW4gYmVuw7Z0aWd0ZSBEYXRlbiA+IGVpbmUgRWJlbmUgaMO2aGVyXHJcblx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV9hcCgpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHQvLyBGZWxkZXIgenVyw7xja3NldHplblxyXG5cdHdpbmRvdy5hcGYubGVlcmVGZWxkZXJWb25Gb3JtdWxhcihcImpiZXJfdWViZXJzaWNodFwiKTtcclxuXHQvLyBEYXRlbiBmw7xyIGRpZSBqYmVyX3VlYmVyc2ljaHQgYXVzIGRlciBEQiBob2xlblxyXG5cdHZhciBnZXRKYmVyw5xiZXJzaWNodCA9ICQuYWpheCh7XHJcbiAgICAgICAgICAgIHR5cGU6ICdnZXQnLFxyXG4gICAgICAgICAgICB1cmw6ICdwaHAvamJlcl91ZWJlcnNpY2h0LnBocCcsXHJcbiAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIFwiSmJ1SmFoclwiOiBsb2NhbFN0b3JhZ2UuamJlcl91ZWJlcnNpY2h0X2lkXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KSxcclxuICAgICAgICAkSmJ1SmFociA9ICQoXCIjSmJ1SmFoclwiKTtcclxuXHRnZXRKYmVyw5xiZXJzaWNodC5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0Ly8gUsO8Y2tnYWJld2VydCBudWxsIHdpcmQgb2ZmZW5iYXIgYXVjaCBhbHMgc3VjY2VzcyBnZXdlcnRldCwgZ2lidCB3ZWl0ZXIgdW50ZW4gRmVobGVyLCBhbHNvIEF1c2bDvGhydW5nIHZlcmhpbmRlcm5cclxuXHRcdGlmIChkYXRhKSB7XHJcblx0XHRcdC8vIGpiZXJfdWViZXJzaWNodCBiZXJlaXRzdGVsbGVuXHJcblx0XHRcdHdpbmRvdy5hcGYuamJlcl/DvGJlcnNpY2h0ID0gZGF0YTtcclxuXHRcdFx0Ly8gRmVsZGVyIG1pdCBEYXRlbiBiZWxpZWZlcm5cclxuICAgICAgICAgICAgJEpidUphaHIudmFsKGRhdGEuSmJ1SmFocik7XHJcblx0XHRcdCQoXCIjSmJ1QmVtZXJrdW5nZW5cIikudmFsKGRhdGEuSmJ1QmVtZXJrdW5nZW4pO1xyXG5cdFx0XHQvLyB3aW5kb3cuYXBmLmZpdFRleHRhcmVhVG9Db250ZW50KFwiQmVtZXJrdW5nZW5cIiwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCk7XHJcblx0XHRcdC8vIEZvcm11bGFyZSBibGVuZGVuXHJcblx0XHRcdHdpbmRvdy5hcGYuemVpZ2VGb3JtdWxhcihcImpiZXJfdWViZXJzaWNodFwiKTtcclxuXHRcdFx0aGlzdG9yeS5yZXBsYWNlU3RhdGUoe2piZXJfdWViZXJzaWNodDogXCJqYmVyX3VlYmVyc2ljaHRcIn0sIFwiamJlcl91ZWJlcnNpY2h0XCIsIFwiaW5kZXguaHRtbD9hcD1cIiArIGxvY2FsU3RvcmFnZS5hcF9pZCArIFwiJmpiZXJfdWViZXJzaWNodD1cIiArIGxvY2FsU3RvcmFnZS5qYmVyX3VlYmVyc2ljaHRfaWQpO1xyXG5cdFx0XHQvLyBiZWkgbmV1ZW4gRGF0ZW5zw6R0emVuIEZva3VzIHN0ZXVlcm5cclxuXHRcdFx0aWYgKCEkSmJ1SmFoci52YWwoKSkge1xyXG4gICAgICAgICAgICAgICAgJEpidUphaHIuZm9jdXMoKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0pO1xyXG59O1xyXG5cclxuLy8gc2V0enQgd2luZG93LmFwZi5qYmVyX8O8YmVyc2ljaHQgdW5kIGxvY2FsU3RvcmFnZS5qYmVyX3VlYmVyc2ljaHRfaWRcclxuLy8gd2lyZCBiZW7DtnRpZ3QsIHdlbm4gYmVpbSBBcHAtU3RhcnQgZGlyZWt0IGVpbiBkZWVwIGxpbmsgZ2XDtmZmbmV0IHdpcmRcclxud2luZG93LmFwZi5zZXR6ZVdpbmRvd0piZXJVZWJlcnNpY2h0ID0gZnVuY3Rpb24oaWQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0bG9jYWxTdG9yYWdlLmpiZXJfdWViZXJzaWNodF9pZCA9IGlkO1xyXG5cdHZhciBnZXRKYmVyVWViZXJzaWNodCA9ICQuYWpheCh7XHJcblx0XHR0eXBlOiAnZ2V0JyxcclxuXHRcdHVybDogJ3BocC9qYmVyX3VlYmVyc2ljaHQucGhwJyxcclxuXHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRkYXRhOiB7XHJcblx0XHRcdFwiaWRcIjogbG9jYWxTdG9yYWdlLmpiZXJfdWViZXJzaWNodF9pZFxyXG5cdFx0fVxyXG5cdH0pO1xyXG5cdGdldEpiZXJVZWJlcnNpY2h0LmFsd2F5cyhmdW5jdGlvbihkYXRhKSB7XHJcblx0XHQvLyBSw7xja2dhYmV3ZXJ0IG51bGwgd2lyZCBvZmZlbmJhciBhdWNoIGFscyBzdWNjZXNzIGdld2VydGV0LCBnaWJ0IHdlaXRlciB1bnRlbiBGZWhsZXIsIGFsc28gQXVzZsO8aHJ1bmcgdmVyaGluZGVyblxyXG5cdFx0aWYgKGRhdGEpIHtcclxuXHRcdFx0Ly8gamJlcl91ZWJlcnNpY2h0IGJlcmVpdHN0ZWxsZW5cclxuXHRcdFx0d2luZG93LmFwZi5qYmVyX8O8YmVyc2ljaHQgPSBkYXRhO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59O1xyXG5cclxud2luZG93LmFwZi5pbml0aWllcmVfYmVyID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICghbG9jYWxTdG9yYWdlLmJlcl9pZCkge1xyXG5cdFx0Ly8gZXMgZmVobGVuIGJlbsO2dGlndGUgRGF0ZW4gPiBlaW5lIEViZW5lIGjDtmhlclxyXG5cdFx0d2luZG93LmFwZi5pbml0aWllcmVfYXAoKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblx0Ly8gRmVsZGVyIHp1csO8Y2tzZXR6ZW5cclxuXHR3aW5kb3cuYXBmLmxlZXJlRmVsZGVyVm9uRm9ybXVsYXIoXCJiZXJcIik7XHJcblx0Ly8gRGF0ZW4gZsO8ciBkaWUgYmVyIGF1cyBkZXIgREIgaG9sZW5cclxuXHR2YXIgZ2V0QmVyID0gJC5hamF4KHtcclxuICAgICAgICAgICAgdHlwZTogJ2dldCcsXHJcbiAgICAgICAgICAgIHVybDogJ3BocC9iZXIucGhwJyxcclxuICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgXCJpZFwiOiBsb2NhbFN0b3JhZ2UuYmVyX2lkXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KSxcclxuICAgICAgICAkQmVyQXV0b3IgPSAkKFwiI0JlckF1dG9yXCIpLFxyXG4gICAgICAgICRCZXJKYWhyID0gJChcIiNCZXJKYWhyXCIpLFxyXG4gICAgICAgICRCZXJUaXRlbCA9ICQoXCIjQmVyVGl0ZWxcIiksXHJcbiAgICAgICAgJEJlclVSTCA9ICQoXCIjQmVyVVJMXCIpO1xyXG5cdGdldEJlci5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0Ly8gUsO8Y2tnYWJld2VydCBudWxsIHdpcmQgb2ZmZW5iYXIgYXVjaCBhbHMgc3VjY2VzcyBnZXdlcnRldCwgZ2lidCB3ZWl0ZXIgdW50ZW4gRmVobGVyLCBhbHNvIEF1c2bDvGhydW5nIHZlcmhpbmRlcm5cclxuXHRcdGlmIChkYXRhKSB7XHJcblx0XHRcdC8vIGJlciBiZXJlaXRzdGVsbGVuXHJcblx0XHRcdHdpbmRvdy5hcGYuYmVyID0gZGF0YTtcclxuXHRcdFx0Ly8gRmVsZGVyIG1pdCBEYXRlbiBiZWxpZWZlcm5cclxuICAgICAgICAgICAgJEJlckF1dG9yLnZhbChkYXRhLkJlckF1dG9yKTtcclxuICAgICAgICAgICAgJEJlckphaHIudmFsKGRhdGEuQmVySmFocik7XHJcbiAgICAgICAgICAgICRCZXJUaXRlbFxyXG4gICAgICAgICAgICAgICAgLnZhbChkYXRhLkJlclRpdGVsKVxyXG4gICAgICAgICAgICAgICAgLmxpbWl0ZXIoMjU1LCAkKFwiI0JlclRpdGVsX2xpbWl0XCIpKTtcclxuICAgICAgICAgICAgJEJlclVSTFxyXG4gICAgICAgICAgICAgICAgLnZhbChkYXRhLkJlclVSTClcclxuICAgICAgICAgICAgICAgIC5saW1pdGVyKDI1NSwgJChcIiNCZXJVUkxfbGltaXRcIikpO1xyXG5cdFx0XHQvLyBVUkwtTGluayBpbml0aWFsaXNpZXJlbiwgd2lyZCBiZWkgw4RuZGVydW5nIGRlciBVUkwgaW4gaW5kZXguaHRtbCBhbmdlcGFzc3RcclxuXHRcdFx0JCgnI0JlclVSTEhyZWYnKS5hdHRyKCdvbkNsaWNrJywgXCJ3aW5kb3cub3BlbignXCIgKyBkYXRhLkJlclVSTCArIFwiJywgdGFyZ2V0PSdfYmxhbmsnKVwiKTtcclxuXHRcdFx0Ly8gRm9ybXVsYXJlIGJsZW5kZW5cclxuXHRcdFx0d2luZG93LmFwZi56ZWlnZUZvcm11bGFyKFwiYmVyXCIpO1xyXG5cdFx0XHRoaXN0b3J5LnJlcGxhY2VTdGF0ZSh7YmVyOiBcImJlclwifSwgXCJiZXJcIiwgXCJpbmRleC5odG1sP2FwPVwiICsgbG9jYWxTdG9yYWdlLmFwX2lkICsgXCImYmVyPVwiICsgbG9jYWxTdG9yYWdlLmJlcl9pZCk7XHJcblx0XHRcdC8vIGJlaSBuZXVlbiBEYXRlbnPDpHR6ZW4gRm9rdXMgc3RldWVyblxyXG5cdFx0XHRpZiAoISRCZXJBdXRvci52YWwoKSkge1xyXG4gICAgICAgICAgICAgICAgJEJlckF1dG9yLmZvY3VzKCk7XHJcblx0XHRcdH0gZWxzZSBpZiAoISRCZXJKYWhyLnZhbCgpKSB7XHJcbiAgICAgICAgICAgICAgICAkQmVySmFoci5mb2N1cygpO1xyXG5cdFx0XHR9IGVsc2UgaWYgKCEkQmVyVGl0ZWwudmFsKCkpIHtcclxuICAgICAgICAgICAgICAgICRCZXJUaXRlbC5mb2N1cygpO1xyXG5cdFx0XHR9IGVsc2UgaWYgKCEkQmVyVVJMLnZhbCgpKSB7XHJcbiAgICAgICAgICAgICAgICAkQmVyVVJMLmZvY3VzKCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbi8vIHNldHp0IHdpbmRvdy5hcGYuYmVyIHVuZCBsb2NhbFN0b3JhZ2UuYmVyX2lkXHJcbi8vIHdpcmQgYmVuw7Z0aWd0LCB3ZW5uIGJlaW0gQXBwLVN0YXJ0IGRpcmVrdCBlaW4gZGVlcCBsaW5rIGdlw7ZmZm5ldCB3aXJkXHJcbndpbmRvdy5hcGYuc2V0emVXaW5kb3dCZXIgPSBmdW5jdGlvbihpZCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuYmVyX2lkID0gaWQ7XHJcblx0dmFyIGdldEJlciA9ICQuYWpheCh7XHJcblx0XHR0eXBlOiAnZ2V0JyxcclxuXHRcdHVybDogJ3BocC9iZXIucGhwJyxcclxuXHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRkYXRhOiB7XHJcblx0XHRcdFwiaWRcIjogbG9jYWxTdG9yYWdlLmJlcl9pZFxyXG5cdFx0fVxyXG5cdH0pO1xyXG5cdGdldEJlci5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0Ly8gUsO8Y2tnYWJld2VydCBudWxsIHdpcmQgb2ZmZW5iYXIgYXVjaCBhbHMgc3VjY2VzcyBnZXdlcnRldCwgZ2lidCB3ZWl0ZXIgdW50ZW4gRmVobGVyLCBhbHNvIEF1c2bDvGhydW5nIHZlcmhpbmRlcm5cclxuXHRcdGlmIChkYXRhKSB7XHJcblx0XHRcdC8vIGJlciBiZXJlaXRzdGVsbGVuXHJcblx0XHRcdHdpbmRvdy5hcGYuYmVyID0gZGF0YTtcclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbndpbmRvdy5hcGYuaW5pdGlpZXJlX2lkZWFsYmlvdG9wID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICghbG9jYWxTdG9yYWdlLmFwX2lkKSB7XHJcblx0XHQvLyBlcyBmZWhsZW4gYmVuw7Z0aWd0ZSBEYXRlbiA+IGVpbmUgRWJlbmUgaMO2aGVyXHJcblx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV9hcCgpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHQvLyBGZWxkZXIgenVyw7xja3NldHplblxyXG5cdHdpbmRvdy5hcGYubGVlcmVGZWxkZXJWb25Gb3JtdWxhcihcImlkZWFsYmlvdG9wXCIpO1xyXG5cdC8vIERhdGVuIGbDvHIgZGllIGlkZWFsYmlvdG9wIGF1cyBkZXIgREIgaG9sZW5cclxuXHR2YXIgZ2V0SWRlYWxiaW90b3AgPSAkLmFqYXgoe1xyXG4gICAgICAgICAgICB0eXBlOiAnZ2V0JyxcclxuICAgICAgICAgICAgdXJsOiAnYXA9JyArIGxvY2FsU3RvcmFnZS5hcF9pZCArICcvaWRlYWxiaW90b3AnLFxyXG4gICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nXHJcbiAgICAgICAgfSksXHJcbiAgICAgICAgJEliRXJzdGVsbGRhdHVtID0gJChcIiNJYkVyc3RlbGxkYXR1bVwiKTtcclxuXHRnZXRJZGVhbGJpb3RvcC5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0Ly8gUsO8Y2tnYWJld2VydCBudWxsIHdpcmQgb2ZmZW5iYXIgYXVjaCBhbHMgc3VjY2VzcyBnZXdlcnRldCwgZ2lidCB3ZWl0ZXIgdW50ZW4gRmVobGVyLCBhbHNvIEF1c2bDvGhydW5nIHZlcmhpbmRlcm5cclxuXHRcdGlmIChkYXRhICYmIGRhdGFbMF0pIHtcclxuICAgICAgICAgICAgZGF0YSA9IGRhdGFbMF07XHJcblx0XHRcdC8vIGlkZWFsYmlvdG9wIGJlcmVpdHN0ZWxsZW5cclxuXHRcdFx0bG9jYWxTdG9yYWdlLmlkZWFsYmlvdG9wX2lkID0gZGF0YS5JYkFwQXJ0SWQ7XHJcblx0XHRcdHdpbmRvdy5hcGYuaWRlYWxiaW90b3AgPSBkYXRhO1xyXG5cdFx0XHQvLyBGZWxkZXIgbWl0IERhdGVuIGJlbGllZmVyblxyXG5cdFx0XHRpZiAoZGF0YS5JYkVyc3RlbGxkYXR1bSAhPT0gXCIwMS4wMS4xOTcwXCIpIHtcclxuXHRcdFx0XHQvLyBwaHAgbWFjaHQgYXVzIGVpbmVtIE51bGx3ZXJ0IGltIERhdHVtIGRlbiAxLjEuMTk3MCEhIVxyXG5cdFx0XHRcdCQoXCIjSWJFcnN0ZWxsZGF0dW1cIikudmFsKGRhdGEuSWJFcnN0ZWxsZGF0dW0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdCQoXCIjSWJIb2VoZW5sYWdlXCIpLnZhbChkYXRhLkliSG9laGVubGFnZSk7XHJcblx0XHRcdCQoXCIjSWJSZWdpb25cIikudmFsKGRhdGEuSWJSZWdpb24pO1xyXG5cdFx0XHQkKFwiI0liRXhwb3NpdGlvblwiKS52YWwoZGF0YS5JYkV4cG9zaXRpb24pO1xyXG5cdFx0XHQkKFwiI0liQmVzb25udW5nXCIpLnZhbChkYXRhLkliQmVzb25udW5nKTtcclxuXHRcdFx0JChcIiNJYkhhbmduZWlndW5nXCIpLnZhbChkYXRhLkliSGFuZ25laWd1bmcpO1xyXG5cdFx0XHQkKFwiI0liQm9kZW5UeXBcIikudmFsKGRhdGEuSWJCb2RlblR5cCk7XHJcblx0XHRcdCQoXCIjSWJCb2RlbkthbGtnZWhhbHRcIikudmFsKGRhdGEuSWJCb2RlbkthbGtnZWhhbHQpO1xyXG5cdFx0XHQkKFwiI0liQm9kZW5EdXJjaGxhZXNzaWdrZWl0XCIpLnZhbChkYXRhLkliQm9kZW5EdXJjaGxhZXNzaWdrZWl0KTtcclxuXHRcdFx0JChcIiNJYkJvZGVuSHVtdXNcIikudmFsKGRhdGEuSWJCb2Rlbkh1bXVzKTtcclxuXHRcdFx0JChcIiNJYkJvZGVuTmFlaHJzdG9mZmdlaGFsdFwiKS52YWwoZGF0YS5JYkJvZGVuTmFlaHJzdG9mZmdlaGFsdCk7XHJcblx0XHRcdCQoXCIjSWJXYXNzZXJoYXVzaGFsdFwiKS52YWwoZGF0YS5JYldhc3NlcmhhdXNoYWx0KTtcclxuXHRcdFx0JChcIiNJYktvbmt1cnJlbnpcIikudmFsKGRhdGEuSWJLb25rdXJyZW56KTtcclxuXHRcdFx0JChcIiNJYk1vb3NzY2hpY2h0XCIpLnZhbChkYXRhLkliTW9vc3NjaGljaHQpO1xyXG5cdFx0XHQkKFwiI0liS3JhdXRzY2hpY2h0XCIpLnZhbChkYXRhLkliS3JhdXRzY2hpY2h0KTtcclxuXHRcdFx0JChcIiNJYlN0cmF1Y2hzY2hpY2h0XCIpLnZhbChkYXRhLkliU3RyYXVjaHNjaGljaHQpO1xyXG5cdFx0XHQkKFwiI0liQmF1bXNjaGljaHRcIikudmFsKGRhdGEuSWJCYXVtc2NoaWNodCk7XHJcblx0XHRcdCQoXCIjSWJCZW1lcmt1bmdlblwiKS52YWwoZGF0YS5JYkJlbWVya3VuZ2VuKTtcclxuXHRcdFx0Ly8gRm9ybXVsYXJlIGJsZW5kZW5cclxuXHRcdFx0d2luZG93LmFwZi56ZWlnZUZvcm11bGFyKFwiaWRlYWxiaW90b3BcIik7XHJcblx0XHRcdGhpc3RvcnkucmVwbGFjZVN0YXRlKHtpZGVhbGJpb3RvcDogXCJpZGVhbGJpb3RvcFwifSwgXCJpZGVhbGJpb3RvcFwiLCBcImluZGV4Lmh0bWw/YXA9XCIgKyBsb2NhbFN0b3JhZ2UuYXBfaWQgKyBcIiZpZGVhbGJpb3RvcD1cIiArIGxvY2FsU3RvcmFnZS5pZGVhbGJpb3RvcF9pZCk7XHJcblx0XHRcdC8vIGJlaSBuZXVlbiBEYXRlbnPDpHR6ZW4gRm9rdXMgc3RldWVyblxyXG5cdFx0XHRpZiAoISRJYkVyc3RlbGxkYXR1bS52YWwoKSkge1xyXG4gICAgICAgICAgICAgICAgJEliRXJzdGVsbGRhdHVtLmZvY3VzKCk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdC8vIG51ciBha3R1YWxpc2llcmVuLCB3ZW5uIFNjaHJlaWJyZWNodGUgYmVzdGVoZW5cclxuXHRcdFx0aWYgKCF3aW5kb3cuYXBmLnByw7xmZVNjaHJlaWJ2b3JhdXNzZXR6dW5nZW4oKSkge1xyXG5cdFx0XHRcdHJldHVybjtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gbnVsbCB6dXLDvGNrZ2Vrb21tZW4gPiBEYXRlc2F0eiBzY2hhZmZlblxyXG5cdFx0XHR2YXIgaW5zZXJ0SWRlYWxiaW90b3AgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdHR5cGU6ICdwb3N0JyxcclxuXHRcdFx0XHR1cmw6ICdwaHAvaWRlYWxiaW90b3BfaW5zZXJ0LnBocCcsXHJcblx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcImlkXCI6IGxvY2FsU3RvcmFnZS5hcF9pZCxcclxuXHRcdFx0XHRcdFwidXNlclwiOiBzZXNzaW9uU3RvcmFnZS5Vc2VyXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdFx0aW5zZXJ0SWRlYWxiaW90b3AuYWx3YXlzKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHRsb2NhbFN0b3JhZ2UuaWRlYWxiaW90b3BfaWQgPSBkYXRhLkliQXBBcnRJZDtcclxuXHRcdFx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV9pZGVhbGJpb3RvcCgpO1xyXG5cdFx0XHR9KTtcclxuXHRcdFx0aW5zZXJ0SWRlYWxiaW90b3AuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IEtlaW4gSWRlYWxiaW90b3AgZXJzdGVsbHRcIik7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coXCJGZWhsZXI6IEtlaW4gSWRlYWxiaW90b3AgZXJzdGVsbHRcIik7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59O1xyXG5cclxuLy8gc2V0enQgd2luZG93LmFwZi5pZGVhbGJpb3RvcCB1bmQgbG9jYWxTdG9yYWdlLmlkZWFsYmlvdG9wX2lkXHJcbi8vIHdpcmQgYmVuw7Z0aWd0LCB3ZW5uIGJlaW0gQXBwLVN0YXJ0IGRpcmVrdCBlaW4gZGVlcCBsaW5rIGdlw7ZmZm5ldCB3aXJkXHJcbndpbmRvdy5hcGYuc2V0emVXaW5kb3dJZGVhbGJpb3RvcCA9IGZ1bmN0aW9uKGlkKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS5pZGVhbGJpb3RvcF9pZCA9IGlkO1xyXG5cdHZhciBnZXRJZGVhbGJpb3RvcCA9ICQuYWpheCh7XHJcblx0XHR0eXBlOiAnZ2V0JyxcclxuXHRcdHVybDogJ2FwPScgKyBsb2NhbFN0b3JhZ2UuaWRlYWxiaW90b3BfaWQgKyAnL2lkZWFsYmlvdG9wLnBocCcsXHJcblx0XHRkYXRhVHlwZTogJ2pzb24nXHJcblx0fSk7XHJcblx0Z2V0SWRlYWxiaW90b3AuYWx3YXlzKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdC8vIFLDvGNrZ2FiZXdlcnQgbnVsbCB3aXJkIG9mZmVuYmFyIGF1Y2ggYWxzIHN1Y2Nlc3MgZ2V3ZXJ0ZXQsIGdpYnQgd2VpdGVyIHVudGVuIEZlaGxlciwgYWxzbyBBdXNmw7xocnVuZyB2ZXJoaW5kZXJuXHJcblx0XHRpZiAoZGF0YSAmJiBkYXRhWzBdKSB7XHJcblx0XHRcdC8vIGlkZWFsYmlvdG9wIGJlcmVpdHN0ZWxsZW5cclxuXHRcdFx0d2luZG93LmFwZi5pZGVhbGJpb3RvcCA9IGRhdGFbMF07XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLmluaXRpaWVyZV9hc3NvemFydGVuID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICghbG9jYWxTdG9yYWdlLmFzc296YXJ0ZW5faWQpIHtcclxuXHRcdC8vIGVzIGZlaGxlbiBiZW7DtnRpZ3RlIERhdGVuID4gZWluZSBFYmVuZSBow7ZoZXJcclxuXHRcdHdpbmRvdy5hcGYuaW5pdGlpZXJlX2FwKCk7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cdC8vIEZlbGRlciB6dXLDvGNrc2V0emVuXHJcblx0d2luZG93LmFwZi5sZWVyZUZlbGRlclZvbkZvcm11bGFyKFwiYXNzb3phcnRlblwiKTtcclxuXHQvLyBEYXRlbiBmw7xyIGRpZSBhc3NvemFydGVuIGF1cyBkZXIgREIgaG9sZW5cclxuXHR2YXIgZ2V0QXNzb3phcnRlbiA9ICQuYWpheCh7XHJcbiAgICAgICAgICAgIHR5cGU6ICdnZXQnLFxyXG4gICAgICAgICAgICB1cmw6ICdhcD0nICsgbG9jYWxTdG9yYWdlLmFwX2lkICsgJy9hc3NvemFydD0nICsgbG9jYWxTdG9yYWdlLmFzc296YXJ0ZW5faWQsXHJcbiAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbidcclxuICAgICAgICB9KSxcclxuICAgICAgICAkQWFTaXNmTnIgPSAkKFwiI0FhU2lzZk5yXCIpO1xyXG5cdGdldEFzc296YXJ0ZW4uYWx3YXlzKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdC8vIFLDvGNrZ2FiZXdlcnQgbnVsbCB3aXJkIG9mZmVuYmFyIGF1Y2ggYWxzIHN1Y2Nlc3MgZ2V3ZXJ0ZXQsIGdpYnQgd2VpdGVyIHVudGVuIEZlaGxlciwgYWxzbyBBdXNmw7xocnVuZyB2ZXJoaW5kZXJuXHJcblx0XHRpZiAoZGF0YSAmJiBkYXRhLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0Ly8gYXNzb3phcnRlbiBiZXJlaXRzdGVsbGVuXHJcblx0XHRcdHdpbmRvdy5hcGYuYXNzb3phcnRlbiA9IGRhdGFbMF07XHJcblx0XHRcdC8vIEZlbGRlciBtaXQgRGF0ZW4gYmVsaWVmZXJuXHJcbiAgICAgICAgICAgICRBYVNpc2ZOci52YWwoZGF0YVswXS5BYVNpc2ZOcik7XHJcblx0XHRcdCQoXCIjQWFCZW1cIikudmFsKGRhdGFbMF0uQWFCZW0pO1xyXG5cdFx0XHQvLyBGb3JtdWxhcmUgYmxlbmRlblxyXG5cdFx0XHR3aW5kb3cuYXBmLnplaWdlRm9ybXVsYXIoXCJhc3NvemFydGVuXCIpO1xyXG5cdFx0XHRoaXN0b3J5LnJlcGxhY2VTdGF0ZSh7YXNzb3phcnRlbjogXCJhc3NvemFydGVuXCJ9LCBcImFzc296YXJ0ZW5cIiwgXCJpbmRleC5odG1sP2FwPVwiICsgbG9jYWxTdG9yYWdlLmFwX2lkICsgXCImYXNzb3phcnRlbj1cIiArIGxvY2FsU3RvcmFnZS5hc3NvemFydGVuX2lkKTtcclxuXHRcdFx0Ly8gYmVpIG5ldWVuIERhdGVuc8OkdHplbiBGb2t1cyBzdGV1ZXJuXHJcblx0XHRcdGlmICghJEFhU2lzZk5yLnZhbCgpKSB7XHJcbiAgICAgICAgICAgICAgICAkQWFTaXNmTnIuZm9jdXMoKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0pO1xyXG59O1xyXG5cclxuLy8gc2V0enQgd2luZG93LmFwZi5hc3NvemFydGVuIHVuZCBsb2NhbFN0b3JhZ2UuYXNzb3phcnRlbl9pZFxyXG4vLyB3aXJkIGJlbsO2dGlndCwgd2VubiBiZWltIEFwcC1TdGFydCBkaXJla3QgZWluIGRlZXAgbGluayBnZcO2ZmZuZXQgd2lyZFxyXG53aW5kb3cuYXBmLnNldHplV2luZG93QXNzb3phcnRlbiA9IGZ1bmN0aW9uKGlkKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS5hc3NvemFydGVuX2lkID0gaWQ7XHJcblx0dmFyIGdldEFzc296YXJ0ZW4gPSAkLmFqYXgoe1xyXG5cdFx0dHlwZTogJ2dldCcsXHJcblx0XHR1cmw6ICdhcD0nICsgbG9jYWxTdG9yYWdlLmFwX2lkICsgJy9hc3NvemFydD0nICsgbG9jYWxTdG9yYWdlLmFzc296YXJ0ZW5faWQsXHJcblx0XHRkYXRhVHlwZTogJ2pzb24nXHJcblx0fSk7XHJcblx0Z2V0QXNzb3phcnRlbi5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0Ly8gUsO8Y2tnYWJld2VydCBudWxsIHdpcmQgb2ZmZW5iYXIgYXVjaCBhbHMgc3VjY2VzcyBnZXdlcnRldCwgZ2lidCB3ZWl0ZXIgdW50ZW4gRmVobGVyLCBhbHNvIEF1c2bDvGhydW5nIHZlcmhpbmRlcm5cclxuXHRcdGlmIChkYXRhKSB7XHJcblx0XHRcdC8vIGFzc296YXJ0ZW4gYmVyZWl0c3RlbGxlblxyXG5cdFx0XHR3aW5kb3cuYXBmLmFzc296YXJ0ZW4gPSBkYXRhO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59O1xyXG5cclxud2luZG93LmFwZi5pbml0aWllcmVfcG9wbWFzc25iZXIgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0aWYgKCFsb2NhbFN0b3JhZ2UucG9wbWFzc25iZXJfaWQpIHtcclxuXHRcdC8vIGVzIGZlaGxlbiBiZW7DtnRpZ3RlIERhdGVuID4gZWluZSBFYmVuZSBow7ZoZXJcclxuXHRcdHdpbmRvdy5hcGYuaW5pdGlpZXJlX3BvcCgpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHQvLyBGZWxkZXIgenVyw7xja3NldHplblxyXG5cdHdpbmRvdy5hcGYubGVlcmVGZWxkZXJWb25Gb3JtdWxhcihcInBvcG1hc3NuYmVyXCIpO1xyXG5cdC8vIERhdGVuIGbDvHIgZGllIHBvcCBhdXMgZGVyIERCIGhvbGVuXHJcblx0dmFyIGdldFBvcG1hc3NuYmVyID0gJC5hamF4KHtcclxuXHRcdHR5cGU6ICdnZXQnLFxyXG5cdFx0dXJsOiAncGhwL3BvcG1hc3NuYmVyLnBocCcsXHJcblx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0ZGF0YToge1xyXG5cdFx0XHRcImlkXCI6IGxvY2FsU3RvcmFnZS5wb3BtYXNzbmJlcl9pZFxyXG5cdFx0fVxyXG5cdH0pO1xyXG5cdGdldFBvcG1hc3NuYmVyLmFsd2F5cyhmdW5jdGlvbihkYXRhKSB7XHJcblx0XHQvLyBSw7xja2dhYmV3ZXJ0IG51bGwgd2lyZCBvZmZlbmJhciBhdWNoIGFscyBzdWNjZXNzIGdld2VydGV0LCBnaWJ0IHdlaXRlciB1bnRlbiBGZWhsZXIsIGFsc28gQXVzZsO8aHJ1bmcgdmVyaGluZGVyblxyXG5cdFx0aWYgKGRhdGEpIHtcclxuXHRcdFx0Ly8gcG9wbWFzc25iZXIgYmVyZWl0c3RlbGxlblxyXG5cdFx0XHR3aW5kb3cuYXBmLnBvcG1hc3NuYmVyID0gZGF0YTtcclxuXHRcdFx0Ly8gRmVsZGVyIG1pdCBEYXRlbiBiZWxpZWZlcm5cclxuXHRcdFx0JChcIiNQb3BNYXNzbkJlckphaHJcIikudmFsKGRhdGEuUG9wTWFzc25CZXJKYWhyKTtcclxuXHRcdFx0JChcIiNQb3BNYXNzbkJlckVyZm9sZ3NiZXVydGVpbHVuZ1wiICsgZGF0YS5Qb3BNYXNzbkJlckVyZm9sZ3NiZXVydGVpbHVuZykucHJvcChcImNoZWNrZWRcIiwgdHJ1ZSk7XHJcblx0XHRcdCQoXCIjUG9wTWFzc25CZXJUeHRcIikudmFsKGRhdGEuUG9wTWFzc25CZXJUeHQpO1xyXG5cdFx0XHQvLyBGb3JtdWxhcmUgYmxlbmRlblxyXG5cdFx0XHR3aW5kb3cuYXBmLnplaWdlRm9ybXVsYXIoXCJwb3BtYXNzbmJlclwiKTtcclxuXHRcdFx0aGlzdG9yeS5yZXBsYWNlU3RhdGUoe3BvcG1hc3NuYmVyOiBcInBvcG1hc3NuYmVyXCJ9LCBcInBvcG1hc3NuYmVyXCIsIFwiaW5kZXguaHRtbD9hcD1cIiArIGxvY2FsU3RvcmFnZS5hcF9pZCArIFwiJnBvcD1cIiArIGxvY2FsU3RvcmFnZS5wb3BfaWQgKyBcIiZwb3BtYXNzbmJlcj1cIiArIGxvY2FsU3RvcmFnZS5wb3BtYXNzbmJlcl9pZCk7XHJcblx0XHRcdC8vIGJlaSBuZXVlbiBEYXRlbnPDpHR6ZW4gRm9rdXMgc3RldWVyblxyXG5cdFx0XHQkKCcjUG9wTWFzc25CZXJKYWhyJykuZm9jdXMoKTtcclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbi8vIHNldHp0IHdpbmRvdy5hcGYucG9wbWFzc25iZXIgdW5kIGxvY2FsU3RvcmFnZS5wb3BtYXNzbmJlcl9pZFxyXG4vLyB3aXJkIGJlbsO2dGlndCwgd2VubiBiZWltIEFwcC1TdGFydCBkaXJla3QgZWluIGRlZXAgbGluayBnZcO2ZmZuZXQgd2lyZFxyXG53aW5kb3cuYXBmLnNldHplV2luZG93UG9wbWFzc25iZXIgPSBmdW5jdGlvbihpZCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UucG9wbWFzc25iZXJfaWQgPSBpZDtcclxuXHR2YXIgZ2V0UG9wbWFzc25iZXIgPSAkLmFqYXgoe1xyXG5cdFx0dHlwZTogJ2dldCcsXHJcblx0XHR1cmw6ICdwaHAvcG9wbWFzc25iZXIucGhwJyxcclxuXHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRkYXRhOiB7XHJcblx0XHRcdFwiaWRcIjogbG9jYWxTdG9yYWdlLnBvcG1hc3NuYmVyX2lkXHJcblx0XHR9XHJcblx0fSk7XHJcblx0Z2V0UG9wbWFzc25iZXIuYWx3YXlzKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdC8vIFLDvGNrZ2FiZXdlcnQgbnVsbCB3aXJkIG9mZmVuYmFyIGF1Y2ggYWxzIHN1Y2Nlc3MgZ2V3ZXJ0ZXQsIGdpYnQgd2VpdGVyIHVudGVuIEZlaGxlciwgYWxzbyBBdXNmw7xocnVuZyB2ZXJoaW5kZXJuXHJcblx0XHRpZiAoZGF0YSkge1xyXG5cdFx0XHQvLyBwb3BtYXNzbmJlciBiZXJlaXRzdGVsbGVuXHJcblx0XHRcdHdpbmRvdy5hcGYucG9wbWFzc25iZXIgPSBkYXRhO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59O1xyXG5cclxud2luZG93LmFwZi5pbml0aWllcmVfdHBvcCA9IGZ1bmN0aW9uKG9obmVfenVfemVpZ2VuKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciAkVFBvcEZsdXJuYW1lID0gJChcIiNUUG9wRmx1cm5hbWVcIik7XHJcblx0aWYgKCFsb2NhbFN0b3JhZ2UudHBvcF9pZCkge1xyXG5cdFx0Ly8gZXMgZmVobGVuIGJlbsO2dGlndGUgRGF0ZW4gPiBlaW5lIEViZW5lIGjDtmhlclxyXG5cdFx0d2luZG93LmFwZi5pbml0aWllcmVfcG9wKCk7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cdC8vIEZlbGRlciB6dXLDvGNrc2V0emVuXHJcblx0d2luZG93LmFwZi5sZWVyZUZlbGRlclZvbkZvcm11bGFyKFwidHBvcFwiKTtcclxuXHQvLyBEYXRlbiBmw7xyIGRpZSBwb3AgYXVzIGRlciBEQiBob2xlblxyXG5cdHZhciBnZXRUUG9wID0gJC5hamF4KHtcclxuICAgICAgICB0eXBlOiAnZ2V0JyxcclxuICAgICAgICB1cmw6ICdwaHAvdHBvcC5waHAnLFxyXG4gICAgICAgIGRhdGFUeXBlOiAnanNvbicsXHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICBcImlkXCI6IGxvY2FsU3RvcmFnZS50cG9wX2lkXHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblx0Z2V0VFBvcC5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0Ly8gUsO8Y2tnYWJld2VydCBudWxsIHdpcmQgb2ZmZW5iYXIgYXVjaCBhbHMgc3VjY2VzcyBnZXdlcnRldCwgZ2lidCB3ZWl0ZXIgdW50ZW4gRmVobGVyLCBhbHNvIEF1c2bDvGhydW5nIHZlcmhpbmRlcm5cclxuXHRcdGlmIChkYXRhKSB7XHJcblx0XHRcdC8vIHRwb3AgYmVyZWl0c3RlbGxlblxyXG5cdFx0XHR3aW5kb3cuYXBmLnRwb3AgPSBkYXRhO1xyXG5cdFx0XHQvLyBGZWxkZXIgbWl0IERhdGVuIGJlbGllZmVyblxyXG4gICAgICAgICAgICAkVFBvcEZsdXJuYW1lXHJcbiAgICAgICAgICAgICAgICAudmFsKGRhdGEuVFBvcEZsdXJuYW1lKVxyXG4gICAgICAgICAgICAgICAgLmxpbWl0ZXIoMjU1LCAkKFwiI1RQb3BGbHVybmFtZV9saW1pdFwiKSk7XHJcblx0XHRcdCQoXCIjVFBvcE5yXCIpLnZhbChkYXRhLlRQb3BOcik7XHJcblx0XHRcdCQoXCIjVFBvcEhlcmt1bmZ0XCIgKyBkYXRhLlRQb3BIZXJrdW5mdCkucHJvcChcImNoZWNrZWRcIiwgdHJ1ZSk7XHJcblx0XHRcdGlmIChkYXRhLlRQb3BIZXJrdW5mdFVua2xhciA9PSAxKSB7XHJcblx0XHRcdFx0JChcIiNUUG9wSGVya3VuZnRVbmtsYXJcIikucHJvcChcImNoZWNrZWRcIiwgdHJ1ZSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0JChcIiNUUG9wSGVya3VuZnRVbmtsYXJcIikucHJvcChcImNoZWNrZWRcIiwgZmFsc2UpO1xyXG5cdFx0XHR9XHJcblx0XHRcdCQoXCIjVFBvcEhlcmt1bmZ0VW5rbGFyQmVncnVlbmR1bmdcIilcclxuICAgICAgICAgICAgICAgIC52YWwoZGF0YS5UUG9wSGVya3VuZnRVbmtsYXJCZWdydWVuZHVuZylcclxuICAgICAgICAgICAgICAgIC5saW1pdGVyKDI1NSwgJChcIiNUUG9wSGVya3VuZnRVbmtsYXJCZWdydWVuZHVuZ19saW1pdFwiKSk7XHJcblx0XHRcdCQoXCIjVFBvcEFwQmVyaWNodFJlbGV2YW50XCIgKyBkYXRhLlRQb3BBcEJlcmljaHRSZWxldmFudCkucHJvcChcImNoZWNrZWRcIiwgdHJ1ZSk7XHJcblx0XHRcdCQoXCIjVFBvcEJla2FubnRTZWl0XCIpLnZhbChkYXRhLlRQb3BCZWthbm50U2VpdCk7XHJcblx0XHRcdCQoXCIjVFBvcEdlbWVpbmRlXCIpXHJcbiAgICAgICAgICAgICAgICAudmFsKGRhdGEuVFBvcEdlbWVpbmRlKVxyXG4gICAgICAgICAgICAgICAgLmxpbWl0ZXIoMjU1LCAkKFwiI1RQb3BHZW1laW5kZV9saW1pdFwiKSk7XHJcblx0XHRcdCQoXCIjVFBvcFhLb29yZFwiKS52YWwoZGF0YS5UUG9wWEtvb3JkKTtcclxuXHRcdFx0JChcIiNUUG9wWUtvb3JkXCIpLnZhbChkYXRhLlRQb3BZS29vcmQpO1xyXG5cdFx0XHQkKFwiI1RQb3BSYWRpdXNcIikudmFsKGRhdGEuVFBvcFJhZGl1cyk7XHJcblx0XHRcdCQoXCIjVFBvcEhvZWhlXCIpLnZhbChkYXRhLlRQb3BIb2VoZSk7XHJcblx0XHRcdCQoXCIjVFBvcEV4cG9zaXRpb25cIilcclxuICAgICAgICAgICAgICAgIC52YWwoZGF0YS5UUG9wRXhwb3NpdGlvbilcclxuICAgICAgICAgICAgICAgIC5saW1pdGVyKDUwLCAkKFwiI1RQb3BFeHBvc2l0aW9uX2xpbWl0XCIpKTtcclxuXHRcdFx0JChcIiNUUG9wS2xpbWFcIilcclxuICAgICAgICAgICAgICAgIC52YWwoZGF0YS5UUG9wS2xpbWEpXHJcbiAgICAgICAgICAgICAgICAubGltaXRlcig1MCwgJChcIiNUUG9wS2xpbWFfbGltaXRcIikpO1xyXG5cdFx0XHQkKFwiI1RQb3BOZWlndW5nXCIpXHJcbiAgICAgICAgICAgICAgICAudmFsKGRhdGEuVFBvcE5laWd1bmcpXHJcbiAgICAgICAgICAgICAgICAubGltaXRlcig1MCwgJChcIiNUUG9wTmVpZ3VuZ19saW1pdFwiKSk7XHJcblx0XHRcdCQoXCIjVFBvcEJlc2NoclwiKVxyXG4gICAgICAgICAgICAgICAgLnZhbChkYXRhLlRQb3BCZXNjaHIpXHJcbiAgICAgICAgICAgICAgICAubGltaXRlcigyNTUsICQoXCIjVFBvcEJlc2Nocl9saW1pdFwiKSk7XHJcblx0XHRcdCQoXCIjVFBvcEthdE5yXCIpXHJcbiAgICAgICAgICAgICAgICAudmFsKGRhdGEuVFBvcEthdE5yKVxyXG4gICAgICAgICAgICAgICAgLmxpbWl0ZXIoMjU1LCAkKFwiI1RQb3BLYXROcl9saW1pdFwiKSk7XHJcblx0XHRcdCQoXCIjVFBvcEVpZ2VuXCIpXHJcbiAgICAgICAgICAgICAgICAudmFsKGRhdGEuVFBvcEVpZ2VuKVxyXG4gICAgICAgICAgICAgICAgLmxpbWl0ZXIoMjU1LCAkKFwiI1RQb3BFaWdlbl9saW1pdFwiKSk7XHJcblx0XHRcdCQoXCIjVFBvcEtvbnRha3RcIilcclxuICAgICAgICAgICAgICAgIC52YWwoZGF0YS5UUG9wS29udGFrdClcclxuICAgICAgICAgICAgICAgIC5saW1pdGVyKDI1NSwgJChcIiNUUG9wS29udGFrdF9saW1pdFwiKSk7XHJcblx0XHRcdCQoXCIjVFBvcE51dHp1bmdzem9uZVwiKVxyXG4gICAgICAgICAgICAgICAgLnZhbChkYXRhLlRQb3BOdXR6dW5nc3pvbmUpXHJcbiAgICAgICAgICAgICAgICAubGltaXRlcigyNTUsICQoXCIjVFBvcE51dHp1bmdzem9uZV9saW1pdFwiKSk7XHJcblx0XHRcdCQoXCIjVFBvcEJld2lydHNjaGFmdGVySW5cIilcclxuICAgICAgICAgICAgICAgIC52YWwoZGF0YS5UUG9wQmV3aXJ0c2NoYWZ0ZXJJbilcclxuICAgICAgICAgICAgICAgIC5saW1pdGVyKDI1NSwgJChcIiNUUG9wQmV3aXJ0c2NoYWZ0ZXJJbl9saW1pdFwiKSk7XHJcblx0XHRcdCQoXCIjVFBvcEJld2lydHNjaGFmdHVuZ1wiKVxyXG4gICAgICAgICAgICAgICAgLnZhbChkYXRhLlRQb3BCZXdpcnRzY2hhZnR1bmcpXHJcbiAgICAgICAgICAgICAgICAubGltaXRlcigyNTUsICQoXCIjVFBvcEJld2lydHNjaGFmdHVuZ19saW1pdFwiKSk7XHJcblx0XHRcdCQoXCIjVFBvcFR4dFwiKS52YWwoZGF0YS5UUG9wVHh0KTtcclxuXHRcdFx0Ly8gZsO8ciBzZWxlY3QgRGF0ZW4gaG9sZW4gLSBvZGVyIHZvcmhhbmRlbmUgbnV0emVuXHJcblx0XHRcdGlmICghd2luZG93LmFwZi5hZHJlc3Nlbl9odG1sKSB7XHJcblx0XHRcdFx0dmFyIGdldEFkcmVzc2VuID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdHR5cGU6ICdnZXQnLFxyXG5cdFx0XHRcdFx0dXJsOiAnYXBpL2FkcmVzc2VuJyxcclxuXHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbidcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRnZXRBZHJlc3Nlbi5hbHdheXMoZnVuY3Rpb24oZGF0YTIpIHtcclxuXHRcdFx0XHRcdGlmIChkYXRhMikge1xyXG5cdFx0XHRcdFx0XHQvLyBhZHJlc3NlbiBiZXJlaXRzdGVsbGVuXHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuYWRyZXNzZW4gPSBkYXRhMjtcclxuXHRcdFx0XHRcdFx0bG9jYWxTdG9yYWdlLmFkcmVzc2VuID0gSlNPTi5zdHJpbmdpZnkoZGF0YTIpO1xyXG5cdFx0XHRcdFx0XHQvLyBGZWxkIG1pdCBEYXRlbiBiZWxpZWZlcm5cclxuXHRcdFx0XHRcdFx0dmFyIGh0bWw7XHJcblx0XHRcdFx0XHRcdGh0bWwgPSBcIjxvcHRpb24+PC9vcHRpb24+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF8uZWFjaChkYXRhMiwgZnVuY3Rpb24oYWRyZXNzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbCArPSBcIjxvcHRpb24gdmFsdWU9XFxcIlwiICsgYWRyZXNzZS5pZCArIFwiXFxcIj5cIiArIGFkcmVzc2UuQWRyTmFtZSArIFwiPC9vcHRpb24+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmFkcmVzc2VuX2h0bWwgPSBodG1sO1xyXG5cdFx0XHRcdFx0XHQkKFwiI1RQb3BWZXJhbnR3XCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuaHRtbChodG1sKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnZhbCh3aW5kb3cuYXBmLnRwb3AuVFBvcFZlcmFudHcpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdCQoXCIjVFBvcFZlcmFudHdcIilcclxuICAgICAgICAgICAgICAgICAgICAuaHRtbCh3aW5kb3cuYXBmLmFkcmVzc2VuX2h0bWwpXHJcbiAgICAgICAgICAgICAgICAgICAgLnZhbCh3aW5kb3cuYXBmLnRwb3AuVFBvcFZlcmFudHcpO1xyXG5cdFx0XHR9XHJcblx0XHRcdC8vIEZvcm11bGFyZSBibGVuZGVuXHJcblx0XHRcdC8vIG51ciwgd2VubiBvaG5lX3p1X3plaWdlbiBuaWNodCB0cnVlIGlzdCAodHJ1ZSwgdW0gaW4gZGlhbG9nIGFuenV6ZWlnZW4pXHJcblx0XHRcdGlmICghb2huZV96dV96ZWlnZW4pIHtcclxuXHRcdFx0XHR3aW5kb3cuYXBmLnplaWdlRm9ybXVsYXIoXCJ0cG9wXCIpO1xyXG5cdFx0XHRcdGhpc3RvcnkucmVwbGFjZVN0YXRlKHt0cG9wOiBcInRwb3BcIn0sIFwidHBvcFwiLCBcImluZGV4Lmh0bWw/YXA9XCIgKyBsb2NhbFN0b3JhZ2UuYXBfaWQgKyBcIiZwb3A9XCIgKyBsb2NhbFN0b3JhZ2UucG9wX2lkICsgXCImdHBvcD1cIiArIGxvY2FsU3RvcmFnZS50cG9wX2lkKTtcclxuXHRcdFx0XHQvLyBiZWkgbmV1ZW4gRGF0ZW5zw6R0emVuIEZva3VzIHN0ZXVlcm5cclxuXHRcdFx0XHRpZiAoISRUUG9wRmx1cm5hbWUudmFsKCkpIHtcclxuXHRcdFx0XHRcdCQoJyNUUG9wTnInKS5mb2N1cygpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0pO1xyXG5cdGdldFRQb3AuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdC8vd2luZG93LmFwZi5tZWxkZSgnRmVobGVyOiBrZWluZSBEYXRlbiBmw7xyIGRpZSBUZWlscG9wdWxhdGlvbiBlcmhhbHRlbicpO1xyXG5cdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjoga2VpbmUgRGF0ZW4gZsO8ciBkaWUgVGVpbHBvcHVsYXRpb24gZXJoYWx0ZW4nKTtcclxuXHR9KTtcclxufTtcclxuXHJcbi8vIHNldHp0IHdpbmRvdy5hcGYudHBvcCB1bmQgbG9jYWxTdG9yYWdlLnRwb3BfaWRcclxuLy8gd2lyZCBiZW7DtnRpZ3QsIHdlbm4gYmVpbSBBcHAtU3RhcnQgZGlyZWt0IGVpbiBkZWVwIGxpbmsgZ2XDtmZmbmV0IHdpcmRcclxud2luZG93LmFwZi5zZXR6ZVdpbmRvd1Rwb3AgPSBmdW5jdGlvbihpZCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UudHBvcF9pZCA9IGlkO1xyXG5cdHZhciBnZXRUUG9wID0gJC5hamF4KHtcclxuXHRcdHR5cGU6ICdnZXQnLFxyXG5cdFx0dXJsOiAncGhwL3Rwb3AucGhwJyxcclxuXHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRkYXRhOiB7XHJcblx0XHRcdFwiaWRcIjogbG9jYWxTdG9yYWdlLnRwb3BfaWRcclxuXHRcdH1cclxuXHR9KTtcclxuXHRnZXRUUG9wLmFsd2F5cyhmdW5jdGlvbihkYXRhKSB7XHJcblx0XHQvLyBSw7xja2dhYmV3ZXJ0IG51bGwgd2lyZCBvZmZlbmJhciBhdWNoIGFscyBzdWNjZXNzIGdld2VydGV0LCBnaWJ0IHdlaXRlciB1bnRlbiBGZWhsZXIsIGFsc28gQXVzZsO8aHJ1bmcgdmVyaGluZGVyblxyXG5cdFx0aWYgKGRhdGEpIHtcclxuXHRcdFx0Ly8gdHBvcCBiZXJlaXRzdGVsbGVuXHJcblx0XHRcdHdpbmRvdy5hcGYudHBvcCA9IGRhdGE7XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLmluaXRpaWVyZV9wb3BiZXIgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0aWYgKCFsb2NhbFN0b3JhZ2UucG9wYmVyX2lkKSB7XHJcblx0XHQvLyBlcyBmZWhsZW4gYmVuw7Z0aWd0ZSBEYXRlbiA+IGVpbmUgRWJlbmUgaMO2aGVyXHJcblx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV9wb3AoKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblx0Ly8gRmVsZGVyIHp1csO8Y2tzZXR6ZW5cclxuXHR3aW5kb3cuYXBmLmxlZXJlRmVsZGVyVm9uRm9ybXVsYXIoXCJwb3BiZXJcIik7XHJcblx0Ly8gRGF0ZW4gZsO8ciBkaWUgcG9wYmVyIGF1cyBkZXIgREIgaG9sZW5cclxuXHR2YXIgZ2V0UG9wYmVyID0gJC5hamF4KHtcclxuXHRcdHR5cGU6ICdnZXQnLFxyXG5cdFx0dXJsOiAncGhwL3BvcGJlci5waHAnLFxyXG5cdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdGRhdGE6IHtcclxuXHRcdFx0XCJpZFwiOiBsb2NhbFN0b3JhZ2UucG9wYmVyX2lkXHJcblx0XHR9XHJcblx0fSk7XHJcblx0Z2V0UG9wYmVyLmFsd2F5cyhmdW5jdGlvbihkYXRhKSB7XHJcblx0XHQvLyBSw7xja2dhYmV3ZXJ0IG51bGwgd2lyZCBvZmZlbmJhciBhdWNoIGFscyBzdWNjZXNzIGdld2VydGV0LCBnaWJ0IHdlaXRlciB1bnRlbiBGZWhsZXIsIGFsc28gQXVzZsO8aHJ1bmcgdmVyaGluZGVyblxyXG5cdFx0aWYgKGRhdGEpIHtcclxuXHRcdFx0Ly8gcG9wYmVyIGJlcmVpdHN0ZWxsZW5cclxuXHRcdFx0d2luZG93LmFwZi5wb3BiZXIgPSBkYXRhO1xyXG5cdFx0XHQvLyBGZWxkZXIgbWl0IERhdGVuIGJlbGllZmVyblxyXG5cdFx0XHQkKFwiI1BvcEJlckphaHJcIikudmFsKGRhdGEuUG9wQmVySmFocik7XHJcblx0XHRcdCQoXCIjUG9wQmVyRW50d2lja2x1bmdcIiArIGRhdGEuUG9wQmVyRW50d2lja2x1bmcpLnByb3AoXCJjaGVja2VkXCIsIHRydWUpO1xyXG5cdFx0XHQkKFwiI1BvcEJlclR4dFwiKS52YWwoZGF0YS5Qb3BCZXJUeHQpO1xyXG5cdFx0XHQvLyBGb3JtdWxhcmUgYmxlbmRlblxyXG5cdFx0XHR3aW5kb3cuYXBmLnplaWdlRm9ybXVsYXIoXCJwb3BiZXJcIik7XHJcblx0XHRcdGhpc3RvcnkucmVwbGFjZVN0YXRlKHt0cG9wYmVyOiBcInBvcGJlclwifSwgXCJwb3BiZXJcIiwgXCJpbmRleC5odG1sP2FwPVwiICsgbG9jYWxTdG9yYWdlLmFwX2lkICsgXCImcG9wPVwiICsgbG9jYWxTdG9yYWdlLnBvcF9pZCArIFwiJnBvcGJlcj1cIiArIGxvY2FsU3RvcmFnZS5wb3BiZXJfaWQpO1xyXG5cdFx0XHQvLyBiZWkgbmV1ZW4gRGF0ZW5zw6R0emVuIEZva3VzIHN0ZXVlcm5cclxuXHRcdFx0JCgnI1BvcEJlckphaHInKS5mb2N1cygpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59O1xyXG5cclxuLy8gc2V0enQgd2luZG93LmFwZi5wb3BiZXIgdW5kIGxvY2FsU3RvcmFnZS5wb3BiZXJfaWRcclxuLy8gd2lyZCBiZW7DtnRpZ3QsIHdlbm4gYmVpbSBBcHAtU3RhcnQgZGlyZWt0IGVpbiBkZWVwIGxpbmsgZ2XDtmZmbmV0IHdpcmRcclxud2luZG93LmFwZi5zZXR6ZVdpbmRvd1BvcGJlciA9IGZ1bmN0aW9uKGlkKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS5wb3BiZXJfaWQgPSBpZDtcclxuXHR2YXIgZ2V0UG9wYmVyID0gJC5hamF4KHtcclxuXHRcdHR5cGU6ICdnZXQnLFxyXG5cdFx0dXJsOiAncGhwL3BvcGJlci5waHAnLFxyXG5cdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdGRhdGE6IHtcclxuXHRcdFx0XCJpZFwiOiBsb2NhbFN0b3JhZ2UucG9wYmVyX2lkXHJcblx0XHR9XHJcblx0fSk7XHJcblx0Z2V0UG9wYmVyLmFsd2F5cyhmdW5jdGlvbihkYXRhKSB7XHJcblx0XHQvLyBSw7xja2dhYmV3ZXJ0IG51bGwgd2lyZCBvZmZlbmJhciBhdWNoIGFscyBzdWNjZXNzIGdld2VydGV0LCBnaWJ0IHdlaXRlciB1bnRlbiBGZWhsZXIsIGFsc28gQXVzZsO8aHJ1bmcgdmVyaGluZGVyblxyXG5cdFx0aWYgKGRhdGEpIHtcclxuXHRcdFx0Ly8gcG9wYmVyIGJlcmVpdHN0ZWxsZW5cclxuXHRcdFx0d2luZG93LmFwZi5wb3BiZXIgPSBkYXRhO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59O1xyXG5cclxud2luZG93LmFwZi5pbml0aWllcmVfdHBvcGZlbGRrb250ciA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyB3aXJkIGdlbWVpbnNhbSBmw7xyIEZlbGQtIHVuZCBGcmVpd2lsbGlnZW5rb250cm9sbGVuIHZlcndlbmRldFxyXG5cdC8vIEZlbGRrb250cm9sbGVuOiBGZWxkZXIgZGVyIEZyZWl3aWxsaWdlbmtvbnRyb2xsZW4gYXVzYmxlbmRlblxyXG5cdC8vIEZyZWl3aWxsaWdlbmtvbnRyb2xsZW46IEZlbGRlciBkZXIgRmVsZGtvbnRyb2xsZW4gYXVzYmxlbmVuIHBsdXMgUmVnaXN0ZXIgQmlvdG9wXHJcblx0aWYgKCFsb2NhbFN0b3JhZ2UudHBvcGZlbGRrb250cl9pZCkge1xyXG5cdFx0Ly8gZXMgZmVobGVuIGJlbsO2dGlndGUgRGF0ZW4gPiBlaW5lIEViZW5lIGjDtmhlclxyXG5cdFx0d2luZG93LmFwZi5pbml0aWllcmVfcG9wKCk7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cdC8vIEZlbGRlciB6dXLDvGNrc2V0emVuXHJcblx0d2luZG93LmFwZi5sZWVyZUZlbGRlclZvbkZvcm11bGFyKFwidHBvcGZlbGRrb250clwiKTtcclxuXHQvLyBhbGxlIEZlbGRlciBhdXNibGVuZGVuLiBTcMOkdGVyIHdlcmRlbiBkaWUgYmVuw7Z0aWd0ZW4gZWluZ2VibGVuZGV0XHJcblx0JCgnLmZlbGRfdHBvcGZlbGRrb250cicpLmVhY2goZnVuY3Rpb24oKSB7XHJcblx0XHQkKHRoaXMpLmhpZGUoKTtcclxuXHR9KTtcclxuXHQvLyBEYXRlbiBmw7xyIGRpZSB0cG9wZmVsZGtvbnRyIGF1cyBkZXIgREIgaG9sZW5cclxuXHR2YXIgZ2V0VHBvcGZlbGRrb250ciA9ICQuYWpheCh7XHJcbiAgICAgICAgICAgIHR5cGU6ICdnZXQnLFxyXG4gICAgICAgICAgICB1cmw6ICdwaHAvdHBvcGZlbGRrb250ci5waHAnLFxyXG4gICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nLFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBcImlkXCI6IGxvY2FsU3RvcmFnZS50cG9wZmVsZGtvbnRyX2lkXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KSxcclxuICAgICAgICAkVFBvcEtvbnRySmFociA9ICQoXCIjVFBvcEtvbnRySmFoclwiKSxcclxuICAgICAgICAkVFBvcEtvbnRySnVuZ1BmbEpOX2phID0gJChcIiNUUG9wS29udHJKdW5nUGZsSk5famFcIiksXHJcbiAgICAgICAgJFRQb3BLb250ckp1bmdQZmxKTl9uZWluID0gJChcIiNUUG9wS29udHJKdW5nUGZsSk5fbmVpblwiKSxcclxuICAgICAgICAkVFBvcEtvbnRySnVuZ1BmbEpOX2xlZXIgPSAkKFwiI1RQb3BLb250ckp1bmdQZmxKTl9sZWVyXCIpO1xyXG5cdGdldFRwb3BmZWxka29udHIuYWx3YXlzKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdC8vIFLDvGNrZ2FiZXdlcnQgbnVsbCB3aXJkIG9mZmVuYmFyIGF1Y2ggYWxzIHN1Y2Nlc3MgZ2V3ZXJ0ZXQsIGdpYnQgd2VpdGVyIHVudGVuIEZlaGxlciwgYWxzbyBBdXNmw7xocnVuZyB2ZXJoaW5kZXJuXHJcblx0XHRpZiAoZGF0YSkge1xyXG5cdFx0XHQvLyB0cG9wZmVsZGtvbnRyIGJlcmVpdHN0ZWxsZW5cclxuXHRcdFx0d2luZG93LmFwZi50cG9wZmVsZGtvbnRyID0gZGF0YTtcclxuXHRcdFx0Ly8gZ2VtZWluc2FtZSBGZWxkZXJcclxuXHRcdFx0Ly8gbWl0IERhdGVuIGJlbGllZmVyblxyXG4gICAgICAgICAgICAkVFBvcEtvbnRySmFoci52YWwoZGF0YS5UUG9wS29udHJKYWhyKTtcclxuXHRcdFx0aWYgKGRhdGEuVFBvcEtvbnRyRGF0dW0gIT09IFwiMDEuMDEuMTk3MFwiKSB7XHJcblx0XHRcdFx0Ly8gcGhwIG1hY2h0IGF1cyBlaW5lbSBOdWxsd2VydCBpbSBEYXR1bSBkZW4gMS4xLjE5NzAhISFcclxuXHRcdFx0XHQkKFwiI1RQb3BLb250ckRhdHVtXCIpLnZhbChkYXRhLlRQb3BLb250ckRhdHVtKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQkKFwiI1RQb3BLb250ckRhdHVtXCIpLnZhbChcIlwiKTtcclxuXHRcdFx0fVxyXG5cdFx0XHQkKFwiI1RQb3BLb250ck1ldGhvZGUxXCIgKyBkYXRhLlRQb3BLb250ck1ldGhvZGUxKS5wcm9wKFwiY2hlY2tlZFwiLCB0cnVlKTtcclxuXHRcdFx0JChcIiNUUG9wS29udHJBbnoxXCIpLnZhbChkYXRhLlRQb3BLb250ckFuejEpO1xyXG5cdFx0XHQkKFwiI1RQb3BLb250ck1ldGhvZGUyXCIgKyBkYXRhLlRQb3BLb250ck1ldGhvZGUyKS5wcm9wKFwiY2hlY2tlZFwiLCB0cnVlKTtcclxuXHRcdFx0JChcIiNUUG9wS29udHJBbnoyXCIpLnZhbChkYXRhLlRQb3BLb250ckFuejIpO1xyXG5cdFx0XHQkKFwiI1RQb3BLb250ck1ldGhvZGUzXCIgKyBkYXRhLlRQb3BLb250ck1ldGhvZGUzKS5wcm9wKFwiY2hlY2tlZFwiLCB0cnVlKTtcclxuXHRcdFx0JChcIiNUUG9wS29udHJBbnozXCIpLnZhbChkYXRhLlRQb3BLb250ckFuejMpO1xyXG5cdFx0XHQkKFwiI1RQb3BLb250clR4dFwiKS52YWwoZGF0YS5UUG9wS29udHJUeHQpO1xyXG5cdFx0XHQkKFwiI1RQb3BLb250ckd1aWRcIikudmFsKGRhdGEuVFBvcEtvbnRyR3VpZCk7XHJcblx0XHRcdC8vIFRQb3BLb250ckJlYXJiOiBEYXRlbiBob2xlbiAtIG9kZXIgdm9yaGFuZGVuZSBudXR6ZW5cclxuXHRcdFx0aWYgKCF3aW5kb3cuYXBmLmFkcmVzc2VuX2h0bWwpIHtcclxuXHRcdFx0XHR2YXIgZ2V0QWRyZXNzZW4gPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0dHlwZTogJ2dldCcsXHJcblx0XHRcdFx0XHR1cmw6ICdhcGkvYWRyZXNzZW4nLFxyXG5cdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJ1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdGdldEFkcmVzc2VuLmFsd2F5cyhmdW5jdGlvbihkYXRhMikge1xyXG5cdFx0XHRcdFx0aWYgKGRhdGEyKSB7XHJcblx0XHRcdFx0XHRcdC8vIEZlbGQgbWl0IERhdGVuIGJlbGllZmVyblxyXG5cdFx0XHRcdFx0XHR2YXIgaHRtbDtcclxuXHRcdFx0XHRcdFx0aHRtbCA9IFwiPG9wdGlvbj48L29wdGlvbj5cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXy5lYWNoKGRhdGEyLCBmdW5jdGlvbihhZHJlc3NlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9IFwiPG9wdGlvbiB2YWx1ZT1cXFwiXCIgKyBhZHJlc3NlLmlkICsgXCJcXFwiPlwiICsgYWRyZXNzZS5BZHJOYW1lICsgXCI8L29wdGlvbj5cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuYWRyZXNzZW5faHRtbCA9IGh0bWw7XHJcblx0XHRcdFx0XHRcdCQoXCIjVFBvcEtvbnRyQmVhcmJcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5odG1sKGh0bWwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudmFsKHdpbmRvdy5hcGYudHBvcGZlbGRrb250ci5UUG9wS29udHJCZWFyYik7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0JChcIiNUUG9wS29udHJCZWFyYlwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5odG1sKHdpbmRvdy5hcGYuYWRyZXNzZW5faHRtbClcclxuICAgICAgICAgICAgICAgICAgICAudmFsKHdpbmRvdy5hcGYudHBvcGZlbGRrb250ci5UUG9wS29udHJCZWFyYik7XHJcblx0XHRcdH1cclxuXHRcdFx0Ly8gZsO8ciAzIHNlbGVjdGZlbGRlciBUUG9wS29udHJaYWVobGVpbmhlaXQgRGF0ZW4gaG9sZW4gLSBvZGVyIHZvcmhhbmRlbmUgbnV0emVuXHJcblx0XHRcdGlmICghd2luZG93LmFwZi5UUG9wS29udHJaw6RobGVpbmhlaXRfaHRtbCkge1xyXG5cdFx0XHRcdHZhciBnZXRUcG9wZmVsZGtvbnRyWmFlaGxlaW5oZWl0ID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdHR5cGU6ICdnZXQnLFxyXG5cdFx0XHRcdFx0dXJsOiAncGhwL3Rwb3BmZWxka29udHJfemFlaGxlaW5oZWl0LnBocCcsXHJcblx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nXHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0Z2V0VHBvcGZlbGRrb250clphZWhsZWluaGVpdC5hbHdheXMoZnVuY3Rpb24oZGF0YTMpIHtcclxuXHRcdFx0XHRcdGlmIChkYXRhMykge1xyXG5cdFx0XHRcdFx0XHQvLyBGZWxkIG1pdCBEYXRlbiBiZWxpZWZlcm5cclxuXHRcdFx0XHRcdFx0dmFyIGh0bWw7XHJcblx0XHRcdFx0XHRcdGh0bWwgPSBcIjxvcHRpb24+PC9vcHRpb24+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF8uZWFjaChkYXRhMy5yb3dzLCBmdW5jdGlvbih6w6RobGVpbmhlaXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gXCI8b3B0aW9uIHZhbHVlPVxcXCJcIiArIHrDpGhsZWluaGVpdC5pZCArIFwiXFxcIj5cIiArIHrDpGhsZWluaGVpdC5aYWVobGVpbmhlaXRUeHQgKyBcIjwvb3B0aW9uPlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi5UUG9wS29udHJaw6RobGVpbmhlaXRfaHRtbCA9IGh0bWw7XHJcblx0XHRcdFx0XHRcdC8vIGFsbGUgMyBGZWxkZXIgc2V0emVuXHJcblx0XHRcdFx0XHRcdCQoXCIjVFBvcEtvbnRyWmFlaGxlaW5oZWl0MVwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmh0bWwoaHRtbClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC52YWwod2luZG93LmFwZi50cG9wZmVsZGtvbnRyLlRQb3BLb250clphZWhsZWluaGVpdDEpO1xyXG5cdFx0XHRcdFx0XHQkKFwiI1RQb3BLb250clphZWhsZWluaGVpdDJcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5odG1sKGh0bWwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudmFsKHdpbmRvdy5hcGYudHBvcGZlbGRrb250ci5UUG9wS29udHJaYWVobGVpbmhlaXQyKTtcclxuXHRcdFx0XHRcdFx0JChcIiNUUG9wS29udHJaYWVobGVpbmhlaXQzXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuaHRtbChodG1sKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnZhbCh3aW5kb3cuYXBmLnRwb3BmZWxka29udHIuVFBvcEtvbnRyWmFlaGxlaW5oZWl0Myk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Ly8gYWxsZSAzIEZlbGRlciBzZXR6ZW5cclxuXHRcdFx0XHQkKFwiI1RQb3BLb250clphZWhsZWluaGVpdDFcIilcclxuICAgICAgICAgICAgICAgICAgICAuaHRtbCh3aW5kb3cuYXBmLlRQb3BLb250clrDpGhsZWluaGVpdF9odG1sKVxyXG4gICAgICAgICAgICAgICAgICAgIC52YWwod2luZG93LmFwZi50cG9wZmVsZGtvbnRyLlRQb3BLb250clphZWhsZWluaGVpdDEpO1xyXG5cdFx0XHRcdCQoXCIjVFBvcEtvbnRyWmFlaGxlaW5oZWl0MlwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5odG1sKHdpbmRvdy5hcGYuVFBvcEtvbnRyWsOkaGxlaW5oZWl0X2h0bWwpXHJcbiAgICAgICAgICAgICAgICAgICAgLnZhbCh3aW5kb3cuYXBmLnRwb3BmZWxka29udHIuVFBvcEtvbnRyWmFlaGxlaW5oZWl0Mik7XHJcblx0XHRcdFx0JChcIiNUUG9wS29udHJaYWVobGVpbmhlaXQzXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLmh0bWwod2luZG93LmFwZi5UUG9wS29udHJaw6RobGVpbmhlaXRfaHRtbClcclxuICAgICAgICAgICAgICAgICAgICAudmFsKHdpbmRvdy5hcGYudHBvcGZlbGRrb250ci5UUG9wS29udHJaYWVobGVpbmhlaXQzKTtcclxuXHRcdFx0fVxyXG5cdFx0XHQvLyBGZWxkZXIsIGRpZSBudXIgaW4gZGVyIEZlbGRrb250cm9sbGUgdm9ya29tbWVuXHJcblx0XHRcdGlmICghbG9jYWxTdG9yYWdlLnRwb3BmcmVpd2tvbnRyKSB7XHJcblx0XHRcdFx0JChcIiNUUG9wS29udHJUeXBcIiArIGRhdGEuVFBvcEtvbnRyVHlwKS5wcm9wKFwiY2hlY2tlZFwiLCB0cnVlKTtcclxuXHRcdFx0XHQkKFwiI1RQb3BLb250ckp1bmdwZmxcIikudmFsKGRhdGEuVFBvcEtvbnRySnVuZ3BmbCk7XHJcblx0XHRcdFx0JChcIiNUUG9wS29udHJWaXRhbGl0YWV0XCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnZhbChkYXRhLlRQb3BLb250clZpdGFsaXRhZXQpXHJcbiAgICAgICAgICAgICAgICAgICAgLmxpbWl0ZXIoMjU1LCAkKFwiI1RQb3BLb250clZpdGFsaXRhZXRfbGltaXRcIikpO1xyXG5cdFx0XHRcdCQoXCIjVFBvcEtvbnRyVWViZXJsZWJcIikudmFsKGRhdGEuVFBvcEtvbnRyVWViZXJsZWIpO1xyXG5cdFx0XHRcdCQoXCIjVFBvcEtvbnRyRW50d2lja2x1bmdcIiArIGRhdGEuVFBvcEtvbnRyRW50d2lja2x1bmcpLnByb3AoXCJjaGVja2VkXCIsIHRydWUpO1xyXG5cdFx0XHRcdCQoXCIjVFBvcEtvbnRyVXJzYWNoXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnZhbChkYXRhLlRQb3BLb250clVyc2FjaClcclxuICAgICAgICAgICAgICAgICAgICAubGltaXRlcigyNTUsICQoXCIjVFBvcEtvbnRyVXJzYWNoX2xpbWl0XCIpKTtcclxuXHRcdFx0XHQkKFwiI1RQb3BLb250clVydGVpbFwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC52YWwoZGF0YS5UUG9wS29udHJVcnRlaWwpXHJcbiAgICAgICAgICAgICAgICAgICAgLmxpbWl0ZXIoMjU1LCAkKFwiI1RQb3BLb250clVydGVpbF9saW1pdFwiKSk7XHJcblx0XHRcdFx0JChcIiNUUG9wS29udHJBZW5kVW1zXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnZhbChkYXRhLlRQb3BLb250ckFlbmRVbXMpXHJcbiAgICAgICAgICAgICAgICAgICAgLmxpbWl0ZXIoMjU1LCAkKFwiI1RQb3BLb250ckFlbmRVbXNfbGltaXRcIikpO1xyXG5cdFx0XHRcdCQoXCIjVFBvcEtvbnRyQWVuZEtvbnRyXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnZhbChkYXRhLlRQb3BLb250ckFlbmRLb250cilcclxuICAgICAgICAgICAgICAgICAgICAubGltaXRlcigyNTUsICQoXCIjVFBvcEtvbnRyQWVuZEtvbnRyX2xpbWl0XCIpKTtcclxuXHRcdFx0XHQvLyBCaW90b3BcclxuXHRcdFx0XHQkKFwiI1RQb3BLb250ckZsYWVjaGVcIikudmFsKGRhdGEuVFBvcEtvbnRyRmxhZWNoZSk7XHJcblx0XHRcdFx0JChcIiNUUG9wS29udHJWZWdUeXBcIilcclxuICAgICAgICAgICAgICAgICAgICAudmFsKGRhdGEuVFBvcEtvbnRyVmVnVHlwKVxyXG4gICAgICAgICAgICAgICAgICAgIC5saW1pdGVyKDEwMCwgJChcIiNUUG9wS29udHJWZWdUeXBfbGltaXRcIikpO1xyXG5cdFx0XHRcdCQoXCIjVFBvcEtvbnRyS29ua3VycmVuelwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC52YWwoZGF0YS5UUG9wS29udHJLb25rdXJyZW56KVxyXG4gICAgICAgICAgICAgICAgICAgIC5saW1pdGVyKDEwMCwgJChcIiNUUG9wS29udHJLb25rdXJyZW56X2xpbWl0XCIpKTtcclxuXHRcdFx0XHQkKFwiI1RQb3BLb250ck1vb3NzY2hpY2h0XCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnZhbChkYXRhLlRQb3BLb250ck1vb3NzY2hpY2h0KVxyXG4gICAgICAgICAgICAgICAgICAgIC5saW1pdGVyKDEwMCwgJChcIiNUUG9wS29udHJNb29zc2NoaWNodF9saW1pdFwiKSk7XHJcblx0XHRcdFx0JChcIiNUUG9wS29udHJLcmF1dHNjaGljaHRcIilcclxuICAgICAgICAgICAgICAgICAgICAudmFsKGRhdGEuVFBvcEtvbnRyS3JhdXRzY2hpY2h0KVxyXG4gICAgICAgICAgICAgICAgICAgIC5saW1pdGVyKDEwMCwgJChcIiNUUG9wS29udHJLcmF1dHNjaGljaHRfbGltaXRcIikpO1xyXG5cdFx0XHRcdCQoXCIjVFBvcEtvbnRyU3RyYXVjaHNjaGljaHRcIilcclxuICAgICAgICAgICAgICAgICAgICAudmFsKGRhdGEuVFBvcEtvbnRyU3RyYXVjaHNjaGljaHQpXHJcbiAgICAgICAgICAgICAgICAgICAgLmxpbWl0ZXIoMjU1LCAkKFwiI1RQb3BLb250clN0cmF1Y2hzY2hpY2h0X2xpbWl0XCIpKTtcclxuXHRcdFx0XHQkKFwiI1RQb3BLb250ckJhdW1zY2hpY2h0XCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnZhbChkYXRhLlRQb3BLb250ckJhdW1zY2hpY2h0KVxyXG4gICAgICAgICAgICAgICAgICAgIC5saW1pdGVyKDEwMCwgJChcIiNUUG9wS29udHJCYXVtc2NoaWNodF9saW1pdFwiKSk7XHJcblx0XHRcdFx0JChcIiNUUG9wS29udHJCb2RlblR5cFwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC52YWwoZGF0YS5UUG9wS29udHJCb2RlblR5cClcclxuICAgICAgICAgICAgICAgICAgICAubGltaXRlcigyNTUsICQoXCIjVFBvcEtvbnRyQm9kZW5UeXBfbGltaXRcIikpO1xyXG5cdFx0XHRcdCQoXCIjVFBvcEtvbnRyQm9kZW5LYWxrZ2VoYWx0XCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnZhbChkYXRhLlRQb3BLb250ckJvZGVuS2Fsa2dlaGFsdClcclxuICAgICAgICAgICAgICAgICAgICAubGltaXRlcigxMDAsICQoXCIjVFBvcEtvbnRyQm9kZW5LYWxrZ2VoYWx0X2xpbWl0XCIpKTtcclxuXHRcdFx0XHQkKFwiI1RQb3BLb250ckJvZGVuRHVyY2hsYWVzc2lna2VpdFwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC52YWwoZGF0YS5UUG9wS29udHJCb2RlbkR1cmNobGFlc3NpZ2tlaXQpXHJcbiAgICAgICAgICAgICAgICAgICAgLmxpbWl0ZXIoMTAwLCAkKFwiI1RQb3BLb250ckJvZGVuRHVyY2hsYWVzc2lna2VpdF9saW1pdFwiKSk7XHJcblx0XHRcdFx0JChcIiNUUG9wS29udHJCb2Rlbkh1bXVzXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnZhbChkYXRhLlRQb3BLb250ckJvZGVuSHVtdXMpXHJcbiAgICAgICAgICAgICAgICAgICAgLmxpbWl0ZXIoMTAwLCAkKFwiI1RQb3BLb250ckJvZGVuSHVtdXNfbGltaXRcIikpO1xyXG5cdFx0XHRcdCQoXCIjVFBvcEtvbnRyQm9kZW5OYWVocnN0b2ZmZ2VoYWx0XCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnZhbChkYXRhLlRQb3BLb250ckJvZGVuTmFlaHJzdG9mZmdlaGFsdClcclxuICAgICAgICAgICAgICAgICAgICAubGltaXRlcigxMDAsICQoXCIjVFBvcEtvbnRyQm9kZW5OYWVocnN0b2ZmZ2VoYWx0X2xpbWl0XCIpKTtcclxuXHRcdFx0XHQkKFwiI1RQb3BLb250ckJvZGVuQWJ0cmFnXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnZhbChkYXRhLlRQb3BLb250ckJvZGVuQWJ0cmFnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5saW1pdGVyKDI1NSwgJChcIiNUUG9wS29udHJCb2RlbkFidHJhZ19saW1pdFwiKSk7XHJcblx0XHRcdFx0JChcIiNUUG9wS29udHJXYXNzZXJoYXVzaGFsdFwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC52YWwoZGF0YS5UUG9wS29udHJXYXNzZXJoYXVzaGFsdClcclxuICAgICAgICAgICAgICAgICAgICAubGltaXRlcigyNTUsICQoXCIjVFBvcEtvbnRyV2Fzc2VyaGF1c2hhbHRfbGltaXRcIikpO1xyXG5cdFx0XHRcdCQoXCIjVFBvcEtvbnRySGFuZGx1bmdzYmVkYXJmXCIpLnZhbChkYXRhLlRQb3BLb250ckhhbmRsdW5nc2JlZGFyZik7XHJcblx0XHRcdFx0JChcIiNUUG9wS29udHJJZGVhbEJpb3RvcFVlYmVyZWluc3RcIiArIGRhdGEuVFBvcEtvbnRySWRlYWxCaW90b3BVZWJlcmVpbnN0KS5wcm9wKFwiY2hlY2tlZFwiLCB0cnVlKTtcclxuXHRcdFx0XHQvLyBUUG9wS29udHJMZWI6IERhdGVuIGhvbGVuIC0gb2RlciB2b3JoYW5kZW5lIG51dHplblxyXG5cdFx0XHRcdGlmICghd2luZG93LmFwZi5scmRlbGFyemVfaHRtbCkge1xyXG5cdFx0XHRcdFx0dmFyIGdldExyRGVsYXJ6ZSA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHRcdHR5cGU6ICdnZXQnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvbHJkZWxhcnplLnBocCcsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbidcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Z2V0THJEZWxhcnplLmFsd2F5cyhmdW5jdGlvbihkYXRhNCkge1xyXG5cdFx0XHRcdFx0XHRpZiAoZGF0YTQpIHtcclxuXHRcdFx0XHRcdFx0XHQvLyBGZWxkIG1pdCBEYXRlbiBiZWxpZWZlcm5cclxuXHRcdFx0XHRcdFx0XHR2YXIgaHRtbDtcclxuXHRcdFx0XHRcdFx0XHRodG1sID0gXCI8b3B0aW9uPjwvb3B0aW9uPlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5lYWNoKGRhdGE0LnJvd3MsIGZ1bmN0aW9uKGxyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbCArPSBcIjxvcHRpb24gdmFsdWU9XFxcIlwiICsgbHIuaWQgKyBcIlxcXCI+XCIgKyBsci5FaW5oZWl0ICsgXCI8L29wdGlvbj5cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYubHJkZWxhcnplX2h0bWwgPSBodG1sO1xyXG5cdFx0XHRcdFx0XHRcdCQoXCIjVFBvcEtvbnRyTGViXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmh0bWwoaHRtbClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudmFsKHdpbmRvdy5hcGYudHBvcGZlbGRrb250ci5UUG9wS29udHJMZWIpO1xyXG5cdFx0XHRcdFx0XHRcdCQoXCIjVFBvcEtvbnRyTGViVW1nXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmh0bWwoaHRtbClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudmFsKHdpbmRvdy5hcGYudHBvcGZlbGRrb250ci5UUG9wS29udHJMZWJVbWcpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0JChcIiNUUG9wS29udHJMZWJcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmh0bWwod2luZG93LmFwZi5scmRlbGFyemVfaHRtbClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnZhbCh3aW5kb3cuYXBmLnRwb3BmZWxka29udHIuVFBvcEtvbnRyTGViKTtcclxuXHRcdFx0XHRcdCQoXCIjVFBvcEtvbnRyTGViVW1nXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5odG1sKHdpbmRvdy5hcGYubHJkZWxhcnplX2h0bWwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC52YWwod2luZG93LmFwZi50cG9wZmVsZGtvbnRyLlRQb3BLb250ckxlYlVtZyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdC8vIFRQb3BLb250cklkZWFsQmlvdG9wVWViZXJlaW5zdDogRGF0ZW4gaG9sZW4gLSBvZGVyIHZvcmhhbmRlbmUgbnV0emVuXHJcblx0XHRcdGlmICghd2luZG93LmFwZi5JZGVhbEJpb3RvcMOcYmVyZWluc3RfaHRtbCkge1xyXG5cdFx0XHRcdHZhciBnZXRJZGVhbGJpb3RvcMO8YmVyZWluc3QgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0dHlwZTogJ2dldCcsXHJcblx0XHRcdFx0XHR1cmw6ICdwaHAvaWRlYWxiaW90b3B1ZWJlcmVpbnN0LnBocCcsXHJcblx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nXHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0Z2V0SWRlYWxiaW90b3DDvGJlcmVpbnN0LmFsd2F5cyhmdW5jdGlvbihkYXRhNSkge1xyXG5cdFx0XHRcdFx0aWYgKGRhdGE1KSB7XHJcblx0XHRcdFx0XHRcdC8vIEZlbGQgbWl0IERhdGVuIGJlbGllZmVyblxyXG5cdFx0XHRcdFx0XHR2YXIgaHRtbDtcclxuXHRcdFx0XHRcdFx0aHRtbCA9IFwiPG9wdGlvbj48L29wdGlvbj5cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXy5lYWNoKGRhdGE1LnJvd3MsIGZ1bmN0aW9uKMO8YmVyZWluc3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gXCI8b3B0aW9uIHZhbHVlPVxcXCJcIiArIMO8YmVyZWluc3QuaWQgKyBcIlxcXCI+XCIgKyDDvGJlcmVpbnN0LkRvbWFpblR4dCArIFwiPC9vcHRpb24+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLklkZWFsQmlvdG9ww5xiZXJlaW5zdF9odG1sID0gaHRtbDtcclxuXHRcdFx0XHRcdFx0JChcIiNUUG9wS29udHJJZGVhbEJpb3RvcFVlYmVyZWluc3RcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5odG1sKGh0bWwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudmFsKHdpbmRvdy5hcGYudHBvcGZlbGRrb250ci5UUG9wS29udHJJZGVhbEJpb3RvcFVlYmVyZWluc3QpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdCQoXCIjVFBvcEtvbnRySWRlYWxCaW90b3BVZWJlcmVpbnN0XCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLmh0bWwod2luZG93LmFwZi5JZGVhbEJpb3RvcMOcYmVyZWluc3RfaHRtbClcclxuICAgICAgICAgICAgICAgICAgICAudmFsKHdpbmRvdy5hcGYudHBvcGZlbGRrb250ci5UUG9wS29udHJJZGVhbEJpb3RvcFVlYmVyZWluc3QpO1xyXG5cdFx0XHR9XHJcblx0XHRcdC8vIEZlbGRlciwgZGllIG51ciBpbiBmcmVpd2tvbnRyIHZvcmtvbW1lblxyXG5cdFx0XHRpZiAobG9jYWxTdG9yYWdlLnRwb3BmcmVpd2tvbnRyKSB7XHJcblx0XHRcdFx0aWYgKGRhdGEuVFBvcEtvbnRyUGxhbiA9PSAxKSB7XHJcblx0XHRcdFx0XHQkKFwiI1RQb3BLb250clBsYW5cIikucHJvcChcImNoZWNrZWRcIiwgdHJ1ZSk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdCQoXCIjVFBvcEtvbnRyUGxhblwiKS5wcm9wKFwiY2hlY2tlZFwiLCBmYWxzZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdCQoXCIjVFBvcEtvbnRyVWViRmxhZWNoZVwiKS52YWwoZGF0YS5UUG9wS29udHJVZWJGbGFlY2hlKTtcclxuXHRcdFx0XHQkKFwiI1RQb3BLb250clVlYlBmbFwiKS52YWwoZGF0YS5UUG9wS29udHJVZWJQZmwpO1xyXG5cdFx0XHRcdCQoXCIjVFBvcEtvbnRyTmFCb1wiKS52YWwoZGF0YS5UUG9wS29udHJOYUJvKTtcclxuXHRcdFx0XHQkVFBvcEtvbnRySnVuZ1BmbEpOX2phLnByb3AoXCJjaGVja2VkXCIsIGZhbHNlKTtcclxuXHRcdFx0XHQkVFBvcEtvbnRySnVuZ1BmbEpOX25laW4ucHJvcChcImNoZWNrZWRcIiwgZmFsc2UpO1xyXG5cdFx0XHRcdCRUUG9wS29udHJKdW5nUGZsSk5fbGVlci5wcm9wKFwiY2hlY2tlZFwiLCBmYWxzZSk7XHJcblx0XHRcdFx0aWYgKGRhdGEuVFBvcEtvbnRySnVuZ1BmbEpOID09IDEpIHtcclxuXHRcdFx0XHRcdCRUUG9wS29udHJKdW5nUGZsSk5famEucHJvcChcImNoZWNrZWRcIiwgdHJ1ZSk7XHJcblx0XHRcdFx0fSBlbHNlIGlmIChkYXRhLlRQb3BLb250ckp1bmdQZmxKTiA9PSAwKSB7XHJcblx0XHRcdFx0XHQkVFBvcEtvbnRySnVuZ1BmbEpOX25laW4ucHJvcChcImNoZWNrZWRcIiwgdHJ1ZSk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdCRUUG9wS29udHJKdW5nUGZsSk5fbGVlci5wcm9wKFwiY2hlY2tlZFwiLCB0cnVlKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0JChcIiNUUG9wS29udHJWZWdIb2VNYXhcIikudmFsKGRhdGEuVFBvcEtvbnRyVmVnSG9lTWF4KTtcclxuXHRcdFx0XHQkKFwiI1RQb3BLb250clZlZ0hvZU1pdFwiKS52YWwoZGF0YS5UUG9wS29udHJWZWdIb2VNaXQpO1xyXG5cdFx0XHRcdCQoXCIjVFBvcEtvbnRyR2VmYWVocmR1bmdcIilcclxuICAgICAgICAgICAgICAgICAgICAudmFsKGRhdGEuVFBvcEtvbnRyR2VmYWVocmR1bmcpXHJcbiAgICAgICAgICAgICAgICAgICAgLmxpbWl0ZXIoMjU1LCAkKFwiI1RQb3BLb250ckdlZmFlaHJkdW5nX2xpbWl0XCIpKTtcclxuXHRcdFx0fVxyXG5cdFx0XHQvLyBmaWVsZGNvbnRhaW4tZGl2cyBkZXIgYmVuw7Z0aWd0ZW4gRmVsZGVyIGVpbmJsZW5kZW5cclxuXHRcdFx0aWYgKGxvY2FsU3RvcmFnZS50cG9wZnJlaXdrb250cikge1xyXG4gICAgICAgICAgICAgICAgXy5lYWNoKHdpbmRvdy5hcGYuZmVsZGxpc3RlX2ZyZWl3a29udHIsIGZ1bmN0aW9uKGZlbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICAkKFwiI2ZpZWxkY29udGFpbl9cIiArIGZlbGQpLnNob3coKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgXy5lYWNoKHdpbmRvdy5hcGYuZmVsZGxpc3RlX2ZlbGRrb250ciwgZnVuY3Rpb24oZmVsZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICQoXCIjZmllbGRjb250YWluX1wiICsgZmVsZCkuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblx0XHRcdH1cclxuXHRcdFx0Ly8gRm9ybXVsYXJlIGJsZW5kZW5cclxuXHRcdFx0d2luZG93LmFwZi56ZWlnZUZvcm11bGFyKFwidHBvcGZlbGRrb250clwiKTtcclxuXHRcdFx0aWYgKCFsb2NhbFN0b3JhZ2UudHBvcGZyZWl3a29udHIpIHtcclxuXHRcdFx0XHRoaXN0b3J5LnJlcGxhY2VTdGF0ZSh7dHBvcGZlbGRrb250cjogXCJ0cG9wZmVsZGtvbnRyXCJ9LCBcInRwb3BmZWxka29udHJcIiwgXCJpbmRleC5odG1sP2FwPVwiICsgbG9jYWxTdG9yYWdlLmFwX2lkICsgXCImcG9wPVwiICsgbG9jYWxTdG9yYWdlLnBvcF9pZCArIFwiJnRwb3A9XCIgKyBsb2NhbFN0b3JhZ2UudHBvcF9pZCArIFwiJnRwb3BmZWxka29udHI9XCIgKyBsb2NhbFN0b3JhZ2UudHBvcGZlbGRrb250cl9pZCk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0aGlzdG9yeS5yZXBsYWNlU3RhdGUoe3Rwb3BmcmVpd2tvbnRyOiBcInRwb3BmcmVpd2tvbnRyXCJ9LCBcInRwb3BmcmVpd2tvbnRyXCIsIFwiaW5kZXguaHRtbD9hcD1cIiArIGxvY2FsU3RvcmFnZS5hcF9pZCArIFwiJnBvcD1cIiArIGxvY2FsU3RvcmFnZS5wb3BfaWQgKyBcIiZ0cG9wPVwiICsgbG9jYWxTdG9yYWdlLnRwb3BfaWQgKyBcIiZ0cG9wZnJlaXdrb250cj1cIiArIGxvY2FsU3RvcmFnZS50cG9wZmVsZGtvbnRyX2lkKTtcclxuXHRcdFx0fVxyXG5cdFx0XHQvLyBSZWdpc3RlciBpbiBGZWxka29udHIgYmxlbmRlblxyXG5cdFx0XHRpZiAobG9jYWxTdG9yYWdlLnRwb3BmcmVpd2tvbnRyKSB7XHJcblx0XHRcdFx0JChcIiN0cG9wZmVsZGtvbnRyX3RhYnNfYmlvdG9wXCIpLmhpZGUoKTtcclxuXHRcdFx0XHQkKFwiI2Jpb3RvcF90YWJfbGlcIikuaGlkZSgpO1xyXG5cdFx0XHRcdCQoXCIjdHBvcGZlbGRrb250cl90YWJzXCIpLnRhYnMoXCJvcHRpb25cIiwgXCJhY3RpdmVcIiwgMCk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0JChcIiN0cG9wZmVsZGtvbnRyX3RhYnNfYmlvdG9wXCIpLnNob3coKTtcclxuXHRcdFx0XHQkKFwiI2Jpb3RvcF90YWJfbGlcIikuc2hvdygpO1xyXG5cdFx0XHRcdC8vIERpZXNlcyBFbGVtZW50IHdpcmQgZsOkbHNjaGxpY2hlcndlaXNlIGluIEVudHdpY2tsdW5nIGVpbmdlYmxlbmRldFxyXG5cdFx0XHRcdC8vIGtlaW5lIEFobnVuZyB3aWVzb1xyXG5cdFx0XHRcdC8vIGF1c2JsZW5kZW4hXHJcblx0XHRcdFx0JChcIiN0cG9wZmVsZGtvbnRyX3RhYnNfYmlvdG9wXCIpLmhpZGUoKTtcclxuXHRcdFx0fVxyXG5cdFx0XHQvLyBGb2t1cyBzdGV1ZXJuXHJcbiAgICAgICAgICAgICRUUG9wS29udHJKYWhyLmZvY3VzKCk7XHJcblx0XHRcdCQod2luZG93KS5zY3JvbGxUb3AoMCk7XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG4vLyBzZXR6dCB3aW5kb3cuYXBmLnRwb3BmZWxka29udHIgdW5kIGxvY2FsU3RvcmFnZS50cG9wZmVsZGtvbnRyX2lkXHJcbi8vIHdpcmQgYmVuw7Z0aWd0LCB3ZW5uIGJlaW0gQXBwLVN0YXJ0IGRpcmVrdCBlaW4gZGVlcCBsaW5rIGdlw7ZmZm5ldCB3aXJkXHJcbndpbmRvdy5hcGYuc2V0emVXaW5kb3dUcG9wZmVsZGtvbnRyID0gZnVuY3Rpb24oaWQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0bG9jYWxTdG9yYWdlLnRwb3BmZWxka29udHJfaWQgPSBpZDtcclxuXHR2YXIgZ2V0VHBvcGZlbGRrb250ciA9ICQuYWpheCh7XHJcblx0XHR0eXBlOiAnZ2V0JyxcclxuXHRcdHVybDogJ3BocC90cG9wZmVsZGtvbnRyLnBocCcsXHJcblx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0ZGF0YToge1xyXG5cdFx0XHRcImlkXCI6IGxvY2FsU3RvcmFnZS50cG9wZmVsZGtvbnRyX2lkXHJcblx0XHR9XHJcblx0fSk7XHJcblx0Z2V0VHBvcGZlbGRrb250ci5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0Ly8gUsO8Y2tnYWJld2VydCBudWxsIHdpcmQgb2ZmZW5iYXIgYXVjaCBhbHMgc3VjY2VzcyBnZXdlcnRldCwgZ2lidCB3ZWl0ZXIgdW50ZW4gRmVobGVyLCBhbHNvIEF1c2bDvGhydW5nIHZlcmhpbmRlcm5cclxuXHRcdGlmIChkYXRhKSB7XHJcblx0XHRcdC8vIHRwb3BmZWxka29udHIgYmVyZWl0c3RlbGxlblxyXG5cdFx0XHR3aW5kb3cuYXBmLnRwb3BmZWxka29udHIgPSBkYXRhO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59O1xyXG5cclxud2luZG93LmFwZi5pbml0aWllcmVfdHBvcG1hc3NuID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICghbG9jYWxTdG9yYWdlLnRwb3BtYXNzbl9pZCkge1xyXG5cdFx0Ly8gZXMgZmVobGVuIGJlbsO2dGlndGUgRGF0ZW4gPiBlaW5lIEViZW5lIGjDtmhlclxyXG5cdFx0d2luZG93LmFwZi5pbml0aWllcmVfcG9wKCk7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cdC8vIEZlbGRlciB6dXLDvGNrc2V0emVuXHJcblx0d2luZG93LmFwZi5sZWVyZUZlbGRlclZvbkZvcm11bGFyKFwidHBvcG1hc3NuXCIpO1xyXG5cdC8vIERhdGVuIGbDvHIgZGllIHBvcCBhdXMgZGVyIERCIGhvbGVuXHJcblx0dmFyIGdldFRQb3BNYXNzbiA9ICQuYWpheCh7XHJcblx0XHR0eXBlOiAnZ2V0JyxcclxuXHRcdHVybDogJ3BocC90cG9wbWFzc24ucGhwJyxcclxuXHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRkYXRhOiB7XHJcblx0XHRcdFwiaWRcIjogbG9jYWxTdG9yYWdlLnRwb3BtYXNzbl9pZFxyXG5cdFx0fVxyXG5cdH0pO1xyXG5cdGdldFRQb3BNYXNzbi5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0Ly8gUsO8Y2tnYWJld2VydCBudWxsIHdpcmQgb2ZmZW5iYXIgYXVjaCBhbHMgc3VjY2VzcyBnZXdlcnRldCwgZ2lidCB3ZWl0ZXIgdW50ZW4gRmVobGVyLCBhbHNvIEF1c2bDvGhydW5nIHZlcmhpbmRlcm5cclxuXHRcdGlmIChkYXRhKSB7XHJcblx0XHRcdC8vIHRwb3BtYXNzbiBiZXJlaXRzdGVsbGVuXHJcblx0XHRcdHdpbmRvdy5hcGYudHBvcG1hc3NuID0gZGF0YTtcclxuXHRcdFx0Ly8gRmVsZGVyIG1pdCBEYXRlbiBiZWxpZWZlcm5cclxuXHRcdFx0Ly8gZsO8ciBzZWxlY3QgVFBvcE1hc3NuVHlwIERhdGVuIGhvbGVuIC0gb2RlciB2b3JoYW5kZW5lIG51dHplblxyXG5cdFx0XHRpZiAoIXdpbmRvdy5hcGYudHBvcG1hc3NudHlwX2h0bWwpIHtcclxuXHRcdFx0XHR2YXIgZ2V0VFBvcE1hc3NuVHlwID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdHR5cGU6ICdnZXQnLFxyXG5cdFx0XHRcdFx0dXJsOiAncGhwL3Rwb3BtYXNzbl90eXAucGhwJyxcclxuXHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbidcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRnZXRUUG9wTWFzc25UeXAuYWx3YXlzKGZ1bmN0aW9uKGRhdGEyKSB7XHJcblx0XHRcdFx0XHRpZiAoZGF0YTIpIHtcclxuXHRcdFx0XHRcdFx0Ly8gdHBvcG1hc3NuX3R5cCBiZXJlaXRzdGVsbGVuXHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYudHBvcG1hc3NuX3R5cCA9IGRhdGEyO1xyXG5cdFx0XHRcdFx0XHQvLyBGZWxkIG1pdCBEYXRlbiBiZWxpZWZlcm5cclxuXHRcdFx0XHRcdFx0dmFyIGh0bWw7XHJcblx0XHRcdFx0XHRcdGh0bWwgPSBcIjxvcHRpb24+PC9vcHRpb24+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF8uZWFjaChkYXRhMi5yb3dzLCBmdW5jdGlvbih0cG9wbWFzc25fdHlwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9IFwiPG9wdGlvbiB2YWx1ZT1cXFwiXCIgKyB0cG9wbWFzc25fdHlwLmlkICsgXCJcXFwiPlwiICsgdHBvcG1hc3NuX3R5cC5NYXNzblR5cFR4dCArIFwiPC9vcHRpb24+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLnRwb3BtYXNzbnR5cF9odG1sID0gaHRtbDtcclxuXHRcdFx0XHRcdFx0JChcIiNUUG9wTWFzc25UeXBcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5odG1sKGh0bWwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudmFsKHdpbmRvdy5hcGYudHBvcG1hc3NuLlRQb3BNYXNzblR5cCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0JChcIiNUUG9wTWFzc25UeXBcIilcclxuICAgICAgICAgICAgICAgICAgICAuaHRtbCh3aW5kb3cuYXBmLnRwb3BtYXNzbnR5cF9odG1sKVxyXG4gICAgICAgICAgICAgICAgICAgIC52YWwod2luZG93LmFwZi50cG9wbWFzc24uVFBvcE1hc3NuVHlwKTtcclxuXHRcdFx0fVxyXG5cdFx0XHQkKFwiI1RQb3BNYXNzblR4dFwiKVxyXG4gICAgICAgICAgICAgICAgLnZhbChkYXRhLlRQb3BNYXNzblR4dClcclxuICAgICAgICAgICAgICAgIC5saW1pdGVyKDI1NSwgJChcIiNUUG9wTWFzc25UeHRfbGltaXRcIikpO1xyXG5cdFx0XHQkKFwiI1RQb3BNYXNzbkphaHJcIikudmFsKGRhdGEuVFBvcE1hc3NuSmFocik7XHJcblx0XHRcdGlmIChkYXRhLlRQb3BNYXNzbkRhdHVtICE9PSBcIjAxLjAxLjE5NzBcIikge1xyXG5cdFx0XHRcdC8vIHBocCBtYWNodCBhdXMgZWluZW0gTnVsbHdlcnQgaW0gRGF0dW0gZGVuIDEuMS4xOTcwISEhXHJcblx0XHRcdFx0JChcIiNUUG9wTWFzc25EYXR1bVwiKS52YWwoZGF0YS5UUG9wTWFzc25EYXR1bSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0JChcIiNUUG9wTWFzc25EYXR1bVwiKS52YWwoXCJcIik7XHJcblx0XHRcdH1cclxuXHRcdFx0Ly8gVFBvcE1hc3NuQmVhcmI6IERhdGVuIGhvbGVuIC0gb2RlciB2b3JoYW5kZW5lIG51dHplblxyXG5cdFx0XHRpZiAoIXdpbmRvdy5hcGYuYWRyZXNzZW5faHRtbCkge1xyXG5cdFx0XHRcdHZhciBnZXRBZHJlc3NlbiA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHR0eXBlOiAnZ2V0JyxcclxuXHRcdFx0XHRcdHVybDogJ2FwaS9hZHJlc3NlbicsXHJcblx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nXHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0Z2V0QWRyZXNzZW4uYWx3YXlzKGZ1bmN0aW9uKGRhdGEyKSB7XHJcblx0XHRcdFx0XHRpZiAoZGF0YTIpIHtcclxuXHRcdFx0XHRcdFx0Ly8gRmVsZCBtaXQgRGF0ZW4gYmVsaWVmZXJuXHJcblx0XHRcdFx0XHRcdHZhciBodG1sO1xyXG5cdFx0XHRcdFx0XHRodG1sID0gXCI8b3B0aW9uPjwvb3B0aW9uPlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfLmVhY2goZGF0YTIsIGZ1bmN0aW9uKGFkcmVzc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gXCI8b3B0aW9uIHZhbHVlPVxcXCJcIiArIGFkcmVzc2UuaWQgKyBcIlxcXCI+XCIgKyBhZHJlc3NlLkFkck5hbWUgKyBcIjwvb3B0aW9uPlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi5hZHJlc3Nlbl9odG1sID0gaHRtbDtcclxuXHRcdFx0XHRcdFx0JChcIiNUUG9wTWFzc25CZWFyYlwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmh0bWwoaHRtbClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC52YWwod2luZG93LmFwZi50cG9wbWFzc24uVFBvcE1hc3NuQmVhcmIpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdCQoXCIjVFBvcE1hc3NuQmVhcmJcIilcclxuICAgICAgICAgICAgICAgICAgICAuaHRtbCh3aW5kb3cuYXBmLmFkcmVzc2VuX2h0bWwpXHJcbiAgICAgICAgICAgICAgICAgICAgLnZhbCh3aW5kb3cuYXBmLnRwb3BtYXNzbi5UUG9wTWFzc25CZWFyYik7XHJcblx0XHRcdH1cclxuXHRcdFx0JChcIiNUUG9wTWFzc25CZW1UeHRcIikudmFsKGRhdGEuVFBvcE1hc3NuQmVtVHh0KTtcclxuXHRcdFx0aWYgKGRhdGEuVFBvcE1hc3NuUGxhbiA9PSAxKSB7XHJcblx0XHRcdFx0JChcIiNUUG9wTWFzc25QbGFuXCIpLnByb3AoXCJjaGVja2VkXCIsIHRydWUpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdCQoXCIjVFBvcE1hc3NuUGxhblwiKS5wcm9wKFwiY2hlY2tlZFwiLCBmYWxzZSk7XHJcblx0XHRcdH1cclxuXHRcdFx0JChcIiNUUG9wTWFzc25QbGFuQmV6XCIpXHJcbiAgICAgICAgICAgICAgICAudmFsKGRhdGEuVFBvcE1hc3NuUGxhbkJleilcclxuICAgICAgICAgICAgICAgIC5saW1pdGVyKDI1NSwgJChcIiNUUG9wTWFzc25QbGFuQmV6X2xpbWl0XCIpKTtcclxuXHRcdFx0JChcIiNUUG9wTWFzc25GbGFlY2hlXCIpLnZhbChkYXRhLlRQb3BNYXNzbkZsYWVjaGUpO1xyXG5cdFx0XHQkKFwiI1RQb3BNYXNzbkFuc2llZEZvcm1cIilcclxuICAgICAgICAgICAgICAgIC52YWwoZGF0YS5UUG9wTWFzc25BbnNpZWRGb3JtKVxyXG4gICAgICAgICAgICAgICAgLmxpbWl0ZXIoMjU1LCAkKFwiI1RQb3BNYXNzbkFuc2llZEZvcm1fbGltaXRcIikpO1xyXG5cdFx0XHQkKFwiI1RQb3BNYXNzbkFuc2llZFBmbGFuemFub3JkbnVuZ1wiKVxyXG4gICAgICAgICAgICAgICAgLnZhbChkYXRhLlRQb3BNYXNzbkFuc2llZFBmbGFuemFub3JkbnVuZylcclxuICAgICAgICAgICAgICAgIC5saW1pdGVyKDI1NSwgJChcIiNUUG9wTWFzc25BbnNpZWRQZmxhbnphbm9yZG51bmdfbGltaXRcIikpO1xyXG5cdFx0XHQkKFwiI1RQb3BNYXNzbk1hcmtpZXJ1bmdcIilcclxuICAgICAgICAgICAgICAgIC52YWwoZGF0YS5UUG9wTWFzc25NYXJraWVydW5nKVxyXG4gICAgICAgICAgICAgICAgLmxpbWl0ZXIoMjU1LCAkKFwiI1RQb3BNYXNzbk1hcmtpZXJ1bmdfbGltaXRcIikpO1xyXG5cdFx0XHQkKFwiI1RQb3BNYXNzbkFuc2llZEFuelRyaWViZVwiKS52YWwoZGF0YS5UUG9wTWFzc25BbnNpZWRBbnpUcmllYmUpO1xyXG5cdFx0XHQkKFwiI1RQb3BNYXNzbkFuc2llZEFuelBmbFwiKS52YWwoZGF0YS5UUG9wTWFzc25BbnNpZWRBbnpQZmwpO1xyXG5cdFx0XHQkKFwiI1RQb3BNYXNzbkFuelBmbGFuenN0ZWxsZW5cIikudmFsKGRhdGEuVFBvcE1hc3NuQW56UGZsYW56c3RlbGxlbik7XHJcblx0XHRcdC8vIGbDvHIgVFBvcE1hc3NuQW5zaWVkV2lydHNwZmwgd3VyZGUgZGllIEFydGxpc3RlIHNjaG9uIGJlcmVpdGdlc3RlbGx0XHJcblx0XHRcdC8vIHdlbm4gZGllIEFud2VuZHVuZyBkaXJla3QgYXVmIGVpbmVyIFRQb3BNYXNzbiBnZcO2ZmZuZXQgd2lyZCwgaXN0IGRpZSBMaXN0ZSBub2NoIG5pY2h0IGJlcmVpdFxyXG5cdFx0XHQvLyBkYXJ1bSBoaWVyIG5vY2htYWxzIGhvbGVuXHJcblx0XHRcdCQud2hlbih3aW5kb3cuYXBmLmVyc3RlbGxlX2FydGxpc3RlbigpKVxyXG5cdFx0XHRcdC50aGVuKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0JChcIiNUUG9wTWFzc25BbnNpZWRXaXJ0c3BmbFwiKS52YWwoZGF0YS5UUG9wTWFzc25BbnNpZWRXaXJ0c3BmbCk7XHJcblx0XHRcdFx0XHQkKFwiI1RQb3BNYXNzbkFuc2llZEhlcmt1bmZ0UG9wXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC52YWwoZGF0YS5UUG9wTWFzc25BbnNpZWRIZXJrdW5mdFBvcClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmxpbWl0ZXIoMjU1LCAkKFwiI1RQb3BNYXNzbkFuc2llZEhlcmt1bmZ0UG9wX2xpbWl0XCIpKTtcclxuXHRcdFx0XHRcdCQoXCIjVFBvcE1hc3NuQW5zaWVkRGF0U2FtbVwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudmFsKGRhdGEuVFBvcE1hc3NuQW5zaWVkRGF0U2FtbSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmxpbWl0ZXIoNTAsICQoXCIjVFBvcE1hc3NuQW5zaWVkRGF0U2FtbV9saW1pdFwiKSk7XHJcblx0XHRcdFx0XHQkKFwiI1RQb3BNYXNzbkd1aWRcIikudmFsKGRhdGEuVFBvcE1hc3NuR3VpZCk7XHJcblx0XHRcdFx0XHQvLyBGb3JtdWxhcmUgYmxlbmRlblxyXG5cdFx0XHRcdFx0d2luZG93LmFwZi56ZWlnZUZvcm11bGFyKFwidHBvcG1hc3NuXCIpO1xyXG5cdFx0XHRcdFx0aGlzdG9yeS5yZXBsYWNlU3RhdGUoe3Rwb3BtYXNzbjogXCJ0cG9wbWFzc25cIn0sIFwidHBvcG1hc3NuXCIsIFwiaW5kZXguaHRtbD9hcD1cIiArIGxvY2FsU3RvcmFnZS5hcF9pZCArIFwiJnBvcD1cIiArIGxvY2FsU3RvcmFnZS5wb3BfaWQgKyBcIiZ0cG9wPVwiICsgbG9jYWxTdG9yYWdlLnRwb3BfaWQgKyBcIiZ0cG9wbWFzc249XCIgKyBsb2NhbFN0b3JhZ2UudHBvcG1hc3NuX2lkKTtcclxuXHRcdFx0XHRcdC8vIGJlaSBuZXVlbiBEYXRlbnPDpHR6ZW4gRm9rdXMgc3RldWVyblxyXG5cdFx0XHRcdFx0JCgnI1RQb3BNYXNzbkphaHInKS5mb2N1cygpO1xyXG5cdFx0XHRcdH0pO1x0XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG4vLyBzZXR6dCB3aW5kb3cuYXBmLnRwb3BtYXNzbiB1bmQgbG9jYWxTdG9yYWdlLnRwb3BtYXNzbl9pZFxyXG4vLyB3aXJkIGJlbsO2dGlndCwgd2VubiBiZWltIEFwcC1TdGFydCBkaXJla3QgZWluIGRlZXAgbGluayBnZcO2ZmZuZXQgd2lyZFxyXG53aW5kb3cuYXBmLnNldHplV2luZG93VHBvcG1hc3NuID0gZnVuY3Rpb24oaWQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0bG9jYWxTdG9yYWdlLnRwb3BtYXNzbl9pZCA9IGlkO1xyXG5cdHZhciBnZXRUUG9wTWFzc24gPSAkLmFqYXgoe1xyXG5cdFx0dHlwZTogJ2dldCcsXHJcblx0XHR1cmw6ICdwaHAvdHBvcG1hc3NuLnBocCcsXHJcblx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0ZGF0YToge1xyXG5cdFx0XHRcImlkXCI6IGxvY2FsU3RvcmFnZS50cG9wbWFzc25faWRcclxuXHRcdH1cclxuXHR9KTtcclxuXHRnZXRUUG9wTWFzc24uYWx3YXlzKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdC8vIFLDvGNrZ2FiZXdlcnQgbnVsbCB3aXJkIG9mZmVuYmFyIGF1Y2ggYWxzIHN1Y2Nlc3MgZ2V3ZXJ0ZXQsIGdpYnQgd2VpdGVyIHVudGVuIEZlaGxlciwgYWxzbyBBdXNmw7xocnVuZyB2ZXJoaW5kZXJuXHJcblx0XHRpZiAoZGF0YSkge1xyXG5cdFx0XHQvLyB0cG9wbWFzc24gYmVyZWl0c3RlbGxlblxyXG5cdFx0XHR3aW5kb3cuYXBmLnRwb3BtYXNzbiA9IGRhdGE7XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLmluaXRpaWVyZV90cG9wbWFzc25iZXIgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0aWYgKCFsb2NhbFN0b3JhZ2UudHBvcG1hc3NuYmVyX2lkKSB7XHJcblx0XHQvLyBlcyBmZWhsZW4gYmVuw7Z0aWd0ZSBEYXRlbiA+IGVpbmUgRWJlbmUgaMO2aGVyXHJcblx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV9wb3AoKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblx0Ly8gRmVsZGVyIHp1csO8Y2tzZXR6ZW5cclxuXHR3aW5kb3cuYXBmLmxlZXJlRmVsZGVyVm9uRm9ybXVsYXIoXCJ0cG9wbWFzc25iZXJcIik7XHJcblx0Ly8gRGF0ZW4gZsO8ciBkaWUgcG9wIGF1cyBkZXIgREIgaG9sZW5cclxuXHR2YXIgZ2V0VFBvcE1hc3NuQmVyID0gJC5hamF4KHtcclxuXHRcdHR5cGU6ICdnZXQnLFxyXG5cdFx0dXJsOiAncGhwL3Rwb3BtYXNzbmJlci5waHAnLFxyXG5cdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdGRhdGE6IHtcclxuXHRcdFx0XCJpZFwiOiBsb2NhbFN0b3JhZ2UudHBvcG1hc3NuYmVyX2lkXHJcblx0XHR9XHJcblx0fSk7XHJcblx0Z2V0VFBvcE1hc3NuQmVyLmFsd2F5cyhmdW5jdGlvbihkYXRhKSB7XHJcblx0XHQvLyBSw7xja2dhYmV3ZXJ0IG51bGwgd2lyZCBvZmZlbmJhciBhdWNoIGFscyBzdWNjZXNzIGdld2VydGV0LCBnaWJ0IHdlaXRlciB1bnRlbiBGZWhsZXIsIGFsc28gQXVzZsO8aHJ1bmcgdmVyaGluZGVyblxyXG5cdFx0aWYgKGRhdGEpIHtcclxuXHRcdFx0Ly8gdHBvcG1hc3NuYmVyIGJlcmVpdHN0ZWxsZW5cclxuXHRcdFx0d2luZG93LmFwZi50cG9wbWFzc25iZXIgPSBkYXRhO1xyXG5cdFx0XHQvLyBGZWxkZXIgbWl0IERhdGVuIGJlbGllZmVyblxyXG5cdFx0XHQkKFwiI1RQb3BNYXNzbkJlckphaHJcIikudmFsKGRhdGEuVFBvcE1hc3NuQmVySmFocik7XHJcblx0XHRcdCQoXCIjVFBvcE1hc3NuQmVyRXJmb2xnc2JldXJ0ZWlsdW5nXCIgKyBkYXRhLlRQb3BNYXNzbkJlckVyZm9sZ3NiZXVydGVpbHVuZykucHJvcChcImNoZWNrZWRcIiwgdHJ1ZSk7XHJcblx0XHRcdCQoXCIjVFBvcE1hc3NuQmVyVHh0XCIpLnZhbChkYXRhLlRQb3BNYXNzbkJlclR4dCk7XHJcblx0XHRcdC8vIEZvcm11bGFyZSBibGVuZGVuXHJcblx0XHRcdHdpbmRvdy5hcGYuemVpZ2VGb3JtdWxhcihcInRwb3BtYXNzbmJlclwiKTtcclxuXHRcdFx0aGlzdG9yeS5yZXBsYWNlU3RhdGUoe3Rwb3BtYXNzbmJlcjogXCJ0cG9wbWFzc25iZXJcIn0sIFwidHBvcG1hc3NuYmVyXCIsIFwiaW5kZXguaHRtbD9hcD1cIiArIGxvY2FsU3RvcmFnZS5hcF9pZCArIFwiJnBvcD1cIiArIGxvY2FsU3RvcmFnZS5wb3BfaWQgKyBcIiZ0cG9wPVwiICsgbG9jYWxTdG9yYWdlLnRwb3BfaWQgKyBcIiZ0cG9wbWFzc25iZXI9XCIgKyBsb2NhbFN0b3JhZ2UudHBvcG1hc3NuYmVyX2lkKTtcclxuXHRcdFx0Ly8gYmVpIG5ldWVuIERhdGVuc8OkdHplbiBGb2t1cyBzdGV1ZXJuXHJcblx0XHRcdCQoJyNUUG9wTWFzc25CZXJKYWhyJykuZm9jdXMoKTtcclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbi8vIHNldHp0IHdpbmRvdy5hcGYudHBvcG1hc3NuYmVyIHVuZCBsb2NhbFN0b3JhZ2UudHBvcG1hc3NuYmVyX2lkXHJcbi8vIHdpcmQgYmVuw7Z0aWd0LCB3ZW5uIGJlaW0gQXBwLVN0YXJ0IGRpcmVrdCBlaW4gZGVlcCBsaW5rIGdlw7ZmZm5ldCB3aXJkXHJcbndpbmRvdy5hcGYuc2V0emVXaW5kb3dUcG9wbWFzc25iZXIgPSBmdW5jdGlvbihpZCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UudHBvcG1hc3NuYmVyX2lkID0gaWQ7XHJcblx0dmFyIGdldFRQb3BNYXNzbkJlciA9ICQuYWpheCh7XHJcblx0XHR0eXBlOiAnZ2V0JyxcclxuXHRcdHVybDogJ3BocC90cG9wbWFzc25iZXIucGhwJyxcclxuXHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRkYXRhOiB7XHJcblx0XHRcdFwiaWRcIjogbG9jYWxTdG9yYWdlLnRwb3BtYXNzbmJlcl9pZFxyXG5cdFx0fVxyXG5cdH0pO1xyXG5cdGdldFRQb3BNYXNzbkJlci5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0Ly8gUsO8Y2tnYWJld2VydCBudWxsIHdpcmQgb2ZmZW5iYXIgYXVjaCBhbHMgc3VjY2VzcyBnZXdlcnRldCwgZ2lidCB3ZWl0ZXIgdW50ZW4gRmVobGVyLCBhbHNvIEF1c2bDvGhydW5nIHZlcmhpbmRlcm5cclxuXHRcdGlmIChkYXRhKSB7XHJcblx0XHRcdC8vIHRwb3BtYXNzbmJlciBiZXJlaXRzdGVsbGVuXHJcblx0XHRcdHdpbmRvdy5hcGYudHBvcG1hc3NuYmVyID0gZGF0YTtcclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbndpbmRvdy5hcGYuaW5pdGlpZXJlVHBvcGJlciA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRpZiAoIWxvY2FsU3RvcmFnZS50cG9wYmVyX2lkKSB7XHJcblx0XHQvLyBlcyBmZWhsZW4gYmVuw7Z0aWd0ZSBEYXRlbiA+IGVpbmUgRWJlbmUgaMO2aGVyXHJcblx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV9wb3AoKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblx0Ly8gRmVsZGVyIHp1csO8Y2tzZXR6ZW5cclxuXHR3aW5kb3cuYXBmLmxlZXJlRmVsZGVyVm9uRm9ybXVsYXIoXCJ0cG9wYmVyXCIpO1xyXG5cdC8vIERhdGVuIGbDvHIgZGllIHRwb3BiZXIgYXVzIGRlciBEQiBob2xlblxyXG5cdHZhciBnZXRUUG9wQmVyID0gJC5hamF4KHtcclxuXHRcdHR5cGU6ICdnZXQnLFxyXG5cdFx0dXJsOiAncGhwL3Rwb3BiZXIucGhwJyxcclxuXHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRkYXRhOiB7XHJcblx0XHRcdFwiaWRcIjogbG9jYWxTdG9yYWdlLnRwb3BiZXJfaWRcclxuXHRcdH1cclxuXHR9KTtcclxuXHRnZXRUUG9wQmVyLmFsd2F5cyhmdW5jdGlvbihkYXRhKSB7XHJcblx0XHQvLyBSw7xja2dhYmV3ZXJ0IG51bGwgd2lyZCBvZmZlbmJhciBhdWNoIGFscyBzdWNjZXNzIGdld2VydGV0LCBnaWJ0IHdlaXRlciB1bnRlbiBGZWhsZXIsIGFsc28gQXVzZsO8aHJ1bmcgdmVyaGluZGVyblxyXG5cdFx0aWYgKGRhdGEpIHtcclxuXHRcdFx0Ly8gdHBvcGJlciBiZXJlaXRzdGVsbGVuXHJcblx0XHRcdHdpbmRvdy5hcGYudHBvcGJlciA9IGRhdGE7XHJcblx0XHRcdC8vIEZlbGRlciBtaXQgRGF0ZW4gYmVsaWVmZXJuXHJcblx0XHRcdCQoXCIjVFBvcEJlckphaHJcIikudmFsKGRhdGEuVFBvcEJlckphaHIpO1xyXG5cdFx0XHQkKFwiI1RQb3BCZXJFbnR3aWNrbHVuZ1wiICsgZGF0YS5UUG9wQmVyRW50d2lja2x1bmcpLnByb3AoXCJjaGVja2VkXCIsIHRydWUpO1xyXG5cdFx0XHQkKFwiI1RQb3BCZXJUeHRcIikudmFsKGRhdGEuVFBvcEJlclR4dCk7XHJcblx0XHRcdC8vIEZvcm11bGFyZSBibGVuZGVuXHJcblx0XHRcdHdpbmRvdy5hcGYuemVpZ2VGb3JtdWxhcihcInRwb3BiZXJcIik7XHJcblx0XHRcdGhpc3RvcnkucmVwbGFjZVN0YXRlKHt0cG9wYmVyOiBcInRwb3BiZXJcIn0sIFwidHBvcGJlclwiLCBcImluZGV4Lmh0bWw/YXA9XCIgKyBsb2NhbFN0b3JhZ2UuYXBfaWQgKyBcIiZwb3A9XCIgKyBsb2NhbFN0b3JhZ2UucG9wX2lkICsgXCImdHBvcD1cIiArIGxvY2FsU3RvcmFnZS50cG9wX2lkICsgXCImdHBvcGJlcj1cIiArIGxvY2FsU3RvcmFnZS50cG9wYmVyX2lkKTtcclxuXHRcdFx0Ly8gYmVpIG5ldWVuIERhdGVuc8OkdHplbiBGb2t1cyBzdGV1ZXJuXHJcblx0XHRcdCQoJyNUUG9wQmVySmFocicpLmZvY3VzKCk7XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG4vLyBzZXR6dCB3aW5kb3cuYXBmLnRwb3BiZXIgdW5kIGxvY2FsU3RvcmFnZS50cG9wYmVyX2lkXHJcbi8vIHdpcmQgYmVuw7Z0aWd0LCB3ZW5uIGJlaW0gQXBwLVN0YXJ0IGRpcmVrdCBlaW4gZGVlcCBsaW5rIGdlw7ZmZm5ldCB3aXJkXHJcbndpbmRvdy5hcGYuc2V0emVXaW5kb3dUcG9wYmVyID0gZnVuY3Rpb24oaWQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0bG9jYWxTdG9yYWdlLnRwb3BiZXJfaWQgPSBpZDtcclxuXHR2YXIgZ2V0VFBvcEJlciA9ICQuYWpheCh7XHJcblx0XHR0eXBlOiAnZ2V0JyxcclxuXHRcdHVybDogJ3BocC90cG9wYmVyLnBocCcsXHJcblx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0ZGF0YToge1xyXG5cdFx0XHRcImlkXCI6IGxvY2FsU3RvcmFnZS50cG9wYmVyX2lkXHJcblx0XHR9XHJcblx0fSk7XHJcblx0Z2V0VFBvcEJlci5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0Ly8gUsO8Y2tnYWJld2VydCBudWxsIHdpcmQgb2ZmZW5iYXIgYXVjaCBhbHMgc3VjY2VzcyBnZXdlcnRldCwgZ2lidCB3ZWl0ZXIgdW50ZW4gRmVobGVyLCBhbHNvIEF1c2bDvGhydW5nIHZlcmhpbmRlcm5cclxuXHRcdGlmIChkYXRhKSB7XHJcblx0XHRcdC8vIHRwb3BiZXIgYmVyZWl0c3RlbGxlblxyXG5cdFx0XHR3aW5kb3cuYXBmLnRwb3BiZXIgPSBkYXRhO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59O1xyXG5cclxud2luZG93LmFwZi5pbml0aWllcmVfYmVvYiA9IGZ1bmN0aW9uKGJlb2J0eXAsIGJlb2JpZCwgYmVvYl9zdGF0dXMsIG9obmVfenVfemVpZ2VuKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIGJlb2Jfc3RhdHVzIG1hcmtpZXJ0LCBvYiBkaWUgQmVvYmFjaHR1bmc6XHJcblx0Ly8gLSBzY2hvbiB6dWdld2llc2VuIGlzdCAoenVnZW9yZG5ldClcclxuXHQvLyAtIG5vY2ggbmljaHQgYmV1cnRlaWx0IGlzdCAobmljaHRfYmV1cnRlaWx0KVxyXG5cdC8vIC0gbmljaHQgenV6dW9yZG5lbiBpc3QgKG5pY2h0X3p1enVvcmRuZW4pXHJcblx0Ly8gYmVvYl9zdGF0dXMgbXVzcyBnZXNwZWljaGVydCB3ZXJkZW4sIGRhbWl0IGJlaSBEYXRlbsOkbmRlcnVuZ2VuIGJla2FubnQgaXN0LCBvYiBlaW4gYmVzdGVoZW5kZXIgRGF0ZW5zYXR6IGJlYXJiZWl0ZXQgb2RlciBlaW4gbmV1ZXIgZ2VzY2hhZmZlbiB3ZXJkZW4gbXVzc1xyXG5cdGxvY2FsU3RvcmFnZS5iZW9iX3N0YXR1cyA9IGJlb2Jfc3RhdHVzO1xyXG5cdC8vIHNpY2hlcnN0ZWxsZW4sIGRhc3MgYmVvYnR5cCBpbW1lciBiZWthbm50IGlzdFxyXG5cdGxvY2FsU3RvcmFnZS5iZW9idHlwID0gYmVvYnR5cDtcclxuXHJcblx0dmFyIHVybCwgdXJsX2Rpc3R6dXRwb3A7XHJcblx0aWYgKCFiZW9iaWQgJiYgIW9obmVfenVfemVpZ2VuKSB7XHJcblx0XHQvLyBlcyBmZWhsZW4gYmVuw7Z0aWd0ZSBEYXRlbiA+IGVpbmUgRWJlbmUgaMO2aGVyXHJcblx0XHRpZiAoYmVvYl9zdGF0dXMgPT09IFwibmljaHRfYmV1cnRlaWx0XCIgfHwgYmVvYl9zdGF0dXMgPT09IFwibmljaHRfenV6dW9yZG5lblwiKSB7XHJcblx0XHRcdHdpbmRvdy5hcGYuaW5pdGlpZXJlX2FwKCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV9wb3AoKTtcclxuXHRcdH1cclxuXHRcdHJldHVybjtcclxuXHR9XHJcblxyXG4gICAgLy8gYmVvYmlkIGhhdCBtZWlzdCAnYmVvYicgdm9yYW5nZXN0ZWxsdCAtIGVudGZlcm5lbiFcclxuICAgIGlmIChiZW9iaWQuaW5kZXhPZignYmVvYicpID4gLTEpIHtcclxuICAgICAgICBiZW9iaWQgPSBiZW9iaWQucmVwbGFjZSgnYmVvYicsICcnKTtcclxuICAgIH1cclxuICAgIC8vIGJlb2JpZCBiZXJlaXRzdGVsbGVuXHJcbiAgICBsb2NhbFN0b3JhZ2UuYmVvYl9pZCA9IGJlb2JpZDtcclxuXHRcclxuXHQvLyBFdkFCIG9kZXIgSW5mb3NwZXppZXM/ID4gZW50c3ByZWNoZW5kZSB1cmwgenVzYW1tZW5zZXR6ZW5cclxuXHR1cmwgPSAncGhwL2Jlb2JfJyArIGJlb2J0eXAgKyAnLnBocCc7XHJcblx0XHJcblx0Ly8gRGF0ZW4gZsO8ciBkaWUgYmVvYiBhdXMgZGVyIERCIGhvbGVuXHJcblx0dmFyIGdldEJlb2IgPSAkLmFqYXgoe1xyXG4gICAgICAgICAgICB0eXBlOiAnZ2V0JyxcclxuICAgICAgICAgICAgdXJsOiB1cmwsXHJcbiAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIFwiaWRcIjogYmVvYmlkXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KSxcclxuICAgICAgICAkQmVvYkJlbWVya3VuZ2VuID0gJChcIiNCZW9iQmVtZXJrdW5nZW5cIik7XHJcblxyXG5cdGdldEJlb2IuYWx3YXlzKGZ1bmN0aW9uKGRhdGFfYmVvYikge1xyXG5cdFx0Ly8gUsO8Y2tnYWJld2VydCBudWxsIHdpcmQgb2ZmZW5iYXIgYXVjaCBhbHMgc3VjY2VzcyBnZXdlcnRldCwgZ2lidCB3ZWl0ZXIgdW50ZW4gRmVobGVyLCBhbHNvIEF1c2bDvGhydW5nIHZlcmhpbmRlcm5cclxuXHRcdGlmIChkYXRhX2Jlb2IpIHtcclxuXHJcblx0XHRcdC8vIGJvZWJmZWxkZXIgYmVyZWl0c3RlbGxlblxyXG5cdFx0XHR2YXIgaHRtbF9iZW9iZmVsZGVyID0gd2luZG93LmFwZi5lcnN0ZWxsZUZlbGRlckbDvHJCZW9iKGRhdGFfYmVvYiwgYmVvYnR5cCk7XHJcblx0XHRcdCQoXCIjYmVvYl90YWJsZVwiKS5odG1sKGh0bWxfYmVvYmZlbGRlcik7XHJcblx0XHRcdFxyXG5cdFx0XHQvLyBBYnN0YW5kIHp1IFRQb3AgYXVzIGRlciBEQiBob2xlblxyXG5cdFx0XHR1cmxfZGlzdHp1dHBvcCA9ICdwaHAvYmVvYl9kaXN0enV0cG9wXycgKyBiZW9idHlwICsgJy5waHAnO1xyXG5cdFx0XHR2YXIgZ2V0RGlzdFp1VFBvcCA9ICQuYWpheCh7XHJcblx0XHRcdFx0dHlwZTogJ2dldCcsXHJcblx0XHRcdFx0dXJsOiB1cmxfZGlzdHp1dHBvcCxcclxuXHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFwiYmVvYmlkXCI6IGJlb2JpZFxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHRcdGdldERpc3RadVRQb3AuYWx3YXlzKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHQvLyBUYWJlbGxlbnplaWxlIGJlZ2lubmVuXHJcblx0XHRcdFx0dmFyIGh0bWxfZGlzdHp1dHBvcCA9ICc8dHIgY2xhc3M9XCJmaWVsZGNvbnRhaW4gRGlzdFp1VFBvcFwiPjx0ZCBjbGFzcz1cImxhYmVsXCI+PGxhYmVsIGlkPVwiRGlzdFp1VFBvcF9sYWJlbFwiIGZvcj1cIkRpc3RadVRQb3BcIj5FaW5lciBUZWlscG9wdWxhdGlvbiB6dW9yZG5lbjo8L2xhYmVsPjwvdGQ+PHRkIGNsYXNzPVwiRGF0ZW5mZWxkZXJcIj48ZGl2IGNsYXNzPVwiRGF0ZW5mZWxkZXJcIiBpZD1cIkRpc3RadVRQb3BfRmVsZGVyXCI+JztcclxuXHRcdFx0XHRpZiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIF8uZWFjaChkYXRhLCBmdW5jdGlvbihiZW9iLCBpbmRleCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXg+MCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbF9kaXN0enV0cG9wICs9IFwiPGJyPlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxfZGlzdHp1dHBvcCArPSAnPGlucHV0IHR5cGU9XCJyYWRpb1wiIG5hbWU9XCJEaXN0WnVUUG9wXCIgaWQ9XCJEaXN0WnVUUG9wJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgaHRtbF9kaXN0enV0cG9wICs9IGJlb2IuVFBvcElkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sX2Rpc3R6dXRwb3AgKz0gJ1wiIGNsYXNzPVwiRGlzdFp1VFBvcFwiIGZvcm11bGFyPVwiYmVvYlwiIHZhbHVlPVwiJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgaHRtbF9kaXN0enV0cG9wICs9IGJlb2IuVFBvcElkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sX2Rpc3R6dXRwb3AgKz0gJ1wiIERpc3RadVRQb3A9XCInO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sX2Rpc3R6dXRwb3AgKz0gYmVvYi5EaXN0WnVUUG9wO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sX2Rpc3R6dXRwb3AgKz0gJ1wiPic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdlbm4gVFBvcCBrZWluZSBLb29yZGluYXRlbiBoYWJlbiwgZGllcyBhbnplaWdlbiB1bmQgQW56ZWlnZSB2b24gTkFOIHZlcmhpbmRlcm5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KGJlb2IuRGlzdFp1VFBvcCwgMTApID49IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxfZGlzdHp1dHBvcCArPSBwYXJzZUludChiZW9iLkRpc3RadVRQb3ApICsgXCJtOiBcIiArIGJlb2IuVFBvcEZsdXJuYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbF9kaXN0enV0cG9wICs9IGJlb2IuVFBvcEZsdXJuYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblx0XHRcdFx0XHQvLyBUYWJlbGxlbnplaWxlIGFic2NobGllc3NlblxyXG5cdFx0XHRcdFx0aHRtbF9kaXN0enV0cG9wICs9ICc8L2Rpdj48L3RkPjwvdHI+JztcclxuXHJcblx0XHRcdFx0XHQvLyBkaXN0enV0cG9wIGJlcmVpdHN0ZWxsZW5cclxuXHRcdFx0XHRcdCQoXCIjYmVvYl96dW9yZG51bmdzZmVsZGVyXCIpLmh0bWwoaHRtbF9kaXN0enV0cG9wKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgJEJlb2JCZW1lcmt1bmdlbi5hdHRyKFwicGxhY2Vob2xkZXJcIiwgXCJcIik7XHJcblxyXG5cdFx0XHRcdFx0aWYgKGJlb2Jfc3RhdHVzICE9PSBcIm5pY2h0X2JldXJ0ZWlsdFwiKSB7XHJcblx0XHRcdFx0XHRcdC8vIERhdGVuIGRlciBadW9yZG51bmcgaG9sZW5cclxuXHRcdFx0XHRcdFx0dmFyIGdldEJlb2JadW9yZG51bmcgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHRcdHR5cGU6ICdnZXQnLFxyXG5cdFx0XHRcdFx0XHRcdHVybDogJ3BocC9iZW9iX3p1b3JkbnVuZy5waHAnLFxyXG5cdFx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFx0XCJpZFwiOiBiZW9iaWRcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRnZXRCZW9iWnVvcmRudW5nLmFsd2F5cyhmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0XHRcdFx0Ly8gRmVsZGVyIG1pdCBEYXRlbiBiZWxpZWZlcm5cclxuXHRcdFx0XHRcdFx0XHQkKFwiI0Jlb2JOaWNodEJldXJ0ZWlsdFwiKS5wcm9wKFwiY2hlY2tlZFwiLCBmYWxzZSk7XHJcblx0XHRcdFx0XHRcdFx0aWYgKGRhdGEuQmVvYk5pY2h0WnVvcmRuZW4gPT0gMSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0JChcIiNCZW9iTmljaHRadW9yZG5lblwiKS5wcm9wKFwiY2hlY2tlZFwiLCB0cnVlKTtcclxuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0JChcIiNCZW9iTmljaHRadW9yZG5lblwiKS5wcm9wKFwiY2hlY2tlZFwiLCBmYWxzZSk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdCQoXCIjRGlzdFp1VFBvcFwiK2RhdGEuVFBvcElkKS5wcm9wKFwiY2hlY2tlZFwiLCB0cnVlKTtcclxuXHRcdFx0XHRcdFx0XHQkKFwiI0Jlb2JCZW1lcmt1bmdlblwiKS52YWwoZGF0YS5CZW9iQmVtZXJrdW5nZW4pO1xyXG5cdFx0XHRcdFx0XHRcdCQoXCIjQmVvYk11dFdhbm5cIikudmFsKGRhdGEuQmVvYk11dFdhbm4pO1xyXG5cdFx0XHRcdFx0XHRcdCQoXCIjQmVvYk11dFdlclwiKS52YWwoZGF0YS5CZW9iTXV0V2VyKTtcclxuXHJcblx0XHRcdFx0XHRcdFx0Ly8gRm9ybXVsYXJlIGJsZW5kZW5cclxuXHRcdFx0XHRcdFx0XHQvLyBudXIsIHdlbm4gb2huZV96dV96ZWlnZW4gbmljaHQgdHJ1ZSBpc3QgKHRydWUsIHVtIGluIGRpYWxvZyBhbnp1emVpZ2VuKVxyXG5cdFx0XHRcdFx0XHRcdGlmICghb2huZV96dV96ZWlnZW4pIHtcclxuXHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuemVpZ2VGb3JtdWxhcihcImJlb2JcIik7XHJcblx0XHRcdFx0XHRcdFx0XHRpZiAoYmVvYl9zdGF0dXMgPT09IFwienVnZW9yZG5ldFwiKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGhpc3RvcnkucmVwbGFjZVN0YXRlKHtiZW9iX3p1Z2VvcmRuZXQ6IFwiYmVvYl96dWdlb3JkbmV0XCJ9LCBcImJlb2JfenVnZW9yZG5ldFwiLCBcImluZGV4Lmh0bWw/YXA9XCIgKyBsb2NhbFN0b3JhZ2UuYXBfaWQgKyBcIiZwb3A9XCIgKyBsb2NhbFN0b3JhZ2UucG9wX2lkICsgXCImdHBvcD1cIiArIGxvY2FsU3RvcmFnZS50cG9wX2lkICsgXCImYmVvYl96dWdlb3JkbmV0PVwiICsgYmVvYmlkKTtcclxuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoYmVvYl9zdGF0dXMgPT09IFwibmljaHRfenV6dW9yZG5lblwiKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGhpc3RvcnkucmVwbGFjZVN0YXRlKHtiZW9iX25pY2h0X3p1enVvcmRuZW46IFwiYmVvYl9uaWNodF96dXp1b3JkbmVuXCJ9LCBcImJlb2JfbmljaHRfenV6dW9yZG5lblwiLCBcImluZGV4Lmh0bWw/YXA9XCIgKyBsb2NhbFN0b3JhZ2UuYXBfaWQgKyBcIiZiZW9iX25pY2h0X3p1enVvcmRuZW49XCIgKyBiZW9iaWQpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHQvLyBiZW9iX3N0YXR1cyBpc3QgXCJuaWNodCBiZXVydGVpbHRcIlxyXG5cdFx0XHRcdFx0XHQkKFwiI0Jlb2JOaWNodEJldXJ0ZWlsdFwiKS5wcm9wKFwiY2hlY2tlZFwiLCB0cnVlKTtcclxuXHRcdFx0XHRcdFx0JChcIiNCZW9iTmljaHRadW9yZG5lblwiKS5wcm9wKFwiY2hlY2tlZFwiLCBmYWxzZSk7XHJcblx0XHRcdFx0XHRcdC8vIGFsbGbDpGxsaWdlIGltIGxldHplbiBiZW9iIGVudGhhbHRlbmUgV2VydGUgZW50ZmVybmVuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRCZW9iQmVtZXJrdW5nZW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC52YWwoXCJcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwicGxhY2Vob2xkZXJcIiwgXCJCZW1lcmt1bmdlbiBzaW5kIG51ciBpbiB6dWdlb3JkbmV0ZW4gb2RlciBuaWNodCB6dXp1b3JkbmVuZGVuIEJlb2JhY2h0dW5nZW4gbcO2Z2xpY2hcIik7XHJcblx0XHRcdFx0XHRcdC8vIEZvcm11bGFyZSBibGVuZGVuXHJcblx0XHRcdFx0XHRcdC8vIG51ciwgd2VubiBvaG5lX3p1X3plaWdlbiBuaWNodCB0cnVlIGlzdCAodHJ1ZSwgdW0gaW4gZGlhbG9nIGFuenV6ZWlnZW4pXHJcblx0XHRcdFx0XHRcdGlmICghb2huZV96dV96ZWlnZW4pIHtcclxuXHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLnplaWdlRm9ybXVsYXIoXCJiZW9iXCIpO1xyXG5cdFx0XHRcdFx0XHRcdGhpc3RvcnkucmVwbGFjZVN0YXRlKHtiZW9iX25pY2h0X2JldXJ0ZWlsdDogXCJiZW9iX25pY2h0X2JldXJ0ZWlsdFwifSwgXCJiZW9iX25pY2h0X2JldXJ0ZWlsdFwiLCBcImluZGV4Lmh0bWw/YXA9XCIgKyBsb2NhbFN0b3JhZ2UuYXBfaWQgKyBcIiZiZW9iX25pY2h0X2JldXJ0ZWlsdD1cIiArIGJlb2JpZCk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59O1xyXG5cclxud2luZG93LmFwZi5pbml0aWllcmVfZXhwb3J0ZSA9IGZ1bmN0aW9uKGFuY2hvcikge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQkKFwiI3Rlc3RhcnRfZGl2XCIpLmhpZGUoKTtcclxuXHQkKFwiI2Zvcm1zX3RpdGVsemVpbGVcIikuaGlkZSgpO1xyXG5cdHdpbmRvdy5hcGYuemVpZ2VGb3JtdWxhcihcImV4cG9ydGVcIik7XHJcblx0aGlzdG9yeS5yZXBsYWNlU3RhdGUoe2V4OiBcImV4XCJ9LCBcImV4XCIsIFwiaW5kZXguaHRtbD9leHBvcnRlPXRydWVcIik7XHJcblx0aWYgKGFuY2hvcikge1xyXG5cdFx0bG9jYXRpb24uaGFzaCA9IFwiI1wiICsgYW5jaG9yO1xyXG5cdH1cclxufTtcclxuXHJcbi8vIG1hbmFnZWQgZGllIFNpY2h0YmFya2VpdCB2b24gRm9ybXVsYXJlblxyXG4vLyB3aXJkIHZvbiBhbGxlbiBpbml0aWllcmVfLUZ1bmt0aW9uZW4gdmVyd2VuZGV0XHJcbi8vIHdpcmQgZWluIEZvcm11bGFybmFtZSDDvGJlcmdlYmVuLCB3aXJkIGRpZXNlcyBGb3JtdWxhciBnZXplaWd0XHJcbi8vIHVuZCBhbGxlIGFuZGVyZW4gYXVzZ2VibGVuZGV0XHJcbi8vIHp1c8OkdHpsaWNoIHdpcmQgZGllIEjDtmhlIHZvbiB0ZXh0aW5wdXQtRmVsZGVybiBhbiBkZW4gVGV4dGluaGFsdCBhbmdlcGFzc3Rcclxud2luZG93LmFwZi56ZWlnZUZvcm11bGFyID0gZnVuY3Rpb24oRm9ybXVsYXJuYW1lKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBmb3JtdWxhcl9hbmdlemVpZ3QgPSAkLkRlZmVycmVkKCksXHJcbiAgICAgICAgJGZvcm1zID0gJChcIiNmb3Jtc1wiKSxcclxuICAgICAgICAkZm9ybSA9ICQoJ2Zvcm0nKSxcclxuICAgICAgICAkdGVzdGFydF9kaXYgPSAkKFwiI3Rlc3RhcnRfZGl2XCIpLFxyXG4gICAgICAgICRmb3Jtc190aXRlbHplaWxlID0gJChcIiNmb3Jtc190aXRlbHplaWxlXCIpLFxyXG4gICAgICAgICRhcF93YWVobGVuID0gJChcIiNhcF93YWVobGVuXCIpLFxyXG4gICAgICAgICRGb3JtdWxhcm5hbWU7XHJcblx0Ly8genVlcnN0IGFsbGUgRm9ybXVsYXJlIGF1c2JsZW5kZW5cclxuICAgICRmb3Jtcy5oaWRlKCk7XHJcbiAgICAkZm9ybS5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0JCh0aGlzKS5oaWRlKCk7XHJcblx0fSk7XHJcblx0Ly8gS2FydGVuIHNpbmQgaW4gZGl2IHN0YXR0IGZvcm1cclxuXHQkKCcua2FydGUnKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0JCh0aGlzKS5oaWRlKCk7XHJcblx0fSk7XHJcblxyXG5cdC8vIGRhbWl0IGthbm4gYmVpIEdyw7Zzc2Vuw6RuZGVydW5nIGRpZSBGb3JtdWxhcmjDtmhlIHZvbiBLYXJ0ZW4gZ2VtYW5hZ3Qgd2VyZGVuXHJcblx0d2luZG93LmFwZi5rYXJ0ZW5ow7ZoZV9tYW51ZWxsID0gZmFsc2U7XHJcblx0Ly8gaMO2aGUgdm9uIGZvcm1zIGF1ZiBhdXRvIHNldHplbiwgd2VpbCBkaWVzIHZvbiBkZW4gS2FydGVuYW5zaWNodGVuIHZlcsOkbmRlcnQgd2lyZFxyXG4gICAgJGZvcm1zLmhlaWdodCgnYXV0bycpO1xyXG4gICAgJHRlc3RhcnRfZGl2LmhpZGUoKTtcclxuICAgICRmb3Jtc190aXRlbHplaWxlLmhpZGUoKTtcclxuXHQvLyBUaXRlbHplaWxlIGFuemVpZ2VuLCB3ZWlsIHNpZSBmw7xyIGRpZSBLYXJ0ZW5hbnplaWdlIGVudGZlcm50IHdpcmRcclxuXHQvLyQoXCIjZm9ybXNfdGl0ZWx6ZWlsZVwiKS5jc3MoXCJkaXNwbGF5XCIsIFwiaW5saW5lLWJsb2NrXCIpO1xyXG5cdC8vIEJlaSBUZXN0YXJ0ZW4gSGlud2VpcyBhbnplaWdlblxyXG5cdGlmICgkYXBfd2FlaGxlbi52YWwoKSkge1xyXG5cdFx0Ly8gdGl0ZWx6ZWlsZSBpbmxpbmUsIHNvbnN0IGdpYnQgZXMgZWluZW4gdW5zY2jDtm5lbiBBYnN0YW5kIG5hY2ggb2JlblxyXG5cdFx0Ly8kKFwiI2Zvcm1zX3RpdGVsemVpbGVcIikuY3NzKFwiZGlzcGxheVwiLCBcImlubGluZVwiKTtcclxuICAgICAgICAkZm9ybXNfdGl0ZWx6ZWlsZS5jc3MoXCJkaXNwbGF5XCIsIFwibm9uZVwiKTtcclxuXHRcdGlmICgkYXBfd2FlaGxlbi52YWwoKSA8PSAxNTAgJiYgRm9ybXVsYXJuYW1lICE9PSBcImpiZXJfdWViZXJzaWNodFwiICYmIEZvcm11bGFybmFtZSAhPT0gXCJleHBvcnRlXCIgJiYgRm9ybXVsYXJuYW1lICE9PSBcIkdlb0FkbWluS2FydGVcIikge1xyXG4gICAgICAgICAgICAvLyB0aXRlbHplaWxlIGlubGluZS1ibG9jaywgc29uc3Qgd2VyZGVuIFRhYnMgbmFjaCByZWNodHMgdmVyc2Nob2JlblxyXG4gICAgICAgICAgICAkKFwiI2Zvcm1zX3RpdGVsemVpbGVcIikuY3NzKFwiZGlzcGxheVwiLCBcImlubGluZS1ibG9ja1wiKTtcclxuICAgICAgICAgICAgJHRlc3RhcnRfZGl2XHJcbiAgICAgICAgICAgICAgICAuY3NzKFwiY29sb3JcIiwgXCIjMDM5NzBGXCIpXHJcbiAgICAgICAgICAgICAgICAuc2hvdygpXHJcbiAgICAgICAgICAgICAgICAuaHRtbChcIkRhcyBpc3QgZWluZSBUZXN0YXJ0IC0gaGllciBrYW5uIG1hbiBhbGxlcyBhdXNwcm9iaWVyZW4hXCIpO1xyXG5cdFx0fSBlbHNlIGlmICgkKFwiI2FwX3dhZWhsZW5cIikudmFsKCkgPD0gMTUwICYmIEZvcm11bGFybmFtZSA9PT0gXCJqYmVyX3VlYmVyc2ljaHRcIikge1xyXG4gICAgICAgICAgICAkKFwiI2Zvcm1zX3RpdGVsemVpbGVcIikuY3NzKFwiZGlzcGxheVwiLCBcImlubGluZS1ibG9ja1wiKTtcclxuICAgICAgICAgICAgJHRlc3RhcnRfZGl2XHJcbiAgICAgICAgICAgICAgICAuY3NzKFwiY29sb3JcIiwgXCIjREYwMzAzXCIpXHJcbiAgICAgICAgICAgICAgICAuc2hvdygpXHJcbiAgICAgICAgICAgICAgICAuaHRtbChcIlZvcnNpY2h0OiBEaWUgw5xiZXJpY2h0IGlzdCBmw7xyIGFsbGUgQXJ0ZW4sIGRhaGVyIEhJRVIgTklDSFQgVEVTVEVOXCIpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0aWYgKEZvcm11bGFybmFtZSkge1xyXG4gICAgICAgICRmb3Jtcy5zaG93KCk7XHJcblx0XHQkKFwiI2FwX2xvZXNjaGVuXCIpLnNob3coKTtcclxuXHRcdCQoXCIjZXhwb3J0aWVyZW5fMVwiKS5oaWRlKCk7XHJcblx0XHRpZiAoRm9ybXVsYXJuYW1lID09PSBcImdvb2dsZV9rYXJ0ZVwiIHx8IEZvcm11bGFybmFtZSA9PT0gXCJHZW9BZG1pbkthcnRlXCIpIHtcclxuXHRcdFx0Ly8gVGl0ZWx6ZWlsZSBlbnRmZXJuZW5cclxuXHRcdFx0JChcIiNmb3Jtc190aXRlbHplaWxlXCIpLmNzcyhcImRpc3BsYXlcIiwgXCJub25lXCIpO1xyXG5cdFx0XHQvLyBow7ZoZSBlaW5zdGVsbGVuXHJcbiAgICAgICAgICAgICRGb3JtdWxhcm5hbWUgPSAkKFwiI1wiICsgRm9ybXVsYXJuYW1lKTtcclxuICAgICAgICAgICAgJEZvcm11bGFybmFtZS5jc3MoXCJoZWlnaHRcIiwgJCh3aW5kb3cpLmhlaWdodCgpLTE3ICsgXCJweFwiKTtcclxuXHRcdFx0Ly8gbWFya2llcmVuLCBkYXNzIGRpZSBGb3JtdWxhcmjDtmhlIGFuZGVycyBnZXNldHp0IHdlcmRlbiBzb2xsXHJcblx0XHRcdHdpbmRvdy5hcGYua2FydGVuaMO2aGVfbWFudWVsbCA9IHRydWU7XHJcblx0XHRcdHdpbmRvdy5hcGYuc2V0emVLYXJ0ZW5ow7ZoZSgpO1xyXG4gICAgICAgICAgICAkRm9ybXVsYXJuYW1lLnNob3coKTtcclxuXHRcdFx0aWYgKEZvcm11bGFybmFtZSA9PT0gXCJHZW9BZG1pbkthcnRlXCIpIHtcclxuXHRcdFx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZU9sbWFwKCk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSB7XHJcbiAgICAgICAgICAgICRmb3Jtcy5jc3MoXCJiYWNrZ3JvdW5kLWNvbG9yXCIsIFwiI0ZGRVwiKTtcclxuICAgICAgICAgICAgJGZvcm0uZWFjaChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHQkKHRoaXMpLmhpZGUoKTtcclxuXHRcdFx0XHRpZiAoJCh0aGlzKS5hdHRyKFwiaWRcIikgPT09IEZvcm11bGFybmFtZSkge1xyXG5cdFx0XHRcdFx0JCh0aGlzKS5zaG93KCk7XHJcblx0XHRcdFx0XHQkKCd0ZXh0YXJlYScpLmVhY2goZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZml0VGV4dGFyZWFUb0NvbnRlbnQodGhpcywgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0XHQkKHdpbmRvdykuc2Nyb2xsVG9wKDApO1xyXG5cdFx0fVxyXG5cdFx0Zm9ybXVsYXJfYW5nZXplaWd0LnJlc29sdmUoKTtcclxuXHR9XHJcblx0cmV0dXJuIGZvcm11bGFyX2FuZ2V6ZWlndC5wcm9taXNlKCk7XHJcbn07XHJcblxyXG4vLyBsZWVydCBhbGxlIEZlbGRlciB1bmQgc3RlbGx0IGlocmUgQnJlaXRlIGVpblxyXG53aW5kb3cuYXBmLmxlZXJlRmVsZGVyVm9uRm9ybXVsYXIgPSBmdW5jdGlvbihGb3JtdWxhcikge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQkKCcjJyArIEZvcm11bGFyICsgJyBpbnB1dFt0eXBlPVwidGV4dFwiXScpLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdCQodGhpcykudmFsKFwiXCIpO1xyXG5cdH0pO1xyXG5cdCQoJyMnICsgRm9ybXVsYXIgKyAnIGlucHV0W3R5cGU9XCJyYWRpb1wiXTpjaGVja2VkJykuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0JCh0aGlzKS5wcm9wKCdjaGVja2VkJywgZmFsc2UpO1xyXG5cdH0pO1xyXG5cdCQoJyMnICsgRm9ybXVsYXIgKyAnIHNlbGVjdCcpLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdCQodGhpcykudmFsKFwiXCIpO1xyXG5cdH0pO1xyXG59O1xyXG5cclxuLy8gYmVncmVuenQgZGllIG1heGltYWxlIEjDtmhlIGRlcyBCYXVtcyBhdWYgZGllIFNlaXRlbmjDtmhlLCB3ZW5uIG7DtnRpZ1xyXG53aW5kb3cuYXBmLnNldHplVHJlZWjDtmhlID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICgkKHdpbmRvdykud2lkdGgoKSA+IDEwMDApIHtcclxuXHRcdGlmICgoJChcIi5qc3RyZWUtbm8taWNvbnNcIikuaGVpZ2h0KCkgKyAxNTcpID4gJCh3aW5kb3cpLmhlaWdodCgpKSB7XHJcblx0XHRcdCQoXCIjdHJlZVwiKS5jc3MoXCJtYXgtaGVpZ2h0XCIsICQod2luZG93KS5oZWlnaHQoKSAtIDEzOSk7XHJcblx0XHR9XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vIFNwYWx0ZW4gc2luZCB1bnRlcmVpbmFuZGVyLiBCYXVtIDc1cHggd2VuaWdlciBob2NoLCBkYW1pdCBGb3JtdWxhcmUgaW1tZXIgZXJyZWljaHQgd2VyZGVuIGvDtm5uZW5cclxuXHRcdGlmICgoJChcIi5qc3RyZWUtbm8taWNvbnNcIikuaGVpZ2h0KCkgKyAxNTcpID4gJCh3aW5kb3cpLmhlaWdodCgpLTc1KSB7XHJcblx0XHRcdCQoXCIjdHJlZVwiKS5jc3MoXCJtYXgtaGVpZ2h0XCIsICQod2luZG93KS5oZWlnaHQoKSAtIDIyMCk7XHJcblx0XHR9XHJcblx0fVxyXG59O1xyXG5cclxud2luZG93LmFwZi5zZXR6ZUthcnRlbmjDtmhlID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG4gICAgdmFyIGx5dF9tYXhfaGVpZ2h0ID0gd2luZG93LmFwZi5iZXJlY2huZU9sbWFwTGF5ZXJ0cmVlTWF4aMO2aGUsXHJcbiAgICBcdGZvcm1zX2hlaWdodCxcclxuICAgIFx0bWF4X3dpZHRoO1xyXG5cdC8vIEZvcm11bGFyZSBzaW5kIHVuYmVncmVuenQgaG9jaCBhYmVyIEthcnRlbiBzb2xsZW4gZGFzIG5pY2h0IHNlaW5cclxuXHRpZiAod2luZG93LmFwZi5rYXJ0ZW5ow7ZoZV9tYW51ZWxsKSB7XHJcblx0XHRmb3Jtc19oZWlnaHQgPSAkKHdpbmRvdykuaGVpZ2h0KCkgLSAxNztcclxuXHRcdG1heF93aWR0aCA9ICQoXCIjZm9ybXNcIikud2lkdGgoKTtcclxuICAgICAgICAvLyByZXNpemFibGUgbmV1IHJlY2huZW4gbGFzc2VuLCBzb25zdCBibGVpYnQgZ2Ffa2FydGVuX2RpdiBpbiBmYWxzY2hlciBHcsO2c3NlXHJcbiAgICAgICAgLy8gbGVpZGVyIGZ1bmt0aW9uaWVydCBkYXMgbmljaHQgd2llIGdld8O8bnNjaHQ6XHJcbiAgICAgICAgLy8gd2VubiBkZXIgQmVudXR6ZXIgZGllIEdyw7Zzc2UgdmVyw6RuZGVydCBoYXQsIHBhc3N0IHNpY2ggZ2Ffa2FydGVuX2RpdiBuaWNodCBtZWhyIHJpY2h0aWcgYW4gVmVyw6RuZGVydW5nZW4gZGVzIEJpbGRzY2hpcm1zIGFuLi4uXHJcbiAgICAgICAgLy8kKCcuYXBmLXJlc2l6YWJsZScpLnJlc2l6YWJsZSgnZGVzdHJveScpO1xyXG4gICAgICAgIC8vJCgnLmFwZi1yZXNpemFibGUnKS5yZXNpemFibGUoKTtcclxuICAgICAgICAvKiQoJy5hcGYtcmVzaXphYmxlJykucmVzaXphYmxlKHtcclxuICAgICAgICBcdG1heFdpZHRoOiBtYXhfd2lkdGgsXHJcblx0XHRcdG1heEhlaWdodDogZm9ybXNfaGVpZ2h0XHJcbiAgICAgICAgfSk7Ki9cclxuXHRcdCQoXCIjZm9ybXNcIikuaGVpZ2h0KGZvcm1zX2hlaWdodCk7XHJcblx0XHQkKCcjZ2Ffa2FydGVuX2RpdicpXHJcblx0XHRcdC8vLmNzcygnd2lkdGgnLCBtYXhfd2lkdGgpXHJcblx0XHRcdC5jc3MoJ21heC13aWR0aCcsIG1heF93aWR0aClcclxuXHRcdFx0Ly8uY3NzKCdoZWlnaHQnLCBmb3Jtc19oZWlnaHQpXHJcblx0XHRcdC5jc3MoJ21heC1oZWlnaHQnLCBmb3Jtc19oZWlnaHQpO1xyXG5cdFx0JCgnLmFwZi1yZXNpemFibGUnKS5yZXNpemFibGUoKTtcclxuXHRcdGlmICh3aW5kb3cuYXBmLm9sbWFwICYmIHdpbmRvdy5hcGYub2xtYXAubWFwKSB7XHJcblx0XHRcdHdpbmRvdy5hcGYub2xtYXAubWFwLnVwZGF0ZVNpemUoKTtcclxuXHRcdFx0Ly8gTWF4aW1hbGdyw7Zzc2UgZGVzIExheWVydHJlZSBiZWdyZW56ZW5cclxuICAgICAgICAgICAgJCgnI29sbWFwX2xheWVydHJlZV9sYXllcnMnKS5jc3MoJ21heC1oZWlnaHQnLCBseXRfbWF4X2hlaWdodCk7XHJcbiAgICAgICAgfVxyXG5cdFx0aWYgKHR5cGVvZiBnb29nbGUgIT09IFwidW5kZWZpbmVkXCIgJiYgZ29vZ2xlLm1hcHMgJiYgd2luZG93LmFwZi5nbWFwICYmIHdpbmRvdy5hcGYuZ21hcC5tYXAgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKHdpbmRvdy5hcGYuZ21hcC5tYXAsICdyZXNpemUnKTtcclxuXHRcdH1cclxuXHR9IGVsc2Uge1xyXG5cdFx0JChcIiNmb3Jtc1wiKS5oZWlnaHQoJ2F1dG8nKTtcclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLm9sbWFwLmJsZW5kZU9sbWFwRXhwb3J0aWVyZW4gPSBmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIHZhciBtYXBfc2l6ZSxcclxuICAgICAgICBhbnpfa2FydGVucGl4ZWwsXHJcbiAgICAgICAgdG9vbHRpcF90aXRsZTtcclxuICAgIG1hcF9zaXplID0gd2luZG93LmFwZi5vbG1hcC5tYXAuZ2V0U2l6ZSgpO1xyXG4gICAgLy8gcmVzb2x1dGlvbiBuaWNodCBiZXLDvGNrc2ljaHRpZ2VuIC0gZGFzIGZ1bmt0aW9uaWVydGUgbmljaHQgenV2ZXJsw6Rzc2lnIHVuZCBnYWIgUHJvYmxlbWVcclxuICAgIGFuel9rYXJ0ZW5waXhlbCA9IC8qd2luZG93LmFwZi5vbG1hcC5tYXAuZ2V0VmlldygpLmdldFJlc29sdXRpb24oKSAqICovbWFwX3NpemVbMF0gKiBtYXBfc2l6ZVsxXTtcclxuICAgIGlmIChhbnpfa2FydGVucGl4ZWwgPiA1MDAwMDApIHtcclxuICAgICAgICAkKCcjb2xtYXBfZXhwb3J0aWVyZW4nKS5idXR0b24oXCJkaXNhYmxlXCIpO1xyXG4gICAgICAgIHRvb2x0aXBfdGl0bGUgPSAnS2FydGUgYWxzIHBuZyBoZXJ1bnRlcmxhZGVuPGJyPkRpZXNlIEZ1bmt0aW9uIGlzdCBpbmFrdGl2PGJyPlVtIHNpZSB6dSBha3RpdmllcmVuLCBtw7xzc2VuIFNpZSBkaWUgS2FydGUgdmVya2xlaW5lcm48YnI+UGFja2VuIFNpZSBkYXp1IGRpZSB1bnRlcmUgcmVjaHRlIEVja2UgdW5kIHppZWhlbiBTaWUgc2llIG5hY2ggb2JlbiBsaW5rcyc7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgICQoJyNvbG1hcF9leHBvcnRpZXJlbicpLmJ1dHRvbihcImVuYWJsZVwiKTtcclxuICAgICAgICB0b29sdGlwX3RpdGxlID0gJ0thcnRlIGFscyBwbmcgaGVydW50ZXJsYWRlbic7XHJcbiAgICB9XHJcbiAgICAkKFwiI29sbWFwX2V4cG9ydGllcmVuX2RpdlwiKS50b29sdGlwKHtcclxuICAgICAgICB0b29sdGlwQ2xhc3M6IFwidG9vbHRpcC1zdHlsaW5nLWhpbnRlcmxlZ3RcIixcclxuICAgICAgICBjb250ZW50OiB0b29sdGlwX3RpdGxlXHJcbiAgICB9KTtcclxufTtcclxuXHJcbndpbmRvdy5hcGYuYmVyZWNobmVPbG1hcExheWVydHJlZU1heGjDtmhlID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgbHl0X21heF9oZWlnaHQ7XHJcbiAgICBpZiAoJCh3aW5kb3cpLndpZHRoKCkgPiAxMDAwKSB7XHJcbiAgICAgICAgbHl0X21heF9oZWlnaHQgPSAkKHdpbmRvdykuaGVpZ2h0KCkgLSAxMTU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIFNwYWx0ZW4gc2luZCB1bnRlcmVpbmFuZGVyXHJcbiAgICAgICAgbHl0X21heF9oZWlnaHQgPSAyMDA7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbHl0X21heF9oZWlnaHQ7XHJcbn07XHJcblxyXG4oZnVuY3Rpb24oJCkge1xyXG5cdCQuZm4uaGFzU2Nyb2xsQmFyID0gZnVuY3Rpb24oKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5nZXQoMCkuc2Nyb2xsSGVpZ2h0ID4gdGhpcy5oZWlnaHQoKTtcclxuXHR9XHJcbn0pKGpRdWVyeSk7XHJcblxyXG4vLyBzZXR6dCBkaWUgSMO2aGUgdm9uIHRleHRhcmVhcyBzbywgZGFzcyBkZXIgVGV4dCBnZW5hdSByZWluIHBhc3N0XHJcbndpbmRvdy5hcGYuZml0VGV4dGFyZWFUb0NvbnRlbnQgPSBmdW5jdGlvbihpZCwgbWF4SGVpZ2h0KSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG4gICB2YXIgdGV4dCA9IGlkICYmIGlkLnN0eWxlID8gaWQgOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XHJcbiAgIGlmICghdGV4dClcclxuXHQgIHJldHVybjtcclxuXHJcbiAgIC8qIEFjY291bnRzIGZvciByb3dzIGJlaW5nIGRlbGV0ZWQsIHBpeGVsIHZhbHVlIG1heSBuZWVkIGFkanVzdGluZyAqL1xyXG4gICBpZiAodGV4dC5jbGllbnRIZWlnaHQgPT0gdGV4dC5zY3JvbGxIZWlnaHQpIHtcclxuXHQgIHRleHQuc3R5bGUuaGVpZ2h0ID0gXCIzMHB4XCI7XHJcbiAgIH1cdCAgIFxyXG5cclxuICAgdmFyIGFkanVzdGVkSGVpZ2h0ID0gdGV4dC5jbGllbnRIZWlnaHQ7XHJcbiAgIGlmICghbWF4SGVpZ2h0IHx8IG1heEhlaWdodCA+IGFkanVzdGVkSGVpZ2h0KSB7XHJcblx0ICBhZGp1c3RlZEhlaWdodCA9IE1hdGgubWF4KHRleHQuc2Nyb2xsSGVpZ2h0LCBhZGp1c3RlZEhlaWdodCk7XHJcblx0ICBpZiAobWF4SGVpZ2h0KVxyXG5cdFx0IGFkanVzdGVkSGVpZ2h0ID0gTWF0aC5taW4obWF4SGVpZ2h0LCBhZGp1c3RlZEhlaWdodCk7XHJcblx0ICBpZiAoYWRqdXN0ZWRIZWlnaHQgPiB0ZXh0LmNsaWVudEhlaWdodClcclxuXHRcdCB0ZXh0LnN0eWxlLmhlaWdodCA9IGFkanVzdGVkSGVpZ2h0ICsgXCJweFwiO1xyXG4gICB9XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLmVyc3RlbGxlX2FwX2xpc3RlID0gZnVuY3Rpb24ocHJvZ3JhbW0pIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGFwbGlzdGVfZXJzdGVsbHQgPSAkLkRlZmVycmVkKCksXHJcblx0XHRnZXRBcGxpc3RlID0gJC5hamF4KHtcclxuXHRcdFx0dHlwZTogJ2dldCcsXHJcblx0XHRcdHVybDogJ2FwaS9hcGxpc3RlL3Byb2dyYW1tPScgKyBwcm9ncmFtbSxcclxuXHRcdFx0ZGF0YVR5cGU6ICdqc29uJ1xyXG5cdFx0fSk7XHJcblx0Z2V0QXBsaXN0ZS5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0dmFyIGh0bWw7XHJcblx0XHRodG1sID0gXCI8b3B0aW9uPjwvb3B0aW9uPlwiO1xyXG4gICAgICAgIF8uZWFjaChkYXRhLCBmdW5jdGlvbihhcCkge1xyXG4gICAgICAgICAgICBodG1sICs9IFwiPG9wdGlvbiB2YWx1ZT1cXFwiXCIgKyBhcC5pZCArIFwiXFxcIj5cIiArIGFwLmFwX25hbWUgKyBcIjwvb3B0aW9uPlwiO1xyXG4gICAgICAgIH0pO1xyXG5cdFx0JChcIiNhcF93YWVobGVuXCIpLmh0bWwoaHRtbCk7XHJcblx0XHRhcGxpc3RlX2Vyc3RlbGx0LnJlc29sdmUoKTtcclxuXHR9KTtcclxuXHRyZXR1cm4gYXBsaXN0ZV9lcnN0ZWxsdC5wcm9taXNlKCk7XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLnfDpGhsZUFwTGlzdGUgPSBmdW5jdGlvbihwcm9ncmFtbSkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgYXBsaXN0ZV9nZXfDpGhsdCA9ICQuRGVmZXJyZWQoKSxcclxuICAgICAgICAkYXBfd2FlaGxlbl9sYWJlbCA9ICQoXCIjYXBfd2FlaGxlbl9sYWJlbFwiKSxcclxuICAgICAgICAkYXBfd2FlaGxlbiA9ICQoXCIjYXBfd2FlaGxlblwiKTtcclxuICAgICRhcF93YWVobGVuX2xhYmVsLmh0bWwoXCJEYXRlbiB3ZXJkZW4gYXVmYmVyZWl0ZXQuLi5cIik7XHJcbiAgICAkYXBfd2FlaGxlbi5odG1sKFwiXCIpO1xyXG5cdCQoXCIjYXBcIikuaGlkZSgpO1xyXG5cdCQoXCIjZm9ybXNcIikuaGlkZSgpO1xyXG5cdCQoJyN0cmVlJykuaGlkZSgpO1xyXG5cdCQoXCIjc3VjaGVuXCIpLmhpZGUoKTtcclxuXHQkKFwiI2V4cG9ydGllcmVuXzJcIikuaGlkZSgpO1xyXG5cdCQoXCIjaGlsZmVcIikuaGlkZSgpO1xyXG5cdCQoXCIjYXBfbG9lc2NoZW5cIikuaGlkZSgpO1xyXG5cdCQoXCIjZXhwb3J0aWVyZW5fMVwiKS5zaG93KCk7XHJcbiAgICAkYXBfd2FlaGxlbi52YWwoXCJcIik7XHJcblx0d2luZG93LmFwZi5pbml0aWllcmVfYXAoKTtcclxuXHQkLndoZW4od2luZG93LmFwZi5lcnN0ZWxsZV9hcF9saXN0ZShwcm9ncmFtbSkpXHJcblx0XHQudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyICRwcm9ncmFtbV93YWhsX2NoZWNrZWQgPSAkKFwiW25hbWU9J3Byb2dyYW1tX3dhaGwnXTpjaGVja2VkXCIpO1xyXG5cdFx0XHRpZiAoJHByb2dyYW1tX3dhaGxfY2hlY2tlZC5hdHRyKFwiaWRcIikgPT09IFwicHJvZ3JhbW1fbmV1XCIpIHtcclxuICAgICAgICAgICAgICAgICRhcF93YWVobGVuX2xhYmVsLmh0bWwoXCJBcnQgZsO8ciBuZXVlcyBGw7ZyZGVycHJvZ3JhbW0gd8OkaGxlbjpcIik7XHJcblx0XHRcdH0gZWxzZSBpZiAoJHByb2dyYW1tX3dhaGxfY2hlY2tlZC5hdHRyKFwiaWRcIikgPT09IFwicHJvZ3JhbW1fYXBcIikge1xyXG4gICAgICAgICAgICAgICAgJGFwX3dhZWhsZW5fbGFiZWwuaHRtbChcIkFrdGlvbnNwbGFuIHfDpGhsZW46XCIpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJGFwX3dhZWhsZW5fbGFiZWwuaHRtbChcIkFydGbDtnJkZXJwcm9ncmFtbSB3w6RobGVuOlwiKTtcclxuXHRcdFx0fVxyXG4gICAgICAgICAgICAkYXBfd2FlaGxlbl9sYWJlbC5zaG93KCk7XHJcblx0XHRcdGFwbGlzdGVfZ2V3w6RobHQucmVzb2x2ZSgpO1xyXG5cdFx0fSk7XHJcblx0cmV0dXJuIGFwbGlzdGVfZ2V3w6RobHQucHJvbWlzZSgpO1xyXG59O1xyXG5cclxud2luZG93LmFwZi5lcnN0ZWxsZV90cmVlID0gZnVuY3Rpb24oQXBBcnRJZCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIganN0cmVlX2Vyc3RlbGx0ID0gJC5EZWZlcnJlZCgpO1xyXG5cdCQoXCIjdHJlZVwiKS5qc3RyZWUoe1xyXG5cdFx0XCJqc29uX2RhdGFcIjoge1xyXG5cdFx0XHRcImFqYXhcIjoge1xyXG5cdFx0XHRcdFwidXJsXCI6IFwiYXBpL3RyZWUvYXA9XCIgKyBBcEFydElkLFxyXG5cdFx0XHRcdFwicHJvZ3Jlc3NpdmVfcmVuZGVyXCI6IHRydWVcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdFwiY29yZVwiOiB7XHJcblx0XHRcdFwib3Blbl9wYXJlbnRzXCI6IHRydWUsXHQvLyB3aXJkIGVpbiBub2RlIHByb2dyYW1tYXRpc2NoIGdlw7ZmZm5ldCwgw7ZmZm5lbiBzaWNoIGFsbGUgcGFyZW50c1xyXG5cdFx0XHRcInN0cmluZ3NcIjoge1x0Ly8gRGV1dHNjaGUgw5xiZXJzZXR6dW5nZW5cclxuXHRcdFx0XHRcImxvYWRpbmdcIjogXCJob2xlIERhdGVuLi4uXCIsXHJcblx0XHRcdFx0XCJuZXdfbm9kZVwiOiBcIm5ldWVyIEtub3RlblwiXHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRcInVpXCI6IHtcclxuXHRcdFx0XCJzZWxlY3RfbGltaXRcIjogMSxcdC8vIG51ciBlaW4gRGF0ZW5zYXR6IGthbm4gYXVmcyBtYWwgZ2V3w6RobHQgd2VyZGVuXHJcblx0XHRcdFwic2VsZWN0ZWRfcGFyZW50X29wZW5cIjogdHJ1ZSxcdC8vIHdlbm4gQ29kZSBlaW5lbiBub2RlIHfDpGhsdCwgd2VyZGVuIGFsbGUgcGFyZW50cyBnZcO2ZmZuZXRcclxuXHRcdFx0XCJzZWxlY3RfcHJldl9vbl9kZWxldGVcIjogdHJ1ZVxyXG5cdFx0fSxcclxuXHRcdFwic2VhcmNoXCI6IHtcclxuXHRcdFx0XCJjYXNlX2luc2Vuc2l0aXZlXCI6IHRydWVcclxuXHRcdH0sXHJcblx0XHRcInNvcnRcIjogZnVuY3Rpb24oYSwgYikge1xyXG5cdFx0XHRpZiAoJChhKS5hdHRyKFwic29ydFwiKSAmJiAkKGIpLmF0dHIoXCJzb3J0XCIpKSB7XHJcblx0XHRcdFx0cmV0dXJuIHBhcnNlSW50KCQoYSkuYXR0cihcInNvcnRcIiksIDEwKSA+IHBhcnNlSW50KCQoYikuYXR0cihcInNvcnRcIiksIDEwKSA/IDEgOiAtMTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdFwidGhlbWVzXCI6IHtcclxuXHRcdFx0XCJpY29uc1wiOiBmYWxzZVxyXG5cdFx0fSxcclxuXHRcdFwiY29udGV4dG1lbnVcIjoge1xyXG5cdFx0XHRcIml0ZW1zXCI6IHdpbmRvdy5hcGYudHJlZUtvbnRleHRtZW51LFxyXG5cdFx0XHRcInNlbGVjdF9ub2RlXCI6IHRydWVcclxuXHRcdH0sXHJcblx0XHRcImNycm1cIjoge1xyXG5cdFx0XHRcIm1vdmVcIjoge1xyXG5cdFx0XHRcdFwiZGVmYXVsdF9wb3NpdGlvblwiOiBcImZpcnN0XCIsXHJcblx0XHRcdFx0XCJjaGVja19tb3ZlXCI6IGZ1bmN0aW9uKG0pIHtcclxuXHRcdFx0XHRcdC8vIGhpZXIgd2lyZCBiZXN0aW1tdCwgd2VsY2hlIGRyYWctZHJvcC1Lb21iaW5hdGlvbmVuIHp1bMOkc3NpZyBzaW5kXHJcblx0XHRcdFx0XHRpZiAobS5vLmF0dHIoXCJ0eXBcIikgPT09IFwicG9wXCIpIHtcclxuXHRcdFx0XHRcdFx0aWYgKG0uci5hdHRyKFwidHlwXCIpID09PSBcInBvcFwiKSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHtcclxuXHRcdFx0XHRcdFx0XHRcdGFmdGVyOiB0cnVlLFxyXG5cdFx0XHRcdFx0XHRcdFx0YmVmb3JlOiB0cnVlLFxyXG5cdFx0XHRcdFx0XHRcdFx0aW5zaWRlOiBmYWxzZVxyXG5cdFx0XHRcdFx0XHRcdH07XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9IGVsc2UgaWYgKG0uby5hdHRyKFwidHlwXCIpID09PSBcInRwb3BcIikge1xyXG5cdFx0XHRcdFx0XHRpZiAobS5yLmF0dHIoXCJ0eXBcIikgPT09IFwidHBvcFwiKSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHtcclxuXHRcdFx0XHRcdFx0XHRcdGFmdGVyOiB0cnVlLFxyXG5cdFx0XHRcdFx0XHRcdFx0YmVmb3JlOiB0cnVlLFxyXG5cdFx0XHRcdFx0XHRcdFx0aW5zaWRlOiBmYWxzZVxyXG5cdFx0XHRcdFx0XHRcdH07XHJcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAobS5yLmF0dHIoXCJ0eXBcIikgPT09IFwicG9wX29yZG5lcl90cG9wXCIpIHtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0YWZ0ZXI6IGZhbHNlLFxyXG5cdFx0XHRcdFx0XHRcdFx0YmVmb3JlOiBmYWxzZSxcclxuXHRcdFx0XHRcdFx0XHRcdGluc2lkZTogdHJ1ZVxyXG5cdFx0XHRcdFx0XHRcdH07XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9IGVsc2UgaWYgKG0uby5hdHRyKFwidHlwXCIpID09PSBcInRwb3BtYXNzblwiKSB7XHJcblx0XHRcdFx0XHRcdGlmIChtLnIuYXR0cihcInR5cFwiKSA9PT0gXCJ0cG9wbWFzc25cIikge1xyXG5cdFx0XHRcdFx0XHRcdHJldHVybiB7XHJcblx0XHRcdFx0XHRcdFx0XHRhZnRlcjogdHJ1ZSxcclxuXHRcdFx0XHRcdFx0XHRcdGJlZm9yZTogdHJ1ZSxcclxuXHRcdFx0XHRcdFx0XHRcdGluc2lkZTogZmFsc2VcclxuXHRcdFx0XHRcdFx0XHR9O1xyXG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKG0uci5hdHRyKFwidHlwXCIpID09PSBcInRwb3Bfb3JkbmVyX21hc3NuXCIpIHtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0YWZ0ZXI6IGZhbHNlLFxyXG5cdFx0XHRcdFx0XHRcdFx0YmVmb3JlOiBmYWxzZSxcclxuXHRcdFx0XHRcdFx0XHRcdGluc2lkZTogdHJ1ZVxyXG5cdFx0XHRcdFx0XHRcdH07XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9IGVsc2UgaWYgKG0uby5hdHRyKFwidHlwXCIpID09PSBcInRwb3BmZWxka29udHJcIikge1xyXG5cdFx0XHRcdFx0XHRpZiAobS5yLmF0dHIoXCJ0eXBcIikgPT09IFwidHBvcGZlbGRrb250clwiKSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHtcclxuXHRcdFx0XHRcdFx0XHRcdGFmdGVyOiB0cnVlLFxyXG5cdFx0XHRcdFx0XHRcdFx0YmVmb3JlOiB0cnVlLFxyXG5cdFx0XHRcdFx0XHRcdFx0aW5zaWRlOiBmYWxzZVxyXG5cdFx0XHRcdFx0XHRcdH07XHJcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAobS5yLmF0dHIoXCJ0eXBcIikgPT09IFwidHBvcF9vcmRuZXJfZmVsZGtvbnRyXCIpIHtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0YWZ0ZXI6IGZhbHNlLFxyXG5cdFx0XHRcdFx0XHRcdFx0YmVmb3JlOiBmYWxzZSxcclxuXHRcdFx0XHRcdFx0XHRcdGluc2lkZTogdHJ1ZVxyXG5cdFx0XHRcdFx0XHRcdH07XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9IGVsc2UgaWYgKG0uby5hdHRyKFwidHlwXCIpID09PSBcInRwb3BmcmVpd2tvbnRyXCIpIHtcclxuXHRcdFx0XHRcdFx0aWYgKG0uci5hdHRyKFwidHlwXCIpID09PSBcInRwb3BmcmVpd2tvbnRyXCIpIHtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0YWZ0ZXI6IHRydWUsXHJcblx0XHRcdFx0XHRcdFx0XHRiZWZvcmU6IHRydWUsXHJcblx0XHRcdFx0XHRcdFx0XHRpbnNpZGU6IGZhbHNlXHJcblx0XHRcdFx0XHRcdFx0fTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIGlmIChtLnIuYXR0cihcInR5cFwiKSA9PT0gXCJ0cG9wX29yZG5lcl9mcmVpd2tvbnRyXCIpIHtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0YWZ0ZXI6IGZhbHNlLFxyXG5cdFx0XHRcdFx0XHRcdFx0YmVmb3JlOiBmYWxzZSxcclxuXHRcdFx0XHRcdFx0XHRcdGluc2lkZTogdHJ1ZVxyXG5cdFx0XHRcdFx0XHRcdH07XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9IGVsc2UgaWYgKG0uby5hdHRyKFwidHlwXCIpID09PSBcImJlb2JfenVnZW9yZG5ldFwiKSB7XHJcblx0XHRcdFx0XHRcdGlmIChtLnIuYXR0cihcInR5cFwiKSA9PT0gXCJiZW9iX3p1Z2VvcmRuZXRcIikge1xyXG5cdFx0XHRcdFx0XHRcdHJldHVybiB7XHJcblx0XHRcdFx0XHRcdFx0XHRhZnRlcjogdHJ1ZSxcclxuXHRcdFx0XHRcdFx0XHRcdGJlZm9yZTogdHJ1ZSxcclxuXHRcdFx0XHRcdFx0XHRcdGluc2lkZTogZmFsc2VcclxuXHRcdFx0XHRcdFx0XHR9O1xyXG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKG0uci5hdHRyKFwidHlwXCIpID09PSBcInRwb3Bfb3JkbmVyX2Jlb2JfenVnZW9yZG5ldFwiKSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHtcclxuXHRcdFx0XHRcdFx0XHRcdGFmdGVyOiBmYWxzZSxcclxuXHRcdFx0XHRcdFx0XHRcdGJlZm9yZTogZmFsc2UsXHJcblx0XHRcdFx0XHRcdFx0XHRpbnNpZGU6IHRydWVcclxuXHRcdFx0XHRcdFx0XHR9O1xyXG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKG0uci5hdHRyKFwidHlwXCIpID09PSBcImFwX29yZG5lcl9iZW9iX25pY2h0X2JldXJ0ZWlsdFwiKSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHtcclxuXHRcdFx0XHRcdFx0XHRcdGFmdGVyOiBmYWxzZSxcclxuXHRcdFx0XHRcdFx0XHRcdGJlZm9yZTogZmFsc2UsXHJcblx0XHRcdFx0XHRcdFx0XHRpbnNpZGU6IHRydWVcclxuXHRcdFx0XHRcdFx0XHR9O1xyXG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKG0uci5hdHRyKFwidHlwXCIpID09PSBcImJlb2JfbmljaHRfYmV1cnRlaWx0XCIpIHtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0YWZ0ZXI6IHRydWUsXHJcblx0XHRcdFx0XHRcdFx0XHRiZWZvcmU6IHRydWUsXHJcblx0XHRcdFx0XHRcdFx0XHRpbnNpZGU6IGZhbHNlXHJcblx0XHRcdFx0XHRcdFx0fTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIGlmIChtLnIuYXR0cihcInR5cFwiKSA9PT0gXCJhcF9vcmRuZXJfYmVvYl9uaWNodF96dXp1b3JkbmVuXCIpIHtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0YWZ0ZXI6IGZhbHNlLFxyXG5cdFx0XHRcdFx0XHRcdFx0YmVmb3JlOiBmYWxzZSxcclxuXHRcdFx0XHRcdFx0XHRcdGluc2lkZTogdHJ1ZVxyXG5cdFx0XHRcdFx0XHRcdH07XHJcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAobS5yLmF0dHIoXCJ0eXBcIikgPT09IFwiYmVvYl9uaWNodF96dXp1b3JkbmVuXCIpIHtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0YWZ0ZXI6IHRydWUsXHJcblx0XHRcdFx0XHRcdFx0XHRiZWZvcmU6IHRydWUsXHJcblx0XHRcdFx0XHRcdFx0XHRpbnNpZGU6IGZhbHNlXHJcblx0XHRcdFx0XHRcdFx0fTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0gZWxzZSBpZiAobS5vLmF0dHIoXCJ0eXBcIikgPT09IFwiYmVvYl9uaWNodF9iZXVydGVpbHRcIikge1xyXG5cdFx0XHRcdFx0XHRpZiAobS5yLmF0dHIoXCJ0eXBcIikgPT09IFwiYmVvYl96dWdlb3JkbmV0XCIpIHtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0YWZ0ZXI6IHRydWUsXHJcblx0XHRcdFx0XHRcdFx0XHRiZWZvcmU6IHRydWUsXHJcblx0XHRcdFx0XHRcdFx0XHRpbnNpZGU6IGZhbHNlXHJcblx0XHRcdFx0XHRcdFx0fTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIGlmIChtLnIuYXR0cihcInR5cFwiKSA9PT0gXCJ0cG9wX29yZG5lcl9iZW9iX3p1Z2VvcmRuZXRcIikge1xyXG5cdFx0XHRcdFx0XHRcdHJldHVybiB7XHJcblx0XHRcdFx0XHRcdFx0XHRhZnRlcjogZmFsc2UsXHJcblx0XHRcdFx0XHRcdFx0XHRiZWZvcmU6IGZhbHNlLFxyXG5cdFx0XHRcdFx0XHRcdFx0aW5zaWRlOiB0cnVlXHJcblx0XHRcdFx0XHRcdFx0fTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIGlmIChtLnIuYXR0cihcInR5cFwiKSA9PT0gXCJhcF9vcmRuZXJfYmVvYl9uaWNodF9iZXVydGVpbHRcIikge1xyXG5cdFx0XHRcdFx0XHRcdHJldHVybiB7XHJcblx0XHRcdFx0XHRcdFx0XHRhZnRlcjogZmFsc2UsXHJcblx0XHRcdFx0XHRcdFx0XHRiZWZvcmU6IGZhbHNlLFxyXG5cdFx0XHRcdFx0XHRcdFx0aW5zaWRlOiB0cnVlXHJcblx0XHRcdFx0XHRcdFx0fTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIGlmIChtLnIuYXR0cihcInR5cFwiKSA9PT0gXCJiZW9iX25pY2h0X2JldXJ0ZWlsdFwiKSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHtcclxuXHRcdFx0XHRcdFx0XHRcdGFmdGVyOiB0cnVlLFxyXG5cdFx0XHRcdFx0XHRcdFx0YmVmb3JlOiB0cnVlLFxyXG5cdFx0XHRcdFx0XHRcdFx0aW5zaWRlOiBmYWxzZVxyXG5cdFx0XHRcdFx0XHRcdH07XHJcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAobS5yLmF0dHIoXCJ0eXBcIikgPT09IFwiYXBfb3JkbmVyX2Jlb2JfbmljaHRfenV6dW9yZG5lblwiKSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHtcclxuXHRcdFx0XHRcdFx0XHRcdGFmdGVyOiBmYWxzZSxcclxuXHRcdFx0XHRcdFx0XHRcdGJlZm9yZTogZmFsc2UsXHJcblx0XHRcdFx0XHRcdFx0XHRpbnNpZGU6IHRydWVcclxuXHRcdFx0XHRcdFx0XHR9O1xyXG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKG0uci5hdHRyKFwidHlwXCIpID09PSBcImJlb2JfbmljaHRfenV6dW9yZG5lblwiKSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHtcclxuXHRcdFx0XHRcdFx0XHRcdGFmdGVyOiB0cnVlLFxyXG5cdFx0XHRcdFx0XHRcdFx0YmVmb3JlOiB0cnVlLFxyXG5cdFx0XHRcdFx0XHRcdFx0aW5zaWRlOiBmYWxzZVxyXG5cdFx0XHRcdFx0XHRcdH07XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9IGVsc2UgaWYgKG0uby5hdHRyKFwidHlwXCIpID09PSBcImJlb2JfbmljaHRfenV6dW9yZG5lblwiKSB7XHJcblx0XHRcdFx0XHRcdGlmIChtLnIuYXR0cihcInR5cFwiKSA9PT0gXCJiZW9iX3p1Z2VvcmRuZXRcIikge1xyXG5cdFx0XHRcdFx0XHRcdHJldHVybiB7XHJcblx0XHRcdFx0XHRcdFx0XHRhZnRlcjogdHJ1ZSxcclxuXHRcdFx0XHRcdFx0XHRcdGJlZm9yZTogdHJ1ZSxcclxuXHRcdFx0XHRcdFx0XHRcdGluc2lkZTogZmFsc2VcclxuXHRcdFx0XHRcdFx0XHR9O1xyXG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKG0uci5hdHRyKFwidHlwXCIpID09PSBcInRwb3Bfb3JkbmVyX2Jlb2JfenVnZW9yZG5ldFwiKSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHtcclxuXHRcdFx0XHRcdFx0XHRcdGFmdGVyOiBmYWxzZSxcclxuXHRcdFx0XHRcdFx0XHRcdGJlZm9yZTogZmFsc2UsXHJcblx0XHRcdFx0XHRcdFx0XHRpbnNpZGU6IHRydWVcclxuXHRcdFx0XHRcdFx0XHR9O1xyXG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKG0uci5hdHRyKFwidHlwXCIpID09PSBcImFwX29yZG5lcl9iZW9iX25pY2h0X2JldXJ0ZWlsdFwiKSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHtcclxuXHRcdFx0XHRcdFx0XHRcdGFmdGVyOiBmYWxzZSxcclxuXHRcdFx0XHRcdFx0XHRcdGJlZm9yZTogZmFsc2UsXHJcblx0XHRcdFx0XHRcdFx0XHRpbnNpZGU6IHRydWVcclxuXHRcdFx0XHRcdFx0XHR9O1xyXG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKG0uci5hdHRyKFwidHlwXCIpID09PSBcImJlb2JfbmljaHRfYmV1cnRlaWx0XCIpIHtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0YWZ0ZXI6IHRydWUsXHJcblx0XHRcdFx0XHRcdFx0XHRiZWZvcmU6IHRydWUsXHJcblx0XHRcdFx0XHRcdFx0XHRpbnNpZGU6IGZhbHNlXHJcblx0XHRcdFx0XHRcdFx0fTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIGlmIChtLnIuYXR0cihcInR5cFwiKSA9PT0gXCJhcF9vcmRuZXJfYmVvYl9uaWNodF96dXp1b3JkbmVuXCIpIHtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0YWZ0ZXI6IGZhbHNlLFxyXG5cdFx0XHRcdFx0XHRcdFx0YmVmb3JlOiBmYWxzZSxcclxuXHRcdFx0XHRcdFx0XHRcdGluc2lkZTogdHJ1ZVxyXG5cdFx0XHRcdFx0XHRcdH07XHJcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAobS5yLmF0dHIoXCJ0eXBcIikgPT09IFwiYmVvYl9uaWNodF96dXp1b3JkbmVuXCIpIHtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0YWZ0ZXI6IHRydWUsXHJcblx0XHRcdFx0XHRcdFx0XHRiZWZvcmU6IHRydWUsXHJcblx0XHRcdFx0XHRcdFx0XHRpbnNpZGU6IGZhbHNlXHJcblx0XHRcdFx0XHRcdFx0fTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRcInR5cGVzXCI6IHtcclxuXHRcdFx0XCJ0eXBlX2F0dHJcIjogXCJ0eXBcIixcclxuXHRcdFx0XCJtYXhfY2hpbGRyZW5cIjogLTIsXHJcblx0XHRcdFwibWF4X2RlcHRoXCI6IC0yLFxyXG5cdFx0XHRcInZhbGlkX2NoaWxkcmVuXCI6IFtcImFwX29yZG5lcl9wb3BcIiwgXCJhcF9vcmRuZXJfYXB6aWVsXCIsIFwiYXBfb3JkbmVyX2VyZmtyaXRcIiwgXCJhcF9vcmRuZXJfamJlclwiLCBcImFwX29yZG5lcl9iZXJcIiwgXCJhcF9vcmRuZXJfYmVvYl9uaWNodF9iZXVydGVpbHRcIiwgXCJhcF9vcmRuZXJfYmVvYl9uaWNodF96dXp1b3JkbmVuXCIsIFwiaWRlYWxiaW90b3BcIiwgXCJhcF9vcmRuZXJfYXNzb3phcnRlblwiXSxcclxuXHRcdFx0XCJ0eXBlc1wiOiB7XHJcblx0XHRcdFx0XCJhcF9vcmRuZXJfcG9wXCI6IHtcclxuXHRcdFx0XHRcdFwidmFsaWRfY2hpbGRyZW5cIjogXCJwb3BcIlxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0XCJwb3BcIjoge1xyXG5cdFx0XHRcdFx0XCJ2YWxpZF9jaGlsZHJlblwiOiBbXCJwb3Bfb3JkbmVyX3Rwb3BcIiwgXCJwb3Bfb3JkbmVyX3BvcGJlclwiLCBcInBvcF9vcmRuZXJfbWFzc25iZXJcIl0sXHJcblx0XHRcdFx0XHRcIm5ld19ub2RlXCI6IFwibmV1ZSBQb3B1bGF0aW9uXCJcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdFwicG9wX29yZG5lcl90cG9wXCI6IHtcclxuXHRcdFx0XHRcdFwidmFsaWRfY2hpbGRyZW5cIjogXCJ0cG9wXCJcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdFwidHBvcFwiOiB7XHJcblx0XHRcdFx0XHRcInZhbGlkX2NoaWxkcmVuXCI6IFtcInRwb3Bfb3JkbmVyX21hc3NuXCIsIFwidHBvcF9vcmRuZXJfbWFzc25iZXJcIiwgXCJ0cG9wX29yZG5lcl9mZWxka29udHJcIiwgXCJ0cG9wX29yZG5lcl9mcmVpd2tvbnRyXCIsIFwidHBvcF9vcmRuZXJfdHBvcGJlclwiLCBcInRwb3Bfb3JkbmVyX2Jlb2JfenVnZW9yZG5ldFwiXSxcclxuXHRcdFx0XHRcdFwibmV3X25vZGVcIjogXCJuZXVlIFRlaWxwb3B1bGF0aW9uXCJcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdFwidHBvcF9vcmRuZXJfbWFzc25cIjoge1xyXG5cdFx0XHRcdFx0XCJ2YWxpZF9jaGlsZHJlblwiOiBcInRwb3BtYXNzblwiXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRcInRwb3BtYXNzblwiOiB7XHJcblx0XHRcdFx0XHRcInZhbGlkX2NoaWxkcmVuXCI6IFwibm9uZVwiLFxyXG5cdFx0XHRcdFx0XCJuZXdfbm9kZVwiOiBcIm5ldWUgTWFzc25haG1lXCJcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdFwidHBvcF9vcmRuZXJfbWFzc25iZXJcIjoge1xyXG5cdFx0XHRcdFx0XCJ2YWxpZF9jaGlsZHJlblwiOiBcInRwb3BtYXNzbmJlclwiXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRcInRwb3BtYXNzbmJlclwiOiB7XHJcblx0XHRcdFx0XHRcInZhbGlkX2NoaWxkcmVuXCI6IFwibm9uZVwiLFxyXG5cdFx0XHRcdFx0XCJuZXdfbm9kZVwiOiBcIm5ldWVyIE1hc3NuYWhtZW4tQmVyaWNodFwiXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRcInRwb3Bfb3JkbmVyX2ZlbGRrb250clwiOiB7XHJcblx0XHRcdFx0XHRcInZhbGlkX2NoaWxkcmVuXCI6IFwidHBvcGZlbGRrb250clwiXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRcInRwb3BmZWxka29udHJcIjoge1xyXG5cdFx0XHRcdFx0XCJ2YWxpZF9jaGlsZHJlblwiOiBcIm5vbmVcIixcclxuXHRcdFx0XHRcdFwibmV3X25vZGVcIjogXCJuZXVlIEZlbGRrb250cm9sbGVcIlxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0XCJ0cG9wX29yZG5lcl9mcmVpd2tvbnRyXCI6IHtcclxuXHRcdFx0XHRcdFwidmFsaWRfY2hpbGRyZW5cIjogXCJ0cG9wZnJlaXdrb250clwiXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRcInRwb3BmcmVpd2tvbnRyXCI6IHtcclxuXHRcdFx0XHRcdFwidmFsaWRfY2hpbGRyZW5cIjogXCJub25lXCIsXHJcblx0XHRcdFx0XHRcIm5ld19ub2RlXCI6IFwibmV1ZSBGcmVpd2lsbGlnZW4tS29udHJvbGxlXCJcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdFwidHBvcF9vcmRuZXJfdHBvcGJlclwiOiB7XHJcblx0XHRcdFx0XHRcInZhbGlkX2NoaWxkcmVuXCI6IFwidHBvcGJlclwiXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRcInRwb3BiZXJcIjoge1xyXG5cdFx0XHRcdFx0XCJ2YWxpZF9jaGlsZHJlblwiOiBcIm5vbmVcIixcclxuXHRcdFx0XHRcdFwibmV3X25vZGVcIjogXCJuZXVlciBUZWlscG9wdWxhdGlvbnMtQmVyaWNodFwiXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRcInRwb3Bfb3JkbmVyX2Jlb2JfenVnZW9yZG5ldFwiOiB7XHJcblx0XHRcdFx0XHRcInZhbGlkX2NoaWxkcmVuXCI6IFwiYmVvYl96dWdlb3JkbmV0XCJcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdFwiYmVvYl96dWdlb3JkbmV0XCI6IHtcclxuXHRcdFx0XHRcdFwidmFsaWRfY2hpbGRyZW5cIjogXCJub25lXCJcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdFwicG9wX29yZG5lcl9wb3BiZXJcIjoge1xyXG5cdFx0XHRcdFx0XCJ2YWxpZF9jaGlsZHJlblwiOiBcInBvcGJlclwiXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRcInBvcGJlclwiOiB7XHJcblx0XHRcdFx0XHRcInZhbGlkX2NoaWxkcmVuXCI6IFwibm9uZVwiLFxyXG5cdFx0XHRcdFx0XCJuZXdfbm9kZVwiOiBcIm5ldWVyIFBvcHVsYXRpb25zLUJlcmljaHRcIlxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0XCJwb3Bfb3JkbmVyX21hc3NuYmVyXCI6IHtcclxuXHRcdFx0XHRcdFwidmFsaWRfY2hpbGRyZW5cIjogXCJtYXNzbmJlclwiXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRcIm1hc3NuYmVyXCI6IHtcclxuXHRcdFx0XHRcdFwidmFsaWRfY2hpbGRyZW5cIjogXCJub25lXCIsXHJcblx0XHRcdFx0XHRcIm5ld19ub2RlXCI6IFwibmV1ZXIgTWFzc25haG1lbi1CZXJpY2h0XCJcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdFwiYXBfb3JkbmVyX2FwemllbFwiOiB7XHJcblx0XHRcdFx0XHRcInZhbGlkX2NoaWxkcmVuXCI6IFwiYXB6aWVsamFoclwiXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRcImFwemllbGphaHJcIjoge1xyXG5cdFx0XHRcdFx0XCJ2YWxpZF9jaGlsZHJlblwiOiBcImFwemllbFwiXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRcImFwemllbFwiOiB7XHJcblx0XHRcdFx0XHRcInZhbGlkX2NoaWxkcmVuXCI6IFwiemllbGJlcl9vcmRuZXJcIixcclxuXHRcdFx0XHRcdFwibmV3X25vZGVcIjogXCJuZXVlcyBBUC1aaWVsXCJcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdFwiemllbGJlcl9vcmRuZXJcIjoge1xyXG5cdFx0XHRcdFx0XCJ2YWxpZF9jaGlsZHJlblwiOiBcInppZWxiZXJcIlxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0XCJ6aWVsYmVyXCI6IHtcclxuXHRcdFx0XHRcdFwidmFsaWRfY2hpbGRyZW5cIjogXCJub25lXCIsXHJcblx0XHRcdFx0XHRcIm5ld19ub2RlXCI6IFwibmV1ZXIgWmllbC1CZXJpY2h0XCJcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdFwiYXBfb3JkbmVyX2VyZmtyaXRcIjoge1xyXG5cdFx0XHRcdFx0XCJ2YWxpZF9jaGlsZHJlblwiOiBcImVyZmtyaXRcIlxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0XCJlcmZrcml0XCI6IHtcclxuXHRcdFx0XHRcdFwidmFsaWRfY2hpbGRyZW5cIjogXCJub25lXCIsXHJcblx0XHRcdFx0XHRcIm5ld19ub2RlXCI6IFwibmV1ZXMgRXJmb2xnc2tyaXRlcml1bVwiXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRcImFwX29yZG5lcl9qYmVyXCI6IHtcclxuXHRcdFx0XHRcdFwidmFsaWRfY2hpbGRyZW5cIjogXCJqYmVyXCJcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdFwiamJlclwiOiB7XHJcblx0XHRcdFx0XHRcInZhbGlkX2NoaWxkcmVuXCI6IFwiamJlcl91ZWJlcnNpY2h0XCIsXHJcblx0XHRcdFx0XHRcIm5ld19ub2RlXCI6IFwibmV1ZXIgQVAtQmVyaWNodFwiXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRcImpiZXJfdWViZXJzaWNodFwiOiB7XHJcblx0XHRcdFx0XHRcInZhbGlkX2NoaWxkcmVuXCI6IFwibm9uZVwiLFxyXG5cdFx0XHRcdFx0XCJuZXdfbm9kZVwiOiBcIm5ldWUgw5xiZXJzaWNodCB6dSBhbGxlbiBBcnRlblwiXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRcImFwX29yZG5lcl9iZXJcIjoge1xyXG5cdFx0XHRcdFx0XCJ2YWxpZF9jaGlsZHJlblwiOiBcImJlclwiXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRcImJlclwiOiB7XHJcblx0XHRcdFx0XHRcInZhbGlkX2NoaWxkcmVuXCI6IFwibm9uZVwiLFxyXG5cdFx0XHRcdFx0XCJuZXdfbm9kZVwiOiBcIm5ldWVyIEJlcmljaHRcIlxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0XCJhcF9vcmRuZXJfYmVvYl9uaWNodF9iZXVydGVpbHRcIjoge1xyXG5cdFx0XHRcdFx0XCJ2YWxpZF9jaGlsZHJlblwiOiBcImJlb2JfbmljaHRfYmV1cnRlaWx0XCJcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdFwiYmVvYl9uaWNodF9iZXVydGVpbHRcIjoge1xyXG5cdFx0XHRcdFx0XCJ2YWxpZF9jaGlsZHJlblwiOiBcIm5vbmVcIlxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0XCJhcF9vcmRuZXJfYmVvYl9uaWNodF96dXp1b3JkbmVuXCI6IHtcclxuXHRcdFx0XHRcdFwidmFsaWRfY2hpbGRyZW5cIjogXCJiZW9iX25pY2h0X3p1enVvcmRuZW5cIlxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0XCJiZW9iX25pY2h0X3p1enVvcmRuZW5cIjoge1xyXG5cdFx0XHRcdFx0XCJ2YWxpZF9jaGlsZHJlblwiOiBcIm5vbmVcIlxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0XCJpZGVhbGJpb3RvcFwiOiB7XHJcblx0XHRcdFx0XHRcInZhbGlkX2NoaWxkcmVuXCI6IFwibm9uZVwiXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRcImFwX29yZG5lcl9hc3NvemFydGVuXCI6IHtcclxuXHRcdFx0XHRcdFwidmFsaWRfY2hpbGRyZW5cIjogXCJhc3NvemFydGVuXCJcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdFwiYXNzb3phcnRlblwiOiB7XHJcblx0XHRcdFx0XHRcInZhbGlkX2NoaWxkcmVuXCI6IFwibm9uZVwiLFxyXG5cdFx0XHRcdFx0XCJuZXdfbm9kZVwiOiBcIm5ldWUgYXNzb3ppaWVydGUgQXJ0XCJcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRcInBsdWdpbnNcIiA6IFtcInRoZW1lc1wiLCBcImpzb25fZGF0YVwiLCBcInVpXCIsIFwiaG90a2V5c1wiLCBcInNlYXJjaFwiLCBcImNvbnRleHRtZW51XCIsIFwiY3JybVwiLCBcInR5cGVzXCJdXHJcblx0XHQvL1wicGx1Z2luc1wiIDogW1widGhlbWVzXCIsIFwianNvbl9kYXRhXCIsIFwidWlcIiwgXCJob3RrZXlzXCIsIFwic2VhcmNoXCIsIFwiY29udGV4dG1lbnVcIiwgXCJjcnJtXCIsIFwiZG5kXCIsIFwidHlwZXNcIl0gICAvLyBkbmQgYXVzZ2VzY2hhbHRldCwgd2VpbCBlcyBTcGVpY2hlcm4gdmVyaGluZGVydCBpbSBsZXR6dGVuIEZlbGQgdm9yIEtsaWNrIGluIEJhdW1cclxuXHR9KVxyXG5cdC5zaG93KClcclxuXHQuYmluZChcImxvYWRlZC5qc3RyZWVcIiwgZnVuY3Rpb24oZXZlbnQsIGRhdGEpIHtcclxuXHRcdGpzdHJlZV9lcnN0ZWxsdC5yZXNvbHZlKCk7XHJcblx0XHR3aW5kb3cuYXBmLnNldHplVHJlZWjDtmhlKCk7XHJcblx0XHQkKFwiI3N1Y2hlblwiKS5zaG93KCk7XHJcblx0XHQkKFwiI2V4cG9ydGllcmVuXzJcIikuc2hvdygpO1xyXG5cdFx0JChcIiNleHBvcnRpZXJlbl8xXCIpLmhpZGUoKTtcclxuXHRcdCQoXCIjaGlsZmVcIikuc2hvdygpO1xyXG5cdFx0aWYgKHdpbmRvdy5hcGYucG9wX3plaWdlbikge1xyXG5cdFx0XHQkKFwiI3RyZWVcIikuanN0cmVlKFwic2VsZWN0X25vZGVcIiwgXCJbdHlwPSdwb3AnXSNcIiArIGxvY2FsU3RvcmFnZS5wb3BfaWQpO1xyXG5cdFx0XHQvLyBkaWVzZSBNYXJraWVydW5nIGVudGZlcm5lbiwgZGFtaXQgZGFzIG7DpGNoc3RlIG1hbCBuaWNodCBtZWhyIGRpZXNlIFBvcCBnZcO2ZmZuZXQgd2lyZFxyXG5cdFx0XHRkZWxldGUgd2luZG93LmFwZi5wb3BfemVpZ2VuO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHdpbmRvdy5hcGYucG9wYmVyX3plaWdlbikge1xyXG5cdFx0XHQkKFwiI3RyZWVcIikuanN0cmVlKFwic2VsZWN0X25vZGVcIiwgXCJbdHlwPSdwb3BiZXInXSNcIiArIGxvY2FsU3RvcmFnZS5wb3BiZXJfaWQpO1xyXG5cdFx0XHQvLyBkaWVzZSBNYXJraWVydW5nIGVudGZlcm5lbiwgZGFtaXQgZGFzIG7DpGNoc3RlIG1hbCBuaWNodCBtZWhyIGRpZXNlIFBvcGJlciBnZcO2ZmZuZXQgd2lyZFxyXG5cdFx0XHRkZWxldGUgd2luZG93LmFwZi5wb3BiZXJfemVpZ2VuO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHdpbmRvdy5hcGYucG9wbWFzc25iZXJfemVpZ2VuKSB7XHJcblx0XHRcdCQoXCIjdHJlZVwiKS5qc3RyZWUoXCJzZWxlY3Rfbm9kZVwiLCBcIlt0eXA9J3BvcG1hc3NuYmVyJ10jXCIgKyBsb2NhbFN0b3JhZ2UucG9wbWFzc25iZXJfaWQpO1xyXG5cdFx0XHQvLyBkaWVzZSBNYXJraWVydW5nIGVudGZlcm5lbiwgZGFtaXQgZGFzIG7DpGNoc3RlIG1hbCBuaWNodCBtZWhyIGRpZXNlIHBvcG1hc3NuYmVyIGdlw7ZmZm5ldCB3aXJkXHJcblx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLnBvcG1hc3NuYmVyX3plaWdlbjtcclxuXHRcdH1cclxuXHRcdGlmICh3aW5kb3cuYXBmLnRwb3BfemVpZ2VuKSB7XHJcblx0XHRcdCQoXCIjdHJlZVwiKS5qc3RyZWUoXCJzZWxlY3Rfbm9kZVwiLCBcIlt0eXA9J3Rwb3AnXSNcIiArIGxvY2FsU3RvcmFnZS50cG9wX2lkKTtcclxuXHRcdFx0Ly8gZGllc2UgTWFya2llcnVuZyBlbnRmZXJuZW4sIGRhbWl0IGRhcyBuw6RjaHN0ZSBtYWwgbmljaHQgbWVociBkaWVzZSBUUG9wIGdlw7ZmZm5ldCB3aXJkXHJcblx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLnRwb3BfemVpZ2VuO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHdpbmRvdy5hcGYudHBvcGZlbGRrb250cl96ZWlnZW4pIHtcclxuXHRcdFx0JChcIiN0cmVlXCIpLmpzdHJlZShcInNlbGVjdF9ub2RlXCIsIFwiW3R5cD0ndHBvcGZlbGRrb250ciddI1wiICsgbG9jYWxTdG9yYWdlLnRwb3BmZWxka29udHJfaWQpO1xyXG5cdFx0XHQvLyBkaWVzZSBNYXJraWVydW5nIGVudGZlcm5lbiwgZGFtaXQgZGFzIG7DpGNoc3RlIG1hbCBuaWNodCBtZWhyIGRpZXNlIHRwb3BmZWxka29udHIgZ2XDtmZmbmV0IHdpcmRcclxuXHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYudHBvcGZlbGRrb250cl96ZWlnZW47XHJcblx0XHR9XHJcblx0XHRpZiAod2luZG93LmFwZi50cG9wZnJlaXdrb250cl96ZWlnZW4pIHtcclxuXHRcdFx0JChcIiN0cmVlXCIpLmpzdHJlZShcInNlbGVjdF9ub2RlXCIsIFwiW3R5cD0ndHBvcGZyZWl3a29udHInXSNcIiArIGxvY2FsU3RvcmFnZS50cG9wZmVsZGtvbnRyX2lkKTtcclxuXHRcdFx0Ly8gZGllc2UgTWFya2llcnVuZyBlbnRmZXJuZW4sIGRhbWl0IGRhcyBuw6RjaHN0ZSBtYWwgbmljaHQgbWVociBkaWVzZSB0cG9wZnJlaXdrb250ciBnZcO2ZmZuZXQgd2lyZFxyXG5cdFx0XHRkZWxldGUgd2luZG93LmFwZi50cG9wZnJlaXdrb250cl96ZWlnZW47XHJcblx0XHR9XHJcblx0XHRpZiAod2luZG93LmFwZi50cG9wbWFzc25femVpZ2VuKSB7XHJcblx0XHRcdCQoXCIjdHJlZVwiKS5qc3RyZWUoXCJzZWxlY3Rfbm9kZVwiLCBcIlt0eXA9J3Rwb3BtYXNzbiddI1wiICsgbG9jYWxTdG9yYWdlLnRwb3BtYXNzbl9pZCk7XHJcblx0XHRcdC8vIGRpZXNlIE1hcmtpZXJ1bmcgZW50ZmVybmVuLCBkYW1pdCBkYXMgbsOkY2hzdGUgbWFsIG5pY2h0IG1laHIgZGllc2UgdHBvcG1hc3NuIGdlw7ZmZm5ldCB3aXJkXHJcblx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLnRwb3BtYXNzbl96ZWlnZW47XHJcblx0XHR9XHJcblx0XHRpZiAod2luZG93LmFwZi50cG9wYmVyX3plaWdlbikge1xyXG5cdFx0XHQkKFwiI3RyZWVcIikuanN0cmVlKFwic2VsZWN0X25vZGVcIiwgXCJbdHlwPSd0cG9wYmVyJ10jXCIgKyBsb2NhbFN0b3JhZ2UudHBvcGJlcl9pZCk7XHJcblx0XHRcdC8vIGRpZXNlIE1hcmtpZXJ1bmcgZW50ZmVybmVuLCBkYW1pdCBkYXMgbsOkY2hzdGUgbWFsIG5pY2h0IG1laHIgZGllc2UgdHBvcGJlciBnZcO2ZmZuZXQgd2lyZFxyXG5cdFx0XHRkZWxldGUgd2luZG93LmFwZi50cG9wYmVyX3plaWdlbjtcclxuXHRcdH1cclxuXHRcdGlmICh3aW5kb3cuYXBmLmJlb2JfenVnZW9yZG5ldF96ZWlnZW4pIHtcclxuXHRcdFx0JChcIiN0cmVlXCIpLmpzdHJlZShcInNlbGVjdF9ub2RlXCIsIFwiI2Jlb2JcIiArIGxvY2FsU3RvcmFnZS5iZW9iX2lkKTtcclxuXHRcdFx0Ly8gZGllc2UgTWFya2llcnVuZyBlbnRmZXJuZW4sIGRhbWl0IGRhcyBuw6RjaHN0ZSBtYWwgbmljaHQgbWVociBkaWVzZSBiZW9iX3p1Z2VvcmRuZXQgZ2XDtmZmbmV0IHdpcmRcclxuXHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYuYmVvYl96dWdlb3JkbmV0X3plaWdlbjtcclxuXHRcdH1cclxuXHRcdGlmICh3aW5kb3cuYXBmLnRwb3BtYXNzbmJlcl96ZWlnZW4pIHtcclxuXHRcdFx0JChcIiN0cmVlXCIpLmpzdHJlZShcInNlbGVjdF9ub2RlXCIsIFwiW3R5cD0ndHBvcG1hc3NuYmVyJ10jXCIgKyBsb2NhbFN0b3JhZ2UudHBvcG1hc3NuYmVyX2lkKTtcclxuXHRcdFx0Ly8gZGllc2UgTWFya2llcnVuZyBlbnRmZXJuZW4sIGRhbWl0IGRhcyBuw6RjaHN0ZSBtYWwgbmljaHQgbWVociBkaWVzZSB0cG9wbWFzc25iZXIgZ2XDtmZmbmV0IHdpcmRcclxuXHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYudHBvcG1hc3NuYmVyX3plaWdlbjtcclxuXHRcdH1cclxuXHRcdGlmICh3aW5kb3cuYXBmLmFwemllbF96ZWlnZW4pIHtcclxuXHRcdFx0JChcIiN0cmVlXCIpLmpzdHJlZShcInNlbGVjdF9ub2RlXCIsIFwiW3R5cD0nYXB6aWVsJ10jXCIgKyBsb2NhbFN0b3JhZ2UuYXB6aWVsX2lkKTtcclxuXHRcdFx0Ly8gZGllc2UgTWFya2llcnVuZyBlbnRmZXJuZW4sIGRhbWl0IGRhcyBuw6RjaHN0ZSBtYWwgbmljaHQgbWVociBkaWVzZSBhcHppZWwgZ2XDtmZmbmV0IHdpcmRcclxuXHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYuYXB6aWVsX3plaWdlbjtcclxuXHRcdH1cclxuXHRcdGlmICh3aW5kb3cuYXBmLnppZWxiZXJfemVpZ2VuKSB7XHJcblx0XHRcdCQoXCIjdHJlZVwiKS5qc3RyZWUoXCJzZWxlY3Rfbm9kZVwiLCBcIlt0eXA9J3ppZWxiZXInXSNcIiArIGxvY2FsU3RvcmFnZS56aWVsYmVyX2lkKTtcclxuXHRcdFx0Ly8gZGllc2UgTWFya2llcnVuZyBlbnRmZXJuZW4sIGRhbWl0IGRhcyBuw6RjaHN0ZSBtYWwgbmljaHQgbWVociBkaWVzZSB6aWVsYmVyIGdlw7ZmZm5ldCB3aXJkXHJcblx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLnppZWxiZXJfemVpZ2VuO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHdpbmRvdy5hcGYuZXJma3JpdF96ZWlnZW4pIHtcclxuXHRcdFx0JChcIiN0cmVlXCIpLmpzdHJlZShcInNlbGVjdF9ub2RlXCIsIFwiW3R5cD0nZXJma3JpdCddI1wiICsgbG9jYWxTdG9yYWdlLmVyZmtyaXRfaWQpO1xyXG5cdFx0XHQvLyBkaWVzZSBNYXJraWVydW5nIGVudGZlcm5lbiwgZGFtaXQgZGFzIG7DpGNoc3RlIG1hbCBuaWNodCBtZWhyIGRpZXNlIGVyZmtyaXQgZ2XDtmZmbmV0IHdpcmRcclxuXHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYuZXJma3JpdF96ZWlnZW47XHJcblx0XHR9XHJcblx0XHRpZiAod2luZG93LmFwZi5qYmVyX3plaWdlbikge1xyXG5cdFx0XHQkKFwiI3RyZWVcIikuanN0cmVlKFwic2VsZWN0X25vZGVcIiwgXCJbdHlwPSdqYmVyJ10jXCIgKyBsb2NhbFN0b3JhZ2UuamJlcl9pZCk7XHJcblx0XHRcdC8vIGRpZXNlIE1hcmtpZXJ1bmcgZW50ZmVybmVuLCBkYW1pdCBkYXMgbsOkY2hzdGUgbWFsIG5pY2h0IG1laHIgZGllc2UgamJlciBnZcO2ZmZuZXQgd2lyZFxyXG5cdFx0XHRkZWxldGUgd2luZG93LmFwZi5qYmVyX3plaWdlbjtcclxuXHRcdH1cclxuXHRcdGlmICh3aW5kb3cuYXBmLmpiZXJfw7xiZXJzaWNodF96ZWlnZW4pIHtcclxuXHRcdFx0JChcIiN0cmVlXCIpLmpzdHJlZShcInNlbGVjdF9ub2RlXCIsIFwiW3R5cD0namJlcl91ZWJlcnNpY2h0J10jXCIgKyBsb2NhbFN0b3JhZ2UuamJlcl91ZWJlcnNpY2h0X2lkKTtcclxuXHRcdFx0Ly8gZGllc2UgTWFya2llcnVuZyBlbnRmZXJuZW4sIGRhbWl0IGRhcyBuw6RjaHN0ZSBtYWwgbmljaHQgbWVociBkaWVzZSBqYmVyX3VlYmVyc2ljaHQgZ2XDtmZmbmV0IHdpcmRcclxuXHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYuamJlcl/DvGJlcnNpY2h0X3plaWdlbjtcclxuXHRcdH1cclxuXHRcdGlmICh3aW5kb3cuYXBmLmJlcl96ZWlnZW4pIHtcclxuXHRcdFx0JChcIiN0cmVlXCIpLmpzdHJlZShcInNlbGVjdF9ub2RlXCIsIFwiW3R5cD0nYmVyJ10jXCIgKyBsb2NhbFN0b3JhZ2UuYmVyX2lkKTtcclxuXHRcdFx0Ly8gZGllc2UgTWFya2llcnVuZyBlbnRmZXJuZW4sIGRhbWl0IGRhcyBuw6RjaHN0ZSBtYWwgbmljaHQgbWVociBkaWVzZSBiZXIgZ2XDtmZmbmV0IHdpcmRcclxuXHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYuYmVyX3plaWdlbjtcclxuXHRcdH1cclxuXHRcdGlmICh3aW5kb3cuYXBmLmlkZWFsYmlvdG9wX3plaWdlbikge1xyXG5cdFx0XHQkKFwiI3RyZWVcIikuanN0cmVlKFwic2VsZWN0X25vZGVcIiwgXCJbdHlwPSdpZGVhbGJpb3RvcCddI1wiICsgbG9jYWxTdG9yYWdlLmlkZWFsYmlvdG9wX2lkKTtcclxuXHRcdFx0Ly8gZGllc2UgTWFya2llcnVuZyBlbnRmZXJuZW4sIGRhbWl0IGRhcyBuw6RjaHN0ZSBtYWwgbmljaHQgbWVociBkaWVzZSBpZGVhbGJpb3RvcCBnZcO2ZmZuZXQgd2lyZFxyXG5cdFx0XHRkZWxldGUgd2luZG93LmFwZi5pZGVhbGJpb3RvcF96ZWlnZW47XHJcblx0XHR9XHJcblx0XHRpZiAod2luZG93LmFwZi5hc3NvemFydGVuX3plaWdlbikge1xyXG5cdFx0XHQkKFwiI3RyZWVcIikuanN0cmVlKFwic2VsZWN0X25vZGVcIiwgXCJbdHlwPSdhc3NvemFydGVuJ10jXCIgKyBsb2NhbFN0b3JhZ2UuYXNzb3phcnRlbl9pZCk7XHJcblx0XHRcdC8vIGRpZXNlIE1hcmtpZXJ1bmcgZW50ZmVybmVuLCBkYW1pdCBkYXMgbsOkY2hzdGUgbWFsIG5pY2h0IG1laHIgZGllc2UgYXNzb3phcnRlbiBnZcO2ZmZuZXQgd2lyZFxyXG5cdFx0XHRkZWxldGUgd2luZG93LmFwZi5hc3NvemFydGVuX3plaWdlbjtcclxuXHRcdH1cclxuXHRcdGlmICh3aW5kb3cuYXBmLmJlb2JfbmljaHRfYmV1cnRlaWx0X3plaWdlbikge1xyXG5cdFx0XHQkKFwiI3RyZWVcIikuanN0cmVlKFwic2VsZWN0X25vZGVcIiwgXCIjYmVvYlwiICsgbG9jYWxTdG9yYWdlLmJlb2JfaWQpO1xyXG5cdFx0XHQvLyBkaWVzZSBNYXJraWVydW5nIGVudGZlcm5lbiwgZGFtaXQgZGFzIG7DpGNoc3RlIG1hbCBuaWNodCBtZWhyIGRpZXNlIGJlb2IgZ2XDtmZmbmV0IHdpcmRcclxuXHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYuYmVvYl9uaWNodF9iZXVydGVpbHRfemVpZ2VuO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHdpbmRvdy5hcGYuYmVvYl9uaWNodF96dXp1b3JkbmVuX3plaWdlbikge1xyXG5cdFx0XHQkKFwiI3RyZWVcIikuanN0cmVlKFwic2VsZWN0X25vZGVcIiwgXCIjYmVvYlwiICsgbG9jYWxTdG9yYWdlLmJlb2JfaWQpO1xyXG5cdFx0XHQvLyBkaWVzZSBNYXJraWVydW5nIGVudGZlcm5lbiwgZGFtaXQgZGFzIG7DpGNoc3RlIG1hbCBuaWNodCBtZWhyIGRpZXNlIGJlb2IgZ2XDtmZmbmV0IHdpcmRcclxuXHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYuYmVvYl9uaWNodF96dXp1b3JkbmVuX3plaWdlbjtcclxuXHRcdH1cclxuXHRcdGlmICh3aW5kb3cuYXBmLmFwX3plaWdlbikge1xyXG5cdFx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV9hcCgpO1xyXG5cdFx0XHQvLyBkaWVzZSBNYXJraWVydW5nIGVudGZlcm5lbiwgZGFtaXQgZGFzIG7DpGNoc3RlIG1hbCBuaWNodCBtZWhyIGRpZXNlciBBUCBnZcO2ZmZuZXQgd2lyZFxyXG5cdFx0XHRkZWxldGUgd2luZG93LmFwZi5hcF96ZWlnZW47XHJcblx0XHR9XHJcblx0fSlcclxuXHQvLyBhdWNoIGF1ZiBNb2JpbGdlcsOkdGVuIHNvbGwgZGFzIEtvbnRleHRtZW7DvCB6dWfDpG5nbGljaCBzZWluIVxyXG5cdC5oYW1tZXIoKS5iaW5kKFwiaG9sZCBkb3VibGV0YXBcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuXHRcdC8vIGF1ZiBQQydzIHZlcmhpbmRlcm46IE1lbnUgZXJzY2hlaW50IHNvbnN0IGJlaW0gU2Nyb2xsZW5cclxuXHRcdGlmICgkKHdpbmRvdykud2lkdGgoKSA8IDEwMDApIHtcclxuXHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHQkKFwiI3RyZWVcIikuanN0cmVlKCdnZXRfc2VsZWN0ZWQnKS5jaGlsZHJlbignYScpLnRyaWdnZXIoJ2NvbnRleHRtZW51Jyk7XHJcblx0XHRcdH0sIDUwMCk7XHJcblx0XHR9XHJcblx0fSlcclxuXHQuYmluZChcInNlbGVjdF9ub2RlLmpzdHJlZVwiLCBmdW5jdGlvbihlLCBkYXRhKSB7XHJcblx0XHR2YXIgbm9kZTtcdFxyXG5cdFx0ZGVsZXRlIGxvY2FsU3RvcmFnZS50cG9wZnJlaXdrb250cjtcdC8vIEVyaW5uZXJ1bmcgYW4gbGV0enRlbiBLbGljayBpbSBCYXVtIGzDtnNjaGVuXHJcblx0XHRub2RlID0gZGF0YS5yc2x0Lm9iajtcclxuXHRcdHZhciBub2RlX3R5cCA9IG5vZGUuYXR0cihcInR5cFwiKTtcclxuXHRcdC8vIGluIGRlciBJRCBkZXMgTm9kZXMgZW50aGFsdGVuZSBUZXh0ZSBtw7xzc2VuIGVudGZlcm50IHdlcmRlblxyXG5cdFx0dmFyIG5vZGVfaWQgPSB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKG5vZGUuYXR0cihcImlkXCIpKTtcclxuXHRcdCQuanN0cmVlLl9yZWZlcmVuY2Uobm9kZSkub3Blbl9ub2RlKG5vZGUpO1xyXG5cdFx0aWYgKG5vZGVfdHlwLnNsaWNlKDAsIDMpID09PSBcImFwX1wiIHx8IG5vZGVfdHlwID09PSBcImFwemllbGphaHJcIikge1xyXG5cdFx0XHQvLyB2ZXJoaW5kZXJuLCBkYXNzIGJlcmVpdHMgb2ZmZW5lIFNlaXRlbiBub2NobWFscyBnZcO2ZmZuZXQgd2VyZGVuXHJcblx0XHRcdGlmICghJChcIiNhcFwiKS5pcygnOnZpc2libGUnKSB8fCBsb2NhbFN0b3JhZ2UuYXBfaWQgIT09IG5vZGVfaWQpIHtcclxuXHRcdFx0XHRsb2NhbFN0b3JhZ2UuYXBfaWQgPSBub2RlX2lkO1xyXG5cdFx0XHRcdGRlbGV0ZSBsb2NhbFN0b3JhZ2UucG9wX2lkO1xyXG5cdFx0XHRcdHdpbmRvdy5hcGYuaW5pdGlpZXJlX2FwKCk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSBpZiAobm9kZV90eXAgPT09IFwicG9wXCIgfHwgbm9kZV90eXAuc2xpY2UoMCwgNCkgPT09IFwicG9wX1wiKSB7XHJcblx0XHRcdC8vIHZlcmhpbmRlcm4sIGRhc3MgYmVyZWl0cyBvZmZlbmUgU2VpdGVuIG5vY2htYWxzIGdlw7ZmZm5ldCB3ZXJkZW5cclxuXHRcdFx0aWYgKCEkKFwiI3BvcFwiKS5pcygnOnZpc2libGUnKSB8fCBsb2NhbFN0b3JhZ2UucG9wX2lkICE9PSBub2RlX2lkKSB7XHJcblx0XHRcdFx0bG9jYWxTdG9yYWdlLnBvcF9pZCA9IG5vZGVfaWQ7XHJcblx0XHRcdFx0d2luZG93LmFwZi5pbml0aWllcmVfcG9wKCk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSBpZiAobm9kZV90eXAgPT09IFwiYXB6aWVsXCIgfHwgbm9kZV90eXAgPT09IFwiemllbGJlcl9vcmRuZXJcIikge1xyXG5cdFx0XHQvLyB2ZXJoaW5kZXJuLCBkYXNzIGJlcmVpdHMgb2ZmZW5lIFNlaXRlbiBub2NobWFscyBnZcO2ZmZuZXQgd2VyZGVuXHJcblx0XHRcdGlmICghJChcIiNhcHppZWxcIikuaXMoJzp2aXNpYmxlJykgfHwgbG9jYWxTdG9yYWdlLmFwemllbF9pZCAhPT0gbm9kZV9pZCkge1xyXG5cdFx0XHRcdGxvY2FsU3RvcmFnZS5hcHppZWxfaWQgPSBub2RlX2lkO1xyXG5cdFx0XHRcdHdpbmRvdy5hcGYuaW5pdGlpZXJlX2FwemllbCgpO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2UgaWYgKG5vZGVfdHlwID09PSBcInppZWxiZXJcIikge1xyXG5cdFx0XHQvLyB2ZXJoaW5kZXJuLCBkYXNzIGJlcmVpdHMgb2ZmZW5lIFNlaXRlbiBub2NobWFscyBnZcO2ZmZuZXQgd2VyZGVuXHJcblx0XHRcdGlmICghJChcIiN6aWVsYmVyXCIpLmlzKCc6dmlzaWJsZScpIHx8IGxvY2FsU3RvcmFnZS56aWVsYmVyX2lkICE9PSBub2RlX2lkKSB7XHJcblx0XHRcdFx0bG9jYWxTdG9yYWdlLnppZWxiZXJfaWQgPSBub2RlX2lkO1xyXG5cdFx0XHRcdHdpbmRvdy5hcGYuaW5pdGlpZXJlX3ppZWxiZXIoKTtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIGlmIChub2RlX3R5cCA9PT0gXCJlcmZrcml0XCIpIHtcclxuXHRcdFx0Ly8gdmVyaGluZGVybiwgZGFzcyBiZXJlaXRzIG9mZmVuZSBTZWl0ZW4gbm9jaG1hbHMgZ2XDtmZmbmV0IHdlcmRlblxyXG5cdFx0XHRpZiAoISQoXCIjZXJma3JpdFwiKS5pcygnOnZpc2libGUnKSB8fCBsb2NhbFN0b3JhZ2UuZXJma3JpdF9pZCAhPT0gbm9kZV9pZCkge1xyXG5cdFx0XHRcdGxvY2FsU3RvcmFnZS5lcmZrcml0X2lkID0gbm9kZV9pZDtcclxuXHRcdFx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV9lcmZrcml0KCk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSBpZiAobm9kZV90eXAgPT09IFwiamJlclwiKSB7XHJcblx0XHRcdC8vIHZlcmhpbmRlcm4sIGRhc3MgYmVyZWl0cyBvZmZlbmUgU2VpdGVuIG5vY2htYWxzIGdlw7ZmZm5ldCB3ZXJkZW5cclxuXHRcdFx0aWYgKCEkKFwiI2piZXJcIikuaXMoJzp2aXNpYmxlJykgfHwgbG9jYWxTdG9yYWdlLmpiZXJfaWQgIT09IG5vZGVfaWQpIHtcclxuXHRcdFx0XHRsb2NhbFN0b3JhZ2UuamJlcl9pZCA9IG5vZGVfaWQ7XHJcblx0XHRcdFx0d2luZG93LmFwZi5pbml0aWllcmVfamJlcigpO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2UgaWYgKG5vZGVfdHlwID09PSBcImpiZXJfdWViZXJzaWNodFwiKSB7XHJcblx0XHRcdC8vIHZlcmhpbmRlcm4sIGRhc3MgYmVyZWl0cyBvZmZlbmUgU2VpdGVuIG5vY2htYWxzIGdlw7ZmZm5ldCB3ZXJkZW5cclxuXHRcdFx0aWYgKCEkKFwiI2piZXJfdWViZXJzaWNodFwiKS5pcygnOnZpc2libGUnKSB8fCBsb2NhbFN0b3JhZ2UuamJlcl91ZWJlcnNpY2h0X2lkICE9PSBub2RlX2lkKSB7XHJcblx0XHRcdFx0bG9jYWxTdG9yYWdlLmpiZXJfdWViZXJzaWNodF9pZCA9IG5vZGVfaWQ7XHJcblx0XHRcdFx0d2luZG93LmFwZi5pbml0aWllcmVfamJlcl91ZWJlcnNpY2h0KCk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSBpZiAobm9kZV90eXAgPT09IFwiYmVyXCIpIHtcclxuXHRcdFx0Ly8gdmVyaGluZGVybiwgZGFzcyBiZXJlaXRzIG9mZmVuZSBTZWl0ZW4gbm9jaG1hbHMgZ2XDtmZmbmV0IHdlcmRlblxyXG5cdFx0XHRpZiAoISQoXCIjYmVyXCIpLmlzKCc6dmlzaWJsZScpIHx8IGxvY2FsU3RvcmFnZS5iZXJfaWQgIT09IG5vZGVfaWQpIHtcclxuXHRcdFx0XHRsb2NhbFN0b3JhZ2UuYmVyX2lkID0gbm9kZV9pZDtcclxuXHRcdFx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV9iZXIoKTtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIGlmIChub2RlX3R5cCA9PT0gXCJpZGVhbGJpb3RvcFwiKSB7XHJcblx0XHRcdC8vIHZlcmhpbmRlcm4sIGRhc3MgYmVyZWl0cyBvZmZlbmUgU2VpdGVuIG5vY2htYWxzIGdlw7ZmZm5ldCB3ZXJkZW5cclxuXHRcdFx0aWYgKCEkKFwiI2lkZWFsYmlvdG9wXCIpLmlzKCc6dmlzaWJsZScpKSB7XHJcblx0XHRcdFx0Ly8gZWlnZW5lIGlkIG5pY2h0IG7DtnRpZ1xyXG5cdFx0XHRcdC8vIDE6MSBtaXQgYXAgdmVyYnVuZGVuLCBnbGVpY2ggaWRcclxuXHRcdFx0XHQvLyB3ZW5uIG5vY2gga2VpbiBEYXRlbnNhdHogZXhpc3RpZXJ0IGVyc3RlbGx0IGlobiB3aW5kb3cuYXBmLmluaXRpaWVyZV9pZGVhbGJpb3RvcFxyXG5cdFx0XHRcdHdpbmRvdy5hcGYuaW5pdGlpZXJlX2lkZWFsYmlvdG9wKCk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSBpZiAobm9kZV90eXAgPT09IFwiYXNzb3phcnRlblwiKSB7XHJcblx0XHRcdC8vIHZlcmhpbmRlcm4sIGRhc3MgYmVyZWl0cyBvZmZlbmUgU2VpdGVuIG5vY2htYWxzIGdlw7ZmZm5ldCB3ZXJkZW5cclxuXHRcdFx0aWYgKCEkKFwiI2Fzc296YXJ0ZW5cIikuaXMoJzp2aXNpYmxlJykgfHwgbG9jYWxTdG9yYWdlLmFzc296YXJ0ZW5faWQgIT09IG5vZGVfaWQpIHtcclxuXHRcdFx0XHRsb2NhbFN0b3JhZ2UuYXNzb3phcnRlbl9pZCA9IG5vZGVfaWQ7XHJcblx0XHRcdFx0d2luZG93LmFwZi5pbml0aWllcmVfYXNzb3phcnRlbigpO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2UgaWYgKG5vZGVfdHlwID09PSBcInBvcGJlclwiKSB7XHJcblx0XHRcdC8vIHZlcmhpbmRlcm4sIGRhc3MgYmVyZWl0cyBvZmZlbmUgU2VpdGVuIG5vY2htYWxzIGdlw7ZmZm5ldCB3ZXJkZW5cclxuXHRcdFx0aWYgKCEkKFwiI3BvcGJlclwiKS5pcygnOnZpc2libGUnKSB8fCBsb2NhbFN0b3JhZ2UucG9wYmVyX2lkICE9PSBub2RlX2lkKSB7XHJcblx0XHRcdFx0bG9jYWxTdG9yYWdlLnBvcGJlcl9pZCA9IG5vZGVfaWQ7XHJcblx0XHRcdFx0d2luZG93LmFwZi5pbml0aWllcmVfcG9wYmVyKCk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSBpZiAobm9kZV90eXAgPT09IFwicG9wbWFzc25iZXJcIikge1xyXG5cdFx0XHQvLyB2ZXJoaW5kZXJuLCBkYXNzIGJlcmVpdHMgb2ZmZW5lIFNlaXRlbiBub2NobWFscyBnZcO2ZmZuZXQgd2VyZGVuXHJcblx0XHRcdGlmICghJChcIiNwb3BtYXNzbmJlclwiKS5pcygnOnZpc2libGUnKSB8fCBsb2NhbFN0b3JhZ2UucG9wbWFzc25iZXJfaWQgIT09IG5vZGVfaWQpIHtcclxuXHRcdFx0XHRsb2NhbFN0b3JhZ2UucG9wbWFzc25iZXJfaWQgPSBub2RlX2lkO1xyXG5cdFx0XHRcdHdpbmRvdy5hcGYuaW5pdGlpZXJlX3BvcG1hc3NuYmVyKCk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSBpZiAobm9kZV90eXAgPT09IFwidHBvcFwiIHx8IG5vZGVfdHlwLnNsaWNlKDAsIDUpID09PSBcInRwb3BfXCIpIHtcclxuXHRcdFx0Ly8gdmVyaGluZGVybiwgZGFzcyBiZXJlaXRzIG9mZmVuZSBTZWl0ZW4gbm9jaG1hbHMgZ2XDtmZmbmV0IHdlcmRlblxyXG5cdFx0XHRpZiAoISQoXCIjdHBvcFwiKS5pcygnOnZpc2libGUnKSB8fCBsb2NhbFN0b3JhZ2UudHBvcF9pZCAhPT0gbm9kZV9pZCkge1xyXG5cdFx0XHRcdGxvY2FsU3RvcmFnZS50cG9wX2lkID0gbm9kZV9pZDtcclxuXHRcdFx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV90cG9wKCk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSBpZiAobm9kZV90eXAgPT09IFwidHBvcGZlbGRrb250clwiKSB7XHJcblx0XHRcdC8vIHZlcmhpbmRlcm4sIGRhc3MgYmVyZWl0cyBvZmZlbmUgU2VpdGVuIG5vY2htYWxzIGdlw7ZmZm5ldCB3ZXJkZW5cclxuXHRcdFx0aWYgKCEkKFwiI3Rwb3BmZWxka29udHJcIikuaXMoJzp2aXNpYmxlJykgfHwgbG9jYWxTdG9yYWdlLnRwb3BmZWxka29udHJfaWQgIT09IG5vZGVfaWQpIHtcclxuXHRcdFx0XHRsb2NhbFN0b3JhZ2UudHBvcGZlbGRrb250cl9pZCA9IG5vZGVfaWQ7XHJcblx0XHRcdFx0d2luZG93LmFwZi5pbml0aWllcmVfdHBvcGZlbGRrb250cigpO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2UgaWYgKG5vZGVfdHlwID09PSBcInRwb3BmcmVpd2tvbnRyXCIpIHtcclxuXHRcdFx0Ly8gdmVyaGluZGVybiwgZGFzcyBiZXJlaXRzIG9mZmVuZSBTZWl0ZW4gbm9jaG1hbHMgZ2XDtmZmbmV0IHdlcmRlblxyXG5cdFx0XHRpZiAoISQoXCIjdHBvcGZlbGRrb250clwiKS5pcygnOnZpc2libGUnKSB8fCBsb2NhbFN0b3JhZ2UudHBvcGZlbGRrb250cl9pZCAhPT0gbm9kZV9pZCkge1xyXG5cdFx0XHRcdGxvY2FsU3RvcmFnZS50cG9wZmVsZGtvbnRyX2lkID0gbm9kZV9pZDtcclxuXHRcdFx0XHRsb2NhbFN0b3JhZ2UudHBvcGZyZWl3a29udHIgPSB0cnVlO1xyXG5cdFx0XHRcdHdpbmRvdy5hcGYuaW5pdGlpZXJlX3Rwb3BmZWxka29udHIoKTtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIGlmIChub2RlX3R5cCA9PT0gXCJ0cG9wbWFzc25cIikge1xyXG5cdFx0XHQvLyB2ZXJoaW5kZXJuLCBkYXNzIGJlcmVpdHMgb2ZmZW5lIFNlaXRlbiBub2NobWFscyBnZcO2ZmZuZXQgd2VyZGVuXHJcblx0XHRcdGlmICghJChcIiN0cG9wbWFzc25cIikuaXMoJzp2aXNpYmxlJykgfHwgbG9jYWxTdG9yYWdlLnRwb3BtYXNzbl9pZCAhPT0gbm9kZV9pZCkge1xyXG5cdFx0XHRcdGxvY2FsU3RvcmFnZS50cG9wbWFzc25faWQgPSBub2RlX2lkO1xyXG5cdFx0XHRcdHdpbmRvdy5hcGYuaW5pdGlpZXJlX3Rwb3BtYXNzbigpO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2UgaWYgKG5vZGVfdHlwID09PSBcInRwb3BiZXJcIikge1xyXG5cdFx0XHQvLyB2ZXJoaW5kZXJuLCBkYXNzIGJlcmVpdHMgb2ZmZW5lIFNlaXRlbiBub2NobWFscyBnZcO2ZmZuZXQgd2VyZGVuXHJcblx0XHRcdGlmICghJChcIiN0cG9wYmVyXCIpLmlzKCc6dmlzaWJsZScpIHx8IGxvY2FsU3RvcmFnZS50cG9wYmVyX2lkICE9PSBub2RlX2lkKSB7XHJcblx0XHRcdFx0bG9jYWxTdG9yYWdlLnRwb3BiZXJfaWQgPSBub2RlX2lkO1xyXG5cdFx0XHRcdHdpbmRvdy5hcGYuaW5pdGlpZXJlVHBvcGJlcigpO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2UgaWYgKG5vZGVfdHlwID09PSBcImJlb2JfenVnZW9yZG5ldFwiKSB7XHJcblx0XHRcdC8vIHZlcmhpbmRlcm4sIGRhc3MgYmVyZWl0cyBvZmZlbmUgU2VpdGVuIG5vY2htYWxzIGdlw7ZmZm5ldCB3ZXJkZW5cclxuXHRcdFx0aWYgKCEkKFwiI2Jlb2JcIikuaXMoJzp2aXNpYmxlJykgfHwgbG9jYWxTdG9yYWdlLmJlb2JfaWQgIT09IG5vZGVfaWQgfHwgbG9jYWxTdG9yYWdlLmJlb2Jfc3RhdHVzICE9PSBcInp1Z2VvcmRuZXRcIikge1xyXG5cdFx0XHRcdGxvY2FsU3RvcmFnZS5iZW9iX2lkID0gbm9kZV9pZDtcclxuXHRcdFx0XHRsb2NhbFN0b3JhZ2UuYmVvYnR5cCA9IG5vZGUuYXR0cihcImJlb2J0eXBcIik7XHJcblx0XHRcdFx0d2luZG93LmFwZi5pbml0aWllcmVfYmVvYihub2RlLmF0dHIoXCJiZW9idHlwXCIpLCBub2RlX2lkLCBcInp1Z2VvcmRuZXRcIik7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSBpZiAobm9kZV90eXAgPT09IFwiYmVvYl9uaWNodF9iZXVydGVpbHRcIikge1xyXG5cdFx0XHQvLyB2ZXJoaW5kZXJuLCBkYXNzIGJlcmVpdHMgb2ZmZW5lIFNlaXRlbiBub2NobWFscyBnZcO2ZmZuZXQgd2VyZGVuXHJcblx0XHRcdGlmICghJChcIiNiZW9iXCIpLmlzKCc6dmlzaWJsZScpIHx8IGxvY2FsU3RvcmFnZS5iZW9iX2lkICE9PSBub2RlX2lkIHx8IGxvY2FsU3RvcmFnZS5iZW9iX3N0YXR1cyAhPT0gXCJuaWNodF9iZXVydGVpbHRcIikge1xyXG5cdFx0XHRcdGxvY2FsU3RvcmFnZS5iZW9iX2lkID0gbm9kZV9pZDtcclxuXHRcdFx0XHRsb2NhbFN0b3JhZ2UuYmVvYnR5cCA9IG5vZGUuYXR0cihcImJlb2J0eXBcIik7XHJcblx0XHRcdFx0Ly8gZGVuIEJlb2J0eXAgbWl0Z2ViZW5cclxuXHRcdFx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV9iZW9iKG5vZGUuYXR0cihcImJlb2J0eXBcIiksIG5vZGVfaWQsIFwibmljaHRfYmV1cnRlaWx0XCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2UgaWYgKG5vZGVfdHlwID09PSBcImJlb2JfbmljaHRfenV6dW9yZG5lblwiKSB7XHJcblx0XHRcdC8vIHZlcmhpbmRlcm4sIGRhc3MgYmVyZWl0cyBvZmZlbmUgU2VpdGVuIG5vY2htYWxzIGdlw7ZmZm5ldCB3ZXJkZW5cclxuXHRcdFx0aWYgKCEkKFwiI2Jlb2JcIikuaXMoJzp2aXNpYmxlJykgfHwgbG9jYWxTdG9yYWdlLmJlb2JfaWQgIT09IG5vZGVfaWQgfHwgbG9jYWxTdG9yYWdlLmJlb2Jfc3RhdHVzICE9PSBcIm5pY2h0X3p1enVvcmRuZW5cIikge1xyXG5cdFx0XHRcdGxvY2FsU3RvcmFnZS5iZW9iX2lkID0gbm9kZV9pZDtcclxuXHRcdFx0XHRsb2NhbFN0b3JhZ2UuYmVvYnR5cCA9IG5vZGUuYXR0cihcImJlb2J0eXBcIik7XHJcblx0XHRcdFx0Ly8gZGVuIEJlb2J0eXAgbWl0Z2ViZW5cclxuXHRcdFx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV9iZW9iKG5vZGUuYXR0cihcImJlb2J0eXBcIiksIG5vZGVfaWQsIFwibmljaHRfenV6dW9yZG5lblwiKTtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIGlmIChub2RlX3R5cCA9PT0gXCJ0cG9wbWFzc25iZXJcIikge1xyXG5cdFx0XHQvLyB2ZXJoaW5kZXJuLCBkYXNzIGJlcmVpdHMgb2ZmZW5lIFNlaXRlbiBub2NobWFscyBnZcO2ZmZuZXQgd2VyZGVuXHJcblx0XHRcdGlmICghJChcIiN0cG9wbWFzc25iZXJcIikuaXMoJzp2aXNpYmxlJykgfHwgbG9jYWxTdG9yYWdlLnRwb3BtYXNzbmJlcl9pZCAhPT0gbm9kZV9pZCkge1xyXG5cdFx0XHRcdGxvY2FsU3RvcmFnZS50cG9wbWFzc25iZXJfaWQgPSBub2RlX2lkO1xyXG5cdFx0XHRcdHdpbmRvdy5hcGYuaW5pdGlpZXJlX3Rwb3BtYXNzbmJlcigpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fSlcclxuXHQuYmluZChcImFmdGVyX29wZW4uanN0cmVlXCIsIGZ1bmN0aW9uKGUsIGRhdGEpIHtcclxuXHRcdHdpbmRvdy5hcGYuc2V0emVUcmVlaMO2aGUoKTtcclxuXHR9KVxyXG5cdC5iaW5kKFwiYWZ0ZXJfY2xvc2UuanN0cmVlXCIsIGZ1bmN0aW9uKGUsIGRhdGEpIHtcclxuXHRcdHdpbmRvdy5hcGYuc2V0emVUcmVlaMO2aGUoKTtcclxuXHR9KVxyXG5cdC5iaW5kKFwicHJlcGFyZV9tb3ZlLmpzdHJlZVwiLCBmdW5jdGlvbihlLCBkYXRhKSB7XHJcblx0XHQvLyBoZXJrdW5mdF9wYXJlbnRfbm9kZSBtdXNzIHZvciBkZW0gbW92ZSBlcm1pdHRlbHQgd2VyZGVuIC0gZGFuYWNoIGlzdCBkZXIgcGFyZW50IGVpbiBhbmRlcmVyIVxyXG5cdFx0d2luZG93LmFwZi5oZXJrdW5mdF9wYXJlbnRfbm9kZSA9ICQuanN0cmVlLl9yZWZlcmVuY2UoZGF0YS5yc2x0Lm8pLl9nZXRfcGFyZW50KGRhdGEucnNsdC5vKTtcclxuXHR9KVxyXG5cdC5iaW5kKFwiY3JlYXRlX25vZGUuanN0cmVlXCIsIGZ1bmN0aW9uKGUsIGRhdGEpIHtcclxuXHRcdGlmIChkYXRhLnJzbHQucGFyZW50WzBdLmF0dHJpYnV0ZXMudHlwLm5vZGVWYWx1ZSA9PT0gXCJhcHppZWxqYWhyXCIpIHtcclxuXHRcdFx0dmFyIE9iamVrdCA9IHt9O1xyXG5cdFx0XHRPYmpla3QubmFtZSA9IFwiWmllbEphaHJcIjtcclxuXHRcdFx0T2JqZWt0LmZvcm11bGFyID0gXCJhcHppZWxcIjtcclxuXHRcdFx0d2luZG93LmFwZi5zcGVpY2hlcm4oT2JqZWt0KTtcclxuICAgICAgICAgICAgJChcIiNaaWVsSmFoclwiKVxyXG4gICAgICAgICAgICAgICAgLnZhbChkYXRhLnJzbHQucGFyZW50WzBdLmlubmVyVGV4dC5zbGljZSgxLCA1KSlcclxuICAgICAgICAgICAgICAgIC5mb2N1cygpO1xyXG5cdFx0fVxyXG5cdH0pXHJcblx0LmJpbmQoXCJtb3ZlX25vZGUuanN0cmVlXCIsIGZ1bmN0aW9uKGUsIGRhdGEpIHtcclxuXHRcdHZhciBoZXJrdW5mdF9ub2RlLFxyXG5cdFx0XHRoZXJrdW5mdF9ub2RlX2lkLFxyXG5cdFx0XHRoZXJrdW5mdF9ub2RlX3R5cCxcclxuXHRcdFx0emllbF9ub2RlLFxyXG5cdFx0XHR6aWVsX25vZGVfaWQsXHJcblx0XHRcdHppZWxfbm9kZV90eXAsXHJcblx0XHRcdHppZWxfcGFyZW50X25vZGUsXHJcblx0XHRcdHppZWxfcGFyZW50X25vZGVfaWQ7XHJcblx0XHRcclxuXHRcdC8vIG51ciBha3R1YWxpc2llcmVuLCB3ZW5uIFNjaHJlaWJyZWNodGUgYmVzdGVoZW5cclxuXHRcdGlmICghd2luZG93LmFwZi5wcsO8ZmVTY2hyZWlidm9yYXVzc2V0enVuZ2VuKCkpIHtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFZhcmlhYmxlbiBzZXR6ZW5cclxuXHRcdGhlcmt1bmZ0X25vZGUgPSBkYXRhLnJzbHQubztcclxuXHRcdGhlcmt1bmZ0X25vZGVfaWQgPSB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoaGVya3VuZnRfbm9kZSkuYXR0cihcImlkXCIpKTtcclxuXHRcdGhlcmt1bmZ0X25vZGVfdHlwID0gaGVya3VuZnRfbm9kZS5hdHRyKFwidHlwXCIpO1xyXG5cdFx0emllbF9ub2RlID0gZGF0YS5yc2x0LnI7XHJcblx0XHR6aWVsX25vZGVfaWQgPSB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoemllbF9ub2RlKS5hdHRyKFwiaWRcIikpO1xyXG5cdFx0emllbF9ub2RlX3R5cCA9IHppZWxfbm9kZS5hdHRyKFwidHlwXCIpO1xyXG5cdFx0emllbF9wYXJlbnRfbm9kZSA9ICQuanN0cmVlLl9yZWZlcmVuY2UoZGF0YS5yc2x0LnIpLl9nZXRfcGFyZW50KGRhdGEucnNsdC5yKTtcclxuXHRcdGlmICgkKHppZWxfcGFyZW50X25vZGUpLmF0dHIoXCJpZFwiKSkge1xyXG5cdFx0XHR6aWVsX3BhcmVudF9ub2RlX2lkID0gd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKHppZWxfcGFyZW50X25vZGUpLmF0dHIoXCJpZFwiKSk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKGhlcmt1bmZ0X25vZGVfdHlwID09PSBcInBvcFwiKSB7XHJcblx0XHRcdGlmICh6aWVsX25vZGVfdHlwID09PSBcInBvcFwiKSB7XHJcblx0XHRcdFx0dmFyIGbDvGdlUG9wRWluID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdHR5cGU6ICdwb3N0JyxcclxuXHRcdFx0XHRcdHVybDogJ3BocC9wb3BfZWluZnVlZ2VuLnBocCcsXHJcblx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcImFwX2FydF9pZFwiOiB6aWVsX3BhcmVudF9ub2RlX2lkLFxyXG5cdFx0XHRcdFx0XHRcInBvcF9pZFwiOiB6aWVsX25vZGVfaWQsXHJcblx0XHRcdFx0XHRcdFwidXNlclwiOiBzZXNzaW9uU3RvcmFnZS5Vc2VyXHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0ZsO8Z2VQb3BFaW4uYWx3YXlzKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gQW56YWhsZW4gYW5wYXNzZW4gZGVyIHBhcmVudC1ub2RlcyBhbSBIZXJrdW5mdHMtIHVuZCBaaWVsb3J0XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX3BvcCh6aWVsX3BhcmVudF9ub2RlKTtcclxuXHRcdFx0XHRcdHdpbmRvdy5hcGYuYmVzY2hyaWZ0ZV9vcmRuZXJfcG9wKHdpbmRvdy5hcGYuaGVya3VuZnRfcGFyZW50X25vZGUpO1xyXG5cdFx0XHRcdFx0Ly8gc2VsZWN0aW9uIHN0ZXVlcm5cclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoemllbF9ub2RlKS5kZXNlbGVjdF9hbGwoKTtcclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoaGVya3VuZnRfbm9kZSkuc2VsZWN0X25vZGUoaGVya3VuZnRfbm9kZSk7XHJcblx0XHRcdFx0XHQvLyBWYXJpYWJsZW4gYXVmcsOkdW1lblxyXG5cdFx0XHRcdFx0bG9jYWxTdG9yYWdlLnBvcF9pZCA9IGhlcmt1bmZ0X25vZGVfaWQ7XHJcblx0XHRcdFx0XHRkZWxldGUgd2luZG93LmFwZi5wb3A7XHJcblx0XHRcdFx0XHRkZWxldGUgd2luZG93LmFwZi5oZXJrdW5mdF9wYXJlbnRfbm9kZTtcclxuXHRcdFx0XHRcdHdpbmRvdy5hcGYuaW5pdGlpZXJlX3BvcCgpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdGbDvGdlUG9wRWluLmZhaWwoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBEaWUgVGVpbHBvcHVsYXRpb24gd3VyZGUgbmljaHQgdmVyc2Nob2JlblwiKTtcclxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKFwiRmVobGVyOiBEaWUgVGVpbHBvcHVsYXRpb24gd3VyZGUgbmljaHQgdmVyc2Nob2JlblwiKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoemllbF9ub2RlX3R5cCA9PT0gXCJ0cG9wXCIpIHtcclxuXHRcdFx0XHR2YXIgZsO8Z2VUUG9wRWluID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdHR5cGU6ICdwb3N0JyxcclxuXHRcdFx0XHRcdHVybDogJ3BocC90cG9wX2VpbmZ1ZWdlbi5waHAnLFxyXG5cdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XCJwb3BfaWRcIjogemllbF9wYXJlbnRfbm9kZV9pZCxcclxuXHRcdFx0XHRcdFx0XCJ0cG9wX2lkXCI6IHppZWxfbm9kZV9pZCxcclxuXHRcdFx0XHRcdFx0XCJ1c2VyXCI6IHNlc3Npb25TdG9yYWdlLlVzZXJcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRmw7xnZVRQb3BFaW4uYWx3YXlzKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gQW56YWhsZW4gYW5wYXNzZW4gZGVyIHBhcmVudC1ub2RlcyBhbSBIZXJrdW5mdHMtIHVuZCBaaWVsb3J0XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX3Rwb3AoemllbF9wYXJlbnRfbm9kZSk7XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX3Rwb3Aod2luZG93LmFwZi5oZXJrdW5mdF9wYXJlbnRfbm9kZSk7XHJcblx0XHRcdFx0XHQvLyBzZWxlY3Rpb24gc3RldWVyblxyXG5cdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZSh6aWVsX25vZGUpLmRlc2VsZWN0X2FsbCgpO1xyXG5cdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShoZXJrdW5mdF9ub2RlKS5zZWxlY3Rfbm9kZShoZXJrdW5mdF9ub2RlKTtcclxuXHRcdFx0XHRcdC8vIFZhcmlhYmxlbiBhdWZyw6R1bWVuXHJcblx0XHRcdFx0XHRsb2NhbFN0b3JhZ2UudHBvcF9pZCA9IGhlcmt1bmZ0X25vZGVfaWQ7XHJcblx0XHRcdFx0XHRkZWxldGUgd2luZG93LmFwZi50cG9wO1xyXG5cdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYudHBvcF9ub2RlX2F1c2dlc2Nobml0dGVuO1xyXG5cdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYuaGVya3VuZnRfcGFyZW50X25vZGU7XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV90cG9wKCk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0ZsO8Z2VUUG9wRWluLmZhaWwoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBEaWUgVGVpbHBvcHVsYXRpb24gd3VyZGUgbmljaHQgdmVyc2Nob2JlblwiKTtcclxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKFwiRmVobGVyOiBEaWUgVGVpbHBvcHVsYXRpb24gd3VyZGUgbmljaHQgdmVyc2Nob2JlblwiKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoemllbF9ub2RlX3R5cCA9PT0gXCJwb3Bfb3JkbmVyX3Rwb3BcIikge1xyXG5cdFx0XHRcdHZhciBmw7xnZVRQb3BFaW5fMiA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHRcdFx0XHR1cmw6ICdwaHAvdHBvcF9laW5mdWVnZW4ucGhwJyxcclxuXHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFwicG9wX2lkXCI6IHppZWxfbm9kZV9pZCxcclxuXHRcdFx0XHRcdFx0XCJ0cG9wX2lkXCI6IGhlcmt1bmZ0X25vZGVfaWQsXHJcblx0XHRcdFx0XHRcdFwidXNlclwiOiBzZXNzaW9uU3RvcmFnZS5Vc2VyXHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0ZsO8Z2VUUG9wRWluXzIuYWx3YXlzKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gQW56YWhsZW4gYW5wYXNzZW4gZGVyIHBhcmVudC1ub2RlcyBhbSBIZXJrdW5mdHMtIHVuZCBaaWVsb3J0XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX3Rwb3AoemllbF9ub2RlKTtcclxuXHRcdFx0XHRcdHdpbmRvdy5hcGYuYmVzY2hyaWZ0ZV9vcmRuZXJfdHBvcCh3aW5kb3cuYXBmLmhlcmt1bmZ0X3BhcmVudF9ub2RlKTtcclxuXHRcdFx0XHRcdC8vIHNlbGVjdCBzdGV1ZXJuXHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKHppZWxfbm9kZSkuZGVzZWxlY3RfYWxsKCk7XHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKHppZWxfbm9kZSkuc2VsZWN0X25vZGUoaGVya3VuZnRfbm9kZSk7XHJcblx0XHRcdFx0XHQvLyBWYXJpYWJsZW4gYXVmcsOkdW1lblxyXG5cdFx0XHRcdFx0bG9jYWxTdG9yYWdlLnRwb3BfaWQgPSBoZXJrdW5mdF9ub2RlX2lkO1xyXG5cdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYudHBvcDtcclxuXHRcdFx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLnRwb3Bfbm9kZV9hdXNnZXNjaG5pdHRlbjtcclxuXHRcdFx0XHRcdHdpbmRvdy5hcGYuaW5pdGlpZXJlX3Rwb3AoKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRmw7xnZVRQb3BFaW5fMi5mYWlsKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogRGllIFRlaWxwb3B1bGF0aW9uIHd1cmRlIG5pY2h0IHZlcnNjaG9iZW5cIik7XHJcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhcIkZlaGxlcjogRGllIFRlaWxwb3B1bGF0aW9uIHd1cmRlIG5pY2h0IHZlcnNjaG9iZW5cIik7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGlmIChoZXJrdW5mdF9ub2RlX3R5cCA9PT0gXCJ0cG9wXCIpIHtcclxuXHRcdFx0aWYgKHppZWxfbm9kZV90eXAgPT09IFwidHBvcFwiKSB7XHJcblx0XHRcdFx0dmFyIGbDvGdlVFBvcEVpbl8zID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdHR5cGU6ICdwb3N0JyxcclxuXHRcdFx0XHRcdHVybDogJ3BocC90cG9wX2VpbmZ1ZWdlbi5waHAnLFxyXG5cdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XCJwb3BfaWRcIjogemllbF9wYXJlbnRfbm9kZV9pZCxcclxuXHRcdFx0XHRcdFx0XCJ0cG9wX2lkXCI6IGhlcmt1bmZ0X25vZGVfaWQsXHJcblx0XHRcdFx0XHRcdFwidXNlclwiOiBzZXNzaW9uU3RvcmFnZS5Vc2VyXHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0ZsO8Z2VUUG9wRWluXzMuYWx3YXlzKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gQW56YWhsZW4gYW5wYXNzZW4gZGVyIHBhcmVudC1ub2RlcyBhbSBIZXJrdW5mdHMtIHVuZCBaaWVsb3J0XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX3Rwb3AoemllbF9wYXJlbnRfbm9kZSk7XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX3Rwb3Aod2luZG93LmFwZi5oZXJrdW5mdF9wYXJlbnRfbm9kZSk7XHJcblx0XHRcdFx0XHQvLyBzZWxlY3Rpb24gc3RldWVyblxyXG5cdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShoZXJrdW5mdF9ub2RlKS5kZXNlbGVjdF9hbGwoKTtcclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoemllbF9wYXJlbnRfbm9kZSkuc2VsZWN0X25vZGUoaGVya3VuZnRfbm9kZSk7XHJcblx0XHRcdFx0XHQvLyBWYXJpYWJsZW4gYXVmcsOkdW1lblxyXG5cdFx0XHRcdFx0bG9jYWxTdG9yYWdlLnRwb3BfaWQgPSBoZXJrdW5mdF9ub2RlX2lkO1xyXG5cdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYudHBvcDtcclxuXHRcdFx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLnRwb3Bfbm9kZV9hdXNnZXNjaG5pdHRlbjtcclxuXHRcdFx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLmhlcmt1bmZ0X3BhcmVudF9ub2RlO1xyXG5cdFx0XHRcdFx0d2luZG93LmFwZi5pbml0aWllcmVfdHBvcCgpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdGbDvGdlVFBvcEVpbl8zLmZhaWwoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBEaWUgVGVpbHBvcHVsYXRpb24gd3VyZGUgbmljaHQgdmVyc2Nob2JlblwiKTtcclxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKFwiRmVobGVyOiBEaWUgVGVpbHBvcHVsYXRpb24gd3VyZGUgbmljaHQgdmVyc2Nob2JlblwiKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoemllbF9ub2RlX3R5cCA9PT0gXCJwb3Bfb3JkbmVyX3Rwb3BcIikge1xyXG5cdFx0XHRcdHZhciBmw7xnZVRQb3BFaW5fNCA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHRcdFx0XHR1cmw6ICdwaHAvdHBvcF9laW5mdWVnZW4ucGhwJyxcclxuXHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFwicG9wX2lkXCI6IHppZWxfbm9kZV9pZCxcclxuXHRcdFx0XHRcdFx0XCJ0cG9wX2lkXCI6IGhlcmt1bmZ0X25vZGVfaWQsXHJcblx0XHRcdFx0XHRcdFwidXNlclwiOiBzZXNzaW9uU3RvcmFnZS5Vc2VyXHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0ZsO8Z2VUUG9wRWluXzQuYWx3YXlzKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gQW56YWhsZW4gYW5wYXNzZW4gZGVyIHBhcmVudC1ub2RlcyBhbSBIZXJrdW5mdHMtIHVuZCBaaWVsb3J0XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX3Rwb3AoemllbF9ub2RlKTtcclxuXHRcdFx0XHRcdHdpbmRvdy5hcGYuYmVzY2hyaWZ0ZV9vcmRuZXJfdHBvcCh3aW5kb3cuYXBmLmhlcmt1bmZ0X3BhcmVudF9ub2RlKTtcclxuXHRcdFx0XHRcdC8vIHNlbGVjdGlvbiBzdGV1ZXJuXHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGhlcmt1bmZ0X25vZGUpLmRlc2VsZWN0X2FsbCgpO1xyXG5cdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShoZXJrdW5mdF9ub2RlKS5zZWxlY3Rfbm9kZShoZXJrdW5mdF9ub2RlKTtcclxuXHRcdFx0XHRcdC8vIFZhcmlhYmxlbiBhdWZyw6R1bWVuXHJcblx0XHRcdFx0XHRsb2NhbFN0b3JhZ2UudHBvcF9pZCA9IGhlcmt1bmZ0X25vZGVfaWQ7XHJcblx0XHRcdFx0XHRkZWxldGUgd2luZG93LmFwZi50cG9wO1xyXG5cdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYudHBvcF9ub2RlX2F1c2dlc2Nobml0dGVuO1xyXG5cdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYuaGVya3VuZnRfcGFyZW50X25vZGU7XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV90cG9wKCk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0ZsO8Z2VUUG9wRWluXzQuZmFpbChmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IERpZSBUZWlscG9wdWxhdGlvbiB3dXJkZSBuaWNodCB2ZXJzY2hvYmVuXCIpO1xyXG5cdFx0XHRcdFx0Y29uc29sZS5sb2coXCJGZWhsZXI6IERpZSBUZWlscG9wdWxhdGlvbiB3dXJkZSBuaWNodCB2ZXJzY2hvYmVuXCIpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRpZiAoaGVya3VuZnRfbm9kZV90eXAgPT09IFwidHBvcG1hc3NuXCIpIHtcclxuXHRcdFx0aWYgKHppZWxfbm9kZV90eXAgPT09IFwidHBvcG1hc3NuXCIpIHtcclxuXHRcdFx0XHR2YXIgZsO8Z2VUUG9wTWFzc25FaW4gPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0dXJsOiAncGhwL3Rwb3BtYXNzbl9laW5mdWVnZW4ucGhwJyxcclxuXHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFwidHBvcF9pZFwiOiB6aWVsX3BhcmVudF9ub2RlX2lkLFxyXG5cdFx0XHRcdFx0XHRcInRwb3BtYXNzbl9pZFwiOiBoZXJrdW5mdF9ub2RlX2lkLFxyXG5cdFx0XHRcdFx0XHRcInVzZXJcIjogc2Vzc2lvblN0b3JhZ2UuVXNlclxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdGbDvGdlVFBvcE1hc3NuRWluLmFsd2F5cyhmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdC8vIEFuemFobGVuIGFucGFzc2VuIGRlciBwYXJlbnQtbm9kZXMgYW0gSGVya3VuZnRzLSB1bmQgWmllbG9ydFxyXG5cdFx0XHRcdFx0d2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl90cG9wbWFzc24oemllbF9wYXJlbnRfbm9kZSk7XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX3Rwb3BtYXNzbih3aW5kb3cuYXBmLmhlcmt1bmZ0X3BhcmVudF9ub2RlKTtcclxuXHRcdFx0XHRcdC8vIHNlbGVjdGlvbiBzdGV1ZXJuXHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGhlcmt1bmZ0X25vZGUpLmRlc2VsZWN0X2FsbCgpO1xyXG5cdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZSh6aWVsX3BhcmVudF9ub2RlKS5zZWxlY3Rfbm9kZShoZXJrdW5mdF9ub2RlKTtcclxuXHRcdFx0XHRcdC8vIFZhcmlhYmxlbiBhdWZyw6R1bWVuXHJcblx0XHRcdFx0XHRsb2NhbFN0b3JhZ2UudHBvcG1hc3NuX2lkID0gaGVya3VuZnRfbm9kZV9pZDtcclxuXHRcdFx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLnRwb3BtYXNzbjtcclxuXHRcdFx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLnRwb3BtYXNzbl9ub2RlX2F1c2dlc2Nobml0dGVuO1xyXG5cdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYuaGVya3VuZnRfcGFyZW50X25vZGU7XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV90cG9wbWFzc24oKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRmw7xnZVRQb3BNYXNzbkVpbi5mYWlsKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogRGllIE1hc3NuYWhtZSB3dXJkZSBuaWNodCB2ZXJzY2hvYmVuXCIpO1xyXG5cdFx0XHRcdFx0Y29uc29sZS5sb2coXCJGZWhsZXI6IERpZSBNYXNzbmFobWUgd3VyZGUgbmljaHQgdmVyc2Nob2JlblwiKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoemllbF9ub2RlX3R5cCA9PT0gXCJ0cG9wX29yZG5lcl9tYXNzblwiKSB7XHJcblx0XHRcdFx0dmFyIGbDvGdlVFBvcE1hc3NuRWluXzIgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0dXJsOiAncGhwL3Rwb3BtYXNzbl9laW5mdWVnZW4ucGhwJyxcclxuXHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFwidHBvcF9pZFwiOiB6aWVsX25vZGVfaWQsXHJcblx0XHRcdFx0XHRcdFwidHBvcG1hc3NuX2lkXCI6IGhlcmt1bmZ0X25vZGVfaWQsXHJcblx0XHRcdFx0XHRcdFwidXNlclwiOiBzZXNzaW9uU3RvcmFnZS5Vc2VyXHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0ZsO8Z2VUUG9wTWFzc25FaW5fMi5hbHdheXMoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQvLyBBbnphaGxlbiBhbnBhc3NlbiBkZXIgcGFyZW50LW5vZGVzIGFtIEhlcmt1bmZ0cy0gdW5kIFppZWxvcnRcclxuXHRcdFx0XHRcdHdpbmRvdy5hcGYuYmVzY2hyaWZ0ZV9vcmRuZXJfdHBvcG1hc3NuKHppZWxfbm9kZSk7XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX3Rwb3BtYXNzbih3aW5kb3cuYXBmLmhlcmt1bmZ0X3BhcmVudF9ub2RlKTtcclxuXHRcdFx0XHRcdC8vIHNlbGVjdGlvbiBzdGV1ZXJuXHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGhlcmt1bmZ0X25vZGUpLmRlc2VsZWN0X2FsbCgpO1xyXG5cdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShoZXJrdW5mdF9ub2RlKS5zZWxlY3Rfbm9kZShoZXJrdW5mdF9ub2RlKTtcclxuXHRcdFx0XHRcdC8vIFZhcmlhYmxlbiBhdWZyw6R1bWVuXHJcblx0XHRcdFx0XHRsb2NhbFN0b3JhZ2UudHBvcG1hc3NuX2lkID0gaGVya3VuZnRfbm9kZV9pZDtcclxuXHRcdFx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLnRwb3BtYXNzbjtcclxuXHRcdFx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLnRwb3BtYXNzbl9ub2RlX2F1c2dlc2Nobml0dGVuO1xyXG5cdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYuaGVya3VuZnRfcGFyZW50X25vZGU7XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV90cG9wbWFzc24oKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRmw7xnZVRQb3BNYXNzbkVpbl8yLmZhaWwoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBEaWUgTWFzc25haG1lIHd1cmRlIG5pY2h0IHZlcnNjaG9iZW5cIik7XHJcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhcIkZlaGxlcjogRGllIE1hc3NuYWhtZSB3dXJkZSBuaWNodCB2ZXJzY2hvYmVuXCIpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRpZiAoaGVya3VuZnRfbm9kZV90eXAgPT09IFwidHBvcGZlbGRrb250clwiKSB7XHJcblx0XHRcdGlmICh6aWVsX25vZGVfdHlwID09PSBcInRwb3BmZWxka29udHJcIikge1xyXG5cdFx0XHRcdHZhciBmw7xnZVRQb3BGZWxka29udHJFaW4gPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0dXJsOiAncGhwL3Rwb3BmZWxka29udHJfZWluZnVlZ2VuLnBocCcsXHJcblx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcInRwb3BfaWRcIjogemllbF9wYXJlbnRfbm9kZV9pZCxcclxuXHRcdFx0XHRcdFx0XCJ0cG9wZmVsZGtvbnRyX2lkXCI6IGhlcmt1bmZ0X25vZGVfaWQsXHJcblx0XHRcdFx0XHRcdFwidXNlclwiOiBzZXNzaW9uU3RvcmFnZS5Vc2VyXHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0ZsO8Z2VUUG9wRmVsZGtvbnRyRWluLmFsd2F5cyhmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdC8vIEFuemFobGVuIGFucGFzc2VuIGRlciBwYXJlbnQtbm9kZXMgYW0gSGVya3VuZnRzLSB1bmQgWmllbG9ydFxyXG5cdFx0XHRcdFx0d2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl90cG9wZmVsZGtvbnRyKHppZWxfcGFyZW50X25vZGUpO1xyXG5cdFx0XHRcdFx0d2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl90cG9wZmVsZGtvbnRyKHdpbmRvdy5hcGYuaGVya3VuZnRfcGFyZW50X25vZGUpO1xyXG5cdFx0XHRcdFx0Ly8gc2VsZWN0aW9uIHN0ZXVlcm5cclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoaGVya3VuZnRfbm9kZSkuZGVzZWxlY3RfYWxsKCk7XHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGhlcmt1bmZ0X25vZGUpLnNlbGVjdF9ub2RlKGhlcmt1bmZ0X25vZGUpO1xyXG5cdFx0XHRcdFx0Ly8gVmFyaWFibGVuIGF1ZnLDpHVtZW5cclxuXHRcdFx0XHRcdGxvY2FsU3RvcmFnZS50cG9wZmVsZGtvbnRyX2lkID0gaGVya3VuZnRfbm9kZV9pZDtcclxuXHRcdFx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLnRwb3BmZWxka29udHI7XHJcblx0XHRcdFx0XHRkZWxldGUgd2luZG93LmFwZi50cG9wZmVsZGtvbnRyX25vZGVfYXVzZ2VzY2huaXR0ZW47XHJcblx0XHRcdFx0XHRkZWxldGUgd2luZG93LmFwZi5oZXJrdW5mdF9wYXJlbnRfbm9kZTtcclxuXHRcdFx0XHRcdHdpbmRvdy5hcGYuaW5pdGlpZXJlX3Rwb3BmZWxka29udHIoKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRmw7xnZVRQb3BGZWxka29udHJFaW4uZmFpbChmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IERpZSBGZWxka29udHJvbGxlIHd1cmRlIG5pY2h0IHZlcnNjaG9iZW5cIik7XHJcblx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBEaWUgRmVsZGtvbnRyb2xsZSB3dXJkZSBuaWNodCB2ZXJzY2hvYmVuJyk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKHppZWxfbm9kZV90eXAgPT09IFwidHBvcF9vcmRuZXJfZmVsZGtvbnRyXCIpIHtcclxuXHRcdFx0XHR2YXIgZsO8Z2VUUG9wRmVsZGtvbnRyRWluXzIgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0dXJsOiAncGhwL3Rwb3BmZWxka29udHJfZWluZnVlZ2VuLnBocCcsXHJcblx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcInRwb3BfaWRcIjogemllbF9ub2RlX2lkLFxyXG5cdFx0XHRcdFx0XHRcInRwb3BmZWxka29udHJfaWRcIjogaGVya3VuZnRfbm9kZV9pZCxcclxuXHRcdFx0XHRcdFx0XCJ1c2VyXCI6IHNlc3Npb25TdG9yYWdlLlVzZXJcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRmw7xnZVRQb3BGZWxka29udHJFaW5fMi5hbHdheXMoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQvLyBBbnphaGxlbiBhbnBhc3NlbiBkZXIgcGFyZW50LW5vZGVzIGFtIEhlcmt1bmZ0cy0gdW5kIFppZWxvcnRcclxuXHRcdFx0XHRcdHdpbmRvdy5hcGYuYmVzY2hyaWZ0ZV9vcmRuZXJfdHBvcGZlbGRrb250cih6aWVsX25vZGUpO1xyXG5cdFx0XHRcdFx0d2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl90cG9wZmVsZGtvbnRyKHdpbmRvdy5hcGYuaGVya3VuZnRfcGFyZW50X25vZGUpO1xyXG5cdFx0XHRcdFx0Ly8gc2VsZWN0aW9uIHN0ZXVlcm5cclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoaGVya3VuZnRfbm9kZSkuZGVzZWxlY3RfYWxsKCk7XHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGhlcmt1bmZ0X25vZGUpLnNlbGVjdF9ub2RlKGhlcmt1bmZ0X25vZGUpO1xyXG5cdFx0XHRcdFx0Ly8gVmFyaWFibGVuIGF1ZnLDpHVtZW5cclxuXHRcdFx0XHRcdGxvY2FsU3RvcmFnZS50cG9wZmVsZGtvbnRyX2lkID0gaGVya3VuZnRfbm9kZV9pZDtcclxuXHRcdFx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLnRwb3BmZWxka29udHI7XHJcblx0XHRcdFx0XHRkZWxldGUgd2luZG93LmFwZi50cG9wZmVsZGtvbnRyX25vZGVfYXVzZ2VzY2huaXR0ZW47XHJcblx0XHRcdFx0XHRkZWxldGUgd2luZG93LmFwZi5oZXJrdW5mdF9wYXJlbnRfbm9kZTtcclxuXHRcdFx0XHRcdHdpbmRvdy5hcGYuaW5pdGlpZXJlX3Rwb3BmZWxka29udHIoKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRmw7xnZVRQb3BGZWxka29udHJFaW5fMi5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBEaWUgRmVsZGtvbnRyb2xsZSB3dXJkZSBuaWNodCB2ZXJzY2hvYmVuXCIpO1xyXG5cdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogRGllIEZlbGRrb250cm9sbGUgd3VyZGUgbmljaHQgdmVyc2Nob2JlbicpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRpZiAoaGVya3VuZnRfbm9kZV90eXAgPT09IFwidHBvcGZyZWl3a29udHJcIikge1xyXG5cdFx0XHRpZiAoemllbF9ub2RlX3R5cCA9PT0gXCJ0cG9wZnJlaXdrb250clwiKSB7XHJcblx0XHRcdFx0dmFyIGbDvGdlVFBvcEZlbGRrb250ckVpbl8zID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdHR5cGU6ICdwb3N0JyxcclxuXHRcdFx0XHRcdHVybDogJ3BocC90cG9wZmVsZGtvbnRyX2VpbmZ1ZWdlbi5waHAnLFxyXG5cdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XCJ0cG9wX2lkXCI6IHppZWxfcGFyZW50X25vZGVfaWQsXHJcblx0XHRcdFx0XHRcdFwidHBvcGZlbGRrb250cl9pZFwiOiBoZXJrdW5mdF9ub2RlX2lkLFxyXG5cdFx0XHRcdFx0XHRcInVzZXJcIjogc2Vzc2lvblN0b3JhZ2UuVXNlclxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdGbDvGdlVFBvcEZlbGRrb250ckVpbl8zLmFsd2F5cyhmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdC8vIEFuemFobGVuIGFucGFzc2VuIGRlciBwYXJlbnQtbm9kZXMgYW0gSGVya3VuZnRzLSB1bmQgWmllbG9ydFxyXG5cdFx0XHRcdFx0d2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl90cG9wZnJlaXdrb250cih6aWVsX3BhcmVudF9ub2RlKTtcclxuXHRcdFx0XHRcdHdpbmRvdy5hcGYuYmVzY2hyaWZ0ZV9vcmRuZXJfdHBvcGZyZWl3a29udHIod2luZG93LmFwZi5oZXJrdW5mdF9wYXJlbnRfbm9kZSk7XHJcblx0XHRcdFx0XHQvLyBzZWxlY3Rpb24gc3RldWVyblxyXG5cdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShoZXJrdW5mdF9ub2RlKS5kZXNlbGVjdF9hbGwoKTtcclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoaGVya3VuZnRfbm9kZSkuc2VsZWN0X25vZGUoaGVya3VuZnRfbm9kZSk7XHJcblx0XHRcdFx0XHQvLyBWYXJpYWJsZW4gYXVmcsOkdW1lblxyXG5cdFx0XHRcdFx0bG9jYWxTdG9yYWdlLnRwb3BmZWxka29udHJfaWQgPSBoZXJrdW5mdF9ub2RlX2lkO1xyXG5cdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYudHBvcGZlbGRrb250cjtcclxuXHRcdFx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLnRwb3BmcmVpd2tvbnRyX25vZGVfYXVzZ2VzY2huaXR0ZW47XHJcblx0XHRcdFx0XHRkZWxldGUgd2luZG93LmFwZi5oZXJrdW5mdF9wYXJlbnRfbm9kZTtcclxuXHRcdFx0XHRcdGxvY2FsU3RvcmFnZS50cG9wZnJlaXdrb250ciA9IHRydWU7XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV90cG9wZmVsZGtvbnRyKCk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0ZsO8Z2VUUG9wRmVsZGtvbnRyRWluXzMuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogRGllIEZyZWl3aWxsaWdlbi1Lb250cm9sbGUgd3VyZGUgbmljaHQgdmVyc2Nob2JlblwiKTtcclxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IERpZSBGcmVpd2lsbGlnZW4tS29udHJvbGxlIHd1cmRlIG5pY2h0IHZlcnNjaG9iZW4nKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoemllbF9ub2RlX3R5cCA9PT0gXCJ0cG9wX29yZG5lcl9mcmVpd2tvbnRyXCIpIHtcclxuXHRcdFx0XHR2YXIgZsO8Z2VUUG9wRmVsZGtvbnRyRWluXzQgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0dXJsOiAncGhwL3Rwb3BmZWxka29udHJfZWluZnVlZ2VuLnBocCcsXHJcblx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcInRwb3BfaWRcIjogemllbF9ub2RlX2lkLFxyXG5cdFx0XHRcdFx0XHRcInRwb3BmZWxka29udHJfaWRcIjogaGVya3VuZnRfbm9kZV9pZCxcclxuXHRcdFx0XHRcdFx0XCJ1c2VyXCI6IHNlc3Npb25TdG9yYWdlLlVzZXJcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRmw7xnZVRQb3BGZWxka29udHJFaW5fNC5hbHdheXMoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQvLyBBbnphaGxlbiBhbnBhc3NlbiBkZXIgcGFyZW50LW5vZGVzIGFtIEhlcmt1bmZ0cy0gdW5kIFppZWxvcnRcclxuXHRcdFx0XHRcdHdpbmRvdy5hcGYuYmVzY2hyaWZ0ZV9vcmRuZXJfdHBvcGZyZWl3a29udHIoemllbF9ub2RlKTtcclxuXHRcdFx0XHRcdHdpbmRvdy5hcGYuYmVzY2hyaWZ0ZV9vcmRuZXJfdHBvcGZyZWl3a29udHIod2luZG93LmFwZi5oZXJrdW5mdF9wYXJlbnRfbm9kZSk7XHJcblx0XHRcdFx0XHQvLyBzZWxlY3Rpb24gc3RldWVyblxyXG5cdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShoZXJrdW5mdF9ub2RlKS5kZXNlbGVjdF9hbGwoKTtcclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoaGVya3VuZnRfbm9kZSkuc2VsZWN0X25vZGUoaGVya3VuZnRfbm9kZSk7XHJcblx0XHRcdFx0XHQvLyBWYXJpYWJsZW4gYXVmcsOkdW1lblxyXG5cdFx0XHRcdFx0bG9jYWxTdG9yYWdlLnRwb3BmZWxka29udHJfaWQgPSBoZXJrdW5mdF9ub2RlX2lkO1xyXG5cdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYudHBvcGZlbGRrb250cjtcclxuXHRcdFx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLnRwb3BmcmVpd2tvbnRyX25vZGVfYXVzZ2VzY2huaXR0ZW47XHJcblx0XHRcdFx0XHRkZWxldGUgd2luZG93LmFwZi5oZXJrdW5mdF9wYXJlbnRfbm9kZTtcclxuXHRcdFx0XHRcdGxvY2FsU3RvcmFnZS50cG9wZnJlaXdrb250ciA9IHRydWU7XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV90cG9wZmVsZGtvbnRyKCk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0ZsO8Z2VUUG9wRmVsZGtvbnRyRWluXzQuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogRGllIEZyZWl3aWxsaWdlbi1Lb250cm9sbGUgd3VyZGUgbmljaHQgdmVyc2Nob2JlblwiKTtcclxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IERpZSBGcmVpd2lsbGlnZW4tS29udHJvbGxlIHd1cmRlIG5pY2h0IHZlcnNjaG9iZW4nKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0aWYgKGhlcmt1bmZ0X25vZGVfdHlwID09PSBcImJlb2JfenVnZW9yZG5ldFwiKSB7XHJcblx0XHRcdC8vIHp1Z2VvcmRuZXRcclxuXHRcdFx0aWYgKHppZWxfbm9kZV90eXAgPT09IFwiYmVvYl9uaWNodF9iZXVydGVpbHRcIiB8fCB6aWVsX25vZGVfdHlwID09PSBcImFwX29yZG5lcl9iZW9iX25pY2h0X2JldXJ0ZWlsdFwiKSB7XHJcblx0XHRcdFx0Ly8genVnZW9yZG5ldCA+IG5pY2h0IGJldXJ0ZWlsdFxyXG5cdFx0XHRcdHZhciBvcmRuZUJlb2JhY2h0dW5nWnUgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0dXJsOiAncGhwL2Jlb2JfenVvcmRudW5nX2RlbGV0ZS5waHAnLFxyXG5cdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XCJpZFwiOiBoZXJrdW5mdF9ub2RlX2lkXHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0b3JkbmVCZW9iYWNodHVuZ1p1LmFsd2F5cyhmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdC8vIHR5cCBkZXMgbm9kZXMgYW5wYXNzZW5cclxuXHRcdFx0XHRcdGhlcmt1bmZ0X25vZGUuYXR0cihcInR5cFwiLCBcImJlb2JfbmljaHRfYmV1cnRlaWx0XCIpO1xyXG5cdFx0XHRcdFx0bG9jYWxTdG9yYWdlLmJlb2J0eXAgPSBcImJlb2JfbmljaHRfYmV1cnRlaWx0XCI7XHJcblx0XHRcdFx0XHQvLyBBbnphaGxlbiBhbnBhc3NlbiBkZXIgcGFyZW50LW5vZGVzIGFtIEhlcmt1bmZ0cy0gdW5kIFppZWxvcnRcclxuXHRcdFx0XHRcdGlmICh6aWVsX25vZGVfdHlwID09PSBcImJlb2JfbmljaHRfYmV1cnRlaWx0XCIpIHtcclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl9iZW9iX25pY2h0X2JldXJ0ZWlsdCh6aWVsX3BhcmVudF9ub2RlKTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuYmVzY2hyaWZ0ZV9vcmRuZXJfYmVvYl9uaWNodF9iZXVydGVpbHQoemllbF9ub2RlKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHdpbmRvdy5hcGYuYmVzY2hyaWZ0ZV9vcmRuZXJfYmVvYl96dWdlb3JkbmV0KHdpbmRvdy5hcGYuaGVya3VuZnRfcGFyZW50X25vZGUpO1xyXG5cdFx0XHRcdFx0Ly8gYmVvYiBpbml0aWllcmVuXHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV9iZW9iKGhlcmt1bmZ0X25vZGUuYXR0cihcImJlb2J0eXBcIiksIGhlcmt1bmZ0X25vZGVfaWQsIFwibmljaHRfYmV1cnRlaWx0XCIpO1xyXG5cdFx0XHRcdFx0Ly8gVmFyaWFibGVuIGF1ZnLDpHVtZW5cclxuXHRcdFx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLmJlb2JfenVnZW9yZG5ldF9ub2RlX2F1c2dlc2Nobml0dGVuO1xyXG5cdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYuaGVya3VuZnRfcGFyZW50X25vZGU7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0b3JkbmVCZW9iYWNodHVuZ1p1LmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IERpZSBCZW9iYWNodHVuZyB3dXJkZSBuaWNodCBhdWYgJ25pY2h0IGJldXJ0ZWlsdCcgZ2VzZXR6dFwiKTtcclxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKFwiRmVobGVyOiBEaWUgQmVvYmFjaHR1bmcgd3VyZGUgbmljaHQgYXVmICduaWNodCBiZXVydGVpbHQnIGdlc2V0enRcIik7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKHppZWxfbm9kZV90eXAgPT09IFwiYmVvYl96dWdlb3JkbmV0XCIgfHwgemllbF9ub2RlX3R5cCA9PT0gXCJ0cG9wX29yZG5lcl9iZW9iX3p1Z2VvcmRuZXRcIikge1xyXG5cdFx0XHRcdC8vIHp1Z2VvcmRuZXQgPiB6dWdlb3JkbmV0XHJcblx0XHRcdFx0aWYgKHppZWxfbm9kZV90eXAgPT09IFwidHBvcF9vcmRuZXJfYmVvYl96dWdlb3JkbmV0XCIpIHtcclxuXHRcdFx0XHRcdG5ldWVfdHBvcF9pZCA9IHppZWxfbm9kZV9pZDtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0bmV1ZV90cG9wX2lkID0gemllbF9wYXJlbnRfbm9kZV9pZDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dmFyIG9yZG5lQmVvYmFjaHR1bmdadV8yID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdHR5cGU6ICdwb3N0JyxcclxuXHRcdFx0XHRcdHVybDogJ3BocC9iZW9iX3VwZGF0ZS5waHAnLFxyXG5cdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XCJpZFwiOiBsb2NhbFN0b3JhZ2UuYmVvYl9pZCxcclxuXHRcdFx0XHRcdFx0XCJGZWxkXCI6IFwiVFBvcElkXCIsXHJcblx0XHRcdFx0XHRcdFwiV2VydFwiOiBuZXVlX3Rwb3BfaWQsXHJcblx0XHRcdFx0XHRcdFwidXNlclwiOiBzZXNzaW9uU3RvcmFnZS5Vc2VyXHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0b3JkbmVCZW9iYWNodHVuZ1p1XzIuYWx3YXlzKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gQW56YWhsZW4gYW5wYXNzZW4gZGVyIHBhcmVudC1ub2RlcyBhbSBIZXJrdW5mdHMtIHVuZCBaaWVsb3J0XHJcblx0XHRcdFx0XHRpZiAoemllbF9ub2RlX3R5cCA9PT0gXCJ0cG9wX29yZG5lcl9iZW9iX3p1Z2VvcmRuZXRcIikge1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX2Jlb2JfenVnZW9yZG5ldCh6aWVsX25vZGUpO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl9iZW9iX3p1Z2VvcmRuZXQoemllbF9wYXJlbnRfbm9kZSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX2Jlb2JfenVnZW9yZG5ldCh3aW5kb3cuYXBmLmhlcmt1bmZ0X3BhcmVudF9ub2RlKTtcclxuXHRcdFx0XHRcdC8vIHNlbGVjdGlvbiBzdGV1ZXJuXHJcblx0XHRcdFx0XHRpZiAoIWxvY2FsU3RvcmFnZS5rYXJ0ZV9mb2t1c3NpZXJlbikge1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV9iZW9iKGhlcmt1bmZ0X25vZGUuYXR0cihcImJlb2J0eXBcIiksIGhlcmt1bmZ0X25vZGVfaWQsIFwienVnZW9yZG5ldFwiKTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdGRlbGV0ZSBsb2NhbFN0b3JhZ2Uua2FydGVfZm9rdXNzaWVyZW47XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHQvLyBWYXJpYWJsZW4gYXVmcsOkdW1lblxyXG5cdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYuYmVvYl96dWdlb3JkbmV0X25vZGVfYXVzZ2VzY2huaXR0ZW47XHJcblx0XHRcdFx0XHRkZWxldGUgd2luZG93LmFwZi5oZXJrdW5mdF9wYXJlbnRfbm9kZTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRvcmRuZUJlb2JhY2h0dW5nWnVfMi5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBEaWUgQmVvYmFjaHR1bmcgd3VyZGUgbmljaHQgdmVyc2Nob2JlblwiKTtcclxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IERpZSBCZW9iYWNodHVuZyB3dXJkZSBuaWNodCB2ZXJzY2hvYmVuJyk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKHppZWxfbm9kZV90eXAgPT09IFwiYmVvYl9uaWNodF96dXp1b3JkbmVuXCIgfHwgemllbF9ub2RlX3R5cCA9PT0gXCJhcF9vcmRuZXJfYmVvYl9uaWNodF96dXp1b3JkbmVuXCIpIHtcclxuXHRcdFx0XHQvLyB6dWdlb3JkbmV0ID4gbmljaHQgenV6dW9yZG5lblxyXG5cdFx0XHRcdHZhciBvcmRuZUJlb2JhY2h0dW5nWnVfMyA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHRcdFx0XHR1cmw6ICdwaHAvYmVvYl91cGRhdGUucGhwJyxcclxuXHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFwiaWRcIjogaGVya3VuZnRfbm9kZV9pZCxcclxuXHRcdFx0XHRcdFx0XCJGZWxkXCI6IFwiQmVvYk5pY2h0WnVvcmRuZW5cIixcclxuXHRcdFx0XHRcdFx0XCJXZXJ0XCI6IDEsXHJcblx0XHRcdFx0XHRcdFwidXNlclwiOiBzZXNzaW9uU3RvcmFnZS5Vc2VyXHJcblx0XHRcdFx0XHR9IFxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdG9yZG5lQmVvYmFjaHR1bmdadV8zLmFsd2F5cyhmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdC8vIFRQb3BJZCBudWxsIHNldHplblxyXG5cdFx0XHRcdFx0dmFyIHNldHplVHBvcGlkID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvYmVvYl91cGRhdGUucGhwJyxcclxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFwiaWRcIjogaGVya3VuZnRfbm9kZV9pZCxcclxuXHRcdFx0XHRcdFx0XHRcIkZlbGRcIjogXCJUUG9wSWRcIixcclxuXHRcdFx0XHRcdFx0XHRcIldlcnRcIjogXCJcIixcclxuXHRcdFx0XHRcdFx0XHRcInVzZXJcIjogc2Vzc2lvblN0b3JhZ2UuVXNlclxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdHNldHplVHBvcGlkLmFsd2F5cyhmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0Ly8gYXVzIHVuZXJmaW5kbGljaGVuIEdyw7xuZGVuIGzDpHVmdCBkZXIgc3VjY2VzcyBjYWxsYmFjayBuaWNodCwgZGFydW0gZG9uZVxyXG5cdFx0XHRcdFx0XHQvLyB0eXAgZGVzIG5vZGVzIGFucGFzc2VuXHJcblx0XHRcdFx0XHRcdGhlcmt1bmZ0X25vZGUuYXR0cihcInR5cFwiLCBcImJlb2JfbmljaHRfenV6dW9yZG5lblwiKTtcclxuXHRcdFx0XHRcdFx0bG9jYWxTdG9yYWdlLmJlb2J0eXAgPSBcImJlb2JfbmljaHRfenV6dW9yZG5lblwiO1xyXG5cdFx0XHRcdFx0XHQvLyBBbnphaGxlbiBhbnBhc3NlbiBkZXIgcGFyZW50LW5vZGVzIGFtIEhlcmt1bmZ0cy0gdW5kIFppZWxvcnRcclxuXHRcdFx0XHRcdFx0aWYgKHppZWxfbm9kZV90eXAgPT09IFwiYXBfb3JkbmVyX2Jlb2JfbmljaHRfenV6dW9yZG5lblwiKSB7XHJcblx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl9iZW9iX25pY2h0X3p1enVvcmRuZW4oemllbF9ub2RlKTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX2Jlb2JfbmljaHRfenV6dW9yZG5lbih6aWVsX3BhcmVudF9ub2RlKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX2Jlb2JfenVnZW9yZG5ldCh3aW5kb3cuYXBmLmhlcmt1bmZ0X3BhcmVudF9ub2RlKTtcclxuXHRcdFx0XHRcdFx0Ly8gQmVvYiBpbml0aWllcmVuXHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuaW5pdGlpZXJlX2Jlb2IoaGVya3VuZnRfbm9kZS5hdHRyKFwiYmVvYnR5cFwiKSwgaGVya3VuZnRfbm9kZV9pZCwgXCJuaWNodF96dXp1b3JkbmVuXCIpO1xyXG5cdFx0XHRcdFx0XHQvLyBWYXJpYWJsZW4gYXVmcsOkdW1lblxyXG5cdFx0XHRcdFx0XHRkZWxldGUgd2luZG93LmFwZi5iZW9iX25vZGVfYXVzZ2VzY2huaXR0ZW47XHJcblx0XHRcdFx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLmhlcmt1bmZ0X3BhcmVudF9ub2RlO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRzZXR6ZVRwb3BpZC5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhcImZlaGxlciBiZWltIExlZXJlbiB2b24gVFBvcElkXCIpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0b3JkbmVCZW9iYWNodHVuZ1p1XzMuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogRGllIEJlb2JhY2h0dW5nIHd1cmRlIG5pY2h0IHZlcnNjaG9iZW5cIik7XHJcblx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBEaWUgQmVvYmFjaHR1bmcgd3VyZGUgbmljaHQgdmVyc2Nob2JlbicpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRpZiAoaGVya3VuZnRfbm9kZV90eXAgPT09IFwiYmVvYl9uaWNodF9iZXVydGVpbHRcIikge1xyXG5cdFx0XHQvLyBuaWNodCBiZXVydGVpbHRcclxuXHRcdFx0aWYgKHppZWxfbm9kZV90eXAgPT09IFwiYmVvYl96dWdlb3JkbmV0XCIgfHwgemllbF9ub2RlX3R5cCA9PT0gXCJ0cG9wX29yZG5lcl9iZW9iX3p1Z2VvcmRuZXRcIikge1xyXG5cdFx0XHRcdC8vIG5pY2h0IGJldXJ0ZWlsdCA+IHp1Z2VvcmRuZXRcclxuXHRcdFx0XHRpZiAoemllbF9ub2RlX3R5cCA9PT0gXCJ0cG9wX29yZG5lcl9iZW9iX3p1Z2VvcmRuZXRcIikge1xyXG5cdFx0XHRcdFx0bmV1ZV90cG9wX2lkID0gemllbF9ub2RlX2lkO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRuZXVlX3Rwb3BfaWQgPSB6aWVsX3BhcmVudF9ub2RlX2lkO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQvLyBadWVyc3QgZWluZSBuZXVlIFp1b3JkbnVuZyBlcnN0ZWxsZW5cclxuXHRcdFx0XHR2YXIgaW5zZXJ0WnVvcmRudW5nID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdHR5cGU6ICdwb3N0JyxcclxuXHRcdFx0XHRcdHVybDogJ3BocC9iZW9iX3p1b3JkbnVuZ19pbnNlcnQucGhwJyxcclxuXHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFwibm9fbm90ZVwiOiBoZXJrdW5mdF9ub2RlX2lkLFxyXG5cdFx0XHRcdFx0XHRcInVzZXJcIjogc2Vzc2lvblN0b3JhZ2UuVXNlclxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdGluc2VydFp1b3JkbnVuZy5hbHdheXMoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQvLyBqZXR6dCBha3R1YWxpc2llcmVuXHJcblx0XHRcdFx0XHR2YXIgdXBkYXRlQmVvYiA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHRcdHR5cGU6ICdwb3N0JyxcclxuXHRcdFx0XHRcdFx0dXJsOiAncGhwL2Jlb2JfdXBkYXRlLnBocCcsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcImlkXCI6IGhlcmt1bmZ0X25vZGVfaWQsXHJcblx0XHRcdFx0XHRcdFx0XCJGZWxkXCI6IFwiVFBvcElkXCIsXHJcblx0XHRcdFx0XHRcdFx0XCJXZXJ0XCI6IG5ldWVfdHBvcF9pZCxcclxuXHRcdFx0XHRcdFx0XHRcInVzZXJcIjogc2Vzc2lvblN0b3JhZ2UuVXNlclxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdHVwZGF0ZUJlb2IuYWx3YXlzKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHQvLyB0eXAgZGVzIG5vZGVzIGFucGFzc2VuXHJcblx0XHRcdFx0XHRcdGhlcmt1bmZ0X25vZGUuYXR0cihcInR5cFwiLCBcImJlb2JfenVnZW9yZG5ldFwiKTtcclxuXHRcdFx0XHRcdFx0bG9jYWxTdG9yYWdlLmJlb2J0eXAgPSBcImJlb2JfenVnZW9yZG5ldFwiO1xyXG5cdFx0XHRcdFx0XHQvLyBQYXJlbnQgTm9kZS1CZXNjaHJpZnR1bmcgYW0gSGVya3VuZnQtIHVuZCBaaWVsb3J0OiBBbnphaGwgYW5wYXNzZW5cclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl9iZW9iX25pY2h0X2JldXJ0ZWlsdCh3aW5kb3cuYXBmLmhlcmt1bmZ0X3BhcmVudF9ub2RlKTtcclxuXHRcdFx0XHRcdFx0aWYgKHppZWxfbm9kZV90eXAgPT09IFwidHBvcF9vcmRuZXJfYmVvYl96dWdlb3JkbmV0XCIpIHtcclxuXHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX2Jlb2JfenVnZW9yZG5ldCh6aWVsX25vZGUpO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuYmVzY2hyaWZ0ZV9vcmRuZXJfYmVvYl96dWdlb3JkbmV0KHppZWxfcGFyZW50X25vZGUpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdC8vIHNlbGVjdGlvbiBzdGV1ZXJuXHJcblx0XHRcdFx0XHRcdGlmICghbG9jYWxTdG9yYWdlLmthcnRlX2Zva3Vzc2llcmVuKSB7XHJcblx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5pbml0aWllcmVfYmVvYihoZXJrdW5mdF9ub2RlLmF0dHIoXCJiZW9idHlwXCIpLCBoZXJrdW5mdF9ub2RlX2lkLCBcInp1Z2VvcmRuZXRcIik7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5rYXJ0ZV9mb2t1c3NpZXJlbjtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHQvLyBWYXJpYWJsZW4gYXVmcsOkdW1lblxyXG5cdFx0XHRcdFx0XHRkZWxldGUgd2luZG93LmFwZi5iZW9iX25vZGVfYXVzZ2VzY2huaXR0ZW47XHJcblx0XHRcdFx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLmhlcmt1bmZ0X3BhcmVudF9ub2RlO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR1cGRhdGVCZW9iLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogRGllIEJlb2JhY2h0dW5nIHd1cmRlIG5pY2h0IHp1Z2VvcmRuZXRcIik7XHJcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IERpZSBCZW9iYWNodHVuZyB3dXJkZSBuaWNodCB6dWdlb3JkbmV0Jyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRpbnNlcnRadW9yZG51bmcuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogRGllIEJlb2JhY2h0dW5nIHd1cmRlIG5pY2h0IHp1Z2VvcmRuZXRcIik7XHJcblx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBEaWUgQmVvYmFjaHR1bmcgd3VyZGUgbmljaHQgenVnZW9yZG5ldCcpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmICh6aWVsX25vZGVfdHlwID09PSBcImJlb2JfbmljaHRfenV6dW9yZG5lblwiIHx8IHppZWxfbm9kZV90eXAgPT09IFwiYXBfb3JkbmVyX2Jlb2JfbmljaHRfenV6dW9yZG5lblwiKSB7XHJcblx0XHRcdFx0Ly8gbmljaHQgYmV1cnRlaWx0ID4gbmljaHQgenVvcmRuZW5cclxuXHRcdFx0XHR2YXIgaW5zZXJ0WnVvcmRudW5nXzIgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0dXJsOiAncGhwL2Jlb2JfenVvcmRudW5nX2luc2VydC5waHAnLFxyXG5cdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XCJub19ub3RlXCI6IGhlcmt1bmZ0X25vZGVfaWQsXHJcblx0XHRcdFx0XHRcdFwidXNlclwiOiBzZXNzaW9uU3RvcmFnZS5Vc2VyXHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0aW5zZXJ0WnVvcmRudW5nXzIuYWx3YXlzKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gamV0enQgYWt0dWFsaXNpZXJlblxyXG5cdFx0XHRcdFx0dmFyIHVwZGF0ZUJlb2JfMiA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHRcdHR5cGU6ICdwb3N0JyxcclxuXHRcdFx0XHRcdFx0dXJsOiAncGhwL2Jlb2JfdXBkYXRlLnBocCcsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcImlkXCI6IGhlcmt1bmZ0X25vZGVfaWQsXHJcblx0XHRcdFx0XHRcdFx0XCJGZWxkXCI6IFwiQmVvYk5pY2h0WnVvcmRuZW5cIixcclxuXHRcdFx0XHRcdFx0XHRcIldlcnRcIjogMSxcclxuXHRcdFx0XHRcdFx0XHRcInVzZXJcIjogc2Vzc2lvblN0b3JhZ2UuVXNlclxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdHVwZGF0ZUJlb2JfMi5hbHdheXMoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vIHR5cCBkZXMgbm9kZXMgYW5wYXNzZW5cclxuXHRcdFx0XHRcdFx0JChoZXJrdW5mdF9ub2RlKS5hdHRyKFwidHlwXCIsIFwiYmVvYl9uaWNodF96dXp1b3JkbmVuXCIpO1xyXG5cdFx0XHRcdFx0XHRsb2NhbFN0b3JhZ2UuYmVvYnR5cCA9IFwiYmVvYl9uaWNodF96dXp1b3JkbmVuXCI7XHJcblx0XHRcdFx0XHRcdC8vIFBhcmVudCBOb2RlLUJlc2NocmlmdHVuZyBhbSBIZXJrdW5mdC0gdW5kIFppZWxvcnQ6IEFuemFobCBhbnBhc3NlblxyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX2Jlb2JfbmljaHRfYmV1cnRlaWx0KHdpbmRvdy5hcGYuaGVya3VuZnRfcGFyZW50X25vZGUpO1xyXG5cdFx0XHRcdFx0XHRpZiAoemllbF9ub2RlX3R5cCA9PT0gXCJhcF9vcmRuZXJfYmVvYl9uaWNodF96dXp1b3JkbmVuXCIpIHtcclxuXHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX2Jlb2JfbmljaHRfenV6dW9yZG5lbih6aWVsX25vZGUpO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuYmVzY2hyaWZ0ZV9vcmRuZXJfYmVvYl9uaWNodF96dXp1b3JkbmVuKHppZWxfcGFyZW50X25vZGUpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdC8vIEJlb2IgaW5pdGlpZXJlblxyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV9iZW9iKGhlcmt1bmZ0X25vZGUuYXR0cihcImJlb2J0eXBcIiksIGhlcmt1bmZ0X25vZGVfaWQsIFwibmljaHRfenV6dW9yZG5lblwiKTtcclxuXHRcdFx0XHRcdFx0Ly8gVmFyaWFibGVuIGF1ZnLDpHVtZW5cclxuXHRcdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYuYmVvYl9ub2RlX2F1c2dlc2Nobml0dGVuO1xyXG5cdFx0XHRcdFx0XHRkZWxldGUgd2luZG93LmFwZi5oZXJrdW5mdF9wYXJlbnRfbm9kZTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0dXBkYXRlQmVvYl8yLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKFwiRmVobGVyOiBEaWUgQmVvYmFjaHR1bmcgd3VyZGUgbmljaHQgenVnZW9yZG5ldFwiKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdGluc2VydFp1b3JkbnVuZ18yLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IERpZSBCZW9iYWNodHVuZyB3dXJkZSBuaWNodCB6dWdlb3JkbmV0XCIpO1xyXG5cdFx0XHRcdFx0Y29uc29sZS5sb2coXCJGZWhsZXI6IERpZSBCZW9iYWNodHVuZyB3dXJkZSBuaWNodCB6dWdlb3JkbmV0XCIpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRpZiAoaGVya3VuZnRfbm9kZV90eXAgPT09IFwiYmVvYl9uaWNodF96dXp1b3JkbmVuXCIpIHtcclxuXHRcdFx0Ly8gbmljaHQgenV6dW9yZG5lblxyXG5cdFx0XHRpZiAoemllbF9ub2RlX3R5cCA9PT0gXCJiZW9iX25pY2h0X2JldXJ0ZWlsdFwiIHx8IHppZWxfbm9kZV90eXAgPT09IFwiYXBfb3JkbmVyX2Jlb2JfbmljaHRfYmV1cnRlaWx0XCIpIHtcclxuXHRcdFx0XHQvLyBuaWNodCB6dXp1b3JkbmVuID4gbmljaHQgYmV1cnRlaWx0XHJcblx0XHRcdFx0dmFyIGRlbGV0ZVp1b3JkbnVuZyA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHRcdFx0XHR1cmw6ICdwaHAvYmVvYl96dW9yZG51bmdfZGVsZXRlLnBocCcsXHJcblx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcImlkXCI6IGhlcmt1bmZ0X25vZGVfaWRcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRkZWxldGVadW9yZG51bmcuYWx3YXlzKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gdHlwIGRlcyBub2RlcyBhbnBhc3NlblxyXG5cdFx0XHRcdFx0JChoZXJrdW5mdF9ub2RlKS5hdHRyKFwidHlwXCIsIFwiYmVvYl9uaWNodF9iZXVydGVpbHRcIik7XHJcblx0XHRcdFx0XHRsb2NhbFN0b3JhZ2UuYmVvYnR5cCA9IFwiYmVvYl9uaWNodF9iZXVydGVpbHRcIjtcclxuXHRcdFx0XHRcdC8vIFBhcmVudCBOb2RlLUJlc2NocmlmdHVuZyBhbSBIZXJrdW5mdC0gdW5kIFppZWxvcnQ6IEFuemFobCBhbnBhc3NlblxyXG5cdFx0XHRcdFx0d2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl9iZW9iX25pY2h0X3p1enVvcmRuZW4od2luZG93LmFwZi5oZXJrdW5mdF9wYXJlbnRfbm9kZSk7XHJcblx0XHRcdFx0XHRpZiAoemllbF9ub2RlX3R5cCA9PT0gXCJhcF9vcmRuZXJfYmVvYl9uaWNodF9iZXVydGVpbHRcIikge1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX2Jlb2JfbmljaHRfYmV1cnRlaWx0KHppZWxfbm9kZSk7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX2Jlb2JfbmljaHRfYmV1cnRlaWx0KHppZWxfcGFyZW50X25vZGUpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0Ly8gc2VsZWt0aWVyZW5cclxuXHRcdFx0XHRcdHdpbmRvdy5hcGYuaW5pdGlpZXJlX2Jlb2IoaGVya3VuZnRfbm9kZS5hdHRyKFwiYmVvYnR5cFwiKSwgaGVya3VuZnRfbm9kZV9pZCwgXCJuaWNodF9iZXVydGVpbHRcIik7XHJcblx0XHRcdFx0XHQvLyBWYXJpYWJsZW4gYXVmcsOkdW1lblxyXG5cdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYuYmVvYl9ub2RlX2F1c2dlc2Nobml0dGVuO1xyXG5cdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYuaGVya3VuZnRfcGFyZW50X25vZGU7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0ZGVsZXRlWnVvcmRudW5nLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IERpZSBadW9yZG51bmcgZGVyIEJlb2JhY2h0dW5nIHd1cmRlIG5pY2h0IGVudGZlcm50XCIpO1xyXG5cdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogRGllIFp1b3JkbnVuZyBkZXIgQmVvYmFjaHR1bmcgd3VyZGUgbmljaHQgZW50ZmVybnQnKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoemllbF9ub2RlX3R5cCA9PT0gXCJiZW9iX3p1Z2VvcmRuZXRcIiB8fCB6aWVsX25vZGVfdHlwID09PSBcInRwb3Bfb3JkbmVyX2Jlb2JfenVnZW9yZG5ldFwiKSB7XHJcblx0XHRcdFx0Ly8gbmljaHQgenV6dW9yZG5lbiA+IHp1Z2VvcmRuZXRcclxuXHRcdFx0XHR2YXIgbmV1ZV90cG9wX2lkO1xyXG5cdFx0XHRcdGlmICh6aWVsX25vZGVfdHlwID09PSBcInRwb3Bfb3JkbmVyX2Jlb2JfenVnZW9yZG5ldFwiKSB7XHJcblx0XHRcdFx0XHRuZXVlX3Rwb3BfaWQgPSB6aWVsX25vZGVfaWQ7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdG5ldWVfdHBvcF9pZCA9IHppZWxfcGFyZW50X25vZGVfaWQ7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHZhciB1cGRhdGVCZW9iXzMgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0dXJsOiAncGhwL2Jlb2JfdXBkYXRlLnBocCcsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcImlkXCI6IGhlcmt1bmZ0X25vZGVfaWQsXHJcblx0XHRcdFx0XHRcdFx0XCJGZWxkXCI6IFwiQmVvYk5pY2h0WnVvcmRuZW5cIixcclxuXHRcdFx0XHRcdFx0XHRcIldlcnRcIjogXCJcIixcclxuXHRcdFx0XHRcdFx0XHRcInVzZXJcIjogc2Vzc2lvblN0b3JhZ2UuVXNlclxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdHVwZGF0ZUJlb2JfMy5hbHdheXMoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgdXBkYXRlQmVvYl80ID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvYmVvYl91cGRhdGUucGhwJyxcclxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFwiaWRcIjogaGVya3VuZnRfbm9kZV9pZCxcclxuXHRcdFx0XHRcdFx0XHRcIkZlbGRcIjogXCJUUG9wSWRcIixcclxuXHRcdFx0XHRcdFx0XHRcIldlcnRcIjogbmV1ZV90cG9wX2lkLFxyXG5cdFx0XHRcdFx0XHRcdFwidXNlclwiOiBzZXNzaW9uU3RvcmFnZS5Vc2VyXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0dXBkYXRlQmVvYl80LmFsd2F5cyhmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0Ly8gdHlwIGRlcyBub2RlcyBhbnBhc3NlblxyXG5cdFx0XHRcdFx0XHQkKGhlcmt1bmZ0X25vZGUpLmF0dHIoXCJ0eXBcIiwgXCJiZW9iX3p1Z2VvcmRuZXRcIik7XHJcblx0XHRcdFx0XHRcdGxvY2FsU3RvcmFnZS5iZW9idHlwID0gXCJiZW9iX3p1Z2VvcmRuZXRcIjtcclxuXHRcdFx0XHRcdFx0Ly8gUGFyZW50IE5vZGUtQmVzY2hyaWZ0dW5nIGFtIEhlcmt1bmZ0LSB1bmQgWmllbG9ydDogQW56YWhsIGFucGFzc2VuXHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuYmVzY2hyaWZ0ZV9vcmRuZXJfYmVvYl9uaWNodF96dXp1b3JkbmVuKHdpbmRvdy5hcGYuaGVya3VuZnRfcGFyZW50X25vZGUpO1xyXG5cdFx0XHRcdFx0XHRpZiAoemllbF9ub2RlX3R5cCA9PT0gXCJ0cG9wX29yZG5lcl9iZW9iX3p1Z2VvcmRuZXRcIikge1xyXG5cdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuYmVzY2hyaWZ0ZV9vcmRuZXJfYmVvYl96dWdlb3JkbmV0KHppZWxfbm9kZSk7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl9iZW9iX3p1Z2VvcmRuZXQoemllbF9wYXJlbnRfbm9kZSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0Ly8gc2VsZWN0aW9uIHN0ZXVlcm5cclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi5pbml0aWllcmVfYmVvYihoZXJrdW5mdF9ub2RlLmF0dHIoXCJiZW9idHlwXCIpLCBoZXJrdW5mdF9ub2RlX2lkLCBcInp1Z2VvcmRuZXRcIik7XHJcblx0XHRcdFx0XHRcdC8vIFZhcmlhYmxlbiBhdWZyw6R1bWVuXHJcblx0XHRcdFx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLmJlb2Jfbm9kZV9hdXNnZXNjaG5pdHRlbjtcclxuXHRcdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYuaGVya3VuZnRfcGFyZW50X25vZGU7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdHVwZGF0ZUJlb2JfNC5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IERpZSBCZW9iYWNodHVuZyB3dXJkZSBuaWNodCB6dWdlb3JkbmV0XCIpO1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBEaWUgQmVvYmFjaHR1bmcgd3VyZGUgbmljaHQgenVnZW9yZG5ldCcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0dXBkYXRlQmVvYl8zLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IERpZSBCZW9iYWNodHVuZyB3dXJkZSBuaWNodCB6dWdlb3JkbmV0XCIpO1xyXG5cdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogRGllIEJlb2JhY2h0dW5nIHd1cmRlIG5pY2h0IHp1Z2VvcmRuZXQnKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0pO1xyXG5cdHJldHVybiBqc3RyZWVfZXJzdGVsbHQucHJvbWlzZSgpO1xyXG59O1xyXG5cclxuLy8gw7xiZXJuaW1tdCBlaW5lbiBub2RlXHJcbi8vIHrDpGhsdCBkZXNzZW4gY2hpbGRyZW4gdW5kIHBhc3N0IGRpZSBCZXNjaHJpZnR1bmcgYW5cclxud2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl9wb3AgPSBmdW5jdGlvbihub2RlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBhbnogPSAkKG5vZGUpLmZpbmQoXCI+IHVsID4gbGlcIikubGVuZ3RoLFxyXG5cdFx0YW56VHh0ID0gXCJQb3B1bGF0aW9uZW4gKFwiICsgYW56ICsgXCIpXCI7XHJcblx0JC5qc3RyZWUuX3JlZmVyZW5jZShub2RlKS5yZW5hbWVfbm9kZShub2RlLCBhbnpUeHQpO1xyXG59O1xyXG5cclxuLy8gw7xiZXJuaW1tdCBlaW5lbiBub2RlXHJcbi8vIHrDpGhsdCBkZXNzZW4gY2hpbGRyZW4gdW5kIHBhc3N0IGRpZSBCZXNjaHJpZnR1bmcgYW5cclxud2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl9hcHppZWwgPSBmdW5jdGlvbihub2RlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBhbnogPSAwLFxyXG5cdFx0YW56VHh0O1xyXG5cdCQoJC5qc3RyZWUuX3JlZmVyZW5jZShub2RlKS5fZ2V0X2NoaWxkcmVuKG5vZGUpKS5lYWNoKGZ1bmN0aW9uKGluZGV4KSB7XHJcblx0XHQkKCQodGhpcykuZmluZChcIj4gdWwgPiBsaVwiKSkuZWFjaChmdW5jdGlvbihpbmRleCkge1xyXG5cdFx0XHRhbnogKz0gMTtcclxuXHRcdH0pO1xyXG5cdH0pO1xyXG5cdGFuelR4dCA9IFwiQVAtWmllbGUgKFwiICsgYW56ICsgXCIpXCI7XHJcblx0JC5qc3RyZWUuX3JlZmVyZW5jZShub2RlKS5yZW5hbWVfbm9kZShub2RlLCBhbnpUeHQpO1xyXG59O1xyXG5cclxuLy8gw7xiZXJuaW1tdCBlaW5lbiBub2RlXHJcbi8vIHrDpGhsdCBkZXNzZW4gY2hpbGRyZW4gdW5kIHBhc3N0IGRpZSBCZXNjaHJpZnR1bmcgYW5cclxud2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl9hcHppZWxqYWhyID0gZnVuY3Rpb24obm9kZSkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgYW56ID0gJChub2RlKS5maW5kKFwiPiB1bCA+IGxpXCIpLmxlbmd0aCxcclxuXHRcdGFuelR4dDtcclxuXHRhbnpUeHQgPSAkLmpzdHJlZS5fcmVmZXJlbmNlKG5vZGUpLmdldF90ZXh0KG5vZGUpLnNsaWNlKDAsIDYpO1xyXG5cdGFuelR4dCArPSBhbnogKyBcIilcIjtcclxuXHQkLmpzdHJlZS5fcmVmZXJlbmNlKG5vZGUpLnJlbmFtZV9ub2RlKG5vZGUsIGFuelR4dCk7XHJcbn07XHJcblxyXG4vLyDDvGJlcm5pbW10IGVpbmVuIG5vZGVcclxuLy8gesOkaGx0IGRlc3NlbiBjaGlsZHJlbiB1bmQgcGFzc3QgZGllIEJlc2NocmlmdHVuZyBhblxyXG53aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX3ppZWxiZXIgPSBmdW5jdGlvbihub2RlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBhbnogPSAkKG5vZGUpLmZpbmQoXCI+IHVsID4gbGlcIikubGVuZ3RoLFxyXG5cdFx0YW56VHh0ID0gXCJaaWVsLUJlcmljaHRlIChcIiArIGFueiArIFwiKVwiO1xyXG5cdCQuanN0cmVlLl9yZWZlcmVuY2Uobm9kZSkucmVuYW1lX25vZGUobm9kZSwgYW56VHh0KTtcclxufTtcclxuXHJcbi8vIMO8YmVybmltbXQgZWluZW4gbm9kZVxyXG4vLyB6w6RobHQgZGVzc2VuIGNoaWxkcmVuIHVuZCBwYXNzdCBkaWUgQmVzY2hyaWZ0dW5nIGFuXHJcbndpbmRvdy5hcGYuYmVzY2hyaWZ0ZV9vcmRuZXJfZXJma3JpdCA9IGZ1bmN0aW9uKG5vZGUpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGFueiA9ICQobm9kZSkuZmluZChcIj4gdWwgPiBsaVwiKS5sZW5ndGgsXHJcblx0XHRhbnpUeHQgPSBcIkFQLUVyZm9sZ3Nrcml0ZXJpZW4gKFwiICsgYW56ICsgXCIpXCI7XHJcblx0JC5qc3RyZWUuX3JlZmVyZW5jZShub2RlKS5yZW5hbWVfbm9kZShub2RlLCBhbnpUeHQpO1xyXG59O1xyXG5cclxuLy8gw7xiZXJuaW1tdCBlaW5lbiBub2RlXHJcbi8vIHrDpGhsdCBkZXNzZW4gY2hpbGRyZW4gdW5kIHBhc3N0IGRpZSBCZXNjaHJpZnR1bmcgYW5cclxud2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl9qYmVyID0gZnVuY3Rpb24obm9kZSkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgYW56ID0gJChub2RlKS5maW5kKFwiPiB1bCA+IGxpXCIpLmxlbmd0aCxcclxuXHRcdGFuelR4dCA9IFwiQVAtQmVyaWNodGUgKFwiICsgYW56ICsgXCIpXCI7XHJcblx0JC5qc3RyZWUuX3JlZmVyZW5jZShub2RlKS5yZW5hbWVfbm9kZShub2RlLCBhbnpUeHQpO1xyXG59O1xyXG5cclxuLy8gw7xiZXJuaW1tdCBlaW5lbiBub2RlXHJcbi8vIHrDpGhsdCBkZXNzZW4gY2hpbGRyZW4gdW5kIHBhc3N0IGRpZSBCZXNjaHJpZnR1bmcgYW5cclxud2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl9iZXIgPSBmdW5jdGlvbihub2RlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBhbnogPSAkKG5vZGUpLmZpbmQoXCI+IHVsID4gbGlcIikubGVuZ3RoLFxyXG5cdFx0YW56VHh0ID0gXCJCZXJpY2h0ZSAoXCIgKyBhbnogKyBcIilcIjtcclxuXHQkLmpzdHJlZS5fcmVmZXJlbmNlKG5vZGUpLnJlbmFtZV9ub2RlKG5vZGUsIGFuelR4dCk7XHJcbn07XHJcblxyXG4vLyDDvGJlcm5pbW10IGVpbmVuIG5vZGVcclxuLy8gesOkaGx0IGRlc3NlbiBjaGlsZHJlbiB1bmQgcGFzc3QgZGllIEJlc2NocmlmdHVuZyBhblxyXG53aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX2Fzc296YXJ0ZW4gPSBmdW5jdGlvbihub2RlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBhbnogPSAkKG5vZGUpLmZpbmQoXCI+IHVsID4gbGlcIikubGVuZ3RoLFxyXG5cdFx0YW56VHh0ID0gXCJhc3NvemlpZXJ0ZSBBcnRlbiAoXCIgKyBhbnogKyBcIilcIjtcclxuXHQkLmpzdHJlZS5fcmVmZXJlbmNlKG5vZGUpLnJlbmFtZV9ub2RlKG5vZGUsIGFuelR4dCk7XHJcbn07XHJcblxyXG4vLyDDvGJlcm5pbW10IGVpbmVuIG5vZGVcclxuLy8gesOkaGx0IGRlc3NlbiBjaGlsZHJlbiB1bmQgcGFzc3QgZGllIEJlc2NocmlmdHVuZyBhblxyXG53aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX3Rwb3AgPSBmdW5jdGlvbihub2RlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBhbnogPSAkKG5vZGUpLmZpbmQoXCI+IHVsID4gbGlcIikubGVuZ3RoLFxyXG5cdFx0YW56VHh0ID0gXCJUZWlscG9wdWxhdGlvbmVuIChcIiArIGFueiArIFwiKVwiO1xyXG5cdCQuanN0cmVlLl9yZWZlcmVuY2Uobm9kZSkucmVuYW1lX25vZGUobm9kZSwgYW56VHh0KTtcclxufTtcclxuXHJcbi8vIMO8YmVybmltbXQgZWluZW4gbm9kZVxyXG4vLyB6w6RobHQgZGVzc2VuIGNoaWxkcmVuIHVuZCBwYXNzdCBkaWUgQmVzY2hyaWZ0dW5nIGFuXHJcbndpbmRvdy5hcGYuYmVzY2hyaWZ0ZV9vcmRuZXJfcG9wYmVyID0gZnVuY3Rpb24obm9kZSkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgYW56ID0gJChub2RlKS5maW5kKFwiPiB1bCA+IGxpXCIpLmxlbmd0aCxcclxuXHRcdGFuelR4dCA9IFwiUG9wdWxhdGlvbnMtQmVyaWNodGUgKFwiICsgYW56ICsgXCIpXCI7XHJcblx0JC5qc3RyZWUuX3JlZmVyZW5jZShub2RlKS5yZW5hbWVfbm9kZShub2RlLCBhbnpUeHQpO1xyXG59O1xyXG5cclxuLy8gw7xiZXJuaW1tdCBlaW5lbiBub2RlXHJcbi8vIHrDpGhsdCBkZXNzZW4gY2hpbGRyZW4gdW5kIHBhc3N0IGRpZSBCZXNjaHJpZnR1bmcgYW5cclxud2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl9wb3BtYXNzbmJlciA9IGZ1bmN0aW9uKG5vZGUpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGFueiA9ICQobm9kZSkuZmluZChcIj4gdWwgPiBsaVwiKS5sZW5ndGgsXHJcblx0XHRhbnpUeHQgPSBcIk1hc3NuYWhtZW4tQmVyaWNodGUgKFwiICsgYW56ICsgXCIpXCI7XHJcblx0JC5qc3RyZWUuX3JlZmVyZW5jZShub2RlKS5yZW5hbWVfbm9kZShub2RlLCBhbnpUeHQpO1xyXG59O1xyXG5cclxuLy8gw7xiZXJuaW1tdCBlaW5lbiBub2RlXHJcbi8vIHrDpGhsdCBkZXNzZW4gY2hpbGRyZW4gdW5kIHBhc3N0IGRpZSBCZXNjaHJpZnR1bmcgYW5cclxud2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl90cG9wbWFzc25iZXIgPSBmdW5jdGlvbihub2RlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBhbnogPSAkKG5vZGUpLmZpbmQoXCI+IHVsID4gbGlcIikubGVuZ3RoLFxyXG5cdFx0YW56VHh0ID0gXCJNYXNzbmFobWVuLUJlcmljaHRlIChcIiArIGFueiArIFwiKVwiO1xyXG5cdCQuanN0cmVlLl9yZWZlcmVuY2Uobm9kZSkucmVuYW1lX25vZGUobm9kZSwgYW56VHh0KTtcclxufTtcclxuXHJcbi8vIMO8YmVybmltbXQgZWluZW4gbm9kZVxyXG4vLyB6w6RobHQgZGVzc2VuIGNoaWxkcmVuIHVuZCBwYXNzdCBkaWUgQmVzY2hyaWZ0dW5nIGFuXHJcbndpbmRvdy5hcGYuYmVzY2hyaWZ0ZV9vcmRuZXJfdHBvcG1hc3NuID0gZnVuY3Rpb24obm9kZSkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgYW56ID0gJChub2RlKS5maW5kKFwiPiB1bCA+IGxpXCIpLmxlbmd0aCxcclxuXHRcdGFuelR4dCA9IFwiTWFzc25haG1lbiAoXCIgKyBhbnogKyBcIilcIjtcclxuXHQkLmpzdHJlZS5fcmVmZXJlbmNlKG5vZGUpLnJlbmFtZV9ub2RlKG5vZGUsIGFuelR4dCk7XHJcbn07XHJcblxyXG4vLyDDvGJlcm5pbW10IGVpbmVuIG5vZGVcclxuLy8gesOkaGx0IGRlc3NlbiBjaGlsZHJlbiB1bmQgcGFzc3QgZGllIEJlc2NocmlmdHVuZyBhblxyXG53aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX3Rwb3BiZXIgPSBmdW5jdGlvbihub2RlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBhbnogPSAkKG5vZGUpLmZpbmQoXCI+IHVsID4gbGlcIikubGVuZ3RoLFxyXG5cdFx0YW56VHh0ID0gXCJUZWlscG9wdWxhdGlvbnMtQmVyaWNodGUgKFwiICsgYW56ICsgXCIpXCI7XHJcblx0JC5qc3RyZWUuX3JlZmVyZW5jZShub2RlKS5yZW5hbWVfbm9kZShub2RlLCBhbnpUeHQpO1xyXG59O1xyXG5cclxuLy8gw7xiZXJuaW1tdCBlaW5lbiBub2RlXHJcbi8vIHrDpGhsdCBkZXNzZW4gY2hpbGRyZW4gdW5kIHBhc3N0IGRpZSBCZXNjaHJpZnR1bmcgYW5cclxud2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl90cG9wZmVsZGtvbnRyID0gZnVuY3Rpb24obm9kZSkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgYW56ID0gJChub2RlKS5maW5kKFwiPiB1bCA+IGxpXCIpLmxlbmd0aCxcclxuXHRcdGFuelR4dCA9IFwiRmVsZGtvbnRyb2xsZW4gKFwiICsgYW56ICsgXCIpXCI7XHJcblx0JC5qc3RyZWUuX3JlZmVyZW5jZShub2RlKS5yZW5hbWVfbm9kZShub2RlLCBhbnpUeHQpO1xyXG59O1xyXG5cclxuLy8gw7xiZXJuaW1tdCBlaW5lbiBub2RlXHJcbi8vIHrDpGhsdCBkZXNzZW4gY2hpbGRyZW4gdW5kIHBhc3N0IGRpZSBCZXNjaHJpZnR1bmcgYW5cclxud2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl90cG9wZnJlaXdrb250ciA9IGZ1bmN0aW9uKG5vZGUpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGFueiA9ICQobm9kZSkuZmluZChcIj4gdWwgPiBsaVwiKS5sZW5ndGgsXHJcblx0XHRhbnpUeHQgPSBcIkZyZWl3aWxsaWdlbi1Lb250cm9sbGVuIChcIiArIGFueiArIFwiKVwiO1xyXG5cdCQuanN0cmVlLl9yZWZlcmVuY2Uobm9kZSkucmVuYW1lX25vZGUobm9kZSwgYW56VHh0KTtcclxufTtcclxuXHJcbi8vIMO8YmVybmltbXQgZWluZW4gbm9kZVxyXG4vLyB6w6RobHQgZGVzc2VuIGNoaWxkcmVuIHVuZCBwYXNzdCBkaWUgQmVzY2hyaWZ0dW5nIGFuXHJcbndpbmRvdy5hcGYuYmVzY2hyaWZ0ZV9vcmRuZXJfYmVvYl96dWdlb3JkbmV0ID0gZnVuY3Rpb24obm9kZSkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgYW56ID0gJChub2RlKS5maW5kKFwiPiB1bCA+IGxpXCIpLmxlbmd0aCxcclxuXHRcdGFuelR4dCA9IFwiQmVvYmFjaHR1bmdlbiAoXCIgKyBhbnogKyBcIilcIjtcclxuXHQkLmpzdHJlZS5fcmVmZXJlbmNlKG5vZGUpLnJlbmFtZV9ub2RlKG5vZGUsIGFuelR4dCk7XHJcbn07XHJcblxyXG4vLyDDvGJlcm5pbW10IGVpbmVuIG5vZGVcclxuLy8gesOkaGx0IGRlc3NlbiBjaGlsZHJlbiB1bmQgcGFzc3QgZGllIEJlc2NocmlmdHVuZyBhblxyXG53aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX2Jlb2JfbmljaHRfYmV1cnRlaWx0ID0gZnVuY3Rpb24obm9kZSkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgYW56ID0gJChub2RlKS5maW5kKFwiPiB1bCA+IGxpXCIpLmxlbmd0aCxcclxuXHRcdGFuelR4dCA9IFwibmljaHQgYmV1cnRlaWx0ZSBCZW9iYWNodHVuZ2VuIChcIiArIGFueiArIFwiKVwiO1xyXG5cdCQuanN0cmVlLl9yZWZlcmVuY2Uobm9kZSkucmVuYW1lX25vZGUobm9kZSwgYW56VHh0KTtcclxufTtcclxuXHJcbi8vIMO8YmVybmltbXQgZWluZW4gbm9kZVxyXG4vLyB6w6RobHQgZGVzc2VuIGNoaWxkcmVuIHVuZCBwYXNzdCBkaWUgQmVzY2hyaWZ0dW5nIGFuXHJcbndpbmRvdy5hcGYuYmVzY2hyaWZ0ZV9vcmRuZXJfYmVvYl9uaWNodF96dXp1b3JkbmVuID0gZnVuY3Rpb24obm9kZSkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgYW56ID0gJChub2RlKS5maW5kKFwiPiB1bCA+IGxpXCIpLmxlbmd0aCxcclxuXHRcdGFuelR4dCA9IFwibmljaHQgenV6dW9yZG5lbmRlIEJlb2JhY2h0dW5nZW4gKFwiICsgYW56ICsgXCIpXCI7XHJcblx0JC5qc3RyZWUuX3JlZmVyZW5jZShub2RlKS5yZW5hbWVfbm9kZShub2RlLCBhbnpUeHQpO1xyXG59O1xyXG5cclxud2luZG93LmFwZi50cmVlS29udGV4dG1lbnUgPSBmdW5jdGlvbihub2RlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBpdGVtcyxcclxuXHRcdGFrdGl2ZXJfbm9kZSxcclxuXHRcdGFrdGl2ZXJfbm9kZVRleHQsXHJcblx0XHRwYXJlbnRfbm9kZSxcclxuXHRcdHBhcmVudF9ub2RlVGV4dCxcclxuXHRcdGdyYW5kcGFyZW50X25vZGUsXHJcblx0XHRuZXVlX2FwemllbGVfbm9kZTtcclxuXHQvLyByZWxldmFudGUgbm9kZXMgendpc2NoZW5zcGVpY2hlcm5cclxuXHQvLyBha3RpdmVyX25vZGUgPSBub2RlO1x0IGRhcyBoYXQgYXVjaCBmdW5rdGlvbmllcnRcclxuXHRha3RpdmVyX25vZGUgPSAkKFwiI3RyZWVcIikuanN0cmVlKCdnZXRfc2VsZWN0ZWQnKTtcclxuXHRha3RpdmVyX25vZGVUZXh0ID0gJC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLmdldF90ZXh0KGFrdGl2ZXJfbm9kZSk7XHJcblx0Ly8gcGFyZW50IG51ciBlcm1pdHRlbG4sIHdlbm4gcGFyZW50cyBleGlzaXRlcmVuIC0gc29uc3QgZ2lidCBlcyBlaW5lbiBGZWhsZXJcclxuXHRpZiAoJChha3RpdmVyX25vZGUpLmF0dHIoXCJ0eXBcIikuc2xpY2UoMCwgOSkgIT09IFwiYXBfb3JkbmVyXCIgJiYgJChha3RpdmVyX25vZGUpLmF0dHIoXCJ0eXBcIikgIT09IFwiaWRlYWxiaW90b3BcIikge1xyXG5cdFx0cGFyZW50X25vZGUgPSAkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkuX2dldF9wYXJlbnQoYWt0aXZlcl9ub2RlKTtcclxuXHRcdHBhcmVudF9ub2RlVGV4dCA9ICQuanN0cmVlLl9yZWZlcmVuY2UocGFyZW50X25vZGUpLmdldF90ZXh0KHBhcmVudF9ub2RlKTtcclxuXHR9XHJcblx0c3dpdGNoKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwidHlwXCIpKSB7XHJcbiAgICAgICAgY2FzZSBcImFwX29yZG5lcl9wb3BcIjpcclxuXHRcdGl0ZW1zID0ge1xyXG5cdFx0XHRcInVudGVyZ2VvcmRuZXRlS25vdGVuT2VmZm5lblwiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcInVudGVyZ2VvcmRuZXRlIEtub3RlbiDDtmZmbmVuXCIsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL3RyZWUxNngxNi5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2Uobm9kZSkub3Blbl9hbGwobm9kZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LFxyXG5cdFx0XHRcIm5ldVwiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcIm5ldWUgUG9wdWxhdGlvblwiLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9uZXUucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgaW5zZXJ0UG9wID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvcG9wX2luc2VydC5waHAnLFxyXG5cdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFx0XCJpZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwiaWRcIikpLFxyXG5cdFx0XHRcdFx0XHRcdFwidHlwXCI6IFwicG9wXCIsXHJcblx0XHRcdFx0XHRcdFx0XCJ1c2VyXCI6IHNlc3Npb25TdG9yYWdlLlVzZXJcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpbnNlcnRQb3AuYWx3YXlzKGZ1bmN0aW9uKGlkKSB7XHJcblx0XHRcdFx0XHRcdHZhciBzdHJ1a3R1cnR5cCA9IFwicG9wXCIsXHJcblx0XHRcdFx0XHRcdFx0YmVzY2hyaWZ0dW5nID0gXCJuZXVlIFBvcHVsYXRpb25cIjtcclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi5pbnNlcnROZXVlbk5vZGVFaW5lSGllcmFyY2hpZXN0dWZlVGllZmVyKGFrdGl2ZXJfbm9kZSwgcGFyZW50X25vZGUsIHN0cnVrdHVydHlwLCBpZCwgYmVzY2hyaWZ0dW5nKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aW5zZXJ0UG9wLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogS2VpbmUgbmV1ZSBQb3B1bGF0aW9uIGVyc3RlbGx0XCIpO1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBLZWluZSBuZXVlIFBvcHVsYXRpb24gZXJzdGVsbHQnKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSxcclxuXHRcdFx0XCJHZW9BZG1pbk1hcHNcIjoge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogXCJhdWYgQ0gtS2FydGVuIHplaWdlblwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9mbG9yYV9pY29uX2dlbGIucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgZ2V0UG9wc0NoS2FydGUgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHR0eXBlOiAnZ2V0JyxcclxuXHRcdFx0XHRcdFx0dXJsOiAncGhwL3BvcHNfY2hfa2FydGUucGhwJyxcclxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFwiQXBBcnRJZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwiaWRcIikpXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Z2V0UG9wc0NoS2FydGUuYWx3YXlzKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHRcdFx0aWYgKGRhdGEucm93cy5sZW5ndGggPiAwKSB7XHJcblx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi56ZWlnZVBvcEF1Zk9sbWFwKCk7XHJcblx0XHRcdFx0XHRcdFx0Ly93aW5kb3cuYXBmLnplaWdlUG9wQXVmT2xtYXAoZGF0YSk7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5tZWxkZShcIkRpZSBQb3B1bGF0aW9uIGhhdCBrZWluZSBLb29yZGluYXRlblwiLCBcIkFrdGlvbiBhYmdlYnJvY2hlblwiKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRnZXRQb3BzQ2hLYXJ0ZS5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IEtlaW5lIERhdGVuIGVyaGFsdGVuXCIpO1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBLZWluZSBEYXRlbiBlcmhhbHRlbicpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LFxyXG5cdFx0XHRcIkdvb2dsZU1hcHNcIjoge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogXCJhdWYgR29vZ2xlLUthcnRlbiB6ZWlnZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvZmxvcmFfaWNvbi5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdHZhciBnZXRBcEthcnRlID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ2dldCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ3BocC9hcF9rYXJ0ZS5waHAnLFxyXG5cdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFx0XCJpZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwiaWRcIikpXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Z2V0QXBLYXJ0ZS5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRcdFx0XHRpZiAoZGF0YS5yb3dzLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmdtYXAuemVpZ2VUUG9wKGRhdGEpO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYubWVsZGUoXCJFcyBnaWJ0IGtlaW5lIFRlaWxwb3B1bGF0aW9uIG1pdCBLb29yZGluYXRlblwiLCBcIkFrdGlvbiBhYmdlYnJvY2hlblwiKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRnZXRBcEthcnRlLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogS2VpbmUgRGF0ZW4gZXJoYWx0ZW5cIik7XHJcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IEtlaW5lIERhdGVuIGVyaGFsdGVuJyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0XHRpZiAod2luZG93LmFwZi5wb3BfenVtX3ZlcnNjaGllYmVuX2dlbWVya3QpIHtcclxuXHRcdFx0aXRlbXMuZWluZnVlZ2VuID0ge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogXCInXCIgKyB3aW5kb3cuYXBmLnBvcF9iZXplaWNobnVuZyArIFwiJyBlaW5mw7xnZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvZWluZnVlZ2VuLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gZGIgYWt0dWFsaXNpZXJlblxyXG5cdFx0XHRcdFx0dmFyIHVwZGF0ZVBvcCA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHRcdHR5cGU6ICdwb3N0JyxcclxuXHRcdFx0XHRcdFx0dXJsOiAncGhwL3BvcF91cGRhdGUucGhwJyxcclxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFwiaWRcIjogd2luZG93LmFwZi5wb3BfaWQsXHJcblx0XHRcdFx0XHRcdFx0XCJGZWxkXCI6IFwiQXBBcnRJZFwiLFxyXG5cdFx0XHRcdFx0XHRcdFwiV2VydFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwiaWRcIikpLFxyXG5cdFx0XHRcdFx0XHRcdFwidXNlclwiOiBzZXNzaW9uU3RvcmFnZS5Vc2VyXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0dXBkYXRlUG9wLmFsd2F5cyhmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0Ly8gQmF1bSBuZXUgYXVmYmF1ZW5cclxuXHRcdFx0XHRcdFx0JC53aGVuKHdpbmRvdy5hcGYuZXJzdGVsbGVfdHJlZSh3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwiaWRcIikpKSlcclxuXHRcdFx0XHRcdFx0XHQudGhlbihmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIGRhbm4gZGVuIGVpbmdlZsO8Z3RlbiBOb2RlIHfDpGhsZW5cclxuXHRcdFx0XHRcdFx0XHRcdCQoXCIjdHJlZVwiKS5qc3RyZWUoXCJzZWxlY3Rfbm9kZVwiLCBcIlt0eXA9J3BvcCddI1wiICsgbG9jYWxTdG9yYWdlLnBvcF9pZCk7IFxyXG5cdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHQvLyBlaW5mw7xnZW4gc29sbCBuaWNodCBtZWhyIGFuZ2V6ZWlndCB3ZXJkZW5cclxuXHRcdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYucG9wX3p1bV92ZXJzY2hpZWJlbl9nZW1lcmt0O1xyXG5cdFx0XHRcdFx0XHQvLyBuaWNodCBtZWhyIGJlbsO2dGlndGUgVmFyaWFibGVuIGVudGZlcm5lblxyXG5cdFx0XHRcdFx0XHRkZWxldGUgd2luZG93LmFwZi5wb3BfYmV6ZWljaG51bmc7XHJcblx0XHRcdFx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLnBvcF9pZDtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0dXBkYXRlUG9wLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogRGllIFBvcHVsYXRpb24gd3VyZGUgbmljaHQgdmVyc2Nob2JlblwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogRGllIFBvcHVsYXRpb24gd3VyZGUgbmljaHQgdmVyc2Nob2JlbicpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gaXRlbXM7XHJcblx0Y2FzZSBcImFwX29yZG5lcl9hcHppZWxcIjpcclxuXHRcdGl0ZW1zID0ge1xyXG5cdFx0XHRcInVudGVyZ2VvcmRuZXRlS25vdGVuT2VmZm5lblwiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcInVudGVyZ2VvcmRuZXRlIEtub3RlbiDDtmZmbmVuXCIsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL3RyZWUxNngxNi5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2Uobm9kZSkub3Blbl9hbGwobm9kZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LFxyXG5cdFx0XHRcIm5ldVwiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcIm5ldWVzIFppZWxcIixcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvbmV1LnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0dmFyIGluc2VydEFwemllbCA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHRcdHR5cGU6ICdwb3N0JyxcclxuXHRcdFx0XHRcdFx0dXJsOiAncGhwL2FwemllbF9pbnNlcnQucGhwJyxcclxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFwiaWRcIjogd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKGFrdGl2ZXJfbm9kZSkuYXR0cihcImlkXCIpKSxcclxuXHRcdFx0XHRcdFx0XHRcInR5cFwiOiBcImFwemllbFwiLFxyXG5cdFx0XHRcdFx0XHRcdFwidXNlclwiOiBzZXNzaW9uU3RvcmFnZS5Vc2VyXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aW5zZXJ0QXB6aWVsLmFsd2F5cyhmdW5jdGlvbihpZCkge1xyXG5cdFx0XHRcdFx0XHR2YXIgc3RydWt0dXJ0eXAgPSBcImFwemllbFwiLFxyXG5cdFx0XHRcdFx0XHRcdGJlc2NocmlmdHVuZyA9IFwibmV1ZXMgWmllbFwiO1xyXG5cdFx0XHRcdFx0XHQvLyBtaXR0ZWlsZW4sIGRhc3Mgdm9uIGdhbnogb2JlbiBlaW4gYXB6aWVsIGVyc3RlbGx0IHdpcmQgdW5kIGRhaGVyIG5vY2ggZWluIFp3aXNjaGVub3JkbmVyIGVyc3RlbGx0IHdlcmRlbiBtdXNzXHJcblx0XHRcdFx0XHRcdGxvY2FsU3RvcmFnZS5hcHppZWxfdm9uX29yZG5lcl9hcHppZWwgPSB0cnVlO1xyXG5cdFx0XHRcdFx0XHQvLyB6dXIgU2ljaGVyaGVpdCBkZW4gYW5kZXJlbiBaZWlnZXIgbMO2c2NoZW5cclxuXHRcdFx0XHRcdFx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5hcHppZWxfdm9uX2FwemllbGphaHI7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuaW5zZXJ0TmV1ZW5Ob2RlRWluZUhpZXJhcmNoaWVzdHVmZVRpZWZlcihha3RpdmVyX25vZGUsIHBhcmVudF9ub2RlLCBzdHJ1a3R1cnR5cCwgaWQsIGJlc2NocmlmdHVuZyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydEFwemllbC5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IEtlaW5lIG5ldWVzIEFQLVppZWwgZXJzdGVsbHRcIik7XHJcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IEtlaW5lIG5ldWVzIEFQLVppZWwgZXJzdGVsbHQnKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHRcdHJldHVybiBpdGVtcztcclxuXHRjYXNlIFwiYXB6aWVsamFoclwiOlxyXG5cdFx0aXRlbXMgPSB7XHJcblx0XHRcdFwidW50ZXJnZW9yZG5ldGVLbm90ZW5PZWZmbmVuXCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwidW50ZXJnZW9yZG5ldGUgS25vdGVuIMO2ZmZuZW5cIixcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvdHJlZTE2eDE2LnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShub2RlKS5vcGVuX2FsbChub2RlKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sXHJcblx0XHRcdFwibmV1XCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwibmV1ZXMgWmllbFwiLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9uZXUucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgaW5zZXJ0QXB6aWVsXzIgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ3BocC9hcHppZWxfaW5zZXJ0LnBocCcsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcImlkXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJChwYXJlbnRfbm9kZSkuYXR0cihcImlkXCIpKSxcclxuXHRcdFx0XHRcdFx0XHRcInR5cFwiOiBcImFwemllbFwiLFxyXG5cdFx0XHRcdFx0XHRcdFwidXNlclwiOiBzZXNzaW9uU3RvcmFnZS5Vc2VyXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aW5zZXJ0QXB6aWVsXzIuYWx3YXlzKGZ1bmN0aW9uKGlkKSB7XHJcblx0XHRcdFx0XHRcdHZhciBzdHJ1a3R1cnR5cCA9IFwiYXB6aWVsXCIsXHJcblx0XHRcdFx0XHRcdFx0YmVzY2hyaWZ0dW5nID0gXCJuZXVlcyBaaWVsXCI7XHJcblx0XHRcdFx0XHRcdGxvY2FsU3RvcmFnZS5hcHppZWxfdm9uX2FwemllbGphaHIgPSB0cnVlO1xyXG5cdFx0XHRcdFx0XHQvLyB6dXIgU2ljaGVyaGVpdCBkZW4gYW5kZXJlbiBaZWlnZXIgbMO2c2NoZW5cclxuXHRcdFx0XHRcdFx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5hcHppZWxfdm9uX29yZG5lcl9hcHppZWw7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuaW5zZXJ0TmV1ZW5Ob2RlRWluZUhpZXJhcmNoaWVzdHVmZVRpZWZlcihha3RpdmVyX25vZGUsIHBhcmVudF9ub2RlLCBzdHJ1a3R1cnR5cCwgaWQsIGJlc2NocmlmdHVuZyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydEFwemllbF8yLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogS2VpbmUgbmV1ZXMgWmllbCBlcnN0ZWxsdFwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogS2VpbmUgbmV1ZXMgWmllbCBlcnN0ZWxsdCcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cdFx0cmV0dXJuIGl0ZW1zO1xyXG5cdGNhc2UgXCJhcHppZWxcIjpcclxuXHRcdGl0ZW1zID0ge1xyXG5cdFx0XHRcIm5ldVwiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcIm5ldWVzIFppZWxcIixcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvbmV1LnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gbnVyIGFrdHVhbGlzaWVyZW4sIHdlbm4gU2NocmVpYnJlY2h0ZSBiZXN0ZWhlblxyXG5cdFx0XHRcdFx0aWYgKCF3aW5kb3cuYXBmLnByw7xmZVNjaHJlaWJ2b3JhdXNzZXR6dW5nZW4oKSkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRncmFuZHBhcmVudF9ub2RlID0gJC5qc3RyZWUuX3JlZmVyZW5jZShwYXJlbnRfbm9kZSkuX2dldF9wYXJlbnQocGFyZW50X25vZGUpO1xyXG5cdFx0XHRcdFx0dmFyIGluc2VydEFwemllbF8zID0gJC5hamF4KCB7XHJcblx0XHRcdFx0XHRcdHR5cGU6ICdwb3N0JyxcclxuXHRcdFx0XHRcdFx0dXJsOiAncGhwL2FwemllbF9pbnNlcnQucGhwJyxcclxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFwiaWRcIjogd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKGdyYW5kcGFyZW50X25vZGUpLmF0dHIoXCJpZFwiKSksXHJcblx0XHRcdFx0XHRcdFx0XCJ1c2VyXCI6IHNlc3Npb25TdG9yYWdlLlVzZXJcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpbnNlcnRBcHppZWxfMy5hbHdheXMoZnVuY3Rpb24oaWQpIHtcclxuXHRcdFx0XHRcdFx0dmFyIHN0cnVrdHVydHlwID0gXCJhcHppZWxcIixcclxuXHRcdFx0XHRcdFx0XHRiZXNjaHJpZnR1bmcgPSBcIm5ldWVzIFppZWxcIjtcclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi5pbnNlcnROZXVlbk5vZGVBdWZHbGVpY2hlckhpZXJhcmNoaWVzdHVmZShha3RpdmVyX25vZGUsIHBhcmVudF9ub2RlLCBzdHJ1a3R1cnR5cCwgaWQsIGJlc2NocmlmdHVuZyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydEFwemllbF8zLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogS2VpbiBuZXVlcyBBUC1aaWVsIGVyc3RlbGx0XCIpO1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBLZWluIG5ldWVzIEFQLVppZWwgZXJzdGVsbHQnKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSxcclxuXHRcdFx0XCJsb2VzY2hlblwiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcImzDtnNjaGVuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL2xvZXNjaGVuLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gbnVyIGFrdHVhbGlzaWVyZW4sIHdlbm4gU2NocmVpYnJlY2h0ZSBiZXN0ZWhlblxyXG5cdFx0XHRcdFx0aWYgKCF3aW5kb3cuYXBmLnByw7xmZVNjaHJlaWJ2b3JhdXNzZXR6dW5nZW4oKSkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHQvLyBzZWxla3RpZXJlbiwgZmFsbHMgZGlyZWt0IG1pdCBkZXIgcmVjaHRlbiBNYXVzdGFzdGUgZ2V3w6RobHQgd3VyZGVcclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5kZXNlbGVjdF9hbGwoKTtcclxuXHRcdFx0XHRcdC8vIGFsbGUgdGllZmVyZW4gS25vdGVuIMO2ZmZuZW4gdW0genUgemVpZ2VuLCB3YXMgbWl0IGdlbMO2c2NodCB3aXJkXHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkub3Blbl9hbGwoYWt0aXZlcl9ub2RlKTtcclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5kZXNlbGVjdF9hbGwoKTtcclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5zZWxlY3Rfbm9kZShha3RpdmVyX25vZGUpO1xyXG5cdFx0XHRcdFx0dmFyIGJlemVpY2hudW5nID0gJC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLmdldF90ZXh0KGFrdGl2ZXJfbm9kZSk7XHJcblx0XHRcdFx0XHQkKFwiI2xvZXNjaGVuX2RpYWxvZ19taXR0ZWlsdW5nXCIpLmh0bWwoXCJEYXMgQVAtWmllbCAnXCIgKyBiZXplaWNobnVuZyArIFwiJyB3aXJkIGdlbMO2c2NodC5cIik7XHJcblx0XHRcdFx0XHQkKFwiI2xvZXNjaGVuX2RpYWxvZ1wiKS5kaWFsb2coe1xyXG5cdFx0XHRcdFx0XHRyZXNpemFibGU6IGZhbHNlLFxyXG5cdFx0XHRcdFx0XHRoZWlnaHQ6J2F1dG8nLFxyXG5cdFx0XHRcdFx0XHR3aWR0aDogNDAwLFxyXG5cdFx0XHRcdFx0XHRtb2RhbDogdHJ1ZSxcclxuXHRcdFx0XHRcdFx0YnV0dG9uczoge1xyXG5cdFx0XHRcdFx0XHRcdFwiamEsIGzDtnNjaGVuIVwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdCQodGhpcykuZGlhbG9nKFwiY2xvc2VcIik7XHJcblx0XHRcdFx0XHRcdFx0XHQvLyBWYXJpYWJsZSB6dW0gcsO8Y2tnw6RuZ2lnIG1hY2hlbiBlcnN0ZWxsZW5cclxuXHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZGVsZXRlZCA9IHdpbmRvdy5hcGYuYXB6aWVsO1xyXG5cdFx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5kZWxldGVkLnR5cCA9IFwiYXB6aWVsXCI7XHJcblx0XHRcdFx0XHRcdFx0XHR2YXIgZGVsZXRlQXB6aWVsID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHR1cmw6ICdwaHAvYXB6aWVsX2RlbGV0ZS5waHAnLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XCJpZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwiaWRcIikpXHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0ZGVsZXRlQXB6aWVsLmFsd2F5cyhmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5hcHppZWxfaWQ7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLmFwemllbDtcclxuXHRcdFx0XHRcdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLmRlbGV0ZV9ub2RlKGFrdGl2ZXJfbm9kZSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vIGdyYW5kcGFyZW50IE5vZGUtQmVzY2hyaWZ0dW5nOiBBbnphaGwgYW5wYXNzZW5cclxuXHRcdFx0XHRcdFx0XHRcdFx0Z3JhbmRwYXJlbnRfbm9kZSA9ICQuanN0cmVlLl9yZWZlcmVuY2UocGFyZW50X25vZGUpLl9nZXRfcGFyZW50KHBhcmVudF9ub2RlKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl9hcHppZWwoZ3JhbmRwYXJlbnRfbm9kZSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vIHBhcmVudCBOb2RlLUJlc2NocmlmdHVuZzogQW56YWhsIGFucGFzc2VuXHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmICgkLmpzdHJlZS5fcmVmZXJlbmNlKHBhcmVudF9ub2RlKS5nZXRfdGV4dChwYXJlbnRfbm9kZSkgIT09IFwibmV1ZSBBUC1aaWVsZVwiKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl9hcHppZWxqYWhyKHBhcmVudF9ub2RlKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBIaW53ZWlzIHp1bSByw7xja2fDpG5naWcgbWFjaGVuIGFuemVpZ2VuXHJcblx0XHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZnJhZ2VPYkFrdGlvblLDvGNrZ8OkbmdpZ0dlbWFjaHRXZXJkZW5Tb2xsKFwiRGFzIEFQLVppZWwgJ1wiICsgYmV6ZWljaG51bmcgKyBcIicgd3VyZGUgZ2Vsw7ZzY2h0LlwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0ZGVsZXRlQXB6aWVsLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogRGFzIEFQLVppZWwgd3VyZGUgbmljaHQgZ2Vsw7ZzY2h0XCIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBEYXMgQVAtWmllbCB3dXJkZSBuaWNodCBnZWzDtnNjaHQnKTtcclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdFx0XCJhYmJyZWNoZW5cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHQkKHRoaXMpLmRpYWxvZyhcImNsb3NlXCIpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cdFx0cmV0dXJuIGl0ZW1zO1xyXG5cdGNhc2UgXCJ6aWVsYmVyX29yZG5lclwiOlxyXG5cdFx0aXRlbXMgPSB7XHJcblx0XHRcdFwibmV1XCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwibmV1ZXIgWmllbC1CZXJpY2h0XCIsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL25ldS5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdHZhciBpbnNlcnRaaWVsYmVyID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvemllbGJlcl9pbnNlcnQucGhwJyxcclxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFwiaWRcIjogd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKGFrdGl2ZXJfbm9kZSkuYXR0cihcImlkXCIpKSxcclxuXHRcdFx0XHRcdFx0XHRcInVzZXJcIjogc2Vzc2lvblN0b3JhZ2UuVXNlclxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydFppZWxiZXIuYWx3YXlzKGZ1bmN0aW9uKGlkKSB7XHJcblx0XHRcdFx0XHRcdHZhciBzdHJ1a3R1cnR5cCA9IFwiemllbGJlclwiLFxyXG5cdFx0XHRcdFx0XHRcdGJlc2NocmlmdHVuZyA9IFwibmV1ZXIgWmllbC1CZXJpY2h0XCI7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuaW5zZXJ0TmV1ZW5Ob2RlRWluZUhpZXJhcmNoaWVzdHVmZVRpZWZlcihha3RpdmVyX25vZGUsIHBhcmVudF9ub2RlLCBzdHJ1a3R1cnR5cCwgaWQsIGJlc2NocmlmdHVuZyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydFppZWxiZXIuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBLZWluZW4gbmV1ZW4gWmllbC1CZXJpY2h0IGVyc3RlbGx0XCIpO1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBLZWluZW4gbmV1ZW4gWmllbC1CZXJpY2h0IGVyc3RlbGx0Jyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0XHRyZXR1cm4gaXRlbXM7XHJcblx0Y2FzZSBcInppZWxiZXJcIjpcclxuXHRcdGl0ZW1zID0ge1xyXG5cdFx0XHRcIm5ldVwiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcIm5ldWVyIFppZWwtQmVyaWNodFwiLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9uZXUucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgaW5zZXJ0WmllbGJlcl8yID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvemllbGJlcl9pbnNlcnQucGhwJyxcclxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFwiaWRcIjogd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKHBhcmVudF9ub2RlKS5hdHRyKFwiaWRcIikpLFxyXG5cdFx0XHRcdFx0XHRcdFwidHlwXCI6IFwiemllbGJlclwiLFxyXG5cdFx0XHRcdFx0XHRcdFwidXNlclwiOiBzZXNzaW9uU3RvcmFnZS5Vc2VyXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aW5zZXJ0WmllbGJlcl8yLmFsd2F5cyhmdW5jdGlvbihpZCkge1xyXG5cdFx0XHRcdFx0XHR2YXIgc3RydWt0dXJ0eXAgPSBcInppZWxiZXJcIixcclxuXHRcdFx0XHRcdFx0XHRiZXNjaHJpZnR1bmcgPSBcIm5ldWVyIFppZWwtQmVyaWNodFwiO1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmluc2VydE5ldWVuTm9kZUF1ZkdsZWljaGVySGllcmFyY2hpZXN0dWZlKGFrdGl2ZXJfbm9kZSwgcGFyZW50X25vZGUsIHN0cnVrdHVydHlwLCBpZCwgYmVzY2hyaWZ0dW5nKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aW5zZXJ0WmllbGJlcl8yLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogS2VpbmVuIG5ldWVuIFppZWwtQmVyaWNodCBlcnN0ZWxsdFwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogS2VpbmVuIG5ldWVuIFppZWwtQmVyaWNodCBlcnN0ZWxsdCcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LFxyXG5cdFx0XHRcImxvZXNjaGVuXCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwibMO2c2NoZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvbG9lc2NoZW4ucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQvLyBudXIgYWt0dWFsaXNpZXJlbiwgd2VubiBTY2hyZWlicmVjaHRlIGJlc3RlaGVuXHJcblx0XHRcdFx0XHRpZiAoIXdpbmRvdy5hcGYucHLDvGZlU2NocmVpYnZvcmF1c3NldHp1bmdlbigpKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdC8vIHNlbGVrdGllcmVuLCBmYWxscyBkaXJla3QgbWl0IGRlciByZWNodGVuIE1hdXN0YXN0ZSBnZXfDpGhsdCB3dXJkZVxyXG5cdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLmRlc2VsZWN0X2FsbCgpO1xyXG5cdFx0XHRcdFx0Ly8gYWxsZSB0aWVmZXJlbiBLbm90ZW4gw7ZmZm5lbiB1bSB6dSB6ZWlnZW4sIHdhcyBtaXQgZ2Vsw7ZzY2h0IHdpcmRcclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5vcGVuX2FsbChha3RpdmVyX25vZGUpO1xyXG5cdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLmRlc2VsZWN0X2FsbCgpO1xyXG5cdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLnNlbGVjdF9ub2RlKGFrdGl2ZXJfbm9kZSk7XHJcblx0XHRcdFx0XHR2YXIgYmV6ZWljaG51bmcgPSAkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkuZ2V0X3RleHQoYWt0aXZlcl9ub2RlKTtcclxuXHRcdFx0XHRcdCQoXCIjbG9lc2NoZW5fZGlhbG9nX21pdHRlaWx1bmdcIikuaHRtbChcIkRlciBaaWVsLUJlcmljaHQgJ1wiICsgYmV6ZWljaG51bmcgKyBcIicgd2lyZCBnZWzDtnNjaHQuXCIpO1xyXG5cdFx0XHRcdFx0JChcIiNsb2VzY2hlbl9kaWFsb2dcIikuZGlhbG9nKHtcclxuXHRcdFx0XHRcdFx0cmVzaXphYmxlOiBmYWxzZSxcclxuXHRcdFx0XHRcdFx0aGVpZ2h0OidhdXRvJyxcclxuXHRcdFx0XHRcdFx0d2lkdGg6IDQwMCxcclxuXHRcdFx0XHRcdFx0bW9kYWw6IHRydWUsXHJcblx0XHRcdFx0XHRcdGJ1dHRvbnM6IHtcclxuXHRcdFx0XHRcdFx0XHRcImphLCBsw7ZzY2hlbiFcIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHQkKHRoaXMpLmRpYWxvZyhcImNsb3NlXCIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gVmFyaWFibGUgenVtIHLDvGNrZ8OkbmdpZyBtYWNoZW4gZXJzdGVsbGVuXHJcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmRlbGV0ZWQgPSB3aW5kb3cuYXBmLnppZWxiZXI7XHJcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmRlbGV0ZWQudHlwID0gXCJ6aWVsYmVyXCI7XHJcblx0XHRcdFx0XHRcdFx0XHR2YXIgZGVsZXRlWmllbGJlciA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHR5cGU6ICdwb3N0JyxcclxuXHRcdFx0XHRcdFx0XHRcdFx0dXJsOiAncGhwL3ppZWxiZXJfZGVsZXRlLnBocCcsXHJcblx0XHRcdFx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcImlkXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJChha3RpdmVyX25vZGUpLmF0dHIoXCJpZFwiKSlcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0XHRkZWxldGVaaWVsYmVyLmFsd2F5cyhmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZGVsZXRlIGxvY2FsU3RvcmFnZS56aWVsYmVyX2lkO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRkZWxldGUgd2luZG93LmFwZi56aWVsYmVyO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkuZGVsZXRlX25vZGUoYWt0aXZlcl9ub2RlKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gUGFyZW50IE5vZGUtQmVzY2hyaWZ0dW5nOiBBbnphaGwgYW5wYXNzZW5cclxuXHRcdFx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl96aWVsYmVyKHBhcmVudF9ub2RlKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gSGlud2VpcyB6dW0gcsO8Y2tnw6RuZ2lnIG1hY2hlbiBhbnplaWdlblxyXG5cdFx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmZyYWdlT2JBa3Rpb25Sw7xja2fDpG5naWdHZW1hY2h0V2VyZGVuU29sbChcIkRlciBaaWVsLUJlcmljaHQgJ1wiICsgYmV6ZWljaG51bmcgKyBcIicgd3VyZGUgZ2Vsw7ZzY2h0LlwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0ZGVsZXRlWmllbGJlci5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IERlciBaaWVsLUJlcmljaHQgd3VyZGUgbmljaHQgZ2Vsw7ZzY2h0XCIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBEZXIgWmllbC1CZXJpY2h0IHd1cmRlIG5pY2h0IGdlbMO2c2NodCcpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0XHRcImFiYnJlY2hlblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdCQodGhpcykuZGlhbG9nKFwiY2xvc2VcIik7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcdFx0XHRcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0XHRyZXR1cm4gaXRlbXM7XHJcblx0Y2FzZSBcImFwX29yZG5lcl9lcmZrcml0XCI6XHJcblx0XHRpdGVtcyA9IHtcclxuXHRcdFx0XCJuZXVcIjoge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogXCJuZXVlcyBFcmZvbGdza3JpdGVyaXVtXCIsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL25ldS5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdHZhciBpbnNlcnRFcmZrcml0ID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvZXJma3JpdF9pbnNlcnQucGhwJyxcclxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFwiaWRcIjogd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKGFrdGl2ZXJfbm9kZSkuYXR0cihcImlkXCIpKSxcclxuXHRcdFx0XHRcdFx0XHRcInVzZXJcIjogc2Vzc2lvblN0b3JhZ2UuVXNlclxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydEVyZmtyaXQuYWx3YXlzKGZ1bmN0aW9uKGlkKSB7XHJcblx0XHRcdFx0XHRcdHZhciBzdHJ1a3R1cnR5cCA9IFwiZXJma3JpdFwiLFxyXG5cdFx0XHRcdFx0XHRcdGJlc2NocmlmdHVuZyA9IFwibmV1ZXMgRXJmb2xnc2tyaXRlcml1bVwiO1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmluc2VydE5ldWVuTm9kZUVpbmVIaWVyYXJjaGllc3R1ZmVUaWVmZXIoYWt0aXZlcl9ub2RlLCBwYXJlbnRfbm9kZSwgc3RydWt0dXJ0eXAsIGlkLCBiZXNjaHJpZnR1bmcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpbnNlcnRFcmZrcml0LmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogS2VpbiBuZXVlcyBFcmZvbGdza3JpdGVyaXVtIGVyc3RlbGx0XCIpO1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBLZWluIG5ldWVzIEVyZm9sZ3Nrcml0ZXJpdW0gZXJzdGVsbHQnKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHRcdHJldHVybiBpdGVtcztcclxuXHRjYXNlIFwiZXJma3JpdFwiOlxyXG5cdFx0aXRlbXMgPSB7XHJcblx0XHRcdFwibmV1XCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwibmV1ZXMgRXJmb2xnc2tyaXRlcml1bVwiLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9uZXUucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgaW5zZXJ0RXJma3JpdF8yID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvZXJma3JpdF9pbnNlcnQucGhwJyxcclxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFwiaWRcIjogd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKHBhcmVudF9ub2RlKS5hdHRyKFwiaWRcIikpLFxyXG5cdFx0XHRcdFx0XHRcdFwidHlwXCI6IFwiZXJma3JpdFwiLFxyXG5cdFx0XHRcdFx0XHRcdFwidXNlclwiOiBzZXNzaW9uU3RvcmFnZS5Vc2VyXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aW5zZXJ0RXJma3JpdF8yLmFsd2F5cyhmdW5jdGlvbihpZCkge1xyXG5cdFx0XHRcdFx0XHR2YXIgc3RydWt0dXJ0eXAgPSBcImVyZmtyaXRcIixcclxuXHRcdFx0XHRcdFx0XHRiZXNjaHJpZnR1bmcgPSBcIm5ldWVzIEVyZm9sZ3Nrcml0ZXJpdW1cIjtcclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi5pbnNlcnROZXVlbk5vZGVBdWZHbGVpY2hlckhpZXJhcmNoaWVzdHVmZShha3RpdmVyX25vZGUsIHBhcmVudF9ub2RlLCBzdHJ1a3R1cnR5cCwgaWQsIGJlc2NocmlmdHVuZyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydEVyZmtyaXRfMi5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IEtlaW4gbmV1ZXMgRXJmb2xnc2tyaXRlcml1bSBlcnN0ZWxsdFwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogS2VpbiBuZXVlcyBFcmZvbGdza3JpdGVyaXVtIGVyc3RlbGx0Jyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sXHJcblx0XHRcdFwibG9lc2NoZW5cIjoge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogXCJsw7ZzY2hlblwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9sb2VzY2hlbi5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdC8vIG51ciBha3R1YWxpc2llcmVuLCB3ZW5uIFNjaHJlaWJyZWNodGUgYmVzdGVoZW5cclxuXHRcdFx0XHRcdGlmICghd2luZG93LmFwZi5wcsO8ZmVTY2hyZWlidm9yYXVzc2V0enVuZ2VuKCkpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0Ly8gc2VsZWt0aWVyZW4sIGZhbGxzIGRpcmVrdCBtaXQgZGVyIHJlY2h0ZW4gTWF1c3Rhc3RlIGdld8OkaGx0IHd1cmRlXHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkuZGVzZWxlY3RfYWxsKCk7XHJcblx0XHRcdFx0XHQvLyBhbGxlIHRpZWZlcmVuIEtub3RlbiDDtmZmbmVuIHVtIHp1IHplaWdlbiwgd2FzIG1pdCBnZWzDtnNjaHQgd2lyZFxyXG5cdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLm9wZW5fYWxsKGFrdGl2ZXJfbm9kZSk7XHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkuZGVzZWxlY3RfYWxsKCk7XHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkuc2VsZWN0X25vZGUoYWt0aXZlcl9ub2RlKTtcclxuXHRcdFx0XHRcdHZhciBiZXplaWNobnVuZyA9ICQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5nZXRfdGV4dChha3RpdmVyX25vZGUpO1xyXG5cdFx0XHRcdFx0JChcIiNsb2VzY2hlbl9kaWFsb2dfbWl0dGVpbHVuZ1wiKS5odG1sKFwiRGFzIEVyZm9sZ3Nrcml0ZXJpdW0gJ1wiICsgYmV6ZWljaG51bmcgKyBcIicgd2lyZCBnZWzDtnNjaHQuXCIpO1xyXG5cdFx0XHRcdFx0JChcIiNsb2VzY2hlbl9kaWFsb2dcIikuZGlhbG9nKHtcclxuXHRcdFx0XHRcdFx0cmVzaXphYmxlOiBmYWxzZSxcclxuXHRcdFx0XHRcdFx0aGVpZ2h0OidhdXRvJyxcclxuXHRcdFx0XHRcdFx0d2lkdGg6IDQwMCxcclxuXHRcdFx0XHRcdFx0bW9kYWw6IHRydWUsXHJcblx0XHRcdFx0XHRcdGJ1dHRvbnM6IHtcclxuXHRcdFx0XHRcdFx0XHRcImphLCBsw7ZzY2hlbiFcIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHQkKHRoaXMpLmRpYWxvZyhcImNsb3NlXCIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gVmFyaWFibGUgenVtIHLDvGNrZ8OkbmdpZyBtYWNoZW4gZXJzdGVsbGVuXHJcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmRlbGV0ZWQgPSB3aW5kb3cuYXBmLmVyZmtyaXQ7XHJcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmRlbGV0ZWQudHlwID0gXCJlcmZrcml0XCI7XHJcblx0XHRcdFx0XHRcdFx0XHR2YXIgZGVsZXRlRXJma3JpdCA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHR5cGU6ICdwb3N0JyxcclxuXHRcdFx0XHRcdFx0XHRcdFx0dXJsOiAncGhwL2VyZmtyaXRfZGVsZXRlLnBocCcsXHJcblx0XHRcdFx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcImlkXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJChha3RpdmVyX25vZGUpLmF0dHIoXCJpZFwiKSlcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0XHRkZWxldGVFcmZrcml0LmFsd2F5cyhmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5lcmZrcml0X2lkO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRkZWxldGUgd2luZG93LmFwZi5lcmZrcml0O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkuZGVsZXRlX25vZGUoYWt0aXZlcl9ub2RlKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gUGFyZW50IE5vZGUtQmVzY2hyaWZ0dW5nOiBBbnphaGwgYW5wYXNzZW5cclxuXHRcdFx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl9lcmZrcml0KHBhcmVudF9ub2RlKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gSGlud2VpcyB6dW0gcsO8Y2tnw6RuZ2lnIG1hY2hlbiBhbnplaWdlblxyXG5cdFx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmZyYWdlT2JBa3Rpb25Sw7xja2fDpG5naWdHZW1hY2h0V2VyZGVuU29sbChcIkRhcyBFcmZvbGdza3JpdGVyaXVtICdcIiArIGJlemVpY2hudW5nICsgXCInIHd1cmRlIGdlbMO2c2NodC5cIik7XHJcblx0XHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0XHRcdGRlbGV0ZUVyZmtyaXQuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBEYXMgRXJmb2xnc2tyaXRlcml1bSB3dXJkZSBuaWNodCBnZWzDtnNjaHRcIik7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IERhcyBFcmZvbGdza3JpdGVyaXVtIHd1cmRlIG5pY2h0IGdlbMO2c2NodCcpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0XHRcImFiYnJlY2hlblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdCQodGhpcykuZGlhbG9nKFwiY2xvc2VcIik7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcdFx0XHRcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0XHRyZXR1cm4gaXRlbXM7XHJcblx0Y2FzZSBcImFwX29yZG5lcl9qYmVyXCI6XHJcblx0XHRpdGVtcyA9IHtcclxuXHRcdFx0XCJ1bnRlcmdlb3JkbmV0ZUtub3Rlbk9lZmZuZW5cIjoge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogXCJ1bnRlcmdlb3JkbmV0ZSBLbm90ZW4gw7ZmZm5lblwiLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy90cmVlMTZ4MTYucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKG5vZGUpLm9wZW5fYWxsKG5vZGUpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSxcclxuXHRcdFx0XCJuZXVcIjoge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogXCJuZXVlciBBUC1CZXJpY2h0XCIsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL25ldS5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdHZhciBpbnNlcnRKYmVyID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvamJlcl9pbnNlcnQucGhwJyxcclxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFwiaWRcIjogd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKGFrdGl2ZXJfbm9kZSkuYXR0cihcImlkXCIpKSxcclxuXHRcdFx0XHRcdFx0XHRcInVzZXJcIjogc2Vzc2lvblN0b3JhZ2UuVXNlclxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydEpiZXIuYWx3YXlzKGZ1bmN0aW9uKGlkKSB7XHJcblx0XHRcdFx0XHRcdHZhciBzdHJ1a3R1cnR5cCA9IFwiamJlclwiLFxyXG5cdFx0XHRcdFx0XHRcdGJlc2NocmlmdHVuZyA9IFwibmV1ZXIgQVAtQmVyaWNodFwiO1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmluc2VydE5ldWVuTm9kZUVpbmVIaWVyYXJjaGllc3R1ZmVUaWVmZXIoYWt0aXZlcl9ub2RlLCBwYXJlbnRfbm9kZSwgc3RydWt0dXJ0eXAsIGlkLCBiZXNjaHJpZnR1bmcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpbnNlcnRKYmVyLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogS2VpbmVuIG5ldWVuIEFQLUJlcmljaHQgZXJzdGVsbHRcIik7XHJcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IEtlaW5lbiBuZXVlbiBBUC1CZXJpY2h0IGVyc3RlbGx0Jyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0XHRyZXR1cm4gaXRlbXM7XHJcblx0Y2FzZSBcImpiZXJcIjpcclxuXHRcdGl0ZW1zID0ge1xyXG5cdFx0XHRcIm5ldVwiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcIm5ldWVyIEFQLUJlcmljaHRcIixcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvbmV1LnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0dmFyIGluc2VydEpiZXJfMiA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHRcdHR5cGU6ICdwb3N0JyxcclxuXHRcdFx0XHRcdFx0dXJsOiAncGhwL2piZXJfaW5zZXJ0LnBocCcsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcImlkXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJChwYXJlbnRfbm9kZSkuYXR0cihcImlkXCIpKSxcclxuXHRcdFx0XHRcdFx0XHRcInR5cFwiOiBcImpiZXJcIixcclxuXHRcdFx0XHRcdFx0XHRcInVzZXJcIjogc2Vzc2lvblN0b3JhZ2UuVXNlclxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydEpiZXJfMi5hbHdheXMoZnVuY3Rpb24oaWQpIHtcclxuXHRcdFx0XHRcdFx0dmFyIHN0cnVrdHVydHlwID0gXCJqYmVyXCIsXHJcblx0XHRcdFx0XHRcdFx0YmVzY2hyaWZ0dW5nID0gXCJuZXVlciBBUC1CZXJpY2h0XCI7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuaW5zZXJ0TmV1ZW5Ob2RlQXVmR2xlaWNoZXJIaWVyYXJjaGllc3R1ZmUoYWt0aXZlcl9ub2RlLCBwYXJlbnRfbm9kZSwgc3RydWt0dXJ0eXAsIGlkLCBiZXNjaHJpZnR1bmcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpbnNlcnRKYmVyXzIuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBLZWluZW4gbmV1ZW4gQVAtQmVyaWNodCBlcnN0ZWxsdFwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogS2VpbmVuIG5ldWVuIEFQLUJlcmljaHQgZXJzdGVsbHQnKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSxcclxuXHRcdFx0XCJsb2VzY2hlblwiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcImzDtnNjaGVuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL2xvZXNjaGVuLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gbnVyIGFrdHVhbGlzaWVyZW4sIHdlbm4gU2NocmVpYnJlY2h0ZSBiZXN0ZWhlblxyXG5cdFx0XHRcdFx0aWYgKCF3aW5kb3cuYXBmLnByw7xmZVNjaHJlaWJ2b3JhdXNzZXR6dW5nZW4oKSkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHQvLyBzZWxla3RpZXJlbiwgZmFsbHMgZGlyZWt0IG1pdCBkZXIgcmVjaHRlbiBNYXVzdGFzdGUgZ2V3w6RobHQgd3VyZGVcclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5kZXNlbGVjdF9hbGwoKTtcclxuXHRcdFx0XHRcdC8vIGFsbGUgdGllZmVyZW4gS25vdGVuIMO2ZmZuZW4gdW0genUgemVpZ2VuLCB3YXMgbWl0IGdlbMO2c2NodCB3aXJkXHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkub3Blbl9hbGwoYWt0aXZlcl9ub2RlKTtcclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5kZXNlbGVjdF9hbGwoKTtcclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5zZWxlY3Rfbm9kZShha3RpdmVyX25vZGUpO1xyXG5cdFx0XHRcdFx0dmFyIGJlemVpY2hudW5nID0gJC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLmdldF90ZXh0KGFrdGl2ZXJfbm9kZSk7XHJcblx0XHRcdFx0XHQkKFwiI2xvZXNjaGVuX2RpYWxvZ19taXR0ZWlsdW5nXCIpLmh0bWwoXCJEZXIgQVAtQmVyaWNodCAnXCIgKyBiZXplaWNobnVuZyArIFwiJyB3aXJkIGdlbMO2c2NodC5cIik7XHJcblx0XHRcdFx0XHQkKFwiI2xvZXNjaGVuX2RpYWxvZ1wiKS5kaWFsb2coe1xyXG5cdFx0XHRcdFx0XHRyZXNpemFibGU6IGZhbHNlLFxyXG5cdFx0XHRcdFx0XHRoZWlnaHQ6J2F1dG8nLFxyXG5cdFx0XHRcdFx0XHR3aWR0aDogNDAwLFxyXG5cdFx0XHRcdFx0XHRtb2RhbDogdHJ1ZSxcclxuXHRcdFx0XHRcdFx0YnV0dG9uczoge1xyXG5cdFx0XHRcdFx0XHRcdFwiamEsIGzDtnNjaGVuIVwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdCQodGhpcykuZGlhbG9nKFwiY2xvc2VcIik7XHJcblx0XHRcdFx0XHRcdFx0XHQvLyBWYXJpYWJsZSB6dW0gcsO8Y2tnw6RuZ2lnIG1hY2hlbiBlcnN0ZWxsZW5cclxuXHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZGVsZXRlZCA9IHdpbmRvdy5hcGYuamJlcjtcclxuXHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZGVsZXRlZC50eXAgPSBcImpiZXJcIjtcclxuXHRcdFx0XHRcdFx0XHRcdHZhciBkZWxldGVKYmVyID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHR1cmw6ICdwaHAvamJlcl9kZWxldGUucGhwJyxcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFwiaWRcIjogd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKGFrdGl2ZXJfbm9kZSkuYXR0cihcImlkXCIpKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0XHRcdGRlbGV0ZUpiZXIuYWx3YXlzKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRkZWxldGUgbG9jYWxTdG9yYWdlLmpiZXJfaWQ7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLmpiZXI7XHJcblx0XHRcdFx0XHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5kZWxldGVfbm9kZShha3RpdmVyX25vZGUpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBQYXJlbnQgTm9kZS1CZXNjaHJpZnR1bmc6IEFuemFobCBhbnBhc3NlblxyXG5cdFx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX2piZXIocGFyZW50X25vZGUpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBIaW53ZWlzIHp1bSByw7xja2fDpG5naWcgbWFjaGVuIGFuemVpZ2VuXHJcblx0XHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZnJhZ2VPYkFrdGlvblLDvGNrZ8OkbmdpZ0dlbWFjaHRXZXJkZW5Tb2xsKFwiRGVyIEFQLUJlcmljaHQgJ1wiICsgYmV6ZWljaG51bmcgKyBcIicgd3VyZGUgZ2Vsw7ZzY2h0LlwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0ZGVsZXRlSmJlci5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IERlciBBUC1CZXJpY2h0IHd1cmRlIG5pY2h0IGdlbMO2c2NodFwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogRGVyIEFQLUJlcmljaHQgd3VyZGUgbmljaHQgZ2Vsw7ZzY2h0Jyk7XHJcblx0XHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0XHRcdFwiYWJicmVjaGVuXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0JCh0aGlzKS5kaWFsb2coXCJjbG9zZVwiKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHRcdC8vIFdlbm4gbm9jaCBrZWluZSBleGlzdGllcnQsIGthbm4gZWluZW4gbmV1ZSDDnGJlcnNpY2h0IHp1IGFsbGVuIEFydGVuIGVyc3RlbGx0IHdlcmRlblxyXG5cdFx0aWYgKCQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5fZ2V0X2NoaWxkcmVuKGFrdGl2ZXJfbm9kZSkubGVuZ3RoID09PSAwKSB7XHJcblx0XHRcdGl0ZW1zLm5ldV9qYmVyX3VlYmVyc2ljaHQgPSB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcIm5ldWUgw5xiZXJzaWNodCB6dSBhbGxlbiBBcnRlblwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9uZXUucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgaW5zZXJ0SmJlclVlYmVyc2ljaHQgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ3BocC9qYmVyX3VlYmVyc2ljaHRfaW5zZXJ0LnBocCcsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcIkpidUphaHJcIjogJC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLmdldF90ZXh0KGFrdGl2ZXJfbm9kZSksXHJcblx0XHRcdFx0XHRcdFx0XCJ1c2VyXCI6IHNlc3Npb25TdG9yYWdlLlVzZXJcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpbnNlcnRKYmVyVWViZXJzaWNodC5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRcdFx0XHR2YXIgc3RydWt0dXJ0eXAgPSBcImpiZXJfdWViZXJzaWNodFwiLFxyXG5cdFx0XHRcdFx0XHRcdGRzX2lkID0gJC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLmdldF90ZXh0KGFrdGl2ZXJfbm9kZSksXHJcblx0XHRcdFx0XHRcdFx0YmVzY2hyaWZ0dW5nID0gXCJuZXVlIMOcYmVyc2ljaHQgenUgYWxsZW4gQXJ0ZW5cIjtcclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi5pbnNlcnROZXVlbk5vZGVFaW5lSGllcmFyY2hpZXN0dWZlVGllZmVyKGFrdGl2ZXJfbm9kZSwgcGFyZW50X25vZGUsIHN0cnVrdHVydHlwLCBkc19pZCwgYmVzY2hyaWZ0dW5nKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aW5zZXJ0SmJlclVlYmVyc2ljaHQuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBLZWluZSDDnGJlcnNpY2h0IHp1IGFsbGVuIEFydGVuIGVyc3RlbGx0XCIpO1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBLZWluZSDDnGJlcnNpY2h0IHp1IGFsbGVuIEFydGVuIGVyc3RlbGx0Jyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiBpdGVtcztcclxuXHRjYXNlIFwiamJlcl91ZWJlcnNpY2h0XCI6XHJcblx0XHRpdGVtcyA9IHtcclxuXHRcdFx0XCJsb2VzY2hlblwiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcImzDtnNjaGUgw5xiZXJzaWNodCB6dSBhbGxlbiBBcnRlblwiLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9sb2VzY2hlbi5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdC8vIG51ciBha3R1YWxpc2llcmVuLCB3ZW5uIFNjaHJlaWJyZWNodGUgYmVzdGVoZW5cclxuXHRcdFx0XHRcdGlmICghd2luZG93LmFwZi5wcsO8ZmVTY2hyZWlidm9yYXVzc2V0enVuZ2VuKCkpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0Ly8gc2VsZWt0aWVyZW4sIGZhbGxzIGRpcmVrdCBtaXQgZGVyIHJlY2h0ZW4gTWF1c3Rhc3RlIGdld8OkaGx0IHd1cmRlXHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkuZGVzZWxlY3RfYWxsKCk7XHJcblx0XHRcdFx0XHQvLyBhbGxlIHRpZWZlcmVuIEtub3RlbiDDtmZmbmVuIHVtIHp1IHplaWdlbiwgd2FzIG1pdCBnZWzDtnNjaHQgd2lyZFxyXG5cdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLm9wZW5fYWxsKGFrdGl2ZXJfbm9kZSk7XHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkuZGVzZWxlY3RfYWxsKCk7XHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkuc2VsZWN0X25vZGUoYWt0aXZlcl9ub2RlKTtcclxuXHRcdFx0XHRcdCQoXCIjbG9lc2NoZW5fZGlhbG9nX21pdHRlaWx1bmdcIikuaHRtbChcIkRpZSDDnGJlcnNpY2h0IHp1IGFsbGVuIEFydGVuIHdpcmQgZ2Vsw7ZzY2h0XCIpO1xyXG5cdFx0XHRcdFx0JChcIiNsb2VzY2hlbl9kaWFsb2dcIikuZGlhbG9nKHtcclxuXHRcdFx0XHRcdFx0cmVzaXphYmxlOiBmYWxzZSxcclxuXHRcdFx0XHRcdFx0aGVpZ2h0OidhdXRvJyxcclxuXHRcdFx0XHRcdFx0d2lkdGg6IDQwMCxcclxuXHRcdFx0XHRcdFx0bW9kYWw6IHRydWUsXHJcblx0XHRcdFx0XHRcdGJ1dHRvbnM6IHtcclxuXHRcdFx0XHRcdFx0XHRcImphLCBsw7ZzY2hlbiFcIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHQkKHRoaXMpLmRpYWxvZyhcImNsb3NlXCIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gVmFyaWFibGUgenVtIHLDvGNrZ8OkbmdpZyBtYWNoZW4gZXJzdGVsbGVuXHJcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmRlbGV0ZWQgPSB3aW5kb3cuYXBmLmpiZXJfw7xiZXJzaWNodDtcclxuXHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZGVsZXRlZC50eXAgPSBcImpiZXJfdWViZXJzaWNodFwiO1xyXG5cdFx0XHRcdFx0XHRcdFx0dmFyIGRlbGV0ZUpiZXJVZWJlcnNpY2h0ID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHR1cmw6ICdwaHAvamJlcl91ZWJlcnNpY2h0X2RlbGV0ZS5waHAnLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XCJqYWhyXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJChha3RpdmVyX25vZGUpLmF0dHIoXCJpZFwiKSlcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0XHRkZWxldGVKYmVyVWViZXJzaWNodC5hbHdheXMoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGRlbGV0ZSBsb2NhbFN0b3JhZ2UuamJlcl91ZWJlcnNpY2h0X2lkO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRkZWxldGUgd2luZG93LmFwZi5qYmVyX8O8YmVyc2ljaHQ7XHJcblx0XHRcdFx0XHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5kZWxldGVfbm9kZShha3RpdmVyX25vZGUpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBIaW53ZWlzIHp1bSByw7xja2fDpG5naWcgbWFjaGVuIGFuemVpZ2VuXHJcblx0XHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZnJhZ2VPYkFrdGlvblLDvGNrZ8OkbmdpZ0dlbWFjaHRXZXJkZW5Tb2xsKFwiRGllIMOcYmVyc2ljaHQgZsO8ciBkZW4gQVAtQmVyaWNodCBkZXMgSmFocnMgXFxcIlwiICsgd2luZG93LmFwZi5kZWxldGVkLkpidUphaHIgKyBcIlxcXCIgd3VyZGUgZ2Vsw7ZzY2h0LlwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0ZGVsZXRlSmJlclVlYmVyc2ljaHQuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBEaWUgw5xiZXJzaWNodCB6dSBhbGxlbiBBcnRlbiB3dXJkZSBuaWNodCBnZWzDtnNjaHRcIik7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IERpZSDDnGJlcnNpY2h0IHp1IGFsbGVuIEFydGVuIHd1cmRlIG5pY2h0IGdlbMO2c2NodCcpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0XHRcImFiYnJlY2hlblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdCQodGhpcykuZGlhbG9nKFwiY2xvc2VcIik7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcdFx0XHRcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0XHRyZXR1cm4gaXRlbXM7XHJcblx0Y2FzZSBcImFwX29yZG5lcl9iZXJcIjpcclxuXHRcdGl0ZW1zID0ge1xyXG5cdFx0XHRcIm5ldVwiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcIm5ldWVyIEJlcmljaHRcIixcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvbmV1LnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0dmFyIGluc2VydEJlciA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHRcdHR5cGU6ICdwb3N0JyxcclxuXHRcdFx0XHRcdFx0dXJsOiAncGhwL2Jlcl9pbnNlcnQucGhwJyxcclxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFwiaWRcIjogd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKGFrdGl2ZXJfbm9kZSkuYXR0cihcImlkXCIpKSxcclxuXHRcdFx0XHRcdFx0XHRcInVzZXJcIjogc2Vzc2lvblN0b3JhZ2UuVXNlclxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydEJlci5hbHdheXMoZnVuY3Rpb24oaWQpIHtcclxuXHRcdFx0XHRcdFx0dmFyIHN0cnVrdHVydHlwID0gXCJiZXJcIixcclxuXHRcdFx0XHRcdFx0XHRiZXNjaHJpZnR1bmcgPSBcIm5ldWVyIEJlcmljaHRcIjtcclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi5pbnNlcnROZXVlbk5vZGVFaW5lSGllcmFyY2hpZXN0dWZlVGllZmVyKGFrdGl2ZXJfbm9kZSwgcGFyZW50X25vZGUsIHN0cnVrdHVydHlwLCBpZCwgYmVzY2hyaWZ0dW5nKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aW5zZXJ0QmVyLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogS2VpbmVuIG5ldWVuIEJlcmljaHQgZXJzdGVsbHRcIik7XHJcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IEtlaW5lbiBuZXVlbiBCZXJpY2h0IGVyc3RlbGx0Jyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0XHRyZXR1cm4gaXRlbXM7XHJcblx0Y2FzZSBcImJlclwiOlxyXG5cdFx0aXRlbXMgPSB7XHJcblx0XHRcdFwibmV1XCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwiTmV1ZXIgQmVyaWNodFwiLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9uZXUucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgaW5zZXJ0QmVyXzIgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ3BocC9iZXJfaW5zZXJ0LnBocCcsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcImlkXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJChwYXJlbnRfbm9kZSkuYXR0cihcImlkXCIpKSxcclxuXHRcdFx0XHRcdFx0XHRcInR5cFwiOiBcImJlclwiLFxyXG5cdFx0XHRcdFx0XHRcdFwidXNlclwiOiBzZXNzaW9uU3RvcmFnZS5Vc2VyXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aW5zZXJ0QmVyXzIuYWx3YXlzKGZ1bmN0aW9uKGlkKSB7XHJcblx0XHRcdFx0XHRcdHZhciBzdHJ1a3R1cnR5cCA9IFwiYmVyXCIsXHJcblx0XHRcdFx0XHRcdFx0YmVzY2hyaWZ0dW5nID0gXCJuZXVlciBCZXJpY2h0XCI7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuaW5zZXJ0TmV1ZW5Ob2RlQXVmR2xlaWNoZXJIaWVyYXJjaGllc3R1ZmUoYWt0aXZlcl9ub2RlLCBwYXJlbnRfbm9kZSwgc3RydWt0dXJ0eXAsIGlkLCBiZXNjaHJpZnR1bmcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpbnNlcnRCZXJfMi5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IEtlaW5lbiBuZXVlbiBCZXJpY2h0IGVyc3RlbGx0XCIpO1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBLZWluZW4gbmV1ZW4gQmVyaWNodCBlcnN0ZWxsdCcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LFxyXG5cdFx0XHRcImxvZXNjaGVuXCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwibMO2c2NoZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvbG9lc2NoZW4ucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQvLyBudXIgYWt0dWFsaXNpZXJlbiwgd2VubiBTY2hyZWlicmVjaHRlIGJlc3RlaGVuXHJcblx0XHRcdFx0XHRpZiAoIXdpbmRvdy5hcGYucHLDvGZlU2NocmVpYnZvcmF1c3NldHp1bmdlbigpKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdC8vIHNlbGVrdGllcmVuLCBmYWxscyBkaXJla3QgbWl0IGRlciByZWNodGVuIE1hdXN0YXN0ZSBnZXfDpGhsdCB3dXJkZVxyXG5cdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLmRlc2VsZWN0X2FsbCgpO1xyXG5cdFx0XHRcdFx0Ly8gYWxsZSB0aWVmZXJlbiBLbm90ZW4gw7ZmZm5lbiB1bSB6dSB6ZWlnZW4sIHdhcyBtaXQgZ2Vsw7ZzY2h0IHdpcmRcclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5vcGVuX2FsbChha3RpdmVyX25vZGUpO1xyXG5cdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLmRlc2VsZWN0X2FsbCgpO1xyXG5cdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLnNlbGVjdF9ub2RlKGFrdGl2ZXJfbm9kZSk7XHJcblx0XHRcdFx0XHR2YXIgYmV6ZWljaG51bmcgPSAkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkuZ2V0X3RleHQoYWt0aXZlcl9ub2RlKTtcclxuXHRcdFx0XHRcdCQoXCIjbG9lc2NoZW5fZGlhbG9nX21pdHRlaWx1bmdcIikuaHRtbChcIkRlciBCZXJpY2h0ICdcIiArIGJlemVpY2hudW5nICsgXCInIHdpcmQgZ2Vsw7ZzY2h0LlwiKTtcclxuXHRcdFx0XHRcdCQoXCIjbG9lc2NoZW5fZGlhbG9nXCIpLmRpYWxvZyh7XHJcblx0XHRcdFx0XHRcdHJlc2l6YWJsZTogZmFsc2UsXHJcblx0XHRcdFx0XHRcdGhlaWdodDonYXV0bycsXHJcblx0XHRcdFx0XHRcdHdpZHRoOiA0MDAsXHJcblx0XHRcdFx0XHRcdG1vZGFsOiB0cnVlLFxyXG5cdFx0XHRcdFx0XHRidXR0b25zOiB7XHJcblx0XHRcdFx0XHRcdFx0XCJqYSwgbMO2c2NoZW4hXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0JCh0aGlzKS5kaWFsb2coXCJjbG9zZVwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIFZhcmlhYmxlIHp1bSByw7xja2fDpG5naWcgbWFjaGVuIGVyc3RlbGxlblxyXG5cdFx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5kZWxldGVkID0gd2luZG93LmFwZi5iZXI7XHJcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmRlbGV0ZWQudHlwID0gXCJiZXJcIjtcclxuXHRcdFx0XHRcdFx0XHRcdHZhciBkZWxldGVCZXIgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHRcdFx0XHRcdFx0XHRcdHVybDogJ3BocC9iZXJfZGVsZXRlLnBocCcsXHJcblx0XHRcdFx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcImlkXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJChha3RpdmVyX25vZGUpLmF0dHIoXCJpZFwiKSlcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0XHRkZWxldGVCZXIuYWx3YXlzKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRkZWxldGUgbG9jYWxTdG9yYWdlLmJlcl9pZDtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYuYmVyO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkuZGVsZXRlX25vZGUoYWt0aXZlcl9ub2RlKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gUGFyZW50IE5vZGUtQmVzY2hyaWZ0dW5nOiBBbnphaGwgYW5wYXNzZW5cclxuXHRcdFx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl9iZXIocGFyZW50X25vZGUpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBIaW53ZWlzIHp1bSByw7xja2fDpG5naWcgbWFjaGVuIGFuemVpZ2VuXHJcblx0XHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZnJhZ2VPYkFrdGlvblLDvGNrZ8OkbmdpZ0dlbWFjaHRXZXJkZW5Tb2xsKFwiRGVyIEJlcmljaHQgJ1wiICsgYmV6ZWljaG51bmcgKyBcIicgd3VyZGUgZ2Vsw7ZzY2h0LlwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0ZGVsZXRlQmVyLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogRGVyIEJlcmljaHQgd3VyZGUgbmljaHQgZ2Vsw7ZzY2h0XCIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBEZXIgQmVyaWNodCB3dXJkZSBuaWNodCBnZWzDtnNjaHQnKTtcclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdFx0XCJhYmJyZWNoZW5cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHQkKHRoaXMpLmRpYWxvZyhcImNsb3NlXCIpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHRcdFx0XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cdFx0cmV0dXJuIGl0ZW1zO1xyXG5cdGNhc2UgXCJhcF9vcmRuZXJfYXNzb3phcnRlblwiOlxyXG5cdFx0aXRlbXMgPSB7XHJcblx0XHRcdFwibmV1XCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwibmV1ZSBhc3NvemlpZXJ0ZSBBcnRcIixcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvbmV1LnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0dmFyIGluc2VydEFzc296YXJ0ZW4gPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ2FwaS9hcD0nICsgd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKGFrdGl2ZXJfbm9kZSkuYXR0cihcImlkXCIpKSArICcvYXNzb3phcnQtbmV1L3VzZXI9JyArIHNlc3Npb25TdG9yYWdlLlVzZXIsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbidcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aW5zZXJ0QXNzb3phcnRlbi5hbHdheXMoZnVuY3Rpb24oaWQpIHtcclxuXHRcdFx0XHRcdFx0dmFyIHN0cnVrdHVydHlwID0gXCJhc3NvemFydGVuXCIsXHJcblx0XHRcdFx0XHRcdFx0YmVzY2hyaWZ0dW5nID0gXCJuZXVlIGFzc296aWllcnRlIEFydFwiO1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmluc2VydE5ldWVuTm9kZUVpbmVIaWVyYXJjaGllc3R1ZmVUaWVmZXIoYWt0aXZlcl9ub2RlLCBwYXJlbnRfbm9kZSwgc3RydWt0dXJ0eXAsIGlkLCBiZXNjaHJpZnR1bmcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpbnNlcnRBc3NvemFydGVuLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjoga2VpbmUgYXNzb3ppaWVydGUgQXJ0IGVyc3RlbGx0XCIpO1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBrZWluZSBhc3NvemlpZXJ0ZSBBcnQgZXJzdGVsbHQnKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHRcdHJldHVybiBpdGVtcztcclxuXHRjYXNlIFwiYXNzb3phcnRlblwiOlxyXG5cdFx0aXRlbXMgPSB7XHJcblx0XHRcdFwibmV1XCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwibmV1ZSBhc3NvemlpZXJ0ZSBBcnRcIixcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvbmV1LnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0dmFyIGluc2VydEFzc296YXJ0ZW5fMiA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHRcdHR5cGU6ICdwb3N0JyxcclxuXHRcdFx0XHRcdFx0dXJsOiAnYXBpL2FwPScgKyB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQocGFyZW50X25vZGUpLmF0dHIoXCJpZFwiKSkgKyAnL2Fzc296YXJ0LW5ldS91c2VyPScgKyBzZXNzaW9uU3RvcmFnZS5Vc2VyLFxyXG5cdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nXHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydEFzc296YXJ0ZW5fMi5hbHdheXMoZnVuY3Rpb24oaWQpIHtcclxuXHRcdFx0XHRcdFx0dmFyIHN0cnVrdHVydHlwID0gXCJhc3NvemFydGVuXCIsXHJcblx0XHRcdFx0XHRcdFx0YmVzY2hyaWZ0dW5nID0gXCJuZXVlIGFzc296aWllcnRlIEFydFwiO1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmluc2VydE5ldWVuTm9kZUF1ZkdsZWljaGVySGllcmFyY2hpZXN0dWZlKGFrdGl2ZXJfbm9kZSwgcGFyZW50X25vZGUsIHN0cnVrdHVydHlwLCBpZCwgYmVzY2hyaWZ0dW5nKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aW5zZXJ0QXNzb3phcnRlbl8yLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogS2VpbmUgYXNzb3ppaWVydGUgQXJ0IGVyc3RlbGx0XCIpO1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBLZWluZSBhc3NvemlpZXJ0ZSBBcnQgZXJzdGVsbHQnKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSxcclxuXHRcdFx0XCJsb2VzY2hlblwiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcImzDtnNjaGVuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL2xvZXNjaGVuLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gbnVyIGFrdHVhbGlzaWVyZW4sIHdlbm4gU2NocmVpYnJlY2h0ZSBiZXN0ZWhlblxyXG5cdFx0XHRcdFx0aWYgKCF3aW5kb3cuYXBmLnByw7xmZVNjaHJlaWJ2b3JhdXNzZXR6dW5nZW4oKSkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHQvLyBzZWxla3RpZXJlbiwgZmFsbHMgZGlyZWt0IG1pdCBkZXIgcmVjaHRlbiBNYXVzdGFzdGUgZ2V3w6RobHQgd3VyZGVcclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5kZXNlbGVjdF9hbGwoKTtcclxuXHRcdFx0XHRcdC8vIGFsbGUgdGllZmVyZW4gS25vdGVuIMO2ZmZuZW4gdW0genUgemVpZ2VuLCB3YXMgbWl0IGdlbMO2c2NodCB3aXJkXHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkub3Blbl9hbGwoYWt0aXZlcl9ub2RlKTtcclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5kZXNlbGVjdF9hbGwoKTtcclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5zZWxlY3Rfbm9kZShha3RpdmVyX25vZGUpO1xyXG5cdFx0XHRcdFx0dmFyIGJlemVpY2hudW5nID0gJC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLmdldF90ZXh0KGFrdGl2ZXJfbm9kZSk7XHJcblx0XHRcdFx0XHQkKFwiI2xvZXNjaGVuX2RpYWxvZ19taXR0ZWlsdW5nXCIpLmh0bWwoXCJEaWUgYXNzb3ppaWVydGUgQXJ0ICdcIiArIGJlemVpY2hudW5nICsgXCInIHdpcmQgZ2Vsw7ZzY2h0LlwiKTtcclxuXHRcdFx0XHRcdCQoXCIjbG9lc2NoZW5fZGlhbG9nXCIpLmRpYWxvZyh7XHJcblx0XHRcdFx0XHRcdHJlc2l6YWJsZTogZmFsc2UsXHJcblx0XHRcdFx0XHRcdGhlaWdodDonYXV0bycsXHJcblx0XHRcdFx0XHRcdHdpZHRoOiA0MDAsXHJcblx0XHRcdFx0XHRcdG1vZGFsOiB0cnVlLFxyXG5cdFx0XHRcdFx0XHRidXR0b25zOiB7XHJcblx0XHRcdFx0XHRcdFx0XCJqYSwgbMO2c2NoZW4hXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0JCh0aGlzKS5kaWFsb2coXCJjbG9zZVwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIFZhcmlhYmxlIHp1bSByw7xja2fDpG5naWcgbWFjaGVuIGVyc3RlbGxlblxyXG5cdFx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5kZWxldGVkID0gd2luZG93LmFwZi5hc3NvemFydGVuO1xyXG5cdFx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5kZWxldGVkLnR5cCA9IFwiYXNzb3phcnRlblwiO1xyXG5cdFx0XHRcdFx0XHRcdFx0dmFyIGRlbGV0ZUFzc296YXJ0ZW4gPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHRcdFx0XHRcdFx0XHRcdHVybDogJ3BocC9hc3NvemFydGVuX2RlbGV0ZS5waHAnLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XCJpZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwiaWRcIikpXHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0ZGVsZXRlQXNzb3phcnRlbi5hbHdheXMoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGRlbGV0ZSBsb2NhbFN0b3JhZ2UuYXNzb3phcnRlbl9pZDtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYuYXNzb3phcnRlbjtcclxuXHRcdFx0XHRcdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLmRlbGV0ZV9ub2RlKGFrdGl2ZXJfbm9kZSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vIFBhcmVudCBOb2RlLUJlc2NocmlmdHVuZzogQW56YWhsIGFucGFzc2VuXHJcblx0XHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuYmVzY2hyaWZ0ZV9vcmRuZXJfYXNzb3phcnRlbihwYXJlbnRfbm9kZSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vIEhpbndlaXMgenVtIHLDvGNrZ8OkbmdpZyBtYWNoZW4gYW56ZWlnZW5cclxuXHRcdFx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5mcmFnZU9iQWt0aW9uUsO8Y2tnw6RuZ2lnR2VtYWNodFdlcmRlblNvbGwoXCJEaWUgYXNzb3ppaWVydGUgQXJ0ICdcIiArIGJlemVpY2hudW5nICsgXCInIHd1cmRlIGdlbMO2c2NodC5cIik7XHJcblx0XHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0XHRcdGRlbGV0ZUFzc296YXJ0ZW4uZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBEaWUgYXNzb3ppaWVydGUgQXJ0IHd1cmRlIG5pY2h0IGdlbMO2c2NodFwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogRGllIGFzc296aWllcnRlIEFydCB3dXJkZSBuaWNodCBnZWzDtnNjaHQnKTtcclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdFx0XCJhYmJyZWNoZW5cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHQkKHRoaXMpLmRpYWxvZyhcImNsb3NlXCIpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHRcdFx0XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cdFx0cmV0dXJuIGl0ZW1zO1xyXG5cdGNhc2UgXCJwb3BcIjpcclxuXHRcdGl0ZW1zID0ge1xyXG5cdFx0XHRcIm5ldVwiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcIm5ldWUgUG9wdWxhdGlvblwiLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9uZXUucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgaW5zZXJ0UG9wXzIgPSAkLmFqYXgoIHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvcG9wX2luc2VydC5waHAnLFxyXG5cdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFx0XCJpZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQocGFyZW50X25vZGUpLmF0dHIoXCJpZFwiKSksXHJcblx0XHRcdFx0XHRcdFx0XCJ0eXBcIjogXCJwb3BcIixcclxuXHRcdFx0XHRcdFx0XHRcInVzZXJcIjogc2Vzc2lvblN0b3JhZ2UuVXNlclxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydFBvcF8yLmFsd2F5cyhmdW5jdGlvbihpZCkge1xyXG5cdFx0XHRcdFx0XHR2YXIgc3RydWt0dXJ0eXAgPSBcInBvcFwiLFxyXG5cdFx0XHRcdFx0XHRcdGJlc2NocmlmdHVuZyA9IFwibmV1ZSBQb3B1bGF0aW9uXCI7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuaW5zZXJ0TmV1ZW5Ob2RlQXVmR2xlaWNoZXJIaWVyYXJjaGllc3R1ZmUoYWt0aXZlcl9ub2RlLCBwYXJlbnRfbm9kZSwgc3RydWt0dXJ0eXAsIGlkLCBiZXNjaHJpZnR1bmcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpbnNlcnRQb3BfMi5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IEtlaW5lIG5ldWUgUG9wdWxhdGlvbiBlcnN0ZWxsdFwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogS2VpbmUgbmV1ZSBQb3B1bGF0aW9uIGVyc3RlbGx0Jyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sXHJcblx0XHRcdFwibG9lc2NoZW5cIjoge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogXCJsw7ZzY2hlblwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9sb2VzY2hlbi5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdC8vIG51ciBha3R1YWxpc2llcmVuLCB3ZW5uIFNjaHJlaWJyZWNodGUgYmVzdGVoZW5cclxuXHRcdFx0XHRcdGlmICghd2luZG93LmFwZi5wcsO8ZmVTY2hyZWlidm9yYXVzc2V0enVuZ2VuKCkpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0Ly8gc2VsZWt0aWVyZW4sIGZhbGxzIGRpcmVrdCBtaXQgZGVyIHJlY2h0ZW4gTWF1c3Rhc3RlIGdld8OkaGx0IHd1cmRlXHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkuZGVzZWxlY3RfYWxsKCk7XHJcblx0XHRcdFx0XHQvLyBhbGxlIHRpZWZlcmVuIEtub3RlbiDDtmZmbmVuIHVtIHp1IHplaWdlbiwgd2FzIG1pdCBnZWzDtnNjaHQgd2lyZFxyXG5cdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLm9wZW5fYWxsKGFrdGl2ZXJfbm9kZSk7XHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkuZGVzZWxlY3RfYWxsKCk7XHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkuc2VsZWN0X25vZGUoYWt0aXZlcl9ub2RlKTtcclxuXHRcdFx0XHRcdHZhciBiZXplaWNobnVuZyA9ICQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5nZXRfdGV4dChha3RpdmVyX25vZGUpO1xyXG5cdFx0XHRcdFx0JChcIiNsb2VzY2hlbl9kaWFsb2dfbWl0dGVpbHVuZ1wiKS5odG1sKFwiRGllIFBvcHVsYXRpb24gJ1wiICsgYmV6ZWljaG51bmcgKyBcIicgd2lyZCBnZWzDtnNjaHQuXCIpO1xyXG5cdFx0XHRcdFx0JChcIiNsb2VzY2hlbl9kaWFsb2dcIikuZGlhbG9nKHtcclxuXHRcdFx0XHRcdFx0cmVzaXphYmxlOiBmYWxzZSxcclxuXHRcdFx0XHRcdFx0aGVpZ2h0OidhdXRvJyxcclxuXHRcdFx0XHRcdFx0d2lkdGg6IDQwMCxcclxuXHRcdFx0XHRcdFx0bW9kYWw6IHRydWUsXHJcblx0XHRcdFx0XHRcdGJ1dHRvbnM6IHtcclxuXHRcdFx0XHRcdFx0XHRcImphLCBsw7ZzY2hlbiFcIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHQkKHRoaXMpLmRpYWxvZyhcImNsb3NlXCIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gVmFyaWFibGUgenVtIHLDvGNrZ8OkbmdpZyBtYWNoZW4gZXJzdGVsbGVuXHJcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmRlbGV0ZWQgPSB3aW5kb3cuYXBmLnBvcDtcclxuXHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZGVsZXRlZC50eXAgPSBcInBvcFwiO1xyXG5cdFx0XHRcdFx0XHRcdFx0dmFyIGRlbGV0ZVBvcCA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHR5cGU6ICdwb3N0JyxcclxuXHRcdFx0XHRcdFx0XHRcdFx0dXJsOiAncGhwL3BvcF9kZWxldGUucGhwJyxcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFwiaWRcIjogd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKGFrdGl2ZXJfbm9kZSkuYXR0cihcImlkXCIpKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0XHRcdGRlbGV0ZVBvcC5hbHdheXMoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGRlbGV0ZSBsb2NhbFN0b3JhZ2UucG9wX2lkO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRkZWxldGUgd2luZG93LmFwZi5wb3A7XHJcblx0XHRcdFx0XHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5kZWxldGVfbm9kZShha3RpdmVyX25vZGUpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBQYXJlbnQgTm9kZS1CZXNjaHJpZnR1bmc6IEFuemFobCBhbnBhc3NlblxyXG5cdFx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX3BvcChwYXJlbnRfbm9kZSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vIEhpbndlaXMgenVtIHLDvGNrZ8OkbmdpZyBtYWNoZW4gYW56ZWlnZW5cclxuXHRcdFx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5mcmFnZU9iQWt0aW9uUsO8Y2tnw6RuZ2lnR2VtYWNodFdlcmRlblNvbGwoXCJQb3B1bGF0aW9uICdcIiArIGJlemVpY2hudW5nICsgXCInIHd1cmRlIGdlbMO2c2NodC5cIik7XHJcblx0XHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0XHRcdGRlbGV0ZVBvcC5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IERpZSBQb3B1bGF0aW9uIHd1cmRlIG5pY2h0IGdlbMO2c2NodFwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogRGllIFBvcHVsYXRpb24gd3VyZGUgbmljaHQgZ2Vsw7ZzY2h0Jyk7XHJcblx0XHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0XHRcdFwiYWJicmVjaGVuXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0JCh0aGlzKS5kaWFsb2coXCJjbG9zZVwiKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSxcclxuXHRcdFx0XCJHZW9BZG1pbk1hcHNcIjoge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogXCJhdWYgQ0gtS2FydGVuIHplaWdlblwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9mbG9yYV9pY29uX2dlbGIucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgZ2V0UG9wQ2hLYXJ0ZV8yID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ2dldCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ3BocC9wb3BfY2hfa2FydGUucGhwJyxcclxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFwicG9wX2lkXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJChha3RpdmVyX25vZGUpLmF0dHIoXCJpZFwiKSlcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRnZXRQb3BDaEthcnRlXzIuYWx3YXlzKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHRcdFx0aWYgKGRhdGEucm93cy5sZW5ndGggPiAwKSB7XHJcblx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi56ZWlnZVBvcEF1Zk9sbWFwKGRhdGEpO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYubWVsZGUoXCJEaWUgUG9wdWxhdGlvbiBoYXQga2VpbmUgS29vcmRpbmF0ZW5cIiwgXCJBa3Rpb24gYWJnZWJyb2NoZW5cIik7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Z2V0UG9wQ2hLYXJ0ZV8yLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogS2VpbmUgUG9wdWxhdGlvbmVuIGVyaGFsdGVuXCIpO1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBLZWluZSBQb3B1bGF0aW9uZW4gZXJoYWx0ZW4nKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSxcclxuXHRcdFx0XCJHb29nbGVNYXBzXCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwiYXVmIEdvb2dsZS1LYXJ0ZW4gemVpZ2VuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL2Zsb3JhX2ljb24ucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgZ2V0UG9wS2FydGUgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHR0eXBlOiAnZ2V0JyxcclxuXHRcdFx0XHRcdFx0dXJsOiAncGhwL3BvcF9rYXJ0ZS5waHAnLFxyXG5cdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFx0XCJpZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwiaWRcIikpXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Z2V0UG9wS2FydGUuYWx3YXlzKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHRcdFx0aWYgKGRhdGEucm93cy5sZW5ndGggPiAwKSB7XHJcblx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5nbWFwLnplaWdlVFBvcChkYXRhKTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLm1lbGRlKFwiRXMgZ2lidCBrZWluZSBUZWlscG9wdWxhdGlvbiBtaXQgS29vcmRpbmF0ZW5cIiwgXCJBa3Rpb24gYWJnZWJyb2NoZW5cIik7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Z2V0UG9wS2FydGUuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBLZWluZSBUZWlscG9wdWxhdGlvbmVuIGVyaGFsdGVuXCIpO1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBLZWluZSBUZWlscG9wdWxhdGlvbmVuIGVyaGFsdGVuJyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0XHRpZiAoIXdpbmRvdy5hcGYucG9wX3p1bV92ZXJzY2hpZWJlbl9nZW1lcmt0KSB7XHJcblx0XHRcdGl0ZW1zLmF1c3NjaG5laWRlbiA9IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwienVtIFZlcnNjaGllYmVuIG1lcmtlblwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9hdXNzY2huZWlkZW4ucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQvLyBudXIgYWt0dWFsaXNpZXJlbiwgd2VubiBTY2hyZWlicmVjaHRlIGJlc3RlaGVuXHJcblx0XHRcdFx0XHRpZiAoIXdpbmRvdy5hcGYucHLDvGZlU2NocmVpYnZvcmF1c3NldHp1bmdlbigpKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdC8vIEpldHp0IGRpZSBQb3BJZCBtZXJrZW4gLSBpaHIgbXVzcyBkYW5hY2ggZWluZSBhbmRlcmUgQXBBcnRJZCB6dWdldGVpbHQgd2VyZGVuXHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLnBvcF9pZCA9IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJChha3RpdmVyX25vZGUpLmF0dHIoXCJpZFwiKSk7XHJcblx0XHRcdFx0XHQvLyBtZXJrZW4sIGRhc3MgZWluIG5vZGUgYXVzZ2VzY2huaXR0ZW4gd3VyZGVcclxuXHRcdFx0XHRcdHdpbmRvdy5hcGYucG9wX3p1bV92ZXJzY2hpZWJlbl9nZW1lcmt0ID0gdHJ1ZTtcclxuXHRcdFx0XHRcdC8vIHVuZCB3aWUgZXIgaGVpc3N0ICh1bSBlcyBzcMOkdGVyIGltIEtvbnRleHRtZW7DvCBhbnp1emVpZ2VuKVxyXG5cdFx0XHRcdFx0d2luZG93LmFwZi5wb3BfYmV6ZWljaG51bmcgPSAkKFwiI1BvcE5yXCIpLnZhbCgpICsgXCIgXCIgKyAkKFwiI1BvcE5hbWVcIikudmFsKCk7XHJcblxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0aWYgKHdpbmRvdy5hcGYucG9wX3p1bV92ZXJzY2hpZWJlbl9nZW1lcmt0KSB7XHJcblx0XHRcdGl0ZW1zLmVpbmZ1ZWdlbiA9IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwiJ1wiICsgd2luZG93LmFwZi5wb3BfYmV6ZWljaG51bmcgKyBcIicgZWluZsO8Z2VuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL2VpbmZ1ZWdlbi5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdHZhciBwb3BpZCA9IHdpbmRvdy5hcGYucG9wX2lkO1xyXG5cdFx0XHRcdFx0dmFyIGFwYXJ0aWQgPSB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQocGFyZW50X25vZGUpLmF0dHIoXCJpZFwiKSk7XHJcblx0XHRcdFx0XHQvLyBkYiBha3R1YWxpc2llcmVuXHJcblx0XHRcdFx0XHR2YXIgdXBkYXRlUG9wXzIgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ3BocC9wb3BfdXBkYXRlLnBocCcsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcImlkXCI6IHBvcGlkLFxyXG5cdFx0XHRcdFx0XHRcdFwiRmVsZFwiOiBcIkFwQXJ0SWRcIixcclxuXHRcdFx0XHRcdFx0XHRcIldlcnRcIjogYXBhcnRpZCxcclxuXHRcdFx0XHRcdFx0XHRcInVzZXJcIjogc2Vzc2lvblN0b3JhZ2UuVXNlclxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdHVwZGF0ZVBvcF8yLmFsd2F5cyhmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0Ly8gQmF1bSB3aWVkZXIgYXVmYmF1ZW5cclxuXHRcdFx0XHRcdFx0JC53aGVuKHdpbmRvdy5hcGYuZXJzdGVsbGVfdHJlZShhcGFydGlkKSlcclxuXHRcdFx0XHRcdFx0XHQudGhlbihmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIGRhbm4gZGVuIGVpbmdlZsO8Z3RlbiBOb2RlIHfDpGhsZW5cclxuXHRcdFx0XHRcdFx0XHRcdCQoXCIjdHJlZVwiKS5qc3RyZWUoXCJzZWxlY3Rfbm9kZVwiLCBcIlt0eXA9J3BvcCddI1wiICsgcG9waWQpOyBcclxuXHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0Ly8gZWluZsO8Z2VuIHNvbGwgbmljaHQgbWVociBhbmdlemVpZ3Qgd2VyZGVuXHJcblx0XHRcdFx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLnBvcF96dW1fdmVyc2NoaWViZW5fZ2VtZXJrdDtcclxuXHRcdFx0XHRcdFx0Ly8gbmljaHQgbWVociBiZW7DtnRpZ3RlIFZhcmlhYmxlbiBlbnRmZXJuZW5cclxuXHRcdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYucG9wX2JlemVpY2hudW5nO1xyXG5cdFx0XHRcdFx0XHRkZWxldGUgd2luZG93LmFwZi5wb3BfaWQ7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdHVwZGF0ZVBvcF8yLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogRGllIFBvcHVsYXRpb24gd3VyZGUgbmljaHQgdmVyc2Nob2JlblwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogRGllIFBvcHVsYXRpb24gd3VyZGUgbmljaHQgdmVyc2Nob2JlbicpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gaXRlbXM7XHJcblx0Y2FzZSBcInBvcF9vcmRuZXJfdHBvcFwiOlxyXG5cdFx0aXRlbXMgPSB7XHJcblx0XHRcdFwidW50ZXJnZW9yZG5ldGVLbm90ZW5PZWZmbmVuXCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwidW50ZXJnZW9yZG5ldGUgS25vdGVuIMO2ZmZuZW5cIixcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvdHJlZTE2eDE2LnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShub2RlKS5vcGVuX2FsbChub2RlKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sXHJcblx0XHRcdFwibmV1XCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwibmV1ZSBUZWlscG9wdWxhdGlvblwiLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9uZXUucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgaW5zZXJ0VFBvcCA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHRcdHR5cGU6ICdwb3N0JyxcclxuXHRcdFx0XHRcdFx0dXJsOiAncGhwL3Rwb3BfaW5zZXJ0LnBocCcsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcImlkXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJChha3RpdmVyX25vZGUpLmF0dHIoXCJpZFwiKSksXHJcblx0XHRcdFx0XHRcdFx0XCJ0eXBcIjogXCJ0cG9wXCIsXHJcblx0XHRcdFx0XHRcdFx0XCJ1c2VyXCI6IHNlc3Npb25TdG9yYWdlLlVzZXJcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpbnNlcnRUUG9wLmFsd2F5cyhmdW5jdGlvbihpZCkge1xyXG5cdFx0XHRcdFx0XHR2YXIgc3RydWt0dXJ0eXAgPSBcInRwb3BcIixcclxuXHRcdFx0XHRcdFx0XHRiZXNjaHJpZnR1bmcgPSBcIm5ldWUgVGVpbHBvcHVsYXRpb25cIjtcclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi5pbnNlcnROZXVlbk5vZGVFaW5lSGllcmFyY2hpZXN0dWZlVGllZmVyKGFrdGl2ZXJfbm9kZSwgcGFyZW50X25vZGUsIHN0cnVrdHVydHlwLCBpZCwgYmVzY2hyaWZ0dW5nKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aW5zZXJ0VFBvcC5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IEtlaW5lIG5ldWUgVGVpbHBvcHVsYXRpb24gZXJzdGVsbHRcIik7XHJcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IEtlaW5lIG5ldWUgVGVpbHBvcHVsYXRpb24gZXJzdGVsbHQnKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSxcclxuXHRcdFx0XCJHZW9BZG1pbk1hcHNcIjoge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogXCJhdWYgQ0gtS2FydGVuIHplaWdlblwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9mbG9yYV9pY29uX2dlbGIucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgZ2V0VHBvcHNLYXJ0ZSA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHRcdHR5cGU6ICdnZXQnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvdHBvcHNfa2FydGUucGhwJyxcclxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFwiaWRcIjogd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKGFrdGl2ZXJfbm9kZSkuYXR0cihcImlkXCIpKVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGdldFRwb3BzS2FydGUuYWx3YXlzKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHRcdFx0aWYgKGRhdGEucm93cy5sZW5ndGggPiAwKSB7XHJcblx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi56ZWlnZVRQb3BBdWZPbG1hcChkYXRhKTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLm1lbGRlKFwiRXMgZ2lidCBrZWluZSBUZWlscG9wdWxhdGlvbiBtaXQgS29vcmRpbmF0ZW5cIiwgXCJBa3Rpb24gYWJnZWJyb2NoZW5cIik7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Z2V0VHBvcHNLYXJ0ZS5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IEtlaW5lIFRlaWxwb3B1bGF0aW9uZW4gZXJoYWx0ZW5cIik7XHJcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IEtlaW5lIFRlaWxwb3B1bGF0aW9uZW4gZXJoYWx0ZW4nKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSxcclxuXHRcdFx0XCJHb29nbGVNYXBzXCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwiYXVmIEdvb2dsZS1LYXJ0ZW4gemVpZ2VuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL2Zsb3JhX2ljb24ucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgZ2V0UG9wS2FydGVfMiA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHRcdHR5cGU6ICdnZXQnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvcG9wX2thcnRlLnBocCcsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcImlkXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJChha3RpdmVyX25vZGUpLmF0dHIoXCJpZFwiKSlcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRnZXRQb3BLYXJ0ZV8yLmFsd2F5cyhmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0XHRcdGlmIChkYXRhLnJvd3MubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZ21hcC56ZWlnZVRQb3AoZGF0YSk7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5tZWxkZShcIkVzIGdpYnQga2VpbmUgVGVpbHBvcHVsYXRpb24gbWl0IEtvb3JkaW5hdGVuXCIsIFwiQWt0aW9uIGFiZ2Vicm9jaGVuXCIpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGdldFBvcEthcnRlXzIuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBLZWluZSBUZWlscG9wdWxhdGlvbmVuIGVyaGFsdGVuXCIpO1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBLZWluZSBUZWlscG9wdWxhdGlvbmVuIGVyaGFsdGVuJyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0XHRpZiAod2luZG93LmFwZi50cG9wX25vZGVfYXVzZ2VzY2huaXR0ZW4pIHtcclxuXHRcdFx0aXRlbXMuZWluZnVlZ2VuID0ge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogJC5qc3RyZWUuX3JlZmVyZW5jZSh3aW5kb3cuYXBmLnRwb3Bfbm9kZV9hdXNnZXNjaG5pdHRlbikuZ2V0X3RleHQod2luZG93LmFwZi50cG9wX25vZGVfYXVzZ2VzY2huaXR0ZW4pICsgXCIgZWluZsO8Z2VuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL2VpbmZ1ZWdlbi5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5tb3ZlX25vZGUod2luZG93LmFwZi50cG9wX25vZGVfYXVzZ2VzY2huaXR0ZW4sIGFrdGl2ZXJfbm9kZSwgXCJmaXJzdFwiLCBmYWxzZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRpZiAod2luZG93LmFwZi50cG9wX25vZGVfa29waWVydCkge1xyXG5cdFx0XHRsYWJlbCA9IFwiXCI7XHJcblx0XHRcdGlmICh3aW5kb3cuYXBmLnRwb3Bfb2JqZWt0X2tvcGllcnQuVFBvcE5yKSB7XHJcblx0XHRcdFx0bGFiZWwgKz0gd2luZG93LmFwZi50cG9wX29iamVrdF9rb3BpZXJ0LlRQb3BOcjtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRsYWJlbCArPSBcIihrZWluZSBOci4pXCI7XHJcblx0XHRcdH1cclxuXHRcdFx0bGFiZWwgKz0gXCI6IFwiO1xyXG5cdFx0XHRpZiAod2luZG93LmFwZi50cG9wX29iamVrdF9rb3BpZXJ0LlRQb3BGbHVybmFtZSkge1xyXG5cdFx0XHRcdGxhYmVsICs9IHdpbmRvdy5hcGYudHBvcF9vYmpla3Rfa29waWVydC5UUG9wRmx1cm5hbWU7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0bGFiZWwgKz0gXCIoa2VpbiBGbHVybmFtZSlcIjtcclxuXHRcdFx0fVxyXG5cdFx0XHRpdGVtcy5laW5mdWVnZW4gPSB7XHJcblx0XHRcdFx0Ly9cImxhYmVsXCI6ICQuanN0cmVlLl9yZWZlcmVuY2Uod2luZG93LmFwZi50cG9wX25vZGVfa29waWVydCkuZ2V0X3RleHQod2luZG93LmFwZi50cG9wX25vZGVfa29waWVydCkgKyBcIiBlaW5mw7xnZW5cIixcclxuXHRcdFx0XHRcImxhYmVsXCI6IGxhYmVsICsgXCIgZWluZsO8Z2VuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL2VpbmZ1ZWdlbi5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdHdpbmRvdy5hcGYudHBvcEtvcGllcnRJblBvcE9yZG5lclRwb3BFaW5mw7xnZW4oYWt0aXZlcl9ub2RlKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiBpdGVtcztcclxuXHRjYXNlIFwidHBvcFwiOlxyXG5cdFx0aXRlbXMgPSB7XHJcblx0XHRcdFwidW50ZXJnZW9yZG5ldGVLbm90ZW5PZWZmbmVuXCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwidW50ZXJnZW9yZG5ldGUgS25vdGVuIMO2ZmZuZW5cIixcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvdHJlZTE2eDE2LnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShub2RlKS5vcGVuX2FsbChub2RlKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sXHJcblx0XHRcdFwibmV1XCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwibmV1ZSBUZWlscG9wdWxhdGlvblwiLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9uZXUucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgaW5zZXJ0VFBvcF8yID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvdHBvcF9pbnNlcnQucGhwJyxcclxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFwiaWRcIjogd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKHBhcmVudF9ub2RlKS5hdHRyKFwiaWRcIikpLFxyXG5cdFx0XHRcdFx0XHRcdFwidHlwXCI6IFwidHBvcFwiLFxyXG5cdFx0XHRcdFx0XHRcdFwidXNlclwiOiBzZXNzaW9uU3RvcmFnZS5Vc2VyXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aW5zZXJ0VFBvcF8yLmFsd2F5cyhmdW5jdGlvbihpZCkge1xyXG5cdFx0XHRcdFx0XHR2YXIgc3RydWt0dXJ0eXAgPSBcInRwb3BcIixcclxuXHRcdFx0XHRcdFx0XHRiZXNjaHJpZnR1bmcgPSBcIm5ldWUgVGVpbHBvcHVsYXRpb25cIjtcclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi5pbnNlcnROZXVlbk5vZGVBdWZHbGVpY2hlckhpZXJhcmNoaWVzdHVmZShha3RpdmVyX25vZGUsIHBhcmVudF9ub2RlLCBzdHJ1a3R1cnR5cCwgaWQsIGJlc2NocmlmdHVuZyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydFRQb3BfMi5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IEtlaW5lIG5ldWUgVGVpbHBvcHVsYXRpb24gZXJzdGVsbHRcIik7XHJcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IEtlaW5lIG5ldWUgVGVpbHBvcHVsYXRpb24gZXJzdGVsbHQnKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSxcclxuXHRcdFx0XCJsb2VzY2hlblwiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcImzDtnNjaGVuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL2xvZXNjaGVuLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gbnVyIGFrdHVhbGlzaWVyZW4sIHdlbm4gU2NocmVpYnJlY2h0ZSBiZXN0ZWhlblxyXG5cdFx0XHRcdFx0aWYgKCF3aW5kb3cuYXBmLnByw7xmZVNjaHJlaWJ2b3JhdXNzZXR6dW5nZW4oKSkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHQvLyBzZWxla3RpZXJlbiwgZmFsbHMgZGlyZWt0IG1pdCBkZXIgcmVjaHRlbiBNYXVzdGFzdGUgZ2V3w6RobHQgd3VyZGVcclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5kZXNlbGVjdF9hbGwoKTtcclxuXHRcdFx0XHRcdC8vIGFsbGUgdGllZmVyZW4gS25vdGVuIMO2ZmZuZW4gdW0genUgemVpZ2VuLCB3YXMgbWl0IGdlbMO2c2NodCB3aXJkXHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkub3Blbl9hbGwoYWt0aXZlcl9ub2RlKTtcclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5kZXNlbGVjdF9hbGwoKTtcclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5zZWxlY3Rfbm9kZShha3RpdmVyX25vZGUpO1xyXG5cdFx0XHRcdFx0dmFyIGJlemVpY2hudW5nID0gJC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLmdldF90ZXh0KGFrdGl2ZXJfbm9kZSk7XHJcblx0XHRcdFx0XHQkKFwiI2xvZXNjaGVuX2RpYWxvZ19taXR0ZWlsdW5nXCIpLmh0bWwoXCJEaWUgVGVpbHBvcHVsYXRpb24gJ1wiICsgYmV6ZWljaG51bmcgKyBcIicgd2lyZCBnZWzDtnNjaHQuXCIpO1xyXG5cdFx0XHRcdFx0JChcIiNsb2VzY2hlbl9kaWFsb2dcIikuZGlhbG9nKHtcclxuXHRcdFx0XHRcdFx0cmVzaXphYmxlOiBmYWxzZSxcclxuXHRcdFx0XHRcdFx0aGVpZ2h0OidhdXRvJyxcclxuXHRcdFx0XHRcdFx0d2lkdGg6IDQwMCxcclxuXHRcdFx0XHRcdFx0bW9kYWw6IHRydWUsXHJcblx0XHRcdFx0XHRcdGJ1dHRvbnM6IHtcclxuXHRcdFx0XHRcdFx0XHRcImphLCBsw7ZzY2hlbiFcIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHQkKHRoaXMpLmRpYWxvZyhcImNsb3NlXCIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gVmFyaWFibGUgenVtIHLDvGNrZ8OkbmdpZyBtYWNoZW4gZXJzdGVsbGVuXHJcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmRlbGV0ZWQgPSB3aW5kb3cuYXBmLnRwb3A7XHJcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmRlbGV0ZWQudHlwID0gXCJ0cG9wXCI7XHJcblx0XHRcdFx0XHRcdFx0XHQvLyBsw7ZzY2hlblxyXG5cdFx0XHRcdFx0XHRcdFx0dmFyIGRlbGV0ZVRQb3AgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHRcdFx0XHRcdFx0XHRcdHVybDogJ3BocC90cG9wX2RlbGV0ZS5waHAnLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XCJpZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwiaWRcIikpXHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0ZGVsZXRlVFBvcC5hbHdheXMoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGRlbGV0ZSBsb2NhbFN0b3JhZ2UudHBvcF9pZDtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYudHBvcDtcclxuXHRcdFx0XHRcdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLmRlbGV0ZV9ub2RlKGFrdGl2ZXJfbm9kZSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vIFBhcmVudCBOb2RlLUJlc2NocmlmdHVuZzogQW56YWhsIGFucGFzc2VuXHJcblx0XHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuYmVzY2hyaWZ0ZV9vcmRuZXJfdHBvcChwYXJlbnRfbm9kZSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vIEhpbndlaXMgenVtIHLDvGNrZ8OkbmdpZyBtYWNoZW4gYW56ZWlnZW5cclxuXHRcdFx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5mcmFnZU9iQWt0aW9uUsO8Y2tnw6RuZ2lnR2VtYWNodFdlcmRlblNvbGwoXCJUZWlscG9wdWxhdGlvbiAnXCIgKyBiZXplaWNobnVuZyArIFwiJyB3dXJkZSBnZWzDtnNjaHQuXCIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0XHRkZWxldGVUUG9wLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogRGllIFRlaWxwb3B1bGF0aW9uIHd1cmRlIG5pY2h0IGdlbMO2c2NodFwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogRGllIFRlaWxwb3B1bGF0aW9uIHd1cmRlIG5pY2h0IGdlbMO2c2NodCcpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0XHRcImFiYnJlY2hlblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdCQodGhpcykuZGlhbG9nKFwiY2xvc2VcIik7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcdFx0XHRcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sXHJcblx0XHRcdFwiR2VvQWRtaW5NYXBzXCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwiYXVmIENILUthcnRlbiB6ZWlnZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvZmxvcmFfaWNvbl9nZWxiLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0dmFyIGdldFRQb3BLYXJ0ZV8yID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ2dldCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ3BocC90cG9wX2thcnRlLnBocCcsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcImlkXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJChha3RpdmVyX25vZGUpLmF0dHIoXCJpZFwiKSlcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRnZXRUUG9wS2FydGVfMi5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRcdFx0XHRpZiAoZGF0YS5yb3dzLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLnplaWdlVFBvcEF1Zk9sbWFwKGRhdGEpO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYubWVsZGUoXCJEaWUgVGVpbHBvcHVsYXRpb24gaGF0IGtlaW5lIEtvb3JkaW5hdGVuXCIsIFwiQWt0aW9uIGFiZ2Vicm9jaGVuXCIpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGdldFRQb3BLYXJ0ZV8yLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogS2VpbmUgVGVpbHBvcHVsYXRpb25lbiBlcmhhbHRlblwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogS2VpbmUgVGVpbHBvcHVsYXRpb25lbiBlcmhhbHRlbicpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LFxyXG5cdFx0XHRcInZlcm9ydGVuR2VvQWRtaW5cIjoge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogXCJhdWYgQ0gtS2FydGVuIHZlcm9ydGVuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL2Zsb3JhX2ljb25fcm90LnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0dmFyIGdldFRQb3BfMiA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHRcdHR5cGU6ICdnZXQnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvdHBvcC5waHAnLFxyXG5cdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFx0XCJpZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwiaWRcIikpXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Z2V0VFBvcF8yLmFsd2F5cyhmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYudmVyb3J0ZVRQb3BBdWZPbG1hcChkYXRhKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Z2V0VFBvcF8yLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogS2VpbmUgVGVpbHBvcHVsYXRpb24gZXJoYWx0ZW5cIik7XHJcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IEtlaW5lIFRlaWxwb3B1bGF0aW9uIGVyaGFsdGVuJyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sXHJcblx0XHRcdFwiR29vZ2xlTWFwc1wiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcImF1ZiBHb29nbGUtS2FydGVuIHplaWdlblwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9mbG9yYV9pY29uLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0dmFyIGdldFRQb3BLYXJ0ZV8zID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ2dldCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ3BocC90cG9wX2thcnRlLnBocCcsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcImlkXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJChha3RpdmVyX25vZGUpLmF0dHIoXCJpZFwiKSlcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRnZXRUUG9wS2FydGVfMy5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRcdFx0XHRpZiAoZGF0YS5yb3dzLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmdtYXAuemVpZ2VUUG9wKGRhdGEpO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYubWVsZGUoXCJEaWUgVGVpbHBvcHVsYXRpb24gaGF0IGtlaW5lIEtvb3JkaW5hdGVuXCIsIFwiQWt0aW9uIGFiZ2Vicm9jaGVuXCIpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGdldFRQb3BLYXJ0ZV8zLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogS2VpbmUgRGF0ZW4gZXJoYWx0ZW5cIik7XHJcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IEtlaW5lIERhdGVuIGVyaGFsdGVuJyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sXHRcdFxyXG5cdFx0XHRcInZlcm9ydGVuXCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwiYXVmIEdvb2dsZS1LYXJ0ZW4gdmVyb3J0ZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvZmxvcmFfaWNvbl9yb3QucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgZ2V0VFBvcF8zID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ2dldCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ3BocC90cG9wLnBocCcsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcImlkXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJChha3RpdmVyX25vZGUpLmF0dHIoXCJpZFwiKSlcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRnZXRUUG9wXzMuYWx3YXlzKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi5nbWFwLnZlcm9ydGVUUG9wKGRhdGEpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRnZXRUUG9wXzMuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBLZWluZSBEYXRlbiBlcmhhbHRlblwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogS2VpbmUgRGF0ZW4gZXJoYWx0ZW4nKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSxcclxuXHRcdFx0XCJHaXNCcm93c2VyXCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwiaW0gR0lTLUJyb3dzZXIgemVpZ2VuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL3dhcHBlbl96dWVyaWNoLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0d2luZG93LmFwZi56ZWlnZUJlb2JLb29yZGluYXRlbkltR2lzQnJvd3NlcigpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHRcdGlmICghd2luZG93LmFwZi50cG9wX25vZGVfYXVzZ2VzY2huaXR0ZW4pIHtcclxuXHRcdFx0aXRlbXMuYXVzc2NobmVpZGVuID0ge1xyXG5cdFx0XHRcdC8vXCJsYWJlbFwiOiBcImF1c3NjaG5laWRlbjxicj4mbmJzcDsmbmJzcDsmbmJzcDtUaXBwOiBkcmFnIGFuZCBkcm9wIG1lIVwiLFxyXG5cdFx0XHRcdFwibGFiZWxcIjogXCJhdXNzY2huZWlkZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvYXVzc2NobmVpZGVuLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gbnVyIGFrdHVhbGlzaWVyZW4sIHdlbm4gU2NocmVpYnJlY2h0ZSBiZXN0ZWhlblxyXG5cdFx0XHRcdFx0aWYgKCF3aW5kb3cuYXBmLnByw7xmZVNjaHJlaWJ2b3JhdXNzZXR6dW5nZW4oKSkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLnRwb3Bfbm9kZV9hdXNnZXNjaG5pdHRlbiA9IGFrdGl2ZXJfbm9kZTtcclxuXHRcdFx0XHRcdC8vIGVzIG1hY2h0IGtlaW5lbiBTaW5uIG1laHIsIGRlbiBrb3BpZXJ0ZW4gbm9kZSB6dSBiZWhhbHRlblxyXG5cdFx0XHRcdFx0Ly8gdW5kIHN0ZWxsdCBzaWNoZXIsIGRhc3MgbnVuIGRlciBhdXNnZXNjaG5pdHRlbmUgbWl0IFwiZWluZsO8Z2VuXCIgYW5nZWJvdGVuIHdpcmRcclxuXHRcdFx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLnRwb3Bfbm9kZV9rb3BpZXJ0O1xyXG5cdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYudHBvcF9vYmpla3Rfa29waWVydDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGlmICghd2luZG93LmFwZi50cG9wX25vZGVfYXVzZ2VzY2huaXR0ZW4pIHtcclxuXHRcdFx0aXRlbXMua29waWVyZW4gPSB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcImtvcGllcmVuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL2tvcGllcmVuLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gbnVyIGFrdHVhbGlzaWVyZW4sIHdlbm4gU2NocmVpYnJlY2h0ZSBiZXN0ZWhlblxyXG5cdFx0XHRcdFx0aWYgKCF3aW5kb3cuYXBmLnByw7xmZVNjaHJlaWJ2b3JhdXNzZXR6dW5nZW4oKSkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLnRwb3Bfbm9kZV9rb3BpZXJ0ID0gYWt0aXZlcl9ub2RlO1xyXG5cdFx0XHRcdFx0Ly8gRGF0ZW4gZGVzIE9iamVrdHMgaG9sZW5cclxuXHRcdFx0XHRcdHZhciBnZXRUUG9wXzQgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHR0eXBlOiAnZ2V0JyxcclxuXHRcdFx0XHRcdFx0dXJsOiAncGhwL3Rwb3AucGhwJyxcclxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFwiaWRcIjogd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKHdpbmRvdy5hcGYudHBvcF9ub2RlX2tvcGllcnQpLmF0dHIoXCJpZFwiKSlcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRnZXRUUG9wXzQuYWx3YXlzKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi50cG9wX29iamVrdF9rb3BpZXJ0ID0gZGF0YTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Z2V0VFBvcF80LmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogRGllIFRlaWxwb3B1bGF0aW9uIHd1cmRlIG5pY2h0IGtvcGllcnRcIik7XHJcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IERpZSBUZWlscG9wdWxhdGlvbiB3dXJkZSBuaWNodCBrb3BpZXJ0Jyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGlmICh3aW5kb3cuYXBmLnRwb3Bfbm9kZV9rb3BpZXJ0KSB7XHJcblx0XHRcdHZhciBsYWJlbCA9IFwiXCI7XHJcblx0XHRcdGlmICh3aW5kb3cuYXBmLnRwb3Bfb2JqZWt0X2tvcGllcnQuVFBvcE5yKSB7XHJcblx0XHRcdFx0bGFiZWwgKz0gd2luZG93LmFwZi50cG9wX29iamVrdF9rb3BpZXJ0LlRQb3BOcjtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRsYWJlbCArPSBcIihrZWluZSBOci4pXCI7XHJcblx0XHRcdH1cclxuXHRcdFx0bGFiZWwgKz0gXCI6IFwiO1xyXG5cdFx0XHRpZiAod2luZG93LmFwZi50cG9wX29iamVrdF9rb3BpZXJ0LlRQb3BGbHVybmFtZSkge1xyXG5cdFx0XHRcdGxhYmVsICs9IHdpbmRvdy5hcGYudHBvcF9vYmpla3Rfa29waWVydC5UUG9wRmx1cm5hbWU7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0bGFiZWwgKz0gXCIoa2VpbiBGbHVybmFtZSlcIjtcclxuXHRcdFx0fVxyXG5cdFx0XHRpdGVtcy5laW5mdWVnZW4gPSB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBsYWJlbCArIFwiIGVpbmbDvGdlblwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9laW5mdWVnZW4ucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLnRwb3BLb3BpZXJ0SW5Qb3BPcmRuZXJUcG9wRWluZsO8Z2VuKHBhcmVudF9ub2RlKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGlmICh3aW5kb3cuYXBmLnRwb3Bfbm9kZV9hdXNnZXNjaG5pdHRlbikge1xyXG5cdFx0XHRpdGVtcy5laW5mdWVnZW4gPSB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiAkLmpzdHJlZS5fcmVmZXJlbmNlKHdpbmRvdy5hcGYudHBvcF9ub2RlX2F1c2dlc2Nobml0dGVuKS5nZXRfdGV4dCh3aW5kb3cuYXBmLnRwb3Bfbm9kZV9hdXNnZXNjaG5pdHRlbikgKyBcIiBlaW5mw7xnZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvZWluZnVlZ2VuLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShwYXJlbnRfbm9kZSkubW92ZV9ub2RlKHdpbmRvdy5hcGYudHBvcF9ub2RlX2F1c2dlc2Nobml0dGVuLCBwYXJlbnRfbm9kZSwgXCJmaXJzdFwiLCBmYWxzZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gaXRlbXM7XHJcblx0Y2FzZSBcInBvcF9vcmRuZXJfcG9wYmVyXCI6XHJcblx0XHRpdGVtcyA9IHtcclxuXHRcdFx0XCJuZXVcIjoge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogXCJuZXVlciBQb3B1bGF0aW9ucy1CZXJpY2h0XCIsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL25ldS5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdHZhciBpbnNlcnRQb3BiZXIgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ3BocC9wb3BiZXJfaW5zZXJ0LnBocCcsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcImlkXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJChha3RpdmVyX25vZGUpLmF0dHIoXCJpZFwiKSksXHJcblx0XHRcdFx0XHRcdFx0XCJ1c2VyXCI6IHNlc3Npb25TdG9yYWdlLlVzZXJcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpbnNlcnRQb3BiZXIuYWx3YXlzKGZ1bmN0aW9uKGlkKSB7XHJcblx0XHRcdFx0XHRcdHZhciBzdHJ1a3R1cnR5cCA9IFwicG9wYmVyXCIsXHJcblx0XHRcdFx0XHRcdFx0YmVzY2hyaWZ0dW5nID0gXCJuZXVlciBQb3B1bGF0aW9ucy1CZXJpY2h0XCI7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuaW5zZXJ0TmV1ZW5Ob2RlRWluZUhpZXJhcmNoaWVzdHVmZVRpZWZlcihha3RpdmVyX25vZGUsIHBhcmVudF9ub2RlLCBzdHJ1a3R1cnR5cCwgaWQsIGJlc2NocmlmdHVuZyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydFBvcGJlci5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IEtlaW5lbiBuZXVlbiBQb3B1bGF0aW9ucy1CZXJpY2h0IGVyc3RlbGx0XCIpO1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBLZWluZW4gbmV1ZW4gUG9wdWxhdGlvbnMtQmVyaWNodCBlcnN0ZWxsdCcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cdFx0cmV0dXJuIGl0ZW1zO1xyXG5cdGNhc2UgXCJwb3BiZXJcIjpcclxuXHRcdGl0ZW1zID0ge1xyXG5cdFx0XHRcIm5ldVwiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcIm5ldWVyIFBvcHVsYXRpb25zLUJlcmljaHRcIixcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvbmV1LnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0dmFyIGluc2VydFBvcGJlcl8yID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvcG9wYmVyX2luc2VydC5waHAnLFxyXG5cdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFx0XCJpZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQocGFyZW50X25vZGUpLmF0dHIoXCJpZFwiKSksXHJcblx0XHRcdFx0XHRcdFx0XCJ0eXBcIjogXCJwb3BiZXJcIixcclxuXHRcdFx0XHRcdFx0XHRcInVzZXJcIjogc2Vzc2lvblN0b3JhZ2UuVXNlclxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydFBvcGJlcl8yLmFsd2F5cyhmdW5jdGlvbihpZCkge1xyXG5cdFx0XHRcdFx0XHR2YXIgc3RydWt0dXJ0eXAgPSBcInBvcGJlclwiLFxyXG5cdFx0XHRcdFx0XHRcdGJlc2NocmlmdHVuZyA9IFwibmV1ZXIgUG9wdWxhdGlvbnMtQmVyaWNodFwiO1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmluc2VydE5ldWVuTm9kZUF1ZkdsZWljaGVySGllcmFyY2hpZXN0dWZlKGFrdGl2ZXJfbm9kZSwgcGFyZW50X25vZGUsIHN0cnVrdHVydHlwLCBpZCwgYmVzY2hyaWZ0dW5nKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aW5zZXJ0UG9wYmVyXzIuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBLZWluZW4gbmV1ZW4gUG9wdWxhdGlvbnMtQmVyaWNodCBlcnN0ZWxsdFwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogS2VpbmVuIG5ldWVuIFBvcHVsYXRpb25zLUJlcmljaHQgZXJzdGVsbHQnKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSxcclxuXHRcdFx0XCJsb2VzY2hlblwiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcImzDtnNjaGVuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL2xvZXNjaGVuLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gbnVyIGFrdHVhbGlzaWVyZW4sIHdlbm4gU2NocmVpYnJlY2h0ZSBiZXN0ZWhlblxyXG5cdFx0XHRcdFx0aWYgKCF3aW5kb3cuYXBmLnByw7xmZVNjaHJlaWJ2b3JhdXNzZXR6dW5nZW4oKSkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR2YXIgYmV6ZWljaG51bmcgPSAkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkuZ2V0X3RleHQoYWt0aXZlcl9ub2RlKTtcclxuXHRcdFx0XHRcdCQoXCIjbG9lc2NoZW5fZGlhbG9nX21pdHRlaWx1bmdcIikuaHRtbChcIkRlciBQb3B1bGF0aW9ucy1CZXJpY2h0ICdcIiArIGJlemVpY2hudW5nICsgXCInIHdpcmQgZ2Vsw7ZzY2h0LlwiKTtcclxuXHRcdFx0XHRcdCQoXCIjbG9lc2NoZW5fZGlhbG9nXCIpLmRpYWxvZyh7XHJcblx0XHRcdFx0XHRcdHJlc2l6YWJsZTogZmFsc2UsXHJcblx0XHRcdFx0XHRcdGhlaWdodDonYXV0bycsXHJcblx0XHRcdFx0XHRcdHdpZHRoOiA0MDAsXHJcblx0XHRcdFx0XHRcdG1vZGFsOiB0cnVlLFxyXG5cdFx0XHRcdFx0XHRidXR0b25zOiB7XHJcblx0XHRcdFx0XHRcdFx0XCJqYSwgbMO2c2NoZW4hXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0JCh0aGlzKS5kaWFsb2coXCJjbG9zZVwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIFZhcmlhYmxlIHp1bSByw7xja2fDpG5naWcgbWFjaGVuIGVyc3RlbGxlblxyXG5cdFx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5kZWxldGVkID0gd2luZG93LmFwZi5wb3BiZXI7XHJcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmRlbGV0ZWQudHlwID0gXCJwb3BiZXJcIjtcclxuXHRcdFx0XHRcdFx0XHRcdHZhciBkZWxldGVQb3BiZXIgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHRcdFx0XHRcdFx0XHRcdHVybDogJ3BocC9wb3BiZXJfZGVsZXRlLnBocCcsXHJcblx0XHRcdFx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcImlkXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJChha3RpdmVyX25vZGUpLmF0dHIoXCJpZFwiKSlcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0XHRkZWxldGVQb3BiZXIuYWx3YXlzKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRkZWxldGUgbG9jYWxTdG9yYWdlLnBvcGJlcl9pZDtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYucG9wYmVyO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkuZGVsZXRlX25vZGUoYWt0aXZlcl9ub2RlKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gUGFyZW50IE5vZGUtQmVzY2hyaWZ0dW5nOiBBbnphaGwgYW5wYXNzZW5cclxuXHRcdFx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl9wb3BiZXIocGFyZW50X25vZGUpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBIaW53ZWlzIHp1bSByw7xja2fDpG5naWcgbWFjaGVuIGFuemVpZ2VuXHJcblx0XHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZnJhZ2VPYkFrdGlvblLDvGNrZ8OkbmdpZ0dlbWFjaHRXZXJkZW5Tb2xsKFwiRGVyIFBvcHVsYXRpb25zLUJlcmljaHQgJ1wiICsgYmV6ZWljaG51bmcgKyBcIicgd3VyZGUgZ2Vsw7ZzY2h0LlwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0ZGVsZXRlUG9wYmVyLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogRGVyIFBvcHVsYXRpb25zLUJlcmljaHQgd3VyZGUgbmljaHQgZ2Vsw7ZzY2h0XCIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBEZXIgUG9wdWxhdGlvbnMtQmVyaWNodCB3dXJkZSBuaWNodCBnZWzDtnNjaHQnKTtcclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdFx0XCJhYmJyZWNoZW5cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHQkKHRoaXMpLmRpYWxvZyhcImNsb3NlXCIpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cdFx0cmV0dXJuIGl0ZW1zO1xyXG5cdGNhc2UgXCJwb3Bfb3JkbmVyX21hc3NuYmVyXCI6XHJcblx0XHRpdGVtcyA9IHtcclxuXHRcdFx0XCJuZXVcIjoge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogXCJuZXVlciBNYXNzbmFobWVuLUJlcmljaHRcIixcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvbmV1LnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0dmFyIGluc2VydFBvcE1hc3NuQmVyID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvcG9wbWFzc25iZXJfaW5zZXJ0LnBocCcsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcImlkXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJChha3RpdmVyX25vZGUpLmF0dHIoXCJpZFwiKSksXHJcblx0XHRcdFx0XHRcdFx0XCJ1c2VyXCI6IHNlc3Npb25TdG9yYWdlLlVzZXJcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpbnNlcnRQb3BNYXNzbkJlci5hbHdheXMoZnVuY3Rpb24oaWQpIHtcclxuXHRcdFx0XHRcdFx0dmFyIHN0cnVrdHVydHlwID0gXCJwb3BtYXNzbmJlclwiLFxyXG5cdFx0XHRcdFx0XHRcdGJlc2NocmlmdHVuZyA9IFwibmV1ZXIgTWFzc25haG1lbi1CZXJpY2h0XCI7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuaW5zZXJ0TmV1ZW5Ob2RlRWluZUhpZXJhcmNoaWVzdHVmZVRpZWZlcihha3RpdmVyX25vZGUsIHBhcmVudF9ub2RlLCBzdHJ1a3R1cnR5cCwgaWQsIGJlc2NocmlmdHVuZyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydFBvcE1hc3NuQmVyLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogRXMgd3VyZGUga2VpbiBuZXVlciBNYXNzbmFobWVuLUJlcmljaHQgZXJzdGVsbHRcIik7XHJcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IEVzIHd1cmRlIGtlaW4gbmV1ZXIgTWFzc25haG1lbi1CZXJpY2h0IGVyc3RlbGx0Jyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0XHRyZXR1cm4gaXRlbXM7XHJcblx0Y2FzZSBcInBvcG1hc3NuYmVyXCI6XHJcblx0XHRpdGVtcyA9IHtcclxuXHRcdFx0XCJuZXVcIjoge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogXCJuZXVlciBNYXNzbmFobWVuLUJlcmljaHRcIixcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvbmV1LnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0dmFyIGluc2VydFBvcE1hc3NuQmVyXzIgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ3BocC9wb3BtYXNzbmJlcl9pbnNlcnQucGhwJyxcclxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFwiaWRcIjogd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKHBhcmVudF9ub2RlKS5hdHRyKFwiaWRcIikpLFxyXG5cdFx0XHRcdFx0XHRcdFwidHlwXCI6IFwicG9wbWFzc25iZXJcIixcclxuXHRcdFx0XHRcdFx0XHRcInVzZXJcIjogc2Vzc2lvblN0b3JhZ2UuVXNlclxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydFBvcE1hc3NuQmVyXzIuYWx3YXlzKGZ1bmN0aW9uKGlkKSB7XHJcblx0XHRcdFx0XHRcdHZhciBzdHJ1a3R1cnR5cCA9IFwicG9wbWFzc25iZXJcIixcclxuXHRcdFx0XHRcdFx0XHRiZXNjaHJpZnR1bmcgPSBcIm5ldWVyIE1hc3NuYWhtZW4tQmVyaWNodFwiO1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmluc2VydE5ldWVuTm9kZUF1ZkdsZWljaGVySGllcmFyY2hpZXN0dWZlKGFrdGl2ZXJfbm9kZSwgcGFyZW50X25vZGUsIHN0cnVrdHVydHlwLCBpZCwgYmVzY2hyaWZ0dW5nKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aW5zZXJ0UG9wTWFzc25CZXJfMi5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IEVzIHd1cmRlIGtlaW4gbmV1ZXIgTWFzc25haG1lbi1CZXJpY2h0IGVyc3RlbGx0XCIpO1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBFcyB3dXJkZSBrZWluIG5ldWVyIE1hc3NuYWhtZW4tQmVyaWNodCBlcnN0ZWxsdCcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LFxyXG5cdFx0XHRcImxvZXNjaGVuXCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwibMO2c2NoZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvbG9lc2NoZW4ucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQvLyBudXIgYWt0dWFsaXNpZXJlbiwgd2VubiBTY2hyZWlicmVjaHRlIGJlc3RlaGVuXHJcblx0XHRcdFx0XHRpZiAoIXdpbmRvdy5hcGYucHLDvGZlU2NocmVpYnZvcmF1c3NldHp1bmdlbigpKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHZhciBiZXplaWNobnVuZyA9ICQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5nZXRfdGV4dChha3RpdmVyX25vZGUpO1xyXG5cdFx0XHRcdFx0JChcIiNsb2VzY2hlbl9kaWFsb2dfbWl0dGVpbHVuZ1wiKS5odG1sKFwiRGVyIE1hc3NuYWhtZW4tQmVyaWNodCAnXCIgKyBiZXplaWNobnVuZyArIFwiJyB3aXJkIGdlbMO2c2NodC5cIik7XHJcblx0XHRcdFx0XHQkKFwiI2xvZXNjaGVuX2RpYWxvZ1wiKS5kaWFsb2coe1xyXG5cdFx0XHRcdFx0XHRyZXNpemFibGU6IGZhbHNlLFxyXG5cdFx0XHRcdFx0XHRoZWlnaHQ6J2F1dG8nLFxyXG5cdFx0XHRcdFx0XHR3aWR0aDogNDAwLFxyXG5cdFx0XHRcdFx0XHRtb2RhbDogdHJ1ZSxcclxuXHRcdFx0XHRcdFx0YnV0dG9uczoge1xyXG5cdFx0XHRcdFx0XHRcdFwiamEsIGzDtnNjaGVuIVwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdCQodGhpcykuZGlhbG9nKFwiY2xvc2VcIik7XHJcblx0XHRcdFx0XHRcdFx0XHQvLyBWYXJpYWJsZSB6dW0gcsO8Y2tnw6RuZ2lnIG1hY2hlbiBlcnN0ZWxsZW5cclxuXHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZGVsZXRlZCA9IHdpbmRvdy5hcGYucG9wbWFzc25iZXI7XHJcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmRlbGV0ZWQudHlwID0gXCJwb3BtYXNzbmJlclwiO1xyXG5cdFx0XHRcdFx0XHRcdFx0dmFyIGRlbGV0ZVBvcE1hc3NuQmVyID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHR1cmw6ICdwaHAvcG9wbWFzc25iZXJfZGVsZXRlLnBocCcsXHJcblx0XHRcdFx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcImlkXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJChha3RpdmVyX25vZGUpLmF0dHIoXCJpZFwiKSlcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0XHRkZWxldGVQb3BNYXNzbkJlci5hbHdheXMoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGRlbGV0ZSBsb2NhbFN0b3JhZ2UucG9wbWFzc25iZXJfaWQ7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLnBvcG1hc3NuYmVyO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkuZGVsZXRlX25vZGUoYWt0aXZlcl9ub2RlKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gUGFyZW50IE5vZGUtQmVzY2hyaWZ0dW5nOiBBbnphaGwgYW5wYXNzZW5cclxuXHRcdFx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl9wb3BtYXNzbmJlcihwYXJlbnRfbm9kZSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vIEhpbndlaXMgenVtIHLDvGNrZ8OkbmdpZyBtYWNoZW4gYW56ZWlnZW5cclxuXHRcdFx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5mcmFnZU9iQWt0aW9uUsO8Y2tnw6RuZ2lnR2VtYWNodFdlcmRlblNvbGwoXCJEZXIgTWFzc25haG1lbi1CZXJpY2h0ICdcIiArIGJlemVpY2hudW5nICsgXCInIHd1cmRlIGdlbMO2c2NodC5cIik7XHJcblx0XHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0XHRcdGRlbGV0ZVBvcE1hc3NuQmVyLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogRGVyIE1hc3NuYWhtZW4tQmVyaWNodCB3dXJkZSBuaWNodCBnZWzDtnNjaHRcIik7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IERlciBNYXNzbmFobWVuLUJlcmljaHQgd3VyZGUgbmljaHQgZ2Vsw7ZzY2h0Jyk7XHJcblx0XHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0XHRcdFwiYWJicmVjaGVuXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0JCh0aGlzKS5kaWFsb2coXCJjbG9zZVwiKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHRcdHJldHVybiBpdGVtcztcclxuXHRjYXNlIFwidHBvcF9vcmRuZXJfZmVsZGtvbnRyXCI6XHJcblx0XHRpdGVtcyA9IHtcclxuXHRcdFx0XCJuZXVcIjoge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogXCJuZXVlIEZlbGRrb250cm9sbGVcIixcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvbmV1LnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0dmFyIGluc2VydFRQb3BGZWxkS29udHIgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ3BocC90cG9wZmVsZGtvbnRyX2luc2VydC5waHAnLFxyXG5cdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFx0XCJpZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwiaWRcIikpLFxyXG5cdFx0XHRcdFx0XHRcdFwidHlwXCI6IFwidHBvcGZlbGRrb250clwiLFxyXG5cdFx0XHRcdFx0XHRcdFwidXNlclwiOiBzZXNzaW9uU3RvcmFnZS5Vc2VyXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aW5zZXJ0VFBvcEZlbGRLb250ci5hbHdheXMoZnVuY3Rpb24oaWQpIHtcclxuXHRcdFx0XHRcdFx0dmFyIHN0cnVrdHVydHlwID0gXCJ0cG9wZmVsZGtvbnRyXCIsXHJcblx0XHRcdFx0XHRcdFx0YmVzY2hyaWZ0dW5nID0gXCJuZXVlIEZlbGRrb250cm9sbGVcIjtcclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi5pbnNlcnROZXVlbk5vZGVFaW5lSGllcmFyY2hpZXN0dWZlVGllZmVyKGFrdGl2ZXJfbm9kZSwgcGFyZW50X25vZGUsIHN0cnVrdHVydHlwLCBpZCwgYmVzY2hyaWZ0dW5nKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aW5zZXJ0VFBvcEZlbGRLb250ci5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IEtlaW5lIG5ldWUgRmVsZGtvbnRyb2xsZSBlcnN0ZWxsdFwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogS2VpbmUgbmV1ZSBGZWxka29udHJvbGxlIGVyc3RlbGx0Jyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0XHRpZiAod2luZG93LmFwZi50cG9wZmVsZGtvbnRyX25vZGVfYXVzZ2VzY2huaXR0ZW4pIHtcclxuXHRcdFx0aXRlbXMuZWluZnVlZ2VuID0ge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogJC5qc3RyZWUuX3JlZmVyZW5jZSh3aW5kb3cuYXBmLnRwb3BmZWxka29udHJfbm9kZV9hdXNnZXNjaG5pdHRlbikuZ2V0X3RleHQod2luZG93LmFwZi50cG9wZmVsZGtvbnRyX25vZGVfYXVzZ2VzY2huaXR0ZW4pICsgXCIgZWluZsO8Z2VuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL2VpbmZ1ZWdlbi5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5tb3ZlX25vZGUod2luZG93LmFwZi50cG9wZmVsZGtvbnRyX25vZGVfYXVzZ2VzY2huaXR0ZW4sIGFrdGl2ZXJfbm9kZSwgXCJmaXJzdFwiLCBmYWxzZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRpZiAod2luZG93LmFwZi50cG9wZmVsZGtvbnRyX25vZGVfa29waWVydCkge1xyXG5cdFx0XHRpdGVtcy5laW5mdWVnZW4gPSB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiAkLmpzdHJlZS5fcmVmZXJlbmNlKHdpbmRvdy5hcGYudHBvcGZlbGRrb250cl9ub2RlX2tvcGllcnQpLmdldF90ZXh0KHdpbmRvdy5hcGYudHBvcGZlbGRrb250cl9ub2RlX2tvcGllcnQpICsgXCIgZWluZsO8Z2VuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL2VpbmZ1ZWdlbi5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdC8vIHVuZCBhbiBkaWUgREIgc2NoaWNrZW5cclxuXHRcdFx0XHRcdHZhciBpbnNlcnRUUG9wRmVsZEtvbnRyS29waWUgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ3BocC90cG9wZmVsZGtvbnRyX2luc2VydF9rb3BpZS5waHAnLFxyXG5cdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFx0XCJ1c2VyXCI6IHNlc3Npb25TdG9yYWdlLlVzZXIsXHJcblx0XHRcdFx0XHRcdFx0XCJUUG9wSWRcIjogd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKGFrdGl2ZXJfbm9kZSkuYXR0cihcImlkXCIpKSxcclxuXHRcdFx0XHRcdFx0XHRcIlRQb3BLb250cklkXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJCh3aW5kb3cuYXBmLnRwb3BmZWxka29udHJfbm9kZV9rb3BpZXJ0KS5hdHRyKFwiaWRcIikpXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aW5zZXJ0VFBvcEZlbGRLb250cktvcGllLmFsd2F5cyhmdW5jdGlvbihpZCkge1xyXG5cdFx0XHRcdFx0XHR2YXIgc3RydWt0dXJ0eXAgPSBcInRwb3BmZWxka29udHJcIixcclxuXHRcdFx0XHRcdFx0XHRiZXNjaHJpZnR1bmcgPSB3aW5kb3cuYXBmLmVyc3RlbGxlTGFiZWxGw7xyRmVsZGtvbnRyb2xsZSh3aW5kb3cuYXBmLnRwb3BmZWxka29udHJfb2JqZWt0X2tvcGllcnQuVFBvcEtvbnRySmFociwgd2luZG93LmFwZi50cG9wZmVsZGtvbnRyX29iamVrdF9rb3BpZXJ0LlRQb3BLb250clR5cCk7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuaW5zZXJ0TmV1ZW5Ob2RlRWluZUhpZXJhcmNoaWVzdHVmZVRpZWZlcihha3RpdmVyX25vZGUsIHBhcmVudF9ub2RlLCBzdHJ1a3R1cnR5cCwgaWQsIGJlc2NocmlmdHVuZyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydFRQb3BGZWxkS29udHJLb3BpZS5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IERpZSBGZWxka29udHJvbGxlIHd1cmRlIG5pY2h0IGVyc3RlbGx0XCIpO1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBEaWUgRmVsZGtvbnRyb2xsZSB3dXJkZSBuaWNodCBlcnN0ZWxsdCcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gaXRlbXM7XHJcblx0Y2FzZSBcInRwb3BmZWxka29udHJcIjpcclxuXHRcdGl0ZW1zID0ge1xyXG5cdFx0XHRcIm5ldVwiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcIm5ldWUgRmVsZGtvbnRyb2xsZVwiLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9uZXUucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgaW5zZXJ0VFBvcEZlbGRLb250cl8yID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvdHBvcGZlbGRrb250cl9pbnNlcnQucGhwJyxcclxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFwiaWRcIjogd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKHBhcmVudF9ub2RlKS5hdHRyKFwiaWRcIikpLFxyXG5cdFx0XHRcdFx0XHRcdFwidHlwXCI6IFwidHBvcGZlbGRrb250clwiLFxyXG5cdFx0XHRcdFx0XHRcdFwidXNlclwiOiBzZXNzaW9uU3RvcmFnZS5Vc2VyXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aW5zZXJ0VFBvcEZlbGRLb250cl8yLmFsd2F5cyhmdW5jdGlvbihpZCkge1xyXG5cdFx0XHRcdFx0XHR2YXIgc3RydWt0dXJ0eXAgPSBcInRwb3BmZWxka29udHJcIixcclxuXHRcdFx0XHRcdFx0XHRiZXNjaHJpZnR1bmcgPSBcIm5ldWUgRmVsZGtvbnRyb2xsZVwiO1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmluc2VydE5ldWVuTm9kZUF1ZkdsZWljaGVySGllcmFyY2hpZXN0dWZlKGFrdGl2ZXJfbm9kZSwgcGFyZW50X25vZGUsIHN0cnVrdHVydHlwLCBpZCwgYmVzY2hyaWZ0dW5nKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aW5zZXJ0VFBvcEZlbGRLb250cl8yLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogS2VpbmUgbmV1ZSBGZWxka29udHJvbGxlIGVyc3RlbGx0XCIpO1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBLZWluZSBuZXVlIEZlbGRrb250cm9sbGUgZXJzdGVsbHQnKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSxcclxuXHRcdFx0XCJsb2VzY2hlblwiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcImzDtnNjaGVuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL2xvZXNjaGVuLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gbnVyIGFrdHVhbGlzaWVyZW4sIHdlbm4gU2NocmVpYnJlY2h0ZSBiZXN0ZWhlblxyXG5cdFx0XHRcdFx0aWYgKCF3aW5kb3cuYXBmLnByw7xmZVNjaHJlaWJ2b3JhdXNzZXR6dW5nZW4oKSkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR2YXIgYmV6ZWljaG51bmcgPSAkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkuZ2V0X3RleHQoYWt0aXZlcl9ub2RlKTtcclxuXHRcdFx0XHRcdCQoXCIjbG9lc2NoZW5fZGlhbG9nX21pdHRlaWx1bmdcIikuaHRtbChcIkRpZSBGZWxka29udHJvbGxlICdcIiArIGJlemVpY2hudW5nICsgXCInIHdpcmQgZ2Vsw7ZzY2h0LlwiKTtcclxuXHRcdFx0XHRcdCQoXCIjbG9lc2NoZW5fZGlhbG9nXCIpLmRpYWxvZyh7XHJcblx0XHRcdFx0XHRcdHJlc2l6YWJsZTogZmFsc2UsXHJcblx0XHRcdFx0XHRcdGhlaWdodDonYXV0bycsXHJcblx0XHRcdFx0XHRcdHdpZHRoOiA0MDAsXHJcblx0XHRcdFx0XHRcdG1vZGFsOiB0cnVlLFxyXG5cdFx0XHRcdFx0XHRidXR0b25zOiB7XHJcblx0XHRcdFx0XHRcdFx0XCJqYSwgbMO2c2NoZW4hXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0JCh0aGlzKS5kaWFsb2coXCJjbG9zZVwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIFZhcmlhYmxlIHp1bSByw7xja2fDpG5naWcgbWFjaGVuIGVyc3RlbGxlblxyXG5cdFx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5kZWxldGVkID0gd2luZG93LmFwZi50cG9wZmVsZGtvbnRyO1xyXG5cdFx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5kZWxldGVkLnR5cCA9IFwidHBvcGZlbGRrb250clwiO1xyXG5cdFx0XHRcdFx0XHRcdFx0dmFyIGRlbGV0ZVRQb3BGZWxkS29udHIgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHRcdFx0XHRcdFx0XHRcdHVybDogJ3BocC90cG9wZmVsZGtvbnRyX2RlbGV0ZS5waHAnLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XCJpZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwiaWRcIikpXHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0ZGVsZXRlVFBvcEZlbGRLb250ci5hbHdheXMoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGRlbGV0ZSBsb2NhbFN0b3JhZ2UudHBvcGZlbGRrb250cl9pZDtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYudHBvcGZlbGRrb250cjtcclxuXHRcdFx0XHRcdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLmRlbGV0ZV9ub2RlKGFrdGl2ZXJfbm9kZSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vIFBhcmVudCBOb2RlLUJlc2NocmlmdHVuZzogQW56YWhsIGFucGFzc2VuXHJcblx0XHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuYmVzY2hyaWZ0ZV9vcmRuZXJfdHBvcGZlbGRrb250cihwYXJlbnRfbm9kZSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vIEhpbndlaXMgenVtIHLDvGNrZ8OkbmdpZyBtYWNoZW4gYW56ZWlnZW5cclxuXHRcdFx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5mcmFnZU9iQWt0aW9uUsO8Y2tnw6RuZ2lnR2VtYWNodFdlcmRlblNvbGwoXCJEaWUgRmVsZGtvbnRyb2xsZSAnXCIgKyBiZXplaWNobnVuZyArIFwiJyB3dXJkZSBnZWzDtnNjaHQuXCIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0XHRkZWxldGVUUG9wRmVsZEtvbnRyLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogRGllIEZlbGRrb250cm9sbGUgd3VyZGUgbmljaHQgZ2Vsw7ZzY2h0XCIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBEaWUgRmVsZGtvbnRyb2xsZSB3dXJkZSBuaWNodCBnZWzDtnNjaHQnKTtcclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdFx0XCJhYmJyZWNoZW5cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHQkKHRoaXMpLmRpYWxvZyhcImNsb3NlXCIpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LFxyXG5cdFx0XHRcImJpb3RvcF9rb3BpZXJlblwiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcIkJpb3RvcCBrb3BpZXJlblwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9rb3BpZXJlbi5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdC8vIG51ciBha3R1YWxpc2llcmVuLCB3ZW5uIFNjaHJlaWJyZWNodGUgYmVzdGVoZW5cclxuXHRcdFx0XHRcdGlmICghd2luZG93LmFwZi5wcsO8ZmVTY2hyZWlidm9yYXVzc2V0enVuZ2VuKCkpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYuZmVsZGtvbnRyX2Jpb3RvcDtcclxuXHRcdFx0XHRcdHdpbmRvdy5hcGYuZmVsZGtvbnRyX2Jpb3RvcCA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciAkVFBvcEtvbnRyRmxhZWNoZSA9ICQoXCIjVFBvcEtvbnRyRmxhZWNoZVwiKTtcclxuXHRcdFx0XHRcdGlmICgkVFBvcEtvbnRyRmxhZWNoZS52YWwoKSkge1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmZlbGRrb250cl9iaW90b3AuVFBvcEtvbnRyRmxhZWNoZSA9ICRUUG9wS29udHJGbGFlY2hlLnZhbCgpO1xyXG5cdFx0XHRcdFx0fVxyXG4gICAgICAgICAgICAgICAgICAgIHZhciAkVFBvcEtvbnRyTGViID0gJChcIiNUUG9wS29udHJMZWJcIik7XHJcblx0XHRcdFx0XHRpZiAoJFRQb3BLb250ckxlYi52YWwoKSkge1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmZlbGRrb250cl9iaW90b3AuVFBvcEtvbnRyTGViID0gJFRQb3BLb250ckxlYi52YWwoKTtcclxuXHRcdFx0XHRcdH1cclxuICAgICAgICAgICAgICAgICAgICB2YXIgJFRQb3BLb250ckxlYlVtZyA9ICQoXCIjVFBvcEtvbnRyTGViVW1nXCIpO1xyXG5cdFx0XHRcdFx0aWYgKCRUUG9wS29udHJMZWJVbWcudmFsKCkpIHtcclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi5mZWxka29udHJfYmlvdG9wLlRQb3BLb250ckxlYlVtZyA9ICRUUG9wS29udHJMZWJVbWcudmFsKCk7XHJcblx0XHRcdFx0XHR9XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyICRUUG9wS29udHJWZWdUeXAgPSAkKFwiI1RQb3BLb250clZlZ1R5cFwiKTtcclxuXHRcdFx0XHRcdGlmICgkVFBvcEtvbnRyVmVnVHlwLnZhbCgpKSB7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZmVsZGtvbnRyX2Jpb3RvcC5UUG9wS29udHJWZWdUeXAgPSAkVFBvcEtvbnRyVmVnVHlwLnZhbCgpO1xyXG5cdFx0XHRcdFx0fVxyXG4gICAgICAgICAgICAgICAgICAgIHZhciAkVFBvcEtvbnRyS29ua3VycmVueiA9ICQoXCIjVFBvcEtvbnRyS29ua3VycmVuelwiKTtcclxuXHRcdFx0XHRcdGlmICgkVFBvcEtvbnRyS29ua3VycmVuei52YWwoKSkge1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmZlbGRrb250cl9iaW90b3AuVFBvcEtvbnRyS29ua3VycmVueiA9ICRUUG9wS29udHJLb25rdXJyZW56LnZhbCgpO1xyXG5cdFx0XHRcdFx0fVxyXG4gICAgICAgICAgICAgICAgICAgIHZhciAkVFBvcEtvbnRyTW9vc3NjaGljaHQgPSAkKFwiI1RQb3BLb250ck1vb3NzY2hpY2h0XCIpO1xyXG5cdFx0XHRcdFx0aWYgKCRUUG9wS29udHJNb29zc2NoaWNodC52YWwoKSkge1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmZlbGRrb250cl9iaW90b3AuVFBvcEtvbnRyTW9vc3NjaGljaHQgPSAkVFBvcEtvbnRyTW9vc3NjaGljaHQudmFsKCk7XHJcblx0XHRcdFx0XHR9XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyICRUUG9wS29udHJLcmF1dHNjaGljaHQgPSAkKFwiI1RQb3BLb250cktyYXV0c2NoaWNodFwiKTtcclxuXHRcdFx0XHRcdGlmICgkVFBvcEtvbnRyS3JhdXRzY2hpY2h0LnZhbCgpKSB7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZmVsZGtvbnRyX2Jpb3RvcC5UUG9wS29udHJLcmF1dHNjaGljaHQgPSAkVFBvcEtvbnRyS3JhdXRzY2hpY2h0LnZhbCgpO1xyXG5cdFx0XHRcdFx0fVxyXG4gICAgICAgICAgICAgICAgICAgIHZhciAkVFBvcEtvbnRyU3RyYXVjaHNjaGljaHQgPSAkKFwiI1RQb3BLb250clN0cmF1Y2hzY2hpY2h0XCIpO1xyXG5cdFx0XHRcdFx0aWYgKCRUUG9wS29udHJTdHJhdWNoc2NoaWNodC52YWwoKSkge1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmZlbGRrb250cl9iaW90b3AuVFBvcEtvbnRyU3RyYXVjaHNjaGljaHQgPSAkVFBvcEtvbnRyU3RyYXVjaHNjaGljaHQudmFsKCk7XHJcblx0XHRcdFx0XHR9XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyICRUUG9wS29udHJCYXVtc2NoaWNodCA9ICQoXCIjVFBvcEtvbnRyQmF1bXNjaGljaHRcIik7XHJcblx0XHRcdFx0XHRpZiAoJFRQb3BLb250ckJhdW1zY2hpY2h0LnZhbCgpKSB7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZmVsZGtvbnRyX2Jpb3RvcC5UUG9wS29udHJCYXVtc2NoaWNodCA9ICRUUG9wS29udHJCYXVtc2NoaWNodC52YWwoKTtcclxuXHRcdFx0XHRcdH1cclxuICAgICAgICAgICAgICAgICAgICB2YXIgJFRQb3BLb250ckJvZGVuVHlwID0gJChcIiNUUG9wS29udHJCb2RlblR5cFwiKTtcclxuXHRcdFx0XHRcdGlmICgkVFBvcEtvbnRyQm9kZW5UeXAudmFsKCkpIHtcclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi5mZWxka29udHJfYmlvdG9wLlRQb3BLb250ckJvZGVuVHlwID0gJFRQb3BLb250ckJvZGVuVHlwLnZhbCgpO1xyXG5cdFx0XHRcdFx0fVxyXG4gICAgICAgICAgICAgICAgICAgIHZhciAkVFBvcEtvbnRyQm9kZW5LYWxrZ2VoYWx0ID0gJChcIiNUUG9wS29udHJCb2RlbkthbGtnZWhhbHRcIik7XHJcblx0XHRcdFx0XHRpZiAoJFRQb3BLb250ckJvZGVuS2Fsa2dlaGFsdC52YWwoKSkge1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmZlbGRrb250cl9iaW90b3AuVFBvcEtvbnRyQm9kZW5LYWxrZ2VoYWx0ID0gJFRQb3BLb250ckJvZGVuS2Fsa2dlaGFsdC52YWwoKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmICgkKFwiI1RQb3BLb250ckJvZGVuRHVyY2hsYWVzc2lna2VpdFwiKS52YWwoKSkge1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmZlbGRrb250cl9iaW90b3AuVFBvcEtvbnRyQm9kZW5EdXJjaGxhZXNzaWdrZWl0ID0gJChcIiNUUG9wS29udHJCb2RlbkR1cmNobGFlc3NpZ2tlaXRcIikudmFsKCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZiAoJChcIiNUUG9wS29udHJCb2Rlbkh1bXVzXCIpLnZhbCgpKSB7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZmVsZGtvbnRyX2Jpb3RvcC5UUG9wS29udHJCb2Rlbkh1bXVzID0gJChcIiNUUG9wS29udHJCb2Rlbkh1bXVzXCIpLnZhbCgpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYgKCQoXCIjVFBvcEtvbnRyQm9kZW5OYWVocnN0b2ZmZ2VoYWx0XCIpLnZhbCgpKSB7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZmVsZGtvbnRyX2Jpb3RvcC5UUG9wS29udHJCb2Rlbk5hZWhyc3RvZmZnZWhhbHQgPSAkKFwiI1RQb3BLb250ckJvZGVuTmFlaHJzdG9mZmdlaGFsdFwiKS52YWwoKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmICgkKFwiI1RQb3BLb250ckJvZGVuQWJ0cmFnXCIpLnZhbCgpKSB7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZmVsZGtvbnRyX2Jpb3RvcC5UUG9wS29udHJCb2RlbkFidHJhZyA9ICQoXCIjVFBvcEtvbnRyQm9kZW5BYnRyYWdcIikudmFsKCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZiAoJChcIiNUUG9wS29udHJXYXNzZXJoYXVzaGFsdFwiKS52YWwoKSkge1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmZlbGRrb250cl9iaW90b3AuVFBvcEtvbnRyV2Fzc2VyaGF1c2hhbHQgPSAkKFwiI1RQb3BLb250cldhc3NlcmhhdXNoYWx0XCIpLnZhbCgpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYgKCQoXCIjVFBvcEtvbnRySGFuZGx1bmdzYmVkYXJmXCIpLnZhbCgpKSB7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZmVsZGtvbnRyX2Jpb3RvcC5UUG9wS29udHJIYW5kbHVuZ3NiZWRhcmYgPSAkKFwiI1RQb3BLb250ckhhbmRsdW5nc2JlZGFyZlwiKS52YWwoKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0XHRpZiAod2luZG93LmFwZi5mZWxka29udHJfYmlvdG9wKSB7XHJcblx0XHRcdGl0ZW1zLmJpb3RvcF9laW5mdWVnZW4gPSB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcIkJpb3RvcCBlaW5mw7xnZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvZWluZnVlZ2VuLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0dmFyIGRhdGEgPSB7fTtcclxuXHRcdFx0XHRcdGRhdGEuaWQgPSB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwiaWRcIikpO1xyXG5cdFx0XHRcdFx0ZGF0YS51c2VyID0gc2Vzc2lvblN0b3JhZ2UuVXNlcjtcclxuXHRcdFx0XHRcdC8vIG51ciBha3R1YWxpc2llcmVuLCB3ZW5uIFNjaHJlaWJyZWNodGUgYmVzdGVoZW5cclxuXHRcdFx0XHRcdGlmICghd2luZG93LmFwZi5wcsO8ZmVTY2hyZWlidm9yYXVzc2V0enVuZ2VuKCkpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0fVxyXG4gICAgICAgICAgICAgICAgICAgIF8uZWFjaCh3aW5kb3cuYXBmLmZlbGRrb250cl9iaW90b3AsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJChcIiNcIiArIGtleSkudmFsKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVtrZXldID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblx0XHRcdFx0XHQvLyBqZXR6dCBhbGxlcyBzcGVpY2hlcm5cclxuXHRcdFx0XHRcdHZhciB1cGRhdGVUUG9wRmVsZEtvbnRyTXVsdGlwbGUgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ3BocC90cG9wZmVsZGtvbnRyX3VwZGF0ZV9tdWx0aXBsZS5waHAnLFxyXG5cdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0XHRkYXRhOiBkYXRhXHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdHVwZGF0ZVRQb3BGZWxkS29udHJNdWx0aXBsZS5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IERhcyBrb3BpZXJ0ZSBCaW90b3Agd3VyZGUgbmljaHQgZWluZ2Vmw7xndFwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogRGFzIGtvcGllcnRlIEJpb3RvcCB3dXJkZSBuaWNodCBlaW5nZWbDvGd0Jyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGlmICghd2luZG93LmFwZi50cG9wZmVsZGtvbnRyX25vZGVfYXVzZ2VzY2huaXR0ZW4pIHtcclxuXHRcdFx0aXRlbXMuYXVzc2NobmVpZGVuID0ge1xyXG5cdFx0XHRcdC8vXCJsYWJlbFwiOiBcIkZlbGRrb250cm9sbGUgYXVzc2NobmVpZGVuPGJyPiZuYnNwOyZuYnNwOyZuYnNwO1RpcHA6IGRyYWcgYW5kIGRyb3AgbWUhXCIsXHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcImF1c3NjaG5laWRlblwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9hdXNzY2huZWlkZW4ucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQvLyBudXIgYWt0dWFsaXNpZXJlbiwgd2VubiBTY2hyZWlicmVjaHRlIGJlc3RlaGVuXHJcblx0XHRcdFx0XHRpZiAoIXdpbmRvdy5hcGYucHLDvGZlU2NocmVpYnZvcmF1c3NldHp1bmdlbigpKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHdpbmRvdy5hcGYudHBvcGZlbGRrb250cl9ub2RlX2F1c2dlc2Nobml0dGVuID0gYWt0aXZlcl9ub2RlO1xyXG5cdFx0XHRcdFx0Ly8gZXMgbWFjaHQga2VpbmVuIFNpbm4gbWVociwgZGVuIGtvcGllcnRlbiBub2RlIHp1IGJlaGFsdGVuXHJcblx0XHRcdFx0XHQvLyB1bmQgc3RlbGx0IHNpY2hlciwgZGFzcyBudW4gZGVyIGF1c2dlc2Nobml0dGVuZSBtaXQgXCJlaW5mw7xnZW5cIiBhbmdlYm90ZW4gd2lyZFxyXG5cdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYudHBvcGZlbGRrb250cl9ub2RlX2tvcGllcnQ7XHJcblx0XHRcdFx0XHRkZWxldGUgd2luZG93LmFwZi50cG9wZmVsZGtvbnRyX29iamVrdF9rb3BpZXJ0O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0aWYgKCF3aW5kb3cuYXBmLnRwb3BmZWxka29udHJfbm9kZV9hdXNnZXNjaG5pdHRlbikge1xyXG5cdFx0XHRpdGVtcy5rb3BpZXJlbiA9IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwia29waWVyZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMva29waWVyZW4ucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQvLyBudXIgYWt0dWFsaXNpZXJlbiwgd2VubiBTY2hyZWlicmVjaHRlIGJlc3RlaGVuXHJcblx0XHRcdFx0XHRpZiAoIXdpbmRvdy5hcGYucHLDvGZlU2NocmVpYnZvcmF1c3NldHp1bmdlbigpKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHdpbmRvdy5hcGYudHBvcGZlbGRrb250cl9ub2RlX2tvcGllcnQgPSBha3RpdmVyX25vZGU7XHJcblx0XHRcdFx0XHQvLyBEYXRlbiBkZXMgT2JqZWt0cyBob2xlblxyXG5cdFx0XHRcdFx0dmFyIGdldFRQb3BGZWxka29udHJfMiA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHRcdHR5cGU6ICdnZXQnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvdHBvcGZlbGRrb250ci5waHAnLFxyXG5cdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFx0XCJpZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQod2luZG93LmFwZi50cG9wZmVsZGtvbnRyX25vZGVfa29waWVydCkuYXR0cihcImlkXCIpKVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGdldFRQb3BGZWxka29udHJfMi5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLnRwb3BmZWxka29udHJfb2JqZWt0X2tvcGllcnQgPSBkYXRhO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRnZXRUUG9wRmVsZGtvbnRyXzIuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBEaWUgRmVsZGtvbnRyb2xsZSB3dXJkZSBuaWNodCBrb3BpZXJ0XCIpO1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBEaWUgRmVsZGtvbnRyb2xsZSB3dXJkZSBuaWNodCBrb3BpZXJ0Jyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGlmICh3aW5kb3cuYXBmLnRwb3BmZWxka29udHJfbm9kZV9hdXNnZXNjaG5pdHRlbikge1xyXG5cdFx0XHRpdGVtcy5laW5mdWVnZW4gPSB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiAkLmpzdHJlZS5fcmVmZXJlbmNlKHdpbmRvdy5hcGYudHBvcGZlbGRrb250cl9ub2RlX2F1c2dlc2Nobml0dGVuKS5nZXRfdGV4dCh3aW5kb3cuYXBmLnRwb3BmZWxka29udHJfbm9kZV9hdXNnZXNjaG5pdHRlbikgKyBcIiBlaW5mw7xnZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvZWluZnVlZ2VuLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShwYXJlbnRfbm9kZSkubW92ZV9ub2RlKHdpbmRvdy5hcGYudHBvcGZlbGRrb250cl9ub2RlX2F1c2dlc2Nobml0dGVuLCBwYXJlbnRfbm9kZSwgXCJmaXJzdFwiLCBmYWxzZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRpZiAod2luZG93LmFwZi50cG9wZmVsZGtvbnRyX25vZGVfa29waWVydCkge1xyXG5cdFx0XHRpdGVtcy5laW5mdWVnZW4gPSB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiAkLmpzdHJlZS5fcmVmZXJlbmNlKHdpbmRvdy5hcGYudHBvcGZlbGRrb250cl9ub2RlX2tvcGllcnQpLmdldF90ZXh0KHdpbmRvdy5hcGYudHBvcGZlbGRrb250cl9ub2RlX2tvcGllcnQpICsgXCIgZWluZsO8Z2VuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL2VpbmZ1ZWdlbi5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdC8vIHVuZCBhbiBkaWUgREIgc2NoaWNrZW5cclxuXHRcdFx0XHRcdHZhciBpbnNlcnRUUG9wRmVsZEtvbnRyS29waWVfMiA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHRcdHR5cGU6ICdwb3N0JyxcclxuXHRcdFx0XHRcdFx0dXJsOiAncGhwL3Rwb3BmZWxka29udHJfaW5zZXJ0X2tvcGllLnBocCcsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcInVzZXJcIjogc2Vzc2lvblN0b3JhZ2UuVXNlcixcclxuXHRcdFx0XHRcdFx0XHRcIlRQb3BJZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQocGFyZW50X25vZGUpLmF0dHIoXCJpZFwiKSksXHJcblx0XHRcdFx0XHRcdFx0XCJUUG9wS29udHJJZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQod2luZG93LmFwZi50cG9wZmVsZGtvbnRyX25vZGVfa29waWVydCkuYXR0cihcImlkXCIpKVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydFRQb3BGZWxkS29udHJLb3BpZV8yLmFsd2F5cyhmdW5jdGlvbihpZCkge1xyXG5cdFx0XHRcdFx0XHR2YXIgc3RydWt0dXJ0eXAgPSBcInRwb3BmZWxka29udHJcIixcclxuXHRcdFx0XHRcdFx0XHRiZXNjaHJpZnR1bmcgPSB3aW5kb3cuYXBmLmVyc3RlbGxlTGFiZWxGw7xyRmVsZGtvbnRyb2xsZSh3aW5kb3cuYXBmLnRwb3BmZWxka29udHJfb2JqZWt0X2tvcGllcnQuVFBvcEtvbnRySmFociwgd2luZG93LmFwZi50cG9wZmVsZGtvbnRyX29iamVrdF9rb3BpZXJ0LlRQb3BLb250clR5cCk7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuaW5zZXJ0TmV1ZW5Ob2RlQXVmR2xlaWNoZXJIaWVyYXJjaGllc3R1ZmUoYWt0aXZlcl9ub2RlLCBwYXJlbnRfbm9kZSwgc3RydWt0dXJ0eXAsIGlkLCBiZXNjaHJpZnR1bmcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpbnNlcnRUUG9wRmVsZEtvbnRyS29waWVfMi5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IERpZSBGZWxka29udHJvbGxlIHd1cmRlIG5pY2h0IGVyc3RlbGx0XCIpO1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBEaWUgRmVsZGtvbnRyb2xsZSB3dXJkZSBuaWNodCBlcnN0ZWxsdCcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gaXRlbXM7XHJcblx0Y2FzZSBcInRwb3Bfb3JkbmVyX2ZyZWl3a29udHJcIjpcclxuXHRcdGl0ZW1zID0ge1xyXG5cdFx0XHRcIm5ldVwiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcIm5ldWUgRnJlaXdpbGxpZ2VuLUtvbnRyb2xsZVwiLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9uZXUucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgaW5zZXJ0VFBvcEZlbGRLb250cl8zID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvdHBvcGZlbGRrb250cl9pbnNlcnQucGhwJyxcclxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFwiaWRcIjogd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKGFrdGl2ZXJfbm9kZSkuYXR0cihcImlkXCIpKSxcclxuXHRcdFx0XHRcdFx0XHRcInVzZXJcIjogc2Vzc2lvblN0b3JhZ2UuVXNlcixcclxuXHRcdFx0XHRcdFx0XHRcInR5cFwiOiBcIkZyZWl3aWxsaWdlbi1FcmZvbGdza29udHJvbGxlXCJcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpbnNlcnRUUG9wRmVsZEtvbnRyXzMuYWx3YXlzKGZ1bmN0aW9uKGlkKSB7XHJcblx0XHRcdFx0XHRcdHZhciBzdHJ1a3R1cnR5cCA9IFwidHBvcGZyZWl3a29udHJcIixcclxuXHRcdFx0XHRcdFx0XHRiZXNjaHJpZnR1bmcgPSBcIm5ldWUgRnJlaXdpbGxpZ2VuLUtvbnRyb2xsZVwiO1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmluc2VydE5ldWVuTm9kZUVpbmVIaWVyYXJjaGllc3R1ZmVUaWVmZXIoYWt0aXZlcl9ub2RlLCBwYXJlbnRfbm9kZSwgc3RydWt0dXJ0eXAsIGlkLCBiZXNjaHJpZnR1bmcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpbnNlcnRUUG9wRmVsZEtvbnRyXzMuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBLZWluZSBuZXVlIEZyZWl3aWxsaWdlbi1Lb250cm9sbGUgZXJzdGVsbHRcIik7XHJcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IEtlaW5lIG5ldWUgRnJlaXdpbGxpZ2VuLUtvbnRyb2xsZSBlcnN0ZWxsdCcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cdFx0aWYgKHdpbmRvdy5hcGYudHBvcGZyZWl3a29udHJfbm9kZV9hdXNnZXNjaG5pdHRlbikge1xyXG5cdFx0XHRpdGVtcy5laW5mdWVnZW4gPSB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiAkLmpzdHJlZS5fcmVmZXJlbmNlKHdpbmRvdy5hcGYudHBvcGZyZWl3a29udHJfbm9kZV9hdXNnZXNjaG5pdHRlbikuZ2V0X3RleHQod2luZG93LmFwZi50cG9wZnJlaXdrb250cl9ub2RlX2F1c2dlc2Nobml0dGVuKSArIFwiIGVpbmbDvGdlblwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9laW5mdWVnZW4ucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkubW92ZV9ub2RlKHdpbmRvdy5hcGYudHBvcGZyZWl3a29udHJfbm9kZV9hdXNnZXNjaG5pdHRlbiwgYWt0aXZlcl9ub2RlLCBcImZpcnN0XCIsIGZhbHNlKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGlmICh3aW5kb3cuYXBmLnRwb3BmcmVpd2tvbnRyX25vZGVfa29waWVydCkge1xyXG5cdFx0XHRpdGVtcy5laW5mdWVnZW4gPSB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiAkLmpzdHJlZS5fcmVmZXJlbmNlKHdpbmRvdy5hcGYudHBvcGZyZWl3a29udHJfbm9kZV9rb3BpZXJ0KS5nZXRfdGV4dCh3aW5kb3cuYXBmLnRwb3BmcmVpd2tvbnRyX25vZGVfa29waWVydCkgKyBcIiBlaW5mw7xnZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvZWluZnVlZ2VuLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gdW5kIGFuIGRpZSBEQiBzY2hpY2tlblxyXG5cdFx0XHRcdFx0dmFyIGluc2VydFRQb3BGZWxkS29udHJLb3BpZV8zID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvdHBvcGZlbGRrb250cl9pbnNlcnRfa29waWUucGhwJyxcclxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFwidXNlclwiOiBzZXNzaW9uU3RvcmFnZS5Vc2VyLFxyXG5cdFx0XHRcdFx0XHRcdFwiVFBvcElkXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJChha3RpdmVyX25vZGUpLmF0dHIoXCJpZFwiKSksXHJcblx0XHRcdFx0XHRcdFx0XCJUUG9wS29udHJJZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQod2luZG93LmFwZi50cG9wZnJlaXdrb250cl9ub2RlX2tvcGllcnQpLmF0dHIoXCJpZFwiKSlcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpbnNlcnRUUG9wRmVsZEtvbnRyS29waWVfMy5hbHdheXMoZnVuY3Rpb24oaWQpIHtcclxuXHRcdFx0XHRcdFx0dmFyIHN0cnVrdHVydHlwID0gXCJ0cG9wZnJlaXdrb250clwiLFxyXG5cdFx0XHRcdFx0XHRcdGJlc2NocmlmdHVuZyA9IHdpbmRvdy5hcGYudHBvcGZyZWl3a29udHJfb2JqZWt0X2tvcGllcnQuVFBvcEtvbnRySmFocjtcclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi5pbnNlcnROZXVlbk5vZGVFaW5lSGllcmFyY2hpZXN0dWZlVGllZmVyKGFrdGl2ZXJfbm9kZSwgcGFyZW50X25vZGUsIHN0cnVrdHVydHlwLCBpZCwgYmVzY2hyaWZ0dW5nKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aW5zZXJ0VFBvcEZlbGRLb250cktvcGllXzMuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBEaWUgRnJlaXdpbGxpZ2VuLUtvbnRyb2xsZSB3dXJkZSBuaWNodCBlcnN0ZWxsdFwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogRGllIEZyZWl3aWxsaWdlbi1Lb250cm9sbGUgd3VyZGUgbmljaHQgZXJzdGVsbHQnKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGl0ZW1zO1xyXG5cdGNhc2UgXCJ0cG9wZnJlaXdrb250clwiOlxyXG5cdFx0aXRlbXMgPSB7XHJcblx0XHRcdFwibmV1XCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwibmV1ZSBGcmVpd2lsbGlnZW4tS29udHJvbGxlXCIsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL25ldS5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdHZhciBpbnNlcnRUUG9wRmVsZEtvbnRyXzQgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ3BocC90cG9wZmVsZGtvbnRyX2luc2VydC5waHAnLFxyXG5cdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFx0XCJpZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQocGFyZW50X25vZGUpLmF0dHIoXCJpZFwiKSksXHJcblx0XHRcdFx0XHRcdFx0XCJ1c2VyXCI6IHNlc3Npb25TdG9yYWdlLlVzZXIsXHJcblx0XHRcdFx0XHRcdFx0XCJ0eXBcIjogXCJGcmVpd2lsbGlnZW4tRXJmb2xnc2tvbnRyb2xsZVwiXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aW5zZXJ0VFBvcEZlbGRLb250cl80LmFsd2F5cyhmdW5jdGlvbihpZCkge1xyXG5cdFx0XHRcdFx0XHR2YXIgc3RydWt0dXJ0eXAgPSBcInRwb3BmcmVpd2tvbnRyXCIsXHJcblx0XHRcdFx0XHRcdFx0YmVzY2hyaWZ0dW5nID0gXCJuZXVlIEZyZWl3aWxsaWdlbi1Lb250cm9sbGVcIjtcclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi5pbnNlcnROZXVlbk5vZGVBdWZHbGVpY2hlckhpZXJhcmNoaWVzdHVmZShha3RpdmVyX25vZGUsIHBhcmVudF9ub2RlLCBzdHJ1a3R1cnR5cCwgaWQsIGJlc2NocmlmdHVuZyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydFRQb3BGZWxkS29udHJfNC5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IEtlaW5lIG5ldWUgRnJlaXdpbGxpZ2VuLUtvbnRyb2xsZSBlcnN0ZWxsdFwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogS2VpbmUgbmV1ZSBGcmVpd2lsbGlnZW4tS29udHJvbGxlIGVyc3RlbGx0Jyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sXHJcblx0XHRcdFwibG9lc2NoZW5cIjoge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogXCJsw7ZzY2hlblwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9sb2VzY2hlbi5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdC8vIG51ciBha3R1YWxpc2llcmVuLCB3ZW5uIFNjaHJlaWJyZWNodGUgYmVzdGVoZW5cclxuXHRcdFx0XHRcdGlmICghd2luZG93LmFwZi5wcsO8ZmVTY2hyZWlidm9yYXVzc2V0enVuZ2VuKCkpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0dmFyIGJlemVpY2hudW5nID0gJC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLmdldF90ZXh0KGFrdGl2ZXJfbm9kZSk7XHJcblx0XHRcdFx0XHQkKFwiI2xvZXNjaGVuX2RpYWxvZ19taXR0ZWlsdW5nXCIpLmh0bWwoXCJEaWUgRnJlaXdpbGxpZ2VuLUtvbnRyb2xsZSAnXCIgKyBiZXplaWNobnVuZyArIFwiJyB3aXJkIGdlbMO2c2NodC5cIik7XHJcblx0XHRcdFx0XHQkKFwiI2xvZXNjaGVuX2RpYWxvZ1wiKS5kaWFsb2coe1xyXG5cdFx0XHRcdFx0XHRyZXNpemFibGU6IGZhbHNlLFxyXG5cdFx0XHRcdFx0XHRoZWlnaHQ6J2F1dG8nLFxyXG5cdFx0XHRcdFx0XHR3aWR0aDogNDAwLFxyXG5cdFx0XHRcdFx0XHRtb2RhbDogdHJ1ZSxcclxuXHRcdFx0XHRcdFx0YnV0dG9uczoge1xyXG5cdFx0XHRcdFx0XHRcdFwiamEsIGzDtnNjaGVuIVwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdCQodGhpcykuZGlhbG9nKFwiY2xvc2VcIik7XHJcblx0XHRcdFx0XHRcdFx0XHQvLyBWYXJpYWJsZSB6dW0gcsO8Y2tnw6RuZ2lnIG1hY2hlbiBlcnN0ZWxsZW5cclxuXHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZGVsZXRlZCA9IHdpbmRvdy5hcGYudHBvcGZlbGRrb250cjtcclxuXHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZGVsZXRlZC50eXAgPSBcInRwb3BmcmVpd2tvbnRyXCI7XHJcblx0XHRcdFx0XHRcdFx0XHR2YXIgZGVsZXRlVFBvcEZlbGRLb250cl8yID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHR1cmw6ICdwaHAvdHBvcGZlbGRrb250cl9kZWxldGUucGhwJyxcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFwiaWRcIjogd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKGFrdGl2ZXJfbm9kZSkuYXR0cihcImlkXCIpKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0XHRcdGRlbGV0ZVRQb3BGZWxkS29udHJfMi5hbHdheXMoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGRlbGV0ZSBsb2NhbFN0b3JhZ2UudHBvcGZlbGRrb250cl9pZDtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZGVsZXRlIGxvY2FsU3RvcmFnZS50cG9wZnJlaXdrb250cjtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYudHBvcGZlbGRrb250cjtcclxuXHRcdFx0XHRcdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLmRlbGV0ZV9ub2RlKGFrdGl2ZXJfbm9kZSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vIFBhcmVudCBOb2RlLUJlc2NocmlmdHVuZzogQW56YWhsIGFucGFzc2VuXHJcblx0XHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuYmVzY2hyaWZ0ZV9vcmRuZXJfdHBvcGZyZWl3a29udHIocGFyZW50X25vZGUpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBIaW53ZWlzIHp1bSByw7xja2fDpG5naWcgbWFjaGVuIGFuemVpZ2VuXHJcblx0XHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZnJhZ2VPYkFrdGlvblLDvGNrZ8OkbmdpZ0dlbWFjaHRXZXJkZW5Tb2xsKFwiRGllIEZyZWl3aWxsaWdlbi1Lb250cm9sbGUgJ1wiICsgYmV6ZWljaG51bmcgKyBcIicgd3VyZGUgZ2Vsw7ZzY2h0LlwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0ZGVsZXRlVFBvcEZlbGRLb250cl8yLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogRGllIEZyZWl3aWxsaWdlbi1Lb250cm9sbGUgd3VyZGUgbmljaHQgZ2Vsw7ZzY2h0XCIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBEaWUgRnJlaXdpbGxpZ2VuLUtvbnRyb2xsZSB3dXJkZSBuaWNodCBnZWzDtnNjaHQnKTtcclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdFx0XCJhYmJyZWNoZW5cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHQkKHRoaXMpLmRpYWxvZyhcImNsb3NlXCIpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cdFx0aWYgKCF3aW5kb3cuYXBmLnRwb3BmcmVpd2tvbnRyX25vZGVfYXVzZ2VzY2huaXR0ZW4pIHtcclxuXHRcdFx0aXRlbXMuYXVzc2NobmVpZGVuID0ge1xyXG5cdFx0XHRcdC8vXCJsYWJlbFwiOiBcImF1c3NjaG5laWRlbjxicj4mbmJzcDsmbmJzcDsmbmJzcDtUaXBwOiBkcmFnIGFuZCBkcm9wIG1lIVwiLFxyXG5cdFx0XHRcdFwibGFiZWxcIjogXCJhdXNzY2huZWlkZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvYXVzc2NobmVpZGVuLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gbnVyIGFrdHVhbGlzaWVyZW4sIHdlbm4gU2NocmVpYnJlY2h0ZSBiZXN0ZWhlblxyXG5cdFx0XHRcdFx0aWYgKCF3aW5kb3cuYXBmLnByw7xmZVNjaHJlaWJ2b3JhdXNzZXR6dW5nZW4oKSkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLnRwb3BmcmVpd2tvbnRyX25vZGVfYXVzZ2VzY2huaXR0ZW4gPSBha3RpdmVyX25vZGU7XHJcblx0XHRcdFx0XHQvLyBlcyBtYWNodCBrZWluZW4gU2lubiBtZWhyLCBkZW4ga29waWVydGVuIG5vZGUgenUgYmVoYWx0ZW5cclxuXHRcdFx0XHRcdC8vIHVuZCBzdGVsbHQgc2ljaGVyLCBkYXNzIG51biBkZXIgYXVzZ2VzY2huaXR0ZW5lIG1pdCBcImVpbmbDvGdlblwiIGFuZ2Vib3RlbiB3aXJkXHJcblx0XHRcdFx0XHRkZWxldGUgd2luZG93LmFwZi50cG9wZnJlaXdrb250cl9ub2RlX2tvcGllcnQ7XHJcblx0XHRcdFx0XHRkZWxldGUgd2luZG93LmFwZi50cG9wZnJlaXdrb250cl9vYmpla3Rfa29waWVydDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGlmICghd2luZG93LmFwZi50cG9wZnJlaXdrb250cl9ub2RlX2F1c2dlc2Nobml0dGVuKSB7XHJcblx0XHRcdGl0ZW1zLmtvcGllcmVuID0ge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogXCJrb3BpZXJlblwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9rb3BpZXJlbi5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdC8vIG51ciBha3R1YWxpc2llcmVuLCB3ZW5uIFNjaHJlaWJyZWNodGUgYmVzdGVoZW5cclxuXHRcdFx0XHRcdGlmICghd2luZG93LmFwZi5wcsO8ZmVTY2hyZWlidm9yYXVzc2V0enVuZ2VuKCkpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0d2luZG93LmFwZi50cG9wZnJlaXdrb250cl9ub2RlX2tvcGllcnQgPSBha3RpdmVyX25vZGU7XHJcblx0XHRcdFx0XHQvLyBEYXRlbiBkZXMgT2JqZWt0cyBob2xlblxyXG5cdFx0XHRcdFx0dmFyIGdldFRQb3BGZWxka29udHJfMyA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHRcdHR5cGU6ICdnZXQnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvdHBvcGZlbGRrb250ci5waHAnLFxyXG5cdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFx0XCJpZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQod2luZG93LmFwZi50cG9wZnJlaXdrb250cl9ub2RlX2tvcGllcnQpLmF0dHIoXCJpZFwiKSlcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRnZXRUUG9wRmVsZGtvbnRyXzMuYWx3YXlzKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi50cG9wZnJlaXdrb250cl9vYmpla3Rfa29waWVydCA9IGRhdGE7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGdldFRQb3BGZWxka29udHJfMy5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IERpZSBGcmVpd2lsbGlnZW4tS29udHJvbGxlIHd1cmRlIG5pY2h0IGtvcGllcnRcIik7XHJcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IERpZSBGcmVpd2lsbGlnZW4tS29udHJvbGxlIHd1cmRlIG5pY2h0IGtvcGllcnQnKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0aWYgKHdpbmRvdy5hcGYudHBvcGZyZWl3a29udHJfbm9kZV9hdXNnZXNjaG5pdHRlbikge1xyXG5cdFx0XHRpdGVtcy5laW5mdWVnZW4gPSB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiAkLmpzdHJlZS5fcmVmZXJlbmNlKHdpbmRvdy5hcGYudHBvcGZyZWl3a29udHJfbm9kZV9hdXNnZXNjaG5pdHRlbikuZ2V0X3RleHQod2luZG93LmFwZi50cG9wZnJlaXdrb250cl9ub2RlX2F1c2dlc2Nobml0dGVuKSArIFwiIGVpbmbDvGdlblwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9laW5mdWVnZW4ucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKHBhcmVudF9ub2RlKS5tb3ZlX25vZGUod2luZG93LmFwZi50cG9wZnJlaXdrb250cl9ub2RlX2F1c2dlc2Nobml0dGVuLCBwYXJlbnRfbm9kZSwgXCJmaXJzdFwiLCBmYWxzZSk7XHJcblx0XHRcdFx0XHRsb2NhbFN0b3JhZ2UudHBvcGZyZWl3a29udHIgPSB0cnVlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0aWYgKHdpbmRvdy5hcGYudHBvcGZyZWl3a29udHJfbm9kZV9rb3BpZXJ0KSB7XHJcblx0XHRcdGl0ZW1zLmVpbmZ1ZWdlbiA9IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6ICQuanN0cmVlLl9yZWZlcmVuY2Uod2luZG93LmFwZi50cG9wZnJlaXdrb250cl9ub2RlX2tvcGllcnQpLmdldF90ZXh0KHdpbmRvdy5hcGYudHBvcGZyZWl3a29udHJfbm9kZV9rb3BpZXJ0KSArIFwiIGVpbmbDvGdlblwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9laW5mdWVnZW4ucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgaW5zZXJ0VFBvcEZlbGRLb250cktvcGllXzQgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ3BocC90cG9wZmVsZGtvbnRyX2luc2VydF9rb3BpZS5waHAnLFxyXG5cdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFx0XCJ1c2VyXCI6IHNlc3Npb25TdG9yYWdlLlVzZXIsXHJcblx0XHRcdFx0XHRcdFx0XCJUUG9wSWRcIjogd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKHBhcmVudF9ub2RlKS5hdHRyKFwiaWRcIikpLFxyXG5cdFx0XHRcdFx0XHRcdFwiVFBvcEtvbnRySWRcIjogd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKHdpbmRvdy5hcGYudHBvcGZyZWl3a29udHJfbm9kZV9rb3BpZXJ0KS5hdHRyKFwiaWRcIikpXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aW5zZXJ0VFBvcEZlbGRLb250cktvcGllXzQuYWx3YXlzKGZ1bmN0aW9uKGlkKSB7XHJcblx0XHRcdFx0XHRcdHZhciBzdHJ1a3R1cnR5cCA9IFwidHBvcGZyZWl3a29udHJcIixcclxuXHRcdFx0XHRcdFx0XHRiZXNjaHJpZnR1bmcgPSB3aW5kb3cuYXBmLnRwb3BmcmVpd2tvbnRyX29iamVrdF9rb3BpZXJ0LlRQb3BLb250ckphaHI7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuaW5zZXJ0TmV1ZW5Ob2RlQXVmR2xlaWNoZXJIaWVyYXJjaGllc3R1ZmUoYWt0aXZlcl9ub2RlLCBwYXJlbnRfbm9kZSwgc3RydWt0dXJ0eXAsIGlkLCBiZXNjaHJpZnR1bmcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpbnNlcnRUUG9wRmVsZEtvbnRyS29waWVfNC5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IERpZSBGcmVpd2lsbGlnZW4tS29udHJvbGxlIHd1cmRlIG5pY2h0IGVyc3RlbGx0XCIpO1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBEaWUgRnJlaXdpbGxpZ2VuLUtvbnRyb2xsZSB3dXJkZSBuaWNodCBlcnN0ZWxsdCcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gaXRlbXM7XHJcblx0Y2FzZSBcInRwb3Bfb3JkbmVyX21hc3NuXCI6XHJcblx0XHRpdGVtcyA9IHtcclxuXHRcdFx0XCJuZXVcIjoge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogXCJuZXVlIE1hc3NuYWhtZVwiLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9uZXUucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgaW5zZXJ0VFBvcE1hc3NuID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvdHBvcG1hc3NuX2luc2VydC5waHAnLFxyXG5cdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFx0XCJpZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwiaWRcIikpLFxyXG5cdFx0XHRcdFx0XHRcdFwidHlwXCI6IFwidHBvcG1hc3NuXCIsXHJcblx0XHRcdFx0XHRcdFx0XCJ1c2VyXCI6IHNlc3Npb25TdG9yYWdlLlVzZXJcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpbnNlcnRUUG9wTWFzc24uYWx3YXlzKGZ1bmN0aW9uKGlkKSB7XHJcblx0XHRcdFx0XHRcdHZhciBzdHJ1a3R1cnR5cCA9IFwidHBvcG1hc3NuXCIsXHJcblx0XHRcdFx0XHRcdFx0YmVzY2hyaWZ0dW5nID0gXCJuZXVlIE1hc3NuYWhtZVwiO1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmluc2VydE5ldWVuTm9kZUVpbmVIaWVyYXJjaGllc3R1ZmVUaWVmZXIoYWt0aXZlcl9ub2RlLCBwYXJlbnRfbm9kZSwgc3RydWt0dXJ0eXAsIGlkLCBiZXNjaHJpZnR1bmcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpbnNlcnRUUG9wTWFzc24uZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBLZWluZSBuZXVlIE1hc3NuYWhtZSBlcnN0ZWxsdFwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogS2VpbmUgbmV1ZSBNYXNzbmFobWUgZXJzdGVsbHQnKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHRcdGlmICh3aW5kb3cuYXBmLnRwb3BtYXNzbl9ub2RlX2F1c2dlc2Nobml0dGVuKSB7XHJcblx0XHRcdGl0ZW1zLmVpbmZ1ZWdlbiA9IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6ICQuanN0cmVlLl9yZWZlcmVuY2Uod2luZG93LmFwZi50cG9wbWFzc25fbm9kZV9hdXNnZXNjaG5pdHRlbikuZ2V0X3RleHQod2luZG93LmFwZi50cG9wbWFzc25fbm9kZV9hdXNnZXNjaG5pdHRlbikgKyBcIiBlaW5mw7xnZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvZWluZnVlZ2VuLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLm1vdmVfbm9kZSh3aW5kb3cuYXBmLnRwb3BtYXNzbl9ub2RlX2F1c2dlc2Nobml0dGVuLCBha3RpdmVyX25vZGUsIFwiZmlyc3RcIiwgZmFsc2UpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0aWYgKHdpbmRvdy5hcGYudHBvcG1hc3NuX25vZGVfa29waWVydCkge1xyXG5cdFx0XHRpdGVtcy5laW5mdWVnZW4gPSB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiAkLmpzdHJlZS5fcmVmZXJlbmNlKHdpbmRvdy5hcGYudHBvcG1hc3NuX25vZGVfa29waWVydCkuZ2V0X3RleHQod2luZG93LmFwZi50cG9wbWFzc25fbm9kZV9rb3BpZXJ0KSArIFwiIGVpbmbDvGdlblwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9laW5mdWVnZW4ucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgaW5zZXJ0VFBvcE1hc3NuS29waWUgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ3BocC90cG9wbWFzc25faW5zZXJ0X2tvcGllLnBocCcsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcInVzZXJcIjogc2Vzc2lvblN0b3JhZ2UuVXNlcixcclxuXHRcdFx0XHRcdFx0XHRcIlRQb3BJZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwiaWRcIikpLFxyXG5cdFx0XHRcdFx0XHRcdFwiVFBvcE1hc3NuSWRcIjogd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKHdpbmRvdy5hcGYudHBvcG1hc3NuX25vZGVfa29waWVydCkuYXR0cihcImlkXCIpKVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydFRQb3BNYXNzbktvcGllLmFsd2F5cyhmdW5jdGlvbihpZCkge1xyXG5cdFx0XHRcdFx0XHR2YXIgc3RydWt0dXJ0eXAgPSBcInRwb3BtYXNzblwiLFxyXG5cdFx0XHRcdFx0XHRcdGJlc2NocmlmdHVuZyA9IHdpbmRvdy5hcGYuZXJzdGVsbGVMYWJlbEbDvHJNYXNzbmFobWUod2luZG93LmFwZi50cG9wbWFzc25fb2JqZWt0X2tvcGllcnQuVFBvcE1hc3NuSmFociwgd2luZG93LmFwZi50cG9wbWFzc25fb2JqZWt0X2tvcGllcnQuVFBvcE1hc3NuQmVyRXJmb2xnc2JldXJ0ZWlsdW5nX3R4dCk7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuaW5zZXJ0TmV1ZW5Ob2RlRWluZUhpZXJhcmNoaWVzdHVmZVRpZWZlcihha3RpdmVyX25vZGUsIHBhcmVudF9ub2RlLCBzdHJ1a3R1cnR5cCwgaWQsIGJlc2NocmlmdHVuZyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydFRQb3BNYXNzbktvcGllLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogRGllIE1hc3NuYWhtZSB3dXJkZSBuaWNodCBlcnN0ZWxsdFwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogRGllIE1hc3NuYWhtZSB3dXJkZSBuaWNodCBlcnN0ZWxsdCcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gaXRlbXM7XHJcblx0Y2FzZSBcInRwb3BtYXNzblwiOlxyXG5cdFx0aXRlbXMgPSB7XHJcblx0XHRcdFwibmV1XCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwibmV1ZSBNYXNzbmFobWVcIixcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvbmV1LnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0dmFyIGluc2VydFRQb3BNYXNzbl8yID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvdHBvcG1hc3NuX2luc2VydC5waHAnLFxyXG5cdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFx0XCJpZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQocGFyZW50X25vZGUpLmF0dHIoXCJpZFwiKSksXHJcblx0XHRcdFx0XHRcdFx0XCJ0eXBcIjogXCJ0cG9wbWFzc25cIixcclxuXHRcdFx0XHRcdFx0XHRcInVzZXJcIjogc2Vzc2lvblN0b3JhZ2UuVXNlclxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydFRQb3BNYXNzbl8yLmFsd2F5cyhmdW5jdGlvbihpZCkge1xyXG5cdFx0XHRcdFx0XHR2YXIgc3RydWt0dXJ0eXAgPSBcInRwb3BtYXNzblwiLFxyXG5cdFx0XHRcdFx0XHRcdGJlc2NocmlmdHVuZyA9IFwibmV1ZSBNYXNzbmFobWVcIjtcclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi5pbnNlcnROZXVlbk5vZGVBdWZHbGVpY2hlckhpZXJhcmNoaWVzdHVmZShha3RpdmVyX25vZGUsIHBhcmVudF9ub2RlLCBzdHJ1a3R1cnR5cCwgaWQsIGJlc2NocmlmdHVuZyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydFRQb3BNYXNzbl8yLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogS2VpbmUgbmV1ZSBNYXNzbmFobWUgZXJzdGVsbHRcIik7XHJcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IEtlaW5lIG5ldWUgTWFzc25haG1lIGVyc3RlbGx0Jyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sXHJcblx0XHRcdFwibG9lc2NoZW5cIjoge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogXCJsw7ZzY2hlblwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9sb2VzY2hlbi5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdC8vIG51ciBha3R1YWxpc2llcmVuLCB3ZW5uIFNjaHJlaWJyZWNodGUgYmVzdGVoZW5cclxuXHRcdFx0XHRcdGlmICghd2luZG93LmFwZi5wcsO8ZmVTY2hyZWlidm9yYXVzc2V0enVuZ2VuKCkpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0dmFyIGJlemVpY2hudW5nID0gJC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLmdldF90ZXh0KGFrdGl2ZXJfbm9kZSk7XHJcblx0XHRcdFx0XHQkKFwiI2xvZXNjaGVuX2RpYWxvZ19taXR0ZWlsdW5nXCIpLmh0bWwoXCJEaWUgTWFzc25haG1lICdcIiArIGJlemVpY2hudW5nICsgXCInIHdpcmQgZ2Vsw7ZzY2h0LlwiKTtcclxuXHRcdFx0XHRcdCQoXCIjbG9lc2NoZW5fZGlhbG9nXCIpLmRpYWxvZyh7XHJcblx0XHRcdFx0XHRcdHJlc2l6YWJsZTogZmFsc2UsXHJcblx0XHRcdFx0XHRcdGhlaWdodDonYXV0bycsXHJcblx0XHRcdFx0XHRcdHdpZHRoOiA0MDAsXHJcblx0XHRcdFx0XHRcdG1vZGFsOiB0cnVlLFxyXG5cdFx0XHRcdFx0XHRidXR0b25zOiB7XHJcblx0XHRcdFx0XHRcdFx0XCJqYSwgbMO2c2NoZW4hXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0JCh0aGlzKS5kaWFsb2coXCJjbG9zZVwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIFZhcmlhYmxlIHp1bSByw7xja2fDpG5naWcgbWFjaGVuIGVyc3RlbGxlblxyXG5cdFx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5kZWxldGVkID0gd2luZG93LmFwZi50cG9wbWFzc247XHJcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmRlbGV0ZWQudHlwID0gXCJ0cG9wbWFzc25cIjtcclxuXHRcdFx0XHRcdFx0XHRcdHZhciBkZWxldGVUUG9wTWFzc24gPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHRcdFx0XHRcdFx0XHRcdHVybDogJ3BocC90cG9wbWFzc25fZGVsZXRlLnBocCcsXHJcblx0XHRcdFx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcImlkXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJChha3RpdmVyX25vZGUpLmF0dHIoXCJpZFwiKSlcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0XHRkZWxldGVUUG9wTWFzc24uYWx3YXlzKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRkZWxldGUgbG9jYWxTdG9yYWdlLnRwb3BtYXNzbl9pZDtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5hcGYudHBvcG1hc3NuO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkuZGVsZXRlX25vZGUoYWt0aXZlcl9ub2RlKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gUGFyZW50IE5vZGUtQmVzY2hyaWZ0dW5nOiBBbnphaGwgYW5wYXNzZW5cclxuXHRcdFx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl90cG9wbWFzc24ocGFyZW50X25vZGUpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBIaW53ZWlzIHp1bSByw7xja2fDpG5naWcgbWFjaGVuIGFuemVpZ2VuXHJcblx0XHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZnJhZ2VPYkFrdGlvblLDvGNrZ8OkbmdpZ0dlbWFjaHRXZXJkZW5Tb2xsKFwiRGllIE1hc3NuYWhtZSAnXCIgKyBiZXplaWNobnVuZyArIFwiJyB3dXJkZSBnZWzDtnNjaHQuXCIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0XHRkZWxldGVUUG9wTWFzc24uZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBEaWUgTWFzc25haG1lIHd1cmRlIG5pY2h0IGdlbMO2c2NodFwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogRGllIE1hc3NuYWhtZSB3dXJkZSBuaWNodCBnZWzDtnNjaHQnKTtcclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdFx0XCJhYmJyZWNoZW5cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHQkKHRoaXMpLmRpYWxvZyhcImNsb3NlXCIpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cdFx0aWYgKCF3aW5kb3cuYXBmLnRwb3BtYXNzbl9ub2RlX2F1c2dlc2Nobml0dGVuKSB7XHJcblx0XHRcdGl0ZW1zLmF1c3NjaG5laWRlbiA9IHtcclxuXHRcdFx0XHQvL1wibGFiZWxcIjogXCJhdXNzY2huZWlkZW48YnI+Jm5ic3A7Jm5ic3A7Jm5ic3A7VGlwcDogZHJhZyBhbmQgZHJvcCBtZSFcIixcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwiYXVzc2NobmVpZGVuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL2F1c3NjaG5laWRlbi5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdC8vIG51ciBha3R1YWxpc2llcmVuLCB3ZW5uIFNjaHJlaWJyZWNodGUgYmVzdGVoZW5cclxuXHRcdFx0XHRcdGlmICghd2luZG93LmFwZi5wcsO8ZmVTY2hyZWlidm9yYXVzc2V0enVuZ2VuKCkpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0d2luZG93LmFwZi50cG9wbWFzc25fbm9kZV9hdXNnZXNjaG5pdHRlbiA9IGFrdGl2ZXJfbm9kZTtcclxuXHRcdFx0XHRcdC8vIGVzIG1hY2h0IGtlaW5lbiBTaW5uIG1laHIsIGRlbiBrb3BpZXJ0ZW4gbm9kZSB6dSBiZWhhbHRlblxyXG5cdFx0XHRcdFx0Ly8gdW5kIHN0ZWxsdCBzaWNoZXIsIGRhc3MgbnVuIGRlciBhdXNnZXNjaG5pdHRlbmUgbWl0IFwiZWluZsO8Z2VuXCIgYW5nZWJvdGVuIHdpcmRcclxuXHRcdFx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLnRwb3BtYXNzbl9ub2RlX2tvcGllcnQ7XHJcblx0XHRcdFx0XHRkZWxldGUgd2luZG93LmFwZi50cG9wbWFzc25fb2JqZWt0X2tvcGllcnQ7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRpZiAoIXdpbmRvdy5hcGYudHBvcG1hc3NuX25vZGVfYXVzZ2VzY2huaXR0ZW4pIHtcclxuXHRcdFx0aXRlbXMua29waWVyZW4gPSB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcImtvcGllcmVuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL2tvcGllcmVuLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gbnVyIGFrdHVhbGlzaWVyZW4sIHdlbm4gU2NocmVpYnJlY2h0ZSBiZXN0ZWhlblxyXG5cdFx0XHRcdFx0aWYgKCF3aW5kb3cuYXBmLnByw7xmZVNjaHJlaWJ2b3JhdXNzZXR6dW5nZW4oKSkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLnRwb3BtYXNzbl9ub2RlX2tvcGllcnQgPSBha3RpdmVyX25vZGU7XHJcblx0XHRcdFx0XHQvLyBEYXRlbiBkZXMgT2JqZWt0cyBob2xlblxyXG5cdFx0XHRcdFx0dmFyIGdldFRQb3BNYXNzbl8yID0gJC5hamF4KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdnZXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAncGhwL3Rwb3BtYXNzbi5waHAnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJCh3aW5kb3cuYXBmLnRwb3BtYXNzbl9ub2RlX2tvcGllcnQpLmF0dHIoXCJpZFwiKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRUUG9wTWFzc25UeXBDaGVja2VkID0gJChcIiNUUG9wTWFzc25UeXAgb3B0aW9uOmNoZWNrZWRcIik7XHJcblx0XHRcdFx0XHRnZXRUUG9wTWFzc25fMi5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLnRwb3BtYXNzbl9vYmpla3Rfa29waWVydCA9IGRhdGE7XHJcblx0XHRcdFx0XHRcdC8vIGRlbiBCZXVydGVpbHVuZ3N0ZXh0IGhvbGVuIC0gaXN0IG51ciBtw7xoc2FtIGF1cyBkZXIgREIgenUgaG9sZW5cclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi50cG9wbWFzc25fb2JqZWt0X2tvcGllcnQuVFBvcE1hc3NuQmVyRXJmb2xnc2JldXJ0ZWlsdW5nX3R4dCA9IFwiXCI7XHJcblx0XHRcdFx0XHRcdGlmICgkVFBvcE1hc3NuVHlwQ2hlY2tlZC50ZXh0KCkpIHtcclxuXHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLnRwb3BtYXNzbl9vYmpla3Rfa29waWVydC5UUG9wTWFzc25CZXJFcmZvbGdzYmV1cnRlaWx1bmdfdHh0ID0gJFRQb3BNYXNzblR5cENoZWNrZWQudGV4dCgpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGdldFRQb3BNYXNzbl8yLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogRGllIE1hc3NuYWhtZSB3dXJkZSBuaWNodCBrb3BpZXJ0XCIpO1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBEaWUgTWFzc25haG1lIHd1cmRlIG5pY2h0IGtvcGllcnQnKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0aWYgKHdpbmRvdy5hcGYudHBvcG1hc3NuX25vZGVfYXVzZ2VzY2huaXR0ZW4pIHtcclxuXHRcdFx0aXRlbXMuZWluZnVlZ2VuID0ge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogJC5qc3RyZWUuX3JlZmVyZW5jZSh3aW5kb3cuYXBmLnRwb3BtYXNzbl9ub2RlX2F1c2dlc2Nobml0dGVuKS5nZXRfdGV4dCh3aW5kb3cuYXBmLnRwb3BtYXNzbl9ub2RlX2F1c2dlc2Nobml0dGVuKSArIFwiIGVpbmbDvGdlblwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9laW5mdWVnZW4ucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKHBhcmVudF9ub2RlKS5tb3ZlX25vZGUod2luZG93LmFwZi50cG9wbWFzc25fbm9kZV9hdXNnZXNjaG5pdHRlbiwgcGFyZW50X25vZGUsIFwiZmlyc3RcIiwgZmFsc2UpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0aWYgKHdpbmRvdy5hcGYudHBvcG1hc3NuX25vZGVfa29waWVydCkge1xyXG5cdFx0XHRpdGVtcy5laW5mdWVnZW4gPSB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiAkLmpzdHJlZS5fcmVmZXJlbmNlKHdpbmRvdy5hcGYudHBvcG1hc3NuX25vZGVfa29waWVydCkuZ2V0X3RleHQod2luZG93LmFwZi50cG9wbWFzc25fbm9kZV9rb3BpZXJ0KSArIFwiIGVpbmbDvGdlblwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9laW5mdWVnZW4ucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgaW5zZXJ0VFBvcE1hc3NuS29waWVfMiA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHRcdHR5cGU6ICdwb3N0JyxcclxuXHRcdFx0XHRcdFx0dXJsOiAncGhwL3Rwb3BtYXNzbl9pbnNlcnRfa29waWUucGhwJyxcclxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFwidXNlclwiOiBzZXNzaW9uU3RvcmFnZS5Vc2VyLFxyXG5cdFx0XHRcdFx0XHRcdFwiVFBvcElkXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJChwYXJlbnRfbm9kZSkuYXR0cihcImlkXCIpKSxcclxuXHRcdFx0XHRcdFx0XHRcIlRQb3BNYXNzbklkXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJCh3aW5kb3cuYXBmLnRwb3BtYXNzbl9ub2RlX2tvcGllcnQpLmF0dHIoXCJpZFwiKSlcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpbnNlcnRUUG9wTWFzc25Lb3BpZV8yLmFsd2F5cyhmdW5jdGlvbihpZCkge1xyXG5cdFx0XHRcdFx0XHR2YXIgc3RydWt0dXJ0eXAgPSBcInRwb3BtYXNzblwiLFxyXG5cdFx0XHRcdFx0XHRcdGJlc2NocmlmdHVuZyA9IHdpbmRvdy5hcGYuZXJzdGVsbGVMYWJlbEbDvHJNYXNzbmFobWUod2luZG93LmFwZi50cG9wbWFzc25fb2JqZWt0X2tvcGllcnQuVFBvcE1hc3NuSmFociwgd2luZG93LmFwZi50cG9wbWFzc25fb2JqZWt0X2tvcGllcnQuVFBvcE1hc3NuQmVyRXJmb2xnc2JldXJ0ZWlsdW5nX3R4dCk7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuaW5zZXJ0TmV1ZW5Ob2RlQXVmR2xlaWNoZXJIaWVyYXJjaGllc3R1ZmUoYWt0aXZlcl9ub2RlLCBwYXJlbnRfbm9kZSwgc3RydWt0dXJ0eXAsIGlkLCBiZXNjaHJpZnR1bmcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpbnNlcnRUUG9wTWFzc25Lb3BpZV8yLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogRGllIE1hc3NuYWhtZSB3dXJkZSBuaWNodCBlcnN0ZWxsdFwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogRGllIE1hc3NuYWhtZSB3dXJkZSBuaWNodCBlcnN0ZWxsdCcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gaXRlbXM7XHJcblx0Y2FzZSBcInRwb3Bfb3JkbmVyX3Rwb3BiZXJcIjpcclxuXHRcdGl0ZW1zID0ge1xyXG5cdFx0XHRcIm5ldVwiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcIm5ldWVyIFRlaWxwb3B1bGF0aW9ucy1CZXJpY2h0XCIsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL25ldS5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdHZhciBpbnNlcnRUUG9wQmVyID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvdHBvcGJlcl9pbnNlcnQucGhwJyxcclxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFwiaWRcIjogd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKGFrdGl2ZXJfbm9kZSkuYXR0cihcImlkXCIpKSxcclxuXHRcdFx0XHRcdFx0XHRcInVzZXJcIjogc2Vzc2lvblN0b3JhZ2UuVXNlclxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydFRQb3BCZXIuYWx3YXlzKGZ1bmN0aW9uKGlkKSB7XHJcblx0XHRcdFx0XHRcdHZhciBzdHJ1a3R1cnR5cCA9IFwidHBvcGJlclwiLFxyXG5cdFx0XHRcdFx0XHRcdGJlc2NocmlmdHVuZyA9IFwibmV1ZXIgVGVpbHBvcHVsYXRpb25zLUJlcmljaHRcIjtcclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi5pbnNlcnROZXVlbk5vZGVFaW5lSGllcmFyY2hpZXN0dWZlVGllZmVyKGFrdGl2ZXJfbm9kZSwgcGFyZW50X25vZGUsIHN0cnVrdHVydHlwLCBpZCwgYmVzY2hyaWZ0dW5nKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aW5zZXJ0VFBvcEJlci5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IEtlaW5lbiBuZXVlbiBUZWlscG9wdWxhdGlvbnMtQmVyaWNodCBlcnN0ZWxsdFwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogS2VpbmVuIG5ldWVuIFRlaWxwb3B1bGF0aW9ucy1CZXJpY2h0IGVyc3RlbGx0Jyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0XHRyZXR1cm4gaXRlbXM7XHJcblx0Y2FzZSBcInRwb3BiZXJcIjpcclxuXHRcdGl0ZW1zID0ge1xyXG5cdFx0XHRcIm5ldVwiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcIm5ldWVyIFRlaWxwb3B1bGF0aW9ucy1CZXJpY2h0XCIsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL25ldS5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdHZhciBpbnNlcnRUUG9wQmVyXzIgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ3BocC90cG9wYmVyX2luc2VydC5waHAnLFxyXG5cdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFx0XCJpZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQocGFyZW50X25vZGUpLmF0dHIoXCJpZFwiKSksXHJcblx0XHRcdFx0XHRcdFx0XCJ0eXBcIjogXCJ0cG9wYmVyXCIsXHJcblx0XHRcdFx0XHRcdFx0XCJ1c2VyXCI6IHNlc3Npb25TdG9yYWdlLlVzZXJcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpbnNlcnRUUG9wQmVyXzIuYWx3YXlzKGZ1bmN0aW9uKGlkKSB7XHJcblx0XHRcdFx0XHRcdHZhciBzdHJ1a3R1cnR5cCA9IFwidHBvcGJlclwiLFxyXG5cdFx0XHRcdFx0XHRcdGJlc2NocmlmdHVuZyA9IFwibmV1ZXIgVGVpbHBvcHVsYXRpb25zLUJlcmljaHRcIjtcclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi5pbnNlcnROZXVlbk5vZGVBdWZHbGVpY2hlckhpZXJhcmNoaWVzdHVmZShha3RpdmVyX25vZGUsIHBhcmVudF9ub2RlLCBzdHJ1a3R1cnR5cCwgaWQsIGJlc2NocmlmdHVuZyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGluc2VydFRQb3BCZXJfMi5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IEtlaW5lbiBuZXVlbiBUZWlscG9wdWxhdGlvbnMtQmVyaWNodCBlcnN0ZWxsdFwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogS2VpbmVuIG5ldWVuIFRlaWxwb3B1bGF0aW9ucy1CZXJpY2h0IGVyc3RlbGx0Jyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sXHJcblx0XHRcdFwibG9lc2NoZW5cIjoge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogXCJsw7ZzY2hlblwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9sb2VzY2hlbi5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdC8vIG51ciBha3R1YWxpc2llcmVuLCB3ZW5uIFNjaHJlaWJyZWNodGUgYmVzdGVoZW5cclxuXHRcdFx0XHRcdGlmICghd2luZG93LmFwZi5wcsO8ZmVTY2hyZWlidm9yYXVzc2V0enVuZ2VuKCkpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0dmFyIGJlemVpY2hudW5nID0gJC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLmdldF90ZXh0KGFrdGl2ZXJfbm9kZSk7XHJcblx0XHRcdFx0XHQkKFwiI2xvZXNjaGVuX2RpYWxvZ19taXR0ZWlsdW5nXCIpLmh0bWwoXCJEZXIgVGVpbHBvcHVsYXRpb25zLUJlcmljaHQgJ1wiICsgYmV6ZWljaG51bmcgKyBcIicgd2lyZCBnZWzDtnNjaHQuXCIpO1xyXG5cdFx0XHRcdFx0JChcIiNsb2VzY2hlbl9kaWFsb2dcIikuZGlhbG9nKHtcclxuXHRcdFx0XHRcdFx0cmVzaXphYmxlOiBmYWxzZSxcclxuXHRcdFx0XHRcdFx0aGVpZ2h0OidhdXRvJyxcclxuXHRcdFx0XHRcdFx0d2lkdGg6IDQwMCxcclxuXHRcdFx0XHRcdFx0bW9kYWw6IHRydWUsXHJcblx0XHRcdFx0XHRcdGJ1dHRvbnM6IHtcclxuXHRcdFx0XHRcdFx0XHRcImphLCBsw7ZzY2hlbiFcIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHQkKHRoaXMpLmRpYWxvZyhcImNsb3NlXCIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gVmFyaWFibGUgenVtIHLDvGNrZ8OkbmdpZyBtYWNoZW4gZXJzdGVsbGVuXHJcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmRlbGV0ZWQgPSB3aW5kb3cuYXBmLnRwb3BiZXI7XHJcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmRlbGV0ZWQudHlwID0gXCJ0cG9wYmVyXCI7XHJcblx0XHRcdFx0XHRcdFx0XHR2YXIgZGVsZXRlVFBvcEJlciA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHR5cGU6ICdwb3N0JyxcclxuXHRcdFx0XHRcdFx0XHRcdFx0dXJsOiAncGhwL3Rwb3BiZXJfZGVsZXRlLnBocCcsXHJcblx0XHRcdFx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcImlkXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJChha3RpdmVyX25vZGUpLmF0dHIoXCJpZFwiKSlcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0XHRkZWxldGVUUG9wQmVyLmFsd2F5cyhmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZGVsZXRlIGxvY2FsU3RvcmFnZS50cG9wYmVyX2lkO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRkZWxldGUgd2luZG93LmFwZi50cG9wYmVyO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkuZGVsZXRlX25vZGUoYWt0aXZlcl9ub2RlKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gUGFyZW50IE5vZGUtQmVzY2hyaWZ0dW5nOiBBbnphaGwgYW5wYXNzZW5cclxuXHRcdFx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl90cG9wYmVyKHBhcmVudF9ub2RlKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gSGlud2VpcyB6dW0gcsO8Y2tnw6RuZ2lnIG1hY2hlbiBhbnplaWdlblxyXG5cdFx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmZyYWdlT2JBa3Rpb25Sw7xja2fDpG5naWdHZW1hY2h0V2VyZGVuU29sbChcIkRlciBUZWlscG9wdWxhdGlvbnMtQmVyaWNodCAnXCIgKyBiZXplaWNobnVuZyArIFwiJyB3dXJkZSBnZWzDtnNjaHQuXCIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0XHRkZWxldGVUUG9wQmVyLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogRGVyIFRlaWxwb3B1bGF0aW9ucy1CZXJpY2h0IHd1cmRlIG5pY2h0IGdlbMO2c2NodFwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogRGVyIFRlaWxwb3B1bGF0aW9ucy1CZXJpY2h0IHd1cmRlIG5pY2h0IGdlbMO2c2NodCcpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0XHRcImFiYnJlY2hlblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdCQodGhpcykuZGlhbG9nKFwiY2xvc2VcIik7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0XHRyZXR1cm4gaXRlbXM7XHJcblx0Y2FzZSBcInRwb3Bfb3JkbmVyX2Jlb2JfenVnZW9yZG5ldFwiOlxyXG5cdFx0aXRlbXMgPSB7XHJcblx0XHRcdFwiR29vZ2xlTWFwc1wiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcImF1ZiBMdWZ0YmlsZCB6ZWlnZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvZmxvcmFfaWNvbi5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdHZhciBnZXRCZW9iS2FydGUgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHR0eXBlOiAnZ2V0JyxcclxuXHRcdFx0XHRcdFx0dXJsOiAncGhwL2Jlb2Jfa2FydGUucGhwJyxcclxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFwidHBvcF9pZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwiaWRcIikpXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Z2V0QmVvYkthcnRlLmFsd2F5cyhmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0XHRcdGlmIChkYXRhLnJvd3MubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZ21hcC56ZWlnZVRQb3BCZW9iKGRhdGEpO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYubWVsZGUoXCJFcyBnaWJ0IGtlaW5lIEJlb2JhY2h0dW5nZW4gbWl0IEtvb3JkaW5hdGVuXCIsIFwiQWt0aW9uIGFiZ2Vicm9jaGVuXCIpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGdldEJlb2JLYXJ0ZS5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IEtlaW5lIERhdGVuIGVyaGFsdGVuXCIpO1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBLZWluZSBEYXRlbiBlcmhhbHRlbicpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cdFx0aWYgKHdpbmRvdy5hcGYuYmVvYl96dWdlb3JkbmV0X25vZGVfYXVzZ2VzY2huaXR0ZW4pIHtcclxuXHRcdFx0aXRlbXMgPSB7fTtcclxuXHRcdFx0aXRlbXMuZWluZnVlZ2VuID0ge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogJC5qc3RyZWUuX3JlZmVyZW5jZSh3aW5kb3cuYXBmLmJlb2JfenVnZW9yZG5ldF9ub2RlX2F1c2dlc2Nobml0dGVuKS5nZXRfdGV4dCh3aW5kb3cuYXBmLmJlb2JfenVnZW9yZG5ldF9ub2RlX2F1c2dlc2Nobml0dGVuKSArIFwiIGVpbmbDvGdlblwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9laW5mdWVnZW4ucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkubW92ZV9ub2RlKHdpbmRvdy5hcGYuYmVvYl96dWdlb3JkbmV0X25vZGVfYXVzZ2VzY2huaXR0ZW4sIGFrdGl2ZXJfbm9kZSwgXCJmaXJzdFwiLCBmYWxzZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRpZiAod2luZG93LmFwZi5iZW9iX25vZGVfYXVzZ2VzY2huaXR0ZW4pIHtcclxuXHRcdFx0aXRlbXMuZWluZnVlZ2VuID0ge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogJC5qc3RyZWUuX3JlZmVyZW5jZSh3aW5kb3cuYXBmLmJlb2Jfbm9kZV9hdXNnZXNjaG5pdHRlbikuZ2V0X3RleHQod2luZG93LmFwZi5iZW9iX25vZGVfYXVzZ2VzY2huaXR0ZW4pICsgXCIgZWluZsO8Z2VuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL2VpbmZ1ZWdlbi5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdCQoXCIjdHJlZVwiKS5qc3RyZWUoXCJtb3ZlX25vZGVcIiwgd2luZG93LmFwZi5iZW9iX25vZGVfYXVzZ2VzY2huaXR0ZW4sIGFrdGl2ZXJfbm9kZSwgXCJmaXJzdFwiKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiBpdGVtcztcclxuXHRjYXNlIFwiYmVvYl96dWdlb3JkbmV0XCI6XHJcblx0XHRpdGVtcyA9IHtcclxuXHRcdFx0XCJHb29nbGVNYXBzXCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwiYXVmIEx1ZnRiaWxkIHplaWdlblwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9mbG9yYV9pY29uLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0dmFyIGdldEJlb2JLYXJ0ZV8yID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ2dldCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ3BocC9iZW9iX2thcnRlLnBocCcsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcImJlb2JpZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwiaWRcIikpXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Z2V0QmVvYkthcnRlXzIuYWx3YXlzKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHRcdFx0aWYgKGRhdGEucm93cy5sZW5ndGggPiAwKSB7XHJcblx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5nbWFwLnplaWdlVFBvcEJlb2IoZGF0YSk7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5tZWxkZShcIkRpZSBCZW9iYWNodHVuZyBoYXQga2VpbmUgS29vcmRpbmF0ZW5cIiwgXCJBa3Rpb24gYWJnZWJyb2NoZW5cIik7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Z2V0QmVvYkthcnRlXzIuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBLZWluZSBEYXRlbiBlcmhhbHRlblwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogS2VpbmUgRGF0ZW4gZXJoYWx0ZW4nKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSxcclxuXHRcdFx0XCJHb29nbGVNYXBzTWl0VFBvcFRQb3BCZW9iXCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwiYXVmIEx1ZnRiaWxkIGVpbmVyIG5ldWVuPGJyPiZuYnNwOyZuYnNwOyZuYnNwO1RlaWxwb3B1bGF0aW9uIHp1b3JkbmVuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL2Zsb3JhX2ljb25fdmlvbGV0dC5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdHZhciBnZXRCZW9iS2FydGVfMyA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHRcdHR5cGU6ICdnZXQnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvYmVvYl9rYXJ0ZS5waHAnLFxyXG5cdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFx0XCJiZW9iaWRcIjogd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKGFrdGl2ZXJfbm9kZSkuYXR0cihcImlkXCIpKVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGdldEJlb2JLYXJ0ZV8zLmFsd2F5cyhmdW5jdGlvbihiZW9iKSB7XHJcblx0XHRcdFx0XHRcdGlmIChiZW9iLnJvd3MubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdFx0XHRcdHZhciBnZXRBcEthcnRlID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0XHRcdHR5cGU6ICdnZXQnLFxyXG5cdFx0XHRcdFx0XHRcdFx0dXJsOiAncGhwL2FwX2thcnRlLnBocCcsXHJcblx0XHRcdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcImlkXCI6IGxvY2FsU3RvcmFnZS5hcF9pZFxyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdGdldEFwS2FydGUuYWx3YXlzKGZ1bmN0aW9uKHRwb3ApIHtcclxuXHRcdFx0XHRcdFx0XHRcdGlmICh0cG9wLnJvd3MubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmdtYXAuemVpZ2VCZW9iVW5kVFBvcChiZW9iLCB0cG9wKTtcclxuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZ21hcC56ZWlnZUJlb2IoYmVvYik7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5tZWxkZShcIkRpZSBCZW9iYWNodHVuZyBoYXQga2VpbmUgS29vcmRpbmF0ZW48YnI+Qml0dGUgaW0gRm9ybXVsYXIgenVvcmRuZW5cIiwgXCJBa3Rpb24gYWJnZWJyb2NoZW5cIik7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Z2V0QmVvYkthcnRlXzMuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBLZWluZSBEYXRlbiBlcmhhbHRlblwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogS2VpbmUgRGF0ZW4gZXJoYWx0ZW4nKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSxcclxuXHRcdFx0XCJHaXNCcm93c2VyXCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwiaW0gR0lTLUJyb3dzZXIgemVpZ2VuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL3dhcHBlbl96dWVyaWNoLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0d2luZG93LmFwZi56ZWlnZUJlb2JLb29yZGluYXRlbkltR2lzQnJvd3NlcigpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHRcdGlmICghd2luZG93LmFwZi5iZW9iX3p1Z2VvcmRuZXRfbm9kZV9hdXNnZXNjaG5pdHRlbikge1xyXG5cdFx0XHRpdGVtcy5hdXNzY2huZWlkZW4gPSB7XHJcblx0XHRcdFx0Ly9cImxhYmVsXCI6IFwiYXVzc2NobmVpZGVuPGJyPiZuYnNwOyZuYnNwOyZuYnNwO1RpcHA6IGRyYWcgYW5kIGRyb3AgbWUhXCIsXHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcImF1c3NjaG5laWRlblwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9hdXNzY2huZWlkZW4ucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQvLyBudXIgYWt0dWFsaXNpZXJlbiwgd2VubiBTY2hyZWlicmVjaHRlIGJlc3RlaGVuXHJcblx0XHRcdFx0XHRpZiAoIXdpbmRvdy5hcGYucHLDvGZlU2NocmVpYnZvcmF1c3NldHp1bmdlbigpKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHdpbmRvdy5hcGYuYmVvYl96dWdlb3JkbmV0X25vZGVfYXVzZ2VzY2huaXR0ZW4gPSBha3RpdmVyX25vZGU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRpZiAod2luZG93LmFwZi5iZW9iX3p1Z2VvcmRuZXRfbm9kZV9hdXNnZXNjaG5pdHRlbikge1xyXG5cdFx0XHRpdGVtcy5laW5mdWVnZW5fYmVvYl96dWdlb3JkbmV0ID0ge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogJC5qc3RyZWUuX3JlZmVyZW5jZSh3aW5kb3cuYXBmLmJlb2JfenVnZW9yZG5ldF9ub2RlX2F1c2dlc2Nobml0dGVuKS5nZXRfdGV4dCh3aW5kb3cuYXBmLmJlb2JfenVnZW9yZG5ldF9ub2RlX2F1c2dlc2Nobml0dGVuKSArIFwiIGVpbmbDvGdlblwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9laW5mdWVnZW4ucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQkLmpzdHJlZS5fcmVmZXJlbmNlKHBhcmVudF9ub2RlKS5tb3ZlX25vZGUod2luZG93LmFwZi5iZW9iX3p1Z2VvcmRuZXRfbm9kZV9hdXNnZXNjaG5pdHRlbiwgcGFyZW50X25vZGUsIFwiZmlyc3RcIiwgZmFsc2UpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0aWYgKHdpbmRvdy5hcGYuYmVvYl9ub2RlX2F1c2dlc2Nobml0dGVuKSB7XHJcblx0XHRcdGl0ZW1zLmVpbmZ1ZWdlbl9iZW9iID0ge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogJC5qc3RyZWUuX3JlZmVyZW5jZSh3aW5kb3cuYXBmLmJlb2Jfbm9kZV9hdXNnZXNjaG5pdHRlbikuZ2V0X3RleHQod2luZG93LmFwZi5iZW9iX25vZGVfYXVzZ2VzY2huaXR0ZW4pICsgXCIgZWluZsO8Z2VuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL2VpbmZ1ZWdlbi5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdCQuanN0cmVlLl9yZWZlcmVuY2UocGFyZW50X25vZGUpLm1vdmVfbm9kZSh3aW5kb3cuYXBmLmJlb2Jfbm9kZV9hdXNnZXNjaG5pdHRlbiwgcGFyZW50X25vZGUsIFwiZmlyc3RcIiwgZmFsc2UpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGl0ZW1zO1xyXG5cdGNhc2UgXCJ0cG9wX29yZG5lcl9tYXNzbmJlclwiOlxyXG5cdFx0aXRlbXMgPSB7XHJcblx0XHRcdFwibmV1XCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwibmV1ZXIgTWFzc25haG1lbi1CZXJpY2h0XCIsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL25ldS5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdHZhciBpbnNlcnRUUG9wTWFzc25CZXIgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ3BocC90cG9wbWFzc25iZXJfaW5zZXJ0LnBocCcsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcImlkXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJChha3RpdmVyX25vZGUpLmF0dHIoXCJpZFwiKSksXHJcblx0XHRcdFx0XHRcdFx0XCJ1c2VyXCI6IHNlc3Npb25TdG9yYWdlLlVzZXJcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpbnNlcnRUUG9wTWFzc25CZXIuYWx3YXlzKGZ1bmN0aW9uKGlkKSB7XHJcblx0XHRcdFx0XHRcdHZhciBzdHJ1a3R1cnR5cCA9IFwidHBvcG1hc3NuYmVyXCIsXHJcblx0XHRcdFx0XHRcdFx0YmVzY2hyaWZ0dW5nID0gXCJuZXVlciBNYXNzbmFobWVuLUJlcmljaHRcIjtcclxuXHRcdFx0XHRcdFx0d2luZG93LmFwZi5pbnNlcnROZXVlbk5vZGVFaW5lSGllcmFyY2hpZXN0dWZlVGllZmVyKGFrdGl2ZXJfbm9kZSwgcGFyZW50X25vZGUsIHN0cnVrdHVydHlwLCBpZCwgYmVzY2hyaWZ0dW5nKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aW5zZXJ0VFBvcE1hc3NuQmVyLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogS2VpbmVuIG5ldWVuIE1hc3NuYWhtZW4tQmVyaWNodCBlcnN0ZWxsdFwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogS2VpbmVuIG5ldWVuIE1hc3NuYWhtZW4tQmVyaWNodCBlcnN0ZWxsdCcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cdFx0cmV0dXJuIGl0ZW1zO1xyXG5cdGNhc2UgXCJ0cG9wbWFzc25iZXJcIjpcclxuXHRcdGl0ZW1zID0ge1xyXG5cdFx0XHRcIm5ldVwiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcIm5ldWVyIE1hc3NuYWhtZW4tQmVyaWNodFwiLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9uZXUucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgaW5zZXJ0VFBvcE1hc3NCZXJfMiA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHRcdHR5cGU6ICdwb3N0JyxcclxuXHRcdFx0XHRcdFx0dXJsOiAncGhwL3Rwb3BtYXNzbmJlcl9pbnNlcnQucGhwJyxcclxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFwiaWRcIjogd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKHBhcmVudF9ub2RlKS5hdHRyKFwiaWRcIikpLFxyXG5cdFx0XHRcdFx0XHRcdFwidHlwXCI6IFwidHBvcG1hc3NuYmVyXCIsXHJcblx0XHRcdFx0XHRcdFx0XCJ1c2VyXCI6IHNlc3Npb25TdG9yYWdlLlVzZXJcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpbnNlcnRUUG9wTWFzc0Jlcl8yLmFsd2F5cyhmdW5jdGlvbihpZCkge1xyXG5cdFx0XHRcdFx0XHR2YXIgc3RydWt0dXJ0eXAgPSBcInRwb3BtYXNzbmJlclwiLFxyXG5cdFx0XHRcdFx0XHRcdGJlc2NocmlmdHVuZyA9IFwibmV1ZXIgTWFzc25haG1lbi1CZXJpY2h0XCI7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuaW5zZXJ0TmV1ZW5Ob2RlQXVmR2xlaWNoZXJIaWVyYXJjaGllc3R1ZmUoYWt0aXZlcl9ub2RlLCBwYXJlbnRfbm9kZSwgc3RydWt0dXJ0eXAsIGlkLCBiZXNjaHJpZnR1bmcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpbnNlcnRUUG9wTWFzc0Jlcl8yLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogS2VpbmVuIG5ldWVuIE1hc3NuYWhtZW4tQmVyaWNodCBlcnN0ZWxsdFwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogS2VpbmVuIG5ldWVuIE1hc3NuYWhtZW4tQmVyaWNodCBlcnN0ZWxsdCcpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LFxyXG5cdFx0XHRcImxvZXNjaGVuXCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwibMO2c2NoZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvbG9lc2NoZW4ucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQvLyBudXIgYWt0dWFsaXNpZXJlbiwgd2VubiBTY2hyZWlicmVjaHRlIGJlc3RlaGVuXHJcblx0XHRcdFx0XHRpZiAoIXdpbmRvdy5hcGYucHLDvGZlU2NocmVpYnZvcmF1c3NldHp1bmdlbigpKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHZhciBiZXplaWNobnVuZyA9ICQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5nZXRfdGV4dChha3RpdmVyX25vZGUpO1xyXG5cdFx0XHRcdFx0JChcIiNsb2VzY2hlbl9kaWFsb2dfbWl0dGVpbHVuZ1wiKS5odG1sKFwiRGVyIE1hc3NuYWhtZW4tQmVyaWNodCAnXCIgKyBiZXplaWNobnVuZyArIFwiJyB3aXJkIGdlbMO2c2NodC5cIik7XHJcblx0XHRcdFx0XHQkKFwiI2xvZXNjaGVuX2RpYWxvZ1wiKS5kaWFsb2coe1xyXG5cdFx0XHRcdFx0XHRyZXNpemFibGU6IGZhbHNlLFxyXG5cdFx0XHRcdFx0XHRoZWlnaHQ6J2F1dG8nLFxyXG5cdFx0XHRcdFx0XHR3aWR0aDogNDAwLFxyXG5cdFx0XHRcdFx0XHRtb2RhbDogdHJ1ZSxcclxuXHRcdFx0XHRcdFx0YnV0dG9uczoge1xyXG5cdFx0XHRcdFx0XHRcdFwiamEsIGzDtnNjaGVuIVwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdCQodGhpcykuZGlhbG9nKFwiY2xvc2VcIik7XHJcblx0XHRcdFx0XHRcdFx0XHQvLyBWYXJpYWJsZSB6dW0gcsO8Y2tnw6RuZ2lnIG1hY2hlbiBlcnN0ZWxsZW5cclxuXHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZGVsZXRlZCA9IHdpbmRvdy5hcGYudHBvcG1hc3NuYmVyO1xyXG5cdFx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5kZWxldGVkLnR5cCA9IFwidHBvcG1hc3NuYmVyXCI7XHJcblx0XHRcdFx0XHRcdFx0XHR2YXIgZGVsZXRlVFBvcE1hc3NuQmVyID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHR1cmw6ICdwaHAvdHBvcG1hc3NuYmVyX2RlbGV0ZS5waHAnLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XCJpZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwiaWRcIikpXHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0ZGVsZXRlVFBvcE1hc3NuQmVyLmFsd2F5cyhmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZGVsZXRlIGxvY2FsU3RvcmFnZS50cG9wbWFzc25iZXJfaWQ7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGRlbGV0ZSB3aW5kb3cuYXBmLnRwb3BtYXNzbmJlcjtcclxuXHRcdFx0XHRcdFx0XHRcdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShha3RpdmVyX25vZGUpLmRlbGV0ZV9ub2RlKGFrdGl2ZXJfbm9kZSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vIFBhcmVudCBOb2RlLUJlc2NocmlmdHVuZzogQW56YWhsIGFucGFzc2VuXHJcblx0XHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuYmVzY2hyaWZ0ZV9vcmRuZXJfcG9wbWFzc25iZXIocGFyZW50X25vZGUpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBIaW53ZWlzIHp1bSByw7xja2fDpG5naWcgbWFjaGVuIGFuemVpZ2VuXHJcblx0XHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZnJhZ2VPYkFrdGlvblLDvGNrZ8OkbmdpZ0dlbWFjaHRXZXJkZW5Tb2xsKFwiRGVyIE1hc3NuYWhtZW4tQmVyaWNodCAnXCIgKyBiZXplaWNobnVuZyArIFwiJyB3dXJkZSBnZWzDtnNjaHQuXCIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0XHRkZWxldGVUUG9wTWFzc25CZXIuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBEZXIgTWFzc25haG1lbi1CZXJpY2h0IHd1cmRlIG5pY2h0IGdlbMO2c2NodFwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogRGVyIE1hc3NuYWhtZW4tQmVyaWNodCB3dXJkZSBuaWNodCBnZWzDtnNjaHQnKTtcclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdFx0XCJhYmJyZWNoZW5cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHQkKHRoaXMpLmRpYWxvZyhcImNsb3NlXCIpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cdFx0cmV0dXJuIGl0ZW1zO1xyXG5cdGNhc2UgXCJhcF9vcmRuZXJfYmVvYl9uaWNodF9iZXVydGVpbHRcIjpcclxuXHRcdGl0ZW1zID0ge1xyXG5cdFx0XHRcIkdvb2dsZU1hcHNcIjoge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogXCJhdWYgTHVmdGJpbGQgemVpZ2VuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL2Zsb3JhX2ljb25fdmlvbGV0dC5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdHZhciBnZXRCZW9iS2FydGVfNCA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHRcdHR5cGU6ICdnZXQnLFxyXG5cdFx0XHRcdFx0XHR1cmw6ICdwaHAvYmVvYl9rYXJ0ZS5waHAnLFxyXG5cdFx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcdFx0XCJhcGFydF9pZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwiaWRcIikpXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Z2V0QmVvYkthcnRlXzQuYWx3YXlzKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHRcdFx0aWYgKGRhdGEucm93cy5sZW5ndGggPiAwKSB7XHJcblx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5nbWFwLnplaWdlQmVvYihkYXRhKTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLm1lbGRlKFwiRXMgZ2lidCBrZWluZSBCZW9iYWNodHVuZyBtaXQgS29vcmRpbmF0ZW5cIiwgXCJBa3Rpb24gYWJnZWJyb2NoZW5cIik7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Z2V0QmVvYkthcnRlXzQuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBLZWluZSBEYXRlbiBlcmhhbHRlblwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogS2VpbmUgRGF0ZW4gZXJoYWx0ZW4nKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSxcclxuXHRcdFx0XCJHb29nbGVNYXBzTWl0VFBvcFwiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcImF1ZiBMdWZ0YmlsZCBUZWlscG9wdWxhdGlvbmVuPGJyPiZuYnNwOyZuYnNwOyZuYnNwO3p1b3JkbmVuPGJyPiZuYnNwOyZuYnNwOyZuYnNwO1RpcHA6IEJlb2JhY2h0dW5nZW4gYXVmPGJyPiZuYnNwOyZuYnNwOyZuYnNwO1RlaWxwb3B1bGF0aW9uZW4gemllaGVuIVwiLFxyXG5cdFx0XHRcdFwic2VwYXJhdG9yX2JlZm9yZVwiOiB0cnVlLFxyXG5cdFx0XHRcdFwiaWNvblwiOiBcInN0eWxlL2ltYWdlcy9mbG9yYV9pY29uX3Zpb2xldHQucG5nXCIsXHJcblx0XHRcdFx0XCJhY3Rpb25cIjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgZ2V0QmVvYkthcnRlXzUgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdFx0XHR0eXBlOiAnZ2V0JyxcclxuXHRcdFx0XHRcdFx0dXJsOiAncGhwL2Jlb2Jfa2FydGUucGhwJyxcclxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XHRcdFwiYXBhcnRfaWRcIjogd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKGFrdGl2ZXJfbm9kZSkuYXR0cihcImlkXCIpKVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGdldEJlb2JLYXJ0ZV81LmFsd2F5cyhmdW5jdGlvbihiZW9iKSB7XHJcblx0XHRcdFx0XHRcdGlmIChiZW9iLnJvd3MubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdFx0XHRcdCQuYWpheCh7XHJcblx0XHRcdFx0XHRcdFx0XHR0eXBlOiAnZ2V0JyxcclxuXHRcdFx0XHRcdFx0XHRcdHVybDogJ3BocC9hcF9rYXJ0ZS5waHAnLFxyXG5cdFx0XHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XCJpZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwiaWRcIikpXHJcblx0XHRcdFx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24odHBvcCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAodHBvcC5yb3dzLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmdtYXAuemVpZ2VCZW9iVW5kVFBvcChiZW9iLCB0cG9wKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmdtYXAuemVpZ2VCZW9iKGJlb2IpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5tZWxkZShcIkVzIGdpYnQga2VpbmUgQmVvYmFjaHR1bmcgbWl0IEtvb3JkaW5hdGVuXCIsIFwiQWt0aW9uIGFiZ2Vicm9jaGVuXCIpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGdldEJlb2JLYXJ0ZV81LmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogS2VpbmUgRGF0ZW4gZXJoYWx0ZW5cIik7XHJcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IEtlaW5lIERhdGVuIGVyaGFsdGVuJyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0XHRpZiAod2luZG93LmFwZi5iZW9iX3p1Z2VvcmRuZXRfbm9kZV9hdXNnZXNjaG5pdHRlbikge1xyXG5cdFx0XHRpdGVtcy5laW5mdWVnZW4gPSB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiAkLmpzdHJlZS5fcmVmZXJlbmNlKHdpbmRvdy5hcGYuYmVvYl96dWdlb3JkbmV0X25vZGVfYXVzZ2VzY2huaXR0ZW4pLmdldF90ZXh0KHdpbmRvdy5hcGYuYmVvYl96dWdlb3JkbmV0X25vZGVfYXVzZ2VzY2huaXR0ZW4pICsgXCIgZWluZsO8Z2VuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL2VpbmZ1ZWdlbi5wbmdcIixcclxuXHRcdFx0XHRcImFjdGlvblwiOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdCQoXCIjdHJlZVwiKS5qc3RyZWUoXCJtb3ZlX25vZGVcIiwgd2luZG93LmFwZi5iZW9iX3p1Z2VvcmRuZXRfbm9kZV9hdXNnZXNjaG5pdHRlbiwgYWt0aXZlcl9ub2RlLCBcImZpcnN0XCIpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGl0ZW1zO1xyXG5cdGNhc2UgXCJiZW9iX25pY2h0X2JldXJ0ZWlsdFwiOlxyXG5cdFx0aXRlbXMgPSB7XHJcblx0XHRcdFwiR29vZ2xlTWFwc1wiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcImF1ZiBMdWZ0YmlsZCB6ZWlnZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvZmxvcmFfaWNvbl92aW9sZXR0LnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0dmFyIGdldEJlb2JLYXJ0ZV82ID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ2dldCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ3BocC9iZW9iX2thcnRlLnBocCcsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcImJlb2JpZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwiaWRcIikpXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Z2V0QmVvYkthcnRlXzYuYWx3YXlzKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHRcdFx0aWYgKGRhdGEucm93cy5sZW5ndGggPiAwKSB7XHJcblx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5nbWFwLnplaWdlQmVvYihkYXRhKTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLm1lbGRlKFwiRXMgZ2lidCBrZWluZSBCZW9iYWNodHVuZyBtaXQgS29vcmRpbmF0ZW5cIiwgXCJBa3Rpb24gYWJnZWJyb2NoZW5cIik7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Z2V0QmVvYkthcnRlXzYuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBLZWluZSBEYXRlbiBlcmhhbHRlblwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogS2VpbmUgRGF0ZW4gZXJoYWx0ZW4nKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSxcclxuXHRcdFx0XCJHb29nbGVNYXBzTWl0VFBvcEJlb2JcIjoge1xyXG5cdFx0XHRcdFwibGFiZWxcIjogXCJhdWYgTHVmdGJpbGQgZWluZXIgVGVpbHBvcHVsYXRpb248YnI+Jm5ic3A7Jm5ic3A7Jm5ic3A7enVvcmRuZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvZmxvcmFfaWNvbl92aW9sZXR0LnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0dmFyIGdldEJlb2JLYXJ0ZV83ID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ2dldCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ3BocC9iZW9iX2thcnRlLnBocCcsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcImJlb2JpZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwiaWRcIikpXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Z2V0QmVvYkthcnRlXzcuYWx3YXlzKGZ1bmN0aW9uKGJlb2IpIHtcclxuXHRcdFx0XHRcdFx0aWYgKGJlb2Iucm93cy5sZW5ndGggPiAwKSB7XHJcblx0XHRcdFx0XHRcdFx0dmFyIGdldEFwS2FydGVfMiA9ICQuYWpheCh7XHJcblx0XHRcdFx0XHRcdFx0XHR0eXBlOiAnZ2V0JyxcclxuXHRcdFx0XHRcdFx0XHRcdHVybDogJ3BocC9hcF9rYXJ0ZS5waHAnLFxyXG5cdFx0XHRcdFx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XCJpZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQocGFyZW50X25vZGUpLmF0dHIoXCJpZFwiKSlcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0XHRnZXRBcEthcnRlXzIuYWx3YXlzKGZ1bmN0aW9uKHRwb3ApIHtcclxuXHRcdFx0XHRcdFx0XHRcdGlmICh0cG9wLnJvd3MubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmdtYXAuemVpZ2VCZW9iVW5kVFBvcChiZW9iLCB0cG9wKTtcclxuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hcGYuZ21hcC56ZWlnZUJlb2IoYmVvYik7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5tZWxkZShcIkRpZSBCZW9iYWNodHVuZyBoYXQga2VpbmUgS29vcmRpbmF0ZW48YnI+Qml0dGUgaW0gRm9ybXVsYXIgenVvcmRuZW5cIiwgXCJBa3Rpb24gYWJnZWJyb2NoZW5cIik7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Z2V0QmVvYkthcnRlXzcuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBLZWluZSBEYXRlbiBlcmhhbHRlblwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogS2VpbmUgRGF0ZW4gZXJoYWx0ZW4nKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSxcclxuXHRcdFx0XCJHaXNCcm93c2VyXCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwiaW0gR0lTLUJyb3dzZXIgemVpZ2VuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL3dhcHBlbl96dWVyaWNoLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0d2luZG93LmFwZi56ZWlnZUJlb2JLb29yZGluYXRlbkltR2lzQnJvd3NlcigpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHRcdGlmICghd2luZG93LmFwZi5iZW9iX25vZGVfYXVzZ2VzY2huaXR0ZW4pIHtcclxuXHRcdFx0aXRlbXMuYXVzc2NobmVpZGVuID0ge1xyXG5cdFx0XHRcdC8vXCJsYWJlbFwiOiBcImF1c3NjaG5laWRlbjxicj4mbmJzcDsmbmJzcDsmbmJzcDtUaXBwOiBkcmFnIGFuZCBkcm9wIG1lIVwiLFxyXG5cdFx0XHRcdFwibGFiZWxcIjogXCJhdXNzY2huZWlkZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvYXVzc2NobmVpZGVuLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gbnVyIGFrdHVhbGlzaWVyZW4sIHdlbm4gU2NocmVpYnJlY2h0ZSBiZXN0ZWhlblxyXG5cdFx0XHRcdFx0aWYgKCF3aW5kb3cuYXBmLnByw7xmZVNjaHJlaWJ2b3JhdXNzZXR6dW5nZW4oKSkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLmJlb2Jfbm9kZV9hdXNnZXNjaG5pdHRlbiA9IGFrdGl2ZXJfbm9kZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGlmICh3aW5kb3cuYXBmLmJlb2JfenVnZW9yZG5ldF9ub2RlX2F1c2dlc2Nobml0dGVuKSB7XHJcblx0XHRcdGl0ZW1zLmVpbmZ1ZWdlbiA9IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6ICQuanN0cmVlLl9yZWZlcmVuY2Uod2luZG93LmFwZi5iZW9iX3p1Z2VvcmRuZXRfbm9kZV9hdXNnZXNjaG5pdHRlbikuZ2V0X3RleHQod2luZG93LmFwZi5iZW9iX3p1Z2VvcmRuZXRfbm9kZV9hdXNnZXNjaG5pdHRlbikgKyBcIiBlaW5mw7xnZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvZWluZnVlZ2VuLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0JChcIiN0cmVlXCIpLmpzdHJlZShcIm1vdmVfbm9kZVwiLCB3aW5kb3cuYXBmLmJlb2JfenVnZW9yZG5ldF9ub2RlX2F1c2dlc2Nobml0dGVuLCBwYXJlbnRfbm9kZSwgXCJmaXJzdFwiKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiBpdGVtcztcclxuXHRjYXNlIFwiYXBfb3JkbmVyX2Jlb2JfbmljaHRfenV6dW9yZG5lblwiOlxyXG5cdFx0aXRlbXMgPSB7XHJcblx0XHRcdFwiR29vZ2xlTWFwc1wiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcImF1ZiBMdWZ0YmlsZCB6ZWlnZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvZmxvcmFfaWNvbl92aW9sZXR0LnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0dmFyIGdldEJlb2JLYXJ0ZV84ID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ2dldCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ3BocC9iZW9iX2thcnRlLnBocCcsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcImFwYXJ0X2lkXCI6IHdpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQoJChha3RpdmVyX25vZGUpLmF0dHIoXCJpZFwiKSksXHJcblx0XHRcdFx0XHRcdFx0XCJuaWNodF96dXp1b3JkbmVuXCI6IFwiMVwiXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Z2V0QmVvYkthcnRlXzguYWx3YXlzKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHRcdFx0aWYgKGRhdGEucm93cy5sZW5ndGggPiAwKSB7XHJcblx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5nbWFwLnplaWdlQmVvYihkYXRhKTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLm1lbGRlKFwiRXMgZ2lidCBrZWluZSBCZW9iYWNodHVuZyBtaXQgS29vcmRpbmF0ZW5cIiwgXCJBa3Rpb24gYWJnZWJyb2NoZW5cIik7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Z2V0QmVvYkthcnRlXzguZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBLZWluZSBEYXRlbiBlcmhhbHRlblwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogS2VpbmUgRGF0ZW4gZXJoYWx0ZW4nKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHRcdGlmICh3aW5kb3cuYXBmLmJlb2JfenVnZW9yZG5ldF9ub2RlX2F1c2dlc2Nobml0dGVuKSB7XHJcblx0XHRcdGl0ZW1zLmVpbmZ1ZWdlbiA9IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6ICQuanN0cmVlLl9yZWZlcmVuY2Uod2luZG93LmFwZi5iZW9iX3p1Z2VvcmRuZXRfbm9kZV9hdXNnZXNjaG5pdHRlbikuZ2V0X3RleHQod2luZG93LmFwZi5iZW9iX3p1Z2VvcmRuZXRfbm9kZV9hdXNnZXNjaG5pdHRlbikgKyBcIiBlaW5mw7xnZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvZWluZnVlZ2VuLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0JChcIiN0cmVlXCIpLmpzdHJlZShcIm1vdmVfbm9kZVwiLCB3aW5kb3cuYXBmLmJlb2JfenVnZW9yZG5ldF9ub2RlX2F1c2dlc2Nobml0dGVuLCBha3RpdmVyX25vZGUsIFwiZmlyc3RcIik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gaXRlbXM7XHJcblx0Y2FzZSBcImJlb2JfbmljaHRfenV6dW9yZG5lblwiOlxyXG5cdFx0aXRlbXMgPSB7XHJcblx0XHRcdFwiR29vZ2xlTWFwc1wiOiB7XHJcblx0XHRcdFx0XCJsYWJlbFwiOiBcImF1ZiBMdWZ0YmlsZCB6ZWlnZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvZmxvcmFfaWNvbl92aW9sZXR0LnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0dmFyIGdldEJlb2JLYXJ0ZV85ID0gJC5hamF4KHtcclxuXHRcdFx0XHRcdFx0dHlwZTogJ2dldCcsXHJcblx0XHRcdFx0XHRcdHVybDogJ3BocC9iZW9iX2thcnRlLnBocCcsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFx0XHRcImJlb2JpZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwiaWRcIikpXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Z2V0QmVvYkthcnRlXzkuYWx3YXlzKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHRcdFx0aWYgKGRhdGEucm93cy5sZW5ndGggPiAwKSB7XHJcblx0XHRcdFx0XHRcdFx0d2luZG93LmFwZi5nbWFwLnplaWdlQmVvYihkYXRhKTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLm1lbGRlKFwiRXMgZ2lidCBrZWluZSBCZW9iYWNodHVuZyBtaXQgS29vcmRpbmF0ZW5cIiwgXCJBa3Rpb24gYWJnZWJyb2NoZW5cIik7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Z2V0QmVvYkthcnRlXzkuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBLZWluZSBEYXRlbiBlcmhhbHRlblwiKTtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogS2VpbmUgRGF0ZW4gZXJoYWx0ZW4nKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSxcclxuXHRcdFx0XCJHaXNCcm93c2VyXCI6IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6IFwiaW0gR0lTLUJyb3dzZXIgemVpZ2VuXCIsXHJcblx0XHRcdFx0XCJzZXBhcmF0b3JfYmVmb3JlXCI6IHRydWUsXHJcblx0XHRcdFx0XCJpY29uXCI6IFwic3R5bGUvaW1hZ2VzL3dhcHBlbl96dWVyaWNoLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0d2luZG93LmFwZi56ZWlnZUJlb2JLb29yZGluYXRlbkltR2lzQnJvd3NlcigpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHRcdGlmICghd2luZG93LmFwZi5iZW9iX25vZGVfYXVzZ2VzY2huaXR0ZW4pIHtcclxuXHRcdFx0aXRlbXMuYXVzc2NobmVpZGVuID0ge1xyXG5cdFx0XHRcdC8vXCJsYWJlbFwiOiBcImF1c3NjaG5laWRlbjxicj4mbmJzcDsmbmJzcDsmbmJzcDtUaXBwOiBkcmFnIGFuZCBkcm9wIG1lIVwiLFxyXG5cdFx0XHRcdFwibGFiZWxcIjogXCJhdXNzY2huZWlkZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvYXVzc2NobmVpZGVuLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gbnVyIGFrdHVhbGlzaWVyZW4sIHdlbm4gU2NocmVpYnJlY2h0ZSBiZXN0ZWhlblxyXG5cdFx0XHRcdFx0aWYgKCF3aW5kb3cuYXBmLnByw7xmZVNjaHJlaWJ2b3JhdXNzZXR6dW5nZW4oKSkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLmJlb2Jfbm9kZV9hdXNnZXNjaG5pdHRlbiA9IGFrdGl2ZXJfbm9kZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGlmICh3aW5kb3cuYXBmLmJlb2JfenVnZW9yZG5ldF9ub2RlX2F1c2dlc2Nobml0dGVuKSB7XHJcblx0XHRcdGl0ZW1zLmVpbmZ1ZWdlbiA9IHtcclxuXHRcdFx0XHRcImxhYmVsXCI6ICQuanN0cmVlLl9yZWZlcmVuY2Uod2luZG93LmFwZi5iZW9iX3p1Z2VvcmRuZXRfbm9kZV9hdXNnZXNjaG5pdHRlbikuZ2V0X3RleHQod2luZG93LmFwZi5iZW9iX3p1Z2VvcmRuZXRfbm9kZV9hdXNnZXNjaG5pdHRlbikgKyBcIiBlaW5mw7xnZW5cIixcclxuXHRcdFx0XHRcInNlcGFyYXRvcl9iZWZvcmVcIjogdHJ1ZSxcclxuXHRcdFx0XHRcImljb25cIjogXCJzdHlsZS9pbWFnZXMvZWluZnVlZ2VuLnBuZ1wiLFxyXG5cdFx0XHRcdFwiYWN0aW9uXCI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0JChcIiN0cmVlXCIpLmpzdHJlZShcIm1vdmVfbm9kZVwiLCB3aW5kb3cuYXBmLmJlb2JfenVnZW9yZG5ldF9ub2RlX2F1c2dlc2Nobml0dGVuLCBwYXJlbnRfbm9kZSwgXCJmaXJzdFwiKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiBpdGVtcztcclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLnRwb3BLb3BpZXJ0SW5Qb3BPcmRuZXJUcG9wRWluZsO8Z2VuID0gZnVuY3Rpb24oYWt0aXZlcl9ub2RlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBpbnNlcnRUUG9wS29waWUgPSAkLmFqYXgoe1xyXG5cdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0dXJsOiAncGhwL3Rwb3BfaW5zZXJ0X2tvcGllLnBocCcsXHJcblx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0ZGF0YToge1xyXG5cdFx0XHRcInVzZXJcIjogc2Vzc2lvblN0b3JhZ2UuVXNlcixcclxuXHRcdFx0XCJQb3BJZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwiaWRcIikpLFxyXG5cdFx0XHRcIlRQb3BJZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQod2luZG93LmFwZi50cG9wX25vZGVfa29waWVydCkuYXR0cihcImlkXCIpKVxyXG5cdFx0fVxyXG5cdH0pO1xyXG5cdGluc2VydFRQb3BLb3BpZS5hbHdheXMoZnVuY3Rpb24oaWQpIHtcclxuXHRcdHZhciBzdHJ1a3R1cnR5cCA9IFwidHBvcFwiLFxyXG5cdFx0XHRiZXNjaHJpZnR1bmcgPSB3aW5kb3cuYXBmLnRwb3Bfb2JqZWt0X2tvcGllcnQuVFBvcEZsdXJuYW1lO1xyXG5cdFx0aWYgKHdpbmRvdy5hcGYudHBvcF9vYmpla3Rfa29waWVydC5UUG9wTnIpIHtcclxuXHRcdFx0YmVzY2hyaWZ0dW5nID0gd2luZG93LmFwZi50cG9wX29iamVrdF9rb3BpZXJ0LlRQb3BOciArICc6ICcgKyB3aW5kb3cuYXBmLnRwb3Bfb2JqZWt0X2tvcGllcnQuVFBvcEZsdXJuYW1lXHJcblx0XHR9XHJcblx0XHR3aW5kb3cuYXBmLmluc2VydE5ldWVuTm9kZUVpbmVIaWVyYXJjaGllc3R1ZmVUaWVmZXIoYWt0aXZlcl9ub2RlLCBcIlwiLCBzdHJ1a3R1cnR5cCwgaWQsIGJlc2NocmlmdHVuZyk7XHJcblx0fSk7XHJcblx0aW5zZXJ0VFBvcEtvcGllLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IERpZSBUZWlscG9wdWxhdGlvbiB3dXJkZSBuaWNodCBlcnN0ZWxsdFwiKTtcclxuXHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IERpZSBUZWlscG9wdWxhdGlvbiB3dXJkZSBuaWNodCBlcnN0ZWxsdCcpO1xyXG5cdH0pO1xyXG59O1xyXG5cclxuLy8gd2lyZCBvZmZlbmJhciBtb21lbnRhbiBuaWNodCB2ZXJ3ZW5kZXRcclxuLyp3aW5kb3cuYXBmLnBvcEtvcGllcnRJblBvcEVpbmbDvGdlbiA9IGZ1bmN0aW9uKGFrdGl2ZXJfbm9kZSwgcGFyZW50X25vZGUpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGRhdGEgPSB7fTtcclxuXHQvLyBudXIgYWt0dWFsaXNpZXJlbiwgd2VubiBTY2hyZWlicmVjaHRlIGJlc3RlaGVuXHJcblx0aWYgKCF3aW5kb3cuYXBmLnByw7xmZVNjaHJlaWJ2b3JhdXNzZXR6dW5nZW4oKSkge1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHQvLyBkcm9wIGtlbm50IGRlbiBwYXJlbnQgbmljaHRcclxuXHRpZiAoIXBhcmVudF9ub2RlKSB7XHJcblx0XHRwYXJlbnRfbm9kZSA9ICQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5fZ2V0X3BhcmVudChha3RpdmVyX25vZGUpO1xyXG5cdH1cclxuXHQvLyBVc2VyIHVuZCBuZXVlIEFwQXJ0SWQgbWl0Z2ViZW5cclxuXHRkYXRhLk11dFdlciA9IHNlc3Npb25TdG9yYWdlLlVzZXI7XHJcblx0ZGF0YS5BcEFydElkID0gd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKHBhcmVudF9ub2RlKS5hdHRyKFwiaWRcIikpO1xyXG5cdC8vIGRpZSBhbHRlbiBpZCdzIGVudGZlcm5lblxyXG5cdGRlbGV0ZSB3aW5kb3cuYXBmLnBvcF9vYmpla3Rfa29waWVydC5BcEFydElkO1xyXG5cdGRlbGV0ZSB3aW5kb3cuYXBmLnBvcF9vYmpla3Rfa29waWVydC5Qb3BJZDtcclxuXHQvLyBkYXMgd2lyZCBnbGVpY2ggbmV1IGdlc2V0enQsIGFsdGUgV2VydGUgdmVyd2VyZmVuXHJcblx0ZGVsZXRlIHdpbmRvdy5hcGYucG9wX29iamVrdF9rb3BpZXJ0Lk11dFdhbm47XHJcblx0ZGVsZXRlIHdpbmRvdy5hcGYucG9wX29iamVrdF9rb3BpZXJ0Lk11dFdlcjtcclxuXHQvLyBhbGxlIHZlcmJsaWViZW5lbiBGZWxkZXIgYW4gZGllIHVybCBow6RuZ2VuXHJcbiAgICBfLmVhY2god2luZG93LmFwZi5wb3Bfb2JqZWt0X2tvcGllcnQsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcclxuICAgICAgICAvLyBOdWxsd2VydGUgYXVzc2NobGllc3NlblxyXG4gICAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBkYXRhW2tleV0gPSB2YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHQvLyB1bmQgYW4gZGllIERCIHNjaGlja2VuXHJcblx0dmFyIGluc2VydFBvcEtvcGllXzIgPSAkLmFqYXgoe1xyXG5cdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0dXJsOiAncGhwL3BvcF9pbnNlcnRfa29waWUucGhwJyxcclxuXHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRkYXRhOiBkYXRhXHJcblx0fSk7XHJcblx0aW5zZXJ0UG9wS29waWVfMi5hbHdheXMoZnVuY3Rpb24ocG9wX2lkKSB7XHJcblx0XHR2YXIgc3RydWt0dXJ0eXAgPSBcInBvcFwiLFxyXG5cdFx0XHRiZXNjaHJpZnR1bmcgPSB3aW5kb3cuYXBmLnBvcF9vYmpla3Rfa29waWVydC5Qb3BOciArIFwiIFwiICsgd2luZG93LmFwZi5wb3Bfb2JqZWt0X2tvcGllcnQuUG9wTmFtZTtcclxuXHRcdHdpbmRvdy5hcGYuaW5zZXJ0TmV1ZW5Ob2RlQXVmR2xlaWNoZXJIaWVyYXJjaGllc3R1ZmUoYWt0aXZlcl9ub2RlLCBwYXJlbnRfbm9kZSwgc3RydWt0dXJ0eXAsIHBvcF9pZCwgYmVzY2hyaWZ0dW5nKTtcclxuXHR9KTtcclxuXHRpbnNlcnRQb3BLb3BpZV8yLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IERpZSBQb3B1bGF0aW9uIHd1cmRlIG5pY2h0IGVyc3RlbGx0XCIpO1xyXG5cdFx0Y29uc29sZS5sb2coJ0RpZSBQb3B1bGF0aW9uIHd1cmRlIG5pY2h0IGVyc3RlbGx0Jyk7XHJcblx0fSk7XHJcbn07Ki9cclxuXHJcbi8vIHdpcmQgb2ZmZW5iYXIgbW9tZW50YW4gbmljaHQgdmVyd2VuZGV0XHJcbndpbmRvdy5hcGYudHBvcEtvcGllcnRJblRwb3BFaW5mw7xnZW4gPSBmdW5jdGlvbihha3RpdmVyX25vZGUsIHBhcmVudF9ub2RlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBkYXRhID0ge307XHJcblx0Ly8gbnVyIGFrdHVhbGlzaWVyZW4sIHdlbm4gU2NocmVpYnJlY2h0ZSBiZXN0ZWhlblxyXG5cdGlmICghd2luZG93LmFwZi5wcsO8ZmVTY2hyZWlidm9yYXVzc2V0enVuZ2VuKCkpIHtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblx0Ly8gZHJvcCBrZW5udCBkZW4gcGFyZW50IG5pY2h0XHJcblx0aWYgKCFwYXJlbnRfbm9kZSkge1xyXG5cdFx0cGFyZW50X25vZGUgPSAkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkuX2dldF9wYXJlbnQoYWt0aXZlcl9ub2RlKTtcclxuXHR9XHJcblx0Ly8gVXNlciB1bmQgbmV1ZSBQb3BJZCBtaXRnZWJlblxyXG5cdGRhdGEuTXV0V2VyID0gc2Vzc2lvblN0b3JhZ2UuVXNlcjtcclxuXHRkYXRhLlBvcElkID0gd2luZG93LmFwZi5lcnN0ZWxsZUlkQXVzRG9tQXR0cmlidXRJZCgkKHBhcmVudF9ub2RlKS5hdHRyKFwiaWRcIikpO1xyXG5cdC8vIGRpZSBhbHRlbiBpZCdzIGVudGZlcm5lblxyXG5cdGRlbGV0ZSB3aW5kb3cuYXBmLnRwb3Bfb2JqZWt0X2tvcGllcnQuUG9wSWQ7XHJcblx0ZGVsZXRlIHdpbmRvdy5hcGYudHBvcF9vYmpla3Rfa29waWVydC5UUG9wSWQ7XHJcblx0Ly8gZGFzIHdpcmQgZ2xlaWNoIG5ldSBnZXNldHp0LCBhbHRlIFdlcnRlIHZlcndlcmZlblxyXG5cdGRlbGV0ZSB3aW5kb3cuYXBmLnRwb3Bfb2JqZWt0X2tvcGllcnQuTXV0V2FubjtcclxuXHRkZWxldGUgd2luZG93LmFwZi50cG9wX29iamVrdF9rb3BpZXJ0Lk11dFdlcjtcclxuXHQvLyBhbGxlIHZlcmJsaWViZW5lbiBGZWxkZXIgYW4gZGllIHVybCBow6RuZ2VuXHJcbiAgICBfLmVhY2god2luZG93LmFwZi50cG9wX29iamVrdF9rb3BpZXJ0LCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XHJcbiAgICAgICAgLy8gTnVsbHdlcnRlIGF1c3NjaGxpZXNzZW5cclxuICAgICAgICBpZiAodmFsdWUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgZGF0YVtrZXldID0gdmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblx0Ly8gdW5kIGFuIGRpZSBEQiBzY2hpY2tlblxyXG5cdHZhciBpbnNlcnRUUG9wS29waWVfMiA9ICQuYWpheCh7XHJcblx0XHR0eXBlOiAncG9zdCcsXHJcblx0XHR1cmw6ICdwaHAvdHBvcF9pbnNlcnRfa29waWUucGhwJyxcclxuXHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRkYXRhOiBkYXRhXHJcblx0fSk7XHJcblx0aW5zZXJ0VFBvcEtvcGllXzIuYWx3YXlzKGZ1bmN0aW9uKHRwb3BfaWQpIHtcclxuXHRcdHZhciBzdHJ1a3R1cnR5cCA9IFwidHBvcFwiLFxyXG5cdFx0XHRiZXNjaHJpZnR1bmcgPSB3aW5kb3cuYXBmLnRwb3Bfb2JqZWt0X2tvcGllcnQuVFBvcE5yICsgXCIgXCIgKyB3aW5kb3cuYXBmLnRwb3Bfb2JqZWt0X2tvcGllcnQuVFBvcEZsdXJuYW1lO1xyXG5cdFx0d2luZG93LmFwZi5pbnNlcnROZXVlbk5vZGVBdWZHbGVpY2hlckhpZXJhcmNoaWVzdHVmZShha3RpdmVyX25vZGUsIHBhcmVudF9ub2RlLCBzdHJ1a3R1cnR5cCwgdHBvcF9pZCwgYmVzY2hyaWZ0dW5nKTtcclxuXHR9KTtcclxuXHRpbnNlcnRUUG9wS29waWVfMi5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBEaWUgVGVpbHBvcHVsYXRpb24gd3VyZGUgbmljaHQgZXJzdGVsbHRcIik7XHJcblx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBEaWUgVGVpbHBvcHVsYXRpb24gd3VyZGUgbmljaHQgZXJzdGVsbHQnKTtcclxuXHR9KTtcclxufTtcclxuXHJcbndpbmRvdy5hcGYucHLDvGZlTGVzZXZvcmF1c3NldHp1bmdlbiA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBrb250cm9sbGllcmVuLCBvYiBkZXIgVXNlciBvZmZsaW5lIGlzdFxyXG5cdGlmICghbmF2aWdhdG9yLm9uTGluZSkge1xyXG5cdFx0Y29uc29sZS5sb2coJ29mZmxpbmUnKTtcclxuXHRcdCQoXCIjb2ZmbGluZV9kaWFsb2dcIilcclxuICAgICAgICAgICAgLnNob3coKVxyXG4gICAgICAgICAgICAuZGlhbG9nKHtcclxuICAgICAgICAgICAgICAgIG1vZGFsOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgd2lkdGg6IDQwMCxcclxuICAgICAgICAgICAgICAgIGJ1dHRvbnM6IHtcclxuICAgICAgICAgICAgICAgICAgICBPazogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuZGlhbG9nKFwiY2xvc2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0cmV0dXJuIHRydWU7XHJcblx0fVxyXG59O1xyXG5cclxud2luZG93LmFwZi5wcsO8ZmVTY2hyZWlidm9yYXVzc2V0enVuZ2VuID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIGtvbnRyb2xsaWVyZW4sIG9iIGRlciBVc2VyIG9ubGluZSBpc3RcclxuXHRpZiAod2luZG93LmFwZi5wcsO8ZmVMZXNldm9yYXVzc2V0enVuZ2VuKCkpIHtcclxuXHRcdC8vIGtvbnRyb2xsaWVyZW4sIG9iIGRlciBVc2VyIFNjaHJlaWJyZWNodGUgaGF0XHJcblx0XHRpZiAoc2Vzc2lvblN0b3JhZ2UuTnVyTGVzZW4pIHtcclxuXHRcdFx0d2luZG93LmFwZi5tZWxkZShcIlNpZSBoYWJlbiBrZWluZSBTY2hyZWlicmVjaHRlXCIsIFwiU3BlaWNoZXJuIGFiZ2Vicm9jaGVuXCIpO1xyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblxyXG4vLyB3aXJkIHZvbiBhbGxlbiBGb3JtdWxhcmVuIGJlbnV0enRcclxuLy8gc3BlaWNoZXJ0IGRlbiBXZXJ0IGVpbmVzIEZlbGRlcyBpbiBlaW5lbSBGb3JtdWxhclxyXG4vLyDDvGJlcm5pbW10IGRhcyBPYmpla3QsIGluIGRlbSBnZcOkbmRlcnQgd3VyZGVcclxud2luZG93LmFwZi5zcGVpY2hlcm4gPSBmdW5jdGlvbih0aGF0KSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBmZWxkdHlwLFxyXG4gICAgICAgIGZvcm11bGFyLFxyXG4gICAgICAgIHRhYmVsbGVJbkRiLFxyXG4gICAgICAgIGlkSW5UYWJlbGxlLFxyXG4gICAgICAgIGZlbGRuYW1lLFxyXG4gICAgICAgIGZlbGR3ZXJ0LFxyXG4gICAgICAgIG9iamVrdCxcclxuICAgICAgICAkUG9wTmFtZSA9ICQoXCIjUG9wTmFtZVwiKSxcclxuICAgICAgICAkUG9wTnIgPSAkKFwiI1BvcE5yXCIpLFxyXG4gICAgICAgICR0cmVlID0gJChcIiN0cmVlXCIpLFxyXG4gICAgICAgICRQb3BCZXJKYWhyID0gJChcIiNQb3BCZXJKYWhyXCIpLFxyXG4gICAgICAgICRQb3BCZXJFbnR3aWNrbHVuZ0NoZWNrZWQgPSAkKCdpbnB1dFtuYW1lPVwiUG9wQmVyRW50d2lja2x1bmdcIl06Y2hlY2tlZCcpLFxyXG4gICAgICAgICRzcGFuUG9wQmVyRW50d2lja2x1bmdQbHVzJFBvcEJlckVudHdpY2tsdW5nQ2hlY2tlZCA9ICQoXCIjc3BhblBvcEJlckVudHdpY2tsdW5nXCIgKyAkUG9wQmVyRW50d2lja2x1bmdDaGVja2VkLnZhbCgpKSxcclxuICAgICAgICAkc3BhblBvcE1hc3NuQmVyRXJmb2xnc2JldXJ0ZWlsdW5nUGx1c1BvcE1hc3NuQmVyRXJmb2xnc2JldXJ0ZWlsdW5nQ2hlY2tlZCA9ICQoXCIjc3BhblBvcE1hc3NuQmVyRXJmb2xnc2JldXJ0ZWlsdW5nXCIgKyAkKCdpbnB1dFtuYW1lPVwiUG9wTWFzc25CZXJFcmZvbGdzYmV1cnRlaWx1bmdcIl06Y2hlY2tlZCcpLnZhbCgpKSxcclxuICAgICAgICAkUG9wTWFzc25CZXJKYWhyID0gJChcIiNQb3BNYXNzbkJlckphaHJcIiksXHJcbiAgICAgICAgJFRQb3BOciA9ICQoXCIjVFBvcE5yXCIpLFxyXG4gICAgICAgICRUUG9wRmx1cm5hbWUgPSAkKFwiI1RQb3BGbHVybmFtZVwiKSxcclxuICAgICAgICAkVFBvcEJlckphaHIgPSAkKFwiI1RQb3BCZXJKYWhyXCIpLFxyXG4gICAgICAgICRzcGFuVFBvcEJlckVudHdpY2tsdW5nUGx1c1RQb3BCZXJFbnR3aWNrbHVuZ0NoZWNrZWQgPSAkKFwiI3NwYW5UUG9wQmVyRW50d2lja2x1bmdcIiArICQoJ2lucHV0W25hbWU9XCJUUG9wQmVyRW50d2lja2x1bmdcIl06Y2hlY2tlZCcpLnZhbCgpKSxcclxuICAgICAgICAkVFBvcE1hc3NuSmFociA9ICQoXCIjVFBvcE1hc3NuSmFoclwiKSxcclxuICAgICAgICAkVFBvcE1hc3NuVHlwQ2hlY2tlZCA9ICQoXCIjVFBvcE1hc3NuVHlwIG9wdGlvbjpjaGVja2VkXCIpLFxyXG4gICAgICAgICRUUG9wTWFzc25CZXJKYWhyID0gJChcIiNUUG9wTWFzc25CZXJKYWhyXCIpLFxyXG4gICAgICAgICRzcGFuVFBvcE1hc3NuQmVyRXJmb2xnc2JldXJ0ZWlsdW5nUGx1c1RQb3BNYXNzbkJlckVyZm9sZ3NiZXVydGVpbHVuZ0NoZWNrZWQgPSAkKFwiI3NwYW5UUG9wTWFzc25CZXJFcmZvbGdzYmV1cnRlaWx1bmdcIiArICQoJ2lucHV0W25hbWU9XCJUUG9wTWFzc25CZXJFcmZvbGdzYmV1cnRlaWx1bmdcIl06Y2hlY2tlZCcpLnZhbCgpKSxcclxuICAgICAgICAkWmllbEJlckphaHIgPSAkKFwiI1ppZWxCZXJKYWhyXCIpLFxyXG4gICAgICAgICRaaWVsQmVyRXJyZWljaHVuZyA9ICQoXCIjWmllbEJlckVycmVpY2h1bmdcIiksXHJcbiAgICAgICAgJFNwYW5FcmZrcml0RXJyZWljaHVuZ3NncmFkUGx1c0VyZmtyaXRFcnJlaWNodW5nc2dyYWRDaGVja2VkID0gJChcIiNTcGFuRXJma3JpdEVycmVpY2h1bmdzZ3JhZFwiICsgJChcImlucHV0OnJhZGlvW25hbWU9J0VyZmtyaXRFcnJlaWNodW5nc2dyYWQnXTpjaGVja2VkXCIpLnZhbCgpKSxcclxuICAgICAgICAkQmVySmFociA9ICQoXCIjQmVySmFoclwiKSxcclxuICAgICAgICAkQmVyVGl0ZWwgPSAkKFwiI0JlclRpdGVsXCIpLFxyXG4gICAgICAgIGNvbmZpZ3VyYXRpb24gPSByZXF1aXJlKCcuL21vZHVsZXMvY29uZmlndXJhdGlvbicpO1xyXG5cclxuXHRpZiAod2luZG93LmFwZi5wcsO8ZmVTY2hyZWlidm9yYXVzc2V0enVuZ2VuKCkpIHtcclxuXHRcdGZvcm11bGFyID0gJCh0aGF0KS5hdHRyKFwiZm9ybXVsYXJcIik7XHJcbiAgICAgICAgLy8gZGllIHp1IGFrdHVhbGlzaWVyZW5kZSBUYWJlbGxlIGluIGRlciBEQlxyXG4gICAgICAgIHRhYmVsbGVJbkRiID0gY29uZmlndXJhdGlvbi5mb3Jtc1tmb3JtdWxhcl0udGFiZWxsZUluRGI7XHJcbiAgICAgICAgaWRJblRhYmVsbGUgPSBjb25maWd1cmF0aW9uLmZvcm1zW2Zvcm11bGFyXS5pZEluVGFiZWxsZTtcclxuXHRcdGZlbGRuYW1lID0gdGhhdC5uYW1lO1xyXG5cdFx0ZmVsZHR5cCA9ICQodGhhdCkuYXR0cihcInR5cGVcIikgfHwgbnVsbDtcclxuXHRcdC8vIEZlbGR3ZXJ0IGVybWl0dGVsblxyXG5cdFx0aWYgKGZlbGR0eXAgJiYgZmVsZHR5cCA9PT0gXCJjaGVja2JveFwiKSB7XHJcblx0XHRcdGZlbGR3ZXJ0ID0gJCgnaW5wdXQ6Y2hlY2tib3hbbmFtZT0nICsgZmVsZG5hbWUgKyAnXTpjaGVja2VkJykudmFsKCk7XHJcblx0XHR9IGVsc2UgaWYgKGZlbGR0eXAgJiYgZmVsZHR5cCA9PT0gXCJyYWRpb1wiKSB7XHJcblx0XHRcdGZlbGR3ZXJ0ID0gJCgnaW5wdXQ6cmFkaW9bbmFtZT0nICsgZmVsZG5hbWUgKyAnXTpjaGVja2VkJykudmFsKCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHQvLyB0ZXh0YXJlYSwgaW5wdXQsIHNlbGVjdFxyXG5cdFx0XHRmZWxkd2VydCA9ICQoXCIjXCIgKyBmZWxkbmFtZSkudmFsKCk7XHJcblx0XHR9XHJcblx0XHQvLyBqYS9uZWluIEZlbGRlciB6dSBib29sZWFuIHVtYmF1ZW5cclxuXHRcdGlmIChmZWxkbmFtZSA9PT0gXCJQb3BIZXJrdW5mdFVua2xhclwiIHx8IGZlbGRuYW1lID09PSBcIlRQb3BIZXJrdW5mdFVua2xhclwiIHx8IGZlbGRuYW1lID09PSBcIlRQb3BNYXNzblBsYW5cIiB8fCBmZWxkbmFtZSA9PT0gXCJUUG9wS29udHJQbGFuXCIpIHtcclxuXHRcdFx0aWYgKGZlbGR3ZXJ0KSB7XHJcblx0XHRcdFx0ZmVsZHdlcnQgPSAxO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGZlbGR3ZXJ0ID0gXCJcIjtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0aWYgKGZlbGRuYW1lID09PSBcIkJlb2JCZW1lcmt1bmdlblwiICYmIGxvY2FsU3RvcmFnZS5iZW9iX3N0YXR1cyA9PT0gXCJuaWNodF9iZXVydGVpbHRcIikge1xyXG5cdFx0XHQvLyBoaWVyIHNvbGwgbmljaHQgZ2VzcGVpY2hlcnQgd2VyZGVuXHJcblx0XHRcdCQoXCIjQmVvYkJlbWVya3VuZ2VuXCIpLnZhbChcIlwiKTtcclxuXHRcdFx0d2luZG93LmFwZi5tZWxkZShcIkJlbWVya3VuZ2VuIHNpbmQgbnVyIGluIHp1Z2VvcmRuZXRlbiBvZGVyIG5pY2h0IHp1enVvcmRuZW5kZW4gQmVvYmFjaHR1bmdlbiBtw7ZnbGljaFwiLCBcIkFrdGlvbiBhYmdlYnJvY2hlblwiKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0dmFyIHVwZGF0ZUZvcm11bGFyID0gJC5hamF4KHtcclxuXHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHR1cmw6ICdhcGkvYXA9JyArIGxvY2FsU3RvcmFnZS5hcF9pZCArICcvdGFiZWxsZT0nICsgdGFiZWxsZUluRGIgKyAnL3RhYmVsbGUtaWQ9JyArIGlkSW5UYWJlbGxlICsgJy9mZWxkPScgKyBmZWxkbmFtZSArICcvd2VydD0nICsgZmVsZHdlcnQgKyAnL3VzZXI9JyArIHNlc3Npb25TdG9yYWdlLlVzZXIsXHJcblx0XHRcdGRhdGFUeXBlOiAnanNvbidcclxuXHRcdH0pO1xyXG5cdFx0dXBkYXRlRm9ybXVsYXIuYWx3YXlzKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHQvLyBWYXJpYWJsZSBmw7xyIE9iamVrdCBuYWNoZsO8aHJlblxyXG5cdFx0XHR3aW5kb3cuYXBmW2Zvcm11bGFyXVtmZWxkbmFtZV0gPSBmZWxkd2VydDtcclxuXHRcdFx0Ly8gV2VubiBBcEFydElkIHZlcsOkbmRlcnQgd3VyZGU6IEZvcm11bGFyIGFrdHVhbGlzaWVyZW5cclxuXHRcdFx0aWYgKGZlbGRuYW1lID09PSBcIkFwQXJ0SWRcIiAmJiBmZWxkd2VydCkge1xyXG5cdFx0XHRcdHdpbmRvdy5hcGYud8OkaGxlQXAoZmVsZHdlcnQpO1xyXG5cdFx0XHRcdHJldHVybjtcclxuXHRcdFx0fVxyXG5cdFx0XHQvLyBXZW5uIGluIGZlbGRrb250ciBEYXR1bSBlcmZhc3N0LCBhdWNoIEphaHIgc3BlaWNoZXJuXHJcblx0XHRcdGlmIChmZWxkbmFtZSA9PT0gXCJUUG9wS29udHJEYXR1bVwiICYmIGZlbGR3ZXJ0KSB7XHJcblx0XHRcdFx0b2JqZWt0ID0ge307XHJcblx0XHRcdFx0b2JqZWt0Lm5hbWUgPSBcIlRQb3BLb250ckphaHJcIjtcclxuXHRcdFx0XHRvYmpla3QuZm9ybXVsYXIgPSBcInRwb3BmZWxka29udHJcIjtcclxuXHRcdFx0XHR3aW5kb3cuYXBmLnNwZWljaGVybihvYmpla3QpO1xyXG5cdFx0XHR9XHJcblx0XHRcdC8vIGRpdG8gYmVpIHRwb3BtYXNzblxyXG5cdFx0XHRpZiAoZmVsZG5hbWUgPT09IFwiVFBvcE1hc3NuRGF0dW1cIiAmJiBmZWxkd2VydCkge1xyXG5cdFx0XHRcdG9iamVrdCA9IHt9O1xyXG5cdFx0XHRcdG9iamVrdC5uYW1lID0gXCJUUG9wTWFzc25KYWhyXCI7XHJcblx0XHRcdFx0b2JqZWt0LmZvcm11bGFyID0gXCJ0cG9wbWFzc25cIjtcclxuXHRcdFx0XHR3aW5kb3cuYXBmLnNwZWljaGVybihvYmpla3QpO1xyXG5cdFx0XHR9XHJcblx0XHRcdC8vIHdlbm4gaW4gVFBvcEtvbnRyWmFlaGxlaW5oZWl0IDEgYmlzIDMgZWluIExlZXJ3ZXJ0IGVpbmdlZsO8aHJ0IHd1cmRlXHJcblx0XHRcdC8vIHNvbGxlbiBhdWNoIGRpZSBGZWxkZXIgVFBvcEtvbnRyTWV0aG9kZSAxIGJpcyAzIHVuZCBUUG9wS29udHJBbnogMSBiaXMgMyBMZWVyd2VydGUgZXJoYWx0ZW5cclxuXHRcdFx0aWYgKCFmZWxkd2VydCkge1xyXG5cdFx0XHRcdGlmIChmZWxkbmFtZSA9PT0gXCJUUG9wS29udHJaYWVobGVpbmhlaXQxXCIpIHtcclxuXHRcdFx0XHRcdC8vIFVJIGFrdHVhbGlzaWVyZW5cclxuXHRcdFx0XHRcdGlmICh3aW5kb3cuYXBmLnRwb3BmZWxka29udHIuVFBvcEtvbnRyTWV0aG9kZTEpIHtcclxuXHRcdFx0XHRcdFx0JChcIiNUUG9wS29udHJNZXRob2RlMVwiICsgd2luZG93LmFwZi50cG9wZmVsZGtvbnRyLlRQb3BLb250ck1ldGhvZGUxKS5wcm9wKFwiY2hlY2tlZFwiLCBmYWxzZSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHQkKFwiI1RQb3BLb250ckFuejFcIikudmFsKFwiXCIpO1xyXG5cdFx0XHRcdFx0Ly8gRGF0ZW5iYW5rIGFrdHVhbGlzaWVyZW5cclxuXHRcdFx0XHRcdC8vIEZlbGQgVFBvcEtvbnRyTWV0aG9kZTFcclxuXHRcdFx0XHRcdG9iamVrdCA9IHt9O1xyXG5cdFx0XHRcdFx0b2JqZWt0Lm5hbWUgPSBcIlRQb3BLb250ck1ldGhvZGUxXCI7XHJcblx0XHRcdFx0XHRvYmpla3QuZm9ybXVsYXIgPSBmb3JtdWxhcjtcclxuXHRcdFx0XHRcdHdpbmRvdy5hcGYuc3BlaWNoZXJuKG9iamVrdCk7XHJcblx0XHRcdFx0XHQvLyBGZWxkIFRQb3BLb250ckFuejFcclxuXHRcdFx0XHRcdG9iamVrdCA9IHt9O1xyXG5cdFx0XHRcdFx0b2JqZWt0Lm5hbWUgPSBcIlRQb3BLb250ckFuejFcIjtcclxuXHRcdFx0XHRcdG9iamVrdC5mb3JtdWxhciA9IGZvcm11bGFyO1xyXG5cdFx0XHRcdFx0d2luZG93LmFwZi5zcGVpY2hlcm4ob2JqZWt0KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKGZlbGRuYW1lID09PSBcIlRQb3BLb250clphZWhsZWluaGVpdDJcIikge1xyXG5cdFx0XHRcdFx0Ly8gVUkgYWt0dWFsaXNpZXJlblxyXG5cdFx0XHRcdFx0aWYgKHdpbmRvdy5hcGYudHBvcGZlbGRrb250ci5UUG9wS29udHJNZXRob2RlMikge1xyXG5cdFx0XHRcdFx0XHQkKFwiI1RQb3BLb250ck1ldGhvZGUyXCIgKyB3aW5kb3cuYXBmLnRwb3BmZWxka29udHIuVFBvcEtvbnRyTWV0aG9kZTIpLnByb3AoXCJjaGVja2VkXCIsIGZhbHNlKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdCQoXCIjVFBvcEtvbnRyQW56MlwiKS52YWwoXCJcIik7XHJcblx0XHRcdFx0XHQvLyBEYXRlbmJhbmsgYWt0dWFsaXNpZXJlblxyXG5cdFx0XHRcdFx0Ly8gRmVsZCBUUG9wS29udHJNZXRob2RlMlxyXG5cdFx0XHRcdFx0b2JqZWt0ID0ge307XHJcblx0XHRcdFx0XHRvYmpla3QubmFtZSA9IFwiVFBvcEtvbnRyTWV0aG9kZTJcIjtcclxuXHRcdFx0XHRcdG9iamVrdC5mb3JtdWxhciA9IGZvcm11bGFyO1xyXG5cdFx0XHRcdFx0d2luZG93LmFwZi5zcGVpY2hlcm4ob2JqZWt0KTtcclxuXHRcdFx0XHRcdC8vIEZlbGQgVFBvcEtvbnRyQW56MlxyXG5cdFx0XHRcdFx0b2JqZWt0ID0ge307XHJcblx0XHRcdFx0XHRvYmpla3QubmFtZSA9IFwiVFBvcEtvbnRyQW56MlwiO1xyXG5cdFx0XHRcdFx0b2JqZWt0LmZvcm11bGFyID0gZm9ybXVsYXI7XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLnNwZWljaGVybihvYmpla3QpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAoZmVsZG5hbWUgPT09IFwiVFBvcEtvbnRyWmFlaGxlaW5oZWl0M1wiKSB7XHJcblx0XHRcdFx0XHQvLyBVSSBha3R1YWxpc2llcmVuXHJcblx0XHRcdFx0XHRpZiAod2luZG93LmFwZi50cG9wZmVsZGtvbnRyLlRQb3BLb250ck1ldGhvZGUzKSB7XHJcblx0XHRcdFx0XHRcdCQoXCIjVFBvcEtvbnRyTWV0aG9kZTNcIiArIHdpbmRvdy5hcGYudHBvcGZlbGRrb250ci5UUG9wS29udHJNZXRob2RlMykucHJvcChcImNoZWNrZWRcIiwgZmFsc2UpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0JChcIiNUUG9wS29udHJBbnozXCIpLnZhbChcIlwiKTtcclxuXHRcdFx0XHRcdC8vIERhdGVuYmFuayBha3R1YWxpc2llcmVuXHJcblx0XHRcdFx0XHQvLyBGZWxkIFRQb3BLb250ck1ldGhvZGUzXHJcblx0XHRcdFx0XHRvYmpla3QgPSB7fTtcclxuXHRcdFx0XHRcdG9iamVrdC5uYW1lID0gXCJUUG9wS29udHJNZXRob2RlM1wiO1xyXG5cdFx0XHRcdFx0b2JqZWt0LmZvcm11bGFyID0gZm9ybXVsYXI7XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLnNwZWljaGVybihvYmpla3QpO1xyXG5cdFx0XHRcdFx0Ly8gRmVsZCBUUG9wS29udHJBbnozXHJcblx0XHRcdFx0XHRvYmpla3QgPSB7fTtcclxuXHRcdFx0XHRcdG9iamVrdC5uYW1lID0gXCJUUG9wS29udHJBbnozXCI7XHJcblx0XHRcdFx0XHRvYmpla3QuZm9ybXVsYXIgPSBmb3JtdWxhcjtcclxuXHRcdFx0XHRcdHdpbmRvdy5hcGYuc3BlaWNoZXJuKG9iamVrdCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRcdHVwZGF0ZUZvcm11bGFyLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogRGllIGxldHp0ZSDDhG5kZXJ1bmcgd3VyZGUgbmljaHQgZ2VzcGVpY2hlcnRcIik7XHJcblx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IERpZSBsZXR6dGUgw4RuZGVydW5nIHd1cmRlIG5pY2h0IGdlc3BlaWNoZXJ0Jyk7XHJcblx0XHR9KTtcclxuXHRcdC8vIG5vZGVzIGltIFRyZWUgdXBkYXRlbiwgd2VubiBkZXJlbiBCZXplaWNobnVuZyDDpG5kZXJ0XHJcblx0XHRzd2l0Y2goZmVsZG5hbWUpIHtcclxuXHRcdFx0Y2FzZSBcIlBvcE5yXCI6XHJcblx0XHRcdGNhc2UgXCJQb3BOYW1lXCI6XHJcblx0XHRcdFx0dmFyIHBvcGJlc2NocmlmdHVuZztcclxuXHRcdFx0XHRpZiAoJFBvcE5hbWUudmFsKCkgJiYgJFBvcE5yLnZhbCgpKSB7XHJcblx0XHRcdFx0XHRwb3BiZXNjaHJpZnR1bmcgPSAkUG9wTnIudmFsKCkgKyBcIjogXCIgKyAkUG9wTmFtZS52YWwoKTtcclxuXHRcdFx0XHR9IGVsc2UgaWYgKCRQb3BOYW1lLnZhbCgpKSB7XHJcblx0XHRcdFx0XHRwb3BiZXNjaHJpZnR1bmcgPSBcIihrZWluZSBOcik6IFwiICsgJFBvcE5hbWUudmFsKCk7XHJcblx0XHRcdFx0fSBlbHNlIGlmICgkUG9wTnIudmFsKCkpIHtcclxuXHRcdFx0XHRcdHBvcGJlc2NocmlmdHVuZyA9ICRQb3BOci52YWwoKSArIFwiOiAoa2VpbiBOYW1lKVwiO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRwb3BiZXNjaHJpZnR1bmcgPSBcIihrZWluZSBOciwga2VpbiBOYW1lKVwiO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQkdHJlZS5qc3RyZWUoXCJyZW5hbWVfbm9kZVwiLCBcIlt0eXA9J2FwX29yZG5lcl9wb3AnXSAjXCIgKyBsb2NhbFN0b3JhZ2UucG9wX2lkLCBwb3BiZXNjaHJpZnR1bmcpO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlIFwiUG9wQmVySmFoclwiOlxyXG5cdFx0XHRjYXNlIFwiUG9wQmVyRW50d2lja2x1bmdcIjpcclxuXHRcdFx0XHR2YXIgcG9wYmVyYmVzY2hyaWZ0dW5nO1xyXG5cdFx0XHRcdGlmICgkUG9wQmVySmFoci52YWwoKSAmJiAkc3BhblBvcEJlckVudHdpY2tsdW5nUGx1cyRQb3BCZXJFbnR3aWNrbHVuZ0NoZWNrZWQudGV4dCgpKSB7XHJcblx0XHRcdFx0XHRwb3BiZXJiZXNjaHJpZnR1bmcgPSAkUG9wQmVySmFoci52YWwoKSArIFwiOiBcIiArICRzcGFuUG9wQmVyRW50d2lja2x1bmdQbHVzJFBvcEJlckVudHdpY2tsdW5nQ2hlY2tlZC50ZXh0KCk7XHJcblx0XHRcdFx0fSBlbHNlIGlmICgkUG9wQmVySmFoci52YWwoKSkge1xyXG5cdFx0XHRcdFx0cG9wYmVyYmVzY2hyaWZ0dW5nID0gJFBvcEJlckphaHIudmFsKCkgKyBcIjogKGtlaW4gU3RhdHVzKVwiO1xyXG5cdFx0XHRcdH0gZWxzZSBpZiAoJHNwYW5Qb3BCZXJFbnR3aWNrbHVuZ1BsdXMkUG9wQmVyRW50d2lja2x1bmdDaGVja2VkLnRleHQoKSkge1xyXG5cdFx0XHRcdFx0cG9wYmVyYmVzY2hyaWZ0dW5nID0gXCIoa2VpbiBKYWhyKTogXCIgKyAkc3BhblBvcEJlckVudHdpY2tsdW5nUGx1cyRQb3BCZXJFbnR3aWNrbHVuZ0NoZWNrZWQudGV4dCgpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRwb3BiZXJiZXNjaHJpZnR1bmcgPSBcIihrZWluIEphaHIpOiAoa2VpbiBTdGF0dXMpXCI7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdCR0cmVlLmpzdHJlZShcInJlbmFtZV9ub2RlXCIsIFwiW3R5cD0ncG9wX29yZG5lcl9wb3BiZXInXSAjXCIgKyBsb2NhbFN0b3JhZ2UucG9wYmVyX2lkLCBwb3BiZXJiZXNjaHJpZnR1bmcpO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlIFwiUG9wTWFzc25CZXJKYWhyXCI6XHJcblx0XHRcdGNhc2UgXCJQb3BNYXNzbkJlckVyZm9sZ3NiZXVydGVpbHVuZ1wiOlxyXG5cdFx0XHRcdHZhciBwb3BtYXNzbmJlcmJlc2NocmlmdHVuZztcclxuXHRcdFx0XHRpZiAoJFBvcE1hc3NuQmVySmFoci52YWwoKSAmJiAkc3BhblBvcE1hc3NuQmVyRXJmb2xnc2JldXJ0ZWlsdW5nUGx1c1BvcE1hc3NuQmVyRXJmb2xnc2JldXJ0ZWlsdW5nQ2hlY2tlZC50ZXh0KCkpIHtcclxuXHRcdFx0XHRcdHBvcG1hc3NuYmVyYmVzY2hyaWZ0dW5nID0gJFBvcE1hc3NuQmVySmFoci52YWwoKSArIFwiOiBcIiArICRzcGFuUG9wTWFzc25CZXJFcmZvbGdzYmV1cnRlaWx1bmdQbHVzUG9wTWFzc25CZXJFcmZvbGdzYmV1cnRlaWx1bmdDaGVja2VkLnRleHQoKTtcclxuXHRcdFx0XHR9IGVsc2UgaWYgKCRQb3BNYXNzbkJlckphaHIudmFsKCkpIHtcclxuXHRcdFx0XHRcdHBvcG1hc3NuYmVyYmVzY2hyaWZ0dW5nID0gJFBvcE1hc3NuQmVySmFoci52YWwoKSArIFwiOiAobmljaHQgYmV1cnRlaWx0KVwiO1xyXG5cdFx0XHRcdH0gZWxzZSBpZiAoJHNwYW5Qb3BNYXNzbkJlckVyZm9sZ3NiZXVydGVpbHVuZ1BsdXNQb3BNYXNzbkJlckVyZm9sZ3NiZXVydGVpbHVuZ0NoZWNrZWQudGV4dCgpKSB7XHJcblx0XHRcdFx0XHRwb3BtYXNzbmJlcmJlc2NocmlmdHVuZyA9IFwiKGtlaW4gSmFocik6IFwiICsgJHNwYW5Qb3BNYXNzbkJlckVyZm9sZ3NiZXVydGVpbHVuZ1BsdXNQb3BNYXNzbkJlckVyZm9sZ3NiZXVydGVpbHVuZ0NoZWNrZWQudGV4dCgpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRwb3BtYXNzbmJlcmJlc2NocmlmdHVuZyA9IFwiKGtlaW4gSmFocik6IChuaWNodCBiZXVydGVpbHQpXCI7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdCR0cmVlLmpzdHJlZShcInJlbmFtZV9ub2RlXCIsIFwiW3R5cD0ncG9wX29yZG5lcl9tYXNzbmJlciddICNcIiArIGxvY2FsU3RvcmFnZS5wb3BtYXNzbmJlcl9pZCwgcG9wbWFzc25iZXJiZXNjaHJpZnR1bmcpO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlIFwiVFBvcE5yXCI6XHJcblx0XHRcdGNhc2UgXCJUUG9wRmx1cm5hbWVcIjpcclxuXHRcdFx0XHR2YXIgdHBvcGJlc2NocmlmdHVuZztcclxuXHRcdFx0XHRpZiAoJFRQb3BOci52YWwoKSAmJiAkVFBvcEZsdXJuYW1lLnZhbCgpKSB7XHJcblx0XHRcdFx0XHR0cG9wYmVzY2hyaWZ0dW5nID0gJFRQb3BOci52YWwoKSArIFwiOiBcIiArICRUUG9wRmx1cm5hbWUudmFsKCk7XHJcblx0XHRcdFx0fSBlbHNlIGlmICgkVFBvcEZsdXJuYW1lLnZhbCgpKSB7XHJcblx0XHRcdFx0XHR0cG9wYmVzY2hyaWZ0dW5nID0gXCIoa2VpbmUgTnIpOiBcIiArICRUUG9wRmx1cm5hbWUudmFsKCk7XHJcblx0XHRcdFx0fSBlbHNlIGlmICgkVFBvcE5yLnZhbCgpKSB7XHJcblx0XHRcdFx0XHR0cG9wYmVzY2hyaWZ0dW5nID0gJFRQb3BOci52YWwoKSArIFwiOiAoa2VpbiBGbHVybmFtZSlcIjtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0dHBvcGJlc2NocmlmdHVuZyA9IFwiKGtlaW5lIE5yLCBrZWluIEZsdXJuYW1lKVwiO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQkdHJlZS5qc3RyZWUoXCJyZW5hbWVfbm9kZVwiLCBcIlt0eXA9J3BvcF9vcmRuZXJfdHBvcCddICNcIiArIGxvY2FsU3RvcmFnZS50cG9wX2lkLCB0cG9wYmVzY2hyaWZ0dW5nKTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSBcIlRQb3BLb250clR5cFwiOlxyXG5cdFx0XHRjYXNlIFwiVFBvcEtvbnRySmFoclwiOlxyXG5cdFx0XHRcdC8vIHdlbm4ga2VpbiBUeXAvSmFociBnZXfDpGhsdDogXCIoa2VpbiBUeXAvSmFocilcIlxyXG5cdFx0XHRcdHZhciB0cG9wa29udHJqYWhyID0gXCIoa2VpbiBKYWhyKVwiLFxyXG5cdFx0XHRcdFx0dHBvcGZlbGRrb250cl9sYWJlbCxcclxuXHRcdFx0XHRcdCRUUG9wS29udHJKYWhyID0gJChcIiNUUG9wS29udHJKYWhyXCIpLnZhbCgpO1xyXG5cdFx0XHRcdGlmICgkVFBvcEtvbnRySmFocikge1xyXG5cdFx0XHRcdFx0dHBvcGtvbnRyamFociA9ICRUUG9wS29udHJKYWhyO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQvLyBQcm9ibGVtOiBFcyBpc3QgbmljaHQgYmVrYW5udCwgb2IgZWluZSBGcmVpd2lsbGlnZW5rb250cm9sbGUgdW1iZW5uYW50IHdpcmQgb2RlciBlaW5lIEZlbGRrb250cm9sbGVcclxuXHRcdFx0XHQvLyBMw7ZzdW5nOiBCZWlkZSBub2RlcyB1bWJlbmVubmVuLiBOdXIgZWluZSBkYXZvbiBoYXQgZGllIHJpY2h0aWdlIGlkXHJcblx0XHRcdFx0JHRyZWUuanN0cmVlKFwicmVuYW1lX25vZGVcIiwgXCJbdHlwPSd0cG9wX29yZG5lcl9mcmVpd2tvbnRyJ10gI1wiICsgbG9jYWxTdG9yYWdlLnRwb3BmZWxka29udHJfaWQsIHRwb3Brb250cmphaHIpO1xyXG5cdFx0XHRcdHRwb3BmZWxka29udHJfbGFiZWwgPSB3aW5kb3cuYXBmLmVyc3RlbGxlTGFiZWxGw7xyRmVsZGtvbnRyb2xsZSgkVFBvcEtvbnRySmFociwgJChcIiNzcGFuVFBvcEtvbnRyVHlwXCIgKyAkKCdpbnB1dFtuYW1lPVwiVFBvcEtvbnRyVHlwXCJdOmNoZWNrZWQnKS52YWwoKSkudGV4dCgpKTtcclxuXHRcdFx0XHQkdHJlZS5qc3RyZWUoXCJyZW5hbWVfbm9kZVwiLCBcIlt0eXA9J3Rwb3Bfb3JkbmVyX2ZlbGRrb250ciddICNcIiArIGxvY2FsU3RvcmFnZS50cG9wZmVsZGtvbnRyX2lkLCB0cG9wZmVsZGtvbnRyX2xhYmVsKTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSBcIlRQb3BCZXJKYWhyXCI6XHJcblx0XHRcdGNhc2UgXCJUUG9wQmVyRW50d2lja2x1bmdcIjpcclxuXHRcdFx0XHQvLyB3ZW5uIGtlaW4gSmFoci9FbnR3aWNrbHVuZyBnZXfDpGhsdDogXCIoa2VpbiBKYWhyL0VudHdpY2tsdW5nKVwiXHJcblx0XHRcdFx0dmFyIHRwb3BiZXJqYWhyLCB0cG9wYmVyZW50d2lja2x1bmc7XHJcblx0XHRcdFx0aWYgKCRUUG9wQmVySmFoci52YWwoKSkge1xyXG5cdFx0XHRcdFx0dHBvcGJlcmphaHIgPSAkVFBvcEJlckphaHIudmFsKCk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHRwb3BiZXJqYWhyID0gXCIoa2VpbiBKYWhyKVwiO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAoJHNwYW5UUG9wQmVyRW50d2lja2x1bmdQbHVzVFBvcEJlckVudHdpY2tsdW5nQ2hlY2tlZC50ZXh0KCkpIHtcclxuXHRcdFx0XHRcdHRwb3BiZXJlbnR3aWNrbHVuZyA9ICRzcGFuVFBvcEJlckVudHdpY2tsdW5nUGx1c1RQb3BCZXJFbnR3aWNrbHVuZ0NoZWNrZWQudGV4dCgpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHR0cG9wYmVyZW50d2lja2x1bmcgPSBcIihrZWluZSBCZXVydGVpbHVuZylcIjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0JHRyZWUuanN0cmVlKFwicmVuYW1lX25vZGVcIiwgXCJbdHlwPSd0cG9wX29yZG5lcl90cG9wYmVyJ10gI1wiICsgbG9jYWxTdG9yYWdlLnRwb3BiZXJfaWQsIHRwb3BiZXJqYWhyICsgXCI6IFwiICsgdHBvcGJlcmVudHdpY2tsdW5nKTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSBcIlRQb3BNYXNzbkphaHJcIjpcclxuXHRcdFx0Y2FzZSBcIlRQb3BNYXNzblR5cFwiOlxyXG5cdFx0XHRcdC8vIHdlbm4ga2VpbiBUeXAvSmFociBnZXfDpGhsdDogXCIoa2VpbiBUeXAvSmFocilcIlxyXG5cdFx0XHRcdHZhciB0cG9wbWFzc25iZXplaWNobnVuZztcclxuXHRcdFx0XHRpZiAoJFRQb3BNYXNzbkphaHIudmFsKCkgJiYgJFRQb3BNYXNzblR5cENoZWNrZWQudGV4dCgpKSB7XHJcblx0XHRcdFx0XHR0cG9wbWFzc25iZXplaWNobnVuZyA9ICRUUG9wTWFzc25KYWhyLnZhbCgpICsgXCI6IFwiICsgJFRQb3BNYXNzblR5cENoZWNrZWQudGV4dCgpO1xyXG5cdFx0XHRcdH0gZWxzZSBpZiAoJFRQb3BNYXNzbkphaHIudmFsKCkpIHtcclxuXHRcdFx0XHRcdHRwb3BtYXNzbmJlemVpY2hudW5nID0gJFRQb3BNYXNzbkphaHIudmFsKCkgKyBcIjogKGtlaW4gVHlwKVwiO1xyXG5cdFx0XHRcdH0gZWxzZSBpZiAoJFRQb3BNYXNzblR5cENoZWNrZWQudGV4dCgpKSB7XHJcblx0XHRcdFx0XHR0cG9wbWFzc25iZXplaWNobnVuZyA9IFwiKGtlaW4gSmFocik6IFwiICsgJFRQb3BNYXNzblR5cENoZWNrZWQudGV4dCgpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHR0cG9wbWFzc25iZXplaWNobnVuZyA9IFwiKGtlaW4gSmFocik6IChrZWluIFR5cClcIjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dHBvcG1hc3NuYmV6ZWljaG51bmcgPSB3aW5kb3cuYXBmLmVyc3RlbGxlTGFiZWxGw7xyTWFzc25haG1lKCRUUG9wTWFzc25KYWhyLnZhbCgpLCAkVFBvcE1hc3NuVHlwQ2hlY2tlZC50ZXh0KCkpO1xyXG5cdFx0XHRcdCR0cmVlLmpzdHJlZShcInJlbmFtZV9ub2RlXCIsIFwiW3R5cD0ndHBvcF9vcmRuZXJfbWFzc24nXSAjXCIgKyBsb2NhbFN0b3JhZ2UudHBvcG1hc3NuX2lkLCB0cG9wbWFzc25iZXplaWNobnVuZyk7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgXCJUUG9wTWFzc25CZXJKYWhyXCI6XHJcblx0XHRcdGNhc2UgXCJUUG9wTWFzc25CZXJFcmZvbGdzYmV1cnRlaWx1bmdcIjpcclxuXHRcdFx0XHQvLyB3ZW5uIGtlaW4gSmFoci9CZXVydGVpbHVuZzogXCIoa2VpbiBKYWhyL0JldXJ0ZWlsdW5nKVwiXHJcblx0XHRcdFx0dmFyIHRwb3BtYXNzYmVyYmVzY2hyaWZ0dW5nO1xyXG5cdFx0XHRcdGlmICgkVFBvcE1hc3NuQmVySmFoci52YWwoKSAmJiAkc3BhblRQb3BNYXNzbkJlckVyZm9sZ3NiZXVydGVpbHVuZ1BsdXNUUG9wTWFzc25CZXJFcmZvbGdzYmV1cnRlaWx1bmdDaGVja2VkLnRleHQoKSkge1xyXG5cdFx0XHRcdFx0dHBvcG1hc3NiZXJiZXNjaHJpZnR1bmcgPSAkVFBvcE1hc3NuQmVySmFoci52YWwoKSArIFwiOiBcIiArICRzcGFuVFBvcE1hc3NuQmVyRXJmb2xnc2JldXJ0ZWlsdW5nUGx1c1RQb3BNYXNzbkJlckVyZm9sZ3NiZXVydGVpbHVuZ0NoZWNrZWQudGV4dCgpO1xyXG5cdFx0XHRcdH0gZWxzZSBpZiAoJFRQb3BNYXNzbkJlckphaHIudmFsKCkpIHtcclxuXHRcdFx0XHRcdHRwb3BtYXNzYmVyYmVzY2hyaWZ0dW5nID0gJFRQb3BNYXNzbkJlckphaHIudmFsKCkgKyBcIjogKGtlaW5lIEJldXJ0ZWlsdW5nKVwiO1xyXG5cdFx0XHRcdH0gZWxzZSBpZiAoJHNwYW5UUG9wTWFzc25CZXJFcmZvbGdzYmV1cnRlaWx1bmdQbHVzVFBvcE1hc3NuQmVyRXJmb2xnc2JldXJ0ZWlsdW5nQ2hlY2tlZC50ZXh0KCkpIHtcclxuXHRcdFx0XHRcdHRwb3BtYXNzYmVyYmVzY2hyaWZ0dW5nID0gXCIoa2VpbiBKYWhyKTogXCIgKyAkc3BhblRQb3BNYXNzbkJlckVyZm9sZ3NiZXVydGVpbHVuZ1BsdXNUUG9wTWFzc25CZXJFcmZvbGdzYmV1cnRlaWx1bmdDaGVja2VkLnRleHQoKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0dHBvcG1hc3NiZXJiZXNjaHJpZnR1bmcgPSBcIihrZWluIEphaHIpOiAoa2VpbmUgQmV1cnRlaWx1bmcpXCI7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdCR0cmVlLmpzdHJlZShcInJlbmFtZV9ub2RlXCIsIFwiW3R5cD0ndHBvcF9vcmRuZXJfbWFzc25iZXInXSAjXCIgKyBsb2NhbFN0b3JhZ2UudHBvcG1hc3NuYmVyX2lkLCB0cG9wbWFzc2JlcmJlc2NocmlmdHVuZyk7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgXCJaaWVsQmV6ZWljaG51bmdcIjpcclxuXHRcdFx0XHR2YXIgemllbGJlc2NocmlmdHVuZztcclxuXHRcdFx0XHRpZiAoZmVsZHdlcnQpIHtcclxuXHRcdFx0XHRcdHppZWxiZXNjaHJpZnR1bmcgPSBmZWxkd2VydDtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0emllbGJlc2NocmlmdHVuZyA9IFwiKFppZWwgbmljaHQgYmVzY2hyaWViZW4pXCI7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdCR0cmVlLmpzdHJlZShcInJlbmFtZV9ub2RlXCIsIFwiW3R5cD0nYXB6aWVsamFociddICNcIiArIGxvY2FsU3RvcmFnZS5hcHppZWxfaWQsIHppZWxiZXNjaHJpZnR1bmcpO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlIFwiWmllbEJlckphaHJcIjpcclxuXHRcdFx0Y2FzZSBcIlppZWxCZXJFcnJlaWNodW5nXCI6XHJcblx0XHRcdFx0dmFyIHppZWxiZXJiZXNjaHJpZnR1bmc7XHJcblx0XHRcdFx0aWYgKCRaaWVsQmVySmFoci52YWwoKSAmJiAkWmllbEJlckVycmVpY2h1bmcudmFsKCkpIHtcclxuXHRcdFx0XHRcdHppZWxiZXJiZXNjaHJpZnR1bmcgPSAkWmllbEJlckphaHIudmFsKCkgKyBcIjogXCIgKyAkWmllbEJlckVycmVpY2h1bmcudmFsKCk7XHJcblx0XHRcdFx0fSBlbHNlIGlmICgkWmllbEJlckphaHIudmFsKCkpIHtcclxuXHRcdFx0XHRcdHppZWxiZXJiZXNjaHJpZnR1bmcgPSAkWmllbEJlckphaHIudmFsKCkgKyBcIjogKGtlaW5lIEJldXJ0ZWlsdW5nKVwiO1xyXG5cdFx0XHRcdH0gZWxzZSBpZiAoJFppZWxCZXJFcnJlaWNodW5nLnZhbCgpKSB7XHJcblx0XHRcdFx0XHR6aWVsYmVyYmVzY2hyaWZ0dW5nID0gXCIoa2VpbiBKYWhyKTogXCIgKyAkWmllbEJlckVycmVpY2h1bmcudmFsKCk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHppZWxiZXJiZXNjaHJpZnR1bmcgPSBcIihrZWluIEphaHIpOiAoa2VpbmUgQmV1cnRlaWx1bmcpXCI7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdCR0cmVlLmpzdHJlZShcInJlbmFtZV9ub2RlXCIsIFwiW3R5cD0nemllbGJlcl9vcmRuZXInXSAjXCIgKyBsb2NhbFN0b3JhZ2UuemllbGJlcl9pZCwgemllbGJlcmJlc2NocmlmdHVuZyk7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgXCJFcmZrcml0RXJyZWljaHVuZ3NncmFkXCI6XHJcblx0XHRcdGNhc2UgXCJFcmZrcml0VHh0XCI6XHJcblx0XHRcdFx0dmFyIGVyZmtyaXRiZXNjaHJpZnR1bmc7XHJcblx0XHRcdFx0aWYgKCRTcGFuRXJma3JpdEVycmVpY2h1bmdzZ3JhZFBsdXNFcmZrcml0RXJyZWljaHVuZ3NncmFkQ2hlY2tlZC50ZXh0KCkgJiYgJChcIiNFcmZrcml0VHh0XCIpLnZhbCgpKSB7XHJcblx0XHRcdFx0XHRlcmZrcml0YmVzY2hyaWZ0dW5nID0gJFNwYW5FcmZrcml0RXJyZWljaHVuZ3NncmFkUGx1c0VyZmtyaXRFcnJlaWNodW5nc2dyYWRDaGVja2VkLnRleHQoKSArIFwiOiBcIiArICQoXCIjRXJma3JpdFR4dFwiKS52YWwoKTtcclxuXHRcdFx0XHR9IGVsc2UgaWYgKCRTcGFuRXJma3JpdEVycmVpY2h1bmdzZ3JhZFBsdXNFcmZrcml0RXJyZWljaHVuZ3NncmFkQ2hlY2tlZC50ZXh0KCkpIHtcclxuXHRcdFx0XHRcdGVyZmtyaXRiZXNjaHJpZnR1bmcgPSAkU3BhbkVyZmtyaXRFcnJlaWNodW5nc2dyYWRQbHVzRXJma3JpdEVycmVpY2h1bmdzZ3JhZENoZWNrZWQudGV4dCgpICsgXCI6IChrZWluIEtyaXRlcml1bSlcIjtcclxuXHRcdFx0XHR9IGVsc2UgaWYgKCQoXCIjRXJma3JpdFR4dFwiKS52YWwoKSkge1xyXG5cdFx0XHRcdFx0ZXJma3JpdGJlc2NocmlmdHVuZyA9IFwiKGtlaW5lIEJldXJ0ZWlsdW5nKTogXCIgKyAkKFwiI0VyZmtyaXRUeHRcIikudmFsKCk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdGVyZmtyaXRiZXNjaHJpZnR1bmcgPSBcIihrZWluZSBCZXVydGVpbHVuZyk6IChrZWluIEtyaXRlcml1bSlcIjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0JHRyZWUuanN0cmVlKFwicmVuYW1lX25vZGVcIiwgXCJbdHlwPSdhcF9vcmRuZXJfZXJma3JpdCddICNcIiArIGxvY2FsU3RvcmFnZS5lcmZrcml0X2lkLCBlcmZrcml0YmVzY2hyaWZ0dW5nKTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSBcIkpCZXJKYWhyXCI6XHJcblx0XHRcdFx0dmFyIGpiZXJiZXNjaHJpZnR1bmc7XHJcblx0XHRcdFx0aWYgKGZlbGR3ZXJ0KSB7XHJcblx0XHRcdFx0XHRqYmVyYmVzY2hyaWZ0dW5nID0gZmVsZHdlcnQ7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdGpiZXJiZXNjaHJpZnR1bmcgPSBcIihrZWluIEphaHIpXCI7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdCR0cmVlLmpzdHJlZShcInJlbmFtZV9ub2RlXCIsIFwiW3R5cD0nYXBfb3JkbmVyX2piZXInXSAjXCIgKyBsb2NhbFN0b3JhZ2UuamJlcl9pZCwgamJlcmJlc2NocmlmdHVuZyk7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgXCJCZXJUaXRlbFwiOlxyXG5cdFx0XHRjYXNlIFwiQmVySmFoclwiOlxyXG5cdFx0XHRcdHZhciBiZXJiZXNjaHJpZnR1bmc7XHJcblx0XHRcdFx0aWYgKCRCZXJKYWhyLnZhbCgpICYmICRCZXJUaXRlbC52YWwoKSkge1xyXG5cdFx0XHRcdFx0YmVyYmVzY2hyaWZ0dW5nID0gJEJlckphaHIudmFsKCkgKyBcIjogXCIgKyAkQmVyVGl0ZWwudmFsKCk7XHJcblx0XHRcdFx0fSBlbHNlIGlmICgkQmVySmFoci52YWwoKSkge1xyXG5cdFx0XHRcdFx0YmVyYmVzY2hyaWZ0dW5nID0gJEJlckphaHIudmFsKCkgKyBcIjogKGtlaW4gVGl0ZWwpXCI7XHJcblx0XHRcdFx0fSBlbHNlIGlmICgkQmVyVGl0ZWwudmFsKCkpIHtcclxuXHRcdFx0XHRcdGJlcmJlc2NocmlmdHVuZyA9IFwiKGtlaW4gSmFocik6IFwiICsgJEJlclRpdGVsLnZhbCgpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRiZXJiZXNjaHJpZnR1bmcgPSBcIihrZWluIEphaHIpOiAoa2VpbiBUaXRlbClcIjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0JHRyZWUuanN0cmVlKFwicmVuYW1lX25vZGVcIiwgXCJbdHlwPSdhcF9vcmRuZXJfYmVyJ10gI1wiICsgbG9jYWxTdG9yYWdlLmJlcl9pZCwgYmVyYmVzY2hyaWZ0dW5nKTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSBcIkFhU2lzZk5yXCI6XHJcblx0XHRcdFx0dmFyIGFhYmVzY2hyaWZ0dW5nO1xyXG5cdFx0XHRcdGlmIChmZWxkd2VydCkge1xyXG5cdFx0XHRcdFx0YWFiZXNjaHJpZnR1bmcgPSAkKFwiI0FhU2lzZk5yIG9wdGlvblt2YWx1ZT0nXCIgKyBmZWxkd2VydCArIFwiJ11cIikudGV4dCgpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRhYWJlc2NocmlmdHVuZyA9IFwiKGtlaW4gQXJ0bmFtZSlcIjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0JHRyZWUuanN0cmVlKFwicmVuYW1lX25vZGVcIiwgXCJbdHlwPSdhcF9vcmRuZXJfYXNzb3phcnRlbiddICNcIiArIGxvY2FsU3RvcmFnZS5hc3NvemFydGVuX2lkLCBhYWJlc2NocmlmdHVuZyk7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHR9XHJcblx0fVxyXG59O1xyXG5cclxuKGZ1bmN0aW9uKCQpIHtcclxuXHQvLyBmcmllbmRseSBoZWxwZXIgLy90aW55dXJsLmNvbS82YW93NnluXHJcblx0Ly8gTMOkdWZ0IGR1cmNoIGFsbGUgRmVsZGVyIGltIEZvcm11bGFyXHJcblx0Ly8gV2VubiBlaW4gV2VydCBlbnRoYWx0ZW4gaXN0LCB3aXJkIEZlbGRuYW1lIHVuZCBXZXJ0IGlucyBPYmpla3QgZ2VzY2hyaWViZW5cclxuXHQvLyBuaWNodCB2ZXJnZXNzZW46IFR5cCwgX2lkIHVuZCBfcmV2IGRhenUgZ2ViZW4sIHVtIHp1IHNwZWljaGVyblxyXG5cdCQuZm4uc2VyaWFsaXplT2JqZWN0ID0gZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgbywgYTtcclxuXHRcdG8gPSB7fTtcclxuXHRcdGEgPSB0aGlzLnNlcmlhbGl6ZUFycmF5KCk7XHJcblx0XHQkLmVhY2goYSwgZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmICh0aGlzLnZhbHVlKSB7XHJcblx0XHRcdFx0aWYgKG9bdGhpcy5uYW1lXSkge1xyXG5cdFx0XHRcdFx0aWYgKCFvW3RoaXMubmFtZV0ucHVzaCkge1xyXG5cdFx0XHRcdFx0XHRvW3RoaXMubmFtZV0gPSBbb1t0aGlzLm5hbWVdXTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdG9bdGhpcy5uYW1lXS5wdXNoKHRoaXMudmFsdWUpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRvW3RoaXMubmFtZV0gPSB0aGlzLnZhbHVlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHRyZXR1cm4gbztcclxuXHR9O1xyXG59KShqUXVlcnkpO1xyXG5cclxuLy8gd2FuZGVsdCBkZWNpbWFsIGRlZ3JlZXMgKHZvbSBHUFMpIGluIFdHUzg0IHVtXHJcbndpbmRvdy5hcGYuRGRJbldnczg0QnJlaXRlR3JhZCA9IGZ1bmN0aW9uKEJyZWl0ZSkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgQnJlaXRlR3JhZCA9IE1hdGguZmxvb3IoQnJlaXRlKTtcclxuXHRyZXR1cm4gQnJlaXRlR3JhZDtcclxufTtcclxuXHJcbndpbmRvdy5hcGYuRGRJbldnczg0QnJlaXRlTWluID0gZnVuY3Rpb24oQnJlaXRlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBCcmVpdGVHcmFkID0gTWF0aC5mbG9vcihCcmVpdGUpLFxyXG5cdFx0QnJlaXRlTWluID0gTWF0aC5mbG9vcigoQnJlaXRlIC0gQnJlaXRlR3JhZCkgKiA2MCk7XHJcblx0cmV0dXJuIEJyZWl0ZU1pbjtcclxufTtcclxuXHJcbndpbmRvdy5hcGYuRGRJbldnczg0QnJlaXRlU2VjID0gZnVuY3Rpb24oQnJlaXRlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBCcmVpdGVHcmFkID0gTWF0aC5mbG9vcihCcmVpdGUpLFxyXG5cdFx0QnJlaXRlTWluID0gTWF0aC5mbG9vcigoQnJlaXRlIC0gQnJlaXRlR3JhZCkqNjApLFxyXG5cdFx0QnJlaXRlU2VjID0gTWF0aC5yb3VuZCgoKChCcmVpdGUgLSBCcmVpdGVHcmFkKSAtIChCcmVpdGVNaW4gLyA2MCkpICogNjAgKiA2MCkgKiAxMDApIC8gMTAwO1xyXG5cdHJldHVybiBCcmVpdGVTZWM7XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLkRkSW5XZ3M4NEzDpG5nZUdyYWQgPSBmdW5jdGlvbihMw6RuZ2UpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIEzDpG5nZUdyYWQgPSBNYXRoLmZsb29yKEzDpG5nZSk7XHJcblx0cmV0dXJuIEzDpG5nZUdyYWQ7XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLkRkSW5XZ3M4NEzDpG5nZU1pbiA9IGZ1bmN0aW9uKEzDpG5nZSkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgTMOkbmdlR3JhZCA9IE1hdGguZmxvb3IoTMOkbmdlKSxcclxuXHRcdEzDpG5nZU1pbiA9IE1hdGguZmxvb3IoKEzDpG5nZSAtIEzDpG5nZUdyYWQpICogNjApO1xyXG5cdHJldHVybiBMw6RuZ2VNaW47XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLkRkSW5XZ3M4NEzDpG5nZVNlYyA9IGZ1bmN0aW9uKEzDpG5nZSkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgTMOkbmdlR3JhZCA9IE1hdGguZmxvb3IoTMOkbmdlKSxcclxuXHRcdEzDpG5nZU1pbiA9IE1hdGguZmxvb3IoKEzDpG5nZSAtIEzDpG5nZUdyYWQpICogNjApLFxyXG5cdFx0TMOkbmdlU2VjID0gTWF0aC5yb3VuZCgoKChMw6RuZ2UgLSBMw6RuZ2VHcmFkKSAtIChMw6RuZ2VNaW4gLyA2MCkpICogNjAgKiA2MCkgKiAxMDApIC8gMTAwO1xyXG5cdHJldHVybiBMw6RuZ2VTZWM7XHJcbn07XHJcblxyXG4vLyBXYW5kZWx0IFdHUzg0IGxhdC9sb25nICjCsCBkZWMpIGluIENILUxhbmRlc2tvb3JkaW5hdGVuIHVtXHJcbndpbmRvdy5hcGYuV2dzODRJbkNoWCA9IGZ1bmN0aW9uKEJyZWl0ZUdyYWQsIEJyZWl0ZU1pbiwgQnJlaXRlU2VjLCBMw6RuZ2VHcmFkLCBMw6RuZ2VNaW4sIEzDpG5nZVNlYykge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgbGF0ID0gQnJlaXRlU2VjICsgQnJlaXRlTWluICogNjAgKyBCcmVpdGVHcmFkICogMzYwMCxcclxuXHRcdGxuZyA9IEzDpG5nZVNlYyArIEzDpG5nZU1pbiAqIDYwICsgTMOkbmdlR3JhZCAqIDM2MDAsXHJcblx0XHQvLyBBdXhpbGlhcnkgdmFsdWVzICglIEJlcm4pXHJcblx0XHRsYXRfYXV4ID0gKGxhdCAtIDE2OTAyOC42NikgLyAxMDAwMCxcclxuXHRcdGxuZ19hdXggPSAobG5nIC0gMjY3ODIuNSkgLyAxMDAwMCxcclxuXHRcdHggPSAyMDAxNDcuMDdcclxuXHRcdCAgKyAzMDg4MDcuOTUgKiBsYXRfYXV4IFxyXG5cdFx0ICArICAgMzc0NS4yNSAqIE1hdGgucG93KGxuZ19hdXgsIDIpXHJcblx0XHQgICtcdCA3Ni42MyAqIE1hdGgucG93KGxhdF9hdXgsIDIpXHJcblx0XHQgIC1cdDE5NC41NiAqIE1hdGgucG93KGxuZ19hdXgsIDIpICogbGF0X2F1eFxyXG5cdFx0ICArXHQxMTkuNzkgKiBNYXRoLnBvdyhsYXRfYXV4LCAzKTtcclxuXHRyZXR1cm4geDtcclxufTtcclxuXHJcbi8vIFdhbmRlbHQgV0dTODQgaW4gQ0gtTGFuZGVza29vcmRpbmF0ZW4gdW1cclxud2luZG93LmFwZi5XZ3M4NEluQ2hZID0gZnVuY3Rpb24oQnJlaXRlR3JhZCwgQnJlaXRlTWluLCBCcmVpdGVTZWMsIEzDpG5nZUdyYWQsIEzDpG5nZU1pbiwgTMOkbmdlU2VjKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIENvbnZlcnRzIGRlZ3JlZXMgZGVjIHRvIHNleFxyXG5cdHZhciBsYXQgPSBCcmVpdGVTZWMgKyBCcmVpdGVNaW4gKiA2MCArIEJyZWl0ZUdyYWQgKiAzNjAwLFxyXG5cdFx0bG5nID0gTMOkbmdlU2VjICsgTMOkbmdlTWluICogNjAgKyBMw6RuZ2VHcmFkICogMzYwMCxcclxuXHRcdC8vIEF1eGlsaWFyeSB2YWx1ZXMgKCUgQmVybilcclxuXHRcdGxhdF9hdXggPSAobGF0IC0gMTY5MDI4LjY2KSAvIDEwMDAwLFxyXG5cdFx0bG5nX2F1eCA9IChsbmcgLSAyNjc4Mi41KSAvIDEwMDAwLFxyXG5cdFx0Ly8gUHJvY2VzcyBZXHJcblx0XHR5ID0gNjAwMDcyLjM3IFxyXG5cdFx0ICArIDIxMTQ1NS45MyAqIGxuZ19hdXggXHJcblx0XHQgIC0gIDEwOTM4LjUxICogbG5nX2F1eCAqIGxhdF9hdXhcclxuXHRcdCAgLVx0ICAwLjM2ICogbG5nX2F1eCAqIE1hdGgucG93KGxhdF9hdXgsIDIpXHJcblx0XHQgIC1cdCA0NC41NCAqIE1hdGgucG93KGxuZ19hdXgsIDMpO1xyXG5cdHJldHVybiB5O1xyXG59O1xyXG5cclxuLy8gd2FuZGVsdCBkZWNpbWFsIGRlZ3JlZXMgKHZvbSBHUFMpIGluIENILUxhbmRlc2tvb3JkaW5hdGVuIHVtXHJcbndpbmRvdy5hcGYuRGRJbkNoWCA9IGZ1bmN0aW9uKEJyZWl0ZSwgTMOkbmdlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBCcmVpdGVHcmFkID0gd2luZG93LmFwZi5EZEluV2dzODRCcmVpdGVHcmFkKEJyZWl0ZSksXHJcblx0XHRCcmVpdGVNaW4gPSB3aW5kb3cuYXBmLkRkSW5XZ3M4NEJyZWl0ZU1pbihCcmVpdGUpLFxyXG5cdFx0QnJlaXRlU2VjID0gd2luZG93LmFwZi5EZEluV2dzODRCcmVpdGVTZWMoQnJlaXRlKSxcclxuXHRcdEzDpG5nZUdyYWQgPSB3aW5kb3cuYXBmLkRkSW5XZ3M4NEzDpG5nZUdyYWQoTMOkbmdlKSxcclxuXHRcdEzDpG5nZU1pbiA9IHdpbmRvdy5hcGYuRGRJbldnczg0TMOkbmdlTWluKEzDpG5nZSksXHJcblx0XHRMw6RuZ2VTZWMgPSB3aW5kb3cuYXBmLkRkSW5XZ3M4NEzDpG5nZVNlYyhMw6RuZ2UpLFxyXG5cdFx0eCA9IE1hdGguZmxvb3Iod2luZG93LmFwZi5XZ3M4NEluQ2hYKEJyZWl0ZUdyYWQsIEJyZWl0ZU1pbiwgQnJlaXRlU2VjLCBMw6RuZ2VHcmFkLCBMw6RuZ2VNaW4sIEzDpG5nZVNlYykpO1xyXG5cdHJldHVybiB4O1xyXG59O1xyXG5cclxud2luZG93LmFwZi5EZEluQ2hZID0gZnVuY3Rpb24oQnJlaXRlLCBMw6RuZ2UpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIEJyZWl0ZUdyYWQgPSB3aW5kb3cuYXBmLkRkSW5XZ3M4NEJyZWl0ZUdyYWQoQnJlaXRlKSxcclxuXHRcdEJyZWl0ZU1pbiA9IHdpbmRvdy5hcGYuRGRJbldnczg0QnJlaXRlTWluKEJyZWl0ZSksXHJcblx0XHRCcmVpdGVTZWMgPSB3aW5kb3cuYXBmLkRkSW5XZ3M4NEJyZWl0ZVNlYyhCcmVpdGUpLFxyXG5cdFx0TMOkbmdlR3JhZCA9IHdpbmRvdy5hcGYuRGRJbldnczg0TMOkbmdlR3JhZChMw6RuZ2UpLFxyXG5cdFx0TMOkbmdlTWluID0gd2luZG93LmFwZi5EZEluV2dzODRMw6RuZ2VNaW4oTMOkbmdlKSxcclxuXHRcdEzDpG5nZVNlYyA9IHdpbmRvdy5hcGYuRGRJbldnczg0TMOkbmdlU2VjKEzDpG5nZSksXHJcblx0XHR5ID0gTWF0aC5mbG9vcih3aW5kb3cuYXBmLldnczg0SW5DaFkoQnJlaXRlR3JhZCwgQnJlaXRlTWluLCBCcmVpdGVTZWMsIEzDpG5nZUdyYWQsIEzDpG5nZU1pbiwgTMOkbmdlU2VjKSk7XHJcblx0cmV0dXJuIHk7XHJcbn07XHJcblxyXG4vLyB2b24gQ0gtTGFuZGVza29vcmQgenUgRGVjRGVnXHJcblxyXG4vLyBDb252ZXJ0IENIIHkveCB0byBXR1MgbGF0XHJcbndpbmRvdy5hcGYuQ0h0b1dHU2xhdCA9IGZ1bmN0aW9uKHksIHgpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gQ29udmVydHMgbWlsaXRhciB0byBjaXZpbCBhbmQgdG8gdW5pdCA9IDEwMDBrbVxyXG5cdC8vIEF1eGlsaWFyeSB2YWx1ZXMgKCUgQmVybilcclxuXHR2YXIgeV9hdXggPSAoeSAtIDYwMDAwMCkgLyAxMDAwMDAwLFxyXG5cdFx0eF9hdXggPSAoeCAtIDIwMDAwMCkgLyAxMDAwMDAwLFxyXG5cdFx0Ly8gUHJvY2VzcyBsYXRcclxuXHRcdGxhdCA9IDE2LjkwMjM4OTJcclxuXHRcdFx0ICsgIDMuMjM4MjcyICogeF9hdXhcclxuXHRcdFx0IC0gIDAuMjcwOTc4ICogTWF0aC5wb3coeV9hdXgsIDIpXHJcblx0XHRcdCAtICAwLjAwMjUyOCAqIE1hdGgucG93KHhfYXV4LCAyKVxyXG5cdFx0XHQgLSAgMC4wNDQ3ICAgKiBNYXRoLnBvdyh5X2F1eCwgMikgKiB4X2F1eFxyXG5cdFx0XHQgLSAgMC4wMTQwICAgKiBNYXRoLnBvdyh4X2F1eCwgMyk7XHJcblx0Ly8gVW5pdCAxMDAwMFwiIHRvIDEgXCIgYW5kIGNvbnZlcnRzIHNlY29uZHMgdG8gZGVncmVlcyAoZGVjKVxyXG5cdGxhdCA9IGxhdCAqIDEwMCAvIDM2O1xyXG5cdHJldHVybiBsYXQ7XHJcbn07XHJcblxyXG4vLyBDb252ZXJ0IENIIHkveCB0byBXR1MgbG9uZ1xyXG53aW5kb3cuYXBmLkNIdG9XR1NsbmcgPSBmdW5jdGlvbih5LCB4KSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIENvbnZlcnRzIG1pbGl0YXIgdG8gY2l2aWwgYW5kIHRvIHVuaXQgPSAxMDAwa21cclxuXHQvLyBBdXhpbGlhcnkgdmFsdWVzICglIEJlcm4pXHJcblx0dmFyIHlfYXV4ID0gKHkgLSA2MDAwMDApIC8gMTAwMDAwMCxcclxuXHRcdHhfYXV4ID0gKHggLSAyMDAwMDApIC8gMTAwMDAwMCxcclxuXHRcdC8vIFByb2Nlc3MgbG9uZ1xyXG5cdFx0bG5nID0gMi42Nzc5MDk0XHJcblx0XHRcdCsgNC43Mjg5ODIgKiB5X2F1eFxyXG5cdFx0XHQrIDAuNzkxNDg0ICogeV9hdXggKiB4X2F1eFxyXG5cdFx0XHQrIDAuMTMwNiAgICogeV9hdXggKiBNYXRoLnBvdyh4X2F1eCwgMilcclxuXHRcdFx0LSAwLjA0MzYgICAqIE1hdGgucG93KHlfYXV4LCAzKTtcclxuXHQvLyBVbml0IDEwMDAwXCIgdG8gMSBcIiBhbmQgY29udmVydHMgc2Vjb25kcyB0byBkZWdyZWVzIChkZWMpXHJcblx0bG5nID0gbG5nICogMTAwIC8gMzY7XHJcblx0cmV0dXJuIGxuZztcclxufTtcclxuXHJcbndpbmRvdy5hcGYuZ21hcC56ZWlnZVRQb3AgPSBmdW5jdGlvbih0cG9wX2xpc3RlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBhbnpfdHBvcCxcclxuICAgICAgICBpbmZvd2luZG93LFxyXG4gICAgICAgIHRwb3BfYmVzY2hyaWZ0dW5nLFxyXG4gICAgICAgIGxhdCxcclxuICAgICAgICBsbmcsXHJcbiAgICAgICAgbGF0bG5nLFxyXG4gICAgICAgIG9wdGlvbnMsXHJcbiAgICAgICAgbWFwLFxyXG4gICAgICAgIGJvdW5kcyxcclxuICAgICAgICBtYXJrZXJzLFxyXG4gICAgICAgIHRwb3BfaWQsXHJcbiAgICAgICAgbGF0bG5nMixcclxuICAgICAgICBtYXJrZXIsXHJcbiAgICAgICAgY29udGVudFN0cmluZyxcclxuICAgICAgICBtYXJrZXJfb3B0aW9ucyxcclxuICAgICAgICBtYXJrZXJfY2x1c3RlcixcclxuICAgICAgICBteV9mbHVybmFtZTtcclxuXHQvLyB2b3IgRXJuZXVlcnVuZyB6ZWlnZW4gLSBzb25zdCBrbGFwcHQgV2llZGVyYXVmcnVmIG5pY2h0LCB3ZW5uIGRpZSBLYXJ0ZSBzY2hvbiBhbmdlemVpZ3QgaXN0XHJcblx0d2luZG93LmFwZi56ZWlnZUZvcm11bGFyKFwiZ29vZ2xlX2thcnRlXCIpO1xyXG5cdHdpbmRvdy5hcGYuZ21hcC5tYXJrZXJzX2FycmF5ID0gW107XHJcblx0d2luZG93LmFwZi5nbWFwLmluZm9fd2luZG93X2FycmF5ID0gW107XHJcblx0aW5mb3dpbmRvdyA9IG5ldyBnb29nbGUubWFwcy5JbmZvV2luZG93KCk7XHJcblx0Ly8gVFBvcExpc3RlIGJlYXJiZWl0ZW46XHJcblx0Ly8gT2JqZWt0ZSBsw7ZzY2hlbiwgZGllIGtlaW5lIEtvb3JkaW5hdGVuIGhhYmVuXHJcblx0Ly8gTGF0IHVuZCBMbmcgZXJnw6RuemVuXHJcbiAgICBfLmVhY2godHBvcF9saXN0ZS5yb3dzLCBmdW5jdGlvbih0cG9wLCBpbmRleCkge1xyXG4gICAgICAgIGlmICghdHBvcC5UUG9wWEtvb3JkIHx8ICF0cG9wLlRQb3BZS29vcmQpIHtcclxuICAgICAgICAgICAgLy8gdHBvcCBlaW5zZXR6ZW4gZ2VodCBuaWNodCwgd2VpbCBDaHJvbWUgRmVobGVyIG1lbGRldFxyXG4gICAgICAgICAgICBkZWxldGUgdHBvcF9saXN0ZS5yb3dzW2luZGV4XTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0cG9wLkxhdCA9IHdpbmRvdy5hcGYuQ0h0b1dHU2xhdChwYXJzZUludCh0cG9wLlRQb3BYS29vcmQpLCBwYXJzZUludCh0cG9wLlRQb3BZS29vcmQpKTtcclxuICAgICAgICAgICAgdHBvcC5MbmcgPSB3aW5kb3cuYXBmLkNIdG9XR1NsbmcocGFyc2VJbnQodHBvcC5UUG9wWEtvb3JkKSwgcGFyc2VJbnQodHBvcC5UUG9wWUtvb3JkKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblx0Ly8gVFBvcCB6w6RobGVuXHJcblx0YW56X3Rwb3AgPSB0cG9wX2xpc3RlLnJvd3MubGVuZ3RoO1xyXG5cdC8vIEthcnRlIG1hbCBhdWYgWsO8cmljaCB6ZW50cmllcmVuLCBmYWxscyBpbiBkZW4gVFBvcExpc3RlLnJvd3Mga2VpbmUgS29vcmRpbmF0ZW4ga29tbWVuXHJcblx0Ly8gYXVmIGRpZSBkaWUgS2FydGUgYXVzZ2VyaWNodGV0IHdlcmRlbiBrYW5uXHJcblx0bGF0ID0gNDcuMzgzMzMzO1xyXG5cdGxuZyA9IDguNTMzMzMzO1xyXG5cdGxhdGxuZyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcobGF0LCBsbmcpO1xyXG5cdG9wdGlvbnMgPSB7XHJcblx0XHR6b29tOiAxNSxcclxuXHRcdGNlbnRlcjogbGF0bG5nLFxyXG5cdFx0c3RyZWV0Vmlld0NvbnRyb2w6IGZhbHNlLFxyXG5cdFx0bWFwVHlwZUlkOiBnb29nbGUubWFwcy5NYXBUeXBlSWQuU0FURUxMSVRFXHJcblx0fTtcclxuXHRtYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZ29vZ2xlX2thcnRlbl9kaXZcIiksIG9wdGlvbnMpO1xyXG5cdHdpbmRvdy5hcGYuZ21hcC5tYXAgPSBtYXA7XHJcblx0Ym91bmRzID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZ0JvdW5kcygpO1xyXG5cdC8vIGbDvHIgYWxsZSBUUG9wIE1hcmtlciBlcnN0ZWxsZW5cclxuXHRtYXJrZXJzID0gW107XHJcbiAgICBfLmVhY2godHBvcF9saXN0ZS5yb3dzLCBmdW5jdGlvbih0cG9wKSB7XHJcbiAgICAgICAgdHBvcF9pZCA9IHRwb3AuVFBvcElkO1xyXG4gICAgICAgIHRwb3BfYmVzY2hyaWZ0dW5nID0gd2luZG93LmFwZi5iZXNjaHJpZnRlVFBvcE1pdE5yRsO8ckthcnRlKHRwb3AuUG9wTnIsIHRwb3AuVFBvcE5yKTtcclxuICAgICAgICBsYXRsbmcyID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyh0cG9wLkxhdCwgdHBvcC5MbmcpO1xyXG4gICAgICAgIGlmIChhbnpfdHBvcCA9PT0gMSkge1xyXG4gICAgICAgICAgICAvLyBtYXAuZml0Ym91bmRzIHNldHp0IHp1IGhvaGVuIHpvb20sIHdlbm4gbnVyIGVpbmUgVFBvcCBLb29yZGluYXRlbiBoYXQgPiB2ZXJoaW5kZXJuXHJcbiAgICAgICAgICAgIGxhdGxuZyA9IGxhdGxuZzI7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gS2FydGVuYXVzc2Nobml0dCB1bSBkaWVzZSBLb29yZGluYXRlIGVyd2VpdGVyblxyXG4gICAgICAgICAgICBib3VuZHMuZXh0ZW5kKGxhdGxuZzIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBtYXJrZXIgPSBuZXcgTWFya2VyV2l0aExhYmVsKHtcclxuICAgICAgICAgICAgbWFwOiBtYXAsXHJcbiAgICAgICAgICAgIHBvc2l0aW9uOiBsYXRsbmcyLFxyXG4gICAgICAgICAgICB0aXRsZTogdHBvcF9iZXNjaHJpZnR1bmcsXHJcbiAgICAgICAgICAgIGxhYmVsQ29udGVudDogdHBvcF9iZXNjaHJpZnR1bmcsXHJcbiAgICAgICAgICAgIGxhYmVsQW5jaG9yOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoNzUsIDApLFxyXG4gICAgICAgICAgICBsYWJlbENsYXNzOiBcIk1hcExhYmVsXCIsXHJcbiAgICAgICAgICAgIGljb246IFwiaW1nL2Zsb3JhX2ljb24ucG5nXCJcclxuICAgICAgICB9KTtcclxuICAgICAgICBtYXJrZXJzLnB1c2gobWFya2VyKTtcclxuICAgICAgICBteV9mbHVybmFtZSA9IHRwb3AuVFBvcEZsdXJuYW1lIHx8ICcoa2VpbiBGbHVybmFtZSknO1xyXG4gICAgICAgIGNvbnRlbnRTdHJpbmcgPSAnPGRpdiBpZD1cImNvbnRlbnRcIj4nK1xyXG4gICAgICAgICAgICAnPGRpdiBpZD1cInNpdGVOb3RpY2VcIj4nK1xyXG4gICAgICAgICAgICAnPC9kaXY+JytcclxuICAgICAgICAgICAgJzxkaXYgaWQ9XCJib2R5Q29udGVudFwiIGNsYXNzPVwiR21JbmZvd2luZG93XCI+JytcclxuICAgICAgICAgICAgJzxoMz4nICsgdHBvcC5BcnRuYW1lICsgJzwvaDM+JytcclxuICAgICAgICAgICAgJzxwPlBvcHVsYXRpb246ICcgKyB0cG9wLlBvcE5hbWUgKyAnPC9wPicrXHJcbiAgICAgICAgICAgICc8cD5UUG9wOiAnICsgbXlfZmx1cm5hbWUgKyAnPC9wPicrXHJcbiAgICAgICAgICAgICc8cD5Lb29yZGluYXRlbjogJyArIHRwb3AuVFBvcFhLb29yZCArICcgLyAnICsgdHBvcC5UUG9wWUtvb3JkICsgJzwvcD4nK1xyXG4gICAgICAgICAgICBcIjxwPjxhIGhyZWY9XFxcIiNcXFwiIG9uY2xpY2s9XFxcIndpbmRvdy5hcGYuw7ZmZm5lVFBvcCgnXCIgKyB0cG9wLlRQb3BJZCArIFwiJylcXFwiPkZvcm11bGFyIGFuc3RlbGxlIEthcnRlIMO2ZmZuZW48XFwvYT48L3A+XCIrXHJcbiAgICAgICAgICAgICc8cD48YSBocmVmPVwiI1wiIG9uY2xpY2s9XFxcIndpbmRvdy5hcGYuw7ZmZm5lRm9ybXVsYXJBbHNQb3B1cChcXCd0cG9wXFwnLCAnICsgdHBvcC5UUG9wSWQgKyAnKVxcXCI+Rm9ybXVsYXIgbmViZW4gZGVyIEthcnRlIMO2ZmZuZW48XFwvYT48L3A+JytcclxuICAgICAgICAgICAgXCI8cD48YSBocmVmPVxcXCIjXFxcIiBvbmNsaWNrPVxcXCJ3aW5kb3cuYXBmLsO2ZmZuZVRQb3BJbk5ldWVtVGFiKCdcIiArIHRwb3AuVFBvcElkICsgXCInKVxcXCI+Rm9ybXVsYXIgaW4gbmV1ZW0gRmVuc3RlciDDtmZmbmVuPFxcL2E+PC9wPlwiK1xyXG4gICAgICAgICAgICAnPC9kaXY+JytcclxuICAgICAgICAgICAgJzwvZGl2Pic7XHJcbiAgICAgICAgbWFrZUxpc3RlbmVyKG1hcCwgbWFya2VyLCBjb250ZW50U3RyaW5nKTtcclxuICAgIH0pO1xyXG5cdG1hcmtlcl9vcHRpb25zID0ge1xyXG5cdFx0bWF4Wm9vbTogMTcsIFxyXG5cdFx0c3R5bGVzOiBbe1xyXG5cdFx0XHRcdGhlaWdodDogNTMsXHJcblx0XHRcdFx0dXJsOiBcImltZy9tOC5wbmdcIixcclxuXHRcdFx0XHR3aWR0aDogNTNcclxuXHRcdFx0fV1cclxuXHR9O1xyXG5cdC8vIGdsb2JhbGUgVmFyaWFibGUgdmVyd2VuZGVuLCBkYW1pdCBlaW4gS2xpY2sgYXVmIGRpZSBDaGVja2JveCBkaWUgRWJlbmUgZWluYmxlbmRlbiBrYW5uXHJcblx0d2luZG93LmFwZi5nb29nbGVfa2FydGVfZGV0YWlscGzDpG5lID0gbmV3IGdvb2dsZS5tYXBzLkttbExheWVyKHtcclxuXHQgICAgLy91cmw6ICcvL3d3dy5hcGZsb3JhLmNoL2ttbC9ydWV0ZXJlbi5rbXonLFxyXG4gICAgICAgIHVybDogJ2ttbC9ydWV0ZXJlbi5rbXonLFxyXG5cdCAgICBwcmVzZXJ2ZVZpZXdwb3J0OiB0cnVlXHJcblx0fSk7XHJcblx0d2luZG93LmFwZi5nb29nbGVfa2FydGVfZGV0YWlscGzDpG5lLnNldE1hcChudWxsKTtcclxuXHRtYXJrZXJfY2x1c3RlciA9IG5ldyBNYXJrZXJDbHVzdGVyZXIobWFwLCBtYXJrZXJzLCBtYXJrZXJfb3B0aW9ucyk7XHJcblx0aWYgKGFuel90cG9wID09PSAxKSB7XHJcblx0XHQvLyBtYXAuZml0Ym91bmRzIHNldHp0IHp1IGhvaGVuIHpvb20sIHdlbm4gbnVyIGVpbmUgQmVvYmFjaHR1bmcgZXJmYXNzdCB3dXJkZSA+IHZlcmhpbmRlcm5cclxuXHRcdG1hcC5zZXRDZW50ZXIobGF0bG5nKTtcclxuXHRcdG1hcC5zZXRab29tKDE4KTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0Ly8gS2FydGUgYXVmIEF1c3NjaG5pdHQgYW5wYXNzZW5cclxuXHRcdG1hcC5maXRCb3VuZHMoYm91bmRzKTtcclxuXHR9XHJcblx0Ly8gZGllc2UgRnVua3Rpb24gbXVzcyBoaWVyIHNlaW4sIGRhbWl0IGluZm93aW5kb3cgYmVrYW5udCBpc3RcclxuXHRmdW5jdGlvbiBtYWtlTGlzdGVuZXIobWFwLCBtYXJrZXIsIGNvbnRlbnRTdHJpbmcpIHtcclxuXHRcdGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdGluZm93aW5kb3cuc2V0Q29udGVudChjb250ZW50U3RyaW5nKTtcclxuXHRcdFx0aW5mb3dpbmRvdy5vcGVuKG1hcCwgbWFya2VyKTtcclxuXHRcdH0pO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5hcGYub2xtYXAuZ2V0TGF5ZXJOYW1lcyA9IGZ1bmN0aW9uKCkge1xyXG5cdHZhciBsYXllcl9vYmpla3RfYXJyYXkgPSB3aW5kb3cuYXBmLm9sbWFwLm1hcC5nZXRMYXllcnMoKS5nZXRBcnJheSgpLFxyXG5cdFx0bGF5ZXJzID0gXy5tYXAobGF5ZXJfb2JqZWt0X2FycmF5LCBmdW5jdGlvbihsYXllcl9vYmpla3QpIHtcclxuXHRcdFx0aWYgKGxheWVyX29iamVrdC52YWx1ZXNfICYmIGxheWVyX29iamVrdC52YWx1ZXNfLnRpdGxlKSB7XHJcblx0IFx0XHRcdHJldHVybiBsYXllcl9vYmpla3QudmFsdWVzXy50aXRsZTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0cmV0dXJuIGxheWVycztcclxufTtcclxuXHJcbndpbmRvdy5hcGYub2xtYXAuZ2V0TGF5ZXJzV2l0aFRpdGxlID0gZnVuY3Rpb24oKSB7XHJcblx0dmFyIGxheWVyc19hcnJheSA9IHdpbmRvdy5hcGYub2xtYXAubWFwLmdldExheWVycygpLmdldEFycmF5KCksXHJcblx0XHRsYXllcnMgPSBfLm1hcChsYXllcnNfYXJyYXksIGZ1bmN0aW9uKGxheWVyKSB7XHJcblx0XHRcdGlmIChsYXllci5nZXQoJ3RpdGxlJykpIHtcclxuXHQgXHRcdFx0cmV0dXJuIGxheWVyO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRyZXR1cm4gbGF5ZXJzIHx8IFtdO1xyXG59O1xyXG5cclxud2luZG93LmFwZi5vbG1hcC5lbnRmZXJuZUxheWVyTmFjaE5hbWUgPSBmdW5jdGlvbihuYW1lKSB7XHJcblx0dmFyIGxheWVyc19hcnJheSA9IHdpbmRvdy5hcGYub2xtYXAuZ2V0TGF5ZXJzV2l0aFRpdGxlKCksXHJcblx0XHRsYXllcm5hbWUsXHJcblx0XHRsYXllcl9rYXRlZ29yaWU7XHJcblx0Xy5lYWNoKGxheWVyc19hcnJheSwgZnVuY3Rpb24obGF5ZXIpIHtcclxuXHRcdGxheWVybmFtZSA9IGxheWVyLmdldCgndGl0bGUnKTtcclxuXHRcdGxheWVyX2thdGVnb3JpZSA9IGxheWVyLmdldCgna2F0ZWdvcmllJyk7XHJcblx0XHRpZiAobGF5ZXJuYW1lID09PSBuYW1lKSB7XHJcblx0XHRcdHdpbmRvdy5hcGYub2xtYXAubWFwLnJlbW92ZUxheWVyKGxheWVyKTtcclxuXHRcdFx0aWYgKGxheWVyX2thdGVnb3JpZSA9PT0gJ0VpZ2VuZSBFYmVuZW4nKSB7XHJcblx0XHRcdFx0Ly8gZWJlbmUgYXVzIGxvY2FsU3RvcmFnZSBlbnRmZXJuZW5cclxuXHRcdFx0XHRjb25zb2xlLmxvZygnZW50ZmVybmVMYXllck5hY2hOYW1lIG1lbGRldDogbGFzc2UgZW50ZmVybmVuIGxheWVyIG1pdCB0aXRsZSAnICsgbGF5ZXJuYW1lKTtcclxuXHRcdFx0XHR3aW5kb3cuYXBmLm9sbWFwLmFrdHVhbGlzaWVyZUViZW5lSW5Mb2NhbFN0b3JhZ2UobGF5ZXIsIHRydWUpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLm9sbWFwLmVudGZlcm5lQWxsZUFwZmxvcmFMYXllciA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRpZiAod2luZG93LmFwZi5vbG1hcCAmJiB3aW5kb3cuYXBmLm9sbWFwLm1hcCkge1xyXG5cdFx0Ly8gZ2V0TGF5ZXJzIHJldG91cm5pZXJ0IGVpbiBPYmpla3QhISFcclxuXHRcdC8vIHVtIGRpZSBlaWdlbnRsaWNoZW4gTGF5ZXJzIHp1IGVyaGFsdGVuLCBtdXNzIG1hbiAuZ2V0TGF5ZXJzKCkuZ2V0QXJyYXkoKSBhdWZydWZlbiEhIVxyXG5cdFx0dmFyIGxheWVyc19hcnJheSA9IHdpbmRvdy5hcGYub2xtYXAubWFwLmdldExheWVycygpLmdldEFycmF5KCksXHJcblx0XHRcdGthdGVnb3JpZSxcclxuXHRcdFx0dGl0bGUsXHJcblx0XHRcdHp1X2zDtnNjaGVuZGVfbGF5ZXIgPSBbXTtcclxuXHRcdC8vIHp1ZXJzdCBudXIgZWluZW4gQXJyYXkgbWl0IGRlbiB6dSBsw7ZzY2hlbmRlbiBMYXllcm4gZXJzdGVsbGVuXHJcblx0XHQvLyB3ZW5uIG1hbiBzb2ZvcnQgbMO2c2NodCwgd2lyZCBudXIgZGVyIGVyc3RlIGVudGZlcm50IVxyXG5cdFx0Xy5lYWNoKGxheWVyc19hcnJheSwgZnVuY3Rpb24obGF5ZXIpIHtcclxuXHRcdFx0a2F0ZWdvcmllID0gbGF5ZXIuZ2V0KCdrYXRlZ29yaWUnKTtcclxuXHRcdFx0dGl0bGUgPSBsYXllci5nZXQoJ3RpdGxlJyk7XHJcblx0XHRcdGlmIChrYXRlZ29yaWUgJiYga2F0ZWdvcmllID09PSAnQVAgRmxvcmEnICYmIHRpdGxlICE9PSAnRGV0YWlscGzDpG5lJykge1xyXG5cdFx0XHRcdHp1X2zDtnNjaGVuZGVfbGF5ZXIucHVzaChsYXllcik7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0Xy5lYWNoKHp1X2zDtnNjaGVuZGVfbGF5ZXIsIGZ1bmN0aW9uKGxheWVyKSB7XHJcblx0XHRcdHdpbmRvdy5hcGYub2xtYXAubWFwLnJlbW92ZUxheWVyKGxheWVyKTtcclxuXHRcdH0pO1xyXG5cdFx0d2luZG93LmFwZi5vbG1hcC5pbml0aWllcmVMYXllcnRyZWUoKTtcclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLmFrdHVhbGlzaWVyZUtvb3JkaW5hdGVuVm9uVFBvcCA9IGZ1bmN0aW9uKHRwb3ApIHtcclxuICAgIHZhciBrb29yZF9ha3R1YWxpc2llcnQgPSAkLkRlZmVycmVkKCk7XHJcbiAgICAvLyBEYXRlbnNhdHogdXBkYXRlblxyXG4gICAgdmFyIHVwZGF0ZVRQb3AgPSAkLmFqYXgoe1xyXG4gICAgICAgIHR5cGU6ICdwb3N0JyxcclxuICAgICAgICB1cmw6ICdwaHAvdHBvcF91cGRhdGUucGhwJyxcclxuICAgICAgICBkYXRhVHlwZTogJ2pzb24nLFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgXCJpZFwiOiB0cG9wLlRQb3BJZCxcclxuICAgICAgICAgICAgXCJGZWxkXCI6IFwiVFBvcFhLb29yZFwiLFxyXG4gICAgICAgICAgICBcIldlcnRcIjogdHBvcC5UUG9wWEtvb3JkLFxyXG4gICAgICAgICAgICBcInVzZXJcIjogc2Vzc2lvblN0b3JhZ2UuVXNlclxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgdXBkYXRlVFBvcC5hbHdheXMoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHVwZGF0ZVRQb3BfMiA9ICQuYWpheCh7XHJcbiAgICAgICAgICAgIHR5cGU6ICdwb3N0JyxcclxuICAgICAgICAgICAgdXJsOiAncGhwL3Rwb3BfdXBkYXRlLnBocCcsXHJcbiAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIFwiaWRcIjogdHBvcC5UUG9wSWQsXHJcbiAgICAgICAgICAgICAgICBcIkZlbGRcIjogXCJUUG9wWUtvb3JkXCIsXHJcbiAgICAgICAgICAgICAgICBcIldlcnRcIjogdHBvcC5UUG9wWUtvb3JkLFxyXG4gICAgICAgICAgICAgICAgXCJ1c2VyXCI6IHNlc3Npb25TdG9yYWdlLlVzZXJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHVwZGF0ZVRQb3BfMi5hbHdheXMoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGtvb3JkX2FrdHVhbGlzaWVydC5yZXNvbHZlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBrb29yZF9ha3R1YWxpc2llcnQucHJvbWlzZSgpO1xyXG59O1xyXG5cclxud2luZG93LmFwZi5vbG1hcC5zdGFwbGVMYXllclp1b2JlcnN0ID0gZnVuY3Rpb24obGF5ZXJfdGl0bGUpIHtcclxuICAgIHZhciBsYXllcnMgPSB3aW5kb3cuYXBmLm9sbWFwLm1hcC5nZXRMYXllcnMoKSxcclxuICAgICAgICBsYXllcnNfYXJyYXkgPSB3aW5kb3cuYXBmLm9sbWFwLm1hcC5nZXRMYXllcnMoKS5nZXRBcnJheSgpLFxyXG4gICAgICAgIHRvcF9sYXllcjtcclxuICAgIF8uZWFjaChsYXllcnNfYXJyYXksIGZ1bmN0aW9uKGxheWVyLCBpbmRleCkge1xyXG4gICAgICAgIGlmIChsYXllci5nZXQoJ3RpdGxlJykgPT09IGxheWVyX3RpdGxlKSB7XHJcbiAgICAgICAgICAgIHRvcF9sYXllciA9IGxheWVycy5yZW1vdmVBdChpbmRleCk7XHJcbiAgICAgICAgICAgIGxheWVycy5pbnNlcnRBdChsYXllcnNfYXJyYXkubGVuZ3RoLCB0b3BfbGF5ZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgd2luZG93LmFwZi5vbG1hcC5pbml0aWllcmVMYXllcnRyZWUoKTtcclxufTtcclxuXHJcbndpbmRvdy5hcGYudmVyb3J0ZVRQb3BBdWZPbG1hcCA9IGZ1bmN0aW9uKHRwb3ApIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGJvdW5kcyxcclxuICAgICAgICB4X21heCxcclxuICAgICAgICB4X21pbixcclxuICAgICAgICB5X21heCxcclxuICAgICAgICB5X21pbjtcclxuXHJcbiAgICAvLyB0cG9wIGhhdCBrZWluZSBQb3BOclxyXG4gICAgLy8gSW5mb3Mgdm9uIFBvcCBtw7xzc2VuIGVyZ8Okbnp0IHdlcmRlbiwgd2VpbCBzaWUgYWxzIExhYmVsIGFuZ2V6ZWlndCB3ZXJkZW5cclxuICAgIHRwb3AuUG9wTnIgPSB3aW5kb3cuYXBmLnBvcC5Qb3BOcjtcclxuICAgIHRwb3AuUG9wTmFtZSA9IHdpbmRvdy5hcGYucG9wLlBvcE5hbWU7XHJcbiAgICB0cG9wLkFydG5hbWUgPSB3aW5kb3cuYXBmLmFwLkFydG5hbWU7XHJcblxyXG5cdC8vJC53aGVuKHdpbmRvdy5hcGYuemVpZ2VGb3JtdWxhcihcIkdlb0FkbWluS2FydGVcIikpXHJcblx0JC53aGVuKHdpbmRvdy5hcGYuemVpZ2VUUG9wQXVmT2xtYXAoKSlcclxuXHRcdC50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB3aW5kb3cuYXBmLm9sbWFwLmRlYWN0aXZhdGVNZW51SXRlbXMoKTtcclxuXHJcbiAgICAgICAgICAgICAvLyBtb2RpZnktbGF5ZXIgZXJzdGVsbGVuXHJcbiAgICAgICAgICAgICB3aW5kb3cuYXBmLm9sbWFwLm1vZGlmeV9zb3VyY2UgPSBuZXcgb2wuc291cmNlLlZlY3RvcigpO1xyXG4gICAgICAgICAgICAgdmFyIG1vZGlmeV9sYXllciA9IG5ldyBvbC5sYXllci5WZWN0b3Ioe1xyXG4gICAgICAgICAgICAgICAgIHRpdGxlOiAndmVyb3J0ZW5kZSBUZWlscG9wdWxhdGlvbicsXHJcbiAgICAgICAgICAgICAgICAga2F0ZWdvcmllOiAnQVAgRmxvcmEnLFxyXG4gICAgICAgICAgICAgICAgIHNvdXJjZTogd2luZG93LmFwZi5vbG1hcC5tb2RpZnlfc291cmNlLFxyXG4gICAgICAgICAgICAgICAgIHN0eWxlOiBmdW5jdGlvbihmZWF0dXJlLCByZXNvbHV0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5hcGYub2xtYXAudHBvcFN0eWxlKGZlYXR1cmUsIHJlc29sdXRpb24sIGZhbHNlLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgd2luZG93LmFwZi5vbG1hcC5tYXAuYWRkTGF5ZXIobW9kaWZ5X2xheWVyKTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0cG9wICYmIHRwb3AuVFBvcFhLb29yZCAmJiB0cG9wLlRQb3BZS29vcmQpIHtcclxuICAgICAgICAgICAgICAgIC8vIGJvdW5kcyB2ZXJuw7xuZnRpZyBlcndlaXRlcm4sIGRhbWl0IFB1bmt0IG5pY2h0IGluIGVpbmUgRWNrZSB6dSBsaWVnZW4ga29tbXRcclxuICAgICAgICAgICAgICAgIHhfbWF4ID0gcGFyc2VJbnQodHBvcC5UUG9wWEtvb3JkKSArIDIwMDtcclxuICAgICAgICAgICAgICAgIHhfbWluID0gcGFyc2VJbnQodHBvcC5UUG9wWEtvb3JkKSAtIDIwMDtcclxuICAgICAgICAgICAgICAgIHlfbWF4ID0gcGFyc2VJbnQodHBvcC5UUG9wWUtvb3JkKSArIDIwMDtcclxuICAgICAgICAgICAgICAgIHlfbWluID0gcGFyc2VJbnQodHBvcC5UUG9wWUtvb3JkKSAtIDIwMDtcclxuICAgICAgICAgICAgICAgIGJvdW5kcyA9IFt4X21pbiwgeV9taW4sIHhfbWF4LCB5X21heF07XHJcbiAgICAgICAgICAgICAgICAvLyB3ZW5uIHNjaG9uIGVpbmUgS29vcmRpbmF0ZSBleGlzdGllcnQ6XHJcbiAgICAgICAgICAgICAgICAvLyB0cG9wIGFscyBmZWF0dXJlIHp1bSBtb2RpZnkgaGluenVmw7xnZW5cclxuICAgICAgICAgICAgICAgIHZhciBuZXdfZmVhdHVyZSA9IG5ldyBvbC5GZWF0dXJlKG5ldyBvbC5nZW9tLlBvaW50KFt0cG9wLlRQb3BYS29vcmQsIHRwb3AuVFBvcFlLb29yZF0pKTtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5hcGYub2xtYXAubW9kaWZ5X3NvdXJjZS5hZGRGZWF0dXJlKG5ld19mZWF0dXJlKTtcclxuICAgICAgICAgICAgICAgIC8vIG1vZGlmeS1oYW5kbGVyIGVyc3RlbGxlblxyXG4gICAgICAgICAgICAgICAgd2luZG93LmFwZi5vbG1hcC5lcnN0ZWxsZU1vZGlmeUludGVyYWN0aW9uRsO8clRQb3AoKTtcclxuICAgICAgICAgICAgICAgIC8vIEthcnRlIHp1bSByaWNodGlnZW4gQXVzc2Nobml0dCB6b29tZW5cclxuICAgICAgICAgICAgICAgIHdpbmRvdy5hcGYub2xtYXAubWFwLnVwZGF0ZVNpemUoKTtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5hcGYub2xtYXAubWFwLmdldFZpZXcoKS5maXRFeHRlbnQoYm91bmRzLCB3aW5kb3cuYXBmLm9sbWFwLm1hcC5nZXRTaXplKCkpO1xyXG4gICAgICAgICAgICAgICAgLy8gdmVyesO2Z2Vybiwgc29uc3QgZnVua3Rpb25pZXJ0IGVzIG5pY2h0XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5hcGYub2xtYXAuc3RhcGxlTGF5ZXJadW9iZXJzdCgndmVyb3J0ZW5kZSBUZWlscG9wdWxhdGlvbicpO1xyXG4gICAgICAgICAgICAgICAgfSwgMjAwKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIHdlbm4ga2VpbmUgS29vcmRpbmF0ZSBleGlzdGllcnQ6XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuYXBmLm9sbWFwLmRyYXdfaW50ZXJhY3Rpb24gPSBuZXcgb2wuaW50ZXJhY3Rpb24uRHJhdyh7XHJcbiAgICAgICAgICAgICAgICBcdHNvdXJjZTogd2luZG93LmFwZi5vbG1hcC5tb2RpZnlfc291cmNlLFxyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IC8qKiBAdHlwZSB7b2wuZ2VvbS5HZW9tZXRyeVR5cGV9ICovICgnUG9pbnQnKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIFx0d2luZG93LmFwZi5vbG1hcC5tYXAuYWRkSW50ZXJhY3Rpb24od2luZG93LmFwZi5vbG1hcC5kcmF3X2ludGVyYWN0aW9uKTtcclxuICAgICAgICAgICAgXHRcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5hcGYub2xtYXAuZHJhd19pbnRlcmFjdGlvbi5vbmNlKCdkcmF3ZW5kJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICBcdFx0XHR2YXIgY29vcmRpbmF0ZXMgPSBldmVudC5mZWF0dXJlLmdldEdlb21ldHJ5KCkuZ2V0Q29vcmRpbmF0ZXMoKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBLb29yZGluYXRlbiBpbiB0cG9wIGVyZ8OkbnplblxyXG4gICAgICAgICAgICAgICAgICAgIHRwb3AuVFBvcFhLb29yZCAgPSBwYXJzZUludChjb29yZGluYXRlc1swXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdHBvcC5UUG9wWUtvb3JkID0gcGFyc2VJbnQoY29vcmRpbmF0ZXNbMV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICQud2hlbih3aW5kb3cuYXBmLmFrdHVhbGlzaWVyZUtvb3JkaW5hdGVuVm9uVFBvcCh0cG9wKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtYXJrZXIgaW4gdHBvcF9sYXllciBlcmfDpG56ZW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRwb3BfbGF5ZXIgaG9sZW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsYXllcnMgPSB3aW5kb3cuYXBmLm9sbWFwLm1hcC5nZXRMYXllcnMoKS5nZXRBcnJheSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRwb3BfbGF5ZXJfbnIgPSAkKCcjb2xtYXBfbGF5ZXJ0cmVlX1RlaWxwb3B1bGF0aW9uZW4nKS52YWwoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cG9wX2xheWVyID0gbGF5ZXJzW3Rwb3BfbGF5ZXJfbnJdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRwb3BfbGF5ZXJfc291cmNlID0gdHBvcF9sYXllci5nZXRTb3VyY2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1hcmtlciBlcmfDpG56ZW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRwb3BfbGF5ZXJfc291cmNlLmFkZEZlYXR1cmUod2luZG93LmFwZi5vbG1hcC5lcnN0ZWxsZU1hcmtlckbDvHJUUG9wTGF5ZXIodHBvcCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VsZWN0cyBlbnRmZXJuZW4gLSBhdXMgdW5lcmZpbmRsaWNoZW0gR3J1bmQgaXN0IGRlciBuZXVlIE1hcmtlciBzZWxla3RpZXJ0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuYXBmLm9sbWFwLnJlbW92ZVNlbGVjdEZlYXR1cmVzSW5TZWxlY3RhYmxlTGF5ZXJzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5hcGYub2xtYXAubWFwLnJlbW92ZUludGVyYWN0aW9uKHdpbmRvdy5hcGYub2xtYXAuZHJhd19pbnRlcmFjdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gbW9kaWZ5LWludGVyYWN0aW9uIGVyc3RlbGxlblxyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5hcGYub2xtYXAuZXJzdGVsbGVNb2RpZnlJbnRlcmFjdGlvbkbDvHJUUG9wKCk7XHJcbiAgICAgICAgICAgICAgICB9LCB0aGlzKTtcclxuICAgICAgICAgICAgICAgIC8vIHZlcnrDtmdlcm4sIHNvbnN0IGZ1bmt0aW9uaWVydCBlcyBuaWNodFxyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuYXBmLm9sbWFwLnN0YXBsZUxheWVyWnVvYmVyc3QoJ3Zlcm9ydGVuZGUgVGVpbHBvcHVsYXRpb24nKTtcclxuICAgICAgICAgICAgICAgIH0sIDIwMCk7XHJcbiAgICAgICAgICAgIH1cclxuXHRcdH0pO1xyXG59O1xyXG5cclxud2luZG93LmFwZi5vbG1hcC5lbnRmZXJuZU1vZGlmeUludGVyYWN0aW9uRsO8clRwb3AgPSBmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIGlmICh3aW5kb3cuYXBmLm9sbWFwLm1vZGlmeV9pbnRlcmFjdGlvbikge1xyXG4gICAgICAgIHdpbmRvdy5hcGYub2xtYXAubWFwLnJlbW92ZUludGVyYWN0aW9uKHdpbmRvdy5hcGYub2xtYXAubW9kaWZ5X2ludGVyYWN0aW9uKTtcclxuICAgICAgICBkZWxldGUgd2luZG93LmFwZi5vbG1hcC5tb2RpZnlfaW50ZXJhY3Rpb247XHJcbiAgICB9XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLm9sbWFwLmVyc3RlbGxlTW9kaWZ5SW50ZXJhY3Rpb25Gw7xyVFBvcCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG4gICAgLy8gYWxsZsOkbGxpZ2UgYmVzdGVoZW5kZSBJbnRlcmFjdGlvbiBlbnRmZXJuZW5cclxuICAgIHdpbmRvdy5hcGYub2xtYXAuZW50ZmVybmVNb2RpZnlJbnRlcmFjdGlvbkbDvHJUcG9wKCk7XHJcbiAgICAvLyBmZWF0dXJlLW92ZXJsYXkgZXJzdGVsbGVuXHJcbiAgICB3aW5kb3cuYXBmLm9sbWFwLm1vZGlmeV9vdmVybGF5ID0gbmV3IG9sLkZlYXR1cmVPdmVybGF5KHtcclxuICAgICAgICBzdHlsZTogZnVuY3Rpb24oZmVhdHVyZSwgcmVzb2x1dGlvbikge1xyXG4gICAgICAgICAgICByZXR1cm4gd2luZG93LmFwZi5vbG1hcC50cG9wU3R5bGUoZmVhdHVyZSwgcmVzb2x1dGlvbiwgZmFsc2UsIHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgLy8gbmV1ZXMgb2RlciBnZXfDpGhsdGVzIGZlYXR1cmUgaGluenVmw7xnZW5cclxuICAgIHdpbmRvdy5hcGYub2xtYXAubW9kaWZ5X292ZXJsYXkuYWRkRmVhdHVyZSh3aW5kb3cuYXBmLm9sbWFwLm1vZGlmeV9zb3VyY2UuZ2V0RmVhdHVyZXMoKVswXSk7XHJcbiAgICAvLyBtb2RpZnktaW50ZXJhY3Rpb24gZXJzdGVsbGVuXHJcbiAgICB3aW5kb3cuYXBmLm9sbWFwLm1vZGlmeV9pbnRlcmFjdGlvbiA9IG5ldyBvbC5pbnRlcmFjdGlvbi5Nb2RpZnkoe1xyXG4gICAgICAgIGZlYXR1cmVzOiB3aW5kb3cuYXBmLm9sbWFwLm1vZGlmeV9vdmVybGF5LmdldEZlYXR1cmVzKClcclxuICAgIH0pO1xyXG4gICAgLy8gesOkaGx0LCB3aWV2aWVsZSBtYWxlIC5vbignY2hhbmdlJykgYXVzZ2Vsw7ZzdCB3dXJkZVxyXG4gICAgd2luZG93LmFwZi5vbG1hcC5tb2RpZnlfaW50ZXJhY3Rpb24uesOkaGxlciA9IDA7XHJcbiAgICAvLyBpbnRlcmFjdGlvbi5Nb2RpZnkgbWVsZGV0IG5pY2h0LCB3ZW5uIGV0d2FzIHZlcsOkbmRlcnQgd3VyZGVcclxuICAgIC8vIGRhaGVyIG11c3MgcmVnaXN0cmllcnQgd2VyZGVuLCB3YW5uIGRhcyBmZWF0dXJlIGdlw6RuZGVydCB3aXJkXHJcbiAgICB3aW5kb3cuYXBmLm9sbWFwLm1vZGlmeV9vdmVybGF5LmdldEZlYXR1cmVzKCkuZ2V0QXJyYXkoKVswXS5vbignY2hhbmdlJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy8gZnVua3Rpb25pZXJ0IHp3YXIsIHdpcmQgYWJlciBiZWltIFZlcnNjaGllYmVuIER1dHplbmRlIGJpcyBodW5kZXJ0ZSBNYWxlIGF1c2dlbMO2c3RcclxuICAgICAgICB2YXIgesOkaGxlcixcclxuICAgICAgICAgICAgY29vcmRpbmF0ZXMgPSB0aGlzLmdldEdlb21ldHJ5KCkuZ2V0Q29vcmRpbmF0ZXMoKSxcclxuICAgICAgICAgICAgZmVhdHVyZSA9IHRoaXM7XHJcbiAgICAgICAgd2luZG93LmFwZi5vbG1hcC5tb2RpZnlfaW50ZXJhY3Rpb24uesOkaGxlcisrO1xyXG4gICAgICAgIC8vIHNwZWljaGVydCwgd2lldmllbGUgbWFsZSAub24oJ2NoYW5nZScpIGF1c2dlbMO2c3Qgd3VyZGUsIGJpcyBzZXRUaW1vdXQgYXVmZ2VydWZlbiB3dXJkZVxyXG4gICAgICAgIHrDpGhsZXIgPSB3aW5kb3cuYXBmLm9sbWFwLm1vZGlmeV9pbnRlcmFjdGlvbi56w6RobGVyO1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICh6w6RobGVyID09PSB3aW5kb3cuYXBmLm9sbWFwLm1vZGlmeV9pbnRlcmFjdGlvbi56w6RobGVyKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBpbiBkZW4gbGV0enRlbiAyMDAgTWlsbGlzZWt1bmRlbiBoYXQgc2ljaCBuaWNodHMgZ2XDpG5kZXJ0ID4gc3BlaWNoZXJuXHJcbiAgICAgICAgICAgICAgICAvLyBLb29yZGluYXRlbiBpbiB0cG9wIGVyZ8OkbnplblxyXG4gICAgICAgICAgICAgICAgd2luZG93LmFwZi50cG9wLlRQb3BYS29vcmQgID0gcGFyc2VJbnQoY29vcmRpbmF0ZXNbMF0pO1xyXG4gICAgICAgICAgICAgICAgd2luZG93LmFwZi50cG9wLlRQb3BZS29vcmQgPSBwYXJzZUludChjb29yZGluYXRlc1sxXSk7XHJcbiAgICAgICAgICAgICAgICAkLndoZW4od2luZG93LmFwZi5ha3R1YWxpc2llcmVLb29yZGluYXRlblZvblRQb3Aod2luZG93LmFwZi50cG9wKSlcclxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbWFya2VyIGluIHRwb3BfbGF5ZXIgZXJnw6RuemVuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRwb3BfbGF5ZXIgbmV1IHplaWNobmVuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsYXllcnMgPSB3aW5kb3cuYXBmLm9sbWFwLm1hcC5nZXRMYXllcnMoKS5nZXRBcnJheSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHBvcF9sYXllcl9uciA9ICQoJyNvbG1hcF9sYXllcnRyZWVfVGVpbHBvcHVsYXRpb25lbicpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHBvcF9sYXllciA9IGxheWVyc1t0cG9wX2xheWVyX25yXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRwb3BfbGF5ZXJfc291cmNlID0gdHBvcF9sYXllci5nZXRTb3VyY2UoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRwb3BfbGF5ZXJfZmVhdHVyZXMgPSB0cG9wX2xheWVyX3NvdXJjZS5nZXRGZWF0dXJlcygpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWt0dWVsbGVzX2ZlYXR1cmUgPSBfLmZpbmQodHBvcF9sYXllcl9mZWF0dXJlcywgZnVuY3Rpb24oZmVhdHVyZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmZWF0dXJlLmdldCgnbXlJZCcpID09PSB3aW5kb3cuYXBmLnRwb3AuVFBvcElkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFrdHVlbGxlc19mZWF0dXJlLmdldEdlb21ldHJ5KCkuc2V0Q29vcmRpbmF0ZXMoY29vcmRpbmF0ZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhYmjDpG5naWdlIEVpZ2Vuc2NoYWZ0ZW4gYWt0dWFsaXNpZXJlblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBha3R1ZWxsZXNfZmVhdHVyZS5zZXQoJ3hrb29yZCcsIHdpbmRvdy5hcGYudHBvcC5UUG9wWEtvb3JkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWt0dWVsbGVzX2ZlYXR1cmUuc2V0KCd5a29vcmQnLCB3aW5kb3cuYXBmLnRwb3AuVFBvcFlLb29yZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFrdHVlbGxlc19mZWF0dXJlLnNldCgncG9wdXBfY29udGVudCcsIHdpbmRvdy5hcGYub2xtYXAuZXJzdGVsbGVDb250ZW50RsO8clRQb3Aod2luZG93LmFwZi50cG9wKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCAyMDApO1xyXG4gICAgfSk7XHJcbiAgICAvKlxyXG4gICAgLy8gY2hhbmdlIHNjaGVpbnQgbmljaHQgenUgcGFzc2llcmVuLiBQcm9iaWVydDogY2hhbmdlLCBwb2ludGVyZHJhZywgY2xpY2ssIGRyYXdlbmRcclxuICAgIHdpbmRvdy5hcGYub2xtYXAubW9kaWZ5X2ludGVyYWN0aW9uLm9uKCdtb3ZlJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnamV0enQgZGllIEtvb3JkaW5hdGVuIGFrdHVhbGlzaWVyZW4nKTtcclxuXHJcbiAgICB9KTsqL1xyXG4gICAgd2luZG93LmFwZi5vbG1hcC5tYXAuYWRkSW50ZXJhY3Rpb24od2luZG93LmFwZi5vbG1hcC5tb2RpZnlfaW50ZXJhY3Rpb24pO1xyXG59O1xyXG5cclxuLy8gaW5wdXRfZGl2OiBkaXYgZGVzIExheWVycywgZGFzIGpldHp0IGFrdGl2aWVydCB3aXJkXHJcbndpbmRvdy5hcGYub2xtYXAuZW50ZmVybmVNb2RpZnlJbnRlcmFjdGlvbkbDvHJWZWN0b3JMYXllciA9IGZ1bmN0aW9uKGlucHV0X2Rpdikge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG4gICAgdmFyICRtb2RpZnlfbGF5ZXIgPSAkKCcubW9kaWZ5X2xheWVyJyk7XHJcbiAgICBpbnB1dF9kaXYgPSBpbnB1dF9kaXYgfHwgbnVsbDtcclxuICAgIGlmICh3aW5kb3cuYXBmLm9sbWFwLm1vZGlmeV9pbnRlcmFjdGlvbl9mw7xyX3ZlY3RvcmxheWVyKSB7XHJcbiAgICAgICAgd2luZG93LmFwZi5vbG1hcC5tYXAucmVtb3ZlSW50ZXJhY3Rpb24od2luZG93LmFwZi5vbG1hcC5tb2RpZnlfaW50ZXJhY3Rpb25fZsO8cl92ZWN0b3JsYXllcik7XHJcbiAgICAgICAgd2luZG93LmFwZi5vbG1hcC5tYXAucmVtb3ZlSW50ZXJhY3Rpb24od2luZG93LmFwZi5vbG1hcC5zZWxlY3RfaW50ZXJhY3Rpb25fZsO8cl92ZWN0b3JsYXllcik7XHJcbiAgICAgICAgd2luZG93LmFwZi5vbG1hcC5tYXAucmVtb3ZlSW50ZXJhY3Rpb24od2luZG93LmFwZi5vbG1hcC5kcmF3X2ludGVyYWN0aW9uX2bDvHJfdmVjdG9ybGF5ZXIpO1xyXG4gICAgICAgIGRlbGV0ZSB3aW5kb3cuYXBmLm9sbWFwLm1vZGlmeV9pbnRlcmFjdGlvbl9mw7xyX3ZlY3RvcmxheWVyO1xyXG4gICAgICAgIGRlbGV0ZSB3aW5kb3cuYXBmLm9sbWFwLnNlbGVjdF9pbnRlcmFjdGlvbl9mw7xyX3ZlY3RvcmxheWVyO1xyXG4gICAgICAgIGRlbGV0ZSB3aW5kb3cuYXBmLm9sbWFwLmRyYXdfaW50ZXJhY3Rpb25fZsO8cl92ZWN0b3JsYXllcjtcclxuICAgIH1cclxuICAgIC8vIGFsbGUgYnV0dG9ucyBpbSBsYXllci10b29sIHp1csO8Y2tzdGVsbGVuXHJcbiAgICAkbW9kaWZ5X2xheWVyXHJcbiAgICAgICAgLmJ1dHRvbih7XHJcbiAgICAgICAgICAgIGljb25zOiB7cHJpbWFyeTogJ3VpLWljb24tbG9ja2VkJ30sXHJcbiAgICAgICAgICAgIHRleHQ6IGZhbHNlXHJcbiAgICAgICAgfSlcclxuICAgICAgICAuYnV0dG9uKCdyZWZyZXNoJyk7XHJcbiAgICAvLyB0b29sdGlwIHp1csO8Y2tzZXR6ZW5cclxuICAgICQoJy5tb2RpZnlfbGF5ZXJfbGFiZWwnKVxyXG4gICAgXHQuYXR0cigndGl0bGUnLCAnRWJlbmUgYmVhcmJlaXRlbicpXHJcbiAgICBcdC50b29sdGlwKHtcclxuICAgICAgICAgICAgdG9vbHRpcENsYXNzOiBcInRvb2x0aXAtc3R5bGluZy1oaW50ZXJsZWd0XCIsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6ICdFYmVuZSBiZWFyYmVpdGVuJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgLy8gZ2VvbV9zZWxlY3QgYXVzYmxlbmRlblxyXG4gICAgJCgnLm1vZGlmeV9sYXllcl9nZW9tX3R5cGUnKS5oaWRlKCk7XHJcbiAgICAvLyDDvGJyaWdlIExheWVyIGRlYWt0aXZpZXJlblxyXG4gICAgJG1vZGlmeV9sYXllci5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgXHQvLyBzaWNoZXJzdGVsbGVuLCBkYXNzIGRlciBqZXR6dCB6dSBha3RpdmllcmVuZGUgTGF5ZXIgbmljaHQgZGVha3RpdmllcnQgd2lyZFxyXG4gICAgXHRpZiAoJCh0aGlzKS5wcm9wKCdjaGVja2VkJykgJiYgISQodGhpcykuaXMoaW5wdXRfZGl2KSkge1xyXG4gICAgXHRcdCQodGhpcykucHJvcChcImNoZWNrZWRcIiwgZmFsc2UpLmNoYW5nZSgpO1xyXG4gICAgXHR9XHJcbiAgICB9KVxyXG59O1xyXG5cclxud2luZG93LmFwZi5vbG1hcC5lcnN0ZWxsZU1vZGlmeUludGVyYWN0aW9uRsO8clZlY3RvckxheWVyID0gZnVuY3Rpb24odmVjdG9ybGF5ZXIpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICB2YXIgZGVmYXVsdFN0eWxlID0ge1xyXG4gICAgICAgICdQb2ludCc6IFtuZXcgb2wuc3R5bGUuU3R5bGUoe1xyXG4gICAgICAgICAgICBpbWFnZTogbmV3IG9sLnN0eWxlLkNpcmNsZSh7XHJcbiAgICAgICAgICAgICAgICBmaWxsOiBuZXcgb2wuc3R5bGUuRmlsbCh7XHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdyZ2JhKDI1NSwyNTUsMCwwLjUpJ1xyXG4gICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICByYWRpdXM6IDUsXHJcbiAgICAgICAgICAgICAgICBzdHJva2U6IG5ldyBvbC5zdHlsZS5TdHJva2Uoe1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnI2ZmMCcsXHJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDFcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSldLFxyXG4gICAgICAgICdMaW5lU3RyaW5nJzogW25ldyBvbC5zdHlsZS5TdHlsZSh7XHJcbiAgICAgICAgICAgIHN0cm9rZTogbmV3IG9sLnN0eWxlLlN0cm9rZSh7XHJcbiAgICAgICAgICAgICAgICBjb2xvcjogJyNmMDAnLFxyXG4gICAgICAgICAgICAgICAgd2lkdGg6IDNcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KV0sXHJcbiAgICAgICAgJ1BvbHlnb24nOiBbbmV3IG9sLnN0eWxlLlN0eWxlKHtcclxuICAgICAgICAgICAgZmlsbDogbmV3IG9sLnN0eWxlLkZpbGwoe1xyXG4gICAgICAgICAgICAgICAgY29sb3I6ICdyZ2JhKDAsMjU1LDI1NSwwLjUpJ1xyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgc3Ryb2tlOiBuZXcgb2wuc3R5bGUuU3Ryb2tlKHtcclxuICAgICAgICAgICAgICAgIGNvbG9yOiAnIzBmZicsXHJcbiAgICAgICAgICAgICAgICB3aWR0aDogMVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXSxcclxuICAgICAgICAnTXVsdGlQb2ludCc6IFtuZXcgb2wuc3R5bGUuU3R5bGUoe1xyXG4gICAgICAgICAgICBpbWFnZTogbmV3IG9sLnN0eWxlLkNpcmNsZSh7XHJcbiAgICAgICAgICAgICAgICBmaWxsOiBuZXcgb2wuc3R5bGUuRmlsbCh7XHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdyZ2JhKDI1NSwwLDI1NSwwLjUpJ1xyXG4gICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICByYWRpdXM6IDUsXHJcbiAgICAgICAgICAgICAgICBzdHJva2U6IG5ldyBvbC5zdHlsZS5TdHJva2Uoe1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnI2YwZicsXHJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDFcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSldLFxyXG4gICAgICAgICdNdWx0aUxpbmVTdHJpbmcnOiBbbmV3IG9sLnN0eWxlLlN0eWxlKHtcclxuICAgICAgICAgICAgc3Ryb2tlOiBuZXcgb2wuc3R5bGUuU3Ryb2tlKHtcclxuICAgICAgICAgICAgICAgIGNvbG9yOiAnIzBmMCcsXHJcbiAgICAgICAgICAgICAgICB3aWR0aDogM1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXSxcclxuICAgICAgICAnTXVsdGlQb2x5Z29uJzogW25ldyBvbC5zdHlsZS5TdHlsZSh7XHJcbiAgICAgICAgICAgIGZpbGw6IG5ldyBvbC5zdHlsZS5GaWxsKHtcclxuICAgICAgICAgICAgICAgIGNvbG9yOiAncmdiYSgwLDAsMjU1LDAuNSknXHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICBzdHJva2U6IG5ldyBvbC5zdHlsZS5TdHJva2Uoe1xyXG4gICAgICAgICAgICAgICAgY29sb3I6ICcjMDBmJyxcclxuICAgICAgICAgICAgICAgIHdpZHRoOiAxXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSldXHJcbiAgICB9O1xyXG5cclxuICAgIGlmICh2ZWN0b3JsYXllciA9PT0gJ25ldWVyX2xheWVyJykge1xyXG4gICAgICAgIHZlY3RvcmxheWVyID0gbmV3IG9sLmxheWVyLlZlY3Rvcih7XHJcbiAgICAgICAgXHRndWlkOiB3aW5kb3cuYXBmLmVyc3RlbGxlR3VpZCgpLFxyXG4gICAgICAgICAgICBzb3VyY2U6IG5ldyBvbC5zb3VyY2UuVmVjdG9yKCksXHJcbiAgICAgICAgICAgIHRpdGxlOiAnbmV1ZSBFYmVuZScsXHJcbiAgICAgICAgICAgIGthdGVnb3JpZTogJ0VpZ2VuZSBFYmVuZW4nLFxyXG4gICAgICAgICAgICBzdHlsZTogZnVuY3Rpb24oZmVhdHVyZSwgcmVzb2x1dGlvbikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRTdHlsZVtmZWF0dXJlLmdldEdlb21ldHJ5KCkuZ2V0VHlwZSgpXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHdpbmRvdy5hcGYub2xtYXAubWFwLmFkZExheWVyKHZlY3RvcmxheWVyKTtcclxuICAgICAgICAvLyB1bWJlbmVubmVuLCBkYW5uIE1vZGlmeUludGVyYWN0aW9uIGVyc3RlbGxlblxyXG4gICAgICAgIHdpbmRvdy5hcGYub2xtYXAuZnJhZ2VOYW1lRsO8ckViZW5lKHZlY3RvcmxheWVyKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGxheWVyX3RpdGxlID0gdmVjdG9ybGF5ZXIuZ2V0KCd0aXRsZScpLFxyXG4gICAgICAgICRnZW9tX3R5cGVfc2VsZWN0ID0gJCgnI21vZGlmeV9sYXllcl9nZW9tX3R5cGVfJyArIGxheWVyX3RpdGxlLnJlcGxhY2UoXCIgXCIsIFwiX1wiKSk7XHJcblxyXG4gICAgLy8gZGFyaW4gd2VyZGVuIGRpZSBpZHMgdm9uIHNlbGVjdGllcnRlbiBmZWF0dXJlcyBnZXNwZWljaGVydFxyXG4gICAgd2luZG93LmFwZi5vbG1hcC5tb2RpZmllZF9mZWF0dXJlcyA9IFtdO1xyXG5cclxuICAgIC8vIGFsbGbDpGxsaWdlIGJlc3RlaGVuZGUgSW50ZXJhY3Rpb24gZW50ZmVybmVuXHJcbiAgICB3aW5kb3cuYXBmLm9sbWFwLmVudGZlcm5lTW9kaWZ5SW50ZXJhY3Rpb25Gw7xyVmVjdG9yTGF5ZXIoKTtcclxuXHJcbiAgICAvLyBzZWxlY3QgaW50ZXJhY3Rpb24gZXJzdGVsbGVuXHJcbiAgICB3aW5kb3cuYXBmLm9sbWFwLnNlbGVjdF9pbnRlcmFjdGlvbl9mw7xyX3ZlY3RvcmxheWVyID0gbmV3IG9sLmludGVyYWN0aW9uLlNlbGVjdCh7XHJcbiAgICAgICAgbGF5ZXJzOiBmdW5jdGlvbihsYXllcikge1xyXG4gICAgICAgIFx0Ly8gc2VsZWN0YWJsZSBzaW5kIG51ciBmZWF0dXJlcyBhdXMgZGVtIGdld8OkaGx0ZW4gbGF5ZXJcclxuICAgICAgICAgICAgcmV0dXJuIGxheWVyLmdldCgndGl0bGUnKSA9PT0gbGF5ZXJfdGl0bGU7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gc2VsZWN0ZWQgZmVhdHVyZXMgc29sbGVuIG1vZGlmaXppZXJ0IHdlcmRlbiBrw7ZubmVuXHJcbiAgICB3aW5kb3cuYXBmLm9sbWFwLnNlbGVjdGVkX2ZlYXR1cmVzID0gd2luZG93LmFwZi5vbG1hcC5zZWxlY3RfaW50ZXJhY3Rpb25fZsO8cl92ZWN0b3JsYXllci5nZXRGZWF0dXJlcygpO1xyXG5cclxuICAgIHdpbmRvdy5hcGYub2xtYXAuc2VsZWN0ZWRfZmVhdHVyZXMub24oJ2FkZCcsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgLy8gbm93IGxpc3RlbiBpZiB0aGUgZmVhdHVyZSBpcyBjaGFuZ2VkXHJcbiAgICAgICAgdmFyIGZlYXR1cmUgPSBldmVudC5lbGVtZW50LFxyXG4gICAgICAgICAgICBmZWF0dXJlX2lkID0gZmVhdHVyZS5nZXRJZCgpO1xyXG4gICAgICAgIC8vIHdlbm4gamVtYW5kIGVpbmUgZWlnZW5lIEViZW5lIGVyZ8Okbnp0IGhhdCwga2FubiBlcyBzZWluLCBkYXNzIGRpZSBmZWF0dXJlcyBrZWluZSBpZCdzIGhhYmVuXHJcbiAgICAgICAgLy8gYWxzbyB3ZW5uIG7DtnRpZyBlcmfDpG56ZW5cclxuICAgICAgICBpZiAoIWZlYXR1cmVfaWQpIHtcclxuICAgICAgICAgICAgZmVhdHVyZS5zZXRJZChfLnVuaXF1ZUlkKCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmZWF0dXJlLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICB2YXIgZmVhdHVyZSA9IGV2ZW50LnRhcmdldCxcclxuICAgICAgICAgICAgICAgIGZlYXR1cmVfaWQgPSBmZWF0dXJlLmdldElkKCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5hcGYub2xtYXAubW9kaWZpZWRfZmVhdHVyZXMgPSB3aW5kb3cuYXBmLm9sbWFwLm1vZGlmaWVkX2ZlYXR1cmVzIHx8IFtdO1xyXG4gICAgICAgICAgICAvLyBpZCBpbiBtb2RpZmllZF9mZWF0dXJlcyBlcmfDpG56ZW5cclxuICAgICAgICAgICAgd2luZG93LmFwZi5vbG1hcC5tb2RpZmllZF9mZWF0dXJlcyA9IF8udW5pb24od2luZG93LmFwZi5vbG1hcC5tb2RpZmllZF9mZWF0dXJlcywgW2ZlYXR1cmVfaWRdKTtcclxuICAgICAgICAgICAgLy8gc3BlaWNoZXJuXHJcbiAgICAgICAgICAgIHdpbmRvdy5hcGYub2xtYXAuYWt0dWFsaXNpZXJlRWJlbmVJbkxvY2FsU3RvcmFnZSh2ZWN0b3JsYXllcik7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIGxpc3RlbiB0byBwcmVzc2luZyBvZiBkZWxldGUga2V5LCB0aGVuIGRlbGV0ZSBzZWxlY3RlZCBmZWF0dXJlc1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdrZXl1cCcsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGlmIChldmVudC5rZXlDb2RlID09IDQ2KSB7XHJcbiAgICAgICAgICAgICAgICAvLyBhbGxlIGdld8OkaGx0ZW4gZmVhdHVyZXMgYXVzIHNlbGVjdF9pbnRlcmFjdGlvbiB1bmQgc291cmNlIGVudGZlcm5lblxyXG4gICAgICAgICAgICAgICAgd2luZG93LmFwZi5vbG1hcC5zZWxlY3RlZF9mZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uKHNlbGVjdGVkX2ZlYXR1cmUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWRfZmVhdHVyZV9pZCA9IHNlbGVjdGVkX2ZlYXR1cmUuZ2V0SWQoKTtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuYXBmLm9sbWFwLnNlbGVjdGVkX2ZlYXR1cmVzLnJlbW92ZShzZWxlY3RlZF9mZWF0dXJlKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBmZWF0dXJlcyBhdXMgdmVjdG9ybGF5ZXJfc291cmNlIGVudGZlcm5lblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciB2ZWN0b3JsYXllcl9mZWF0dXJlcyA9IHZlY3RvcmxheWVyLmdldFNvdXJjZSgpLmdldEZlYXR1cmVzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmVjdG9ybGF5ZXJfZmVhdHVyZXMuZm9yRWFjaChmdW5jdGlvbihzb3VyY2VfZmVhdHVyZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc291cmNlX2ZlYXR1cmVfaWQgPSBzb3VyY2VfZmVhdHVyZS5nZXRJZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlX2ZlYXR1cmVfaWQgPT09IHNlbGVjdGVkX2ZlYXR1cmVfaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlY3RvcmxheWVyLmdldFNvdXJjZSgpLnJlbW92ZUZlYXR1cmUoc291cmNlX2ZlYXR1cmUpO1xyXG5cdFx0XHQgICAgICAgICAgICAgICAgLy8gc3BlaWNoZXJuXHJcblx0XHRcdCAgICAgICAgICAgICAgICB3aW5kb3cuYXBmLm9sbWFwLmFrdHVhbGlzaWVyZUViZW5lSW5Mb2NhbFN0b3JhZ2UodmVjdG9ybGF5ZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICQoZG9jdW1lbnQpLm9mZigna2V5dXAnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyB2ZXJoaW5kZXJuLCBkYXNzIEtub3RlbiBpbSBTdHJ1a3R1cmJhdW0gZW50ZmVybnQgd2VyZGVuXHJcbiAgICAgICAgJC5qc3RyZWUuX3JlZmVyZW5jZShcIlt0eXA9J2FwX29yZG5lcl9wb3AnXVwiKS5kZXNlbGVjdF9hbGwoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHdpbmRvdy5hcGYub2xtYXAuc2VsZWN0ZWRfZmVhdHVyZXMub24oJ3JlbW92ZScsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgdmFyIGZlYXR1cmUgPSBldmVudC5lbGVtZW50LFxyXG4gICAgICAgICAgICBmZWF0dXJlX2lkID0gZmVhdHVyZS5nZXRJZCgpLFxyXG4gICAgICAgICAgICBmZWF0dXJlX2luZGV4ID0gd2luZG93LmFwZi5vbG1hcC5tb2RpZmllZF9mZWF0dXJlcy5pbmRleE9mKGZlYXR1cmVfaWQpO1xyXG4gICAgICAgIGlmIChmZWF0dXJlX2luZGV4ID4gLTEpIHtcclxuICAgICAgICAgICAgLy8gc3BlaWNoZXJuXHJcbiAgICAgICAgICAgIHdpbmRvdy5hcGYub2xtYXAuYWt0dWFsaXNpZXJlRWJlbmVJbkxvY2FsU3RvcmFnZSh2ZWN0b3JsYXllcik7XHJcbiAgICAgICAgICAgIC8vIGVyc3Qgd2llZGVyIHNwZWljaGVybiwgd2VubiBuZXUgdmVyw6RuZGVydCB3dXJkZVxyXG4gICAgICAgICAgICB3aW5kb3cuYXBmLm9sbWFwLm1vZGlmaWVkX2ZlYXR1cmVzLnNwbGljZShmZWF0dXJlX2luZGV4LCAxKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBnbG9iYWwgZGVmaW5pZXJlbjogd2lyZCBiZW7DtnRpZ3QsIHVtIHNww6R0ZXIgKGJlaW0gS2xpY2sgYXVmICdFYmVuZSBiZWFyYmVpdGVuJykgZmVzdHp1c3RlbGxlbiwgb2IgZWluZSBtb2RpZnktaW50ZXJhY3Rpb24gZXhpc3RpZXJ0XHJcbiAgICB3aW5kb3cuYXBmLm9sbWFwLm1vZGlmeV9pbnRlcmFjdGlvbl9mw7xyX3ZlY3RvcmxheWVyID0gbmV3IG9sLmludGVyYWN0aW9uLk1vZGlmeSh7XHJcbiAgICAgICAgZmVhdHVyZXM6IHdpbmRvdy5hcGYub2xtYXAuc2VsZWN0X2ludGVyYWN0aW9uX2bDvHJfdmVjdG9ybGF5ZXIuZ2V0RmVhdHVyZXMoKSxcclxuICAgICAgICAvLyB0aGUgU0hJRlQga2V5IG11c3QgYmUgcHJlc3NlZCB0byBkZWxldGUgdmVydGljZXMsIHNvXHJcbiAgICAgICAgLy8gdGhhdCBuZXcgdmVydGljZXMgY2FuIGJlIGRyYXduIGF0IHRoZSBzYW1lIHBvc2l0aW9uXHJcbiAgICAgICAgLy8gb2YgZXhpc3RpbmcgdmVydGljZXNcclxuICAgICAgICBkZWxldGVDb25kaXRpb246IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBvbC5ldmVudHMuY29uZGl0aW9uLnNoaWZ0S2V5T25seShldmVudCkgJiZcclxuICAgICAgICAgICAgICAgIG9sLmV2ZW50cy5jb25kaXRpb24uc2luZ2xlQ2xpY2soZXZlbnQpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgICRnZW9tX3R5cGVfc2VsZWN0Lm9uKCdzZWxlY3RtZW51Y2hhbmdlJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICB3aW5kb3cuYXBmLm9sbWFwLm1hcC5yZW1vdmVJbnRlcmFjdGlvbih3aW5kb3cuYXBmLm9sbWFwLmRyYXdfaW50ZXJhY3Rpb25fZsO8cl92ZWN0b3JsYXllcik7XHJcbiAgICAgICAgYWRkRHJhd0ludGVyYWN0aW9uKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBmdW5jdGlvbiBhZGREcmF3SW50ZXJhY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKCRnZW9tX3R5cGVfc2VsZWN0LnZhbCgpICE9PSAnbGVlcndlcnQnKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5hcGYub2xtYXAuZHJhd19pbnRlcmFjdGlvbl9mw7xyX3ZlY3RvcmxheWVyID0gbmV3IG9sLmludGVyYWN0aW9uLkRyYXcoe1xyXG4gICAgICAgICAgICAgICAgc291cmNlOiB2ZWN0b3JsYXllci5nZXRTb3VyY2UoKSxcclxuICAgICAgICAgICAgICAgIHR5cGU6IC8qKiBAdHlwZSB7b2wuZ2VvbS5HZW9tZXRyeVR5cGV9ICovICgkZ2VvbV90eXBlX3NlbGVjdC52YWwoKSlcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5hcGYub2xtYXAubWFwLmFkZEludGVyYWN0aW9uKHdpbmRvdy5hcGYub2xtYXAuZHJhd19pbnRlcmFjdGlvbl9mw7xyX3ZlY3RvcmxheWVyKTtcclxuICAgICAgICAgICAgLy8gYmVpICdkcmF3ZW5kJyB3w7xyZGUgbWFuIMOEbmRlcnVuZ2VuIGluIGRpZSBEQiBzY2hyZWliZW5cclxuICAgICAgICAgICAgd2luZG93LmFwZi5vbG1hcC5kcmF3X2ludGVyYWN0aW9uX2bDvHJfdmVjdG9ybGF5ZXIub24oJ2RyYXdlbmQnLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGlkID0gXy51bmlxdWVJZCgpO1xyXG4gICAgICAgICAgICAgICAgZXZlbnQuZmVhdHVyZS5zZXRJZChpZCk7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuYXBmLm9sbWFwLm1vZGlmaWVkX2ZlYXR1cmVzID0gd2luZG93LmFwZi5vbG1hcC5tb2RpZmllZF9mZWF0dXJlcyB8fCBbXTtcclxuICAgICAgICAgICAgICAgIC8vIGlkIGluIG1vZGlmaWVkX2ZlYXR1cmVzIGVyZ8OkbnplblxyXG4gICAgICAgICAgICAgICAgd2luZG93LmFwZi5vbG1hcC5tb2RpZmllZF9mZWF0dXJlcyA9IF8udW5pb24od2luZG93LmFwZi5vbG1hcC5tb2RpZmllZF9mZWF0dXJlcywgW2lkXSk7XHJcbiAgICAgICAgICAgICAgICAvLyBzcGVpY2hlcm5cclxuICAgICAgICAgICAgICAgIHdpbmRvdy5hcGYub2xtYXAuYWt0dWFsaXNpZXJlRWJlbmVJbkxvY2FsU3RvcmFnZSh2ZWN0b3JsYXllcik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBhZGREcmF3SW50ZXJhY3Rpb24oKTtcclxuICAgIHdpbmRvdy5hcGYub2xtYXAubWFwLmFkZEludGVyYWN0aW9uKHdpbmRvdy5hcGYub2xtYXAuc2VsZWN0X2ludGVyYWN0aW9uX2bDvHJfdmVjdG9ybGF5ZXIpO1xyXG4gICAgd2luZG93LmFwZi5vbG1hcC5tYXAuYWRkSW50ZXJhY3Rpb24od2luZG93LmFwZi5vbG1hcC5tb2RpZnlfaW50ZXJhY3Rpb25fZsO8cl92ZWN0b3JsYXllcik7XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLm9sbWFwLmV4cG9ydGllcmVMYXllciA9IGZ1bmN0aW9uKGxheWVyLCBzZWxlY3RlZF92YWx1ZSkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgbGF5ZXJfbmFtZSA9IGxheWVyLmdldCgndGl0bGUnKSB8fCAnRWlnZW5lX0ViZW5lJyxcclxuXHRcdGFsbEZlYXR1cmVzID0gbGF5ZXIuZ2V0U291cmNlKCkuZ2V0RmVhdHVyZXMoKSxcclxuICAgICAgICBmb3JtYXQgPSBuZXcgb2wuZm9ybWF0W3NlbGVjdGVkX3ZhbHVlXSgpLFxyXG4gICAgICAgIGRhdGFfcGFyc2VkLFxyXG4gICAgICAgIGRhdGFfc3RyaW5naWZpZWQ7XHJcbiAgICBsYXllcl9uYW1lICs9ICcuJyArIHNlbGVjdGVkX3ZhbHVlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBkYXRhX3BhcnNlZCA9IGZvcm1hdC53cml0ZUZlYXR1cmVzKGFsbEZlYXR1cmVzKTtcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICB3aW5kb3cuYXBmLm1lbGRlKCdTb3JyeSwgZGFzIGthbm4gT3BlbiBMYXllcnMgMyBub2NoIG5pY2h0IHJpY2h0aWcnLCAnRmVobGVyIGJlaW0gRXhwb3J0Jyk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKHNlbGVjdGVkX3ZhbHVlID09PSAnR2VvSlNPTicpIHtcclxuICAgIFx0dHJ5IHtcclxuICAgICAgICBcdGRhdGFfc3RyaW5naWZpZWQgPSBKU09OLnN0cmluZ2lmeShkYXRhX3BhcnNlZCwgbnVsbCwgNCk7XHJcbiAgICBcdH1cclxuICAgIFx0Y2F0Y2ggKGUpIHtcclxuICAgIFx0XHR3aW5kb3cuYXBmLm1lbGRlKCdTb3JyeSwgZGFzIGthbm4gT3BlbiBMYXllcnMgMyBub2NoIG5pY2h0IHJpY2h0aWcnLCAnRmVobGVyIGJlaW0gRXhwb3J0Jyk7XHJcbiAgICBcdH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdmFyIHNlcmlhbGl6ZXIgPSBuZXcgWE1MU2VyaWFsaXplcigpO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgXHRkYXRhX3N0cmluZ2lmaWVkID0gc2VyaWFsaXplci5zZXJpYWxpemVUb1N0cmluZyhkYXRhX3BhcnNlZCk7XHJcbiAgICBcdH1cclxuICAgIFx0Y2F0Y2ggKGUpIHtcclxuICAgIFx0XHR3aW5kb3cuYXBmLm1lbGRlKCdTb3JyeSwgZGFzIGthbm4gT3BlbiBMYXllcnMgMyBub2NoIG5pY2h0IHJpY2h0aWcnLCAnRmVobGVyIGJlaW0gRXhwb3J0Jyk7XHJcbiAgICBcdH1cclxuICAgIH1cclxuICAgIHdpbmRvdy5hcGYuZG93bmxvYWQobGF5ZXJfbmFtZSwgZGF0YV9zdHJpbmdpZmllZCk7XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLmRvd25sb2FkID0gZnVuY3Rpb24oZmlsZW5hbWUsIHRleHQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcbiAgICB2YXIgcG9tID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gICAgcG9tLnNldEF0dHJpYnV0ZSgnaHJlZicsICdkYXRhOnRleHQvcGxhaW47Y2hhcnNldD11dGYtOCwnICsgZW5jb2RlVVJJQ29tcG9uZW50KHRleHQpKTtcclxuICAgIHBvbS5zZXRBdHRyaWJ1dGUoJ2Rvd25sb2FkJywgZmlsZW5hbWUpO1xyXG4gICAgcG9tLmNsaWNrKCk7XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLm9sbWFwLmlzdExheWVyU2ljaHRiYXJOYWNoTmFtZSA9IGZ1bmN0aW9uKGxheWVybmFtZSkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgbGF5ZXJfb2JqZWt0X2FycmF5LFxyXG5cdFx0bGF5ZXJfaXN0X3NpY2h0YmFyO1xyXG5cdC8vIHByw7xmZW4sIG9iIGVpbmUgbWFwIGV4aXN0aWVydFxyXG5cdGlmICh3aW5kb3cuYXBmLm9sbWFwLm1hcCkge1xyXG5cdFx0bGF5ZXJfb2JqZWt0X2FycmF5ID0gd2luZG93LmFwZi5vbG1hcC5tYXAuZ2V0TGF5ZXJzKCkuZ2V0QXJyYXkoKTtcclxuXHRcdGxheWVyX2lzdF9zaWNodGJhciA9IF8uZmluZChsYXllcl9vYmpla3RfYXJyYXksIGZ1bmN0aW9uKGxheWVyX29iamVrdCkge1xyXG5cdFx0XHRyZXR1cm4gbGF5ZXJfb2JqZWt0LmdldCgndGl0bGUnKSA9PT0gbGF5ZXJuYW1lICYmIGxheWVyX29iamVrdC5nZXQoJ3Zpc2libGUnKTtcclxuXHRcdH0pO1xyXG5cdFx0aWYgKGxheWVyX2lzdF9zaWNodGJhcikge1xyXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdH1cclxuXHR9XHJcblx0cmV0dXJuIGZhbHNlO1xyXG59O1xyXG5cclxud2luZG93LmFwZi56ZWlnZVRQb3BBdWZPbG1hcCA9IGZ1bmN0aW9uKFRQb3BMaXN0ZU1hcmtpZXJ0KSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIHdlbm4gbGF5ZXIgXCJQb3B1bGF0aW9uZW5cIiBzaWNodGJhciBpc3QsIHNpY2h0YmFyIGJlaGFsdGVuXHJcblx0dmFyIG92ZXJsYXlfcG9wX3Zpc2libGUgPSB3aW5kb3cuYXBmLm9sbWFwLmlzdExheWVyU2ljaHRiYXJOYWNoTmFtZShcIlBvcHVsYXRpb25lblwiKTtcclxuXHQvLyB3ZW5uIGxheWVyIFwiUG9wdWxhdGlvbmVuIE5hbWVuXCIgc2ljaHRiYXIgaXN0LCBzaWNodGJhciBiZWhhbHRlblxyXG5cdHZhciBvdmVybGF5X3BvcG5yX3Zpc2libGUgPSB3aW5kb3cuYXBmLm9sbWFwLmlzdExheWVyU2ljaHRiYXJOYWNoTmFtZShcIlBvcHVsYXRpb25lbiBOdW1tZXJuXCIpO1xyXG5cdFxyXG5cdHZhciBtYXJraWVydGVfdHBvcCA9IHdpbmRvdy5hcGYub2xtYXAud8OkaGxlQXVzc2Nobml0dEbDvHLDnGJlcmdlYmVuZVRQb3AoVFBvcExpc3RlTWFya2llcnQpO1xyXG5cclxuXHQvLyBHcnVuZGthcnRlIGF1ZmJhdWVuXHJcblx0JC53aGVuKHdpbmRvdy5hcGYuemVpZ2VGb3JtdWxhcihcIkdlb0FkbWluS2FydGVcIikpXHJcblx0XHQudGhlbihmdW5jdGlvbigpIHtcclxuXHRcdFx0Ly8gS2FydGUgenVtIHJpY2h0aWdlbiBBdXNzY2huaXR0IHpvb21lblxyXG4gICAgICAgICAgICB3aW5kb3cuYXBmLm9sbWFwLm1hcC51cGRhdGVTaXplKCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5hcGYub2xtYXAubWFwLmdldFZpZXcoKS5maXRFeHRlbnQobWFya2llcnRlX3Rwb3AuYm91bmRzLCB3aW5kb3cuYXBmLm9sbWFwLm1hcC5nZXRTaXplKCkpO1xyXG5cdFx0XHQvLyB0cG9wIHVuZCBwb3AgZXJnw6RuemVuXHJcblx0XHRcdC8vIGFsbGUgdHBvcCBob2xlblxyXG5cdFx0XHR2YXIgZ2V0VFBvcEthcnRlQWxsZSA9ICQuYWpheCh7XHJcblx0XHRcdFx0dHlwZTogJ2dldCcsXHJcblx0XHRcdFx0dXJsOiAncGhwL3Rwb3Bfa2FydGVfYWxsZS5waHAnLFxyXG5cdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XCJBcEFydElkXCI6IHdpbmRvdy5hcGYuYXAuQXBBcnRJZFxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRnZXRUUG9wS2FydGVBbGxlLmFsd2F5cyhmdW5jdGlvbih0cG9wX2xpc3RlKSB7XHJcblx0XHRcdFx0JC53aGVuKFxyXG5cdFx0XHRcdFx0Ly8gTGF5ZXIgZsO8ciBTeW1ib2xlIHVuZCBCZXNjaHJpZnR1bmcgZXJzdGVsbGVuXHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLm9sbWFwLmVyc3RlbGxlVFBvcExheWVyKHRwb3BfbGlzdGUsIG1hcmtpZXJ0ZV90cG9wLnRwb3BpZF9tYXJraWVydCwgdHJ1ZSksXHJcblx0XHRcdFx0XHQvLyBhbGxlIFBvcCBob2xlblxyXG5cdFx0XHRcdFx0d2luZG93LmFwZi5vbG1hcC56ZWlnZVBvcEluVFBvcChvdmVybGF5X3BvcF92aXNpYmxlLCBvdmVybGF5X3BvcG5yX3Zpc2libGUpXHJcblx0XHRcdFx0KVxyXG5cdFx0XHRcdC50aGVuKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gbGF5ZXJ0cmVlIG5ldSBhdWZiYXVlblxyXG5cdFx0XHRcdFx0d2luZG93LmFwZi5vbG1hcC5pbml0aWllcmVMYXllcnRyZWUoKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRnZXRUUG9wS2FydGVBbGxlLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBFcyBrb25udGVuIGtlaW5lIFRlaWxwb3B1bGF0aW9uZW4gYXVzIGRlciBEYXRlbmJhbmsgYWJnZXJ1ZmVuIHdlcmRlblwiKTtcclxuXHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBFcyBrb25udGVuIGtlaW5lIFRlaWxwb3B1bGF0aW9uZW4gYXVzIGRlciBEYXRlbmJhbmsgYWJnZXJ1ZmVuIHdlcmRlbicpO1xyXG5cdFx0XHR9KTtcclxuXHR9KTtcclxufTtcclxuXHJcbndpbmRvdy5hcGYuemVpZ2VQb3BBdWZPbG1hcCA9IGZ1bmN0aW9uKFBvcExpc3RlTWFya2llcnQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gZmFsbHMgbm9jaCBhdXMgZGVtIFZlcm9ydGVuIGVpbiBLbGljay1IYW5kbGVyIGJlc3RlaHQ6IGRlYWt0aXZpZXJlblxyXG5cdGlmICh3aW5kb3cuYXBmLm9sbWFwLkxldHp0ZXJLbGlja0hhbmRsZXIpIHtcclxuXHRcdHdpbmRvdy5hcGYub2xtYXAuTGV0enRlcktsaWNrSGFuZGxlci5kZWFjdGl2YXRlKCk7XHJcblx0fVxyXG5cdFxyXG5cdHZhciBtYXJraWVydGVfcG9wID0gd2luZG93LmFwZi5vbG1hcC53w6RobGVBdXNzY2huaXR0RsO8csOcYmVyZ2ViZW5lUG9wKFBvcExpc3RlTWFya2llcnQpLFxyXG5cdFx0ZXh0ZW50O1xyXG5cclxuXHQvLyBHcnVuZGthcnRlIGF1ZmJhdWVuXHJcblx0JC53aGVuKHdpbmRvdy5hcGYuemVpZ2VGb3JtdWxhcihcIkdlb0FkbWluS2FydGVcIikpXHJcblx0XHQudGhlbihmdW5jdGlvbigpIHtcclxuXHRcdFx0Ly8gS2FydGUgenVtIHJpY2h0aWdlbiBBdXNzY2huaXR0IHpvb21lblxyXG5cdFx0XHQvLyBhYmVyIG51ciwgd2VubiBrZWluZSBBdXN3YWhsIGFrdGl2XHJcblx0XHRcdGlmICh3aW5kb3cuYXBmLm9sbWFwLmF1c3dhaGxQb2x5Z29uTGF5ZXIgJiYgd2luZG93LmFwZi5vbG1hcC5hdXN3YWhsUG9seWdvbkxheWVyLmZlYXR1cmVzLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0XHQvLyBBdXN3YWhsIGFrdGl2LCBab29tc3R1ZmUgYmVsYXNzZW5cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHR3aW5kb3cuYXBmLm9sbWFwLm1hcC51cGRhdGVTaXplKCk7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuYXBmLm9sbWFwLm1hcC5nZXRWaWV3KCkuZml0RXh0ZW50KG1hcmtpZXJ0ZV9wb3AuYm91bmRzLCB3aW5kb3cuYXBmLm9sbWFwLm1hcC5nZXRTaXplKCkpO1xyXG5cdFx0XHR9XHJcblx0XHRcdC8vIHRwb3AgdW5kIHBvcCBlcmfDpG56ZW5cclxuXHRcdFx0Ly8gYWxsZSB0cG9wIGhvbGVuXHJcblx0XHRcdHZhciBnZXRUUG9wS2FydGVBbGxlXzIgPSAkLmFqYXgoe1xyXG5cdFx0XHRcdHR5cGU6ICdnZXQnLFxyXG5cdFx0XHRcdHVybDogJ3BocC90cG9wX2thcnRlX2FsbGUucGhwJyxcclxuXHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFwiQXBBcnRJZFwiOiB3aW5kb3cuYXBmLmFwLkFwQXJ0SWRcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Z2V0VFBvcEthcnRlQWxsZV8yLmFsd2F5cyhmdW5jdGlvbihUUG9wTGlzdGUpIHtcclxuXHRcdFx0XHQkLndoZW4oXHJcblx0XHRcdFx0XHQvLyBMYXllciBmw7xyIFN5bWJvbGUgdW5kIEJlc2NocmlmdHVuZyBlcnN0ZWxsZW5cclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuYXBmLm9sbWFwLmVyc3RlbGxlVFBvcExheWVyKFRQb3BMaXN0ZSksXHJcblx0XHRcdFx0XHQvLyBhbGxlIFBvcCBob2xlbiwgc3ltYm9sZSB1bmQgbnIgc2ljaHRiYXIgc2NoYWx0ZW4sIE1hcmtpZXJ1bmcgw7xiZXJnZWJlblxyXG5cdFx0XHRcdFx0d2luZG93LmFwZi5vbG1hcC56ZWlnZVBvcEluVFBvcCh0cnVlLCB0cnVlLCBtYXJraWVydGVfcG9wLnBvcGlkX21hcmtpZXJ0KVxyXG5cdFx0XHRcdClcclxuXHRcdFx0XHQudGhlbihmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdC8vIGxheWVydHJlZSBuZXUgYXVmYmF1ZW5cclxuXHRcdFx0XHRcdHdpbmRvdy5hcGYub2xtYXAuaW5pdGlpZXJlTGF5ZXJ0cmVlKCk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Z2V0VFBvcEthcnRlQWxsZV8yLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBFcyBrb25udGVuIGtlaW5lIERhdGVuIGF1cyBkZXIgRGF0ZW5iYW5rIGFiZ2VydWZlbiB3ZXJkZW5cIik7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogRXMga29ubnRlbiBrZWluZSBEYXRlbiBhdXMgZGVyIERhdGVuYmFuayBhYmdlcnVmZW4gd2VyZGVuJyk7XHJcblx0XHRcdH0pO1xyXG5cdH0pO1xyXG59O1xyXG5cclxuLy8gw7xiZXJuaW1tdCBlaW5lIExpc3RlIHZvbiAobWFya2llcnRlbikgVFBvcFxyXG4vLyByZXRvdXJuaWVydCBkZW4gQXVzc2Nobml0dCA9IGJvdW5kcyBkZXIgYW5nZXplaWd0IHdlcmRlbiBzb2xsXHJcbi8vIHVuZCBlaW5lbiBhcnJheSBtaXQgZGVuIHRwb3BfaWQncyBkZXIgbGlzdGVcclxud2luZG93LmFwZi5vbG1hcC53w6RobGVBdXNzY2huaXR0RsO8csOcYmVyZ2ViZW5lVFBvcCA9IGZ1bmN0aW9uKHRwb3BfbGlzdGVfbWFya2llcnQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGJvdW5kcyxcclxuXHRcdHhrb29yZF9hcnJheSA9IFtdLFxyXG5cdFx0eWtvb3JkX2FycmF5ID0gW10sXHJcbiAgICAgICAgeF9tYXgsXHJcbiAgICAgICAgeV9tYXgsXHJcbiAgICAgICAgeF9taW4sXHJcbiAgICAgICAgeV9taW47XHJcblxyXG5cdC8vIGJvdW5kcyBkZXIgYW56dXplaWdlbmRlbiBiZXN0aW1tZW5cclxuXHR2YXIgdHBvcGlkX21hcmtpZXJ0ID0gW107XHJcblx0aWYgKHRwb3BfbGlzdGVfbWFya2llcnQgJiYgdHBvcF9saXN0ZV9tYXJraWVydC5yb3dzICYmIHRwb3BfbGlzdGVfbWFya2llcnQucm93cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgXy5lYWNoKHRwb3BfbGlzdGVfbWFya2llcnQucm93cywgZnVuY3Rpb24odHBvcCkge1xyXG4gICAgICAgICAgICB0cG9waWRfbWFya2llcnQucHVzaCh0cG9wLlRQb3BJZCk7XHJcbiAgICAgICAgICAgIHhrb29yZF9hcnJheS5wdXNoKHRwb3AuVFBvcFhLb29yZCk7XHJcblx0ICAgICAgICB5a29vcmRfYXJyYXkucHVzaCh0cG9wLlRQb3BZS29vcmQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIGV4dGVudCBiZXJlY2huZW5cclxuXHQgICAgLy8gcHVmZmVybiwgZGFtaXQgaW1tZXIgYWxsZXMgc2ljaHRiYXIgaXN0XHJcblx0ICAgIC8vIHVuZGVyc2NvcmUgcmV0b3VybmllcnQgc3RyaW5ncywgYWxzbyBpbiBaYWhsZW4gdW13YW5kZWxuXHJcblx0ICAgIHhfbWF4ID0gcGFyc2VJbnQoXy5tYXgoeGtvb3JkX2FycmF5KSkgKyA3MDtcclxuXHQgICAgeF9taW4gPSBwYXJzZUludChfLm1pbih4a29vcmRfYXJyYXkpKSAtIDcwO1xyXG5cdCAgICB5X21heCA9IHBhcnNlSW50KF8ubWF4KHlrb29yZF9hcnJheSkpICsgNzA7XHJcblx0ICAgIHlfbWluID0gcGFyc2VJbnQoXy5taW4oeWtvb3JkX2FycmF5KSkgLSA3MDtcclxuXHQgICAgYm91bmRzID0gW3hfbWluLCB5X21pbiwgeF9tYXgsIHlfbWF4XTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0Ly8ga2VpbmUgdHBvcCDDvGJlcmdlYmVuLCBLYW50b24gYW56ZWlnZW5cclxuICAgICAgICBib3VuZHMgPSBbNjY5MDAwLCAyMjIwMDAsIDcxNzAwMCwgMjg0MDAwXTtcclxuXHR9XHJcblx0cmV0dXJuIHtib3VuZHM6IGJvdW5kcywgdHBvcGlkX21hcmtpZXJ0OiB0cG9waWRfbWFya2llcnR9O1xyXG59O1xyXG5cclxuLy8gw7xiZXJuaW1tdCBlaW5lIExpc3RlIHZvbiAobWFya2llcnRlbikgUG9wXHJcbi8vIHJldG91cm5pZXJ0IGRlbiBBdXNzY2huaXR0ID0gYm91bmRzIGRlciBhbmdlemVpZ3Qgd2VyZGVuIHNvbGxcclxuLy8gdW5kIGVpbmVuIGFycmF5IG1pdCBkZW4gdHBvcF9pZCdzIGRlciBsaXN0ZVxyXG53aW5kb3cuYXBmLm9sbWFwLnfDpGhsZUF1c3NjaG5pdHRGw7xyw5xiZXJnZWJlbmVQb3AgPSBmdW5jdGlvbihwb3BfbGlzdGVfbWFya2llcnQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGJvdW5kcyxcclxuXHRcdHhrb29yZF9hcnJheSA9IFtdLFxyXG5cdFx0eWtvb3JkX2FycmF5ID0gW10sXHJcbiAgICAgICAgeF9tYXgsXHJcbiAgICAgICAgeV9tYXgsXHJcbiAgICAgICAgeF9taW4sXHJcbiAgICAgICAgeV9taW4sXHJcbiAgICAgICAgLy8gYm91bmRzIGRlciBhbnp1emVpZ2VuZGVuIGJlc3RpbW1lblxyXG5cdFx0cG9waWRfbWFya2llcnQgPSBbXTtcclxuXHRpZiAocG9wX2xpc3RlX21hcmtpZXJ0ICYmIHBvcF9saXN0ZV9tYXJraWVydC5yb3dzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBfLmVhY2gocG9wX2xpc3RlX21hcmtpZXJ0LnJvd3MsIGZ1bmN0aW9uKHBvcCkge1xyXG4gICAgICAgICAgICBwb3BpZF9tYXJraWVydC5wdXNoKHBvcC5Qb3BJZCk7XHJcbiAgICAgICAgICAgIHhrb29yZF9hcnJheS5wdXNoKHBvcC5Qb3BYS29vcmQpO1xyXG5cdCAgICAgICAgeWtvb3JkX2FycmF5LnB1c2gocG9wLlBvcFlLb29yZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gZXh0ZW50IGJlcmVjaG5lblxyXG5cdCAgICAvLyBwdWZmZXJuLCBkYW1pdCBpbW1lciBhbGxlcyBzaWNodGJhciBpc3RcclxuXHQgICAgLy8gdW5kZXJzY29yZSByZXRvdXJuaWVydCBzdHJpbmdzLCBhbHNvIGluIFphaGxlbiB1bXdhbmRlbG5cclxuXHQgICAgeF9tYXggPSBwYXJzZUludChfLm1heCh4a29vcmRfYXJyYXkpKSArIDcwO1xyXG5cdCAgICB4X21pbiA9IHBhcnNlSW50KF8ubWluKHhrb29yZF9hcnJheSkpIC0gNzA7XHJcblx0ICAgIHlfbWF4ID0gcGFyc2VJbnQoXy5tYXgoeWtvb3JkX2FycmF5KSkgKyA3MDtcclxuXHQgICAgeV9taW4gPSBwYXJzZUludChfLm1pbih5a29vcmRfYXJyYXkpKSAtIDcwO1xyXG5cdCAgICBib3VuZHMgPSBbeF9taW4sIHlfbWluLCB4X21heCwgeV9tYXhdO1xyXG5cdH0gZWxzZSB7XHJcblx0XHQvLyBrZWluZSB0cG9wIMO8YmVyZ2ViZW4sIEthbnRvbiBhbnplaWdlblxyXG4gICAgICAgIGJvdW5kcyA9IFs2NjkwMDAsIDIyMjAwMCwgNzE3MDAwLCAyODQwMDBdO1xyXG5cdH1cclxuXHRyZXR1cm4ge2JvdW5kczogYm91bmRzLCBwb3BpZF9tYXJraWVydDogcG9waWRfbWFya2llcnR9O1xyXG59O1xyXG5cclxud2luZG93LmFwZi5vbG1hcC56ZWlnZVBvcEluVFBvcCA9IGZ1bmN0aW9uKG92ZXJsYXlfcG9wX3Zpc2libGUsIG92ZXJsYXlfcG9wbnJfdmlzaWJsZSwgcG9waWRfbWFya2llcnQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIHBvcF9nZXplaWd0ID0gJC5EZWZlcnJlZCgpLFxyXG5cdFx0Z2V0UG9wS2FydGVBbGxlID0gJC5hamF4KHtcclxuXHRcdFx0dHlwZTogJ2dldCcsXHJcblx0XHRcdHVybDogJ3BocC9wb3Bfa2FydGVfYWxsZS5waHAnLFxyXG5cdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XCJBcEFydElkXCI6IHdpbmRvdy5hcGYuYXAuQXBBcnRJZFxyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRnZXRQb3BLYXJ0ZUFsbGUuYWx3YXlzKGZ1bmN0aW9uKFBvcExpc3RlKSB7XHJcblx0XHQvLyBMYXllciBmw7xyIFN5bWJvbGUgdW5kIEJlc2NocmlmdHVuZyBlcnN0ZWxsZW5cclxuXHRcdCQud2hlbihcclxuXHRcdFx0d2luZG93LmFwZi5vbG1hcC5lcnN0ZWxsZVBvcExheWVyKFBvcExpc3RlLCBwb3BpZF9tYXJraWVydCwgb3ZlcmxheV9wb3BfdmlzaWJsZSlcclxuXHRcdClcclxuXHRcdC50aGVuKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHQvLyBsYXllcnRyZWUgbmV1IGF1ZmJhdWVuXHJcblx0XHRcdHdpbmRvdy5hcGYub2xtYXAuaW5pdGlpZXJlTGF5ZXJ0cmVlKCk7XHJcblx0XHRcdHBvcF9nZXplaWd0LnJlc29sdmUoKTtcclxuXHRcdH0pO1xyXG5cdH0pO1xyXG5cdGdldFBvcEthcnRlQWxsZS5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBFcyBrb25udGVuIGtlaW5lIFBvcHVsYXRpb25lbiBhdXMgZGVyIERhdGVuYmFuayBhYmdlcnVmZW4gd2VyZGVuXCIpO1xyXG5cdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogRXMga29ubnRlbiBrZWluZSBEYXRlbiBhdXMgZGVyIERhdGVuYmFuayBhYmdlcnVmZW4gd2VyZGVuJyk7XHJcblx0XHRwb3BfZ2V6ZWlndC5yZXNvbHZlKCk7XHJcblx0fSk7XHJcblx0cmV0dXJuIHBvcF9nZXplaWd0LnByb21pc2UoKTtcclxufTtcclxuXHJcbndpbmRvdy5hcGYub2xtYXAuZXJzdGVsbGVUUG9wdWxhdGlvbiA9IGZ1bmN0aW9uKFRQb3ApIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gc3R5bGVzIGbDvHIgb3ZlcmxheV90b3AgZGVmaW5pZXJlblxyXG5cdHZhciBkZWZhdWx0U3R5bGUgPSBuZXcgT3BlbkxheWVycy5TdHlsZSh7XHJcblx0XHRcdGV4dGVybmFsR3JhcGhpYzogJy8vd3d3LmFwZmxvcmEuY2gvaW1nL2Zsb3JhX2ljb25fcm90LnBuZycsXHJcblx0XHRcdGdyYXBoaWNXaWR0aDogMzIsIGdyYXBoaWNIZWlnaHQ6IDM3LCBncmFwaGljWU9mZnNldDogLTM3LFxyXG5cdFx0XHR0aXRsZTogJyR7dG9vbHRpcH0nXHJcblx0XHR9KSxcclxuXHRcdHNlbGVjdFN0eWxlID0gbmV3IE9wZW5MYXllcnMuU3R5bGUoe1xyXG5cdFx0XHRleHRlcm5hbEdyYXBoaWM6ICcvL3d3dy5hcGZsb3JhLmNoL2ltZy9mbG9yYV9pY29uX2dlbGIucG5nJ1xyXG5cdFx0fSksXHJcblx0XHQvLyBvdmVybGF5IGxheWVyIGbDvHIgTWFya2VyIHZvcmJlcmVpdGVuXHJcblx0XHRvdmVybGF5X3Rwb3B1bGF0aW9uID0gbmV3IE9wZW5MYXllcnMuTGF5ZXIuVmVjdG9yKCdUZWlscG9wdWxhdGlvbicsIHtcclxuXHRcdFx0c3R5bGVNYXA6IG5ldyBPcGVuTGF5ZXJzLlN0eWxlTWFwKHtcclxuXHRcdFx0XHQnZGVmYXVsdCc6IGRlZmF1bHRTdHlsZSxcclxuXHRcdFx0XHQnc2VsZWN0JzogZGVmYXVsdFN0eWxlXHJcblx0XHRcdH0pXHJcblx0XHR9KSxcclxuXHRcdG15TG9jYXRpb24gPSBuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChUUG9wLlRQb3BYS29vcmQsIFRQb3AuVFBvcFlLb29yZCksXHJcblx0XHRteVRQb3BGbHVybmFtZSA9IFRQb3AuVFBvcEZsdXJuYW1lIHx8ICcoa2VpbiBGbHVybmFtZSknLFxyXG5cdFx0Ly8gdG9vbHRpcCBiencuIGxhYmVsIHZvcmJlcmVpdGVuOiBudWxsd2VydGUgYXVzYmxlbmRlblxyXG5cdFx0bXlUb29sdGlwO1xyXG5cdGlmICh3aW5kb3cuYXBmLnBvcC5Qb3BOciAmJiBUUG9wLlRQb3BOcikge1xyXG5cdFx0bXlUb29sdGlwID0gd2luZG93LmFwZi5wb3AuUG9wTnIgKyAnLycgKyBUUG9wLlRQb3BOciArICcgJyArIG15VFBvcEZsdXJuYW1lO1xyXG5cdH0gZWxzZSBpZiAod2luZG93LmFwZi5wb3AuUG9wTnIpIHtcclxuXHRcdG15VG9vbHRpcCA9IHdpbmRvdy5hcGYucG9wLlBvcE5yICsgJy8/JyArICcgJyArIG15VFBvcEZsdXJuYW1lO1xyXG5cdH0gZWxzZSBpZiAoVFBvcC5UUG9wTnIpIHtcclxuXHRcdG15VG9vbHRpcCA9ICc/LycgKyBUUG9wLlRQb3BOciArICcgJyArIG15VFBvcEZsdXJuYW1lO1xyXG5cdH0gZWxzZSB7XHJcblx0XHRteVRvb2x0aXAgPSAnPy8/JyArICcgJyArIG15VFBvcEZsdXJuYW1lO1xyXG5cdH1cclxuXHJcblx0Ly8gbWFya2VyIGVyc3RlbGxlbi4uLlxyXG5cdC8vIGdld8OkaGx0ZSBlcmhhbHRlbiBzdHlsZSBnZWxiIHVuZCB6dW9iZXJzdFxyXG5cdHZhciBtYXJrZXIgPSBuZXcgT3BlbkxheWVycy5GZWF0dXJlLlZlY3RvcihteUxvY2F0aW9uLCB7XHJcblx0XHR0b29sdGlwOiBteVRvb2x0aXBcclxuXHR9KTtcclxuXHJcblx0Ly8gZGllIG1hcmtlciBkZXIgRWJlbmUgaGluenVmw7xnZW5cclxuXHRvdmVybGF5X3Rwb3B1bGF0aW9uLmFkZEZlYXR1cmVzKG1hcmtlcik7XHJcblxyXG5cdC8vIGRpZSBtYXJrZXIgc29sbGVuIHZlcnNjaG9iZW4gd2VyZGVuIGvDtm5uZW5cclxuXHR2YXIgZHJhZ0NvbnRyb2wgPSBuZXcgT3BlbkxheWVycy5Db250cm9sLkRyYWdGZWF0dXJlKG92ZXJsYXlfdHBvcHVsYXRpb24sIHtcclxuXHRcdG9uQ29tcGxldGU6IGZ1bmN0aW9uKGZlYXR1cmUpIHtcclxuXHRcdFx0Ly8geCB1bmQgeSBtZXJrZW5cclxuXHRcdFx0VFBvcC5UUG9wWEtvb3JkID0gZmVhdHVyZS5nZW9tZXRyeS54O1xyXG5cdFx0XHRUUG9wLlRQb3BZS29vcmQgPSBmZWF0dXJlLmdlb21ldHJ5Lnk7XHJcblx0XHRcdC8vIERhdGVuc2F0eiB1cGRhdGVuXHJcblx0XHRcdHdpbmRvdy5hcGYuc3BlaWNoZXJlV2VydCgndHBvcCcsIGxvY2FsU3RvcmFnZS50cG9wX2lkLCAnVFBvcFhLb29yZCcsIFRQb3AuVFBvcFhLb29yZCk7XHJcblx0XHRcdHdpbmRvdy5hcGYuc3BlaWNoZXJlV2VydCgndHBvcCcsIGxvY2FsU3RvcmFnZS50cG9wX2lkLCAnVFBvcFlLb29yZCcsIFRQb3AuVFBvcFlLb29yZCk7XHJcblx0XHR9XHJcblx0fSk7XHJcblx0d2luZG93LmFwZi5vbG1hcC5hZGRDb250cm9sKGRyYWdDb250cm9sKTtcclxuXHRkcmFnQ29udHJvbC5hY3RpdmF0ZSgpO1xyXG5cclxuXHQvLyBvdmVybGF5IHp1ciBLYXJ0ZSBoaW56dWbDvGdlblxyXG5cdHdpbmRvdy5hcGYub2xtYXAuYWRkTGF5ZXIob3ZlcmxheV90cG9wdWxhdGlvbik7XHJcblxyXG5cdC8vIGNvbnRyb2wgenVyIEthcnRlIGhpbnp1ZsO8Z2VuXHJcblx0d2luZG93LnNlbGVjdENvbnRyb2xUUG9wID0gbmV3IE9wZW5MYXllcnMuQ29udHJvbC5TZWxlY3RGZWF0dXJlKG92ZXJsYXlfdHBvcHVsYXRpb24sIHtjbGlja291dDogdHJ1ZX0pO1xyXG5cdHdpbmRvdy5hcGYub2xtYXAuYWRkQ29udHJvbCh3aW5kb3cuc2VsZWN0Q29udHJvbFRQb3ApO1xyXG5cdHdpbmRvdy5zZWxlY3RDb250cm9sVFBvcC5hY3RpdmF0ZSgpO1xyXG59O1xyXG5cclxuLy8gZGllc2VyIEZ1bmt0aW9uIGthbm4gbWFuIGVpbmVuIFdlcnQgenVtIHNwZWljaGVybiDDvGJlcmdlYmVuXHJcbndpbmRvdy5hcGYuc3BlaWNoZXJlV2VydCA9IGZ1bmN0aW9uKHRhYmVsbGUsIGlkLCBmZWxkLCB3ZXJ0KSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciB1cGRhdGVUYWJlbGxlID0gJC5hamF4KHtcclxuXHRcdHR5cGU6ICdwb3N0JyxcclxuXHRcdHVybDogJ3BocC8nICsgdGFiZWxsZSArICdfdXBkYXRlLnBocCcsXHJcblx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0ZGF0YToge1xyXG5cdFx0XHRcImlkXCI6IGlkLFxyXG5cdFx0XHRcIkZlbGRcIjogZmVsZCxcclxuXHRcdFx0XCJXZXJ0XCI6IHdlcnQsXHJcblx0XHRcdFwidXNlclwiOiBzZXNzaW9uU3RvcmFnZS5Vc2VyXHJcblx0XHR9XHJcblx0fSk7XHJcblx0dXBkYXRlVGFiZWxsZS5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBEaWUgbGV0enRlIMOEbmRlcnVuZyB3dXJkZSBuaWNodCBnZXNwZWljaGVydFwiKTtcclxuXHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IERpZSBsZXR6dGUgw4RuZGVydW5nIHd1cmRlIG5pY2h0IGdlc3BlaWNoZXJ0Jyk7XHJcblx0fSk7XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLm9sbWFwLmVyc3RlbGxlQ29udGVudEbDvHJUUG9wID0gZnVuY3Rpb24odHBvcCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG4gICAgdmFyIG15X2ZsdXJuYW1lID0gdHBvcC5UUG9wRmx1cm5hbWUgfHwgJyhrZWluIEZsdXJuYW1lKSc7XHJcbiAgICByZXR1cm4gJzx0YWJsZT4nK1xyXG4gICAgICAgICc8dHI+PHRkPjxwPlR5cDo8L3A+PC90ZD48dGQ+PHA+VGVpbHBvcHVsYXRpb248L3A+PC90ZD48L3RyPicrXHJcbiAgICAgICAgJzx0cj48dGQ+PHA+UG9wdWxhdGlvbjo8L3A+PC90ZD48dGQ+PHA+JyArIHRwb3AuUG9wTmFtZSArICc8L3A+PC90ZD48L3RyPicrXHJcbiAgICAgICAgJzx0cj48dGQ+PHA+VGVpbHBvcHVsYXRpb246PC9wPjwvdGQ+PHRkPjxwPicgKyBteV9mbHVybmFtZSArICc8L3A+PC90ZD48L3RyPicrXHJcbiAgICAgICAgJzx0cj48dGQ+PHA+S29vcmRpbmF0ZW46PC9wPjwvdGQ+PHRkPjxwPicgKyB0cG9wLlRQb3BYS29vcmQgKyAnIC8gJyArIHRwb3AuVFBvcFlLb29yZCArICc8L3A+PC90ZD48L3RyPicrXHJcbiAgICAgICAgJzwvdGFibGU+JytcclxuICAgICAgICBcIjxwPjxhIGhyZWY9XFxcIiNcXFwiIG9uY2xpY2s9XFxcIndpbmRvdy5hcGYuw7ZmZm5lVFBvcCgnXCIgKyB0cG9wLlRQb3BJZCArIFwiJylcXFwiPkZvcm11bGFyIGFuc3RlbGxlIEthcnRlIMO2ZmZuZW48XFwvYT48L3A+XCIrXHJcbiAgICAgICAgJzxwPjxhIGhyZWY9XCIjXCIgb25jbGljaz1cXFwid2luZG93LmFwZi7DtmZmbmVGb3JtdWxhckFsc1BvcHVwKFxcJ3Rwb3BcXCcsICcgKyB0cG9wLlRQb3BJZCArICcpXFxcIj5Gb3JtdWxhciBuZWJlbiBkZXIgS2FydGUgw7ZmZm5lbjxcXC9hPjwvcD4nK1xyXG4gICAgICAgIFwiPHA+PGEgaHJlZj1cXFwiI1xcXCIgb25jbGljaz1cXFwid2luZG93LmFwZi7DtmZmbmVUUG9wSW5OZXVlbVRhYignXCIgKyB0cG9wLlRQb3BJZCArIFwiJylcXFwiPkZvcm11bGFyIGluIG5ldWVtIEZlbnN0ZXIgw7ZmZm5lbjxcXC9hPjwvcD5cIjtcclxufTtcclxuXHJcbi8vIHJldG91cm5pZXJ0IGZlYXR1cmVzXHJcbi8vIMO8YmVyZ2lidCBtYW4gZWluZW4gVHlwLCB3ZXJkZW4gbnVyIGZlYXR1cmVzIGRpZXNlcyBUeXBzIHJldG91cm5pZXJ0XHJcbndpbmRvdy5hcGYub2xtYXAubGlzdFNlbGVjdGVkRmVhdHVyZXMgPSBmdW5jdGlvbih0eXApIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHR2YXIgc2VsZWN0ZWRfZmVhdHVyZXMgPSB3aW5kb3cuYXBmLm9sbWFwLm1hcC5vbG1hcF9zZWxlY3RfaW50ZXJhY3Rpb24uZ2V0RmVhdHVyZXMoKS5nZXRBcnJheSgpLFxyXG5cdFx0ZmVhdHVyZXNfdG9fcmV0dXJuO1xyXG5cdGZlYXR1cmVzX3RvX3JldHVybiA9IF8uZmlsdGVyKHNlbGVjdGVkX2ZlYXR1cmVzLCBmdW5jdGlvbihmZWF0dXJlKSB7XHJcblx0XHRpZiAodHlwKSB7XHJcblx0XHRcdHJldHVybiBmZWF0dXJlLmdldCgnbXlUeXAnKSA9PT0gdHlwO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0cmV0dXJuIGZlYXR1cmUuZ2V0KCdteVR5cCcpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cdHJldHVybiBmZWF0dXJlc190b19yZXR1cm47XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLm9sbWFwLmVyc3RlbGxlTGlzdGVEZXJBdXNnZXfDpGhsdGVuUG9wVFBvcCA9IGZ1bmN0aW9uKHBvcF9zZWxlY3RlZCwgdHBvcF9zZWxlY3RlZCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyByw7xja21lbGRlbiwgd2VsY2hlIE9iamVrdGUgZ2V3w6RobHQgd3VyZGVuXHJcblx0dmFyIHLDvGNrbWVsZHVuZyA9IFwiXCIsXHJcblx0XHRwb3BfaWQsXHJcbiAgICAgICAgdHBvcF9pZDtcclxuXHJcbiAgICAvLyBnbG9iYWxlIFZhcmlhYmVsbiBhbmxlZ2VuLCBkYW1pdCBkaWUgRXhwb3J0ZnVua3Rpb25lbiBzaWUgc3DDpHRlciBudXR6ZW4ga8O2bm5lblxyXG4gICAgd2luZG93LmFwZi5vbG1hcC5wb3Bfc2VsZWN0ZWQgPSBwb3Bfc2VsZWN0ZWQ7XHJcbiAgICB3aW5kb3cuYXBmLm9sbWFwLnRwb3Bfc2VsZWN0ZWQgPSB0cG9wX3NlbGVjdGVkO1xyXG5cclxuXHRpZiAocG9wX3NlbGVjdGVkLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAvLyBwb3AgbmFjaCBuciBzb3J0aWVyZW5cclxuICAgICAgICBwb3Bfc2VsZWN0ZWQgPSBfLnNvcnRCeShwb3Bfc2VsZWN0ZWQsIGZ1bmN0aW9uKHBvcCkge1xyXG4gICAgICAgICAgICB2YXIgcG9wX25yID0gcG9wLmdldCgncG9wX25yJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBwYXJzZUludChwb3BfbnIpO1xyXG4gICAgICAgIH0pO1xyXG5cdFx0aWYgKHRwb3Bfc2VsZWN0ZWQubGVuZ3RoID4gMCkge1xyXG5cdFx0XHQvLyB0cG9wIHVuZCBwb3AgYmV0aXR0ZWxuXHJcblx0XHRcdHLDvGNrbWVsZHVuZyArPSBcIjxwIGNsYXNzPSdlcmdlYm5pc0F1c3dhaGxMaXN0ZVRpdGVsJz5cIiArIHBvcF9zZWxlY3RlZC5sZW5ndGggKyBcIiBQb3B1bGF0aW9uZW46IDwvcD5cIjtcclxuXHRcdH1cclxuXHRcdHLDvGNrbWVsZHVuZyArPSBcIjx0YWJsZT5cIjtcclxuICAgICAgICBfLmVhY2gocG9wX3NlbGVjdGVkLCBmdW5jdGlvbihwb3ApIHtcclxuICAgICAgICBcdHBvcF9pZCA9IHBvcC5nZXQoJ215SWQnKTtcclxuICAgICAgICAgICAgcsO8Y2ttZWxkdW5nICs9IFwiPHRyPjx0ZD48YSBocmVmPVxcXCIjXFxcIiBvbmNsaWNrPVxcXCJ3aW5kb3cuYXBmLsO2ZmZuZVBvcCgnXCIgKyBwb3BfaWQgKyBcIicpXFxcIj5cIjtcclxuICAgICAgICAgICAgcsO8Y2ttZWxkdW5nICs9IHBvcC5nZXQoJ3BvcF9ucicpICsgXCI6PFxcL2E+PC90ZD48dGQ+PGEgaHJlZj1cXFwiI1xcXCIgb25jbGljaz1cXFwid2luZG93LmFwZi7DtmZmbmVQb3AoJ1wiICsgcG9wX2lkICsgXCInKVxcXCI+XCIgKyBwb3AuZ2V0KCdwb3BfbmFtZScpICsgXCI8XFwvYT48L3RkPjwvdHI+XCI7XHJcbiAgICAgICAgfSk7XHJcblx0XHRyw7xja21lbGR1bmcgKz0gXCI8L3RhYmxlPlwiO1xyXG5cdH1cclxuXHRpZiAodHBvcF9zZWxlY3RlZC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgLy8gdHBvcCBuYWNoIG5yIGRhbm4gdHBvcG5yIHNvcnRpZXJlblxyXG4gICAgICAgIHRwb3Bfc2VsZWN0ZWQgPSBfLnNvcnRCeSh0cG9wX3NlbGVjdGVkLCBmdW5jdGlvbih0cG9wKSB7XHJcbiAgICAgICAgICAgIHZhciBwb3BfbnIgPSB0cG9wLmdldCgncG9wX25yJykgfHwgMCxcclxuICAgICAgICAgICAgICAgIHRwb3BfbnIgPSB0cG9wLmdldCgndHBvcF9ucicpIHx8IDAsXHJcbiAgICAgICAgICAgICAgICBwb3BfdHBvcF9uciA9IHBhcnNlRmxvYXQocGFyc2VJbnQocG9wX25yKSArICcuJyArIHBhcnNlSW50KHRwb3BfbnIpKTtcclxuICAgICAgICAgICAgcmV0dXJuIHBvcF90cG9wX25yO1xyXG4gICAgICAgIH0pO1xyXG5cdFx0aWYgKHBvcF9zZWxlY3RlZC5sZW5ndGggPiAwKSB7XHJcblx0XHRcdC8vIHRwb3AgdW5kIHBvcCBiZXRpdHRlbG5cclxuXHRcdFx0csO8Y2ttZWxkdW5nICs9IFwiPHAgY2xhc3M9J2VyZ2VibmlzQXVzd2FobExpc3RlVGl0ZWwgZXJnZWJuaXNBdXN3YWhsTGlzdGVUaXRlbFRQb3AnPlwiICsgdHBvcF9zZWxlY3RlZC5sZW5ndGggKyBcIiBUZWlscG9wdWxhdGlvbmVuOiA8L3A+XCI7XHJcblx0XHR9XHJcblx0XHRyw7xja21lbGR1bmcgKz0gXCI8dGFibGU+XCI7XHJcbiAgICAgICAgXy5lYWNoKHRwb3Bfc2VsZWN0ZWQsIGZ1bmN0aW9uKHRwb3ApIHtcclxuICAgICAgICAgICAgdHBvcF9pZCA9IHRwb3AuZ2V0KCdteUlkJyk7XHJcbiAgICAgICAgICAgIHLDvGNrbWVsZHVuZyArPSBcIjx0cj48dGQ+PGEgaHJlZj1cXFwiI1xcXCIgb25jbGljaz1cXFwid2luZG93LmFwZi7DtmZmbmVUUG9wSW5OZXVlbVRhYignXCIgKyB0cG9wX2lkICsgXCInKVxcXCI+XCI7XHJcbiAgICAgICAgICAgIHLDvGNrbWVsZHVuZyArPSB0cG9wLmdldCgndHBvcF9ucl9sYWJlbCcpICsgXCI6PFxcL2E+PC90ZD48dGQ+PGEgaHJlZj1cXFwiI1xcXCIgb25jbGljaz1cXFwid2luZG93LmFwZi7DtmZmbmVUUG9wSW5OZXVlbVRhYignXCIgKyB0cG9wX2lkICsgXCInKVxcXCI+XCI7XHJcbiAgICAgICAgICAgIHLDvGNrbWVsZHVuZyArPSB0cG9wLmdldCgndHBvcF9uYW1lJykgKyBcIjxcXC9hPjwvdGQ+PC90cj5cIjtcclxuICAgICAgICB9KTtcclxuXHRcdHLDvGNrbWVsZHVuZyArPSBcIjwvdGFibGU+XCI7XHJcblx0fVxyXG5cdC8vIEjDtmhlIGRlciBNZWxkdW5nIGJlZ3Jlbnplbi4gTGVpZGVyIGZ1bmt0aW9uaWVydCBtYXhIZWlnaHQgbmljaHRcclxuXHR2YXIgaGVpZ2h0ID0gXCJhdXRvXCI7XHJcblx0aWYgKHRwb3Bfc2VsZWN0ZWQubGVuZ3RoID4gMjUpIHtcclxuXHRcdGhlaWdodCA9IDY1MDtcclxuXHR9XHJcblxyXG5cdC8vIExpc3RlbnRpdGVsIGVyc3RlbGxlblxyXG5cdHZhciBsaXN0ZW50aXRlbCxcclxuXHRcdGV4cG9ydGllcmVuID0gXCJFeHBvcnRpZXJlbjogXCIsXHJcblx0XHRleHBvcnRpZXJlblBvcCA9IFwiPGEgaHJlZj0nIycgY2xhc3M9J2V4cG9ydF9wb3AnPlBvcHVsYXRpb25lbjwvYT5cIixcclxuXHRcdGV4cG9ydGllcmVuVFBvcCA9IFwiPGEgaHJlZj0nIycgY2xhc3M9J2V4cG9ydF90cG9wJz5UZWlscG9wdWxhdGlvbmVuPC9hPiwgPGEgaHJlZj0nIycgY2xhc3M9J2V4cG9ydF9rb250cic+S29udHJvbGxlbjwvYT4sIDxhIGhyZWY9JyMnIGNsYXNzPSdleHBvcnRfbWFzc24nPk1hc3NuYWhtZW48L2E+XCI7XHJcblx0aWYgKHBvcF9zZWxlY3RlZC5sZW5ndGggPiAwICYmIHRwb3Bfc2VsZWN0ZWQubGVuZ3RoID4gMCkge1xyXG5cdFx0bGlzdGVudGl0ZWwgPSBcIkdld8OkaGx0IHd1cmRlbiBcIiArIHBvcF9zZWxlY3RlZC5sZW5ndGggKyBcIiBQb3B1bGF0aW9uZW4gdW5kIFwiICsgdHBvcF9zZWxlY3RlZC5sZW5ndGggKyBcIiBUZWlscG9wdWxhdGlvbmVuXCI7XHJcblx0XHRleHBvcnRpZXJlbiArPSBleHBvcnRpZXJlblBvcCArIFwiLCBcIiArIGV4cG9ydGllcmVuVFBvcDtcclxuXHR9IGVsc2UgaWYgKHBvcF9zZWxlY3RlZC5sZW5ndGggPiAwKSB7XHJcblx0XHRsaXN0ZW50aXRlbCA9IFwiR2V3w6RobHQgd3VyZGVuIFwiICsgcG9wX3NlbGVjdGVkLmxlbmd0aCArIFwiIFBvcHVsYXRpb25lbjpcIjtcclxuXHRcdGV4cG9ydGllcmVuICs9IGV4cG9ydGllcmVuUG9wO1xyXG5cdH0gZWxzZSBpZiAodHBvcF9zZWxlY3RlZC5sZW5ndGggPiAwKSB7XHJcblx0XHRsaXN0ZW50aXRlbCA9IFwiR2V3w6RobHQgd3VyZGVuIFwiICsgdHBvcF9zZWxlY3RlZC5sZW5ndGggKyBcIiBUZWlscG9wdWxhdGlvbmVuOlwiO1xyXG5cdFx0ZXhwb3J0aWVyZW4gKz0gZXhwb3J0aWVyZW5UUG9wO1xyXG5cdH0gZWxzZSB7XHJcblx0XHRsaXN0ZW50aXRlbCA9IFwiS2VpbmUgUG9wdWxhdGlvbmVuL1RlaWxwb3B1bGF0aW9uZW4gZ2V3w6RobHRcIjtcclxuXHRcdGV4cG9ydGllcmVuID0gXCJcIjtcclxuXHR9XHJcblx0JChcIiNlcmdlYm5pc0F1c3dhaGxIZWFkZXJUZXh0XCIpLmh0bWwobGlzdGVudGl0ZWwpO1xyXG5cdCQoXCIjZXJnZWJuaXNBdXN3YWhsTGlzdGVcIikuaHRtbChyw7xja21lbGR1bmcpO1xyXG5cdCQoXCIjZXJnZWJuaXNBdXN3YWhsRm9vdGVyXCIpLmh0bWwoZXhwb3J0aWVyZW4pO1xyXG5cdC8vIEVyZ2VibmlzLURpdiBlaW5ibGVuZGVuXHJcblx0JChcIiNlcmdlYm5pc0F1c3dhaGxcIikuY3NzKFwiZGlzcGxheVwiLCBcImJsb2NrXCIpO1xyXG59O1xyXG5cclxuLy8gc3VjaHQgZmVhdHVyZXMgYW4gZWluZW0gT3J0IGluIGRlciBLYXJ0ZVxyXG53aW5kb3cuYXBmLm9sbWFwLnN1Y2hlRmVhdHVyZXMgPSBmdW5jdGlvbihwaXhlbCkge1xyXG5cdHZhciBmZWF0dXJlcyA9IFtdO1xyXG5cdHdpbmRvdy5hcGYub2xtYXAubWFwLmZvckVhY2hGZWF0dXJlQXRQaXhlbChwaXhlbCwgZnVuY3Rpb24oZmVhdHVyZSwgbGF5ZXIpIHtcclxuXHRcdGZlYXR1cmVzLnB1c2goZmVhdHVyZSk7XHJcblx0fSk7XHJcblx0cmV0dXJuIGZlYXR1cmVzO1xyXG59O1xyXG5cclxud2luZG93LmFwZi5vbG1hcC5lbnRmZXJuZVBvcHVwT3ZlcmxheXMgPSBmdW5jdGlvbigpIHtcclxuXHR2YXIgb3ZlcmxheXMgPSB3aW5kb3cuYXBmLm9sbWFwLm1hcC5nZXRPdmVybGF5cygpLmdldEFycmF5KCksXHJcblx0XHR6dV9sw7ZzY2hlbmRlcl9vdmVybGF5ID0gW107XHJcblx0Xy5lYWNoKG92ZXJsYXlzLCBmdW5jdGlvbihvdmVybGF5KSB7XHJcblx0XHRpZiAob3ZlcmxheS5nZXQoJ3R5cCcpID09PSAncG9wdXAnKSB7XHJcblx0XHRcdHp1X2zDtnNjaGVuZGVyX292ZXJsYXkucHVzaChvdmVybGF5KTtcclxuXHRcdH1cclxuXHR9KTtcclxuXHRfLmVhY2goenVfbMO2c2NoZW5kZXJfb3ZlcmxheSwgZnVuY3Rpb24ob3ZlcmxheSkge1xyXG5cdFx0d2luZG93LmFwZi5vbG1hcC5tYXAucmVtb3ZlT3ZlcmxheShvdmVybGF5KTtcclxuXHR9KTtcclxuXHQvLyBhbGxlIHF0aXBzIGVudGZlcm5lblxyXG5cdCQoJy5xdGlwJykuZWFjaChmdW5jdGlvbigpIHtcclxuXHRcdCQodGhpcykucXRpcCgnZGVzdHJveScsIHRydWUpO1xyXG5cdH0pO1xyXG59O1xyXG5cclxud2luZG93LmFwZi5vbG1hcC56ZWlnZUZlYXR1cmVJbmZvID0gZnVuY3Rpb24ocGl4ZWwsIGNvb3JkaW5hdGUpIHtcclxuXHR2YXIgZmVhdHVyZXMgPSB3aW5kb3cuYXBmLm9sbWFwLnN1Y2hlRmVhdHVyZXMocGl4ZWwpLFxyXG5cdFx0b3ZlcmxheSxcclxuXHRcdHBvcHVwX2lkLFxyXG5cdFx0cG9wdXBfaWRfYXJyYXkgPSBbXSxcclxuXHRcdGtvb3JkaW5hdGVuLFxyXG5cdFx0cG9wdXBfdGl0bGUsXHJcblx0XHRwb3B1cF90ZXh0ID0gJycsXHJcblx0XHRmZWF0dXJlc19taXRfdHlwO1xyXG5cdC8vIGVzIHNjaGVpbnQgYXVjaCB3ZWl0ZXJlIEZlYXR1cmVzIHp1IGdlYmVuICh6LkIuIHdlbm4gbWFuIGdlbmF1IGF1ZiBkaWUgS29vcmRpbmF0ZSBlaW5lciBQb3Aga2xpY2t0KVxyXG5cdC8vIG51ciBkaWUgZ2V3b2xsdGVuIGJlaGFsdGVuXHJcblx0ZmVhdHVyZXNfbWl0X3R5cCA9IF8uZmlsdGVyKGZlYXR1cmVzLCBmdW5jdGlvbihmZWF0dXJlKSB7XHJcblx0XHRyZXR1cm4gZmVhdHVyZS5nZXQoJ215VHlwJykgfHwgIGZlYXR1cmUuZ2V0KCdwb3B1cF90aXRsZScpO1xyXG5cdH0pO1xyXG5cdGlmIChmZWF0dXJlc19taXRfdHlwICYmIGZlYXR1cmVzX21pdF90eXAubGVuZ3RoID4gMCkge1xyXG5cdFx0Ly8gd2VubiBtZWhyZXJlIGZlYXR1cmVzX21pdF90eXAgdm9ya29tbWVuOiBkaWUgSW5mb3MgYWxsZXIgc2FtbWVsbiB1bmQgYW56ZWlnZW5cclxuXHRcdGlmIChmZWF0dXJlc19taXRfdHlwLmxlbmd0aCA+IDEpIHtcclxuXHRcdFx0Xy5lYWNoKGZlYXR1cmVzX21pdF90eXAsIGZ1bmN0aW9uKGZlYXR1cmUsIGluZGV4KSB7XHJcblx0XHRcdFx0aWYgKGZlYXR1cmUuZ2V0KCdteVR5cCcpID09PSAnRGV0YWlscGxhbicpIHtcclxuXHRcdFx0XHRcdHBvcHVwX3RleHQgKz0gJzxoMz5PYmpla3QgSUQ6ICcgKyBmZWF0dXJlLmdldCgnT0JKRUNUSUQnKSArICc8L2gzPic7XHJcblx0XHRcdFx0ICAgIHBvcHVwX3RleHQgKz0gJzx0YWJsZT48dHI+PHRkPjxwPlR5cDo8L3A+PC90ZD48dGQ+PHA+RGV0YWlscGxhbjwvcD48L3RkPjwvdHI+JytcclxuXHRcdCAgICBcdFx0XHQnPHRyPjx0ZD48cD5GbMOkY2hlOjwvcD48L3RkPjx0ZD48cD4nICsgcGFyc2VJbnQoZmVhdHVyZS5nZXQoJ1NIQVBFX0FyZWEnKSAvIDEwKSArICc8L3A+PC90ZD48L3RyPicrXHJcblx0XHQgICAgXHRcdFx0Jzx0cj48dGQ+PHA+QmVtZXJrdW5nZTo8L3A+PC90ZD48dGQ+PHA+JyArIChmZWF0dXJlLmdldCgnQmVtZXJrdW5nZScpIHx8IFwiXCIpICsgJzwvcD48L3RkPjwvdHI+JytcclxuXHRcdCAgICBcdFx0XHQnPHRyPjx0ZD48cD5CZW1lcmt1bl8xOjwvcD48L3RkPjx0ZD48cD4nICsgKGZlYXR1cmUuZ2V0KCdCZW1lcmt1bl8xJykgfHwgXCJcIikgKyAnPC9wPjwvdGQ+PC90cj48L3RhYmxlPic7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHBvcHVwX3RleHQgKz0gJzxoMz4nICsgZmVhdHVyZS5nZXQoJ3BvcHVwX3RpdGxlJykgKyAnPC9oMz4nO1xyXG5cdFx0XHRcdFx0cG9wdXBfdGV4dCArPSBmZWF0dXJlLmdldCgncG9wdXBfY29udGVudCcpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAoaW5kZXggKyAxIDwgZmVhdHVyZXNfbWl0X3R5cC5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdHBvcHVwX3RleHQgKz0gJzxocj4nO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHRcdHBvcHVwX3RpdGxlID0gZmVhdHVyZXNfbWl0X3R5cC5sZW5ndGggKyAnIFRyZWZmZXInO1xyXG5cdFx0XHQvLyBhbHMgS29vcmRpbmF0ZW4gZGVuIE9ydCBkZXMgS2xpY2tzIG5laG1lblxyXG5cdFx0XHRrb29yZGluYXRlbiA9IGNvb3JkaW5hdGU7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHQvLyBlcyBnaWJ0IG51ciBlaW5lbiBmZWF0dXJlXHJcblx0XHRcdGlmIChmZWF0dXJlc19taXRfdHlwWzBdLmdldCgnbXlUeXAnKSA9PT0gJ0RldGFpbHBsYW4nKSB7XHJcblx0XHRcdCAgICBwb3B1cF90ZXh0ID0gJzx0YWJsZT48dHI+PHRkPjxwPlR5cDo8L3A+PC90ZD48dGQ+PHA+RGV0YWlscGxhbjwvcD48L3RkPjwvdHI+JytcclxuXHQgICAgXHRcdFx0Jzx0cj48dGQ+PHA+RmzDpGNoZTo8L3A+PC90ZD48dGQ+PHA+JyArIHBhcnNlSW50KGZlYXR1cmVzX21pdF90eXBbMF0uZ2V0KCdTSEFQRV9BcmVhJykgLyAxMCkgKyAnPC9wPjwvdGQ+PC90cj4nK1xyXG5cdCAgICBcdFx0XHQnPHRyPjx0ZD48cD5CZW1lcmt1bmdlOjwvcD48L3RkPjx0ZD48cD4nICsgKGZlYXR1cmVzX21pdF90eXBbMF0uZ2V0KCdCZW1lcmt1bmdlJykgfHwgXCJcIikgKyAnPC9wPjwvdGQ+PC90cj4nK1xyXG5cdCAgICBcdFx0XHQnPHRyPjx0ZD48cD5CZW1lcmt1bl8xOjwvcD48L3RkPjx0ZD48cD4nICsgKGZlYXR1cmVzX21pdF90eXBbMF0uZ2V0KCdCZW1lcmt1bl8xJykgfHwgXCJcIikgKyAnPC9wPjwvdGQ+PC90cj48L3RhYmxlPic7XHJcblx0XHRcdFx0cG9wdXBfdGl0bGUgPSAnT2JqZWt0IElEOiAnICsgZmVhdHVyZXNfbWl0X3R5cFswXS5nZXQoJ09CSkVDVElEJyk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0cG9wdXBfdGV4dCA9IGZlYXR1cmVzX21pdF90eXBbMF0uZ2V0KCdwb3B1cF9jb250ZW50Jyk7XHJcblx0XHRcdFx0cG9wdXBfdGl0bGUgPSBmZWF0dXJlc19taXRfdHlwWzBdLmdldCgncG9wdXBfdGl0bGUnKTtcclxuXHRcdFx0fVxyXG5cdFx0XHQvLyBhbHMgS29vcmRpbmF0ZW4gZGllIEtvb3JkaW5hdGUgZGVzIHBvcHVwcyBuZWhtZW5cclxuXHRcdFx0aWYgKGZlYXR1cmVzX21pdF90eXBbMF0uZ2V0KCd4a29vcmQnKSAmJiBmZWF0dXJlc19taXRfdHlwWzBdLmdldCgneWtvb3JkJykpIHtcclxuXHRcdFx0XHRrb29yZGluYXRlbiA9IFtmZWF0dXJlc19taXRfdHlwWzBdLmdldCgneGtvb3JkJyksIGZlYXR1cmVzX21pdF90eXBbMF0uZ2V0KCd5a29vcmQnKV07XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0a29vcmRpbmF0ZW4gPSBjb29yZGluYXRlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8genVlcnN0IG1pdCBndGlwIGVpbmVuIHBvcHVwIGVyemV1Z2VuXHJcblx0XHQkKCcub2xtYXBfcG9wdXAnKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHQkKHRoaXMpLnF0aXAoe1xyXG5cdFx0XHRcdGNvbnRlbnQ6IHtcclxuXHRcdCAgICAgICAgICAgIHRleHQ6IHBvcHVwX3RleHQsXHJcblx0XHQgICAgICAgICAgICB0aXRsZTogcG9wdXBfdGl0bGUsXHJcblx0XHQgICAgICAgICAgICBidXR0b246ICdDbG9zZSdcclxuXHRcdCAgICAgICAgfSxcclxuXHRcdCAgICAgICAgc3R5bGU6IHtcclxuXHRcdCAgICAgICAgICAgIC8vIFVzZSB0aGUgalF1ZXJ5IFVJIHdpZGdldCBjbGFzc2VzXHJcblx0XHQgICAgICAgICAgICB3aWRnZXQ6IHRydWUsXHJcblx0XHQgICAgICAgICAgICAvLyBSZW1vdmUgdGhlIGRlZmF1bHQgc3R5bGluZ1xyXG5cdFx0ICAgICAgICAgICAgZGVmOiBmYWxzZSxcclxuXHRcdCAgICAgICAgICAgIGNsYXNzZXM6ICdvbG1hcF9wb3B1cF9zdHlsaW5nJyxcclxuXHRcdFx0ICAgICAgICB0aXA6IHtcclxuXHRcdFx0ICAgICAgICBcdHdpZHRoOiAyMCxcclxuXHRcdFx0ICAgICAgICBcdGhlaWdodDogMjBcclxuXHRcdFx0ICAgICAgICB9XHJcblx0XHQgICAgICAgIH0sXHJcblx0XHQgICAgICAgIHBvc2l0aW9uOiB7XHJcblx0XHQgICAgICAgICAgICBteTogJ3RvcCBsZWZ0JyxcclxuXHRcdCAgICAgICAgICAgIGF0OiAnYm90dG9tIHJpZ2h0JyxcclxuXHRcdCAgICAgICAgICAgIHRhcmdldDogJCh0aGlzKSxcclxuXHRcdCAgICAgICAgICAgIHZpZXdwb3J0OiAkKCcjR2VvQWRtaW5LYXJ0ZScpXHJcblx0XHQgICAgICAgIH1cclxuXHQgICAgICAgIH0pO1xyXG5cdCAgICAgICAgJCh0aGlzKS5xdGlwKCd0b2dnbGUnLCB0cnVlKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIGlkIGRlcyBwb3B1cHMgZXJtaXR0ZWxuXHJcblx0XHQkKCcucXRpcCcpLmVhY2goZnVuY3Rpb24oKSB7XHJcblx0XHRcdHBvcHVwX2lkX2FycmF5LnB1c2goJCh0aGlzKS5hdHRyKCdkYXRhLXF0aXAtaWQnKSk7XHJcblx0XHR9KTtcclxuXHRcdHBvcHVwX2lkID0gXy5tYXgocG9wdXBfaWRfYXJyYXkpO1xyXG5cclxuXHRcdC8vIGRpZSBtaXQgcXRpcCBlcnpldWd0ZSBkaXYgZGVtIG92ZXJsYXkgw7xiZXJnZWJlblxyXG5cdFx0b3ZlcmxheSA9IG5ldyBvbC5PdmVybGF5KHtcclxuXHRcdFx0ZWxlbWVudDogJCgnI3F0aXAtJyArIHBvcHVwX2lkKVxyXG5cdFx0fSk7XHJcblx0XHR3aW5kb3cuYXBmLm9sbWFwLm1hcC5hZGRPdmVybGF5KG92ZXJsYXkpO1xyXG5cdFx0b3ZlcmxheS5zZXRQb3NpdGlvbihrb29yZGluYXRlbik7XHJcblx0XHRvdmVybGF5LnNldCgndHlwJywgJ3BvcHVwJyk7XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vIGFsbGUgcG9wdXBzIGVudGZlcm5lblxyXG5cdFx0d2luZG93LmFwZi5vbG1hcC5lbnRmZXJuZVBvcHVwT3ZlcmxheXMoKTtcclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLm9sbWFwLmVyc3RlbGxlQ29udGVudEbDvHJQb3AgPSBmdW5jdGlvbihwb3ApIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIHJldHVybiAnPHRhYmxlPicrXHJcbiAgICAgICAgJzx0cj48dGQ+PHA+VHlwOjwvcD48L3RkPjx0ZD48cD5Qb3B1bGF0aW9uPC9wPjwvdGQ+PC90cj4nK1xyXG4gICAgICAgICc8dHI+PHRkPjxwPktvb3JkaW5hdGVuOjwvcD48L3RkPjx0ZD48cD4nICsgcG9wLlBvcFhLb29yZCArICcgLyAnICsgcG9wLlBvcFlLb29yZCArICc8L3A+PC90ZD48L3RyPicrXHJcbiAgICAgICAgJzwvdGFibGU+JytcclxuICAgICAgICBcIjxwPjxhIGhyZWY9XFxcIiNcXFwiIG9uY2xpY2s9XFxcIndpbmRvdy5hcGYuw7ZmZm5lUG9wKCdcIiArIHBvcC5Qb3BJZCArIFwiJylcXFwiPkZvcm11bGFyIGFuc3RlbGxlIEthcnRlIMO2ZmZuZW48XFwvYT48L3A+XCIrXHJcbiAgICAgICAgJzxwPjxhIGhyZWY9XCIjXCIgb25jbGljaz1cXFwid2luZG93LmFwZi7DtmZmbmVGb3JtdWxhckFsc1BvcHVwKFxcJ3BvcFxcJywgJyArIHBvcC5Qb3BJZCArICcpXFxcIj5Gb3JtdWxhciBuZWJlbiBkZXIgS2FydGUgw7ZmZm5lbjxcXC9hPjwvcD4nK1xyXG4gICAgICAgIFwiPHA+PGEgaHJlZj1cXFwiI1xcXCIgb25jbGljaz1cXFwid2luZG93LmFwZi7DtmZmbmVQb3BJbk5ldWVtVGFiKCdcIiArIHBvcC5Qb3BJZCArIFwiJylcXFwiPkZvcm11bGFyIGluIG5ldWVtIEZlbnN0ZXIgw7ZmZm5lbjxcXC9hPjwvcD5cIjtcclxufTtcclxuXHJcbi8vIMO8YmVybmltbXQgZHJlaSBWYXJpYWJsZW46IHBvcGxpc3RlIGlzdCBkYXMgT2JqZWt0IG1pdCBkZW4gUG9wdWxhdGlvbmVuXHJcbi8vIHBvcGlkX21hcmtpZXJ0IGRlciBBcnJheSBtaXQgZGVuIGF1c2dld8OkaGx0ZW4gUG9wXHJcbi8vIHZpc2libGU6IE9iIGRpZSBFYmVuZSBzaWNodGJhciBnZXNjaGFsdGV0IHdpcmQgKG9kZXIgYmxvc3MgaW0gTGF5ZXJ0cmVlIHZlcmbDvGdiYXIgaXN0KVxyXG53aW5kb3cuYXBmLm9sbWFwLmVyc3RlbGxlUG9wTGF5ZXIgPSBmdW5jdGlvbihwb3BsaXN0ZSwgcG9waWRfbWFya2llcnQsIHZpc2libGUpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIHZhciBwb3BfbGF5ZXJfZXJzdGVsbHQgPSAkLkRlZmVycmVkKCksXHJcbiAgICAgICAgbWFya2VycyA9IFtdLFxyXG4gICAgICAgIG1hcmtlcixcclxuICAgICAgICBteV9sYWJlbCxcclxuICAgICAgICBteV9uYW1lLFxyXG4gICAgICAgIHBvcHVwX2NvbnRlbnQsXHJcbiAgICAgICAgcG9wX21pdF9ucl9sYXllcixcclxuICAgICAgICBzZWxlY3RlZF9mZWF0dXJlcztcclxuXHJcbiAgICBpZiAod2luZG93LmFwZi5vbG1hcC5tYXAgJiYgd2luZG93LmFwZi5vbG1hcC5tYXAub2xtYXBfc2VsZWN0X2ludGVyYWN0aW9uICYmIHBvcGlkX21hcmtpZXJ0KSB7XHJcbiAgICBcdHNlbGVjdGVkX2ZlYXR1cmVzID0gd2luZG93LmFwZi5vbG1hcC5tYXAub2xtYXBfc2VsZWN0X2ludGVyYWN0aW9uLmdldEZlYXR1cmVzKCkuZ2V0QXJyYXkoKTtcclxuICAgIH0gZWxzZSBpZiAocG9waWRfbWFya2llcnQpIHtcclxuICAgIFx0d2luZG93LmFwZi5vbG1hcC5hZGRTZWxlY3RGZWF0dXJlc0luU2VsZWN0YWJsZUxheWVycygpO1xyXG4gICAgXHRzZWxlY3RlZF9mZWF0dXJlcyA9IHdpbmRvdy5hcGYub2xtYXAubWFwLm9sbWFwX3NlbGVjdF9pbnRlcmFjdGlvbi5nZXRGZWF0dXJlcygpLmdldEFycmF5KCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHZpc2libGUgPT09IG51bGwpIHtcclxuICAgICAgICB2aXNpYmxlID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBfLmVhY2gocG9wbGlzdGUucm93cywgZnVuY3Rpb24ocG9wKSB7XHJcbiAgICAgICAgbXlfbmFtZSA9IHBvcC5Qb3BOYW1lIHx8ICcoa2VpbiBOYW1lKSc7XHJcbiAgICAgICAgcG9wdXBfY29udGVudCA9IHdpbmRvdy5hcGYub2xtYXAuZXJzdGVsbGVDb250ZW50RsO8clBvcChwb3ApO1xyXG5cclxuICAgICAgICAvLyB0b29sdGlwIGJ6dy4gbGFiZWwgdm9yYmVyZWl0ZW46IG51bGx3ZXJ0ZSBhdXNibGVuZGVuXHJcbiAgICAgICAgaWYgKHBvcC5Qb3BOcikge1xyXG4gICAgICAgICAgICBteV9sYWJlbCA9IHBvcC5Qb3BOci50b1N0cmluZygpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIG15X2xhYmVsID0gJz8nO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gbWFya2VyIGVyc3RlbGxlbi4uLlxyXG4gICAgICAgIG1hcmtlciA9IG5ldyBvbC5GZWF0dXJlKHtcclxuICAgICAgICAgICAgZ2VvbWV0cnk6IG5ldyBvbC5nZW9tLlBvaW50KFtwb3AuUG9wWEtvb3JkLCBwb3AuUG9wWUtvb3JkXSksXHJcbiAgICAgICAgICAgIHBvcF9ucjogbXlfbGFiZWwsXHJcbiAgICAgICAgICAgIHBvcF9uYW1lOiBteV9uYW1lLFxyXG4gICAgICAgICAgICBuYW1lOiBteV9sYWJlbCwgLy8gbm9jaCBiZW7DtnRpZ3Q/IFRPRE86IGVudGZlcm5lblxyXG4gICAgICAgICAgICBwb3B1cF9jb250ZW50OiBwb3B1cF9jb250ZW50LFxyXG4gICAgICAgICAgICBwb3B1cF90aXRsZTogbXlfbmFtZSxcclxuICAgICAgICAgICAgLy8gS29vcmRpbmF0ZW4gd2VyZGVuIGdlYnJhdWNodCwgZGFtaXQgZGFzIHBvcHVwIHJpY2h0aWcgcGxhdHppZXJ0IHdlcmRlbiBrYW5uXHJcbiAgICAgICAgICAgIHhrb29yZDogcG9wLlBvcFhLb29yZCxcclxuICAgICAgICAgICAgeWtvb3JkOiBwb3AuUG9wWUtvb3JkLFxyXG4gICAgICAgICAgICBteVR5cDogJ3BvcCcsXHJcbiAgICAgICAgICAgIG15SWQ6IHBvcC5Qb3BJZFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBtYXJrZXIgaW4gQXJyYXkgc3BlaWNoZXJuXHJcbiAgICAgICAgbWFya2Vycy5wdXNoKG1hcmtlcik7XHJcblxyXG4gICAgICAgIC8vIG1hcmtpZXJ0ZSBpbiB3aW5kb3cuYXBmLm9sbWFwLm1hcC5vbG1hcF9zZWxlY3RfaW50ZXJhY3Rpb24gZXJnw6RuemVuXHJcbiAgICAgICAgaWYgKHBvcGlkX21hcmtpZXJ0ICYmIHBvcGlkX21hcmtpZXJ0LmluZGV4T2YocG9wLlBvcElkKSAhPT0gLTEpIHtcclxuICAgICAgICBcdHNlbGVjdGVkX2ZlYXR1cmVzLnB1c2gobWFya2VyKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBsYXllciBmw7xyIE1hcmtlciBlcnN0ZWxsZW5cclxuICAgIHBvcF9taXRfbnJfbGF5ZXIgPSBuZXcgb2wubGF5ZXIuVmVjdG9yKHtcclxuICAgICAgICB0aXRsZTogJ1BvcHVsYXRpb25lbicsXHJcbiAgICAgICAgc2VsZWN0YWJsZTogdHJ1ZSxcclxuICAgICAgICBzb3VyY2U6IG5ldyBvbC5zb3VyY2UuVmVjdG9yKHtcclxuICAgICAgICAgICAgZmVhdHVyZXM6IG1hcmtlcnNcclxuICAgICAgICB9KSxcclxuICAgICAgICBzdHlsZTogZnVuY3Rpb24oZmVhdHVyZSwgcmVzb2x1dGlvbikge1xyXG4gICAgICAgICAgICByZXR1cm4gd2luZG93LmFwZi5vbG1hcC5wb3BTdHlsZShmZWF0dXJlLCByZXNvbHV0aW9uKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIHBvcF9taXRfbnJfbGF5ZXIuc2V0KCd2aXNpYmxlJywgdmlzaWJsZSk7XHJcbiAgICBwb3BfbWl0X25yX2xheWVyLnNldCgna2F0ZWdvcmllJywgJ0FQIEZsb3JhJyk7XHJcbiAgICB3aW5kb3cuYXBmLm9sbWFwLm1hcC5hZGRMYXllcihwb3BfbWl0X25yX2xheWVyKTtcclxuXHJcbiAgICBpZiAoc2VsZWN0ZWRfZmVhdHVyZXMgJiYgc2VsZWN0ZWRfZmVhdHVyZXMubGVuZ3RoID4gMCkge1xyXG5cdCAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG5cdCAgICAgICAgd2luZG93LmFwZi5vbG1hcC5wcsO8ZmVPYlBvcFRwb3BHZXfDpGhsdFd1cmRlbigpO1xyXG5cdCAgICB9LCAxMDApO1xyXG5cdCAgICAvLyBTY2hhbHRmbMOkY2hlIG9sbWFwX2F1c3dhZWhsZW4gYWt0aXZpZXJlblxyXG5cdCAgICAkKCcjb2xtYXBfYXVzd2FlaGxlbicpXHJcbiAgICAgICAgICAgIC5wcm9wKCdjaGVja2VkJywgdHJ1ZSlcclxuICAgICAgICAgICAgLmJ1dHRvbihcInJlZnJlc2hcIik7XHJcbiAgICB9XHJcblxyXG4gICAgcG9wX2xheWVyX2Vyc3RlbGx0LnJlc29sdmUoKTtcclxuICAgIHJldHVybiBwb3BfbGF5ZXJfZXJzdGVsbHQucHJvbWlzZSgpO1xyXG59O1xyXG5cclxuXHJcbi8vIGVybcO2Z2xpY2h0IGVzLCBuYWNoIGRlbSB0b29saXAgenUgc29ydGllcmVuXHJcbndpbmRvdy5hcGYudmVyZ2xlaWNoZVRQb3BadW1Tb3J0aWVyZW5OYWNoVG9vbHRpcCA9IGZ1bmN0aW9uKGEsYikge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRpZiAoYS50b29sdGlwIDwgYi50b29sdGlwKVxyXG5cdFx0IHJldHVybiAtMTtcclxuXHRpZiAoYS50b29sdGlwID4gYi50b29sdGlwKVxyXG5cdFx0cmV0dXJuIDE7XHJcblx0cmV0dXJuIDA7XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLmRlYWt0aXZpZXJlR2VvQWRtaW5BdXN3YWhsID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICh3aW5kb3cuYXBmLm9sbWFwLmF1c3dhaGxQb2x5Z29uTGF5ZXIpIHtcclxuXHRcdHdpbmRvdy5hcGYub2xtYXAuYXVzd2FobFBvbHlnb25MYXllci5yZW1vdmVBbGxGZWF0dXJlcygpO1xyXG5cdH1cclxuXHRpZiAod2luZG93LmRyYXdDb250cm9sKSB7XHJcblx0XHR3aW5kb3cuZHJhd0NvbnRyb2wuZGVhY3RpdmF0ZSgpO1xyXG5cdH1cclxuXHQkKFwiI2VyZ2VibmlzQXVzd2FobFwiKS5jc3MoXCJkaXNwbGF5XCIsIFwibm9uZVwiKTtcclxuXHRkZWxldGUgd2luZG93LmFwZi50cG9wX2lkX2FycmF5O1xyXG5cdGRlbGV0ZSB3aW5kb3cudHBvcF9pZF9saXN0ZTtcclxuXHRkZWxldGUgd2luZG93LmFwZi5wb3BfaWRfYXJyYXk7XHJcblx0ZGVsZXRlIHdpbmRvdy5wb3BfaWRfbGlzdGU7XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLmVyc3RlbGxlVFBvcE5yTGFiZWwgPSBmdW5jdGlvbihwb3BuciwgdHBvcG5yKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcbiAgICAvLyB0b29sdGlwIGJ6dy4gbGFiZWwgdm9yYmVyZWl0ZW46IG51bGx3ZXJ0ZSBhdXNibGVuZGVuXHJcbiAgICBpZiAocG9wbnIgJiYgdHBvcG5yKSB7XHJcbiAgICAgICAgcmV0dXJuIHBvcG5yICsgJy8nICsgdHBvcG5yO1xyXG4gICAgfSBlbHNlIGlmIChwb3Bucikge1xyXG4gICAgICAgIHJldHVybiBwb3BuciArICcvPyc7XHJcbiAgICB9IGVsc2UgaWYgKHRwb3Bucikge1xyXG4gICAgICAgIHJldHVybiAnPy8nICsgdHBvcG5yO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gJz8vPyc7XHJcbiAgICB9XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLm9sbWFwLmVyc3RlbGxlTWFya2VyRsO8clRQb3BMYXllciA9IGZ1bmN0aW9uKHRwb3ApIHtcclxuXHRyZXR1cm4gbmV3IG9sLkZlYXR1cmUoe1xyXG5cdFx0Z2VvbWV0cnk6IG5ldyBvbC5nZW9tLlBvaW50KFt0cG9wLlRQb3BYS29vcmQsIHRwb3AuVFBvcFlLb29yZF0pLFxyXG4gICAgICAgIHRwb3BfbnI6IHRwb3AuVFBvcE5yLFxyXG4gICAgICAgIHBvcF9ucjogdHBvcC5Qb3BOcixcclxuICAgICAgICB0cG9wX25yX2xhYmVsOiB3aW5kb3cuYXBmLmVyc3RlbGxlVFBvcE5yTGFiZWwodHBvcC5Qb3BOciwgdHBvcC5UUG9wTnIpLFxyXG4gICAgICAgIHRwb3BfbmFtZTogdHBvcC5UUG9wRmx1cm5hbWUgfHwgJyhrZWluIE5hbWUpJyxcclxuXHRcdG5hbWU6IHdpbmRvdy5hcGYuZXJzdGVsbGVUUG9wTnJMYWJlbCh0cG9wLlBvcE5yLCB0cG9wLlRQb3BOciksICAvLyBicmF1Y2h0cyBkYXMgbm9jaD8gVE9ETzogZW50ZmVybmVuXHJcbiAgICAgICAgcG9wdXBfY29udGVudDogd2luZG93LmFwZi5vbG1hcC5lcnN0ZWxsZUNvbnRlbnRGw7xyVFBvcCh0cG9wKSxcclxuICAgICAgICBwb3B1cF90aXRsZTogdHBvcC5BcnRuYW1lLFxyXG4gICAgICAgIC8vIGtvb3JkaW5hdGVuIHdlcmRlbiBiZW7DtnRpZ3QgZGFtaXQgZGFzIHBvcHVwIGFtIHJpY2h0aWdlbiBPcnQgdmVyYW5rZXJ0IHdpcmRcclxuICAgICAgICB4a29vcmQ6IHRwb3AuVFBvcFhLb29yZCxcclxuICAgICAgICB5a29vcmQ6IHRwb3AuVFBvcFlLb29yZCxcclxuICAgICAgICBteVR5cDogJ3Rwb3AnLFxyXG4gICAgICAgIG15SWQ6IHRwb3AuVFBvcElkXHJcblx0fSk7XHJcbn07XHJcblxyXG4vLyBuaW1tdCBkcmVpIFZhcmlhYmxlbiBlbnRnZWdlbjpcclxuLy8gdHBvcF9saXN0ZTogRGllIExpc3RlIGRlciBkYXJ6dXN0ZWxsZW5kZW4gVGVpbHBvcHVsYXRpb25lblxyXG4vLyB0cG9waWRfbWFya2llcnQ6IGRpZSBJRCBkZXIgenUgbWFya2llcmVuZGVuIFRQb3BcclxuLy8gdmlzaWJsZTogT2IgZGFzIExheWVyIHNpY2h0YmFyIHNlaW4gc29sbFxyXG53aW5kb3cuYXBmLm9sbWFwLmVyc3RlbGxlVFBvcExheWVyID0gZnVuY3Rpb24odHBvcF9saXN0ZSwgdHBvcGlkX21hcmtpZXJ0LCB2aXNpYmxlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cclxuXHR2YXIgdHBvcF9sYXllcl9lcnN0ZWxsdCA9ICQuRGVmZXJyZWQoKSxcclxuXHRcdHRwb3BfbGF5ZXIsXHJcblx0XHRtYXJrZXJzID0gW10sXHJcblx0XHRtYXJrZXIsXHJcbiAgICAgICAgc2VsZWN0ZWRfZmVhdHVyZXM7XHJcblxyXG4gICAgaWYgKHdpbmRvdy5hcGYub2xtYXAubWFwLm9sbWFwX3NlbGVjdF9pbnRlcmFjdGlvbiAmJiB0cG9waWRfbWFya2llcnQpIHtcclxuICAgICAgICBzZWxlY3RlZF9mZWF0dXJlcyA9IHdpbmRvdy5hcGYub2xtYXAubWFwLm9sbWFwX3NlbGVjdF9pbnRlcmFjdGlvbi5nZXRGZWF0dXJlcygpLmdldEFycmF5KCk7XHJcbiAgICB9IGVsc2UgaWYgKHRwb3BpZF9tYXJraWVydCkge1xyXG4gICAgICAgIHdpbmRvdy5hcGYub2xtYXAuYWRkU2VsZWN0RmVhdHVyZXNJblNlbGVjdGFibGVMYXllcnMoKTtcclxuICAgICAgICBzZWxlY3RlZF9mZWF0dXJlcyA9IHdpbmRvdy5hcGYub2xtYXAubWFwLm9sbWFwX3NlbGVjdF9pbnRlcmFjdGlvbi5nZXRGZWF0dXJlcygpLmdldEFycmF5KCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHZpc2libGUgPT09IG51bGwpIHtcclxuICAgICAgICB2aXNpYmxlID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBfLmVhY2godHBvcF9saXN0ZS5yb3dzLCBmdW5jdGlvbih0cG9wKSB7XHJcbiAgICAgICAgLy8gbWFya2VyIGVyc3RlbGxlbi4uLlxyXG4gICAgICAgIG1hcmtlciA9IHdpbmRvdy5hcGYub2xtYXAuZXJzdGVsbGVNYXJrZXJGw7xyVFBvcExheWVyKHRwb3ApO1xyXG5cclxuICAgICAgICAvLyAuLi51bmQgaW4gQXJyYXkgc3BlaWNoZXJuXHJcbiAgICAgICAgbWFya2Vycy5wdXNoKG1hcmtlcik7XHJcblxyXG4gICAgICAgIC8vIG1hcmtpZXJ0ZSBpbiB3aW5kb3cuYXBmLm9sbWFwLm1hcC5vbG1hcF9zZWxlY3RfaW50ZXJhY3Rpb24gZXJnw6RuemVuXHJcbiAgICAgICAgaWYgKHRwb3BpZF9tYXJraWVydCAmJiB0cG9waWRfbWFya2llcnQuaW5kZXhPZih0cG9wLlRQb3BJZCkgIT09IC0xKSB7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkX2ZlYXR1cmVzLnB1c2gobWFya2VyKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBsYXllciBmw7xyIE1hcmtlciBlcnN0ZWxsZW5cclxuXHR0cG9wX2xheWVyID0gbmV3IG9sLmxheWVyLlZlY3Rvcih7XHJcblx0XHR0aXRsZTogJ1RlaWxwb3B1bGF0aW9uZW4nLFxyXG5cdFx0c291cmNlOiBuZXcgb2wuc291cmNlLlZlY3Rvcih7XHJcblx0XHRcdFx0ZmVhdHVyZXM6IG1hcmtlcnNcclxuXHRcdFx0fSksXHJcblx0XHRzdHlsZTogZnVuY3Rpb24oZmVhdHVyZSwgcmVzb2x1dGlvbikge1xyXG4gICAgICAgICAgICByZXR1cm4gd2luZG93LmFwZi5vbG1hcC50cG9wU3R5bGUoZmVhdHVyZSwgcmVzb2x1dGlvbik7XHJcbiAgICAgICAgfVxyXG5cdH0pO1xyXG4gICAgdHBvcF9sYXllci5zZXQoJ3Zpc2libGUnLCB2aXNpYmxlKTtcclxuICAgIHRwb3BfbGF5ZXIuc2V0KCdrYXRlZ29yaWUnLCAnQVAgRmxvcmEnKTtcclxuICAgIFxyXG4gICAgLy8gLi4udW5kIGRlciBLYXJ0ZSBoaW56dWbDvGdlblxyXG4gICAgd2luZG93LmFwZi5vbG1hcC5tYXAuYWRkTGF5ZXIodHBvcF9sYXllcik7XHJcblxyXG4gICAgaWYgKHNlbGVjdGVkX2ZlYXR1cmVzICYmIHNlbGVjdGVkX2ZlYXR1cmVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB3aW5kb3cuYXBmLm9sbWFwLnByw7xmZU9iUG9wVHBvcEdld8OkaGx0V3VyZGVuKCk7XHJcbiAgICAgICAgfSwgMTAwKTtcclxuICAgICAgICAvLyBTY2hhbHRmbMOkY2hlIG9sbWFwX2F1c3dhZWhsZW4gYWt0aXZpZXJlblxyXG4gICAgICAgICQoJyNvbG1hcF9hdXN3YWVobGVuJylcclxuICAgICAgICAgICAgLnByb3AoJ2NoZWNrZWQnLCB0cnVlKVxyXG4gICAgICAgICAgICAuYnV0dG9uKFwicmVmcmVzaFwiKTtcclxuICAgIH1cclxuXHJcblx0dHBvcF9sYXllcl9lcnN0ZWxsdC5yZXNvbHZlKCk7XHJcblx0cmV0dXJuIHRwb3BfbGF5ZXJfZXJzdGVsbHQucHJvbWlzZSgpO1xyXG59O1xyXG5cclxud2luZG93LmFwZi5vbG1hcC5vbkZlYXR1cmVTZWxlY3QgPSBmdW5jdGlvbihmZWF0dXJlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBwb3B1cCA9IG5ldyBPcGVuTGF5ZXJzLlBvcHVwLkZyYW1lZENsb3VkKFwicG9wdXBcIixcclxuXHRcdFx0ZmVhdHVyZS5nZW9tZXRyeS5nZXRCb3VuZHMoKS5nZXRDZW50ZXJMb25MYXQoKSxcclxuXHRcdFx0bnVsbCxcclxuXHRcdFx0ZmVhdHVyZS5hdHRyaWJ1dGVzLm1lc3NhZ2UsXHJcblx0XHRcdG51bGwsXHJcblx0XHRcdGZhbHNlXHQvLyB0cnVlIHplaWd0IFNjaGxpZXNzLVNjaGFsZnRsw6RjaGUgYW4uIFNjaGxpZXNzZW4gemVyc3TDtnJ0IGFiZXIgZXZlbnQtbGlzdGVuZXIgPiBwb3B1cCBrYW5uIG51ciBlaW4gbWFsIGFuZ2V6ZWlndCB3ZXJkZW4hXHJcblx0XHQpO1xyXG5cdHBvcHVwLmF1dG9TaXplID0gdHJ1ZTtcclxuXHRwb3B1cC5tYXhTaXplID0gbmV3IE9wZW5MYXllcnMuU2l6ZSg2MDAsNjAwKTtcclxuXHRwb3B1cC5maXhlZFJlbGF0aXZlUG9zaXRpb24gPSB0cnVlO1xyXG5cdGZlYXR1cmUucG9wdXAgPSBwb3B1cDtcclxuXHR3aW5kb3cuYXBmLmdtYXAuYWRkUG9wdXAocG9wdXApO1xyXG59O1xyXG5cclxud2luZG93LmFwZi5vbG1hcC5vbkZlYXR1cmVVbnNlbGVjdCA9IGZ1bmN0aW9uKGZlYXR1cmUpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0ZmVhdHVyZS5wb3B1cC5oaWRlKCk7XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLmdtYXAuemVpZ2VCZW9iVW5kVFBvcCA9IGZ1bmN0aW9uKGJlb2JfbGlzdGUsIHRwb3BfbGlzdGUpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0d2luZG93LnRwb3BfbGlzdGUgPSB0cG9wX2xpc3RlO1xyXG5cdHZhciBhbnpfYmVvYixcclxuICAgICAgICBhbnpfdHBvcCxcclxuICAgICAgICBpbmZvd2luZG93X2Jlb2IsXHJcbiAgICAgICAgaW5mb3dpbmRvd190cG9wLFxyXG4gICAgICAgIHRwb3AsXHJcbiAgICAgICAgbGF0LFxyXG4gICAgICAgIGxuZyxcclxuICAgICAgICBsYXRsbmcsXHJcbiAgICAgICAgb3B0aW9ucyxcclxuICAgICAgICBtYXAsXHJcbiAgICAgICAgYm91bmRzLFxyXG4gICAgICAgIG1hcmtlcnNfdHBvcCxcclxuICAgICAgICB0cG9wX2lkLFxyXG4gICAgICAgIGxhdGxuZzIsXHJcbiAgICAgICAgbWFya2VyX2Jlb2IsXHJcbiAgICAgICAgbWFya2VyX3Rwb3AsXHJcbiAgICAgICAgY29udGVudHN0cmluZ19iZW9iLFxyXG4gICAgICAgIGNvbnRlbnRzdHJpbmdfdHBvcCxcclxuICAgICAgICBtYXJrZXJfb3B0aW9uc19iZW9iLFxyXG4gICAgICAgIG1hcmtlcl9vcHRpb25zX3Rwb3AsXHJcbiAgICAgICAgbWFya2VyX2NsdXN0ZXJfYmVvYixcclxuICAgICAgICBtYXJrZXJfY2x1c3Rlcl90cG9wLFxyXG4gICAgICAgIGRhdHVtLFxyXG4gICAgICAgIHRpdGVsX2Jlb2IsXHJcbiAgICAgICAgdHBvcF9iZXNjaHJpZnR1bmcsXHJcbiAgICAgICAgYV9ub3RlLFxyXG4gICAgICAgIG15X2ZsdXJuYW1lO1xyXG5cdC8vIHZvciBFcm5ldWVydW5nIHplaWdlbiAtIHNvbnN0IGtsYXBwdCBXaWVkZXJhdWZydWYgbmljaHQsIHdlbm4gZGllIEthcnRlIHNjaG9uIGFuZ2V6ZWlndCBpc3RcclxuXHR3aW5kb3cuYXBmLnplaWdlRm9ybXVsYXIoXCJnb29nbGVfa2FydGVcIik7XHJcblx0d2luZG93LmFwZi5nbWFwLm1hcmtlcnNfYXJyYXkgPSBbXTtcclxuXHR3aW5kb3cuYXBmLmdtYXAuaW5mb193aW5kb3dfYXJyYXkgPSBbXTtcclxuXHRpbmZvd2luZG93X2Jlb2IgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdygpO1xyXG5cdGluZm93aW5kb3dfdHBvcCA9IG5ldyBnb29nbGUubWFwcy5JbmZvV2luZG93KCk7XHJcblx0Ly8gTGF0IHVuZCBMbmcgaW4gQmVvYkxpc3RlIGVyZ8OkbnplblxyXG4gICAgXy5lYWNoKGJlb2JfbGlzdGUucm93cywgZnVuY3Rpb24oYmVvYikge1xyXG4gICAgICAgIGJlb2IuTGF0ID0gd2luZG93LmFwZi5DSHRvV0dTbGF0KHBhcnNlSW50KGJlb2IuWCksIHBhcnNlSW50KGJlb2IuWSkpO1xyXG4gICAgICAgIGJlb2IuTG5nID0gd2luZG93LmFwZi5DSHRvV0dTbG5nKHBhcnNlSW50KGJlb2IuWCksIHBhcnNlSW50KGJlb2IuWSkpO1xyXG4gICAgfSk7XHJcblx0Ly8gZGl0byBpbiBUUG9wTGlzdGVcclxuICAgIF8uZWFjaCh0cG9wX2xpc3RlLnJvd3MsIGZ1bmN0aW9uKHRwb3AsIGluZGV4KSB7XHJcbiAgICAgICAgaWYgKCF0cG9wLlRQb3BYS29vcmQgfHwgIXRwb3AuVFBvcFlLb29yZCkge1xyXG4gICAgICAgICAgICAvLyB0cG9wIGdpYnQgaW4gQ2hyb21lIEZlaGxlclxyXG4gICAgICAgICAgICBkZWxldGUgdHBvcF9saXN0ZS5yb3dzW2luZGV4XTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0cG9wLkxhdCA9IHdpbmRvdy5hcGYuQ0h0b1dHU2xhdChwYXJzZUludCh0cG9wLlRQb3BYS29vcmQpLCBwYXJzZUludCh0cG9wLlRQb3BZS29vcmQpKTtcclxuICAgICAgICAgICAgdHBvcC5MbmcgPSB3aW5kb3cuYXBmLkNIdG9XR1NsbmcocGFyc2VJbnQodHBvcC5UUG9wWEtvb3JkKSwgcGFyc2VJbnQodHBvcC5UUG9wWUtvb3JkKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblx0Ly8gQmVvYiB6w6RobGVuXHJcblx0YW56X2Jlb2IgPSBiZW9iX2xpc3RlLnJvd3MubGVuZ3RoO1xyXG5cdC8vIFRQb3AgesOkaGxlblxyXG5cdGFuel90cG9wID0gdHBvcF9saXN0ZS5yb3dzLmxlbmd0aDtcclxuXHQvLyBLYXJ0ZSBtYWwgYXVmIFrDvHJpY2ggemVudHJpZXJlbiwgZmFsbHMgaW4gZGVuIEJlb2JMaXN0ZS5yb3dzIGtlaW5lIEtvb3JkaW5hdGVuIGtvbW1lblxyXG5cdC8vIGF1ZiBkaWUgZGllIEthcnRlIGF1c2dlcmljaHRldCB3ZXJkZW4ga2FublxyXG5cdGxhdCA9IDQ3LjM4MzMzMztcclxuXHRsbmcgPSA4LjUzMzMzMztcclxuXHRsYXRsbmcgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxhdCwgbG5nKTtcclxuXHRvcHRpb25zID0ge1xyXG5cdFx0em9vbTogMTUsXHJcblx0XHRjZW50ZXI6IGxhdGxuZyxcclxuXHRcdHN0cmVldFZpZXdDb250cm9sOiBmYWxzZSxcclxuXHRcdG1hcFR5cGVJZDogZ29vZ2xlLm1hcHMuTWFwVHlwZUlkLlNBVEVMTElURVxyXG5cdH07XHJcblx0bWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImdvb2dsZV9rYXJ0ZW5fZGl2XCIpLCBvcHRpb25zKTtcclxuXHR3aW5kb3cuYXBmLmdtYXAubWFwID0gbWFwO1xyXG5cdGJvdW5kcyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmdCb3VuZHMoKTtcclxuXHJcblx0Ly8gZsO8ciBhbGxlIFRQb3AgTWFya2VyIGVyc3RlbGxlblxyXG5cdG1hcmtlcnNfdHBvcCA9IFtdO1xyXG4gICAgXy5lYWNoKHRwb3BfbGlzdGUucm93cywgZnVuY3Rpb24odHBvcCkge1xyXG4gICAgICAgIHRwb3BfaWQgPSB0cG9wLlRQb3BJZDtcclxuICAgICAgICBsYXRsbmcyID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyh0cG9wLkxhdCwgdHBvcC5MbmcpO1xyXG4gICAgICAgIC8vIEthcnRlbmF1c3NjaG5pdHQgdW0gZGllc2UgS29vcmRpbmF0ZSBlcndlaXRlcm5cclxuICAgICAgICBib3VuZHMuZXh0ZW5kKGxhdGxuZzIpO1xyXG4gICAgICAgIHRwb3BfYmVzY2hyaWZ0dW5nID0gd2luZG93LmFwZi5iZXNjaHJpZnRlVFBvcE1pdE5yRsO8ckthcnRlKHRwb3AuUG9wTnIsIHRwb3AuVFBvcE5yKTtcclxuICAgICAgICBtYXJrZXJfdHBvcCA9IG5ldyBNYXJrZXJXaXRoTGFiZWwoe1xyXG4gICAgICAgICAgICBtYXA6IG1hcCxcclxuICAgICAgICAgICAgcG9zaXRpb246IGxhdGxuZzIsXHJcbiAgICAgICAgICAgIHRpdGxlOiB0cG9wX2Jlc2NocmlmdHVuZyxcclxuICAgICAgICAgICAgbGFiZWxDb250ZW50OiB0cG9wX2Jlc2NocmlmdHVuZyxcclxuICAgICAgICAgICAgbGFiZWxBbmNob3I6IG5ldyBnb29nbGUubWFwcy5Qb2ludCg3NSwgMCksXHJcbiAgICAgICAgICAgIGxhYmVsQ2xhc3M6IFwiTWFwTGFiZWxcIixcclxuICAgICAgICAgICAgaWNvbjogXCJpbWcvZmxvcmFfaWNvbi5wbmdcIlxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIG1hcmtlcnNfdHBvcC5wdXNoKG1hcmtlcl90cG9wKTtcclxuICAgICAgICBteV9mbHVybmFtZSA9IHRwb3AuVFBvcEZsdXJuYW1lIHx8ICcoa2VpbiBGbHVybmFtZSknO1xyXG4gICAgICAgIGNvbnRlbnRzdHJpbmdfdHBvcCA9ICc8ZGl2IGlkPVwiY29udGVudFwiPicrXHJcbiAgICAgICAgICAgICc8ZGl2IGlkPVwic2l0ZU5vdGljZVwiPicrXHJcbiAgICAgICAgICAgICc8L2Rpdj4nK1xyXG4gICAgICAgICAgICAnPGRpdiBpZD1cImJvZHlDb250ZW50XCIgY2xhc3M9XCJHbUluZm93aW5kb3dcIj4nK1xyXG4gICAgICAgICAgICAnPGgzPicgKyB0cG9wLkFydG5hbWUgKyAnPC9oMz4nK1xyXG4gICAgICAgICAgICAnPHA+UG9wdWxhdGlvbjogJyArIHRwb3AuUG9wTmFtZSArICc8L3A+JytcclxuICAgICAgICAgICAgJzxwPlRQb3A6ICcgKyBteV9mbHVybmFtZSArICc8L3A+JytcclxuICAgICAgICAgICAgJzxwPktvb3JkaW5hdGVuOiAnICsgdHBvcC5UUG9wWEtvb3JkICsgJyAvICcgKyB0cG9wLlRQb3BZS29vcmQgKyAnPC9wPicrXHJcbiAgICAgICAgICAgIFwiPHA+PGEgaHJlZj1cXFwiI1xcXCIgb25jbGljaz1cXFwid2luZG93LmFwZi7DtmZmbmVUUG9wKCdcIiArIHRwb3AuVFBvcElkICsgXCInKVxcXCI+Rm9ybXVsYXIgYW5zdGVsbGUgS2FydGUgw7ZmZm5lbjxcXC9hPjwvcD5cIitcclxuICAgICAgICAgICAgJzxwPjxhIGhyZWY9XCIjXCIgb25jbGljaz1cXFwid2luZG93LmFwZi7DtmZmbmVGb3JtdWxhckFsc1BvcHVwKFxcJ3Rwb3BcXCcsICcgKyB0cG9wLlRQb3BJZCArICcpXFxcIj5Gb3JtdWxhciBuZWJlbiBkZXIgS2FydGUgw7ZmZm5lbjxcXC9hPjwvcD4nK1xyXG4gICAgICAgICAgICBcIjxwPjxhIGhyZWY9XFxcIiNcXFwiIG9uY2xpY2s9XFxcIndpbmRvdy5hcGYuw7ZmZm5lVFBvcEluTmV1ZW1UYWIoJ1wiICsgdHBvcC5UUG9wSWQgKyBcIicpXFxcIj5Gb3JtdWxhciBpbiBuZXVlbSBGZW5zdGVyIMO2ZmZuZW48XFwvYT48L3A+XCIrXHJcbiAgICAgICAgICAgICc8L2Rpdj4nK1xyXG4gICAgICAgICAgICAnPC9kaXY+JztcclxuICAgICAgICBtYWtlTGlzdGVuZXIobWFwLCBtYXJrZXJfdHBvcCwgY29udGVudHN0cmluZ190cG9wKTtcclxuICAgIH0pO1xyXG5cdG1hcmtlcl9vcHRpb25zX3Rwb3AgPSB7XHJcblx0XHRtYXhab29tOiAxNywgXHJcblx0XHRzdHlsZXM6IFt7XHJcblx0XHRcdFx0aGVpZ2h0OiA1MyxcclxuXHRcdFx0XHR1cmw6IFwiaW1nL204LnBuZ1wiLFxyXG5cdFx0XHRcdHdpZHRoOiA1M1xyXG5cdFx0XHR9XVxyXG5cdH07XHJcblx0bWFya2VyX2NsdXN0ZXJfdHBvcCA9IG5ldyBNYXJrZXJDbHVzdGVyZXIobWFwLCBtYXJrZXJzX3Rwb3AsIG1hcmtlcl9vcHRpb25zX3Rwb3ApO1xyXG5cdFxyXG5cdC8vIGRpZXNlIEZ1bmt0aW9uIG11c3MgaGllciBzZWluLCBkYW1pdCBpbmZvd2luZG93IGJla2FubnQgaXN0XHJcblx0ZnVuY3Rpb24gbWFrZUxpc3RlbmVyKG1hcCwgbWFya2VyVFBvcCwgY29udGVudFN0cmluZ1RQb3ApIHtcclxuXHRcdGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlclRQb3AsICdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRpbmZvd2luZG93X3Rwb3Auc2V0Q29udGVudChjb250ZW50U3RyaW5nVFBvcCk7XHJcblx0XHRcdGluZm93aW5kb3dfdHBvcC5vcGVuKG1hcCwgbWFya2VyVFBvcCk7XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdC8vIGbDvHIgYWxsZSBCZW9iIE1hcmtlciBlcnN0ZWxsZW5cclxuXHR3aW5kb3cubWFya2Vyc0Jlb2IgPSBbXTtcclxuICAgIF8uZWFjaChiZW9iX2xpc3RlLnJvd3MsIGZ1bmN0aW9uKGJlb2IpIHtcclxuICAgICAgICBkYXR1bSA9IGJlb2IuRGF0dW07XHJcbiAgICAgICAgbGF0bG5nMiA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoYmVvYi5MYXQsIGJlb2IuTG5nKTtcclxuICAgICAgICBpZiAoYW56X2Jlb2IgPT09IDEpIHtcclxuICAgICAgICAgICAgLy8gbWFwLmZpdGJvdW5kcyBzZXR6dCB6dSBob2hlbiB6b29tLCB3ZW5uIG51ciBlaW5lIEJlb2IgS29vcmRpbmF0ZW4gaGF0ID4gdmVyaGluZGVyblxyXG4gICAgICAgICAgICBsYXRsbmcgPSBsYXRsbmcyO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIEthcnRlbmF1c3NjaG5pdHQgdW0gZGllc2UgS29vcmRpbmF0ZSBlcndlaXRlcm5cclxuICAgICAgICAgICAgYm91bmRzLmV4dGVuZChsYXRsbmcyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gdGl0bGUgbXVzcyBTdHJpbmcgc2VpblxyXG4gICAgICAgIGlmIChkYXR1bSkge1xyXG4gICAgICAgICAgICB0aXRlbF9iZW9iID0gZGF0dW0udG9TdHJpbmcoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aXRlbF9iZW9iID0gXCJcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gQV9OT1RFIG11c3MgU3RyaW5nIHNlaW5cclxuICAgICAgICBpZiAoYmVvYi5BX05PVEUpIHtcclxuICAgICAgICAgICAgYV9ub3RlID0gYmVvYi5BX05PVEUudG9TdHJpbmcoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBhX25vdGUgPSBcIlwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBtYXJrZXJfYmVvYiA9IG5ldyBNYXJrZXJXaXRoTGFiZWwoe1xyXG4gICAgICAgICAgICBtYXA6IG1hcCxcclxuICAgICAgICAgICAgcG9zaXRpb246IGxhdGxuZzIsXHJcbiAgICAgICAgICAgIHRpdGxlOiB0aXRlbF9iZW9iLFxyXG4gICAgICAgICAgICBsYWJlbENvbnRlbnQ6IGFfbm90ZSxcclxuICAgICAgICAgICAgbGFiZWxBbmNob3I6IG5ldyBnb29nbGUubWFwcy5Qb2ludCg3NSwgMCksXHJcbiAgICAgICAgICAgIGxhYmVsQ2xhc3M6IFwiTWFwTGFiZWxcIixcclxuICAgICAgICAgICAgaWNvbjogXCJpbWcvZmxvcmFfaWNvbl92aW9sZXR0LnBuZ1wiLFxyXG4gICAgICAgICAgICBkcmFnZ2FibGU6IHRydWVcclxuICAgICAgICB9KTtcclxuICAgICAgICB3aW5kb3cubWFya2Vyc0Jlb2IucHVzaChtYXJrZXJfYmVvYik7XHJcbiAgICAgICAgbWFrZUxpc3RlbmVyTWFya2VyQmVvYkRyYWdlbmQobWFya2VyX2Jlb2IsIGJlb2IpO1xyXG4gICAgICAgIHZhciBBdXRvciA9IGJlb2IuQXV0b3IgfHwgXCIoa2VpbmVyKVwiO1xyXG4gICAgICAgIHZhciBQcm9qZWt0ID0gYmVvYi5QUk9KRVQgfHwgXCIoa2VpbmVzKVwiO1xyXG4gICAgICAgIHZhciBPcnQgPSBiZW9iLkRFU0NfTE9DQUxJVEUgfHwgXCIoa2VpbmVyKVwiO1xyXG4gICAgICAgIGNvbnRlbnRzdHJpbmdfYmVvYiA9ICc8ZGl2IGlkPVwiY29udGVudFwiPicrXHJcbiAgICAgICAgICAgICc8ZGl2IGlkPVwic2l0ZU5vdGljZVwiPicrXHJcbiAgICAgICAgICAgICc8L2Rpdj4nK1xyXG4gICAgICAgICAgICAnPGRpdiBpZD1cImJvZHlDb250ZW50XCIgY2xhc3M9XCJHbUluZm93aW5kb3dcIj4nK1xyXG4gICAgICAgICAgICAnPGgzPicgKyBkYXR1bSArICc8L2gzPicrXHJcbiAgICAgICAgICAgICc8cD5BdXRvcjogJyArIEF1dG9yICsgJzwvcD4nK1xyXG4gICAgICAgICAgICAnPHA+UHJvamVrdDogJyArIFByb2pla3QgKyAnPC9wPicrXHJcbiAgICAgICAgICAgICc8cD5PcnQ6ICcgKyBPcnQgKyAnPC9wPicrXHJcbiAgICAgICAgICAgICc8cD5Lb29yZGluYXRlbjogJyArIGJlb2IuWCArICcgLyAnICsgYmVvYi5ZICsgJzwvcD4nK1xyXG4gICAgICAgICAgICBcIjxwPjxhIGhyZWY9XFxcIiNcXFwiIG9uY2xpY2s9XFxcIndpbmRvdy5hcGYuw7ZmZm5lQmVvYignXCIgKyBiZW9iLk5PX05PVEUgKyBcIicpXFxcIj5Gb3JtdWxhciBhbnN0ZWxsZSBLYXJ0ZSDDtmZmbmVuPFxcL2E+PC9wPlwiK1xyXG4gICAgICAgICAgICAvLyc8cD48YSBocmVmPVwiI1wiIG9uY2xpY2s9XFxcIndpbmRvdy5hcGYuw7ZmZm5lRm9ybXVsYXJBbHNQb3B1cChcXCdiZW9iXFwnLCAnICsgYmVvYi5OT19OT1RFICsgJylcXFwiPkZvcm11bGFyIG5lYmVuIGRlciBLYXJ0ZSDDtmZmbmVuPFxcL2E+PC9wPicrXHJcbiAgICAgICAgICAgIFwiPHA+PGEgaHJlZj1cXFwiI1xcXCIgb25jbGljaz1cXFwid2luZG93LmFwZi7DtmZmbmVCZW9iSW5OZXVlbVRhYignXCIgKyBiZW9iLk5PX05PVEUgKyBcIicpXFxcIj5Gb3JtdWxhciBpbiBuZXVlbSBGZW5zdGVyIMO2ZmZuZW48XFwvYT48L3A+XCIrXHJcbiAgICAgICAgICAgICc8L2Rpdj4nK1xyXG4gICAgICAgICAgICAnPC9kaXY+JztcclxuICAgICAgICBtYWtlTGlzdGVuZXJCZW9iKG1hcCwgbWFya2VyX2Jlb2IsIGNvbnRlbnRzdHJpbmdfYmVvYik7XHJcbiAgICB9KTtcclxuXHQvLyBLRUlOIE1BUktFUkNMVVNURVJFUjogZXIgdmVyaGluZGVydCBkYXMgRW50ZmVybmVuIGVpbnplbG5lciBNYXJrZXIhXHJcblx0Ly8gYXVzc2VyZGVtIG1hY2h0IGVyIGVzIHNjaHdpZXJpZywgZW5nIGxpZWdlbmRlIE1hcmtlciB6dXp1b3JkbmVuXHJcblx0XHJcblx0Ly8gZGllc2UgRnVua3Rpb24gbXVzcyBoaWVyIHNlaW4sIGRhbWl0IGluZm93aW5kb3cgYmVrYW5udCBpc3RcclxuXHRmdW5jdGlvbiBtYWtlTGlzdGVuZXJCZW9iKG1hcCwgbWFya2VyQmVvYiwgY29udGVudFN0cmluZ0Jlb2IpIHtcclxuXHRcdGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlckJlb2IsICdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRpbmZvd2luZG93X2Jlb2Iuc2V0Q29udGVudChjb250ZW50U3RyaW5nQmVvYik7XHJcblx0XHRcdGluZm93aW5kb3dfYmVvYi5vcGVuKG1hcCwgbWFya2VyQmVvYik7XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIG1ha2VMaXN0ZW5lck1hcmtlckJlb2JEcmFnZW5kKG1hcmtlckJlb2IsIEJlb2IpIHtcclxuXHRcdGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlckJlb2IsIFwiZHJhZ2VuZFwiLCBmdW5jdGlvbihldmVudCkge1xyXG5cdFx0XHR2YXIgbGF0LCBsbmcsIFgsIFksIHRoYXQ7XHJcblx0XHRcdHRoYXQgPSB0aGlzO1xyXG5cdFx0XHQvLyBLb29yZGluYXRlbiBiZXJlY2huZW5cclxuXHRcdFx0bGF0ID0gZXZlbnQubGF0TG5nLmxhdCgpO1xyXG5cdFx0XHRsbmcgPSBldmVudC5sYXRMbmcubG5nKCk7XHJcblx0XHRcdFggPSB3aW5kb3cuYXBmLkRkSW5DaFkobGF0LCBsbmcpO1xyXG5cdFx0XHRZID0gd2luZG93LmFwZi5EZEluQ2hYKGxhdCwgbG5nKTtcclxuXHRcdFx0Ly8gbsOkY2hzdGdlbGVnZW5lIFRQb3AgYXVzIERCIGhvbGVuXHJcblx0XHRcdHZhciBCZW9iTsOkY2hzdGVUUG9wID0gJC5hamF4KHtcclxuXHRcdFx0XHR0eXBlOiAnZ2V0JyxcclxuXHRcdFx0XHR1cmw6ICdwaHAvYmVvYl9uYWVjaHN0ZV90cG9wLnBocCcsXHJcblx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0XCJBcEFydElkXCI6IEJlb2IuTk9fSVNGUyxcclxuXHRcdFx0XHRcdFwiWFwiOiBYLFxyXG5cdFx0XHRcdFx0XCJZXCI6IFlcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdGRhdGFUeXBlOiAnanNvbidcclxuXHRcdFx0fSk7XHJcblx0XHRcdEJlb2JOw6RjaHN0ZVRQb3AuYWx3YXlzKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHR2YXIgYmVvYnR4dDtcclxuXHRcdFx0XHRpZiAoQmVvYi5BdXRvcikge1xyXG5cdFx0XHRcdFx0YmVvYnR4dCA9IFwiQmVvYmFjaHR1bmcgdm9uIFwiICsgQmVvYi5BdXRvciArIFwiIGF1cyBkZW0gSmFociBcIiArIEJlb2IuQV9OT1RFO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRiZW9idHh0ID0gXCJCZW9iYWNodHVuZyBvaG5lIEF1dG9yIGF1cyBkZW0gSmFociBcIiArIEJlb2IuQV9OT1RFO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQvLyByw7xja2ZyYWdlblxyXG5cdFx0XHRcdCQoXCIjTWVsZHVuZ1wiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5odG1sKFwiU29sbCBkaWUgXCIgKyBiZW9idHh0ICsgXCI8YnI+ZGVyIFRlaWxwb3B1bGF0aW9uICdcIiArIGRhdGFbMF0uVFBvcEZsdXJuYW1lICsgXCInIHp1Z2VvcmRuZXQgd2VyZGVuP1wiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5kaWFsb2coe1xyXG5cdFx0XHRcdFx0bW9kYWw6IHRydWUsXHJcblx0XHRcdFx0XHR0aXRsZTogXCJadW9yZG51bmcgYmVzdMOkdGlnZW5cIixcclxuXHRcdFx0XHRcdHdpZHRoOiA2MDAsXHJcblx0XHRcdFx0XHRidXR0b25zOiB7XHJcblx0XHRcdFx0XHRcdEphOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHQkKHRoaXMpLmRpYWxvZyhcImNsb3NlXCIpO1xyXG5cdFx0XHRcdFx0XHRcdC8vIGRlbSBiaW5kLm1vdmVfbm9kZSBtaXR0ZWlsZW4sIGRhc3MgZGFzIEZvcm11bGFyIG5pY2h0IGluaXRpaWVydCB3ZXJkZW4gc29sbFxyXG5cdFx0XHRcdFx0XHRcdGxvY2FsU3RvcmFnZS5rYXJ0ZV9mb2t1c3NpZXJlbiA9IHRydWU7XHJcblx0XHRcdFx0XHRcdFx0Ly8gQmVvYiBkZXIgVFBvcCB6dXdlaXNlblxyXG5cdFx0XHRcdFx0XHRcdCQoXCIjdHJlZVwiKS5qc3RyZWUoXCJtb3ZlX25vZGVcIiwgXCIjYmVvYlwiICsgQmVvYi5OT19OT1RFLCBcIiN0cG9wX29yZG5lcl9iZW9iX3p1Z2VvcmRuZXRcIiArIGRhdGFbMF0uVFBvcElkLCBcImZpcnN0XCIpO1xyXG5cdFx0XHRcdFx0XHRcdC8vIERlbiBNYXJrZXIgZGVyIHp1Z2V3aWVzZW5lbiBCZW9iYWNodHVuZyBlbnRmZXJuZW5cclxuXHRcdFx0XHRcdFx0XHR0aGF0LnNldE1hcChudWxsKTtcclxuXHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0TmVpbjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0JCh0aGlzKS5kaWFsb2coXCJjbG9zZVwiKTtcclxuXHRcdFx0XHRcdFx0XHQvLyBkcmFnIHLDvGNrZ8OkbmdpZyBtYWNoZW5cclxuXHRcdFx0XHRcdFx0XHRsbmcgPSB3aW5kb3cuYXBmLkNIdG9XR1NsbmcoQmVvYi5YLCBCZW9iLlkpO1xyXG5cdFx0XHRcdFx0XHRcdGxhdCA9IHdpbmRvdy5hcGYuQ0h0b1dHU2xhdChCZW9iLlgsIEJlb2IuWSk7XHJcblx0XHRcdFx0XHRcdFx0dmFyIGxhdGxuZzMgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxhdCwgbG5nKTtcclxuXHRcdFx0XHRcdFx0XHR0aGF0LnNldFBvc2l0aW9uKGxhdGxuZzMpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRCZW9iTsOkY2hzdGVUUG9wLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBEaWUgQmVvYmFjaHR1bmcgd3VyZGUgbmljaHQgenVnZW9yZG5ldFwiKTtcclxuXHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBEaWUgQmVvYmFjaHR1bmcgd3VyZGUgbmljaHQgenVnZW9yZG5ldCcpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0aWYgKGFuel90cG9wICsgYW56X2Jlb2IgPT09IDEpIHtcclxuXHRcdC8vIG1hcC5maXRib3VuZHMgc2V0enQgenUgaG9oZW4gem9vbSwgd2VubiBudXIgZWluIFB1bmt0IGRhcmdlc3RlbGx0IHdpcmQgPiB2ZXJoaW5kZXJuXHJcblx0XHRtYXAuc2V0Q2VudGVyKGxhdGxuZyk7XHJcblx0XHRtYXAuc2V0Wm9vbSgxOCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vIEthcnRlIGF1ZiBBdXNzY2huaXR0IGFucGFzc2VuXHJcblx0XHRtYXAuZml0Qm91bmRzKGJvdW5kcyk7XHJcblx0fVxyXG59O1xyXG5cclxud2luZG93LmFwZi5nbWFwLnplaWdlQmVvYiA9IGZ1bmN0aW9uKGJlb2JfbGlzdGUpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGFuel9iZW9iLFxyXG4gICAgICAgIGluZm93aW5kb3csXHJcbiAgICAgICAgbGF0LFxyXG4gICAgICAgIGxuZyxcclxuICAgICAgICBsYXRsbmcsXHJcbiAgICAgICAgb3B0aW9ucyxcclxuICAgICAgICBtYXAsXHJcbiAgICAgICAgYm91bmRzLFxyXG4gICAgICAgIG1hcmtlcnMsXHJcbiAgICAgICAgbGF0bG5nMixcclxuICAgICAgICBtYXJrZXIsXHJcbiAgICAgICAgY29udGVudFN0cmluZyxcclxuICAgICAgICBtYXJrZXJfb3B0aW9ucyxcclxuICAgICAgICBtYXJrZXJfY2x1c3RlcixcclxuICAgICAgICBkYXR1bSxcclxuICAgICAgICB0aXRlbCxcclxuICAgICAgICBhX25vdGU7XHJcblx0Ly8gdm9yIEVybmV1ZXJ1bmcgemVpZ2VuIC0gc29uc3Qga2xhcHB0IFdpZWRlcmF1ZnJ1ZiBuaWNodCwgd2VubiBkaWUgS2FydGUgc2Nob24gYW5nZXplaWd0IGlzdFxyXG5cdHdpbmRvdy5hcGYuemVpZ2VGb3JtdWxhcihcImdvb2dsZV9rYXJ0ZVwiKTtcclxuXHR3aW5kb3cuYXBmLmdtYXAubWFya2Vyc19hcnJheSA9IFtdO1xyXG5cdHdpbmRvdy5hcGYuZ21hcC5pbmZvX3dpbmRvd19hcnJheSA9IFtdO1xyXG5cdGluZm93aW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdygpO1xyXG5cdC8vIExhdCB1bmQgTG5nIGluIEJlb2JMaXN0ZSBlcmfDpG56ZW5cclxuICAgIF8uZWFjaChiZW9iX2xpc3RlLnJvd3MsIGZ1bmN0aW9uKGJlb2IpIHtcclxuICAgICAgICBiZW9iLkxhdCA9IHdpbmRvdy5hcGYuQ0h0b1dHU2xhdChwYXJzZUludChiZW9iLlgpLCBwYXJzZUludChiZW9iLlkpKTtcclxuICAgICAgICBiZW9iLkxuZyA9IHdpbmRvdy5hcGYuQ0h0b1dHU2xuZyhwYXJzZUludChiZW9iLlgpLCBwYXJzZUludChiZW9iLlkpKTtcclxuICAgIH0pO1xyXG5cdC8vIFRQb3AgesOkaGxlblxyXG5cdGFuel9iZW9iID0gYmVvYl9saXN0ZS5yb3dzLmxlbmd0aDtcclxuXHQvLyBLYXJ0ZSBtYWwgYXVmIFrDvHJpY2ggemVudHJpZXJlbiwgZmFsbHMgaW4gZGVuIEJlb2JMaXN0ZS5yb3dzIGtlaW5lIEtvb3JkaW5hdGVuIGtvbW1lblxyXG5cdC8vIGF1ZiBkaWUgZGllIEthcnRlIGF1c2dlcmljaHRldCB3ZXJkZW4ga2FublxyXG5cdGxhdCA9IDQ3LjM4MzMzMztcclxuXHRsbmcgPSA4LjUzMzMzMztcclxuXHRsYXRsbmcgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxhdCwgbG5nKTtcclxuXHRvcHRpb25zID0ge1xyXG5cdFx0em9vbTogMTUsXHJcblx0XHRjZW50ZXI6IGxhdGxuZyxcclxuXHRcdHN0cmVldFZpZXdDb250cm9sOiBmYWxzZSxcclxuXHRcdG1hcFR5cGVJZDogZ29vZ2xlLm1hcHMuTWFwVHlwZUlkLlNBVEVMTElURSxcclxuXHRcdG1hcFR5cGVDb250cm9sT3B0aW9uczoge1xyXG5cdFx0XHRtYXBUeXBlSWRzOiBbXHJcblx0XHRcdGdvb2dsZS5tYXBzLk1hcFR5cGVJZC5ST0FETUFQLFxyXG5cdFx0XHRnb29nbGUubWFwcy5NYXBUeXBlSWQuVEVSUkFJTixcclxuXHRcdFx0Z29vZ2xlLm1hcHMuTWFwVHlwZUlkLlNBVEVMTElURSxcclxuXHRcdFx0Z29vZ2xlLm1hcHMuTWFwVHlwZUlkLkhZQlJJRFxyXG5cdFx0XHRdXHJcblx0XHR9XHJcblx0fTtcclxuXHRtYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZ29vZ2xlX2thcnRlbl9kaXZcIiksIG9wdGlvbnMpO1xyXG5cdHdpbmRvdy5hcGYuZ21hcC5tYXAgPSBtYXA7XHJcblx0Ym91bmRzID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZ0JvdW5kcygpO1xyXG5cdC8vIGbDvHIgYWxsZSBPcnRlIE1hcmtlciBlcnN0ZWxsZW5cclxuXHRtYXJrZXJzID0gW107XHJcbiAgICBfLmVhY2goYmVvYl9saXN0ZS5yb3dzLCBmdW5jdGlvbihiZW9iKSB7XHJcbiAgICAgICAgZGF0dW0gPSBiZW9iLkRhdHVtO1xyXG4gICAgICAgIGxhdGxuZzIgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGJlb2IuTGF0LCBiZW9iLkxuZyk7XHJcbiAgICAgICAgaWYgKGFuel9iZW9iID09PSAxKSB7XHJcbiAgICAgICAgICAgIC8vIG1hcC5maXRib3VuZHMgc2V0enQgenUgaG9oZW4gem9vbSwgd2VubiBudXIgZWluZSBCZW9iIEtvb3JkaW5hdGVuIGhhdCA+IHZlcmhpbmRlcm5cclxuICAgICAgICAgICAgbGF0bG5nID0gbGF0bG5nMjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBLYXJ0ZW5hdXNzY2huaXR0IHVtIGRpZXNlIEtvb3JkaW5hdGUgZXJ3ZWl0ZXJuXHJcbiAgICAgICAgICAgIGJvdW5kcy5leHRlbmQobGF0bG5nMik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIHRpdGxlIG11c3MgU3RyaW5nIHNlaW5cclxuICAgICAgICBpZiAoZGF0dW0pIHtcclxuICAgICAgICAgICAgdGl0ZWwgPSBkYXR1bS50b1N0cmluZygpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRpdGVsID0gXCJcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gQV9OT1RFIG11c3MgU3RyaW5nIHNlaW5cclxuICAgICAgICBpZiAoYmVvYi5BX05PVEUpIHtcclxuICAgICAgICAgICAgYV9ub3RlID0gYmVvYi5BX05PVEUudG9TdHJpbmcoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBhX25vdGUgPSBcIlwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBtYXJrZXIgPSBuZXcgTWFya2VyV2l0aExhYmVsKHtcclxuICAgICAgICAgICAgbWFwOiBtYXAsXHJcbiAgICAgICAgICAgIHBvc2l0aW9uOiBsYXRsbmcyLFxyXG4gICAgICAgICAgICB0aXRsZTogdGl0ZWwsXHJcbiAgICAgICAgICAgIGxhYmVsQ29udGVudDogYV9ub3RlLFxyXG4gICAgICAgICAgICBsYWJlbEFuY2hvcjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDc1LCAwKSxcclxuICAgICAgICAgICAgbGFiZWxDbGFzczogXCJNYXBMYWJlbFwiLFxyXG4gICAgICAgICAgICBpY29uOiBcImltZy9mbG9yYV9pY29uX3Zpb2xldHQucG5nXCJcclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyBkZW0gTWFya2VyIGVpbmVuIFR5cCB1bmQgZWluZSBpZCBnZWJlblxyXG4gICAgICAgIC8vIGRhbWl0IGRyYWcgYW5kIGRyb3AgbcO2Z2xpY2ggd2VyZGVuIHNvbGxcclxuICAgICAgICAvLyBtYXJrZXIuc2V0KFwidHlwXCIsIFwiYmVvYlwiKTtcclxuICAgICAgICAvLyBtYXJrZXIuc2V0KFwiaWRcIiwgQmVvYi5CZW9iSWQpO1xyXG4gICAgICAgIG1hcmtlci5tZXRhZGF0YSA9IHt0eXA6IFwiYmVvYl9uaWNodF9iZXVydGVpbHRcIiwgaWQ6IGJlb2IuTk9fTk9URX07XHJcbiAgICAgICAgbWFya2Vycy5wdXNoKG1hcmtlcik7XHJcbiAgICAgICAgdmFyIEF1dG9yID0gYmVvYi5BdXRvciB8fCBcIihrZWluZXIpXCI7XHJcbiAgICAgICAgdmFyIFByb2pla3QgPSBiZW9iLlBST0pFVCB8fCBcIihrZWluZXMpXCI7XHJcbiAgICAgICAgdmFyIE9ydCA9IGJlb2IuREVTQ19MT0NBTElURSB8fCBcIihrZWluZXIpXCI7XHJcbiAgICAgICAgY29udGVudFN0cmluZyA9ICc8ZGl2IGlkPVwiY29udGVudFwiPicrXHJcbiAgICAgICAgICAgICc8ZGl2IGlkPVwic2l0ZU5vdGljZVwiPicrXHJcbiAgICAgICAgICAgICc8L2Rpdj4nK1xyXG4gICAgICAgICAgICAnPGRpdiBpZD1cImJvZHlDb250ZW50XCIgY2xhc3M9XCJHbUluZm93aW5kb3dcIj4nK1xyXG4gICAgICAgICAgICAnPGgzPicgKyBkYXR1bSArICc8L2gzPicrXHJcbiAgICAgICAgICAgICc8cD5BdXRvcjogJyArIEF1dG9yICsgJzwvcD4nK1xyXG4gICAgICAgICAgICAnPHA+UHJvamVrdDogJyArIFByb2pla3QgKyAnPC9wPicrXHJcbiAgICAgICAgICAgICc8cD5PcnQ6ICcgKyBPcnQgKyAnPC9wPicrXHJcbiAgICAgICAgICAgICc8cD5Lb29yZGluYXRlbjogJyArIGJlb2IuWCArICcgLyAnICsgYmVvYi5ZICsgJzwvcD4nK1xyXG4gICAgICAgICAgICBcIjxwPjxhIGhyZWY9XFxcIiNcXFwiIG9uY2xpY2s9XFxcIndpbmRvdy5hcGYuw7ZmZm5lQmVvYignXCIgKyBiZW9iLk5PX05PVEUgKyBcIicpXFxcIj5Gb3JtdWxhciBhbnN0ZWxsZSBLYXJ0ZSDDtmZmbmVuPFxcL2E+PC9wPlwiK1xyXG4gICAgICAgICAgICBcIjxwPjxhIGhyZWY9XFxcIiNcXFwiIG9uY2xpY2s9XFxcIndpbmRvdy5hcGYuw7ZmZm5lQmVvYkluTmV1ZW1UYWIoJ1wiICsgYmVvYi5OT19OT1RFICsgXCInKVxcXCI+Rm9ybXVsYXIgaW4gbmV1ZW0gRmVuc3RlciDDtmZmbmVuPFxcL2E+PC9wPlwiK1xyXG4gICAgICAgICAgICAnPC9kaXY+JytcclxuICAgICAgICAgICAgJzwvZGl2Pic7XHJcbiAgICAgICAgbWFrZUxpc3RlbmVyKG1hcCwgbWFya2VyLCBjb250ZW50U3RyaW5nKTtcclxuICAgIH0pO1xyXG5cdG1hcmtlcl9vcHRpb25zID0ge1xyXG5cdFx0bWF4Wm9vbTogMTcsIFxyXG5cdFx0c3R5bGVzOiBbe1xyXG5cdFx0XHRcdGhlaWdodDogNTMsXHJcblx0XHRcdFx0dXJsOiBcImltZy9tNS5wbmdcIixcclxuXHRcdFx0XHR3aWR0aDogNTNcclxuXHRcdFx0fV1cclxuXHR9O1xyXG5cdG1hcmtlcl9jbHVzdGVyID0gbmV3IE1hcmtlckNsdXN0ZXJlcihtYXAsIG1hcmtlcnMsIG1hcmtlcl9vcHRpb25zKTtcclxuXHRpZiAoYW56X2Jlb2IgPT09IDEpIHtcclxuXHRcdC8vIG1hcC5maXRib3VuZHMgc2V0enQgenUgaG9oZW4gem9vbSwgd2VubiBudXIgZWluZSBCZW9iYWNodHVuZyBlcmZhc3N0IHd1cmRlID4gdmVyaGluZGVyblxyXG5cdFx0bWFwLnNldENlbnRlcihsYXRsbmcpO1xyXG5cdFx0bWFwLnNldFpvb20oMTgpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHQvLyBLYXJ0ZSBhdWYgQXVzc2Nobml0dCBhbnBhc3NlblxyXG5cdFx0bWFwLmZpdEJvdW5kcyhib3VuZHMpO1xyXG5cdH1cclxuXHQvLyBkaWVzZSBGdW5rdGlvbiBtdXNzIGhpZXIgc2VpbiwgZGFtaXQgaW5mb3dpbmRvdyBiZWthbm50IGlzdFxyXG5cdGZ1bmN0aW9uIG1ha2VMaXN0ZW5lcihtYXAsIG1hcmtlciwgY29udGVudFN0cmluZykge1xyXG5cdFx0Z29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAnY2xpY2snLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0aW5mb3dpbmRvdy5zZXRDb250ZW50KGNvbnRlbnRTdHJpbmcpO1xyXG5cdFx0XHRpbmZvd2luZG93Lm9wZW4obWFwLCBtYXJrZXIpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxud2luZG93LmFwZi5nbWFwLnplaWdlVFBvcEJlb2IgPSBmdW5jdGlvbih0cG9wX2Jlb2JfbGlzdGUpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGFuel90cG9wX2Jlb2IsXHJcbiAgICAgICAgaW5mb3dpbmRvdyxcclxuICAgICAgICBsYXQsXHJcbiAgICAgICAgbG5nLFxyXG4gICAgICAgIGxhdGxuZyxcclxuICAgICAgICBvcHRpb25zLFxyXG4gICAgICAgIG1hcCxcclxuICAgICAgICBib3VuZHMsXHJcbiAgICAgICAgbWFya2VycyxcclxuICAgICAgICBsYXRsbmcyLFxyXG4gICAgICAgIG1hcmtlcixcclxuICAgICAgICBjb250ZW50U3RyaW5nLFxyXG4gICAgICAgIG1hcmtlcl9vcHRpb25zLFxyXG4gICAgICAgIG1hcmtlcl9jbHVzdGVyLFxyXG4gICAgICAgIGRhdHVtLFxyXG4gICAgICAgIHRpdGVsO1xyXG5cdC8vIHZvciBFcm5ldWVydW5nIHplaWdlbiAtIHNvbnN0IGtsYXBwdCBXaWVkZXJhdWZydWYgbmljaHQsIHdlbm4gZGllIEthcnRlIHNjaG9uIGFuZ2V6ZWlndCBpc3RcclxuXHR3aW5kb3cuYXBmLnplaWdlRm9ybXVsYXIoXCJnb29nbGVfa2FydGVcIik7XHJcblx0d2luZG93LmFwZi5nbWFwLm1hcmtlcnNfYXJyYXkgPSBbXTtcclxuXHR3aW5kb3cuYXBmLmdtYXAuaW5mb193aW5kb3dfYXJyYXkgPSBbXTtcclxuXHRpbmZvd2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coKTtcclxuXHQvLyBUUG9wTGlzdGUgYmVhcmJlaXRlbjpcclxuXHQvLyBPYmpla3RlIGzDtnNjaGVuLCBkaWUga2VpbmUgS29vcmRpbmF0ZW4gaGFiZW5cclxuXHQvLyBMYXQgdW5kIExuZyBlcmfDpG56ZW5cclxuICAgIF8uZWFjaCh0cG9wX2Jlb2JfbGlzdGUucm93cywgZnVuY3Rpb24odHBvcF9iZW9iKSB7XHJcbiAgICAgICAgdHBvcF9iZW9iLkxhdCA9IHdpbmRvdy5hcGYuQ0h0b1dHU2xhdChwYXJzZUludCh0cG9wX2Jlb2IuWCksIHBhcnNlSW50KHRwb3BfYmVvYi5ZKSk7XHJcbiAgICAgICAgdHBvcF9iZW9iLkxuZyA9IHdpbmRvdy5hcGYuQ0h0b1dHU2xuZyhwYXJzZUludCh0cG9wX2Jlb2IuWCksIHBhcnNlSW50KHRwb3BfYmVvYi5ZKSk7XHJcbiAgICB9KTtcclxuXHQvLyBUUG9wIHrDpGhsZW5cclxuXHRhbnpfdHBvcF9iZW9iID0gdHBvcF9iZW9iX2xpc3RlLnJvd3MubGVuZ3RoO1xyXG5cdC8vIEthcnRlIG1hbCBhdWYgWsO8cmljaCB6ZW50cmllcmVuLCBmYWxscyBpbiBkZW4gVFBvcEJlb2JMaXN0ZS5yb3dzIGtlaW5lIEtvb3JkaW5hdGVuIGtvbW1lblxyXG5cdC8vIGF1ZiBkaWUgZGllIEthcnRlIGF1c2dlcmljaHRldCB3ZXJkZW4ga2FublxyXG5cdGxhdCA9IDQ3LjM4MzMzMztcclxuXHRsbmcgPSA4LjUzMzMzMztcclxuXHRsYXRsbmcgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxhdCwgbG5nKTtcclxuXHRvcHRpb25zID0ge1xyXG5cdFx0em9vbTogMTUsXHJcblx0XHRjZW50ZXI6IGxhdGxuZyxcclxuXHRcdHN0cmVldFZpZXdDb250cm9sOiBmYWxzZSxcclxuXHRcdG1hcFR5cGVJZDogZ29vZ2xlLm1hcHMuTWFwVHlwZUlkLlNBVEVMTElURSxcclxuXHRcdG1hcFR5cGVDb250cm9sT3B0aW9uczoge1xyXG5cdFx0XHRtYXBUeXBlSWRzOiBbXHJcblx0XHRcdGdvb2dsZS5tYXBzLk1hcFR5cGVJZC5ST0FETUFQLFxyXG5cdFx0XHRnb29nbGUubWFwcy5NYXBUeXBlSWQuVEVSUkFJTixcclxuXHRcdFx0Z29vZ2xlLm1hcHMuTWFwVHlwZUlkLlNBVEVMTElURSxcclxuXHRcdFx0Z29vZ2xlLm1hcHMuTWFwVHlwZUlkLkhZQlJJRFxyXG5cdFx0XHRdXHJcblx0XHR9XHJcblx0fTtcclxuXHRtYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZ29vZ2xlX2thcnRlbl9kaXZcIiksIG9wdGlvbnMpO1xyXG5cdHdpbmRvdy5hcGYuZ21hcC5tYXAgPSBtYXA7XHJcblx0Ly8gVmVyc3VjaDogU1ZPIGVpbmJsZW5kZW5cclxuXHQvL2xvYWRXTVMobWFwLCBcIi8vd21zLnpoLmNoL0Zuc1NWT1pIV01TP1wiKTtcclxuXHQvL2xvYWRXTVMobWFwLCBcIi8vd3d3Lmdpcy56aC5jaC9zY3JpcHRzL3dtc2Zuc3N2bzIuYXNwP1wiKTtcclxuXHQvLyBWZXJzdWNoOiBBViBlaW5ibGVuZGVuXHJcblx0Ly9sb2FkV01TKG1hcCwgXCIvL3dtcy56aC5jaC9hdndtcz9cIik7XHJcblx0Ym91bmRzID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZ0JvdW5kcygpO1xyXG5cdC8vIGbDvHIgYWxsZSBPcnRlIE1hcmtlciBlcnN0ZWxsZW5cclxuXHRtYXJrZXJzID0gW107XHJcbiAgICBfLmVhY2godHBvcF9iZW9iX2xpc3RlLnJvd3MsIGZ1bmN0aW9uKHRwb3BfYmVvYikge1xyXG4gICAgICAgIGRhdHVtID0gdHBvcF9iZW9iLkRhdHVtO1xyXG4gICAgICAgIGxhdGxuZzIgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHRwb3BfYmVvYi5MYXQsIHRwb3BfYmVvYi5MbmcpO1xyXG4gICAgICAgIGlmIChhbnpfdHBvcF9iZW9iID09PSAxKSB7XHJcbiAgICAgICAgICAgIC8vIG1hcC5maXRib3VuZHMgc2V0enQgenUgaG9oZW4gem9vbSwgd2VubiBudXIgZWluZSBUUG9wQmVvYiBLb29yZGluYXRlbiBoYXQgPiB2ZXJoaW5kZXJuXHJcbiAgICAgICAgICAgIGxhdGxuZyA9IGxhdGxuZzI7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gS2FydGVuYXVzc2Nobml0dCB1bSBkaWVzZSBLb29yZGluYXRlIGVyd2VpdGVyblxyXG4gICAgICAgICAgICBib3VuZHMuZXh0ZW5kKGxhdGxuZzIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyB0aXRsZSBtdXNzIFN0cmluZyBzZWluXHJcbiAgICAgICAgaWYgKGRhdHVtKSB7XHJcbiAgICAgICAgICAgIHRpdGVsID0gZGF0dW0udG9TdHJpbmcoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aXRlbCA9IFwiXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG1hcmtlciA9IG5ldyBNYXJrZXJXaXRoTGFiZWwoe1xyXG4gICAgICAgICAgICBtYXA6IG1hcCxcclxuICAgICAgICAgICAgcG9zaXRpb246IGxhdGxuZzIsXHJcbiAgICAgICAgICAgIC8vIHRpdGxlIG11c3MgU3RyaW5nIHNlaW5cclxuICAgICAgICAgICAgdGl0bGU6IHRpdGVsLFxyXG4gICAgICAgICAgICBsYWJlbENvbnRlbnQ6IHRpdGVsLFxyXG4gICAgICAgICAgICBsYWJlbEFuY2hvcjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDc1LCAwKSxcclxuICAgICAgICAgICAgbGFiZWxDbGFzczogXCJNYXBMYWJlbFwiLFxyXG4gICAgICAgICAgICBpY29uOiBcImltZy9mbG9yYV9pY29uX3Zpb2xldHQucG5nXCJcclxuICAgICAgICB9KTtcclxuICAgICAgICBtYXJrZXJzLnB1c2gobWFya2VyKTtcclxuICAgICAgICB2YXIgQXV0b3IgPSB0cG9wX2Jlb2IuQXV0b3IgfHwgXCIoa2VpbmVyKVwiO1xyXG4gICAgICAgIHZhciBQcm9qZWt0ID0gdHBvcF9iZW9iLlBST0pFVCB8fCBcIihrZWluZXMpXCI7XHJcbiAgICAgICAgdmFyIE9ydCA9IHRwb3BfYmVvYi5ERVNDX0xPQ0FMSVRFIHx8IFwiKGtlaW5lcilcIjtcclxuICAgICAgICBjb250ZW50U3RyaW5nID0gJzxkaXYgaWQ9XCJjb250ZW50XCI+JytcclxuICAgICAgICAgICAgJzxkaXYgaWQ9XCJzaXRlTm90aWNlXCI+JytcclxuICAgICAgICAgICAgJzwvZGl2PicrXHJcbiAgICAgICAgICAgICc8ZGl2IGlkPVwiYm9keUNvbnRlbnRcIiBjbGFzcz1cIkdtSW5mb3dpbmRvd1wiPicrXHJcbiAgICAgICAgICAgICc8aDM+JyArIGRhdHVtICsgJzwvaDM+JytcclxuICAgICAgICAgICAgJzxwPkF1dG9yOiAnICsgQXV0b3IgKyAnPC9wPicrXHJcbiAgICAgICAgICAgICc8cD5Qcm9qZWt0OiAnICsgUHJvamVrdCArICc8L3A+JytcclxuICAgICAgICAgICAgJzxwPk9ydDogJyArIE9ydCArICc8L3A+JytcclxuICAgICAgICAgICAgJzxwPktvb3JkaW5hdGVuOiAnICsgdHBvcF9iZW9iLlggKyAnIC8gJyArIHRwb3BfYmVvYi5ZICsgJzwvcD4nK1xyXG4gICAgICAgICAgICBcIjxwPjxhIGhyZWY9XFxcIiNcXFwiIG9uY2xpY2s9XFxcIndpbmRvdy5hcGYuw7ZmZm5lVFBvcEJlb2IoJ1wiICsgdHBvcF9iZW9iLk5PX05PVEUgKyBcIicpXFxcIj5Gb3JtdWxhciBhbnN0ZWxsZSBLYXJ0ZSDDtmZmbmVuPFxcL2E+PC9wPlwiK1xyXG4gICAgICAgICAgICBcIjxwPjxhIGhyZWY9XFxcIiNcXFwiIG9uY2xpY2s9XFxcIndpbmRvdy5hcGYuw7ZmZm5lVFBvcEJlb2JJbk5ldWVtVGFiKCdcIiArIHRwb3BfYmVvYi5OT19OT1RFICsgXCInKVxcXCI+Rm9ybXVsYXIgaW4gbmV1ZW0gRmVuc3RlciDDtmZmbmVuPFxcL2E+PC9wPlwiK1xyXG4gICAgICAgICAgICAnPC9kaXY+JytcclxuICAgICAgICAgICAgJzwvZGl2Pic7XHJcbiAgICAgICAgbWFrZUxpc3RlbmVyKG1hcCwgbWFya2VyLCBjb250ZW50U3RyaW5nKTtcclxuICAgIH0pO1xyXG5cdG1hcmtlcl9vcHRpb25zID0ge1xyXG5cdFx0bWF4Wm9vbTogMTcsIFxyXG5cdFx0c3R5bGVzOiBbe1xyXG5cdFx0XHRcdGhlaWdodDogNTMsXHJcblx0XHRcdFx0dXJsOiBcImltZy9tNS5wbmdcIixcclxuXHRcdFx0XHR3aWR0aDogNTNcclxuXHRcdFx0fV1cclxuXHR9O1xyXG5cdG1hcmtlcl9jbHVzdGVyID0gbmV3IE1hcmtlckNsdXN0ZXJlcihtYXAsIG1hcmtlcnMsIG1hcmtlcl9vcHRpb25zKTtcclxuXHRpZiAoYW56X3Rwb3BfYmVvYiA9PT0gMSkge1xyXG5cdFx0Ly8gbWFwLmZpdGJvdW5kcyBzZXR6dCB6dSBob2hlbiB6b29tLCB3ZW5uIG51ciBlaW5lIEJlb2JhY2h0dW5nIGVyZmFzc3Qgd3VyZGUgPiB2ZXJoaW5kZXJuXHJcblx0XHRtYXAuc2V0Q2VudGVyKGxhdGxuZyk7XHJcblx0XHRtYXAuc2V0Wm9vbSgxOCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vIEthcnRlIGF1ZiBBdXNzY2huaXR0IGFucGFzc2VuXHJcblx0XHRtYXAuZml0Qm91bmRzKGJvdW5kcyk7XHJcblx0fVxyXG5cdC8vIGRpZXNlIEZ1bmt0aW9uIG11c3MgaGllciBzZWluLCBkYW1pdCBpbmZvd2luZG93IGJla2FubnQgaXN0XHJcblx0ZnVuY3Rpb24gbWFrZUxpc3RlbmVyKG1hcCwgbWFya2VyLCBjb250ZW50U3RyaW5nKSB7XHJcblx0XHRnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRpbmZvd2luZG93LnNldENvbnRlbnQoY29udGVudFN0cmluZyk7XHJcblx0XHRcdGluZm93aW5kb3cub3BlbihtYXAsIG1hcmtlcik7XHJcblx0XHR9KTtcclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLmdtYXAudmVyb3J0ZVRQb3AgPSBmdW5jdGlvbih0cG9wKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBpbmZvd2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coKSxcclxuICAgICAgICBsYXQsXHJcbiAgICAgICAgbG5nLFxyXG4gICAgICAgIGxhdGxuZyxcclxuICAgICAgICB6b29tX2xldmVsLFxyXG4gICAgICAgIG9wdGlvbnMsXHJcbiAgICAgICAgbWFwLFxyXG4gICAgICAgIG1hcF9jYW52YXMgPSAkKCcjZ29vZ2xlX2thcnRlbl9kaXYnKSxcclxuICAgICAgICB2ZXJvcnRlZCxcclxuICAgICAgICBtYXJrZXIsXHJcbiAgICAgICAgY29udGVudF9zdHJpbmcsXHJcbiAgICAgICAgdHBvcF9iZXNjaHJpZnR1bmcsXHJcbiAgICAgICAgbXlfZmx1cm5hbWU7XHJcbiAgICB3aW5kb3cuYXBmLmdtYXAubWFya2Vyc19hcnJheSA9IFtdO1xyXG5cclxuXHQvLyB2b3IgRXJuZXVlcnVuZyB6ZWlnZW4gLSBzb25zdCBrbGFwcHQgV2llZGVyYXVmcnVmIG5pY2h0LCB3ZW5uIGRpZSBLYXJ0ZSBzY2hvbiBhbmdlemVpZ3QgaXN0XHJcblx0d2luZG93LmFwZi56ZWlnZUZvcm11bGFyKFwiZ29vZ2xlX2thcnRlXCIpO1xyXG5cclxuICAgIC8vIE9wdGlvbmVuIGbDvHIgZGllIEFuemVpZ2VcclxuXHRpZiAodHBvcCAmJiB0cG9wLlRQb3BYS29vcmQgJiYgdHBvcC5UUG9wWUtvb3JkKSB7XHJcblx0XHQvLyBXZW5uIEtvb3JkaW5hdGVuIHZvcmhhbmRlbiwgTGF0IHVuZCBMbmcgZXJnw6RuemVuXHJcblx0XHRsYXQgPSB3aW5kb3cuYXBmLkNIdG9XR1NsYXQocGFyc2VJbnQodHBvcC5UUG9wWEtvb3JkKSwgcGFyc2VJbnQodHBvcC5UUG9wWUtvb3JkKSk7XHJcblx0XHRsbmcgPSB3aW5kb3cuYXBmLkNIdG9XR1NsbmcocGFyc2VJbnQodHBvcC5UUG9wWEtvb3JkKSwgcGFyc2VJbnQodHBvcC5UUG9wWUtvb3JkKSk7XHJcblx0XHR6b29tX2xldmVsID0gMTU7XHJcblx0XHR2ZXJvcnRlZCA9IHRydWU7XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vIHNvbnN0IGF1ZiBaw7xyaWNoIHplbnRyaWVyZW5cclxuXHRcdGxhdCA9IDQ3LjM2MDU2NjtcclxuXHRcdGxuZyA9IDguNTQyODI5O1xyXG5cdFx0em9vbV9sZXZlbCA9IDEyO1xyXG5cdFx0dmVyb3J0ZWQgPSBmYWxzZTtcclxuXHR9XHJcblx0bGF0bG5nID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhsYXQsIGxuZyk7XHJcblx0b3B0aW9ucyA9IHtcclxuXHRcdHpvb206IHpvb21fbGV2ZWwsXHJcblx0XHRjZW50ZXI6IGxhdGxuZyxcclxuXHRcdHN0cmVldFZpZXdDb250cm9sOiBmYWxzZSxcclxuXHRcdG1hcFR5cGVJZDogZ29vZ2xlLm1hcHMuTWFwVHlwZUlkLlNBVEVMTElURVxyXG5cdH07XHJcblxyXG4gICAgLy8gS2FydGUgZ3LDvG5kZW5cclxuXHRtYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKG1hcF9jYW52YXNbMF0sIG9wdGlvbnMpO1xyXG5cdHdpbmRvdy5hcGYuZ21hcC5tYXAgPSBtYXA7XHJcblxyXG5cdGlmICh2ZXJvcnRlZCkge1xyXG4gICAgICAgIC8vIG1hcmtlciBlcnN0ZWxsZW5cclxuXHRcdHRwb3BfYmVzY2hyaWZ0dW5nID0gd2luZG93LmFwZi5iZXNjaHJpZnRlVFBvcE1pdE5yRsO8ckthcnRlKHRwb3AuUG9wTnIsIHRwb3AuVFBvcE5yKTtcclxuXHRcdG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xyXG5cdFx0XHRwb3NpdGlvbjogbGF0bG5nLCBcclxuXHRcdFx0bWFwOiBtYXAsXHJcblx0XHRcdHRpdGxlOiB0cG9wX2Jlc2NocmlmdHVuZyxcclxuXHRcdFx0aWNvbjogXCJpbWcvZmxvcmFfaWNvbl9yb3QucG5nXCIsXHJcblx0XHRcdGRyYWdnYWJsZTogdHJ1ZVxyXG5cdFx0fSk7XHJcblx0XHQvLyBNYXJrZXIgaW4gQXJyYXkgc3BlaWNoZXJuLCBkYW1pdCBlciBnZWzDtnNjaHQgd2VyZGVuIGthbm5cclxuXHRcdHdpbmRvdy5hcGYuZ21hcC5tYXJrZXJzX2FycmF5LnB1c2gobWFya2VyKTtcclxuXHJcbiAgICAgICAgLy8gaW5mb3dpbmRvdyBlcnN0ZWxsZW5cclxuXHRcdG15X2ZsdXJuYW1lID0gdHBvcC5UUG9wRmx1cm5hbWUgfHwgJyhrZWluIEZsdXJuYW1lKSc7XHJcblx0XHRjb250ZW50X3N0cmluZyA9ICc8ZGl2IGlkPVwiY29udGVudFwiPicrXHJcblx0XHRcdCc8ZGl2IGlkPVwic2l0ZU5vdGljZVwiPicrXHJcblx0XHRcdCc8L2Rpdj4nK1xyXG5cdFx0XHQnPGRpdiBpZD1cImJvZHlDb250ZW50XCIgY2xhc3M9XCJHbUluZm93aW5kb3dcIj4nK1xyXG5cdFx0XHQnPGgzPicgKyBteV9mbHVybmFtZSArICc8L2gzPicrXHJcblx0XHRcdCc8cD5Lb29yZGluYXRlbjogJyArIHRwb3AuVFBvcFhLb29yZCArICcgLyAnICsgdHBvcC5UUG9wWUtvb3JkICsgJzwvcD4nK1xyXG5cdFx0XHRcIjxwPjxhIGhyZWY9XFxcIiNcXFwiIG9uY2xpY2s9XFxcIndpbmRvdy5hcGYuw7ZmZm5lVFBvcCgnXCIgKyB0cG9wLlRQb3BJZCArIFwiJylcXFwiPkZvcm11bGFyIGFuc3RlbGxlIEthcnRlIMO2ZmZuZW48XFwvYT48L3A+XCIrXHJcbiAgICAgICAgICAgICc8cD48YSBocmVmPVwiI1wiIG9uY2xpY2s9XFxcIndpbmRvdy5hcGYuw7ZmZm5lRm9ybXVsYXJBbHNQb3B1cChcXCd0cG9wXFwnLCAnICsgdHBvcC5UUG9wSWQgKyAnKVxcXCI+Rm9ybXVsYXIgbmViZW4gZGVyIEthcnRlIMO2ZmZuZW48XFwvYT48L3A+JytcclxuXHRcdFx0XCI8cD48YSBocmVmPVxcXCIjXFxcIiBvbmNsaWNrPVxcXCJ3aW5kb3cuYXBmLsO2ZmZuZVRQb3BJbk5ldWVtVGFiKCdcIiArIHRwb3AuVFBvcElkICsgXCInKVxcXCI+Rm9ybXVsYXIgaW4gbmV1ZW0gRmVuc3RlciDDtmZmbmVuPFxcL2E+PC9wPlwiK1xyXG5cdFx0XHQnPC9kaXY+JytcclxuXHRcdFx0JzwvZGl2Pic7XHJcblx0XHRpbmZvd2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coe1xyXG5cdFx0XHRjb250ZW50OiBjb250ZW50X3N0cmluZ1xyXG5cdFx0fSk7XHJcblx0XHRpZiAoIXdpbmRvdy5hcGYuZ21hcC5pbmZvX3dpbmRvd19hcnJheSkge1xyXG5cdFx0XHR3aW5kb3cuYXBmLmdtYXAuaW5mb193aW5kb3dfYXJyYXkgPSBbXTtcclxuXHRcdH1cclxuXHRcdHdpbmRvdy5hcGYuZ21hcC5pbmZvX3dpbmRvd19hcnJheS5wdXNoKGluZm93aW5kb3cpO1xyXG5cclxuXHRcdGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdGluZm93aW5kb3cub3BlbihtYXAsIG1hcmtlcik7XHJcblx0XHR9KTtcclxuXHRcdGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgXCJkcmFnZW5kXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcblx0XHRcdHdpbmRvdy5hcGYuZ21hcC5TZXRMb2NhdGlvblRQb3AoZXZlbnQubGF0TG5nLCBtYXAsIG1hcmtlciwgdHBvcCk7XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG4gICAgLy8gbGlzdGVuZXIgYmVpIGtsaWNrIGluIEthcnRlXHJcbiAgICAvLyBlbnRmZXJudCBiZXN0ZWhlbmRlbiBtYXJrZXIsIGVyc3RlbGx0IG5ldWVuIHVuZCBha3R1YWxpc2llcnQgS29vcmRpbmF0ZW5cclxuXHRnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXAsICdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcblx0XHR3aW5kb3cuYXBmLmdtYXAuZXJzdGVsbGVNYXJrZXIoZXZlbnQubGF0TG5nLCBtYXAsIG1hcmtlciwgdHBvcCk7XHJcblx0fSk7XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLmdtYXAuZXJzdGVsbGVNYXJrZXIgPSBmdW5jdGlvbihsb2NhdGlvbiwgbWFwLCBtYXJrZXIsIHRwb3ApIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIHRpdGxlO1xyXG5cclxuXHQvLyB0aXRsZSBtdXNzIFN0cmluZyBzZWluXHJcblx0aWYgKHRwb3AgJiYgdHBvcC5UUG9wRmx1cm5hbWUpIHtcclxuXHRcdHRpdGxlID0gdHBvcC5UUG9wRmx1cm5hbWU7XHJcblx0fSBlbHNlIHtcclxuXHRcdHRpdGxlID0gXCJuZXVlIFRlaWxwb3B1bGF0aW9uXCI7XHJcblx0fVxyXG5cdC8vIHp1ZXJzdCBiaXNoZXJpZ2VuIE1hcmtlciBsw7ZzY2hlblxyXG5cdHdpbmRvdy5hcGYuZ21hcC5jbGVhck1hcmtlcnMoKTtcclxuXHR2YXIgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XHJcblx0XHRwb3NpdGlvbjogbG9jYXRpb24sIFxyXG5cdFx0bWFwOiBtYXAsXHJcblx0XHR0aXRsZTogdGl0bGUsXHJcblx0XHRpY29uOiBcImltZy9mbG9yYV9pY29uX3JvdC5wbmdcIixcclxuXHRcdGRyYWdnYWJsZTogdHJ1ZVxyXG5cdH0pO1xyXG5cdC8vIE1hcmtlciBpbiBBcnJheSBzcGVpY2hlcm4sIGRhbWl0IGVyIGdlbMO2c2NodCB3ZXJkZW4ga2FublxyXG5cdHdpbmRvdy5hcGYuZ21hcC5tYXJrZXJzX2FycmF5LnB1c2gobWFya2VyKTtcclxuXHRnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsIFwiZHJhZ2VuZFwiLCBmdW5jdGlvbihldmVudCkge1xyXG5cdFx0d2luZG93LmFwZi5nbWFwLlNldExvY2F0aW9uVFBvcChldmVudC5sYXRMbmcsIG1hcCwgbWFya2VyLCB0cG9wKTtcclxuXHR9KTtcclxuXHR3aW5kb3cuYXBmLmdtYXAuU2V0TG9jYXRpb25UUG9wKGxvY2F0aW9uLCBtYXAsIG1hcmtlcik7XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLmdtYXAuU2V0TG9jYXRpb25UUG9wID0gZnVuY3Rpb24oTGF0TG5nLCBtYXAsIG1hcmtlciwgVFBvcCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgbGF0LFxyXG5cdFx0bG5nLFxyXG5cdFx0Y29udGVudFN0cmluZyxcclxuXHRcdGluZm93aW5kb3csXHJcblx0XHRPYmpla3QsXHJcblx0XHR0aXRsZSxcclxuXHRcdFgsXHJcblx0XHRZO1xyXG5cdC8vIG51ciBha3R1YWxpc2llcmVuLCB3ZW5uIFNjaHJlaWJyZWNodGUgYmVzdGVoZW5cclxuXHRpZiAoIXdpbmRvdy5hcGYucHLDvGZlU2NocmVpYnZvcmF1c3NldHp1bmdlbigpKSB7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cdGlmIChUUG9wICYmIFRQb3AuVFBvcEZsdXJuYW1lKSB7XHJcblx0XHR0aXRsZSA9IFRQb3AuVFBvcEZsdXJuYW1lO1xyXG5cdH0gZWxzZSB7XHJcblx0XHR0aXRsZSA9IFwibmV1ZSBUZWlscG9wdWxhdGlvblwiO1xyXG5cdH1cclxuXHRsYXQgPSBMYXRMbmcubGF0KCk7XHJcblx0bG5nID0gTGF0TG5nLmxuZygpO1xyXG5cdFggPSB3aW5kb3cuYXBmLkRkSW5DaFkobGF0LCBsbmcpO1xyXG5cdFkgPSB3aW5kb3cuYXBmLkRkSW5DaFgobGF0LCBsbmcpO1xyXG5cdHZhciB1cGRhdGVUUG9wXzMgPSAkLmFqYXgoe1xyXG5cdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0dXJsOiAncGhwL3Rwb3BfdXBkYXRlLnBocCcsXHJcblx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0ZGF0YToge1xyXG5cdFx0XHRcImlkXCI6IGxvY2FsU3RvcmFnZS50cG9wX2lkLFxyXG5cdFx0XHRcIkZlbGRcIjogXCJUUG9wWEtvb3JkXCIsXHJcblx0XHRcdFwiV2VydFwiOiBYLFxyXG5cdFx0XHRcInVzZXJcIjogc2Vzc2lvblN0b3JhZ2UuVXNlclxyXG5cdFx0fVxyXG5cdH0pO1xyXG5cdHVwZGF0ZVRQb3BfMy5hbHdheXMoZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgdXBkYXRlVFBvcF80ID0gJC5hamF4KHtcclxuXHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHR1cmw6ICdwaHAvdHBvcF91cGRhdGUucGhwJyxcclxuXHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFwiaWRcIjogbG9jYWxTdG9yYWdlLnRwb3BfaWQsXHJcblx0XHRcdFx0XCJGZWxkXCI6IFwiVFBvcFlLb29yZFwiLFxyXG5cdFx0XHRcdFwiV2VydFwiOiBZLFxyXG5cdFx0XHRcdFwidXNlclwiOiBzZXNzaW9uU3RvcmFnZS5Vc2VyXHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0dXBkYXRlVFBvcF80LmFsd2F5cyhmdW5jdGlvbigpIHtcclxuXHRcdFx0d2luZG93LmFwZi5nbWFwLmNsZWFySW5mb1dpbmRvd3MoKTtcclxuXHRcdFx0Y29udGVudFN0cmluZyA9ICc8ZGl2IGlkPVwiY29udGVudFwiPicrXHJcblx0XHRcdFx0JzxkaXYgaWQ9XCJzaXRlTm90aWNlXCI+JytcclxuXHRcdFx0XHQnPC9kaXY+JytcclxuXHRcdFx0XHQnPGRpdiBpZD1cImJvZHlDb250ZW50XCIgY2xhc3M9XCJHbUluZm93aW5kb3dcIj4nK1xyXG5cdFx0XHRcdCc8aDM+JyArIHRpdGxlICsgJzwvaDM+JytcclxuXHRcdFx0XHQnPHA+S29vcmRpbmF0ZW46ICcgKyBYICsgJyAvICcgKyBZICsgJzwvcD4nK1xyXG5cdFx0XHRcdFwiPHA+PGEgaHJlZj1cXFwiI1xcXCIgb25jbGljaz1cXFwid2luZG93LmFwZi7DtmZmbmVUUG9wKCdcIiArIGxvY2FsU3RvcmFnZS50cG9wX2lkICsgXCInKVxcXCI+Rm9ybXVsYXIgYW5zdGVsbGUgS2FydGUgw7ZmZm5lbjxcXC9hPjwvcD5cIitcclxuICAgICAgICAgICAgICAgICc8cD48YSBocmVmPVwiI1wiIG9uY2xpY2s9XFxcIndpbmRvdy5hcGYuw7ZmZm5lRm9ybXVsYXJBbHNQb3B1cChcXCd0cG9wXFwnLCAnICsgbG9jYWxTdG9yYWdlLnRwb3BfaWQgKyAnKVxcXCI+Rm9ybXVsYXIgbmViZW4gZGVyIEthcnRlIMO2ZmZuZW48XFwvYT48L3A+JytcclxuXHRcdFx0XHRcIjxwPjxhIGhyZWY9XFxcIiNcXFwiIG9uY2xpY2s9XFxcIndpbmRvdy5hcGYuw7ZmZm5lVFBvcEluTmV1ZW1UYWIoJ1wiICsgbG9jYWxTdG9yYWdlLnRwb3BfaWQgKyBcIicpXFxcIj5Gb3JtdWxhciBpbiBuZXVlbSBGZW5zdGVyIMO2ZmZuZW48XFwvYT48L3A+XCIrXHJcblx0XHRcdFx0JzwvZGl2PicrXHJcblx0XHRcdFx0JzwvZGl2Pic7XHJcblx0XHRcdGluZm93aW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdyh7XHJcblx0XHRcdFx0Y29udGVudDogY29udGVudFN0cmluZ1xyXG5cdFx0XHR9KTtcclxuXHRcdFx0aWYgKCF3aW5kb3cuYXBmLmdtYXAuaW5mb193aW5kb3dfYXJyYXkpIHtcclxuXHRcdFx0XHR3aW5kb3cuYXBmLmdtYXAuaW5mb193aW5kb3dfYXJyYXkgPSBbXTtcclxuXHRcdFx0fVxyXG5cdFx0XHR3aW5kb3cuYXBmLmdtYXAuaW5mb193aW5kb3dfYXJyYXkucHVzaChpbmZvd2luZG93KTtcclxuXHRcdFx0Z29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAnY2xpY2snLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRpbmZvd2luZG93Lm9wZW4obWFwLCBtYXJrZXIpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cdFx0dXBkYXRlVFBvcF80LmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogRGllIFktS29vcmRpbmF0ZSB3dXJkZSBuaWNodCDDvGJlcm5vbW1lbiAoZGllIFgtS29vcmRpbmF0ZSBvZmZlbmJhciBzY2hvbilcIik7XHJcblx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IERpZSBZLUtvb3JkaW5hdGUgd3VyZGUgbmljaHQgw7xiZXJub21tZW4gKGRpZSBYLUtvb3JkaW5hdGUgb2ZmZW5iYXIgc2Nob24pJyk7XHJcblx0XHR9KTtcclxuXHR9KTtcclxuXHR1cGRhdGVUUG9wXzMuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogRGllIEtvb3JkaW5hdGVuIHd1cmRlbiBuaWNodCDDvGJlcm5vbW1lblwiKTtcclxuXHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IERpZSBLb29yZGluYXRlbiB3dXJkZW4gbmljaHQgw7xiZXJub21tZW4nKTtcclxuXHR9KTtcclxufTtcclxuXHJcbi8vIEdvb2dsZU1hcDogYWxsZSBNYXJrZXIgbMO2c2NoZW5cclxuLy8gYmVudXR6dCB3byBpbiBHb29nbGVNYXBzIE1hcmtlciBnZXNldHp0IHVuZCB2ZXJzY2hvYmVuIHdlcmRlblxyXG53aW5kb3cuYXBmLmdtYXAuY2xlYXJNYXJrZXJzID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG4gICAgXy5lYWNoKHdpbmRvdy5hcGYuZ21hcC5tYXJrZXJzX2FycmF5LCBmdW5jdGlvbihtYXJrZXIpIHtcclxuICAgICAgICBtYXJrZXIuc2V0TWFwKG51bGwpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG4vLyBHb29nbGVNYXA6IGFsbGUgSW5mb1dpbmRvd3MgbMO2c2NoZW5cclxuLy8gYmVudXR6dCB3byBpbiBHb29nbGVNYXBzIEluZm93aW5kb3dzIG5ldSBnZXNldHp0IHdlcmRlbiBtw7xzc2VuLCB3ZWlsIGRpZSBEYXRlbiB2ZXLDpG5kZXJ0IHd1cmRlblxyXG53aW5kb3cuYXBmLmdtYXAuY2xlYXJJbmZvV2luZG93cyA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuICAgIF8uZWFjaCh3aW5kb3cuYXBmLmdtYXAuaW5mb193aW5kb3dfYXJyYXksIGZ1bmN0aW9uKGluZm9fd2luZG93KSB7XHJcbiAgICAgICAgaW5mb193aW5kb3cuc2V0TWFwKG51bGwpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLsO2ZmZuZVRQb3AgPSBmdW5jdGlvbih0cG9wX2lkKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS50cG9wX2lkID0gdHBvcF9pZDtcclxuXHQkLmpzdHJlZS5fcmVmZXJlbmNlKFwiW3R5cD0ndHBvcCddI1wiICsgdHBvcF9pZCkuZGVzZWxlY3RfYWxsKCk7XHJcblx0JChcIiN0cmVlXCIpLmpzdHJlZShcInNlbGVjdF9ub2RlXCIsIFwiW3R5cD0ndHBvcCddI1wiICsgdHBvcF9pZCk7XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLsO2ZmZuZVRQb3BJbk5ldWVtVGFiID0gZnVuY3Rpb24odHBvcF9pZCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR3aW5kb3cub3BlbihcImluZGV4Lmh0bWw/YXA9XCIrbG9jYWxTdG9yYWdlLmFwX2lkK1wiJnBvcD1cIiArIGxvY2FsU3RvcmFnZS5wb3BfaWQrXCImdHBvcD1cIit0cG9wX2lkLCBcIl9ibGFua1wiKTtcclxufTtcclxuXHJcbndpbmRvdy5hcGYuw7ZmZm5lUG9wID0gZnVuY3Rpb24ocG9wX2lkKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS5wb3BfaWQgPSBwb3BfaWQ7XHJcblx0JC5qc3RyZWUuX3JlZmVyZW5jZShcIlt0eXA9J3BvcCddI1wiICsgcG9wX2lkKS5kZXNlbGVjdF9hbGwoKTtcclxuXHQkKFwiI3RyZWVcIikuanN0cmVlKFwic2VsZWN0X25vZGVcIiwgXCJbdHlwPSdwb3AnXSNcIiArIHBvcF9pZCk7XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLsO2ZmZuZVBvcEluTmV1ZW1UYWIgPSBmdW5jdGlvbihwb3BfaWQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0d2luZG93Lm9wZW4oXCJpbmRleC5odG1sP2FwPVwiK2xvY2FsU3RvcmFnZS5hcF9pZCtcIiZwb3A9XCIgKyBwb3BfaWQsIFwiX2JsYW5rXCIpO1xyXG59O1xyXG5cclxud2luZG93LmFwZi7DtmZmbmVCZW9iID0gZnVuY3Rpb24oYmVvYl9pZCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuYmVvYl9pZCA9IGJlb2JfaWQ7XHJcblx0JC5qc3RyZWUuX3JlZmVyZW5jZShcIlt0eXA9J2Jlb2JfbmljaHRfYmV1cnRlaWx0J10jYmVvYlwiICsgYmVvYl9pZCkuZGVzZWxlY3RfYWxsKCk7XHJcblx0JChcIiN0cmVlXCIpLmpzdHJlZShcInNlbGVjdF9ub2RlXCIsIFwiW3R5cD0nYmVvYl9uaWNodF9iZXVydGVpbHQnXSNiZW9iXCIgKyBiZW9iX2lkKTtcclxufTtcclxuXHJcbndpbmRvdy5hcGYuw7ZmZm5lQmVvYkluTmV1ZW1UYWIgPSBmdW5jdGlvbihiZW9iX2lkKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHdpbmRvdy5vcGVuKFwiaW5kZXguaHRtbD9hcD1cIitsb2NhbFN0b3JhZ2UuYXBfaWQrXCImYmVvYl9uaWNodF9iZXVydGVpbHQ9XCIgKyBiZW9iX2lkLCBcIl9ibGFua1wiKTtcclxufTtcclxuXHJcbndpbmRvdy5hcGYuw7ZmZm5lVFBvcEJlb2IgPSBmdW5jdGlvbihiZW9iX2lkKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS5iZW9iX2lkID0gYmVvYl9pZDtcclxuXHQkLmpzdHJlZS5fcmVmZXJlbmNlKFwiW3R5cD0nYmVvYl96dWdlb3JkbmV0J10jYmVvYlwiICsgYmVvYl9pZCkuZGVzZWxlY3RfYWxsKCk7XHJcblx0JChcIiN0cmVlXCIpLmpzdHJlZShcInNlbGVjdF9ub2RlXCIsIFwiW3R5cD0nYmVvYl96dWdlb3JkbmV0J10jYmVvYlwiICsgYmVvYl9pZCk7XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLsO2ZmZuZVRQb3BCZW9iSW5OZXVlbVRhYiA9IGZ1bmN0aW9uKGJlb2JfaWQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0d2luZG93Lm9wZW4oXCJpbmRleC5odG1sP2FwPVwiK2xvY2FsU3RvcmFnZS5hcF9pZCtcIiZiZW9iX25pY2h0X2JldXJ0ZWlsdD1cIiArIGJlb2JfaWQsIFwiX2JsYW5rXCIpO1xyXG59O1xyXG5cclxuXHJcblxyXG5cclxuXHJcbi8qIFxyXG5cdERvY3VtZW50ICAgOiB3bXMuanNcclxuXHRDcmVhdGVkIG9uIDogRmViIDE2LCAyMDExLCAzOjI1OjI3IFBNXHJcblx0QXV0aG9yXHQgOiBcIkdhdmluIEphY2tzb24gPEdhdmluLkphY2tzb25AY3Npcm8uYXU+XCJcclxuXHJcblx0UmVmYWN0b3JlZCBjb2RlIGZyb20gLy9seWNldW0ubWFzc2dpcy5zdGF0ZS5tYS51cy93aWtpL2Rva3UucGhwP2lkPWdvb2dsZW1hcHN2Mzpob21lXHJcblxyXG5cdGV4YW1wbGU6IGxvYWRXTVMobWFwLCBcIi8vc3BhdGlhbC5hbGEub3JnLmF1L2dlb3NlcnZlci93bXM/XCIsIGN1c3RvbVBhcmFtcyk7XHJcblxyXG5cdFlvdSBjYW4gZWFzaWx5IGFkZCBhIFdNUyBvdmVybGF5IGJ5IGNhbGxpbmcgdGhlIGxvYWRXTVMobWFwLCBiYXNlVVJMLCBjdXN0b21QYXJhbXMpIGZ1bmN0aW9uLCB3aGVyZTpcclxuXHJcblx0bWFwIC0gaXMgYW4gaW5zdGFuY2Ugb2YgR29vZ2xlLm1hcHMuTWFwXHJcblx0YmFzZVVSTCAtIGlzIHRoZSBiYXNlIFVSTCBvZiB5b3VyIFdNUyBzZXJ2ZXIgKGVnIGdlb3NlcnZlcilcclxuXHRjdXN0b21QYXJhbXMgLSBBZGRpdGlvbmFsIFdNUyBwYXJhbWV0ZXJzXHJcbiovXHJcblxyXG5mdW5jdGlvbiBib3VuZCh2YWx1ZSwgb3B0X21pbiwgb3B0X21heCkge1xyXG5cdGlmIChvcHRfbWluICE9IG51bGwpIHZhbHVlID0gTWF0aC5tYXgodmFsdWUsIG9wdF9taW4pO1xyXG5cdGlmIChvcHRfbWF4ICE9IG51bGwpIHZhbHVlID0gTWF0aC5taW4odmFsdWUsIG9wdF9tYXgpO1xyXG5cdHJldHVybiB2YWx1ZTtcclxufVxyXG5cclxuZnVuY3Rpb24gZGVncmVlc1RvUmFkaWFucyhkZWcpIHtcclxuXHRyZXR1cm4gZGVnICogKE1hdGguUEkgLyAxODApO1xyXG59XHJcblxyXG5mdW5jdGlvbiByYWRpYW5zVG9EZWdyZWVzKHJhZCkge1xyXG5cdHJldHVybiByYWQgLyAoTWF0aC5QSSAvIDE4MCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIE1lcmNhdG9yUHJvamVjdGlvbigpIHtcclxuXHR2YXIgTUVSQ0FUT1JfUkFOR0UgPSAyNTY7XHJcblx0dGhpcy5waXhlbE9yaWdpbl8gPSBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoXHJcblx0XHRNRVJDQVRPUl9SQU5HRSAvIDIsIE1FUkNBVE9SX1JBTkdFIC8gMik7XHJcblx0dGhpcy5waXhlbHNQZXJMb25EZWdyZWVfID0gTUVSQ0FUT1JfUkFOR0UgLyAzNjA7XHJcblx0dGhpcy5waXhlbHNQZXJMb25SYWRpYW5fID0gTUVSQ0FUT1JfUkFOR0UgLyAoMiAqIE1hdGguUEkpO1xyXG59XHJcblxyXG5NZXJjYXRvclByb2plY3Rpb24ucHJvdG90eXBlLmZyb21MYXRMbmdUb1BvaW50ID0gZnVuY3Rpb24obGF0TG5nLCBvcHRfcG9pbnQpIHtcclxuXHR2YXIgbWUgPSB0aGlzLFxyXG5cdFx0cG9pbnQgPSBvcHRfcG9pbnQgfHwgbmV3IGdvb2dsZS5tYXBzLlBvaW50KDAsIDApLFxyXG5cdFx0b3JpZ2luID0gbWUucGl4ZWxPcmlnaW5fO1xyXG5cdHBvaW50LnggPSBvcmlnaW4ueCArIGxhdExuZy5sbmcoKSAqIG1lLnBpeGVsc1BlckxvbkRlZ3JlZV87XHJcblx0Ly8gTk9URShhcHBsZXRvbik6IFRydW5jYXRpbmcgdG8gMC45OTk5IGVmZmVjdGl2ZWx5IGxpbWl0cyBsYXRpdHVkZSB0b1xyXG5cdC8vIDg5LjE4OS4gIFRoaXMgaXMgYWJvdXQgYSB0aGlyZCBvZiBhIHRpbGUgcGFzdCB0aGUgZWRnZSBvZiB0aGUgd29ybGQgdGlsZS5cclxuXHR2YXIgc2lueSA9IGJvdW5kKE1hdGguc2luKGRlZ3JlZXNUb1JhZGlhbnMobGF0TG5nLmxhdCgpKSksIC0wLjk5OTksIDAuOTk5OSk7XHJcblx0cG9pbnQueSA9IG9yaWdpbi55ICsgMC41ICogTWF0aC5sb2coKDEgKyBzaW55KSAvICgxIC0gc2lueSkpICogLW1lLnBpeGVsc1BlckxvblJhZGlhbl87XHJcblx0cmV0dXJuIHBvaW50O1xyXG59O1xyXG5cclxuTWVyY2F0b3JQcm9qZWN0aW9uLnByb3RvdHlwZS5mcm9tRGl2UGl4ZWxUb0xhdExuZyA9IGZ1bmN0aW9uKHBpeGVsLCB6b29tKSB7XHJcblx0dmFyIG1lID0gdGhpcyxcclxuXHRcdG9yaWdpbiA9IG1lLnBpeGVsT3JpZ2luXyxcclxuXHRcdHNjYWxlID0gTWF0aC5wb3coMiwgem9vbSksXHJcblx0XHRsbmcgPSAocGl4ZWwueCAvIHNjYWxlIC0gb3JpZ2luLngpIC8gbWUucGl4ZWxzUGVyTG9uRGVncmVlXyxcclxuXHRcdGxhdFJhZGlhbnMgPSAocGl4ZWwueSAvIHNjYWxlIC0gb3JpZ2luLnkpIC8gLW1lLnBpeGVsc1BlckxvblJhZGlhbl8sXHJcblx0XHRsYXQgPSByYWRpYW5zVG9EZWdyZWVzKDIgKiBNYXRoLmF0YW4oTWF0aC5leHAobGF0UmFkaWFucykpIC0gTWF0aC5QSSAvIDIpO1xyXG5cdHJldHVybiBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxhdCwgbG5nKTtcclxufTtcclxuXHJcbk1lcmNhdG9yUHJvamVjdGlvbi5wcm90b3R5cGUuZnJvbURpdlBpeGVsVG9TcGhlcmljYWxNZXJjYXRvciA9IGZ1bmN0aW9uKHBpeGVsLCB6b29tKSB7XHJcblx0dmFyIG1lID0gdGhpcyxcclxuXHRcdGNvb3JkID0gbWUuZnJvbURpdlBpeGVsVG9MYXRMbmcocGl4ZWwsIHpvb20pLFxyXG5cdFx0ciA9IDYzNzgxMzcuMCxcclxuXHRcdHggPSByICogZGVncmVlc1RvUmFkaWFucyhjb29yZC5sbmcoKSksXHJcblx0XHRsYXRSYWQgPSBkZWdyZWVzVG9SYWRpYW5zKGNvb3JkLmxhdCgpKSxcclxuXHRcdHkgPSAociAvIDIpICogTWF0aC5sb2coKDEgKyBNYXRoLnNpbihsYXRSYWQpKSAvICgxIC0gTWF0aC5zaW4obGF0UmFkKSkpO1xyXG5cdHJldHVybiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoeCx5KTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIGxvYWRXTVMobWFwLCBiYXNlVVJMLCBjdXN0b21QYXJhbXMpe1xyXG5cdHZhciB0aWxlSGVpZ2h0ID0gMjU2LFxyXG5cdFx0dGlsZVdpZHRoID0gMjU2LFxyXG5cdFx0b3BhY2l0eUxldmVsID0gMC43NSxcclxuXHRcdGlzUG5nID0gdHJ1ZSxcclxuXHRcdG1pblpvb21MZXZlbCA9IDIsXHJcblx0XHRtYXhab29tTGV2ZWwgPSAyODtcclxuXHJcblx0Ly92YXIgYmFzZVVSTCA9IFwiXCI7XHJcblx0Ly8gZsO8ciBTVk9cclxuXHR2YXIgd21zUGFyYW1zID0gW1xyXG5cdFwiUkVRVUVTVD1HZXRNYXBcIixcclxuXHRcIlNFUlZJQ0U9V01TXCIsXHJcblx0XCJWRVJTSU9OPTEuMS4xXCIsXHJcblx0Ly9cIldJRFRIPTUxMlwiLFxyXG5cdC8vXCJIRUlHSFQ9NTEyXCIsXHJcblx0Ly9cIlNSUz1FUFNHOjQzMjZcIixcclxuXHQvL1wiTEFZRVJTPXpvbmVuLXNjaHV0enZlcm9yZG51bmdlblwiLFxyXG5cdFwiU1RZTEVTPWRlZmF1bHRcIixcclxuXHRcIlRSQU5TUEFSRU5UPVRSVUVcIixcclxuXHRcIkZPUk1BVD1pbWFnZS9naWZcIlxyXG5cdF07XHJcblx0Ly8gZsO8ciBhdlxyXG5cdC8qdmFyIHdtc1BhcmFtcyA9IFtcclxuXHQvL1wiUkVRVUVTVD1HZXRDYXBhYmlsaXRpZXNcIixcclxuXHQvL1wiU0VSVklDRT1XTVNcIixcclxuXHQvL1wiVkVSU0lPTj0xLjMuMFwiLFxyXG5cdFwiV0lEVEg9XCIrIHRpbGVXaWR0aCxcclxuXHRcIkhFSUdIVD1cIisgdGlsZUhlaWdodFxyXG5cdF07Ki9cclxuXHJcblx0Ly8gYWRkIGFkZGl0aW9uYWwgcGFyYW1ldGVyc1xyXG5cdHdtc1BhcmFtcyA9IHdtc1BhcmFtcy5jb25jYXQoY3VzdG9tUGFyYW1zKTtcclxuXHJcblx0dmFyIG92ZXJsYXlPcHRpb25zID0ge1xyXG5cdFx0Z2V0VGlsZVVybDogZnVuY3Rpb24oY29vcmQsIHpvb20pIHtcclxuXHRcdFx0dmFyIGxVTFAgPSBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoY29vcmQueCoyNTYsKGNvb3JkLnkrMSkqMjU2KTtcclxuXHRcdFx0dmFyIGxMUlAgPSBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoKGNvb3JkLngrMSkqMjU2LGNvb3JkLnkqMjU2KTtcclxuXHJcblx0XHRcdHZhciBwcm9qZWN0aW9uTWFwID0gbmV3IE1lcmNhdG9yUHJvamVjdGlvbigpO1xyXG5cclxuXHRcdFx0dmFyIGxVTGcgPSBwcm9qZWN0aW9uTWFwLmZyb21EaXZQaXhlbFRvU3BoZXJpY2FsTWVyY2F0b3IobFVMUCwgem9vbSk7XHJcblx0XHRcdHZhciBsTFJnICA9IHByb2plY3Rpb25NYXAuZnJvbURpdlBpeGVsVG9TcGhlcmljYWxNZXJjYXRvcihsTFJQLCB6b29tKTtcclxuXHJcblx0XHRcdHZhciBsVUxfTGF0aXR1ZGUgPSBsVUxnLnk7XHJcblx0XHRcdHZhciBsVUxfTG9uZ2l0dWRlID0gbFVMZy54O1xyXG5cdFx0XHR2YXIgbExSX0xhdGl0dWRlID0gbExSZy55O1xyXG5cdFx0XHR2YXIgbExSX0xvbmdpdHVkZSA9IGxMUmcueDtcclxuXHRcdFx0Ly8gR0o6IHRoZXJlIGlzIGEgYnVnIHdoZW4gY3Jvc3NpbmcgdGhlIC0xODAgbG9uZ2l0dWRlIGJvcmRlciAodGlsZSBkb2VzIG5vdCByZW5kZXIpIC0gdGhpcyBjaGVjayBzZWVtcyB0byBmaXggaXRcclxuXHRcdFx0aWYgKGxMUl9Mb25naXR1ZGUgPCBsVUxfTG9uZ2l0dWRlKXtcclxuXHRcdFx0ICBsTFJfTG9uZ2l0dWRlID0gTWF0aC5hYnMobExSX0xvbmdpdHVkZSk7XHJcblx0XHRcdH1cclxuXHRcdFx0dmFyIHVybFJlc3VsdCA9IGJhc2VVUkwgKyB3bXNQYXJhbXMuam9pbihcIiZcIikgKyBcIiZiYm94PVwiICsgbFVMX0xvbmdpdHVkZSArIFwiLFwiICsgbFVMX0xhdGl0dWRlICsgXCIsXCIgKyBsTFJfTG9uZ2l0dWRlICsgXCIsXCIgKyBsTFJfTGF0aXR1ZGU7XHJcblxyXG5cdFx0XHRyZXR1cm4gdXJsUmVzdWx0O1xyXG5cdFx0fSxcclxuXHJcblx0XHR0aWxlU2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUodGlsZUhlaWdodCwgdGlsZVdpZHRoKSxcclxuXHJcblx0XHRtaW5ab29tOiBtaW5ab29tTGV2ZWwsXHJcblx0XHRtYXhab29tOiBtYXhab29tTGV2ZWwsXHJcblxyXG5cdFx0b3BhY2l0eTogb3BhY2l0eUxldmVsLFxyXG5cclxuXHRcdGlzUG5nOiBpc1BuZ1xyXG5cdH07XHJcblxyXG5cdHZhciBvdmVybGF5V01TID0gbmV3IGdvb2dsZS5tYXBzLkltYWdlTWFwVHlwZShvdmVybGF5T3B0aW9ucyk7XHJcblxyXG5cdG1hcC5vdmVybGF5TWFwVHlwZXMuaW5zZXJ0QXQoMCwgb3ZlcmxheVdNUyk7XHJcblxyXG5cdG1hcC5zZXRPcHRpb25zKHtcclxuXHRcdG1hcFR5cGVDb250cm9sT3B0aW9uczoge1xyXG5cdFx0XHRtYXBUeXBlSWRzOiBbXHJcblx0XHRcdFx0Z29vZ2xlLm1hcHMuTWFwVHlwZUlkLlJPQURNQVAsXHJcblx0XHRcdFx0Z29vZ2xlLm1hcHMuTWFwVHlwZUlkLlRFUlJBSU4sXHJcblx0XHRcdFx0Z29vZ2xlLm1hcHMuTWFwVHlwZUlkLlNBVEVMTElURSxcclxuXHRcdFx0XHRnb29nbGUubWFwcy5NYXBUeXBlSWQuSFlCUklEXHJcblx0XHRcdF0sXHJcblx0XHRcdHN0eWxlOiBnb29nbGUubWFwcy5NYXBUeXBlQ29udHJvbFN0eWxlLkRST1BET1dOX01FTlVcclxuXHRcdH1cclxuXHR9KTtcclxufVxyXG5cclxuLyohIENvcHlyaWdodCAoYykgMjAxMSBCcmFuZG9uIEFhcm9uICgvL2JyYW5kb25hYXJvbi5uZXQpXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZSAoTElDRU5TRS50eHQpLlxyXG4gKlxyXG4gKiBUaGFua3MgdG86IC8vYWRvbWFzLm9yZy9qYXZhc2NyaXB0LW1vdXNlLXdoZWVsLyBmb3Igc29tZSBwb2ludGVycy5cclxuICogVGhhbmtzIHRvOiBNYXRoaWFzIEJhbmsoLy93d3cubWF0aGlhcy1iYW5rLmRlKSBmb3IgYSBzY29wZSBidWcgZml4LlxyXG4gKiBUaGFua3MgdG86IFNlYW11cyBMZWFoeSBmb3IgYWRkaW5nIGRlbHRhWCBhbmQgZGVsdGFZXHJcbiAqXHJcbiAqIFZlcnNpb246IDMuMC42XHJcbiAqIFxyXG4gKiBSZXF1aXJlczogMS4yLjIrXHJcbiAqXHJcbiAqIEJlbnV0enQsIHVtIE1vdXN3aGVlbC1TY3JvbGxlbiBhYnp1ZmFuZ2VuIHVuZCBkZW4gZXZlbnQgenUgdmVyaGluZGVybiAodW5iZWFic2ljaHRpZ3RlIMOEbmRlcnVuZyB2b24gWmFobGVuIGluIG51bWJlci1GZWxkZXJuIHZlcmhpbmRlcm4pXHJcbiAqXHJcbiAqL1xyXG5cclxuKGZ1bmN0aW9uKCQpIHtcclxuXHJcbnZhciB0eXBlcyA9IFsnRE9NTW91c2VTY3JvbGwnLCAnbW91c2V3aGVlbCddO1xyXG5cclxuaWYgKCQuZXZlbnQuZml4SG9va3MpIHtcclxuXHRmb3IgKCB2YXIgaT10eXBlcy5sZW5ndGg7IGk7ICkge1xyXG5cdFx0JC5ldmVudC5maXhIb29rc1sgdHlwZXNbLS1pXSBdID0gJC5ldmVudC5tb3VzZUhvb2tzO1xyXG5cdH1cclxufVxyXG5cclxuJC5ldmVudC5zcGVjaWFsLm1vdXNld2hlZWwgPSB7XHJcblx0c2V0dXA6IGZ1bmN0aW9uKCkge1xyXG5cdFx0aWYgKCB0aGlzLmFkZEV2ZW50TGlzdGVuZXIgKSB7XHJcblx0XHRcdGZvciAoIHZhciBpPXR5cGVzLmxlbmd0aDsgaTsgKSB7XHJcblx0XHRcdFx0dGhpcy5hZGRFdmVudExpc3RlbmVyKCB0eXBlc1stLWldLCBoYW5kbGVyLCBmYWxzZSApO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aGlzLm9ubW91c2V3aGVlbCA9IGhhbmRsZXI7XHJcblx0XHR9XHJcblx0fSxcclxuXHRcclxuXHR0ZWFyZG93bjogZnVuY3Rpb24oKSB7XHJcblx0XHRpZiAoIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lciApIHtcclxuXHRcdFx0Zm9yICggdmFyIGk9dHlwZXMubGVuZ3RoOyBpOyApIHtcclxuXHRcdFx0XHR0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoIHR5cGVzWy0taV0sIGhhbmRsZXIsIGZhbHNlICk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRoaXMub25tb3VzZXdoZWVsID0gbnVsbDtcclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblxyXG4kLmZuLmV4dGVuZCh7XHJcblx0bW91c2V3aGVlbDogZnVuY3Rpb24oZm4pIHtcclxuXHRcdHJldHVybiBmbiA/IHRoaXMuYmluZChcIm1vdXNld2hlZWxcIiwgZm4pIDogdGhpcy50cmlnZ2VyKFwibW91c2V3aGVlbFwiKTtcclxuXHR9LFxyXG5cdFxyXG5cdHVubW91c2V3aGVlbDogZnVuY3Rpb24oZm4pIHtcclxuXHRcdHJldHVybiB0aGlzLnVuYmluZChcIm1vdXNld2hlZWxcIiwgZm4pO1xyXG5cdH1cclxufSk7XHJcblxyXG5cclxuZnVuY3Rpb24gaGFuZGxlcihldmVudCkge1xyXG5cdHZhciBvcmdFdmVudCA9IGV2ZW50IHx8IHdpbmRvdy5ldmVudCwgYXJncyA9IFtdLnNsaWNlLmNhbGwoIGFyZ3VtZW50cywgMSApLCBkZWx0YSA9IDAsIHJldHVyblZhbHVlID0gdHJ1ZSwgZGVsdGFYID0gMCwgZGVsdGFZID0gMDtcclxuXHRldmVudCA9ICQuZXZlbnQuZml4KG9yZ0V2ZW50KTtcclxuXHRldmVudC50eXBlID0gXCJtb3VzZXdoZWVsXCI7XHJcblx0XHJcblx0Ly8gT2xkIHNjaG9vbCBzY3JvbGx3aGVlbCBkZWx0YVxyXG5cdGlmICggb3JnRXZlbnQud2hlZWxEZWx0YSApIHsgZGVsdGEgPSBvcmdFdmVudC53aGVlbERlbHRhLzEyMDsgfVxyXG5cdGlmICggb3JnRXZlbnQuZGV0YWlsXHQgKSB7IGRlbHRhID0gLW9yZ0V2ZW50LmRldGFpbC8zOyB9XHJcblx0XHJcblx0Ly8gTmV3IHNjaG9vbCBtdWx0aWRpbWVuc2lvbmFsIHNjcm9sbCAodG91Y2hwYWRzKSBkZWx0YXNcclxuXHRkZWx0YVkgPSBkZWx0YTtcclxuXHRcclxuXHQvLyBHZWNrb1xyXG5cdGlmICggb3JnRXZlbnQuYXhpcyAhPT0gdW5kZWZpbmVkICYmIG9yZ0V2ZW50LmF4aXMgPT09IG9yZ0V2ZW50LkhPUklaT05UQUxfQVhJUyApIHtcclxuXHRcdGRlbHRhWSA9IDA7XHJcblx0XHRkZWx0YVggPSAtMSpkZWx0YTtcclxuXHR9XHJcblx0XHJcblx0Ly8gV2Via2l0XHJcblx0aWYgKCBvcmdFdmVudC53aGVlbERlbHRhWSAhPT0gdW5kZWZpbmVkICkgeyBkZWx0YVkgPSBvcmdFdmVudC53aGVlbERlbHRhWS8xMjA7IH1cclxuXHRpZiAoIG9yZ0V2ZW50LndoZWVsRGVsdGFYICE9PSB1bmRlZmluZWQgKSB7IGRlbHRhWCA9IC0xKm9yZ0V2ZW50LndoZWVsRGVsdGFYLzEyMDsgfVxyXG5cdFxyXG5cdC8vIEFkZCBldmVudCBhbmQgZGVsdGEgdG8gdGhlIGZyb250IG9mIHRoZSBhcmd1bWVudHNcclxuXHRhcmdzLnVuc2hpZnQoZXZlbnQsIGRlbHRhLCBkZWx0YVgsIGRlbHRhWSk7XHJcblx0XHJcblx0cmV0dXJuICgkLmV2ZW50LmRpc3BhdGNoIHx8ICQuZXZlbnQuaGFuZGxlKS5hcHBseSh0aGlzLCBhcmdzKTtcclxufVxyXG5cclxufSkoalF1ZXJ5KTtcclxuXHJcbndpbmRvdy5hcGYuw7ZmZm5lVXJpID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciB1cmkgPSBuZXcgVXJpKCQobG9jYXRpb24pLmF0dHIoJ2hyZWYnKSksXHJcblx0XHRhbmNob3IgPSB1cmkuYW5jaG9yKCkgfHwgbnVsbCxcclxuXHRcdGFwX2lkID0gdXJpLmdldFF1ZXJ5UGFyYW1WYWx1ZSgnYXAnKTtcclxuXHRpZiAoYXBfaWQpIHtcclxuXHRcdC8vIGdsb2JhbGUgVmFyaWFibGVuIHNldHplblxyXG5cdFx0d2luZG93LmFwZi5zZXR6ZVdpbmRvd0FwKGFwX2lkKTtcclxuXHRcdC8vIERlbSBGZWxkIGltIEZvcm11bGFyIGRlbiBXZXJ0IHp1d2Vpc2VuXHJcblx0XHQkKFwiI2FwX3dhZWhsZW5cIikudmFsKGFwX2lkKTtcclxuXHRcdGlmICh1cmkuZ2V0UXVlcnlQYXJhbVZhbHVlKCd0cG9wJykpIHtcclxuXHRcdFx0Ly8gZ2xvYmFsZSBWYXJpYWJsZW4gc2V0emVuXHJcblx0XHRcdHdpbmRvdy5hcGYuc2V0emVXaW5kb3dQb3AodXJpLmdldFF1ZXJ5UGFyYW1WYWx1ZSgncG9wJykpO1xyXG5cdFx0XHR3aW5kb3cuYXBmLnNldHplV2luZG93VHBvcCh1cmkuZ2V0UXVlcnlQYXJhbVZhbHVlKCd0cG9wJykpO1xyXG5cdFx0XHR2YXIgdHBvcGZlbGRrb250cl9pZCA9IHVyaS5nZXRRdWVyeVBhcmFtVmFsdWUoJ3Rwb3BmZWxka29udHInKTtcclxuXHRcdFx0aWYgKHRwb3BmZWxka29udHJfaWQpIHtcclxuXHRcdFx0XHQvLyBnbG9iYWxlIFZhcmlhYmxlbiBzZXR6ZW5cclxuXHRcdFx0XHR3aW5kb3cuYXBmLnNldHplV2luZG93VHBvcGZlbGRrb250cih0cG9wZmVsZGtvbnRyX2lkKTtcclxuXHRcdFx0XHQvLyBtYXJraWVyZW4sIGRhc3MgbmFjaCBkZW0gbG9hZGVkLWV2ZW50IGltIFRyZWUgZGllIFRQb3Brb250ciBhbmdlemVpZ3Qgd2VyZGVuIHNvbGwgXHJcblx0XHRcdFx0Ly8gRGllIE1hcmtpZXJ1bmcgd2lyZCBpbSBsb2FkLUV2ZW50IHdpZWRlciBlbnRmZXJudFxyXG5cdFx0XHRcdHdpbmRvdy5hcGYudHBvcGZlbGRrb250cl96ZWlnZW4gPSB0cnVlO1xyXG5cdFx0XHRcdC8vIGRpcmVrdCBpbml0aWllcmVuLCBuaWNodCBlcnN0LCB3ZW5uIGJhdW0gZmVydGlnIGF1ZmdlYmF1dCBpc3RcclxuXHRcdFx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV90cG9wZmVsZGtvbnRyKCk7XHJcblx0XHRcdH0gZWxzZSBpZiAodXJpLmdldFF1ZXJ5UGFyYW1WYWx1ZSgndHBvcGZyZWl3a29udHInKSkge1xyXG5cdFx0XHRcdC8vIGdsb2JhbGUgVmFyaWFibGVuIHNldHplblxyXG5cdFx0XHRcdHdpbmRvdy5hcGYuc2V0emVXaW5kb3dUcG9wZmVsZGtvbnRyKHVyaS5nZXRRdWVyeVBhcmFtVmFsdWUoJ3Rwb3BmcmVpd2tvbnRyJykpO1xyXG5cdFx0XHRcdC8vIG1hcmtpZXJlbiwgZGFzcyBuYWNoIGRlbSBsb2FkZWQtZXZlbnQgaW0gVHJlZSBkaWUgVFBvcGtvbnRyIGFuZ2V6ZWlndCB3ZXJkZW4gc29sbCBcclxuXHRcdFx0XHQvLyBEaWUgTWFya2llcnVuZyB3aXJkIGltIGxvYWQtRXZlbnQgd2llZGVyIGVudGZlcm50XHJcblx0XHRcdFx0d2luZG93LmFwZi50cG9wZnJlaXdrb250cl96ZWlnZW4gPSB0cnVlO1xyXG5cdFx0XHRcdC8vIGRpcmVrdCBpbml0aWllcmVuLCBuaWNodCBlcnN0LCB3ZW5uIGJhdW0gZmVydGlnIGF1ZmdlYmF1dCBpc3RcclxuXHRcdFx0XHRsb2NhbFN0b3JhZ2UudHBvcGZyZWl3a29udHIgPSB0cnVlO1xyXG5cdFx0XHRcdHdpbmRvdy5hcGYuaW5pdGlpZXJlX3Rwb3BmZWxka29udHIoKTtcclxuXHRcdFx0fSBlbHNlIGlmICh1cmkuZ2V0UXVlcnlQYXJhbVZhbHVlKCd0cG9wbWFzc24nKSkge1xyXG5cdFx0XHRcdC8vIGdsb2JhbGUgVmFyaWFibGVuIHNldHplblxyXG5cdFx0XHRcdHdpbmRvdy5hcGYuc2V0emVXaW5kb3dUcG9wbWFzc24odXJpLmdldFF1ZXJ5UGFyYW1WYWx1ZSgndHBvcG1hc3NuJykpO1xyXG5cdFx0XHRcdC8vIG1hcmtpZXJlbiwgZGFzcyBuYWNoIGRlbSBsb2FkZWQtZXZlbnQgaW0gVHJlZSBkaWUgVFBvcGtvbnRyIGFuZ2V6ZWlndCB3ZXJkZW4gc29sbCBcclxuXHRcdFx0XHQvLyBEaWUgTWFya2llcnVuZyB3aXJkIGltIGxvYWQtRXZlbnQgd2llZGVyIGVudGZlcm50XHJcblx0XHRcdFx0d2luZG93LmFwZi50cG9wbWFzc25femVpZ2VuID0gdHJ1ZTtcclxuXHRcdFx0XHQvLyBkaXJla3QgaW5pdGlpZXJlbiwgbmljaHQgZXJzdCwgd2VubiBiYXVtIGZlcnRpZyBhdWZnZWJhdXQgaXN0XHJcblx0XHRcdFx0d2luZG93LmFwZi5pbml0aWllcmVfdHBvcG1hc3NuKCk7XHJcblx0XHRcdH0gZWxzZSBpZiAodXJpLmdldFF1ZXJ5UGFyYW1WYWx1ZSgndHBvcGJlcicpKSB7XHJcblx0XHRcdFx0Ly8gZ2xvYmFsZSBWYXJpYWJsZW4gc2V0emVuXHJcblx0XHRcdFx0d2luZG93LmFwZi5zZXR6ZVdpbmRvd1Rwb3BiZXIodXJpLmdldFF1ZXJ5UGFyYW1WYWx1ZSgndHBvcGJlcicpKTtcclxuXHRcdFx0XHQvLyBtYXJraWVyZW4sIGRhc3MgbmFjaCBkZW0gbG9hZGVkLWV2ZW50IGltIFRyZWUgZGllIHRwb3BiZXIgYW5nZXplaWd0IHdlcmRlbiBzb2xsIFxyXG5cdFx0XHRcdC8vIERpZSBNYXJraWVydW5nIHdpcmQgaW0gbG9hZC1FdmVudCB3aWVkZXIgZW50ZmVybnRcclxuXHRcdFx0XHR3aW5kb3cuYXBmLnRwb3BiZXJfemVpZ2VuID0gdHJ1ZTtcclxuXHRcdFx0XHQvLyBkaXJla3QgaW5pdGlpZXJlbiwgbmljaHQgZXJzdCwgd2VubiBiYXVtIGZlcnRpZyBhdWZnZWJhdXQgaXN0XHJcblx0XHRcdFx0d2luZG93LmFwZi5pbml0aWllcmVUcG9wYmVyKCk7XHJcblx0XHRcdH0gZWxzZSBpZiAodXJpLmdldFF1ZXJ5UGFyYW1WYWx1ZSgnYmVvYl96dWdlb3JkbmV0JykpIHtcclxuXHRcdFx0XHQvLyBtYXJraWVyZW4sIGRhc3MgbmFjaCBkZW0gbG9hZGVkLWV2ZW50IGltIFRyZWUgZGllIGJlb2JfenVnZW9yZG5ldCBhbmdlemVpZ3Qgd2VyZGVuIHNvbGwgXHJcblx0XHRcdFx0Ly8gRGllIE1hcmtpZXJ1bmcgd2lyZCBpbSBsb2FkLUV2ZW50IHdpZWRlciBlbnRmZXJudFxyXG5cdFx0XHRcdHdpbmRvdy5hcGYuYmVvYl96dWdlb3JkbmV0X3plaWdlbiA9IHRydWU7XHJcblx0XHRcdFx0Ly8gZGlyZWt0IGluaXRpaWVyZW4sIG5pY2h0IGVyc3QsIHdlbm4gYmF1bSBmZXJ0aWcgYXVmZ2ViYXV0IGlzdFxyXG5cdFx0XHRcdC8qYXVzZ2VzY2hhbHRldCAtIGZ1bmt0aW9uaWVydCBuaWNodCEgdmVybXV0bGljaCwgd2VpbCB0cmVlLnBocCB1bmQgYmVvYl9kaXN0enV0cG9wIHNpY2ggaW4gcXVlcmUga29tbWVuXHJcblx0XHRcdFx0Ly8gaGVyYXVzZmluZGVuLCBvYiBiZW9idHlwIGluZm9zcGV6aWVzIG9kZXIgZXZhYiBpc3RcclxuXHRcdFx0XHRsb2NhbFN0b3JhZ2UuYmVvYl9pZCA9IHVyaS5nZXRRdWVyeVBhcmFtVmFsdWUoJ2Jlb2JfenVnZW9yZG5ldCcpO1xyXG5cdFx0XHRcdGlmIChpc05hTih1cmkuZ2V0UXVlcnlQYXJhbVZhbHVlKCdiZW9iX3p1Z2VvcmRuZXQnKSkpIHtcclxuXHRcdFx0XHRcdC8vIGV2YWJcclxuXHRcdFx0XHRcdGxvY2FsU3RvcmFnZS5iZW9idHlwID0gXCJldmFiXCI7XHJcblx0XHRcdFx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV9iZW9iKFwiZXZhYlwiLCBsb2NhbFN0b3JhZ2UuYmVvYl9pZCwgXCJ6dWdlb3JkbmV0XCIpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRsb2NhbFN0b3JhZ2UuYmVvYnR5cCA9IFwiaW5mb3NwZXppZXNcIjtcclxuXHRcdFx0XHRcdHdpbmRvdy5hcGYuaW5pdGlpZXJlX2Jlb2IoXCJpbmZvc3Blemllc1wiLCBsb2NhbFN0b3JhZ2UuYmVvYl9pZCwgXCJ6dWdlb3JkbmV0XCIpO1xyXG5cdFx0XHRcdH0qL1xyXG5cdFx0XHR9IGVsc2UgaWYgKHVyaS5nZXRRdWVyeVBhcmFtVmFsdWUoJ3Rwb3BtYXNzbmJlcicpKSB7XHJcblx0XHRcdFx0Ly8gZ2xvYmFsZSBWYXJpYWJsZW4gc2V0emVuXHJcblx0XHRcdFx0d2luZG93LmFwZi5zZXR6ZVdpbmRvd1Rwb3BtYXNzbmJlcih1cmkuZ2V0UXVlcnlQYXJhbVZhbHVlKCd0cG9wbWFzc25iZXInKSk7XHJcblx0XHRcdFx0Ly8gbWFya2llcmVuLCBkYXNzIG5hY2ggZGVtIGxvYWRlZC1ldmVudCBpbSBUcmVlIGRpZSB0cG9wbWFzc25iZXIgYW5nZXplaWd0IHdlcmRlbiBzb2xsIFxyXG5cdFx0XHRcdC8vIERpZSBNYXJraWVydW5nIHdpcmQgaW0gbG9hZC1FdmVudCB3aWVkZXIgZW50ZmVybnRcclxuXHRcdFx0XHR3aW5kb3cuYXBmLnRwb3BtYXNzbmJlcl96ZWlnZW4gPSB0cnVlO1xyXG5cdFx0XHRcdC8vIGRpcmVrdCBpbml0aWllcmVuLCBuaWNodCBlcnN0LCB3ZW5uIGJhdW0gZmVydGlnIGF1ZmdlYmF1dCBpc3RcclxuXHRcdFx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV90cG9wbWFzc25iZXIoKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQvLyBtdXNzIHRwb3Agc2VpblxyXG5cdFx0XHRcdC8vIG1hcmtpZXJlbiwgZGFzcyBuYWNoIGRlbSBsb2FkZWQtZXZlbnQgaW0gVHJlZSBkaWUgVFBvcCBhbmdlemVpZ3Qgd2VyZGVuIHNvbGwgXHJcblx0XHRcdFx0Ly8gRGllIE1hcmtpZXJ1bmcgd2lyZCBpbSBsb2FkLUV2ZW50IHdpZWRlciBlbnRmZXJudFxyXG5cdFx0XHRcdHdpbmRvdy5hcGYudHBvcF96ZWlnZW4gPSB0cnVlO1xyXG5cdFx0XHRcdC8vIGRpcmVrdCBpbml0aWllcmVuLCBuaWNodCBlcnN0LCB3ZW5uIGJhdW0gZmVydGlnIGF1ZmdlYmF1dCBpc3RcclxuXHRcdFx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV90cG9wKCk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSBpZiAodXJpLmdldFF1ZXJ5UGFyYW1WYWx1ZSgncG9wJykpIHtcclxuXHRcdFx0Ly8gZ2xvYmFsZSBWYXJpYWJsZW4gc2V0emVuXHJcblx0XHRcdHdpbmRvdy5hcGYuc2V0emVXaW5kb3dQb3AodXJpLmdldFF1ZXJ5UGFyYW1WYWx1ZSgncG9wJykpO1xyXG5cdFx0XHRpZiAodXJpLmdldFF1ZXJ5UGFyYW1WYWx1ZSgncG9wYmVyJykpIHtcclxuXHRcdFx0XHQvLyBnbG9iYWxlIFZhcmlhYmxlbiBzZXR6ZW5cclxuXHRcdFx0XHR3aW5kb3cuYXBmLnNldHplV2luZG93UG9wYmVyKHVyaS5nZXRRdWVyeVBhcmFtVmFsdWUoJ3BvcGJlcicpKTtcclxuXHRcdFx0XHQvLyBtYXJraWVyZW4sIGRhc3MgbmFjaCBkZW0gbG9hZGVkLWV2ZW50IGltIFRyZWUgZGllIFBvcCBhbmdlemVpZ3Qgd2VyZGVuIHNvbGwgXHJcblx0XHRcdFx0Ly8gRGllIE1hcmtpZXJ1bmcgd2lyZCBpbSBsb2FkLUV2ZW50IHdpZWRlciBlbnRmZXJudFxyXG5cdFx0XHRcdHdpbmRvdy5hcGYucG9wYmVyX3plaWdlbiA9IHRydWU7XHJcblx0XHRcdFx0Ly8gZGlyZWt0IGluaXRpaWVyZW4sIG5pY2h0IGVyc3QsIHdlbm4gYmF1bSBmZXJ0aWcgYXVmZ2ViYXV0IGlzdFxyXG5cdFx0XHRcdHdpbmRvdy5hcGYuaW5pdGlpZXJlX3BvcGJlcigpO1xyXG5cdFx0XHR9IGVsc2UgaWYgKHVyaS5nZXRRdWVyeVBhcmFtVmFsdWUoJ3BvcG1hc3NuYmVyJykpIHtcclxuXHRcdFx0XHQvLyBnbG9iYWxlIFZhcmlhYmxlbiBzZXR6ZW5cclxuXHRcdFx0XHR3aW5kb3cuYXBmLnNldHplV2luZG93UG9wbWFzc25iZXIodXJpLmdldFF1ZXJ5UGFyYW1WYWx1ZSgncG9wbWFzc25iZXInKSk7XHJcblx0XHRcdFx0Ly8gbWFya2llcmVuLCBkYXNzIG5hY2ggZGVtIGxvYWRlZC1ldmVudCBpbSBUcmVlIGRpZSBwb3BtYXNzbmJlciBhbmdlemVpZ3Qgd2VyZGVuIHNvbGwgXHJcblx0XHRcdFx0Ly8gRGllIE1hcmtpZXJ1bmcgd2lyZCBpbSBsb2FkLUV2ZW50IHdpZWRlciBlbnRmZXJudFxyXG5cdFx0XHRcdHdpbmRvdy5hcGYucG9wbWFzc25iZXJfemVpZ2VuID0gdHJ1ZTtcclxuXHRcdFx0XHQvLyBkaXJla3QgaW5pdGlpZXJlbiwgbmljaHQgZXJzdCwgd2VubiBiYXVtIGZlcnRpZyBhdWZnZWJhdXQgaXN0XHJcblx0XHRcdFx0d2luZG93LmFwZi5pbml0aWllcmVfcG9wbWFzc25iZXIoKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQvLyBtdXNzIHBvcCBzZWluXHJcblx0XHRcdFx0Ly8gbWFya2llcmVuLCBkYXNzIG5hY2ggZGVtIGxvYWRlZC1ldmVudCBpbSBUcmVlIGRpZSBQb3AgYW5nZXplaWd0IHdlcmRlbiBzb2xsIFxyXG5cdFx0XHRcdC8vIERpZSBNYXJraWVydW5nIHdpcmQgaW0gbG9hZC1FdmVudCB3aWVkZXIgZW50ZmVybnRcclxuXHRcdFx0XHR3aW5kb3cuYXBmLnBvcF96ZWlnZW4gPSB0cnVlO1xyXG5cdFx0XHRcdC8vIGRpcmVrdCBpbml0aWllcmVuLCBuaWNodCBlcnN0LCB3ZW5uIGJhdW0gZmVydGlnIGF1ZmdlYmF1dCBpc3RcclxuXHRcdFx0XHRsb2NhbFN0b3JhZ2UucG9wX2lkID0gdXJpLmdldFF1ZXJ5UGFyYW1WYWx1ZSgncG9wJyk7XHJcblx0XHRcdFx0d2luZG93LmFwZi5pbml0aWllcmVfcG9wKCk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSBpZiAodXJpLmdldFF1ZXJ5UGFyYW1WYWx1ZSgnYXB6aWVsJykpIHtcclxuXHRcdFx0Ly8gZ2xvYmFsZSBWYXJpYWJsZW4gc2V0emVuXHJcblx0XHRcdHdpbmRvdy5hcGYuc2V0emVXaW5kb3dBcHppZWwodXJpLmdldFF1ZXJ5UGFyYW1WYWx1ZSgnYXB6aWVsJykpO1xyXG5cdFx0XHRpZiAodXJpLmdldFF1ZXJ5UGFyYW1WYWx1ZSgnemllbGJlcicpKSB7XHJcblx0XHRcdFx0Ly8gZ2xvYmFsZSBWYXJpYWJsZW4gc2V0emVuXHJcblx0XHRcdFx0d2luZG93LmFwZi5zZXR6ZVdpbmRvd1ppZWxiZXIodXJpLmdldFF1ZXJ5UGFyYW1WYWx1ZSgnemllbGJlcicpKTtcclxuXHRcdFx0XHQvLyBtYXJraWVyZW4sIGRhc3MgbmFjaCBkZW0gbG9hZGVkLWV2ZW50IGltIFRyZWUgZGllIHppZWxiZXIgYW5nZXplaWd0IHdlcmRlbiBzb2xsIFxyXG5cdFx0XHRcdC8vIERpZSBNYXJraWVydW5nIHdpcmQgaW0gbG9hZC1FdmVudCB3aWVkZXIgZW50ZmVybnRcclxuXHRcdFx0XHR3aW5kb3cuYXBmLnppZWxiZXJfemVpZ2VuID0gdHJ1ZTtcclxuXHRcdFx0XHQvLyBkaXJla3QgaW5pdGlpZXJlbiwgbmljaHQgZXJzdCwgd2VubiBiYXVtIGZlcnRpZyBhdWZnZWJhdXQgaXN0XHJcblx0XHRcdFx0d2luZG93LmFwZi5pbml0aWllcmVfemllbGJlcigpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdC8vIG11c3MgZWluIGFwemllbCBzZWluXHJcblx0XHRcdFx0Ly8gbWFya2llcmVuLCBkYXNzIG5hY2ggZGVtIGxvYWRlZC1ldmVudCBpbSBUcmVlIGRpZSBhcHppZWwgYW5nZXplaWd0IHdlcmRlbiBzb2xsIFxyXG5cdFx0XHRcdC8vIERpZSBNYXJraWVydW5nIHdpcmQgaW0gbG9hZC1FdmVudCB3aWVkZXIgZW50ZmVybnRcclxuXHRcdFx0XHR3aW5kb3cuYXBmLmFwemllbF96ZWlnZW4gPSB0cnVlO1xyXG5cdFx0XHRcdC8vIGRpcmVrdCBpbml0aWllcmVuLCBuaWNodCBlcnN0LCB3ZW5uIGJhdW0gZmVydGlnIGF1ZmdlYmF1dCBpc3RcclxuXHRcdFx0XHRsb2NhbFN0b3JhZ2UuYXB6aWVsX2lkID0gdXJpLmdldFF1ZXJ5UGFyYW1WYWx1ZSgnYXB6aWVsJyk7XHJcblx0XHRcdFx0d2luZG93LmFwZi5pbml0aWllcmVfYXB6aWVsKCk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSBpZiAodXJpLmdldFF1ZXJ5UGFyYW1WYWx1ZSgnZXJma3JpdCcpKSB7XHJcblx0XHRcdC8vIGdsb2JhbGUgVmFyaWFibGVuIHNldHplblxyXG5cdFx0XHR3aW5kb3cuYXBmLnNldHplV2luZG93RXJma3JpdCh1cmkuZ2V0UXVlcnlQYXJhbVZhbHVlKCdlcmZrcml0JykpO1xyXG5cdFx0XHQvLyBtYXJraWVyZW4sIGRhc3MgbmFjaCBkZW0gbG9hZGVkLWV2ZW50IGltIFRyZWUgZGllIGVyZmtyaXQgYW5nZXplaWd0IHdlcmRlbiBzb2xsIFxyXG5cdFx0XHQvLyBEaWUgTWFya2llcnVuZyB3aXJkIGltIGxvYWQtRXZlbnQgd2llZGVyIGVudGZlcm50XHJcblx0XHRcdHdpbmRvdy5hcGYuZXJma3JpdF96ZWlnZW4gPSB0cnVlO1xyXG5cdFx0fSBlbHNlIGlmICh1cmkuZ2V0UXVlcnlQYXJhbVZhbHVlKCdqYmVyJykpIHtcclxuXHRcdFx0Ly8gZ2xvYmFsZSBWYXJpYWJsZW4gc2V0emVuXHJcblx0XHRcdHdpbmRvdy5hcGYuc2V0emVXaW5kb3dKYmVyKHVyaS5nZXRRdWVyeVBhcmFtVmFsdWUoJ2piZXInKSk7XHJcblx0XHRcdC8vIG1hcmtpZXJlbiwgZGFzcyBuYWNoIGRlbSBsb2FkZWQtZXZlbnQgaW0gVHJlZSBkaWUgamJlciBhbmdlemVpZ3Qgd2VyZGVuIHNvbGwgXHJcblx0XHRcdC8vIERpZSBNYXJraWVydW5nIHdpcmQgaW0gbG9hZC1FdmVudCB3aWVkZXIgZW50ZmVybnRcclxuXHRcdFx0d2luZG93LmFwZi5qYmVyX3plaWdlbiA9IHRydWU7XHJcblx0XHRcdC8vIGRpcmVrdCBpbml0aWllcmVuLCBuaWNodCBlcnN0LCB3ZW5uIGJhdW0gZmVydGlnIGF1ZmdlYmF1dCBpc3RcclxuXHRcdFx0d2luZG93LmFwZi5pbml0aWllcmVfamJlcigpO1xyXG5cdFx0fSBlbHNlIGlmICh1cmkuZ2V0UXVlcnlQYXJhbVZhbHVlKCdqYmVyX3VlYmVyc2ljaHQnKSkge1xyXG5cdFx0XHQvLyBnbG9iYWxlIFZhcmlhYmxlbiBzZXR6ZW5cclxuXHRcdFx0d2luZG93LmFwZi5zZXR6ZVdpbmRvd0piZXJVZWJlcnNpY2h0KHVyaS5nZXRRdWVyeVBhcmFtVmFsdWUoJ2piZXJfdWViZXJzaWNodCcpKTtcclxuXHRcdFx0Ly8gbWFya2llcmVuLCBkYXNzIG5hY2ggZGVtIGxvYWRlZC1ldmVudCBpbSBUcmVlIGRpZSBqYmVyX3VlYmVyc2ljaHQgYW5nZXplaWd0IHdlcmRlbiBzb2xsIFxyXG5cdFx0XHQvLyBEaWUgTWFya2llcnVuZyB3aXJkIGltIGxvYWQtRXZlbnQgd2llZGVyIGVudGZlcm50XHJcblx0XHRcdHdpbmRvdy5hcGYuamJlcl/DvGJlcnNpY2h0X3plaWdlbiA9IHRydWU7XHJcblx0XHRcdC8vIGRpcmVrdCBpbml0aWllcmVuLCBuaWNodCBlcnN0LCB3ZW5uIGJhdW0gZmVydGlnIGF1ZmdlYmF1dCBpc3RcclxuXHRcdFx0d2luZG93LmFwZi5pbml0aWllcmVfamJlcl91ZWJlcnNpY2h0KCk7XHJcblx0XHR9IGVsc2UgaWYgKHVyaS5nZXRRdWVyeVBhcmFtVmFsdWUoJ2JlcicpKSB7XHJcblx0XHRcdC8vIGdsb2JhbGUgVmFyaWFibGVuIHNldHplblxyXG5cdFx0XHR3aW5kb3cuYXBmLnNldHplV2luZG93QmVyKHVyaS5nZXRRdWVyeVBhcmFtVmFsdWUoJ2JlcicpKTtcclxuXHRcdFx0Ly8gbWFya2llcmVuLCBkYXNzIG5hY2ggZGVtIGxvYWRlZC1ldmVudCBpbSBUcmVlIGRpZSBiZXIgYW5nZXplaWd0IHdlcmRlbiBzb2xsIFxyXG5cdFx0XHQvLyBEaWUgTWFya2llcnVuZyB3aXJkIGltIGxvYWQtRXZlbnQgd2llZGVyIGVudGZlcm50XHJcblx0XHRcdHdpbmRvdy5hcGYuYmVyX3plaWdlbiA9IHRydWU7XHJcblx0XHRcdC8vIGRpcmVrdCBpbml0aWllcmVuLCBuaWNodCBlcnN0LCB3ZW5uIGJhdW0gZmVydGlnIGF1ZmdlYmF1dCBpc3RcclxuXHRcdFx0d2luZG93LmFwZi5pbml0aWllcmVfYmVyKCk7XHJcblx0XHR9IGVsc2UgaWYgKHVyaS5nZXRRdWVyeVBhcmFtVmFsdWUoJ2lkZWFsYmlvdG9wJykpIHtcclxuXHRcdFx0Ly8gZ2xvYmFsZSBWYXJpYWJsZW4gc2V0emVuXHJcblx0XHRcdHdpbmRvdy5hcGYuc2V0emVXaW5kb3dJZGVhbGJpb3RvcCh1cmkuZ2V0UXVlcnlQYXJhbVZhbHVlKCdpZGVhbGJpb3RvcCcpKTtcclxuXHRcdFx0Ly8gbWFya2llcmVuLCBkYXNzIG5hY2ggZGVtIGxvYWRlZC1ldmVudCBpbSBUcmVlIGRpZSBpZGVhbGJpb3RvcCBhbmdlemVpZ3Qgd2VyZGVuIHNvbGwgXHJcblx0XHRcdC8vIERpZSBNYXJraWVydW5nIHdpcmQgaW0gbG9hZC1FdmVudCB3aWVkZXIgZW50ZmVybnRcclxuXHRcdFx0d2luZG93LmFwZi5pZGVhbGJpb3RvcF96ZWlnZW4gPSB0cnVlO1xyXG5cdFx0XHQvLyBkaXJla3QgaW5pdGlpZXJlbiwgbmljaHQgZXJzdCwgd2VubiBiYXVtIGZlcnRpZyBhdWZnZWJhdXQgaXN0XHJcblx0XHRcdHdpbmRvdy5hcGYuaW5pdGlpZXJlX2lkZWFsYmlvdG9wKCk7XHJcblx0XHR9IGVsc2UgaWYgKHVyaS5nZXRRdWVyeVBhcmFtVmFsdWUoJ2Fzc296YXJ0ZW4nKSkge1xyXG5cdFx0XHQvLyBnbG9iYWxlIFZhcmlhYmxlbiBzZXR6ZW5cclxuXHRcdFx0d2luZG93LmFwZi5zZXR6ZVdpbmRvd0Fzc296YXJ0ZW4odXJpLmdldFF1ZXJ5UGFyYW1WYWx1ZSgnYXNzb3phcnRlbicpKTtcclxuXHRcdFx0Ly8gbWFya2llcmVuLCBkYXNzIG5hY2ggZGVtIGxvYWRlZC1ldmVudCBpbSBUcmVlIGRpZSBhc3NvemFydGVuIGFuZ2V6ZWlndCB3ZXJkZW4gc29sbCBcclxuXHRcdFx0Ly8gRGllIE1hcmtpZXJ1bmcgd2lyZCBpbSBsb2FkLUV2ZW50IHdpZWRlciBlbnRmZXJudFxyXG5cdFx0XHR3aW5kb3cuYXBmLmFzc296YXJ0ZW5femVpZ2VuID0gdHJ1ZTtcclxuXHRcdFx0Ly8gTklDSFQgZGlyZWt0IGluaXRpaWVyZW4sIHdlaWwgc29uc3QgZGllIEFydGxpc3RlIG5vY2ggbmljaHQgZXhpc3RpZXJ0XHJcblx0XHR9IGVsc2UgaWYgKHVyaS5nZXRRdWVyeVBhcmFtVmFsdWUoJ2Jlb2JfbmljaHRfYmV1cnRlaWx0JykpIHtcclxuXHRcdFx0Ly8gbWFya2llcmVuLCBkYXNzIG5hY2ggZGVtIGxvYWRlZC1ldmVudCBpbSBUcmVlIGRpZSBiZW9iIGFuZ2V6ZWlndCB3ZXJkZW4gc29sbCBcclxuXHRcdFx0Ly8gRGllIE1hcmtpZXJ1bmcgd2lyZCBpbSBsb2FkLUV2ZW50IHdpZWRlciBlbnRmZXJudFxyXG5cdFx0XHR3aW5kb3cuYXBmLmJlb2JfbmljaHRfYmV1cnRlaWx0X3plaWdlbiA9IHRydWU7XHJcblx0XHR9IGVsc2UgaWYgKHVyaS5nZXRRdWVyeVBhcmFtVmFsdWUoJ2Jlb2JfbmljaHRfenV6dW9yZG5lbicpKSB7XHJcblx0XHRcdC8vIG1hcmtpZXJlbiwgZGFzcyBuYWNoIGRlbSBsb2FkZWQtZXZlbnQgaW0gVHJlZSBkaWUgYmVvYiBhbmdlemVpZ3Qgd2VyZGVuIHNvbGwgXHJcblx0XHRcdC8vIERpZSBNYXJraWVydW5nIHdpcmQgaW0gbG9hZC1FdmVudCB3aWVkZXIgZW50ZmVybnRcclxuXHRcdFx0d2luZG93LmFwZi5iZW9iX25pY2h0X3p1enVvcmRuZW5femVpZ2VuID0gdHJ1ZTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdC8vIG11c3MgYXAgc2VpblxyXG5cdFx0XHQvLyBtYXJraWVyZW4sIGRhc3MgbmFjaCBkZW0gbG9hZGVkLWV2ZW50IGltIFRyZWUgZGllIFBvcCBhbmdlemVpZ3Qgd2VyZGVuIHNvbGwgXHJcblx0XHRcdC8vIERpZSBNYXJraWVydW5nIHdpcmQgaW0gbG9hZC1FdmVudCB3aWVkZXIgZW50ZmVybnRcclxuXHRcdFx0d2luZG93LmFwZi5hcF96ZWlnZW4gPSB0cnVlO1xyXG5cdFx0XHQvLyBkaXJla3QgaW5pdGlpZXJlbiwgbmljaHQgZXJzdCwgd2VubiBiYXVtIGZlcnRpZyBhdWZnZWJhdXQgaXN0XHJcblx0XHRcdGxvY2FsU3RvcmFnZS5hcF9pZCA9IGFwX2lkO1xyXG5cdFx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV9hcCgpO1xyXG5cdFx0fVxyXG5cdFx0d2luZG93LmFwZi5lcnN0ZWxsZV90cmVlKGFwX2lkKTtcclxuXHRcdCQoXCIjYXBfd2FlaGxlbl9sYWJlbFwiKS5oaWRlKCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdHZhciBleHBvcnRlID0gdXJpLmdldFF1ZXJ5UGFyYW1WYWx1ZSgnZXhwb3J0ZScpO1xyXG5cdFx0aWYgKGV4cG9ydGUpIHtcclxuXHRcdFx0d2luZG93LmFwZi5pbml0aWllcmVfZXhwb3J0ZShhbmNob3IpO1xyXG5cdFx0fVxyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5hcGYuZ2V0SW50ZXJuZXRFeHBsb3JlclZlcnNpb24gPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcbi8vIFJldHVybnMgdGhlIHZlcnNpb24gb2YgSW50ZXJuZXQgRXhwbG9yZXIgb3IgYSAtMVxyXG4vLyAoaW5kaWNhdGluZyB0aGUgdXNlIG9mIGFub3RoZXIgYnJvd3NlcikuXHJcbiAgdmFyIHJ2ID0gLTE7IC8vIFJldHVybiB2YWx1ZSBhc3N1bWVzIGZhaWx1cmUuXHJcbiAgaWYgKG5hdmlnYXRvci5hcHBOYW1lID09ICdNaWNyb3NvZnQgSW50ZXJuZXQgRXhwbG9yZXInKSB7XHJcblx0dmFyIHVhID0gbmF2aWdhdG9yLnVzZXJBZ2VudCxcclxuXHRcdHJlICA9IG5ldyBSZWdFeHAoXCJNU0lFIChbMC05XXsxLH1bXFwuMC05XXswLH0pXCIpO1xyXG5cdGlmIChyZS5leGVjKHVhKSAhPSBudWxsKVxyXG5cdCAgcnYgPSBwYXJzZUZsb2F0KFJlZ0V4cC4kMSk7XHJcbiAgfVxyXG4gIHJldHVybiBydjtcclxufTtcclxuXHJcbndpbmRvdy5hcGYub2xtYXAuY3JlYXRlTGF5ZXJzRm9yT2xtYXAgPSBmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIC8vIGJpbmctbWFwcyB3w6RyZSBzY2jDtm5cclxuICAgIC8vIG9sMyBjYW4ndCByZXByb2plY3QgcmFzdGVyIHRpbGVzIHlldCB0aG91Z2hcclxuICAgIC8vIGRhaGVyIHdlcmRlbiBkaWUgTGF5ZXIgbm9jaCBuaWNodCBhbmdlemVpZ3RcclxuICAgIHZhciBiaW5nX3N0eWxlc19vYmplY3QgPSB7XHJcbiAgICAgICAgICAgICdBZXJpYWwnOiAnQmluZyBMdWZ0YmlsZCcsXHJcbiAgICAgICAgICAgICdBZXJpYWxXaXRoTGFiZWxzJzogJ0JpbmcgTHVmdGJpbGQgYmVzY2hyaWZ0ZXQnLFxyXG4gICAgICAgICAgICAnUm9hZCc6ICdCaW5nIFN0cmFzc2Vua2FydGUnXHJcbiAgICAgICAgfSxcclxuICAgICAgICBiaW5nX3N0eWxlcyA9IF8ua2V5cyhiaW5nX3N0eWxlc19vYmplY3QpLFxyXG4gICAgICAgIGJpbmdfbGF5ZXJzID0gW107XHJcbiAgICBfLmVhY2goYmluZ19zdHlsZXMsIGZ1bmN0aW9uKGJpbmdfc3R5bGUpIHtcclxuICAgICAgICBiaW5nX2xheWVycy5wdXNoKG5ldyBvbC5sYXllci5UaWxlKHtcclxuICAgICAgICAgICAgdGl0bGU6IGJpbmdfc3R5bGVzX29iamVjdFtiaW5nX3N0eWxlXSxcclxuICAgICAgICAgICAga2F0ZWdvcmllOiAnV2VsdCBIaW50ZXJncnVuZCcsXHJcbiAgICAgICAgICAgIHZpc2libGU6IGZhbHNlLFxyXG4gICAgICAgICAgICBwcmVsb2FkOiBJbmZpbml0eSxcclxuICAgICAgICAgICAgc291cmNlOiBuZXcgb2wuc291cmNlLkJpbmdNYXBzKHtcclxuICAgICAgICAgICAgICAgIC8vcHJvamVjdGlvbjogbmV3IG9sLnByb2ouRVBTRzIxNzgxKCksXHJcbiAgICAgICAgICAgICAgICAvL3Byb2plY3Rpb246IHByb2plY3Rpb24sXHJcbiAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiAnRVBTRzoyMTc4MScsXHJcbiAgICAgICAgICAgICAgICBrZXk6ICdBakdPdEJfeWdCcGxweFh0S2lpSHRtLUdFUmpTZzlURkVvQ211QklfWXo0Vld5MHVuUkdVRG85R09aSEE0NlBmJyxcclxuICAgICAgICAgICAgICAgIGltYWdlcnlTZXQ6IGJpbmdfc3R5bGVcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB2YXIgY2hfb3J0aG9sdWZ0YmlsZF9sYXllciA9IGdhLmxheWVyLmNyZWF0ZSgnY2guc3dpc3N0b3BvLnN3aXNzaW1hZ2UnKTtcclxuICAgIGNoX29ydGhvbHVmdGJpbGRfbGF5ZXIuc2V0KCd0aXRsZScsICdMdWZ0YmlsZCBDSCcpO1xyXG4gICAgY2hfb3J0aG9sdWZ0YmlsZF9sYXllci5zZXQoJ3Zpc2libGUnLCBmYWxzZSk7XHJcbiAgICBjaF9vcnRob2x1ZnRiaWxkX2xheWVyLnNldCgna2F0ZWdvcmllJywgJ0hpbnRlcmdydW5kJyk7XHJcblxyXG4gICAgdmFyIGNoX2xrX2dyYXVfbGF5ZXIgPSBnYS5sYXllci5jcmVhdGUoJ2NoLnN3aXNzdG9wby5waXhlbGthcnRlLWdyYXUnKTtcclxuICAgIGNoX2xrX2dyYXVfbGF5ZXIuc2V0KCd0aXRsZScsICdMYW5kZXNrYXJ0ZW4gQ0ggZ3JhdScpO1xyXG4gICAgY2hfbGtfZ3JhdV9sYXllci5zZXQoJ3Zpc2libGUnLCBmYWxzZSk7XHJcbiAgICBjaF9sa19ncmF1X2xheWVyLnNldCgna2F0ZWdvcmllJywgJ0hpbnRlcmdydW5kJyk7XHJcblxyXG4gICAgdmFyIGNoX2xrX2ZhcmJlX2xheWVyID0gZ2EubGF5ZXIuY3JlYXRlKCdjaC5zd2lzc3RvcG8ucGl4ZWxrYXJ0ZS1mYXJiZScpO1xyXG4gICAgY2hfbGtfZmFyYmVfbGF5ZXIuc2V0KCd0aXRsZScsICdMYW5kZXNrYXJ0ZW4gQ0ggZmFyYmlnJyk7XHJcbiAgICBjaF9sa19mYXJiZV9sYXllci5zZXQoJ3Zpc2libGUnLCB0cnVlKTtcclxuICAgIGNoX2xrX2ZhcmJlX2xheWVyLnNldCgna2F0ZWdvcmllJywgJ0hpbnRlcmdydW5kJyk7XHJcblxyXG4gICAgdmFyIGNoX3NpZWdyaWVka2FydGVfbGF5ZXIgPSBnYS5sYXllci5jcmVhdGUoJ2NoLnN3aXNzdG9wby5oaWtzLXNpZWdmcmllZCcpO1xyXG4gICAgY2hfc2llZ3JpZWRrYXJ0ZV9sYXllci5zZXQoJ3RpdGxlJywgJ1NpZWdmcmllZGthcnRlIDE4ODEnKTtcclxuICAgIGNoX3NpZWdyaWVka2FydGVfbGF5ZXIuc2V0KCd2aXNpYmxlJywgZmFsc2UpO1xyXG4gICAgY2hfc2llZ3JpZWRrYXJ0ZV9sYXllci5zZXQoJ2thdGVnb3JpZScsICdIaW50ZXJncnVuZCcpO1xyXG5cclxuICAgIHZhciBjaF9nZW1laW5kZW5fbGF5ZXIgPSBnYS5sYXllci5jcmVhdGUoJ2NoLnN3aXNzdG9wby12ZC5nZW9tZXRhLWdlbWVpbmRlJyk7XHJcbiAgICBjaF9nZW1laW5kZW5fbGF5ZXIuc2V0KCd0aXRsZScsICdHZW1laW5kZW4nKTtcclxuICAgIGNoX2dlbWVpbmRlbl9sYXllci5zZXQoJ3Zpc2libGUnLCBmYWxzZSk7XHJcbiAgICBjaF9nZW1laW5kZW5fbGF5ZXIuc2V0KCdrYXRlZ29yaWUnLCAnQ0ggU2FjaGluZm9ybWF0aW9uZW4nKTtcclxuXHJcbiAgICB2YXIgY2hfa2FudG9uZV9sYXllciA9IGdhLmxheWVyLmNyZWF0ZSgnY2guc3dpc3N0b3BvLnN3aXNzYm91bmRhcmllczNkLWthbnRvbi1mbGFlY2hlLmZpbGwnKTtcclxuICAgIGNoX2thbnRvbmVfbGF5ZXIuc2V0KCd0aXRsZScsICdLYW50b25lJyk7XHJcbiAgICBjaF9rYW50b25lX2xheWVyLnNldCgndmlzaWJsZScsIGZhbHNlKTtcclxuICAgIGNoX2thbnRvbmVfbGF5ZXIuc2V0KCdjcm9zc09yaWdpbicsIG51bGwpO1xyXG4gICAgY2hfa2FudG9uZV9sYXllci5zZXQoJ2thdGVnb3JpZScsICdDSCBTYWNoaW5mb3JtYXRpb25lbicpO1xyXG5cclxuICAgIHZhciBjaF9wYXJ6ZWxsZW5fbGF5ZXIgPSBnYS5sYXllci5jcmVhdGUoJ2NoLmthbnRvbmUuY2FkYXN0cmFsd2VibWFwLWZhcmJlJyk7XHJcbiAgICBjaF9wYXJ6ZWxsZW5fbGF5ZXIuc2V0KCd0aXRsZScsICdQYXJ6ZWxsZW4nKTtcclxuICAgIGNoX3BhcnplbGxlbl9sYXllci5zZXQoJ3Zpc2libGUnLCBmYWxzZSk7XHJcbiAgICBjaF9rYW50b25lX2xheWVyLnNldCgnY3Jvc3NPcmlnaW4nLCBudWxsKTtcclxuICAgIGNoX3BhcnplbGxlbl9sYXllci5zZXQoJ2thdGVnb3JpZScsICdDSCBTYWNoaW5mb3JtYXRpb25lbicpO1xyXG5cclxuICAgIHZhciBjaF9hbV9sYXllciA9IGdhLmxheWVyLmNyZWF0ZSgnY2guYmFmdS5idW5kZXNpbnZlbnRhcmUtYW1waGliaWVuJyk7XHJcbiAgICBjaF9hbV9sYXllci5zZXQoJ3RpdGxlJywgJ0FtcGhpYmllbicpO1xyXG4gICAgY2hfYW1fbGF5ZXIuc2V0KCd2aXNpYmxlJywgZmFsc2UpO1xyXG4gICAgY2hfYW1fbGF5ZXIuc2V0KCdrYXRlZ29yaWUnLCAnQ0ggQmlvdG9waW52ZW50YXJlJyk7XHJcblxyXG4gICAgdmFyIGNoX2FtX3dhbmRlcl9sYXllciA9IGdhLmxheWVyLmNyZWF0ZSgnY2guYmFmdS5idW5kZXNpbnZlbnRhcmUtYW1waGliaWVuX3dhbmRlcm9iamVrdGUnKTtcclxuICAgIGNoX2FtX3dhbmRlcl9sYXllci5zZXQoJ3RpdGxlJywgJ0FtcGhpYmllbiBXYW5kZXJvYmpla3RlJyk7XHJcbiAgICBjaF9hbV93YW5kZXJfbGF5ZXIuc2V0KCd2aXNpYmxlJywgZmFsc2UpO1xyXG4gICAgY2hfYW1fd2FuZGVyX2xheWVyLnNldCgna2F0ZWdvcmllJywgJ0NIIEJpb3RvcGludmVudGFyZScpO1xyXG5cclxuICAgIHZhciBjaF9hdWVuX2xheWVyID0gZ2EubGF5ZXIuY3JlYXRlKCdjaC5iYWZ1LmJ1bmRlc2ludmVudGFyZS1hdWVuJyk7XHJcbiAgICBjaF9hdWVuX2xheWVyLnNldCgndGl0bGUnLCAnQXVlbicpO1xyXG4gICAgY2hfYXVlbl9sYXllci5zZXQoJ3Zpc2libGUnLCBmYWxzZSk7XHJcbiAgICBjaF9hdWVuX2xheWVyLnNldCgna2F0ZWdvcmllJywgJ0NIIEJpb3RvcGludmVudGFyZScpO1xyXG5cclxuICAgIHZhciBjaF9mbV9sYXllciA9IGdhLmxheWVyLmNyZWF0ZSgnY2guYmFmdS5idW5kZXNpbnZlbnRhcmUtZmxhY2htb29yZScpO1xyXG4gICAgY2hfZm1fbGF5ZXIuc2V0KCd0aXRsZScsICdGbGFjaG1vb3JlJyk7XHJcbiAgICBjaF9mbV9sYXllci5zZXQoJ3Zpc2libGUnLCBmYWxzZSk7XHJcbiAgICBjaF9mbV9sYXllci5zZXQoJ2thdGVnb3JpZScsICdDSCBCaW90b3BpbnZlbnRhcmUnKTtcclxuXHJcbiAgICB2YXIgY2hfaG1fbGF5ZXIgPSBnYS5sYXllci5jcmVhdGUoJ2NoLmJhZnUuYnVuZGVzaW52ZW50YXJlLWhvY2htb29yZScpO1xyXG4gICAgY2hfaG1fbGF5ZXIuc2V0KCd0aXRsZScsICdIb2NoY2htb29yZScpO1xyXG4gICAgY2hfaG1fbGF5ZXIuc2V0KCd2aXNpYmxlJywgZmFsc2UpO1xyXG4gICAgY2hfaG1fbGF5ZXIuc2V0KCdrYXRlZ29yaWUnLCAnQ0ggQmlvdG9waW52ZW50YXJlJyk7XHJcblxyXG4gICAgdmFyIGNoX3R3d19sYXllciA9IGdhLmxheWVyLmNyZWF0ZSgnY2guYmFmdS5idW5kZXNpbnZlbnRhcmUtdHJvY2tlbndpZXNlbl90cm9ja2Vud2VpZGVuJyk7XHJcbiAgICBjaF90d3dfbGF5ZXIuc2V0KCd0aXRsZScsICdUcm9ja2Vud2llc2VuIHVuZCAtd2VpZGVuJyk7XHJcbiAgICBjaF90d3dfbGF5ZXIuc2V0KCd2aXNpYmxlJywgZmFsc2UpO1xyXG4gICAgY2hfdHd3X2xheWVyLnNldCgna2F0ZWdvcmllJywgJ0NIIEJpb3RvcGludmVudGFyZScpO1xyXG5cclxuICAgIHZhciBjaF92b2dlbHJlc2VydmF0ZV9sYXllciA9IGdhLmxheWVyLmNyZWF0ZSgnY2guYmFmdS5idW5kZXNpbnZlbnRhcmUtdm9nZWxyZXNlcnZhdGUnKTtcclxuICAgIGNoX3ZvZ2VscmVzZXJ2YXRlX2xheWVyLnNldCgndGl0bGUnLCAnVm9nZWxyZXNlcnZhdGUnKTtcclxuICAgIGNoX3ZvZ2VscmVzZXJ2YXRlX2xheWVyLnNldCgndmlzaWJsZScsIGZhbHNlKTtcclxuICAgIGNoX3ZvZ2VscmVzZXJ2YXRlX2xheWVyLnNldCgna2F0ZWdvcmllJywgJ0NIIEJpb3RvcGludmVudGFyZScpO1xyXG5cclxuICAgIHZhciBkZXRhaWxwbMOkbmVfbGF5ZXJfc291cmNlID0gbmV3IG9sLnNvdXJjZS5HZW9KU09OKHtcclxuICAgICAgICB1cmw6ICdnZW9qc29uL2RldGFpbHBsYWVuZS5nZW9qc29uJy8qLFxyXG4gICAgICAgICBteVR5cDogJ0RldGFpbHBsYW4nKi9cdC8vIGZ1bmt0aW9uaWVydCBuaWNodFxyXG4gICAgfSk7XHJcbiAgICAvKiBmdW5rdGlvbmllcnQgbmljaHQ6XHJcbiAgICAgZGV0YWlscGzDpG5lX2xheWVyX3NvdXJjZS5mb3JFYWNoRmVhdHVyZShmdW5jdGlvbihmZWF0dXJlKSB7XHJcbiAgICAgZmVhdHVyZS5zZXRWYWx1ZXMoJ215VHlwJywgJ0RldGFpbHBsYW4nKTtcclxuICAgICB9KTsqL1xyXG5cclxuICAgIHZhciBkZXRhaWxwbMOkbmVfbGF5ZXIgPSBuZXcgb2wubGF5ZXIuVmVjdG9yKHtcclxuICAgICAgICB0aXRsZTogJ0RldGFpbHBsw6RuZScsXHJcbiAgICAgICAgb3BhY2l0eTogMSxcclxuICAgICAgICB2aXNpYmxlOiBmYWxzZSxcclxuICAgICAgICBrYXRlZ29yaWU6ICdBUCBGbG9yYScsXHJcbiAgICAgICAgc2VsZWN0YWJsZTogdHJ1ZSxcclxuICAgICAgICBzb3VyY2U6IGRldGFpbHBsw6RuZV9sYXllcl9zb3VyY2UsXHJcbiAgICAgICAgc3R5bGU6IHdpbmRvdy5hcGYub2xtYXAuZGV0YWlscGxhblN0eWxlKClcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIGF1c2dlc2NoYWx0ZXQsIGRhIGVzIG5pY2h0IGZ1bmt0aW9uaWVydCAoYXV0aG9yaXphdGlvbiByZXF1aXJlZClcclxuICAgIHZhciB6aF9hdl9sYXllciA9IG5ldyBvbC5sYXllci5UaWxlKHtcclxuICAgICAgICB0aXRsZTogJ0FtdGxpY2hlIFZlcm1lc3N1bmcnLFxyXG4gICAgICAgIHZpc2libGU6IGZhbHNlLFxyXG4gICAgICAgIGthdGVnb3JpZTogJ1pIIFNhY2hpbmZvcm1hdGlvbmVuJyxcclxuICAgICAgICBzb3VyY2U6IG5ldyBvbC5zb3VyY2UuVGlsZVdNUyh7XHJcbiAgICAgICAgICAgIHVybDogJy8vYWdhYnJpZWw6NHpDNk1nak1Ad21zLnpoLmNoL2F2d21zJyxcclxuICAgICAgICAgICAgLy91cmw6ICcvL3dtcy56aC5jaC9hdndtcycsXHJcbiAgICAgICAgICAgIGNyb3NzT3JpZ2luOiBudWxsLFxyXG4gICAgICAgICAgICBwYXJhbXM6IHtcclxuICAgICAgICAgICAgICAgICdsYXllcnMnOiAnbGllZ2Vuc2NoYWZ0ZW4nXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gT0wzIGhhdCBub2NoIFByb2JsZW1lIHVuZCBiZXJlaW5pZ3QgZGllIE1ldGhvZGVuIGbDvHIgV0ZTIC0genV3YXJ0ZW5cclxuICAgIHZhciB6aF9rYXJ0aWVydW5nZW5fbGF5ZXJfc291cmNlID0gbmV3IG9sLnNvdXJjZS5TZXJ2ZXJWZWN0b3Ioe1xyXG4gICAgXHQvL2Zvcm1hdDogbmV3IG9sLmZvcm1hdC5HZW9KU09OKCksXHQvLyBob2x0IG5pY2h0IG1hbCBkaWUgRGF0ZW5cclxuICAgIFx0Zm9ybWF0OiBuZXcgb2wuZm9ybWF0LldGUyh7XHQvLyBob2x0IGRpZSBEYXRlbiAtIHNvbGx0ZSBhYmVyIGJhbGQgZGllIEF0dHJyaWJ1dGUgbmljaHQgbWVociBiZW7DtnRpZ2VuXHJcbiAgICBcdFx0ZmVhdHVyZU5TOiAnLy9tYXBzLnpoLmNoJyxcclxuICAgIFx0XHRmZWF0dXJlVHlwZTogJ3BvbHlnb24nXHJcbiAgICBcdH0pLFxyXG4gICAgXHQvL2Zvcm1hdDogbmV3IG9sLmZvcm1hdC5HTUwoKSxcclxuICAgIFx0bG9hZGVyOiBmdW5jdGlvbihleHRlbnQsIHJlc29sdXRpb24sIHByb2plY3Rpb24pIHtcclxuXHRcdFx0JC5hamF4KHtcclxuXHRcdFx0XHR0eXBlOiBHRVQsXHJcblx0XHRcdFx0dXJsOiAnLy9tYXBzLnpoLmNoL3dmcy9GbnNOU1dGUycsXHJcblx0XHRcdFx0ZGF0YToge1xyXG5cdFx0XHRcdFx0U0VSVklDRTogJ1dGUycsXHJcblx0XHRcdFx0XHRWRVJTSU9OOiAnMS4wLjAnLFxyXG5cdFx0XHRcdFx0UkVRVUVTVDogJ0dldEZlYXR1cmUnLFxyXG5cdFx0XHRcdFx0VFlQRU5BTUU6ICdscm1fdmVnJyxcclxuXHRcdFx0XHRcdFNSU05BTUU6ICdFUFNHOjIxNzgxJyxcclxuXHRcdFx0XHRcdGJib3g6IGV4dGVudC5qb2luKCcsJykgKyAnLEVQU0c6MjE3ODEnXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRkYXRhVHlwZTogJ2pzb25wJyxcclxuXHRcdFx0XHRqc29ucENhbGxiYWNrOiAnbG9hZF96aF9rYXJ0aWVydW5nZW5fbGF5ZXJfc291cmNlJ1xyXG5cdFx0XHR9KTtcclxuICAgIFx0fSxcclxuXHRcdHN0cmF0ZWd5OiBvbC5sb2FkaW5nc3RyYXRlZ3kuY3JlYXRlVGlsZShuZXcgb2wudGlsZWdyaWQuWFlaKHtcclxuXHRcdFx0bWF4Wm9vbTogMTlcclxuXHRcdH0pKSxcclxuXHRcdHByb2plY3Rpb246ICdFUFNHOjIxNzgxJ1xyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIGxvYWRfemhfa2FydGllcnVuZ2VuX2xheWVyX3NvdXJjZSA9IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICBcdC8vY29uc29sZS5sb2coJ3Jlc3BvbnNlJywgcmVzcG9uc2UpO1xyXG5cdCAgXHR6aF9rYXJ0aWVydW5nZW5fbGF5ZXJfc291cmNlLmFkZEZlYXR1cmVzKHpoX2thcnRpZXJ1bmdlbl9sYXllcl9zb3VyY2UucmVhZEZlYXR1cmVzKHJlc3BvbnNlKSk7XHQvLyBmdW5rdGlvbmllcnQgbmljaHQhXHJcblx0fTtcclxuXHJcbiAgICB2YXIgemhfa2FydGllcnVuZ2VuX2xheWVyID0gbmV3IG9sLmxheWVyLlZlY3Rvcih7XHJcbiAgICAgICAgdGl0bGU6ICdMZWJlbnNyYXVtLUthcnRpZXJ1bmdlbicsXHJcbiAgICAgICAgb3BhY2l0eTogMC43LFxyXG4gICAgICAgIHZpc2libGU6IGZhbHNlLFxyXG4gICAgICAgIGthdGVnb3JpZTogJ1pIIFNhY2hpbmZvcm1hdGlvbmVuJyxcclxuICAgICAgICBzb3VyY2U6IHpoX2thcnRpZXJ1bmdlbl9sYXllcl9zb3VyY2UsXHJcbiAgICAgICAgc3R5bGU6IG5ldyBvbC5zdHlsZS5TdHlsZSh7XHJcblx0XHRcdHN0cm9rZTogbmV3IG9sLnN0eWxlLlN0cm9rZSh7XHJcblx0XHRcdFx0Y29sb3I6ICdyZ2JhKDAsIDAsIDI1NSwgMS4wKScsXHJcblx0XHRcdFx0d2lkdGg6IDJcclxuXHRcdFx0fSlcclxuXHRcdH0pXHJcbiAgICB9KTtcclxuXHJcbiAgICB2YXIgemhfc3ZvX2ZhcmJpZ19sYXllciA9IG5ldyBvbC5sYXllci5UaWxlKHtcclxuICAgICAgICB0aXRsZTogJ1NWTyBmYXJiaWcnLFxyXG4gICAgICAgIG9wYWNpdHk6IDAuNyxcclxuICAgICAgICB2aXNpYmxlOiBmYWxzZSxcclxuICAgICAgICBrYXRlZ29yaWU6ICdaSCBTYWNoaW5mb3JtYXRpb25lbicsXHJcbiAgICAgICAgbGVnZW5kZTogdHJ1ZSxcclxuICAgICAgICBsZWdlbmRlX3VybDogJ2h0dHA6Ly93bXMuemguY2gvRm5zU1ZPWkhXTVM/dmVyc2lvbj0xLjMuMCZzZXJ2aWNlPVdNUyZyZXF1ZXN0PUdldExlZ2VuZEdyYXBoaWMmc2xkX3ZlcnNpb249MS4xLjAmbGF5ZXI9em9uZW4tc2NodXR6dmVyb3JkbnVuZ2VuJmZvcm1hdD1pbWFnZS9wbmcmU1RZTEU9ZGVmYXVsdCcsXHJcbiAgICAgICAgc291cmNlOiBuZXcgb2wuc291cmNlLlRpbGVXTVMoe1xyXG4gICAgICAgICAgICB1cmw6ICcvL3dtcy56aC5jaC9GbnNTVk9aSFdNUycsXHJcbiAgICAgICAgICAgIGNyb3NzT3JpZ2luOiBudWxsLFxyXG4gICAgICAgICAgICBwYXJhbXM6IHtcclxuICAgICAgICAgICAgICAgICdsYXllcnMnOiAnem9uZW4tc2NodXR6dmVyb3JkbnVuZ2VuLHVlYmVybGFnZXJuZGUtc2NodXR6em9uZW4sc2NodXR6dmVyb3JkbnVuZ3NvYmpla3RlLHN2by16b25lbi1sYWJlbHMsc2NodXR6dmVyb3JkbnVuZ3NvYmpla3QtbnInXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIHpoX3N2b19ncmF1X2xheWVyID0gbmV3IG9sLmxheWVyLlRpbGUoe1xyXG4gICAgICAgIHRpdGxlOiAnU1ZPIHNjaHdhcnovd2Vpc3MnLFxyXG4gICAgICAgIHZpc2libGU6IGZhbHNlLFxyXG4gICAgICAgIGthdGVnb3JpZTogJ1pIIFNhY2hpbmZvcm1hdGlvbmVuJyxcclxuICAgICAgICBsZWdlbmRlOiB0cnVlLFxyXG4gICAgICAgIGxlZ2VuZGVfdXJsOiAnaHR0cDovL3dtcy56aC5jaC9GbnNTVk9aSFdNUz92ZXJzaW9uPTEuMy4wJnNlcnZpY2U9V01TJnJlcXVlc3Q9R2V0TGVnZW5kR3JhcGhpYyZzbGRfdmVyc2lvbj0xLjEuMCZsYXllcj16b25lbi1zY2h1dHp2ZXJvcmRudW5nZW4tcmFzdGVyJmZvcm1hdD1pbWFnZS9wbmcmU1RZTEU9ZGVmYXVsdCcsXHJcbiAgICAgICAgc291cmNlOiBuZXcgb2wuc291cmNlLlRpbGVXTVMoe1xyXG4gICAgICAgICAgICB1cmw6ICcvL3dtcy56aC5jaC9GbnNTVk9aSFdNUycsXHJcbiAgICAgICAgICAgIGNyb3NzT3JpZ2luOiBudWxsLFxyXG4gICAgICAgICAgICBwYXJhbXM6IHtcclxuICAgICAgICAgICAgICAgICdsYXllcnMnOiAnem9uZW4tc2NodXR6dmVyb3JkbnVuZ2VuLXJhc3Rlcix1ZWJlcmxhZ2VybmRlLXNjaHV0enpvbmVuLHNjaHV0enZlcm9yZG51bmdzb2JqZWt0ZSxzdm8tem9uZW4tbGFiZWxzLHNjaHV0enZlcm9yZG51bmdzb2JqZWt0LW5yJyxcclxuICAgICAgICAgICAgICAgICdzaW5nbGVUaWxlJzogdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH0pO1xyXG5cclxuICAgIHZhciB6aF9saWNodGVfd8OkbGRlcl9sYXllciA9IG5ldyBvbC5sYXllci5UaWxlKHtcclxuICAgICAgICB0aXRsZTogJ1fDpGxkZXI6IGxpY2h0ZScsXHJcbiAgICAgICAgdmlzaWJsZTogZmFsc2UsXHJcbiAgICAgICAga2F0ZWdvcmllOiAnWkggU2FjaGluZm9ybWF0aW9uZW4nLFxyXG4gICAgICAgIGxlZ2VuZGU6IHRydWUsXHJcbiAgICAgICAgbGVnZW5kZV91cmw6ICdodHRwOi8vd21zLnpoLmNoL0Zuc0xXWkhXTVM/dmVyc2lvbj0xLjMuMCZzZXJ2aWNlPVdNUyZyZXF1ZXN0PUdldExlZ2VuZEdyYXBoaWMmc2xkX3ZlcnNpb249MS4xLjAmbGF5ZXI9b2JqZWt0ZS1saWNodGUtd2FlbGRlci1rYW50b24tenVlcmljaCZmb3JtYXQ9aW1hZ2UvcG5nJlNUWUxFPWRlZmF1bHQnLFxyXG4gICAgICAgIHNvdXJjZTogbmV3IG9sLnNvdXJjZS5UaWxlV01TKHtcclxuICAgICAgICAgICAgdXJsOiAnLy9tYXBzLnpoLmNoL3dtcy9GbnNMV1pIJyxcclxuICAgICAgICAgICAgY3Jvc3NPcmlnaW46IG51bGwsXHJcbiAgICAgICAgICAgIHBhcmFtczoge1xyXG4gICAgICAgICAgICAgICAgJ2xheWVycyc6ICdvYmpla3RlLWxpY2h0ZS13YWVsZGVyLWthbnRvbi16dWVyaWNoJyxcclxuICAgICAgICAgICAgICAgICdzaW5nbGVUaWxlJzogdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIG5pY2h0IGVpbmdlc2NoYWx0ZXQsIGRhIG9obmUgTGVnZW5kZSB3ZW5pZyBicmF1Y2hiYXJcclxuICAgIHZhciB6aF93YWxka2FydGllcnVuZ19sYXllciA9IG5ldyBvbC5sYXllci5UaWxlKHtcclxuICAgICAgICB0aXRsZTogJ1fDpGxkZXI6IFZlZ2V0YXRpb24nLFxyXG4gICAgICAgIHZpc2libGU6IGZhbHNlLFxyXG4gICAgICAgIGthdGVnb3JpZTogJ1pIIFNhY2hpbmZvcm1hdGlvbmVuJyxcclxuICAgICAgICBsZWdlbmRlOiB0cnVlLFxyXG4gICAgICAgIGxlZ2VuZGVfdXJsOiAnaHR0cDovL3dtcy56aC5jaC9XYWxkVktXTVM/dmVyc2lvbj0xLjMuMCZzZXJ2aWNlPVdNUyZyZXF1ZXN0PUdldExlZ2VuZEdyYXBoaWMmc2xkX3ZlcnNpb249MS4xLjAmbGF5ZXI9d2FsZGdlc2VsbHNjaGFmdGVuJmZvcm1hdD1pbWFnZS9wbmcmU1RZTEU9ZGVmYXVsdCcsXHJcbiAgICAgICAgc291cmNlOiBuZXcgb2wuc291cmNlLlRpbGVXTVMoe1xyXG4gICAgICAgICAgICB1cmw6ICcvL21hcHMuemguY2gvd21zL1dhbGRWS1dNUycsXHJcbiAgICAgICAgICAgIGNyb3NzT3JpZ2luOiBudWxsLFxyXG4gICAgICAgICAgICBwYXJhbXM6IHtcclxuICAgICAgICAgICAgICAgICdsYXllcnMnOiAnd2FsZGdlc2VsbHNjaGFmdGVuJyxcclxuICAgICAgICAgICAgICAgICdzaW5nbGVUaWxlJzogdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIG5pY2h0IGltIEdlYnJhdWNoXHJcbiAgICB2YXIgemhfZ2VtZWluZGVuX2xheWVyID0gbmV3IG9sLmxheWVyLlRpbGUoe1xyXG4gICAgICAgIHRpdGxlOiAnS2FudG9uJyxcclxuICAgICAgICB2aXNpYmxlOiBmYWxzZSxcclxuICAgICAgICBrYXRlZ29yaWU6ICdaSCBTYWNoaW5mb3JtYXRpb25lbicsXHJcbiAgICAgICAgc291cmNlOiBuZXcgb2wuc291cmNlLlRpbGVXTVMoe1xyXG4gICAgICAgICAgICB1cmw6ICcvL21hcHMuemguY2gvd21zL0JBU0lTS0FSVEVaSCcsXHJcbiAgICAgICAgICAgIGNyb3NzT3JpZ2luOiBudWxsLFxyXG4gICAgICAgICAgICBwYXJhbXM6IHtcclxuICAgICAgICAgICAgICAgICdsYXllcnMnOiAnZ3JlbnplbixnZW1laW5kZWdyZW56ZW4nLFxyXG4gICAgICAgICAgICAgICAgJ3NpbmdsZVRpbGUnOiB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gZXJyb3IgNDAxIChBdXRob3JpemF0aW9uIHJlcXVpcmVkKVxyXG4gICAgdmFyIHpoX29ydGhvbHVmdGJpbGRfbGF5ZXJfMSA9IG5ldyBvbC5sYXllci5UaWxlKHtcclxuICAgICAgICB0aXRsZTogJ0x1ZnRiaWxkJyxcclxuICAgICAgICB2aXNpYmxlOiBmYWxzZSxcclxuICAgICAgICBrYXRlZ29yaWU6ICdIaW50ZXJncnVuZCcsXHJcbiAgICAgICAgc291cmNlOiBuZXcgb2wuc291cmNlLlRpbGVXTVMoe1xyXG4gICAgICAgICAgICB1cmw6ICcvL2FnYWJyaWVsOjR6QzZNZ2pNQHdtcy56aC5jaC9PcnRob1pIV01TJyxcclxuICAgICAgICAgICAgY3Jvc3NPcmlnaW46IG51bGwsXHJcbiAgICAgICAgICAgIHBhcmFtczoge1xyXG4gICAgICAgICAgICAgICAgJ2xheWVycyc6ICdvcnRob3Bob3RvcycsXHJcbiAgICAgICAgICAgICAgICAnc2luZ2xlVGlsZSc6IHRydWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBlcnJvciA0MDEgKEF1dGhvcml6YXRpb24gcmVxdWlyZWQpXHJcbiAgICB2YXIgemhfb3J0aG9sdWZ0YmlsZF9sYXllciA9IG5ldyBvbC5sYXllci5UaWxlKHtcclxuICAgICAgICB0aXRsZTogJ0x1ZnRiaWxkIFpIJyxcclxuICAgICAgICB2aXNpYmxlOiBmYWxzZSxcclxuICAgICAgICBrYXRlZ29yaWU6ICdIaW50ZXJncnVuZCcsXHJcbiAgICAgICAgc291cmNlOiBuZXcgb2wuc291cmNlLlRpbGVXTVMoe1xyXG4gICAgICAgICAgICB1cmw6ICcvL21hcHMuemguY2gvd21zL09ydGhvQmFja2dyb3VuZFpIJyxcclxuICAgICAgICAgICAgY3Jvc3NPcmlnaW46IG51bGwsXHJcbiAgICAgICAgICAgIHBhcmFtczoge1xyXG4gICAgICAgICAgICAgICAgJ2xheWVycyc6ICdvcnRob2FrdHVlbGwnLFxyXG4gICAgICAgICAgICAgICAgJ3NpbmdsZVRpbGUnOiB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIHpoX8O8cF9sYXllciA9IG5ldyBvbC5sYXllci5UaWxlKHtcclxuICAgICAgICB0aXRsZTogJ8OcYmVyc2ljaHRzcGxhbiBaSCcsXHJcbiAgICAgICAgdmlzaWJsZTogZmFsc2UsXHJcbiAgICAgICAga2F0ZWdvcmllOiAnSGludGVyZ3J1bmQnLFxyXG4gICAgICAgIHNvdXJjZTogbmV3IG9sLnNvdXJjZS5UaWxlV01TKHtcclxuICAgICAgICAgICAgdXJsOiAnaHR0cDovL3dtcy56aC5jaC91cHdtcycsXHJcbiAgICAgICAgICAgIGNyb3NzT3JpZ2luOiBudWxsLFxyXG4gICAgICAgICAgICBwYXJhbXM6IHtcclxuICAgICAgICAgICAgICAgICdsYXllcnMnOiAndXB3bXMnLFxyXG4gICAgICAgICAgICAgICAgJ3NpbmdsZVRpbGUnOiB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIHpoX2Jhc2lza2FydGVuX2xheWVyID0gbmV3IG9sLmxheWVyLlRpbGUoe1xyXG4gICAgICAgIHRpdGxlOiAnTGFuZGVza2FydGVuIFpIJyxcclxuICAgICAgICB2aXNpYmxlOiBmYWxzZSxcclxuICAgICAgICBrYXRlZ29yaWU6ICdIaW50ZXJncnVuZCcsXHJcbiAgICAgICAgc291cmNlOiBuZXcgb2wuc291cmNlLlRpbGVXTVMoe1xyXG4gICAgICAgICAgICB1cmw6ICcvL21hcHMuemguY2gvd21zL0JBU0lTS0FSVEVaSCcsXHJcbiAgICAgICAgICAgIGNyb3NzT3JpZ2luOiBudWxsLFxyXG4gICAgICAgICAgICBwYXJhbXM6IHtcclxuICAgICAgICAgICAgICAgICdsYXllcnMnOiAnd2FsZCxzZWVuLGxrNTAwLGxrMjAwLGxrMTAwLGxrNTAsbGsyNSx1cDgsdXAyNCcsXHJcbiAgICAgICAgICAgICAgICAnc2luZ2xlVGlsZSc6IHRydWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9KTtcclxuXHJcbiAgICB2YXIgemhfaMO2aGVubW9kZWxsX2xheWVyID0gbmV3IG9sLmxheWVyLlRpbGUoe1xyXG4gICAgICAgIHRpdGxlOiAnSMO2aGVubW9kZWxsIFpIJyxcclxuICAgICAgICB2aXNpYmxlOiBmYWxzZSxcclxuICAgICAgICBrYXRlZ29yaWU6ICdIaW50ZXJncnVuZCcsXHJcbiAgICAgICAgc291cmNlOiBuZXcgb2wuc291cmNlLlRpbGVXTVMoe1xyXG4gICAgICAgICAgICB1cmw6ICcvL21hcHMuemguY2gvd21zL0RUTUJhY2tncm91bmRaSCcsXHJcbiAgICAgICAgICAgIGNyb3NzT3JpZ2luOiBudWxsLFxyXG4gICAgICAgICAgICBwYXJhbXM6IHtcclxuICAgICAgICAgICAgICAgICdsYXllcnMnOiAnZHRtJyxcclxuICAgICAgICAgICAgICAgICdzaW5nbGVUaWxlJzogdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIFp1bsOkY2hzdCBhbGxlIExheWVyIGRlZmluaWVyZW5cclxuICAgIHZhciBsYXllcnNfcHJvdiA9IFtcclxuICAgIFx0emhfaMO2aGVubW9kZWxsX2xheWVyLFxyXG4gICAgICAgIHpoX29ydGhvbHVmdGJpbGRfbGF5ZXIsXHJcbiAgICAgICAgY2hfb3J0aG9sdWZ0YmlsZF9sYXllcixcclxuICAgICAgICB6aF9iYXNpc2thcnRlbl9sYXllcixcclxuICAgICAgICBjaF9sa19ncmF1X2xheWVyLFxyXG4gICAgICAgIGNoX2xrX2ZhcmJlX2xheWVyLFxyXG4gICAgICAgIGNoX3NpZWdyaWVka2FydGVfbGF5ZXIsXHJcbiAgICAgICAgY2hfcGFyemVsbGVuX2xheWVyLFxyXG4gICAgICAgIGNoX2dlbWVpbmRlbl9sYXllcixcclxuICAgICAgICBjaF9hbV9sYXllcixcclxuICAgICAgICBjaF9hbV93YW5kZXJfbGF5ZXIsXHJcbiAgICAgICAgY2hfYXVlbl9sYXllcixcclxuICAgICAgICBjaF9mbV9sYXllcixcclxuICAgICAgICBjaF9obV9sYXllcixcclxuICAgICAgICBjaF90d3dfbGF5ZXIsXHJcbiAgICAgICAgY2hfdm9nZWxyZXNlcnZhdGVfbGF5ZXIsXHJcbiAgICAgICAgY2hfa2FudG9uZV9sYXllcixcclxuICAgICAgICB6aF/DvHBfbGF5ZXIsXHJcbiAgICAgICAgemhfc3ZvX2ZhcmJpZ19sYXllcixcclxuICAgICAgICB6aF9zdm9fZ3JhdV9sYXllcixcclxuICAgICAgICAvL3poX2thcnRpZXJ1bmdlbl9sYXllcixcdC8vIHdhcnRlbiwgZGFzIE9MMyBtaXQgV0ZTIG5vY2ggbmljaHQgZnVua3Rpb25pZXJ0XHJcbiAgICAgICAgemhfbGljaHRlX3fDpGxkZXJfbGF5ZXIsXHJcbiAgICAgICAgemhfd2FsZGthcnRpZXJ1bmdfbGF5ZXIsXHJcbiAgICAgICAgZGV0YWlscGzDpG5lX2xheWVyXHJcbiAgICBdO1xyXG5cclxuICAgIC8vIGJpbmctbGF5ZXJzIHZvcm5lIHNldHplblxyXG4gICAgLy8gYmluZy1tYXBzIHfDpHJlIHNjaMO2blxyXG4gICAgLy8gb2wzIGNhbid0IHJlcHJvamVjdCByYXN0ZXIgdGlsZXMgeWV0IHRob3VnaFxyXG4gICAgLy8gZGFoZXIgd2VyZGVuIGRpZSBMYXllciBub2NoIG5pY2h0IGFuZ2V6ZWlndFxyXG4gICAgLy92YXIgbGF5ZXJzID0gbGF5ZXJzX3Byb3YuY29uY2F0KGJpbmdfbGF5ZXJzKTtcclxuICAgIHZhciBsYXllcnMgPSBsYXllcnNfcHJvdjtcclxuXHJcbiAgICAvLyBwcsO8ZmVuLCBvYiBpbiBsb2NhbFN0b3JhZ2UgZWlnZW5lIExheWVyIGV4aXN0aWVyZW5cclxuICAgIC8vIGF1c2dlc2NoYWx0ZXQsIHdlaWwgZGllIExheWVyT2JqZWt0ZSB2b24gT0wzIHJla3Vyc2l2IHNpbmQgdW5kIG5pY2h0IGbDvHIgZGllIGxvY2FsU3RvcmFnZSBzdHJpbmdpZmllZCB3ZXJkZW4ga8O2bm5lblxyXG4gICAgaWYgKGxvY2FsU3RvcmFnZS5vbG1hcF9laWdlbmVfZWJlbmVuKSB7XHJcbiAgICAgICAgLy8gZHJhZyBhbmQgZHJvcCBnZW8tZmlsZXNcclxuICAgICAgICB2YXIgZGVmYXVsdFN0eWxlID0ge1xyXG4gICAgICAgICAgICAnUG9pbnQnOiBbbmV3IG9sLnN0eWxlLlN0eWxlKHtcclxuICAgICAgICAgICAgICAgIGltYWdlOiBuZXcgb2wuc3R5bGUuQ2lyY2xlKHtcclxuICAgICAgICAgICAgICAgICAgICBmaWxsOiBuZXcgb2wuc3R5bGUuRmlsbCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAncmdiYSgyNTUsMjU1LDAsMC41KSdcclxuICAgICAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgICAgICByYWRpdXM6IDUsXHJcbiAgICAgICAgICAgICAgICAgICAgc3Ryb2tlOiBuZXcgb2wuc3R5bGUuU3Ryb2tlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICcjZmYwJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDFcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSldLFxyXG4gICAgICAgICAgICAnTGluZVN0cmluZyc6IFtuZXcgb2wuc3R5bGUuU3R5bGUoe1xyXG4gICAgICAgICAgICAgICAgc3Ryb2tlOiBuZXcgb2wuc3R5bGUuU3Ryb2tlKHtcclxuICAgICAgICAgICAgICAgICAgICBjb2xvcjogJyNmMDAnLFxyXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiAzXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9KV0sXHJcbiAgICAgICAgICAgICdQb2x5Z29uJzogW25ldyBvbC5zdHlsZS5TdHlsZSh7XHJcbiAgICAgICAgICAgICAgICBmaWxsOiBuZXcgb2wuc3R5bGUuRmlsbCh7XHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdyZ2JhKDAsMjU1LDI1NSwwLjUpJ1xyXG4gICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICBzdHJva2U6IG5ldyBvbC5zdHlsZS5TdHJva2Uoe1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnIzBmZicsXHJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDFcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0pXSxcclxuICAgICAgICAgICAgJ011bHRpUG9pbnQnOiBbbmV3IG9sLnN0eWxlLlN0eWxlKHtcclxuICAgICAgICAgICAgICAgIGltYWdlOiBuZXcgb2wuc3R5bGUuQ2lyY2xlKHtcclxuICAgICAgICAgICAgICAgICAgICBmaWxsOiBuZXcgb2wuc3R5bGUuRmlsbCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAncmdiYSgyNTUsMCwyNTUsMC41KSdcclxuICAgICAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgICAgICByYWRpdXM6IDUsXHJcbiAgICAgICAgICAgICAgICAgICAgc3Ryb2tlOiBuZXcgb2wuc3R5bGUuU3Ryb2tlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICcjZjBmJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDFcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSldLFxyXG4gICAgICAgICAgICAnTXVsdGlMaW5lU3RyaW5nJzogW25ldyBvbC5zdHlsZS5TdHlsZSh7XHJcbiAgICAgICAgICAgICAgICBzdHJva2U6IG5ldyBvbC5zdHlsZS5TdHJva2Uoe1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnIzBmMCcsXHJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDNcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0pXSxcclxuICAgICAgICAgICAgJ011bHRpUG9seWdvbic6IFtuZXcgb2wuc3R5bGUuU3R5bGUoe1xyXG4gICAgICAgICAgICAgICAgZmlsbDogbmV3IG9sLnN0eWxlLkZpbGwoe1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiAncmdiYSgwLDAsMjU1LDAuNSknXHJcbiAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgIHN0cm9rZTogbmV3IG9sLnN0eWxlLlN0cm9rZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6ICcjMDBmJyxcclxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogMVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSldXHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgc3R5bGVGdW5jdGlvbiA9IGZ1bmN0aW9uKGZlYXR1cmUsIHJlc29sdXRpb24pIHtcclxuICAgICAgICAgICAgdmFyIGZlYXR1cmVTdHlsZUZ1bmN0aW9uID0gZmVhdHVyZS5nZXRTdHlsZUZ1bmN0aW9uKCk7XHJcbiAgICAgICAgICAgIGlmIChmZWF0dXJlU3R5bGVGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZlYXR1cmVTdHlsZUZ1bmN0aW9uLmNhbGwoZmVhdHVyZSwgcmVzb2x1dGlvbik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdFN0eWxlW2ZlYXR1cmUuZ2V0R2VvbWV0cnkoKS5nZXRUeXBlKCldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyBkaWVzZSBoaW56dWbDvGdlblxyXG4gICAgICAgIHZhciBlaWdlbmVfZWJlbmVuID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2Uub2xtYXBfZWlnZW5lX2ViZW5lbiksXHJcbiAgICAgICAgICAgIGVpZ2VuZV9lYmVuZW5fbGF5ZXJzID0gW107XHJcbiAgICAgICAgXy5lYWNoKGVpZ2VuZV9lYmVuZW4sIGZ1bmN0aW9uKGViZW5lKSB7XHJcbiAgICAgICAgICAgIHZhciBmb3JtYXQgPSBuZXcgb2wuZm9ybWF0Lkdlb0pTT04oKSxcclxuICAgICAgICAgICAgICAgIGZlYXR1cmVzID0gZm9ybWF0LnJlYWRGZWF0dXJlcyhlYmVuZSk7XHJcbiAgICAgICAgICAgIC8vd2luZG93LmVpZ2VuZV9lYmVuZW4ucHVzaChmZWF0dXJlcyk7XHJcbiAgICAgICAgICAgIHZhciB2ZWN0b3JTb3VyY2UgPSBuZXcgb2wuc291cmNlLlZlY3Rvcih7XHJcbiAgICAgICAgICAgICAgICBmZWF0dXJlczogZmVhdHVyZXNcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHZhciBsYXllciA9IG5ldyBvbC5sYXllci5WZWN0b3Ioe1xyXG4gICAgICAgICAgICAgICAgZ3VpZDogZWJlbmUuZ3VpZCxcclxuICAgICAgICAgICAgICAgIHNvdXJjZTogdmVjdG9yU291cmNlLFxyXG4gICAgICAgICAgICAgICAgc3R5bGU6IHN0eWxlRnVuY3Rpb24sXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogZWJlbmUudGl0bGUsXHJcbiAgICAgICAgICAgICAgICBrYXRlZ29yaWU6IGViZW5lLmthdGVnb3JpZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgZWlnZW5lX2ViZW5lbl9sYXllcnMucHVzaChsYXllcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgbGF5ZXJzID0gbGF5ZXJzLmNvbmNhdChlaWdlbmVfZWJlbmVuX2xheWVycyk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGxheWVycztcclxufTtcclxuXHJcbi8vIGFrdHVhbGlzaWVydCBlaW5lIEtvcGllIGVpZ2VuZXIgRWJlbmVuIGluIGxvY2FsU3RvcmFnZVxyXG4vLyByZW1vdmU6IHdlbm4gdm9yaGFuZGVuLCB3aXJkIGRpZSBFYmVuZSBlbnRmZXJudFxyXG4vLyBzb25zdCB3aXJkIGRpZSBlbnRoYWx0ZW5lIFZlcnNpb24gZHVyY2ggZGllIGFrdHVlbGxlIGVyc2V0enRcclxuLy8gZ2VzY2hyaWViZW4gd2lyZCBHZW9KU09OLiBHcnVuZDogRGllIExheWVyb2JqZWt0ZSBzaW5kIHJla3Vyc2l2IHVuZCBrw7ZubmVuIGRhaGVyIG5pY2h0IHN0cmluZ2lmaWVkIHdlcmRlblxyXG53aW5kb3cuYXBmLm9sbWFwLmFrdHVhbGlzaWVyZUViZW5lSW5Mb2NhbFN0b3JhZ2UgPSBmdW5jdGlvbihsYXllciwgcmVtb3ZlKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcbiAgICAvLyBtaXQgZGVyIGd1aWQga29udHJvbGxpZXJlbiwgb2IgZGllIEViZW5lIHNjaG9uIGV4aXN0aWVydFxyXG4gICAgdmFyIGd1aWQgPSBsYXllci5nZXQoJ2d1aWQnKSxcclxuICAgICAgICBpbmRleF90b19yZW1vdmUsXHJcbiAgICAgICAgZWlnZW5lX2ViZW5lbiA9IFtdO1xyXG5cclxuICAgIGlmIChsb2NhbFN0b3JhZ2Uub2xtYXBfZWlnZW5lX2ViZW5lbikge1xyXG4gICAgICAgIGVpZ2VuZV9lYmVuZW4gPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5vbG1hcF9laWdlbmVfZWJlbmVuKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZ3VpZCkge1xyXG4gICAgXHQvLyBkZW4gbGF5ZXIgZW50ZmVybmVuXHJcbiAgICBcdC8vIHdlbm4gZXIgbmljaHQgZW50ZmVybnQgd2VyZGVuIHNvbGwsIHdpcmQgZXIgaW0gbsOkY2hzdGVuIFNjaHJpdHQgbWl0IGRlbiBha3R1ZWxsZW4gRGF0ZW4gZXJzZXR6dFxyXG4gICAgXHRlaWdlbmVfZWJlbmVuID0gXy5yZWplY3QoZWlnZW5lX2ViZW5lbiwgZnVuY3Rpb24oZWJlbmUpIHtcclxuICAgIFx0XHRyZXR1cm4gZWJlbmUuZ3VpZCAmJiBlYmVuZS5ndWlkID09PSBndWlkO1xyXG4gICAgXHR9KTtcclxuICAgICAgICAvLyB3ZW5uIGRpZSBFYmVuZSBuaWNodCBlbnRmZXJudCB3ZXJkZW4gc29sbHRlLCBtaXQgZGVuIGFrdHVlbGxlbiBEYXRlbiBlcmfDpG56ZW5cclxuICAgICAgICBpZiAoIXJlbW92ZSkge1xyXG4gICAgICAgICAgICB2YXIgZm9ybWF0ID0gbmV3IG9sLmZvcm1hdC5HZW9KU09OKCksXHJcbiAgICAgICAgICAgICAgICBkYXRhX3BhcnNlZCA9IGZvcm1hdC53cml0ZUZlYXR1cmVzKGxheWVyLmdldFNvdXJjZSgpLmdldEZlYXR1cmVzKCkpO1xyXG4gICAgICAgICAgICAvLyBhbGxlIHp1Z2Vmw7xndGVuIEVpZ2Vuc2NoYWZ0ZW4gYW5mw7xnZW5cclxuICAgICAgICAgICAgZGF0YV9wYXJzZWQudGl0bGUgPSBsYXllci5nZXQoJ3RpdGxlJyk7XHJcbiAgICAgICAgICAgIGRhdGFfcGFyc2VkLmd1aWQgPSBndWlkO1xyXG4gICAgICAgICAgICBkYXRhX3BhcnNlZC5rYXRlZ29yaWUgPSBsYXllci5nZXQoJ2thdGVnb3JpZScpO1xyXG4gICAgICAgICAgICBlaWdlbmVfZWJlbmVuLnB1c2goZGF0YV9wYXJzZWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgIFx0Ly8gVE9ETzogd2VubiBydWV0ZXJlbi5rbWwgaW1wb3J0aWVydCB3dXJkZSBlcnNjaGVpbnQgRmVobGVyICdDb252ZXJ0aW5nIGNpcmN1bGFyIHN0cnVjdHVyZSB0byBKU09OJ1xyXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uub2xtYXBfZWlnZW5lX2ViZW5lbiA9IEpTT04uc3RyaW5naWZ5KGVpZ2VuZV9lYmVuZW4pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnRWJlbmUga29ubnRlIG5pY2h0IGluIGxvY2FsU3RvcmFnZSBnZXNwZWljaGVydCB3ZXJkZW4uIEZlaGxlcm1lbGR1bmc6ICcgKyBlKTtcclxuICAgICAgICAgICAgJCgnI2VpZ2VuZV9sYXllcl9tZWxkdW5nXycgKyBsYXllci5nZXQoJ3RpdGxlJykucmVwbGFjZShcIiBcIiwgXCJfXCIpKVxyXG4gICAgICAgICAgICBcdC5odG1sKCdFYmVuZSBrYW5uIG5pY2h0IGltIENhY2hlIGRlcyBCcm93c2VycyBnZXNwZWljaGVydCB3ZXJkZW4nKVxyXG4gICAgICAgICAgICBcdC5zaG93KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5cclxud2luZG93LmFwZi5pbml0aWllcmVPbG1hcCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBQcm94eSBIb3N0IGZvciBBamF4IFJlcXVlc3RzIHRvIG92ZXJjb21lIENyb3NzLURvbWFpbiBIVFRUUCBSZXF1ZXN0c1xyXG5cdC8vT3BlbkxheWVycy5Qcm94eUhvc3QgPSBcIi4uL2NnaS1iaW4vcHJveHkuY2dpP3VybD1cIjtcclxuXHQvL3ZhciB6aF9iYm94XzE5MDMgPSBuZXcgb2wuRXh0ZW50KDY2OTAwMCwgMjIyMDAwLCA3MTcwMDAsIDI4NDAwMCk7XHJcblxyXG5cdC8vIGFsbGbDpGxsaWdlIEFwZmxvcmEtRWJlbmVuIGVudGZlcm5lblxyXG5cdHdpbmRvdy5hcGYub2xtYXAuZW50ZmVybmVBbGxlQXBmbG9yYUxheWVyKCk7XHJcbiAgICAvLyBhbGxmw6RsbGlnZSBNb2RpZnktSW50ZXJha3Rpb24gZW50ZmVybmVuXHJcbiAgICB3aW5kb3cuYXBmLm9sbWFwLmVudGZlcm5lTW9kaWZ5SW50ZXJhY3Rpb25Gw7xyVHBvcCgpO1xyXG5cclxuXHQvLyBLYXJ0ZSBudXIgYXVmYmF1ZW4sIHdlbm4gZGllcyBuaWNodCBzY2hvbiBwYXNzaWVydCBpc3RcclxuXHRpZiAoIXdpbmRvdy5hcGYub2xtYXAubWFwKSB7XHJcblxyXG4gICAgICAgIHdpbmRvdy5hcGYub2xtYXAubWFwID0gbmV3IGdhLk1hcCh7XHJcbiAgICAgICAgICAgIHRhcmdldDogJ2dhX2thcnRlbl9kaXYnLFxyXG4gICAgICAgICAgICBsYXllcnM6IHdpbmRvdy5hcGYub2xtYXAuY3JlYXRlTGF5ZXJzRm9yT2xtYXAoKSxcclxuICAgICAgICAgICAgdmlldzogbmV3IG9sLlZpZXcyRCh7XHJcbiAgICAgICAgICAgICAgICByZXNvbHV0aW9uOiA0LFxyXG4gICAgICAgICAgICAgICAgY2VudGVyOiBbNjkzMDAwLCAyNTMwMDBdXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIGRpdmVyc2UgZmVhdHVyZXMgdW5kIEbDpGhpZ2tlaXRlbiBlcmfDpG56ZW5cclxuICAgICAgICB3aW5kb3cuYXBmLm9sbWFwLmFkZERyYWdBbmREcm9wR2VvZmlsZXMoKTtcclxuICAgICAgICB3aW5kb3cuYXBmLm9sbWFwLmFkZFNob3dGZWF0dXJlSW5mb09uQ2xpY2soKTtcclxuICAgICAgICB3aW5kb3cuYXBmLm9sbWFwLmNoYW5nZUN1cnNvck92ZXJGZWF0dXJlKCk7XHJcbiAgICAgICAgd2luZG93LmFwZi5vbG1hcC5pbml0aWllcmVMYXllcnRyZWUoKTtcclxuICAgICAgICB3aW5kb3cuYXBmLm9sbWFwLmFkZE1vdXNlUG9zaXRpb25Db250cm9sKCk7XHJcbiAgICAgICAgd2luZG93LmFwZi5vbG1hcC5hZGRGdWxsU2NyZWVuQ29udHJvbCgpO1xyXG5cclxuICAgICAgICB3aW5kb3cuYXBmLm9sbWFwLm1hcC5vbignY2hhbmdlOnNpemUnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgLy8gc3RldWVybiwgb2IgZGFzIEV4cG9ydC1Ub29sIHNpY2h0YmFyIGlzdFxyXG4gICAgICAgICAgICAvLyB3ZW5uIGVzIGJlaSBob2hlciBQaXhlbHphaGwgc2ljaHRiYXIgaXN0LCBnaWJ0IGVzIFByb2JsZW1lXHJcbiAgICAgICAgICAgIHdpbmRvdy5hcGYub2xtYXAuYmxlbmRlT2xtYXBFeHBvcnRpZXJlbigpO1xyXG4gICAgICAgIH0pO1xyXG5cdH1cclxufTtcclxuXHJcbi8vIGRlYWt0aXZpZXJ0IE1lc3NlbiB1bmQgQXVzd8OkaGxlblxyXG53aW5kb3cuYXBmLm9sbWFwLmRlYWN0aXZhdGVNZW51SXRlbXMgPSBmdW5jdGlvbigpIHtcclxuICAgIC8vIG1lc3NlbiBkZWFrdGl2aWVyZW5cclxuICAgIHdpbmRvdy5hcGYub2xtYXAucmVtb3ZlTWVhc3VyZUludGVyYWN0aW9uKCk7XHJcbiAgICAvLyBBdXN3w6RobGVuIGRlYWt0aXZpZXJlblxyXG4gICAgd2luZG93LmFwZi5vbG1hcC5yZW1vdmVTZWxlY3RGZWF0dXJlc0luU2VsZWN0YWJsZUxheWVycygpO1xyXG4gICAgLy8gYWxsZsOkbGxpZ2UgcG9wdXBzIHNjaGxpZXNzZW5cclxuICAgIHdpbmRvdy5hcGYub2xtYXAuZW50ZmVybmVQb3B1cE92ZXJsYXlzKCk7XHJcbiAgICAvLyBhbGxmw6RsbGlnZSB0b29sdGlwcyB2b24gZ2Eta2FydGVuIHZlcnN0ZWNrZW5cclxuICAgICQoJ2Rpdi5nYS10b29sdGlwJykuaGlkZSgpO1xyXG4gICAgLy8gYWxsZsOkbGxpZ2UgbW9kaWZ5LWludGVyYWN0aW9uIGVudGZlcm5lblxyXG4gICAgd2luZG93LmFwZi5vbG1hcC5lbnRmZXJuZU1vZGlmeUludGVyYWN0aW9uRsO8clRwb3AoKTtcclxufTtcclxuXHJcbndpbmRvdy5hcGYub2xtYXAucmVtb3ZlU2VsZWN0RmVhdHVyZXNJblNlbGVjdGFibGVMYXllcnMgPSBmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIGlmICh3aW5kb3cuYXBmLm9sbWFwLm1hcC5vbG1hcF9zZWxlY3RfaW50ZXJhY3Rpb24pIHtcclxuICAgICAgICB3aW5kb3cuYXBmLm9sbWFwLm1hcC5yZW1vdmVJbnRlcmFjdGlvbih3aW5kb3cuYXBmLm9sbWFwLm1hcC5vbG1hcF9zZWxlY3RfaW50ZXJhY3Rpb24pO1xyXG4gICAgICAgIGRlbGV0ZSB3aW5kb3cuYXBmLm9sbWFwLm1hcC5vbG1hcF9zZWxlY3RfaW50ZXJhY3Rpb247XHJcbiAgICAgICAgd2luZG93LmFwZi5vbG1hcC5yZW1vdmVEcmFnQm94KCk7XHJcbiAgICAgICAgJChcIiNlcmdlYm5pc0F1c3dhaGxcIikuaGlkZSgpO1xyXG4gICAgfVxyXG59O1xyXG5cclxud2luZG93LmFwZi5vbG1hcC5hZGRTZWxlY3RGZWF0dXJlc0luU2VsZWN0YWJsZUxheWVycyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG4gICAgd2luZG93LmFwZi5vbG1hcC5tYXAub2xtYXBfc2VsZWN0X2ludGVyYWN0aW9uID0gbmV3IG9sLmludGVyYWN0aW9uLlNlbGVjdCh7XHJcbiAgICAgICAgLy8gVE9ETzogJ2xheWVyRmlsdGVyJyB3aWxsIHNvb24gYmUgZGVwcmVjYXRlZCA+IGNoYW5nZSB0byAnbGF5ZXJzJyB3aGVuIGRlcHJlY2F0ZWRcclxuICAgICAgICBsYXllckZpbHRlcjogZnVuY3Rpb24obGF5ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGxheWVyLmdldCgnc2VsZWN0YWJsZScpID09PSB0cnVlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc3R5bGU6IGZ1bmN0aW9uKGZlYXR1cmUsIHJlc29sdXRpb24pIHtcclxuICAgICAgICAgICAgc3dpdGNoKGZlYXR1cmUuZ2V0KCdteVR5cCcpKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdwb3AnOlxyXG4gICAgICAgICAgICAgICAgXHRyZXR1cm4gd2luZG93LmFwZi5vbG1hcC5wb3BTdHlsZShmZWF0dXJlLCByZXNvbHV0aW9uLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3Rwb3AnOlxyXG4gICAgICAgICAgICAgICAgXHRyZXR1cm4gd2luZG93LmFwZi5vbG1hcC50cG9wU3R5bGUoZmVhdHVyZSwgcmVzb2x1dGlvbiwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdEZXRhaWxwbGFuJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gd2luZG93LmFwZi5vbG1hcC5kZXRhaWxwbGFuU3R5bGVTZWxlY3RlZChmZWF0dXJlLCByZXNvbHV0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvKixcclxuICAgICAgICAgLy8gd2VubiBtYW4gZGFzIGZlYXR1cmUgenVtIHp3ZWl0ZW4gbWFsIGtsaWNrdCwgc29sbCBlcyBuaWNodCBtZWhyIHNlbGVjdGVkIHNlaW5cclxuICAgICAgICAgdG9nZ2xlQ29uZGl0aW9uOiBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICByZXR1cm4gZXZlbnQgPT09ICdjbGljayc7XHJcbiAgICAgICAgIH0qL1xyXG4gICAgfSk7XHJcbiAgICB3aW5kb3cuYXBmLm9sbWFwLm1hcC5hZGRJbnRlcmFjdGlvbih3aW5kb3cuYXBmLm9sbWFwLm1hcC5vbG1hcF9zZWxlY3RfaW50ZXJhY3Rpb24pO1xyXG4gICAgLy8gbWFuIHNvbGwgYXVjaCBtaXQgZHJhZ2JveCBzZWxlY3RlbiBrw7ZubmVuXHJcbiAgICB3aW5kb3cuYXBmLm9sbWFwLmFkZERyYWdCb3hGb3JQb3BUcG9wKCk7XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLm9sbWFwLmdldFNlbGVjdGVkRmVhdHVyZXMgPSBmdW5jdGlvbigpIHtcclxuICAgIGlmICh3aW5kb3cuYXBmLm9sbWFwLm1hcC5vbG1hcF9zZWxlY3RfaW50ZXJhY3Rpb24pIHtcclxuICAgICAgICByZXR1cm4gd2luZG93LmFwZi5vbG1hcC5tYXAub2xtYXBfc2VsZWN0X2ludGVyYWN0aW9uLmdldEZlYXR1cmVzKCkuZ2V0QXJyYXkoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG59O1xyXG5cclxud2luZG93LmFwZi5vbG1hcC5nZXRTZWxlY3RlZEZlYXR1cmVzT2ZUeXBlID0gZnVuY3Rpb24odHlwZSkge1xyXG4gICAgdmFyIGZlYXR1cmVzX2FycmF5ID0gd2luZG93LmFwZi5vbG1hcC5nZXRTZWxlY3RlZEZlYXR1cmVzKCksXHJcbiAgICAgICAgcmV0dXJuX2FycmF5ID0gW10sXHJcbiAgICAgICAgZmVhdHVyZV90eXBlO1xyXG4gICAgaWYgKGZlYXR1cmVzX2FycmF5Lmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxuICAgIF8uZWFjaChmZWF0dXJlc19hcnJheSwgZnVuY3Rpb24oZmVhdHVyZSkge1xyXG4gICAgICAgIGZlYXR1cmVfdHlwZSA9IGZlYXR1cmUuZ2V0KCdteVR5cCcpO1xyXG4gICAgICAgIGlmIChmZWF0dXJlX3R5cGUgPT09IHR5cGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuX2FycmF5LnB1c2goZmVhdHVyZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gcmV0dXJuX2FycmF5O1xyXG59O1xyXG5cclxud2luZG93LmFwZi5vbG1hcC5yZW1vdmVEcmFnQm94ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcbiAgICBpZiAod2luZG93LmFwZi5vbG1hcC5kcmFnX2JveF9pbnRlcmFjdGlvbikge1xyXG4gICAgICAgIHdpbmRvdy5hcGYub2xtYXAubWFwLnJlbW92ZUludGVyYWN0aW9uKHdpbmRvdy5hcGYub2xtYXAuZHJhZ19ib3hfaW50ZXJhY3Rpb24pO1xyXG4gICAgICAgIC8vd2luZG93LmFwZi5vbG1hcC5kcmFnX2JveF9pbnRlcmFjdGlvbi5vZmYoJ2JveGVuZCcpO1xyXG4gICAgICAgIGRlbGV0ZSB3aW5kb3cuYXBmLm9sbWFwLmRyYWdfYm94X2ludGVyYWN0aW9uO1xyXG4gICAgfVxyXG59O1xyXG5cclxud2luZG93LmFwZi5vbG1hcC5hZGREcmFnQm94Rm9yUG9wVHBvcCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG4gICAgd2luZG93LmFwZi5vbG1hcC5kcmFnX2JveF9pbnRlcmFjdGlvbiA9IG5ldyBvbC5pbnRlcmFjdGlvbi5EcmFnQm94KHtcclxuICAgICAgICAvKiBkcmFnYm94IGludGVyYWN0aW9uIGlzIGFjdGl2ZSBvbmx5IGlmIGFsdCBrZXkgaXMgcHJlc3NlZCAqL1xyXG4gICAgICAgIGNvbmRpdGlvbjogb2wuZXZlbnRzLmNvbmRpdGlvbi5hbHRLZXlPbmx5LFxyXG4gICAgICAgIC8qIHN0eWxlIHRoZSBib3ggKi9cclxuICAgICAgICBzdHlsZTogbmV3IG9sLnN0eWxlLlN0eWxlKHtcclxuICAgICAgICAgICAgZmlsbDogbmV3IG9sLnN0eWxlLkZpbGwoe1xyXG4gICAgICAgICAgICAgICAgY29sb3I6ICdyZ2JhKDI1NSwwLDAsMC4xKSdcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgIHN0cm9rZTogbmV3IG9sLnN0eWxlLlN0cm9rZSh7XHJcbiAgICAgICAgICAgICAgICBjb2xvcjogWzI1NSwgMCwgMCwgMV0sXHJcbiAgICAgICAgICAgICAgICB3aWR0aDogM1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcbiAgICB9KTtcclxuICAgIHdpbmRvdy5hcGYub2xtYXAuZHJhZ19ib3hfaW50ZXJhY3Rpb24ub24oJ2JveGVuZCcsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgdmFyIGdlb21ldHJ5ID0gd2luZG93LmFwZi5vbG1hcC5kcmFnX2JveF9pbnRlcmFjdGlvbi5nZXRHZW9tZXRyeSgpLFxyXG4gICAgICAgICAgICBleHRlbnQgPSBnZW9tZXRyeS5nZXRFeHRlbnQoKSxcclxuICAgICAgICAgICAgbGF5ZXJzID0gd2luZG93LmFwZi5vbG1hcC5tYXAuZ2V0TGF5ZXJzKCkuZ2V0QXJyYXkoKSxcclxuICAgICAgICAgICAgcG9wX2xheWVyX25yID0gJCgnI29sbWFwX2xheWVydHJlZV9Qb3B1bGF0aW9uZW4nKS52YWwoKSxcclxuICAgICAgICAgICAgcG9wX2xheWVyID0gbGF5ZXJzW3BvcF9sYXllcl9ucl0sXHJcbiAgICAgICAgICAgIHRwb3BfbGF5ZXJfbnIgPSAkKCcjb2xtYXBfbGF5ZXJ0cmVlX1RlaWxwb3B1bGF0aW9uZW4nKS52YWwoKSxcclxuICAgICAgICAgICAgdHBvcF9sYXllciA9IGxheWVyc1t0cG9wX2xheWVyX25yXSxcclxuICAgICAgICAgICAgcG9wX2xheWVyX3NvdXJjZSA9IHBvcF9sYXllci5nZXRTb3VyY2UoKSxcclxuICAgICAgICAgICAgdHBvcF9sYXllcl9zb3VyY2UgPSB0cG9wX2xheWVyLmdldFNvdXJjZSgpLFxyXG4gICAgICAgICAgICBzZWxlY3RlZF9mZWF0dXJlcyA9IHdpbmRvdy5hcGYub2xtYXAubWFwLm9sbWFwX3NlbGVjdF9pbnRlcmFjdGlvbi5nZXRGZWF0dXJlcygpLmdldEFycmF5KCk7XHJcbiAgICAgICAgaWYgKHBvcF9sYXllci5nZXQoJ3Zpc2libGUnKSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICBwb3BfbGF5ZXJfc291cmNlLmZvckVhY2hGZWF0dXJlSW5FeHRlbnQoZXh0ZW50LCBmdW5jdGlvbiAoZmVhdHVyZSkge1xyXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRfZmVhdHVyZXMucHVzaChmZWF0dXJlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0cG9wX2xheWVyLmdldCgndmlzaWJsZScpID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgIHRwb3BfbGF5ZXJfc291cmNlLmZvckVhY2hGZWF0dXJlSW5FeHRlbnQoZXh0ZW50LCBmdW5jdGlvbiAoZmVhdHVyZSkge1xyXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRfZmVhdHVyZXMucHVzaChmZWF0dXJlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5hcGYub2xtYXAucHLDvGZlT2JQb3BUcG9wR2V3w6RobHRXdXJkZW4oKTtcclxuICAgICAgICB9LCAxMDApO1xyXG4gICAgfSk7XHJcbiAgICB3aW5kb3cuYXBmLm9sbWFwLm1hcC5hZGRJbnRlcmFjdGlvbih3aW5kb3cuYXBmLm9sbWFwLmRyYWdfYm94X2ludGVyYWN0aW9uKTtcclxufTtcclxuXHJcbndpbmRvdy5hcGYub2xtYXAuYWRkU2hvd0ZlYXR1cmVJbmZvT25DbGljayA9IGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG4gICAgd2luZG93LmFwZi5vbG1hcC5tYXAub24oJ3NpbmdsZWNsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICB2YXIgcGl4ZWwgPSBldmVudC5waXhlbCxcclxuICAgICAgICAgICAgY29vcmRpbmF0ZSA9IGV2ZW50LmNvb3JkaW5hdGU7XHJcbiAgICAgICAgLy8gbnVyIG1hY2hlbiwgd2VubiBuaWNodCBzZWxla3RpZXJ0IHdpcmRcclxuICAgICAgICBpZiAoIXdpbmRvdy5hcGYub2xtYXAubWFwLm9sbWFwX3NlbGVjdF9pbnRlcmFjdGlvbikge1xyXG4gICAgICAgICAgICB3aW5kb3cuYXBmLm9sbWFwLnplaWdlRmVhdHVyZUluZm8ocGl4ZWwsIGNvb3JkaW5hdGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBwcsO8ZmVuLCBvYiBwb3AgLyB0cG9wIGdld8OkaGx0IHd1cmRlblxyXG4gICAgICAgIC8vIHZlcnrDtmdlcm4sIHdlaWwgZGllIG5ldXN0ZSBzZWxlY3Rpb24gc29uc3QgbmljaHQgZXJmYXNzdCB3aXJkXHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgd2luZG93LmFwZi5vbG1hcC5wcsO8ZmVPYlBvcFRwb3BHZXfDpGhsdFd1cmRlbigpO1xyXG4gICAgICAgIH0sIDEwMCk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbndpbmRvdy5hcGYub2xtYXAucHLDvGZlT2JQb3BUcG9wR2V3w6RobHRXdXJkZW4gPSBmdW5jdGlvbigpIHtcclxuICAgIHZhciBwb3Bfc2VsZWN0ZWQgPSBbXSxcclxuICAgICAgICB0cG9wX3NlbGVjdGVkID0gW107XHJcbiAgICAvLyBwcsO8ZmVuLCBvYiBwb3AgLyB0cG9wIGdld8OkaGx0IHd1cmRlblxyXG4gICAgcG9wX3NlbGVjdGVkID0gd2luZG93LmFwZi5vbG1hcC5nZXRTZWxlY3RlZEZlYXR1cmVzT2ZUeXBlKCdwb3AnKTtcclxuICAgIHRwb3Bfc2VsZWN0ZWQgPSB3aW5kb3cuYXBmLm9sbWFwLmdldFNlbGVjdGVkRmVhdHVyZXNPZlR5cGUoJ3Rwb3AnKTtcclxuICAgIC8vIHdlbm4gamE6IGFuemVpZ2VuXHJcbiAgICBpZiAocG9wX3NlbGVjdGVkLmxlbmd0aCA+IDAgfHwgdHBvcF9zZWxlY3RlZC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgd2luZG93LmFwZi5vbG1hcC5lcnN0ZWxsZUxpc3RlRGVyQXVzZ2V3w6RobHRlblBvcFRQb3AocG9wX3NlbGVjdGVkLCB0cG9wX3NlbGVjdGVkKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJChcIiNlcmdlYm5pc0F1c3dhaGxcIikuaGlkZSgpO1xyXG4gICAgfVxyXG59O1xyXG5cclxud2luZG93LmFwZi5vbG1hcC5jaGFuZ2VDdXJzb3JPdmVyRmVhdHVyZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG4gICAgJCh3aW5kb3cuYXBmLm9sbWFwLm1hcC5nZXRWaWV3cG9ydCgpKS5vbignbW91c2Vtb3ZlJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgIHZhciBwaXhlbCA9IHdpbmRvdy5hcGYub2xtYXAubWFwLmdldEV2ZW50UGl4ZWwoZS5vcmlnaW5hbEV2ZW50KSxcclxuICAgICAgICAgICAgaGl0ID0gd2luZG93LmFwZi5vbG1hcC5tYXAuZm9yRWFjaEZlYXR1cmVBdFBpeGVsKHBpeGVsLCBmdW5jdGlvbihmZWF0dXJlLCBsYXllcikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChoaXQpIHtcclxuICAgICAgICAgICAgJCgnI2dhX2thcnRlbl9kaXYnKS5jc3MoJ2N1cnNvcicsICdwb2ludGVyJyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJCgnI2dhX2thcnRlbl9kaXYnKS5jc3MoJ2N1cnNvcicsICcnKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufTtcclxuXHJcbndpbmRvdy5hcGYub2xtYXAuYWRkTW91c2VQb3NpdGlvbkNvbnRyb2wgPSBmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIHZhciBtb3VzZVBvc2l0aW9uQ29udHJvbCA9IG5ldyBvbC5jb250cm9sLk1vdXNlUG9zaXRpb24oe1xyXG4gICAgICAgIC8vVGhpcyBpcyB0aGUgZm9ybWF0IHdlIHdhbnQgdGhlIGNvb3JkaW5hdGUgaW5cclxuICAgICAgICAvL1RoZSBudW1iZXIgYXJndW1lbnQgaW4gY3JlYXRlU3RyaW5nWFkgaXMgdGhlIG51bWJlciBvZiBkZWNpbWFsIHBsYWNlc1xyXG4gICAgICAgIGNvb3JkaW5hdGVGb3JtYXQ6IG9sLmNvb3JkaW5hdGUuY3JlYXRlU3RyaW5nWFkoMCksXHJcbiAgICAgICAgcHJvamVjdGlvbjogXCJFUFNHOjIxNzgxXCIsXHJcbiAgICAgICAgdW5kZWZpbmVkSFRNTDogJyZuYnNwOycgLy93aGF0IG9wZW5sYXllcnMgd2lsbCB1c2UgaWYgdGhlIG1hcCByZXR1cm5zIHVuZGVmaW5lZCBmb3IgYSBtYXAgY29vcmRpbmF0ZVxyXG4gICAgfSk7XHJcbiAgICB3aW5kb3cuYXBmLm9sbWFwLm1hcC5hZGRDb250cm9sKG1vdXNlUG9zaXRpb25Db250cm9sKTtcclxufTtcclxuXHJcbndpbmRvdy5hcGYub2xtYXAuYWRkRnVsbFNjcmVlbkNvbnRyb2wgPSBmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIHZhciBteUZ1bGxTY3JlZW5Db250cm9sID0gbmV3IG9sLmNvbnRyb2wuRnVsbFNjcmVlbigpO1xyXG4gICAgd2luZG93LmFwZi5vbG1hcC5tYXAuYWRkQ29udHJvbChteUZ1bGxTY3JlZW5Db250cm9sKTtcclxuICAgIC8vIGF1ZiBEZXV0c2NoIGJlc2NocmlmdGVuXHJcbiAgICAkKCcjZ2Ffa2FydGVuX2RpdicpLmZpbmQoJy5vbC1mdWxsLXNjcmVlbicpLmZpbmQoJ3NwYW5bcm9sZT1cInRvb2x0aXBcIl0nKS5odG1sKCdWb2xsYmlsZCB3ZWNoc2VsbicpO1xyXG59O1xyXG5cclxud2luZG93LmFwZi5vbG1hcC5hZGREcmFnQW5kRHJvcEdlb2ZpbGVzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcbiAgICAvLyBkcmFnIGFuZCBkcm9wIGdlby1maWxlc1xyXG4gICAgdmFyIGRyYWdfYW5kX2Ryb3BfZGVmYXVsdFN0eWxlID0ge1xyXG4gICAgICAgICdQb2ludCc6IFtuZXcgb2wuc3R5bGUuU3R5bGUoe1xyXG4gICAgICAgICAgICBpbWFnZTogbmV3IG9sLnN0eWxlLkNpcmNsZSh7XHJcbiAgICAgICAgICAgICAgICBmaWxsOiBuZXcgb2wuc3R5bGUuRmlsbCh7XHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdyZ2JhKDI1NSwyNTUsMCwwLjUpJ1xyXG4gICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICByYWRpdXM6IDUsXHJcbiAgICAgICAgICAgICAgICBzdHJva2U6IG5ldyBvbC5zdHlsZS5TdHJva2Uoe1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnI2ZmMCcsXHJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDFcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSldLFxyXG4gICAgICAgICdMaW5lU3RyaW5nJzogW25ldyBvbC5zdHlsZS5TdHlsZSh7XHJcbiAgICAgICAgICAgIHN0cm9rZTogbmV3IG9sLnN0eWxlLlN0cm9rZSh7XHJcbiAgICAgICAgICAgICAgICBjb2xvcjogJyNmMDAnLFxyXG4gICAgICAgICAgICAgICAgd2lkdGg6IDNcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KV0sXHJcbiAgICAgICAgJ1BvbHlnb24nOiBbbmV3IG9sLnN0eWxlLlN0eWxlKHtcclxuICAgICAgICAgICAgZmlsbDogbmV3IG9sLnN0eWxlLkZpbGwoe1xyXG4gICAgICAgICAgICAgICAgY29sb3I6ICdyZ2JhKDAsMjU1LDI1NSwwLjUpJ1xyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgc3Ryb2tlOiBuZXcgb2wuc3R5bGUuU3Ryb2tlKHtcclxuICAgICAgICAgICAgICAgIGNvbG9yOiAnIzBmZicsXHJcbiAgICAgICAgICAgICAgICB3aWR0aDogMVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXSxcclxuICAgICAgICAnTXVsdGlQb2ludCc6IFtuZXcgb2wuc3R5bGUuU3R5bGUoe1xyXG4gICAgICAgICAgICBpbWFnZTogbmV3IG9sLnN0eWxlLkNpcmNsZSh7XHJcbiAgICAgICAgICAgICAgICBmaWxsOiBuZXcgb2wuc3R5bGUuRmlsbCh7XHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdyZ2JhKDI1NSwwLDI1NSwwLjUpJ1xyXG4gICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICByYWRpdXM6IDUsXHJcbiAgICAgICAgICAgICAgICBzdHJva2U6IG5ldyBvbC5zdHlsZS5TdHJva2Uoe1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnI2YwZicsXHJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDFcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSldLFxyXG4gICAgICAgICdNdWx0aUxpbmVTdHJpbmcnOiBbbmV3IG9sLnN0eWxlLlN0eWxlKHtcclxuICAgICAgICAgICAgc3Ryb2tlOiBuZXcgb2wuc3R5bGUuU3Ryb2tlKHtcclxuICAgICAgICAgICAgICAgIGNvbG9yOiAnIzBmMCcsXHJcbiAgICAgICAgICAgICAgICB3aWR0aDogM1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXSxcclxuICAgICAgICAnTXVsdGlQb2x5Z29uJzogW25ldyBvbC5zdHlsZS5TdHlsZSh7XHJcbiAgICAgICAgICAgIGZpbGw6IG5ldyBvbC5zdHlsZS5GaWxsKHtcclxuICAgICAgICAgICAgICAgIGNvbG9yOiAncmdiYSgwLDAsMjU1LDAuNSknXHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICBzdHJva2U6IG5ldyBvbC5zdHlsZS5TdHJva2Uoe1xyXG4gICAgICAgICAgICAgICAgY29sb3I6ICcjMDBmJyxcclxuICAgICAgICAgICAgICAgIHdpZHRoOiAxXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSldXHJcbiAgICB9O1xyXG4gICAgdmFyIGRyYWdfYW5kX2Ryb3Bfc3R5bGVGdW5jdGlvbiA9IGZ1bmN0aW9uKGZlYXR1cmUsIHJlc29sdXRpb24pIHtcclxuICAgICAgICB2YXIgZmVhdHVyZVN0eWxlRnVuY3Rpb24gPSBmZWF0dXJlLmdldFN0eWxlRnVuY3Rpb24oKTtcclxuICAgICAgICBpZiAoZmVhdHVyZVN0eWxlRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZlYXR1cmVTdHlsZUZ1bmN0aW9uLmNhbGwoZmVhdHVyZSwgcmVzb2x1dGlvbik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRyYWdfYW5kX2Ryb3BfZGVmYXVsdFN0eWxlW2ZlYXR1cmUuZ2V0R2VvbWV0cnkoKS5nZXRUeXBlKCldO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB2YXIgZHJhZ19hbmRfZHJvcF9pbnRlcmFjdGlvbiA9IG5ldyBvbC5pbnRlcmFjdGlvbi5EcmFnQW5kRHJvcCh7XHJcbiAgICAgICAgZm9ybWF0Q29uc3RydWN0b3JzOiBbXHJcbiAgICAgICAgICAgIG9sLmZvcm1hdC5HUFgsXHJcbiAgICAgICAgICAgIG9sLmZvcm1hdC5HZW9KU09OLFxyXG4gICAgICAgICAgICBvbC5mb3JtYXQuSUdDLFxyXG4gICAgICAgICAgICBvbC5mb3JtYXQuS01MLFxyXG4gICAgICAgICAgICBvbC5mb3JtYXQuVG9wb0pTT05cclxuICAgICAgICBdXHJcbiAgICB9KTtcclxuXHJcbiAgICB3aW5kb3cuYXBmLm9sbWFwLm1hcC5hZGRJbnRlcmFjdGlvbihkcmFnX2FuZF9kcm9wX2ludGVyYWN0aW9uKTtcclxuXHJcbiAgICBkcmFnX2FuZF9kcm9wX2ludGVyYWN0aW9uLm9uKCdhZGRmZWF0dXJlcycsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgdmFyIHZlY3RvclNvdXJjZSA9IG5ldyBvbC5zb3VyY2UuVmVjdG9yKHtcclxuICAgICAgICAgICAgZmVhdHVyZXM6IGV2ZW50LmZlYXR1cmVzXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIGRyYWdfYW5kX2Ryb3BfbGF5ZXIgPSBuZXcgb2wubGF5ZXIuVmVjdG9yKHtcclxuICAgICAgICBcdGd1aWQ6IHdpbmRvdy5hcGYuZXJzdGVsbGVHdWlkKCksXHJcbiAgICAgICAgICAgIHNvdXJjZTogdmVjdG9yU291cmNlLFxyXG4gICAgICAgICAgICBzdHlsZTogZHJhZ19hbmRfZHJvcF9zdHlsZUZ1bmN0aW9uLFxyXG4gICAgICAgICAgICB0aXRsZTogJ2VpZ2VuZSBFYmVuZScsXHJcbiAgICAgICAgICAgIGthdGVnb3JpZTogJ0VpZ2VuZSBFYmVuZW4nXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgd2luZG93LmFwZi5vbG1hcC5tYXAuYWRkTGF5ZXIoZHJhZ19hbmRfZHJvcF9sYXllcik7XHJcbiAgICAgICAgdmFyIHZpZXcgPSB3aW5kb3cuYXBmLm9sbWFwLm1hcC5nZXRWaWV3KCk7XHJcbiAgICAgICAgdmlldy5maXRFeHRlbnQodmVjdG9yU291cmNlLmdldEV4dGVudCgpLCAvKiogQHR5cGUge29sLlNpemV9ICovICh3aW5kb3cuYXBmLm9sbWFwLm1hcC5nZXRTaXplKCkpKTtcclxuICAgICAgICAvLyBsYXllcnRyZWUgYWt0dWFsaXNpZXJlblxyXG4gICAgICAgIHdpbmRvdy5hcGYub2xtYXAuaW5pdGlpZXJlTGF5ZXJ0cmVlKCdFaWdlbmUgRWJlbmVuJyk7XHJcbiAgICAgICAgd2luZG93LmFwZi5vbG1hcC5mcmFnZU5hbWVGw7xyRWJlbmUoZHJhZ19hbmRfZHJvcF9sYXllcik7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbndpbmRvdy5hcGYub2xtYXAuZnJhZ2VOYW1lRsO8ckViZW5lID0gZnVuY3Rpb24oZWlnZW5lX2ViZW5lKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcbiAgICB2YXIgbmFtZV9lcmZyYWd0ID0gJC5EZWZlcnJlZCgpLFxyXG4gICAgXHQkZWlnZW5lX2ViZW5lX25hbWUgPSAkKCcjZWlnZW5lX2ViZW5lX25hbWUnKSxcclxuICAgICAgICAkZWlnZW5lX2ViZW5lX25hbWVfY29udGFpbmVyID0gJCgnI2VpZ2VuZV9lYmVuZV9uYW1lX2NvbnRhaW5lcicpO1xyXG4gICAgLy8gZWlnZW5lIEViZW5lIGdsb2JhbCBzcGVpY2hlcm4sIGRhbWl0IGRlciBldmVudGhhbmRsZXIgZGFyYXVmIHp1Z3JlaWZlbiBrYW5uXHJcbiAgICB3aW5kb3cuYXBmLm9sbWFwLmVpZ2VuZV9lYmVuZSA9IGVpZ2VuZV9lYmVuZTtcclxuICAgICRlaWdlbmVfZWJlbmVfbmFtZV9jb250YWluZXJcclxuICAgICAgICAuZGlhbG9nKHtcclxuICAgICAgICAgICAgdGl0bGU6ICdFYmVuZSB0YXVmZW4nLFxyXG4gICAgICAgICAgICBtb2RhbDogdHJ1ZSxcclxuICAgICAgICAgICAgcG9zaXRpb246IHtcclxuICAgICAgICAgICAgICAgIG15OiAnY2VudGVyJyxcclxuICAgICAgICAgICAgICAgIGF0OiAnY2VudGVyJyxcclxuICAgICAgICAgICAgICAgIG9mOiAkKCcjZ2Ffa2FydGVuX2RpdicpXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGJ1dHRvbnM6IFtcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiBcInNwZWljaGVyblwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdW1iZW5lbm5lblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuYXBmLm9sbWFwLm5lbm5lRWJlbmVVbShlaWdlbmVfZWJlbmUsICRlaWdlbmVfZWJlbmVfbmFtZS52YWwoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5hbWVuIHp1csO8Y2tzZXR6ZW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgJGVpZ2VuZV9lYmVuZV9uYW1lLnZhbCgnJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuZGlhbG9nKCBcImNsb3NlXCIgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZV9lcmZyYWd0LnJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IFwiYWJicmVjaGVuXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmRpYWxvZyggXCJjbG9zZVwiICk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBdXHJcbiAgICAgICAgfSlcclxuICAgICAgICAuZGlhbG9nKCdvcGVuJyk7XHJcbiAgICAkZWlnZW5lX2ViZW5lX25hbWUub24oJ2tleXVwJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICBpZiAoZXZlbnQud2hpY2ggPT0gMTMgJiYgd2luZG93LmFwZi5vbG1hcC5laWdlbmVfZWJlbmUpIHtcclxuICAgICAgICAgICAgLy8gZW50ZXIgcHJlc3NlZFxyXG4gICAgICAgICAgICAvLyB1bWJlbmVubmVuXHJcbiAgICAgICAgICAgIHdpbmRvdy5hcGYub2xtYXAubmVubmVFYmVuZVVtKHdpbmRvdy5hcGYub2xtYXAuZWlnZW5lX2ViZW5lLCBldmVudC50YXJnZXQudmFsdWUpO1xyXG4gICAgICAgICAgICAvLyBOYW1lbiB6dXLDvGNrc2V0emVuXHJcbiAgICAgICAgICAgICRlaWdlbmVfZWJlbmVfbmFtZS52YWwoJycpO1xyXG4gICAgICAgICAgICAkKCcjZWlnZW5lX2ViZW5lX25hbWVfY29udGFpbmVyJykuZGlhbG9nKCBcImNsb3NlXCIgKTtcclxuICAgICAgICAgICAgJCgnI0dlb0FkbWluS2FydGUnKS5vZmYoJ2tleXVwJywgJyNlaWdlbmVfZWJlbmVfbmFtZScpO1xyXG4gICAgICAgICAgICBkZWxldGUgd2luZG93LmFwZi5vbG1hcC5laWdlbmVfZWJlbmU7XHJcbiAgICAgICAgICAgIG5hbWVfZXJmcmFndC5yZXNvbHZlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gbmFtZV9lcmZyYWd0LnByb21pc2UoKTtcclxufTtcclxuXHJcbndpbmRvdy5hcGYub2xtYXAubmVubmVFYmVuZVVtID0gZnVuY3Rpb24obGF5ZXIsIHRpdGxlKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcbiAgICBsYXllci5zZXQoJ3RpdGxlJywgdGl0bGUpO1xyXG4gICAgd2luZG93LmFwZi5vbG1hcC5pbml0aWllcmVMYXllcnRyZWUoJ0VpZ2VuZSBFYmVuZW4nKTtcclxuICAgIC8vIGxheWVyIGluIGxvY2FsU3RvcmFnZSBzcGVpY2hlcm5cclxuICAgIHdpbmRvdy5hcGYub2xtYXAuYWt0dWFsaXNpZXJlRWJlbmVJbkxvY2FsU3RvcmFnZShsYXllcik7XHJcbn07XHJcblxyXG4vLyBiYXV0IGRhcyBodG1sIGbDvHIgZGVuIGxheWVydHJlZSBhdWZcclxuLy8gTXVzdGVyOlxyXG4vLyA8bGk+PGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGlkPVwib2xtYXBfbGF5ZXJ0cmVlX0ViZW5lIDFcIj48bGFiZWwgZm9yPVwib2xtYXBfbGF5ZXJ0cmVlX0ViZW5lIDFcIj5FYmVuZSAxPC9sYWJlbD48L2xpPjxocj5cclxuLy8gYWN0aXZlX2thdGVnb3JpZTogZGVyIEJlcmVpY2ggZGllc2VyIEthdGVnb3JpZSBzb2xsIG9mZmVuIHNlaW5cclxud2luZG93LmFwZi5vbG1hcC5pbml0aWllcmVMYXllcnRyZWUgPSBmdW5jdGlvbihhY3RpdmVfa2F0ZWdvcmllKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG4gICAgdmFyIGxheWVydGl0ZWwsXHJcbiAgICAgICAgdmlzaWJsZSxcclxuICAgICAgICBrYXRlZ29yaWUsXHJcbiAgICAgICAgLy9odG1sX3dlbHRfaGludGVyZ3J1bmQgPSAnPGgzPldlbHQgSGludGVyZ3J1bmQ8L2gzPjxkaXY+JyxcclxuICAgICAgICBodG1sX2NoX2hpbnRlcmdydW5kID0gJzxoMz5IaW50ZXJncnVuZDwvaDM+PGRpdj4nLFxyXG4gICAgICAgIGh0bWxfY2hfc2FjaGluZm9zID0gJzxoMz5DSCBTYWNoaW5mb3JtYXRpb25lbjwvaDM+PGRpdj4nLFxyXG4gICAgICAgIGh0bWxfY2hfYmlvdG9waW52ID0gJzxoMz5DSCBCaW90b3BpbnZlbnRhcmU8L2gzPjxkaXY+JyxcclxuICAgICAgICBodG1sX3poX3NhY2hpbmZvcyA9ICc8aDM+WkggU2FjaGluZm9ybWF0aW9uZW48L2gzPjxkaXY+JyxcclxuICAgICAgICBodG1sX2FwZmxvcmEgPSAnPGgzPlpIIEFQIEZsb3JhPC9oMz48ZGl2PicsXHJcbiAgICAgICAgaHRtbF9wcm92LFxyXG4gICAgICAgIGh0bWwsXHJcbiAgICAgICAgJG9sbWFwX2xheWVydHJlZV9sYXllcnMgPSAkKCcjb2xtYXBfbGF5ZXJ0cmVlX2xheWVycycpLFxyXG4gICAgICAgICRnYV9rYXJ0ZW5fZGl2X2FjY29yZGlvbiA9ICQoXCIjZ2Ffa2FydGVuX2RpdlwiKS5maW5kKFwiLmFjY29yZGlvblwiKSxcclxuICAgICAgICBsYXllcnMgPSB3aW5kb3cuYXBmLm9sbWFwLm1hcC5nZXRMYXllcnMoKS5nZXRBcnJheSgpLFxyXG4gICAgICAgIGh0bWxfZWlnZW5lX2xheWVyX3RleHQsXHJcbiAgICAgICAgaHRtbF9laWdlbmVfbGF5ZXIgPSAnPGhyPicsXHJcbiAgICAgICAgZWlnZW5lX2xheWVyX3rDpGhsZXIgPSAwLFxyXG4gICAgICAgIGluaXRpYWxpemVfbW9kaWZ5X2xheWVyID0gZmFsc2UsXHJcbiAgICAgICAgYWN0aXZlLFxyXG4gICAgICAgIGV4cG9ydF9sYXllcl9zZWxlY3RfaWRzID0gW10sXHJcbiAgICAgICAgbGVnZW5kZSxcclxuICAgICAgICBsZWdlbmRlX3VybCxcclxuICAgICAgICBpbml0aWFsaXplX2xlZ2VuZGUgPSBmYWxzZTtcclxuXHJcbiAgICBodG1sX2VpZ2VuZV9sYXllcl90ZXh0ID0gJzxoMz5FaWdlbmUgRWJlbmVuPC9oMz4nO1xyXG4gICAgaHRtbF9laWdlbmVfbGF5ZXJfdGV4dCArPSAnPGRpdj4nO1xyXG4gICAgaHRtbF9laWdlbmVfbGF5ZXJfdGV4dCArPSAnPHA+RWluZmFjaCBlaW5lIGRlciBmb2xnZW5kZW4gRGF0ZWl0eXBlbiBhdWYgZGllIEthcnRlIHppZWhlbjo8L3A+JztcclxuICAgIGh0bWxfZWlnZW5lX2xheWVyX3RleHQgKz0gJzx1bD4nO1xyXG4gICAgaHRtbF9laWdlbmVfbGF5ZXJfdGV4dCArPSAnPGxpPkdQWDwvbGk+JztcclxuICAgIGh0bWxfZWlnZW5lX2xheWVyX3RleHQgKz0gJzxsaT5HZW9KU09OPC9saT4nO1xyXG4gICAgaHRtbF9laWdlbmVfbGF5ZXJfdGV4dCArPSAnPGxpPklHQzwvbGk+JztcclxuICAgIGh0bWxfZWlnZW5lX2xheWVyX3RleHQgKz0gJzxsaT5LTUw8L2xpPic7XHJcbiAgICBodG1sX2VpZ2VuZV9sYXllcl90ZXh0ICs9ICc8bGk+VG9wb0pTT048L2xpPic7XHJcbiAgICBodG1sX2VpZ2VuZV9sYXllcl90ZXh0ICs9ICc8L3VsPic7XHJcbiAgICBodG1sX2VpZ2VuZV9sYXllcl90ZXh0ICs9ICc8ZGl2IGlkPVwib2xtYXBfZWlnZW5lX2ViZW5lbl9iZXRhX2NvbnRhaW5lclwiPic7XHJcbiAgICBodG1sX2VpZ2VuZV9sYXllcl90ZXh0ICs9ICc8cCBzdHlsZT1cImZvbnQtc2l6ZToxMHB4OyBsaW5lLWhlaWdodDowLjllbTtcIj5PcGVuIExheWVycyAzIGlzdCBub2NoIGluIGRlciBCZXRhLVBoYXNlLjxicj5EYWhlciBmdW5rdGlvbmllcmVuIGVpZ2VuZSBMYXllciBuaWNodCBpbW1lciBmZWhsZXJmcmVpLjwvcD4nO1xyXG4gICAgaHRtbF9laWdlbmVfbGF5ZXJfdGV4dCArPSAnPC9kaXY+JztcclxuICAgIGh0bWxfZWlnZW5lX2xheWVyX3RleHQgKz0gJzxkaXYgaWQ9XCJvbG1hcF9uZXVlc19sYXllcl9jb250YWluZXJcIj4nO1xyXG4gICAgaHRtbF9laWdlbmVfbGF5ZXJfdGV4dCArPSAnPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGNsYXNzPVwibmV1ZXNfbGF5ZXJcIiBpZD1cIm9sbWFwX25ldWVzX2xheWVyXCI+JztcclxuICAgIGh0bWxfZWlnZW5lX2xheWVyX3RleHQgKz0gJzxsYWJlbCBmb3I9XCJvbG1hcF9uZXVlc19sYXllclwiIGNsYXNzPVwibmV1ZXNfbGF5ZXJfbGFiZWxcIj5uZXVlIEViZW5lIGVyc3RlbGxlbjwvbGFiZWw+JztcclxuICAgIGh0bWxfZWlnZW5lX2xheWVyX3RleHQgKz0gJzwvZGl2Pic7XHJcblxyXG4gICAgLy8gYWNjb3JkaW9uIHplcnN0w7ZyZW4sIGRhbWl0IGVzIG5ldSBhdWZnZWJhdXQgd2VyZGVuIGthbm5cclxuICAgIC8vIHVtIGVzIHp1IHplcnN0w7ZyZW4gbXVzcyBlcyBpbml0aWllcnQgc2VpbiFcclxuXHQkZ2Ffa2FydGVuX2Rpdl9hY2NvcmRpb25cclxuXHRcdC5hY2NvcmRpb24oe2NvbGxhcHNpYmxlOnRydWUsIGFjdGl2ZTogZmFsc2UsIGhlaWdodFN0eWxlOiAnY29udGVudCd9KVxyXG5cdFx0LmFjY29yZGlvbihcImRlc3Ryb3lcIik7XHJcblxyXG4gICAgXy5lYWNoKGxheWVycywgZnVuY3Rpb24obGF5ZXIsIGluZGV4KSB7XHJcbiAgICAgICAgbGF5ZXJ0aXRlbCA9IGxheWVyLmdldCgndGl0bGUnKSB8fCAnKEViZW5lIG9obmUgVGl0ZWwpJztcclxuICAgICAgICB2aXNpYmxlID0gbGF5ZXIuZ2V0KCd2aXNpYmxlJyk7XHJcbiAgICAgICAga2F0ZWdvcmllID0gbGF5ZXIuZ2V0KCdrYXRlZ29yaWUnKTtcclxuICAgICAgICBsZWdlbmRlID0gbGF5ZXIuZ2V0KCdsZWdlbmRlJykgfHwgZmFsc2U7XHJcbiAgICAgICAgbGVnZW5kZV91cmwgPSBsYXllci5nZXQoJ2xlZ2VuZGVfdXJsJykgfHwgbnVsbDtcclxuXHJcbiAgICAgICAgaWYgKGxheWVydGl0ZWwgIT09ICdtZXNzZW4nKSB7XHJcblx0ICAgICAgICBodG1sX3Byb3YgPSAnPGxpPjxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBjbGFzcz1cIm9sbWFwX2xheWVydHJlZV9jaGVja2JveFwiIGlkPVwib2xtYXBfbGF5ZXJ0cmVlXycgKyBsYXllcnRpdGVsICsgJ1wiIHZhbHVlPVwiJyArIGluZGV4ICsgJ1wiJztcclxuXHQgICAgICAgIC8vIHNpY2h0YmFyZSBMYXllciBzb2xsZW4gZ2VjaGVja3Qgc2VpblxyXG5cdCAgICAgICAgaWYgKHZpc2libGUpIHtcclxuXHQgICAgICAgICAgICBodG1sX3Byb3YgKz0gJyBjaGVja2VkPVwiY2hlY2tlZFwiJztcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIGh0bWxfcHJvdiArPSAnPic7XHJcblx0ICAgICAgICBodG1sX3Byb3YgKz0gJzxsYWJlbCBmb3I9XCJvbG1hcF9sYXllcnRyZWVfJyArIGxheWVydGl0ZWwgKyAnXCI+JyArIGxheWVydGl0ZWwgKyAnPC9sYWJlbD4nO1xyXG4gICAgICAgICAgICAvLyBiZWkgcG9wIHVuZCB0cG9wIG11c3Mgc3R5bGUgZ2V3w6RobHQgd2VyZGVuIGvDtm5uZW5cclxuICAgICAgICAgICAgaWYgKGxheWVydGl0ZWwgPT09ICdQb3B1bGF0aW9uZW4nKSB7XHJcbiAgICAgICAgICAgICAgICBodG1sX3Byb3YgKz0gJzxkaXYgY2xhc3M9XCJsYXllcm9wdGlvbmVuXCI+JztcclxuICAgICAgICAgICAgICAgIGh0bWxfcHJvdiArPSAnPGxhYmVsIGZvcj1cImxheWVydHJlZV9wb3BfbnJcIiBjbGFzcz1cImxheWVydHJlZV9wb3Bfc3R5bGUgcG9wX25yXCI+TnIuPC9sYWJlbD4nO1xyXG4gICAgICAgICAgICAgICAgaHRtbF9wcm92ICs9ICc8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgaWQ9XCJsYXllcnRyZWVfcG9wX25yXCIgY2xhc3M9XCJsYXllcnRyZWVfcG9wX3N0eWxlIHBvcF9uclwiIGNoZWNrZWQ9XCJjaGVja2VkXCI+ICc7XHJcbiAgICAgICAgICAgICAgICBodG1sX3Byb3YgKz0gJzxsYWJlbCBmb3I9XCJsYXllcnRyZWVfcG9wX25hbWVcIiBjbGFzcz1cImxheWVydHJlZV9wb3Bfc3R5bGUgcG9wX25hbWVcIj5OYW1lbjwvbGFiZWw+JztcclxuICAgICAgICAgICAgICAgIGh0bWxfcHJvdiArPSAnPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGlkPVwibGF5ZXJ0cmVlX3BvcF9uYW1lXCIgY2xhc3M9XCJsYXllcnRyZWVfcG9wX3N0eWxlIHBvcF9uYW1lXCI+JztcclxuICAgICAgICAgICAgICAgIGh0bWxfcHJvdiArPSAnPC9kaXY+JztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobGF5ZXJ0aXRlbCA9PT0gJ1RlaWxwb3B1bGF0aW9uZW4nKSB7XHJcbiAgICAgICAgICAgICAgICBodG1sX3Byb3YgKz0gJzxkaXYgY2xhc3M9XCJsYXllcm9wdGlvbmVuXCI+JztcclxuICAgICAgICAgICAgICAgIGh0bWxfcHJvdiArPSAnPGxhYmVsIGZvcj1cImxheWVydHJlZV90cG9wX25yXCIgY2xhc3M9XCJsYXllcnRyZWVfdHBvcF9zdHlsZSB0cG9wX25yXCI+TnIuPC9sYWJlbD4nO1xyXG4gICAgICAgICAgICAgICAgaHRtbF9wcm92ICs9ICc8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgaWQ9XCJsYXllcnRyZWVfdHBvcF9uclwiIGNsYXNzPVwibGF5ZXJ0cmVlX3Rwb3Bfc3R5bGUgdHBvcF9uclwiIGNoZWNrZWQ9XCJjaGVja2VkXCI+ICc7XHJcbiAgICAgICAgICAgICAgICBodG1sX3Byb3YgKz0gJzxsYWJlbCBmb3I9XCJsYXllcnRyZWVfdHBvcF9uYW1lXCIgY2xhc3M9XCJsYXllcnRyZWVfdHBvcF9zdHlsZSB0cG9wX25hbWVcIj5OYW1lbjwvbGFiZWw+JztcclxuICAgICAgICAgICAgICAgIGh0bWxfcHJvdiArPSAnPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGlkPVwibGF5ZXJ0cmVlX3Rwb3BfbmFtZVwiIGNsYXNzPVwibGF5ZXJ0cmVlX3Rwb3Bfc3R5bGUgdHBvcF9uYW1lXCI+JztcclxuICAgICAgICAgICAgICAgIGh0bWxfcHJvdiArPSAnPC9kaXY+JztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoa2F0ZWdvcmllID09PSAnRWlnZW5lIEViZW5lbicpIHtcclxuICAgICAgICAgICAgICAgIGh0bWxfcHJvdiArPSAnPGRpdiBjbGFzcz1cImxheWVyb3B0aW9uZW5cIj4nO1xyXG4gICAgICAgICAgICAgICAgaHRtbF9wcm92ICs9ICc8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgY2xhc3M9XCJtb2RpZnlfbGF5ZXJcIiBpZD1cIm1vZGlmeV9sYXllcl8nICsgbGF5ZXJ0aXRlbC5yZXBsYWNlKFwiIFwiLCBcIl9cIikgKyAnXCI+JztcclxuICAgICAgICAgICAgICAgIGh0bWxfcHJvdiArPSAnPGxhYmVsIGZvcj1cIm1vZGlmeV9sYXllcl8nICsgbGF5ZXJ0aXRlbC5yZXBsYWNlKFwiIFwiLCBcIl9cIikgKyAnXCIgdGl0bGU9XCJFYmVuZSBiZWFyYmVpdGVuXCIgY2xhc3M9XCJtb2RpZnlfbGF5ZXJfbGFiZWxcIj48L2xhYmVsPic7XHJcbiAgICAgICAgICAgICAgICBodG1sX3Byb3YgKz0gJzxzZWxlY3QgaWQ9XCJtb2RpZnlfbGF5ZXJfZ2VvbV90eXBlXycgKyBsYXllcnRpdGVsLnJlcGxhY2UoXCIgXCIsIFwiX1wiKSArICdcIiBjbGFzcz1cIm1vZGlmeV9sYXllcl9nZW9tX3R5cGUgYXBmX3Rvb2x0aXBcIiB0aXRsZT1cIk5ldWUgT2JqZWt0ZSB6ZWljaG5lbiBvZGVyPGJyPmJlc3RlaGVuZGUgT2JqZWt0ZSBhdXN3w6RobGVuLCB1bSBzaWUgenUgdmVyw6RuZGVyblwiPjxvcHRpb24gaWQ9XCJtb2RpZnlfbGF5ZXJfZ2VvbV90eXBlX2xlZXJ3ZXJ0XCIgdmFsdWU9XCJsZWVyd2VydFwiIHNlbGVjdGVkPk9iamVrdCBhdXN3w6RobGVuPC9vcHRpb24+PG9wdGlvbiB2YWx1ZT1cIlBvaW50XCI+UHVua3QgemVpY2huZW48L29wdGlvbj48b3B0aW9uIHZhbHVlPVwiTGluZVN0cmluZ1wiPkxpbmllIHplaWNobmVuPC9vcHRpb24+PG9wdGlvbiB2YWx1ZT1cIlBvbHlnb25cIj5Qb2x5Z29uIHplaWNobmVuPC9vcHRpb24+PC9zZWxlY3Q+JztcclxuICAgICAgICAgICAgICAgIGh0bWxfcHJvdiArPSAnPGRpdiBjbGFzcz1cIm5vbl9tb2RpZnlfb3B0aW9uc1wiPic7XHJcbiAgICAgICAgICAgICAgICAgICAgaHRtbF9wcm92ICs9ICc8c2VsZWN0IGlkPVwiZXhwb3J0Ml9sYXllcl9nZW9tX3R5cGVfJyArIGxheWVydGl0ZWwucmVwbGFjZShcIiBcIiwgXCJfXCIpICsgJ1wiIGNsYXNzPVwiZXhwb3J0X2xheWVyX3NlbGVjdCBhcGZfdG9vbHRpcFwiIHRpdGxlPVwiRWJlbmUgZXhwb3J0aWVyZW48YnI+V8OkaGxlbiBTaWUgZWluIEZvcm1hdFwiPjxvcHRpb24gdmFsdWU9XCJsZWVyd2VydFwiIHNlbGVjdGVkPmV4cG9ydGllcmVuPC9vcHRpb24+PG9wdGlvbiB2YWx1ZT1cIkdlb0pTT05cIj5HZW9KU09OPC9vcHRpb24+PG9wdGlvbiB2YWx1ZT1cIktNTFwiPktNTDwvb3B0aW9uPjxvcHRpb24gdmFsdWU9XCJHUFhcIj5HUFg8L29wdGlvbj48L3NlbGVjdD4nO1xyXG4gICAgICAgICAgICAgICAgaHRtbF9wcm92ICs9ICc8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgY2xhc3M9XCJyZW5hbWVfbGF5ZXJcIiBpZD1cInJlbmFtZV9sYXllcl8nICsgbGF5ZXJ0aXRlbC5yZXBsYWNlKFwiIFwiLCBcIl9cIikgKyAnXCI+JztcclxuICAgICAgICAgICAgICAgIGh0bWxfcHJvdiArPSAnPGxhYmVsIGZvcj1cInJlbmFtZV9sYXllcl8nICsgbGF5ZXJ0aXRlbC5yZXBsYWNlKFwiIFwiLCBcIl9cIikgKyAnXCIgdGl0bGU9XCJFYmVuZSB1bWJlbmVubmVuXCIgY2xhc3M9XCJyZW5hbWVfbGF5ZXJfbGFiZWxcIj48L2xhYmVsPic7XHJcbiAgICAgICAgICAgICAgICBodG1sX3Byb3YgKz0gJzxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBjbGFzcz1cImVudGZlcm5lX2xheWVyXCIgaWQ9XCJlbnRmZXJuZV9sYXllcl8nICsgbGF5ZXJ0aXRlbC5yZXBsYWNlKFwiIFwiLCBcIl9cIikgKyAnXCI+JztcclxuICAgICAgICAgICAgICAgIGh0bWxfcHJvdiArPSAnPGxhYmVsIGZvcj1cImVudGZlcm5lX2xheWVyXycgKyBsYXllcnRpdGVsLnJlcGxhY2UoXCIgXCIsIFwiX1wiKSArICdcIiB0aXRsZT1cIkViZW5lIGVudGZlcm5lblwiIGNsYXNzPVwiZW50ZmVybmVfbGF5ZXJfbGFiZWxcIj48L2xhYmVsPic7XHJcbiAgICAgICAgICAgICAgICBodG1sX3Byb3YgKz0gJzwvZGl2Pic7XHJcbiAgICAgICAgICAgICAgICBodG1sX3Byb3YgKz0gJzxkaXYgaWQ9XCJlaWdlbmVfbGF5ZXJfbWVsZHVuZ18nICsgbGF5ZXJ0aXRlbC5yZXBsYWNlKFwiIFwiLCBcIl9cIikgKyAnXCIgY2xhc3M9XCJlaWdlbmVfbGF5ZXJfbWVsZHVuZ1wiPjwvZGl2Pic7XHJcbiAgICAgICAgICAgICAgICBodG1sX3Byb3YgKz0gJzwvZGl2Pic7XHJcbiAgICAgICAgICAgICAgICBpbml0aWFsaXplX21vZGlmeV9sYXllciA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAvLyBkaWVzZSBpZHMgd2VyZGVuIGdlYnJhdWNodCwgdW0gdG9vbHRpcHMgenUgZXJzdGVsbGVuXHJcbiAgICAgICAgICAgICAgICBleHBvcnRfbGF5ZXJfc2VsZWN0X2lkcy5wdXNoKCdleHBvcnQyX2xheWVyX2dlb21fdHlwZV8nICsgbGF5ZXJ0aXRlbC5yZXBsYWNlKFwiIFwiLCBcIl9cIikpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChsZWdlbmRlICYmIGxlZ2VuZGVfdXJsKSB7XHJcbiAgICAgICAgICAgIFx0Ly8gU3ltYm9sIGVyZ8OkbnplblxyXG4gICAgICAgICAgICBcdC8vIGJlaW0gaG92ZXJuIGVyc2NoZWludCBwb3B1cCBtaXQgTGVnZW5kZVxyXG4gICAgICAgICAgICBcdGh0bWxfcHJvdiArPSAnPGEgY2xhc3M9XCJ1aS1pY29uIHVpLWljb24taW5mbyBvbG1hcF9sYXllcnRyZWVlX2xlZ2VuZGVcIiBocmVmPVwiJyArIGxlZ2VuZGVfdXJsICsgJ1wiIHRhcmdldD1cIl9ibGFua1wiIHRpdGxlPVwiJyArIGxlZ2VuZGVfdXJsICsgJ1wiPjwvYT4nO1xyXG4gICAgICAgICAgICBcdGluaXRpYWxpemVfbGVnZW5kZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaHRtbF9wcm92ICs9ICc8L2xpPic7XHJcblx0ICAgICAgICBodG1sX3Byb3YgKz0gJzxocj4nO1xyXG5cdCAgICAgICAgc3dpdGNoIChrYXRlZ29yaWUpIHtcclxuICAgICAgICAgICAgICAgIC8qY2FzZSBcIldlbHQgSGludGVyZ3J1bmRcIjpcclxuICAgICAgICAgICAgICAgICAgICBodG1sX3dlbHRfaGludGVyZ3J1bmQgKz0gaHRtbF9wcm92O1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrOyovXHJcblx0ICAgICAgICAgICAgY2FzZSBcIkhpbnRlcmdydW5kXCI6XHJcblx0ICAgICAgICAgICAgICAgIGh0bWxfY2hfaGludGVyZ3J1bmQgKz0gaHRtbF9wcm92O1xyXG5cdCAgICAgICAgICAgICAgICBicmVhaztcclxuXHQgICAgICAgICAgICBjYXNlIFwiQ0ggU2FjaGluZm9ybWF0aW9uZW5cIjpcclxuXHQgICAgICAgICAgICAgICAgaHRtbF9jaF9zYWNoaW5mb3MgKz0gaHRtbF9wcm92O1xyXG5cdCAgICAgICAgICAgICAgICBicmVhaztcclxuXHQgICAgICAgICAgICBjYXNlIFwiQ0ggQmlvdG9waW52ZW50YXJlXCI6XHJcblx0ICAgICAgICAgICAgICAgIGh0bWxfY2hfYmlvdG9waW52ICs9IGh0bWxfcHJvdjtcclxuXHQgICAgICAgICAgICAgICAgYnJlYWs7XHJcblx0ICAgICAgICAgICAgY2FzZSBcIlpIIFNhY2hpbmZvcm1hdGlvbmVuXCI6XHJcblx0ICAgICAgICAgICAgICAgIGh0bWxfemhfc2FjaGluZm9zICs9IGh0bWxfcHJvdjtcclxuXHQgICAgICAgICAgICAgICAgYnJlYWs7XHJcblx0ICAgICAgICAgICAgY2FzZSBcIkFQIEZsb3JhXCI6XHJcblx0ICAgICAgICAgICAgICAgIGh0bWxfYXBmbG9yYSArPSBodG1sX3Byb3Y7XHJcblx0ICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBcIkVpZ2VuZSBFYmVuZW5cIjpcclxuICAgICAgICAgICAgICAgICAgICBodG1sX2VpZ2VuZV9sYXllciArPSBodG1sX3Byb3Y7XHJcbiAgICAgICAgICAgICAgICAgICAgZWlnZW5lX2xheWVyX3rDpGhsZXIrKztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHQgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIC8vaHRtbF9laWdlbmVfbGF5ZXIgKz0gaHRtbF9wcm92O1xyXG4gICAgICAgICAgICAgICAgICAgIC8vZWlnZW5lX2xheWVyX3rDpGhsZXIrKztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHQgICAgICAgIH1cclxuXHQgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gbGV0enRlcyA8aHI+IGFic2NobmVpZGVuXHJcbiAgICAvLyBhYmVyIG51ciwgd2VubiBsYXllcnMgZXJnw6RuenQgd3VyZGVuXHJcbiAgICAvLyB3ZW5uIGtlaW5lIExheWVycyBlcmfDpG56dCB3dXJkZW46IExheWVydGl0ZWwgbmljaHQgYW56ZWlnZW4gKG51ciBiZWkgaHRtbF9hcGZsb3JhIHZvbiBCZWRldXR1bmcpXHJcbiAgICAvL2h0bWxfd2VsdF9oaW50ZXJncnVuZCA9IGh0bWxfd2VsdF9oaW50ZXJncnVuZC5zdWJzdHJpbmcoMCwgKGh0bWxfd2VsdF9oaW50ZXJncnVuZC5sZW5ndGggLSA0KSk7XHJcbiAgICBodG1sX2NoX2hpbnRlcmdydW5kID0gaHRtbF9jaF9oaW50ZXJncnVuZC5zdWJzdHJpbmcoMCwgKGh0bWxfY2hfaGludGVyZ3J1bmQubGVuZ3RoIC0gNCkpO1xyXG4gICAgaHRtbF9jaF9zYWNoaW5mb3MgPSBodG1sX2NoX3NhY2hpbmZvcy5zdWJzdHJpbmcoMCwgKGh0bWxfY2hfc2FjaGluZm9zLmxlbmd0aCAtIDQpKTtcclxuICAgIGh0bWxfY2hfYmlvdG9waW52ID0gaHRtbF9jaF9iaW90b3BpbnYuc3Vic3RyaW5nKDAsIChodG1sX2NoX2Jpb3RvcGludi5sZW5ndGggLSA0KSk7XHJcbiAgICBodG1sX3poX3NhY2hpbmZvcyA9IGh0bWxfemhfc2FjaGluZm9zLnN1YnN0cmluZygwLCAoaHRtbF96aF9zYWNoaW5mb3MubGVuZ3RoIC0gNCkpO1xyXG4gICAgaWYgKGVpZ2VuZV9sYXllcl96w6RobGVyID4gMCkge1xyXG4gICAgICAgIGh0bWxfZWlnZW5lX2xheWVyID0gaHRtbF9laWdlbmVfbGF5ZXIuc3Vic3RyaW5nKDAsIChodG1sX2VpZ2VuZV9sYXllci5sZW5ndGggLSA0KSk7XHJcbiAgICB9XHJcbiAgICBpZiAoaHRtbF9hcGZsb3JhICE9PSAnPGgzPlpIIEFQIEZsb3JhPC9oMz48ZGl2PicpIHtcclxuICAgIFx0aHRtbF9hcGZsb3JhID0gaHRtbF9hcGZsb3JhLnN1YnN0cmluZygwLCAoaHRtbF9hcGZsb3JhLmxlbmd0aCAtIDQpKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICBcdGh0bWxfYXBmbG9yYSA9ICcnO1xyXG4gICAgfVxyXG4gICAgLy8gdW50ZXJhY2NvcmRpb25zIGFic2NobGllc3NlblxyXG4gICAgLy9odG1sX3dlbHRfaGludGVyZ3J1bmQgKz0gJzwvZGl2Pic7XHJcbiAgICBodG1sX2NoX2hpbnRlcmdydW5kICs9ICc8L2Rpdj4nO1xyXG4gICAgaHRtbF9jaF9zYWNoaW5mb3MgKz0gJzwvZGl2Pic7XHJcbiAgICBodG1sX2NoX2Jpb3RvcGludiArPSAnPC9kaXY+JztcclxuICAgIGh0bWxfemhfc2FjaGluZm9zICs9ICc8L2Rpdj4nO1xyXG4gICAgaHRtbF9hcGZsb3JhICs9ICc8L2Rpdj4nO1xyXG4gICAgaWYgKGVpZ2VuZV9sYXllcl96w6RobGVyID4gMCkge1xyXG4gICAgICAgIGh0bWxfZWlnZW5lX2xheWVyX3RleHQgKz0gaHRtbF9laWdlbmVfbGF5ZXI7XHJcbiAgICB9XHJcbiAgICBodG1sX2VpZ2VuZV9sYXllcl90ZXh0ICs9ICc8L2Rpdj4nO1xyXG4gICAgLy8gYWxsZXMgenVzYW1tZW5zZXR6ZW5cclxuICAgIGh0bWwgPSAvKmh0bWxfd2VsdF9oaW50ZXJncnVuZCArICovaHRtbF9jaF9oaW50ZXJncnVuZCArIGh0bWxfY2hfc2FjaGluZm9zICsgaHRtbF9jaF9iaW90b3BpbnYgKyBodG1sX3poX3NhY2hpbmZvcyArIGh0bWxfYXBmbG9yYSArIGh0bWxfZWlnZW5lX2xheWVyX3RleHQ7XHJcbiAgICAvLyB1bmQgZWluc2V0emVuXHJcbiAgICAkb2xtYXBfbGF5ZXJ0cmVlX2xheWVycy5odG1sKGh0bWwpO1xyXG4gICAgLy8gZXJzdCBqZXR6dCBpbml0aWllcmVuLCBzb25zdCBzdGltbXQgZGllIEjDtmhlIG5pY2h0XHJcbiAgICBpZiAoYWN0aXZlX2thdGVnb3JpZSkge1xyXG4gICAgICAgIC8vIG9obmUgZGllIGVyc3RlIEFrdGl2aWVydW5nIGZ1bmt0aW9uaWVydCBlcyBuaWNodFxyXG4gICAgICAgICRnYV9rYXJ0ZW5fZGl2X2FjY29yZGlvbi5hY2NvcmRpb24oe1xyXG4gICAgICAgICAgICBjb2xsYXBzaWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgYWN0aXZlOiBmYWxzZSxcclxuICAgICAgICAgICAgaGVpZ2h0U3R5bGU6ICdjb250ZW50J1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICRnYV9rYXJ0ZW5fZGl2X2FjY29yZGlvbi5hY2NvcmRpb24oe1xyXG4gICAgICAgICAgICBjb2xsYXBzaWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgYWN0aXZlOiAwLFxyXG4gICAgICAgICAgICBoZWlnaHRTdHlsZTogJ2NvbnRlbnQnXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKGFjdGl2ZV9rYXRlZ29yaWUgPT09ICdFaWdlbmUgRWJlbmVuJykge1xyXG4gICAgICAgICAgICBhY3RpdmUgPSA1O1xyXG4gICAgICAgIH1cclxuICAgICAgICAkKCcjb2xtYXBfbGF5ZXJ0cmVlX2xheWVycycpLmFjY29yZGlvbih7XHJcbiAgICAgICAgICAgIGNvbGxhcHNpYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICBhY3RpdmU6IGFjdGl2ZSxcclxuICAgICAgICAgICAgaGVpZ2h0U3R5bGU6ICdjb250ZW50J1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICAkZ2Ffa2FydGVuX2Rpdl9hY2NvcmRpb24uYWNjb3JkaW9uKHtcclxuICAgICAgICAgICAgY29sbGFwc2libGU6IHRydWUsXHJcbiAgICAgICAgICAgIGFjdGl2ZTogZmFsc2UsXHJcbiAgICAgICAgICAgIGhlaWdodFN0eWxlOiAnY29udGVudCdcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBNYXhpbWFsZ3LDtnNzZSBkZXMgTGF5ZXJ0cmVlIGJlZ3JlbnplblxyXG4gICAgJG9sbWFwX2xheWVydHJlZV9sYXllcnMuY3NzKCdtYXgtaGVpZ2h0Jywgd2luZG93LmFwZi5iZXJlY2huZU9sbWFwTGF5ZXJ0cmVlTWF4aMO2aGUpO1xyXG4gICAgLy8gYnV0dG9ucyBpbml0aWllcmVuXHJcbiAgICAkKCcubmV1ZXNfbGF5ZXInKVxyXG4gICAgICAgIC5idXR0b24oe1xyXG4gICAgICAgICAgICBpY29uczoge3ByaW1hcnk6ICd1aS1pY29uLXBsdXN0aGljayd9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuYnV0dG9uKCdyZWZyZXNoJyk7XHJcbiAgICAkKCcuZXhwb3J0X2xheWVyX3NlbGVjdCcpLnNlbGVjdG1lbnUoKTtcclxuICAgIC8vIGpldHp0IHRvb2x0aXBzIGVyc3RlbGxlblxyXG4gICAgXy5lYWNoKGV4cG9ydF9sYXllcl9zZWxlY3RfaWRzLCBmdW5jdGlvbihpZCkge1xyXG4gICAgICAgIC8vIGdpdmUgdGhlIHNlbGVjdG1lbnUgYSB0b29sdGlwXHJcbiAgICAgICAgJCgnIycgKyBpZCArICctYnV0dG9uJykudG9vbHRpcCh7XHJcbiAgICAgICAgICAgIHRvb2x0aXBDbGFzczogXCJ0b29sdGlwLXN0eWxpbmctaGludGVybGVndFwiLFxyXG4gICAgICAgICAgICBpdGVtczogJ3NwYW4nLFxyXG4gICAgICAgICAgICBjb250ZW50OiAnRWJlbmUgZXhwb3J0aWVyZW48YnI+V8OkaGxlbiBTaWUgZWluIEZvcm1hdCdcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG4gICAgaWYgKGluaXRpYWxpemVfbW9kaWZ5X2xheWVyKSB7XHJcbiAgICAgICAgJCgnLm1vZGlmeV9sYXllcicpXHJcbiAgICAgICAgICAgIC5idXR0b24oe1xyXG4gICAgICAgICAgICAgICAgaWNvbnM6IHtwcmltYXJ5OiAndWktaWNvbi1sb2NrZWQnfSxcclxuICAgICAgICAgICAgICAgIHRleHQ6IGZhbHNlXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5idXR0b24oJ3JlZnJlc2gnKTtcclxuICAgICAgICAkKCcubW9kaWZ5X2xheWVyX2xhYmVsLCAuZXhwb3J0X2xheWVyX3NlbGVjdF9sYWJlbCwgLnJlbmFtZV9sYXllcl9sYWJlbCwgLmVudGZlcm5lX2xheWVyX2xhYmVsLCAuYXBmX3Rvb2x0aXAnKVxyXG4gICAgICAgICAgICAudG9vbHRpcCh7XHJcbiAgICAgICAgICAgICAgICB0b29sdGlwQ2xhc3M6IFwidG9vbHRpcC1zdHlsaW5nLWhpbnRlcmxlZ3RcIixcclxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAkKHRoaXMpLmF0dHIoJ3RpdGxlJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICQoJy5yZW5hbWVfbGF5ZXInKVxyXG4gICAgICAgICAgICAuYnV0dG9uKHtcclxuICAgICAgICAgICAgICAgIGljb25zOiB7cHJpbWFyeTogJ3VpLWljb24tdGFnJ30sXHJcbiAgICAgICAgICAgICAgICB0ZXh0OiBmYWxzZVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuYnV0dG9uKCdyZWZyZXNoJyk7XHJcbiAgICAgICAgJCgnLmVudGZlcm5lX2xheWVyJylcclxuICAgICAgICAgICAgLmJ1dHRvbih7XHJcbiAgICAgICAgICAgICAgICBpY29uczoge3ByaW1hcnk6ICd1aS1pY29uLWNsb3NldGhpY2snfSxcclxuICAgICAgICAgICAgICAgIHRleHQ6IGZhbHNlXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5idXR0b24oJ3JlZnJlc2gnKTtcclxuICAgIH1cclxuICAgIGlmIChpbml0aWFsaXplX2xlZ2VuZGUpIHtcclxuXHRcdCQoXCIub2xtYXBfbGF5ZXJ0cmVlZV9sZWdlbmRlXCIpLnRvb2x0aXAoe1xyXG5cdFx0XHR0b29sdGlwQ2xhc3M6IFwidG9vbHRpcF9vbG1hcF9sYXllcnRyZWVfbGVnZW5kZVwiXHJcblx0XHRcdCxwb3NpdGlvbjoge1xyXG5cdFx0XHRcdG15OiBcInJpZ2h0IHRvcCsxNVwiXHJcblx0XHRcdFx0LGF0OiBcInJpZ2h0IGJvdHRvbVwiXHJcblx0XHRcdFx0LGNvbGxpc2lvbjogXCJmbGlwZml0XCJcclxuXHRcdFx0fVxyXG5cdFx0XHQsY29udGVudDogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0dmFyIHVybCA9ICQodGhpcykuYXR0cignaHJlZicpO1xyXG5cdFx0XHRcdHJldHVybiBcIjxpbWcgc3JjPSdcIiArIHVybCArIFwiJz5cIjtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHQvLyBkaWUgdG9vbHRpcHMgc2luZCBiZWltIGVyc3RlbiDDlmZmbmVuIHp1IHdlaXQgcmVjaHRzID4gbmljaHQgc2ljaHRiYXIhXHJcblx0XHQvLyBkYXJ1bSBhbGxlIGVpbm1hbCDDtmZmbmVuXHJcblx0XHQvLyBhYiBkZW0gendlaXRlbiBtYWwgbGllZ2VuIHNpZSBhbSByaWNodGlnZW4gT3J0XHJcblx0XHQkKFwiLm9sbWFwX2xheWVydHJlZWVfbGVnZW5kZVwiKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHQkKHRoaXMpLnRvb2x0aXAoJ29wZW4nKTtcclxuXHRcdFx0JCh0aGlzKS50b29sdGlwKCdjbG9zZScpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxuLy8gZGFzIGlzdCBkZXIgVmVyc3VjaCwgZXhpc3RpZXJlbmRlIEZvcm11bGFyZSBhbHMgZGlhbG9nIHp1IMO2ZmZuZW5cclxuLy8gYnJhdWNodCBkaWUgaWQgZGVzIEZvcm11bGFyc1xyXG4vLyB1bmQgZGllIGlkIGRlcyBEYXRlbnNhdHplcywgZGVyIGFuenV6ZWlnZW4gaXN0XHJcbndpbmRvdy5hcGYuw7ZmZm5lRm9ybXVsYXJBbHNQb3B1cCA9IGZ1bmN0aW9uKGZvcm11bGFybmFtZSwgaWQpIHtcclxuICAgIHZhciAkZm9ybXVsYXJuYW1lID0gJCgnIycgKyBmb3JtdWxhcm5hbWUpLFxyXG4gICAgXHR0aXRsZTtcclxuXHQvLyB0aXRlbCBiZXN0aW1tZW5cclxuXHRzd2l0Y2ggKGZvcm11bGFybmFtZSkge1xyXG5cdFx0Y2FzZSAncG9wJzpcclxuXHRcdFx0dGl0bGUgPSAnUG9wdWxhdGlvbic7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0Y2FzZSAndHBvcCc6XHJcblx0XHRcdHRpdGxlID0gJ1RlaWxwb3B1bGF0aW9uJztcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRjYXNlICdiZW9iJzpcclxuXHRcdFx0dGl0bGUgPSAnQmVvYmFjaHR1bmcnO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGRlZmF1bHQ6XHJcblx0XHRcdHRpdGxlID0gJyc7XHJcblx0fVxyXG4gICAgLy8gaWQgc2V0emVuXHJcbiAgICBsb2NhbFN0b3JhZ2VbZm9ybXVsYXJuYW1lICsgJ19pZCddID0gaWQ7XHJcbiAgICAvLyBmb3JtdWxhciBpbml0aWllcmVuLCBvaG5lIGFuenV6ZWlnZW5cclxuICAgIGlmIChmb3JtdWxhcm5hbWUgPT09ICdiZW9iJykge1xyXG4gICAgXHR3aW5kb3cuYXBmWydpbml0aWllcmVfJyArIGZvcm11bGFybmFtZV0oJ2Jlb2JfbmljaHRfYmV1cnRlaWx0JywgaWQsICduaWNodF9iZXVydGVpbHQnLCB0cnVlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICBcdHdpbmRvdy5hcGZbJ2luaXRpaWVyZV8nICsgZm9ybXVsYXJuYW1lXSh0cnVlKTtcclxuICAgIH1cclxuICAgIC8vIGRpYWxvZyDDtmZmbmVuXHJcbiAgICAkZm9ybXVsYXJuYW1lLmRpYWxvZyh7XHJcbiAgICAgICAgY2xvc2U6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkZm9ybXVsYXJuYW1lLmRpYWxvZyhcImRlc3Ryb3lcIik7XHJcbiAgICAgICAgfSxcclxuICAgICAgXHQvL2hlaWdodDogNjAwLFxyXG4gICAgICAgIHdpZHRoOiA2MDAsXHJcbiAgICAgICAgbWF4SGVpZ2h0OiAkKCcjbWVudScpLmhlaWdodCgpLFxyXG4gICAgICAgIHJlc2l6YWJsZTogdHJ1ZSxcclxuICAgICAgICBwb3NpdGlvbjoge1xyXG4gICAgICAgIFx0bXk6ICdsZWZ0IHRvcCcsXHJcbiAgICAgICAgXHRhdDogJ2xlZnQgdG9wJyxcclxuICAgICAgICBcdG9mOiAkKCcjbWVudScpXHJcbiAgICAgICAgfSxcclxuICAgICAgICB0aXRsZTogdGl0bGVcclxuICAgIH0pO1xyXG4gICAgJGZvcm11bGFybmFtZS5kaWFsb2coXCJvcGVuXCIpO1xyXG59O1xyXG5cclxud2luZG93LmFwZi5vbG1hcC5kZXRhaWxwbGFuU3R5bGUgPSBmdW5jdGlvbihmZWF0dXJlLCByZXNvbHV0aW9uKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcbiAgICByZXR1cm4gbmV3IG9sLnN0eWxlLlN0eWxlKHtcclxuICAgICAgICBmaWxsOiBuZXcgb2wuc3R5bGUuRmlsbCh7XHJcbiAgICAgICAgICAgIGNvbG9yOiAncmdiYSgyNTAsIDU4LCAxNSwgMC4xKSdcclxuICAgICAgICB9KSxcclxuICAgICAgICBzdHJva2U6IG5ldyBvbC5zdHlsZS5TdHJva2Uoe1xyXG4gICAgICAgICAgICBjb2xvcjogJyNmYTNhMGYnLFxyXG4gICAgICAgICAgICB3aWR0aDogMVxyXG4gICAgICAgIH0pXHJcbiAgICB9KTtcclxufTtcclxuXHJcbndpbmRvdy5hcGYub2xtYXAuZGV0YWlscGxhblN0eWxlU2VsZWN0ZWQgPSBmdW5jdGlvbihmZWF0dXJlLCByZXNvbHV0aW9uKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcbiAgICByZXR1cm4gbmV3IG9sLnN0eWxlLlN0eWxlKHtcclxuICAgICAgICBmaWxsOiBuZXcgb2wuc3R5bGUuRmlsbCh7XHJcbiAgICAgICAgICAgIGNvbG9yOiAncmdiYSgxNSwgODUsIDI1MCwgMC4xKSdcclxuICAgICAgICB9KSxcclxuICAgICAgICBzdHJva2U6IG5ldyBvbC5zdHlsZS5TdHJva2Uoe1xyXG4gICAgICAgICAgICBjb2xvcjogJyMwRjU1RkEnLFxyXG4gICAgICAgICAgICB3aWR0aDogMVxyXG4gICAgICAgIH0pXHJcbiAgICB9KTtcclxufTtcclxuXHJcbi8vIHN0ZXVlcnQgZGVuIHN0eWxlIHZvbiBwb3BcclxuLy8gc2VsZWN0ZWQ6IG1pdCBkZXIgTWF1cyBvZGVyIGRyYWdfYm94IG1hcmtpZXJ0ZVxyXG53aW5kb3cuYXBmLm9sbWFwLnBvcFN0eWxlID0gZnVuY3Rpb24oZmVhdHVyZSwgcmVzb2x1dGlvbiwgc2VsZWN0ZWQpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIFxyXG4gICAgdmFyIGljb24gPSAnaW1nL2Zsb3JhX2ljb25fYnJhdW4ucG5nJyxcclxuICAgICAgICBwb3BpZCA9IGZlYXR1cmUuZ2V0KCdteUlkJyksXHJcblx0ICAgIHN0eWxlLFxyXG5cdCAgICBpbWFnZV9zdHlsZSxcclxuICAgICAgICB0ZXh0X2luaGFsdCxcclxuICAgICAgICB0ZXh0X3N0eWxlLFxyXG4gICAgICAgIHN0cm9rZV9jb2xvciA9ICd3aGl0ZScsXHJcblx0ICAgIHN0eWxlX3dpdGhfdGV4dCxcclxuXHQgICAgc3R5bGVfd2l0aG91dF90ZXh0LFxyXG4gICAgICAgICRsYXllcnRyZWVfcG9wX25yID0gJCgnI2xheWVydHJlZV9wb3BfbnInKTtcclxuXHJcbiAgICAvLyBtYXJraWVydGU6IGljb24gaXN0IG9yYW5nZSB1bmQgVGV4dCBoYXQgcm90ZW4gSGludGVyZ3J1bmRcclxuICAgIGlmIChzZWxlY3RlZCkge1xyXG4gICAgICAgIGljb24gPSAnaW1nL2Zsb3JhX2ljb25fb3JhbmdlLnBuZyc7XHJcbiAgICAgICAgc3Ryb2tlX2NvbG9yID0gJ3JlZCc7XHJcbiAgICB9XHJcblxyXG4gICAgaW1hZ2Vfc3R5bGUgPSBuZXcgb2wuc3R5bGUuSWNvbigvKiogQHR5cGUge29seC5zdHlsZS5JY29uT3B0aW9uc30gKi8gKHtcclxuICAgICAgICBhbmNob3I6IFswLjUsIDQ2XSxcclxuICAgICAgICBhbmNob3JYVW5pdHM6ICdmcmFjdGlvbicsXHJcbiAgICAgICAgYW5jaG9yWVVuaXRzOiAncGl4ZWxzJyxcclxuICAgICAgICBvcGFjaXR5OiAxLFxyXG4gICAgICAgIHNyYzogaWNvblxyXG4gICAgfSkpO1xyXG5cclxuICAgIC8vIHRleHQgYmVzdGltbWVuLCBhYmjDpG5naWcgdm9uIGRlciBFaW5zdGVsbHVuZyBpbSBMYXllcnRyZWVcclxuICAgIGlmICgkbGF5ZXJ0cmVlX3BvcF9uci5pcygnOmNoZWNrZWQnKSkge1xyXG4gICAgXHR0ZXh0X2luaGFsdCA9IGZlYXR1cmUuZ2V0KCdwb3BfbnInKTtcclxuICAgIH0gZWxzZSBpZiAoJCgnI2xheWVydHJlZV9wb3BfbmFtZScpLmlzKCc6Y2hlY2tlZCcpKSB7XHJcbiAgICBcdHRleHRfaW5oYWx0ID0gZmVhdHVyZS5nZXQoJ3BvcF9uYW1lJyk7XHJcbiAgICB9XHJcblxyXG4gICAgdGV4dF9zdHlsZSA9IG5ldyBvbC5zdHlsZS5UZXh0KHtcclxuICAgICAgICBmb250OiAnYm9sZCAxMXB4IEFyaWFsLCBWZXJkYW5hLCBIZWx2ZXRpY2EsIHNhbnMtc2VyaWYnLFxyXG4gICAgICAgIHRleHQ6IHRleHRfaW5oYWx0LFxyXG4gICAgICAgIGZpbGw6IG5ldyBvbC5zdHlsZS5GaWxsKHtcclxuICAgICAgICAgICAgY29sb3I6ICdibGFjaydcclxuICAgICAgICB9KSxcclxuICAgICAgICBzdHJva2U6IG5ldyBvbC5zdHlsZS5TdHJva2Uoe1xyXG4gICAgICAgICAgICBjb2xvcjogc3Ryb2tlX2NvbG9yLFxyXG4gICAgICAgICAgICB3aWR0aDogN1xyXG4gICAgICAgIH0pXHJcbiAgICB9KTtcclxuXHJcbiAgICBzdHlsZV93aXRoX3RleHQgPSBuZXcgb2wuc3R5bGUuU3R5bGUoe1xyXG4gICAgICAgIGltYWdlOiBpbWFnZV9zdHlsZSxcclxuICAgICAgICB0ZXh0OiB0ZXh0X3N0eWxlXHJcbiAgICB9KTtcclxuICAgIHN0eWxlX3dpdGhvdXRfdGV4dCA9IG5ldyBvbC5zdHlsZS5TdHlsZSh7XHJcbiAgICAgICAgaW1hZ2U6IGltYWdlX3N0eWxlXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBzdHlsZSBiZXN0aW1tZW5cclxuICAgIGlmICgkbGF5ZXJ0cmVlX3BvcF9uci5pcygnOmNoZWNrZWQnKSkge1xyXG4gICAgICAgIHN0eWxlID0gc3R5bGVfd2l0aF90ZXh0O1xyXG4gICAgfSBlbHNlIGlmICgkKCcjbGF5ZXJ0cmVlX3BvcF9uYW1lJykuaXMoJzpjaGVja2VkJykpIHtcclxuICAgICAgICBzdHlsZSA9IHN0eWxlX3dpdGhfdGV4dDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgc3R5bGUgPSBzdHlsZV93aXRob3V0X3RleHQ7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBbc3R5bGVdO1xyXG59O1xyXG5cclxuLy8gc3RldWVydCBkZW4gc3R5bGUgdm9uIHRwb3BcclxuLy8gdHBvcGlkX21hcmtpZXJ0OiBiZWltIEF1ZmJhdSBkZXMgTGF5ZXJzIHdlcmRlbiBtYXJraWVydGUgbWl0Z2VnZWJlblxyXG4vLyBzZWxlY3RlZDogbWl0IGRlciBNYXVzIG9kZXIgZHJhZ19ib3ggbWFya2llcnRlXHJcbi8vIHZlcm9ydGVuOiBiZWltIFZlcm9ydGVuIHNvbGwgZGFzIFN5bWJvbCByb3Qgc2VpblxyXG53aW5kb3cuYXBmLm9sbWFwLnRwb3BTdHlsZSA9IGZ1bmN0aW9uKGZlYXR1cmUsIHJlc29sdXRpb24sIHNlbGVjdGVkLCB2ZXJvcnRlbikge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIHZhciBpY29uID0gJ2ltZy9mbG9yYV9pY29uLnBuZycsXHJcbiAgICAgICAgdHBvcGlkID0gZmVhdHVyZS5nZXQoJ215SWQnKSxcclxuICAgICAgICBzdHlsZSxcclxuICAgICAgICBpbWFnZV9zdHlsZSxcclxuICAgICAgICB0ZXh0X2luaGFsdCxcclxuICAgICAgICB0ZXh0X3N0eWxlLFxyXG4gICAgICAgIHN0cm9rZV9jb2xvciA9ICd3aGl0ZScsXHJcbiAgICAgICAgc3R5bGVfd2l0aF90ZXh0LFxyXG4gICAgICAgIHN0eWxlX3dpdGhvdXRfdGV4dCxcclxuICAgICAgICAkbGF5ZXJ0cmVlX3Rwb3BfbnIgPSAkKCcjbGF5ZXJ0cmVlX3Rwb3BfbnInKTtcclxuXHJcbiAgICAvLyBtYXJraWVydGU6IGljb24gaXN0IGdlbGJcclxuICAgIGlmIChzZWxlY3RlZCkge1xyXG4gICAgICAgIGljb24gPSAnaW1nL2Zsb3JhX2ljb25fZ2VsYi5wbmcnO1xyXG4gICAgICAgIHN0cm9rZV9jb2xvciA9ICdyZWQnO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh2ZXJvcnRlbikge1xyXG4gICAgXHRpY29uID0gJ2ltZy9mbG9yYV9pY29uX3JvdC5wbmcnO1xyXG4gICAgfVxyXG5cclxuICAgIGltYWdlX3N0eWxlID0gbmV3IG9sLnN0eWxlLkljb24oLyoqIEB0eXBlIHtvbHguc3R5bGUuSWNvbk9wdGlvbnN9ICovICh7XHJcbiAgICAgICAgYW5jaG9yOiBbMC41LCA0Nl0sXHJcbiAgICAgICAgYW5jaG9yWFVuaXRzOiAnZnJhY3Rpb24nLFxyXG4gICAgICAgIGFuY2hvcllVbml0czogJ3BpeGVscycsXHJcbiAgICAgICAgb3BhY2l0eTogMSxcclxuICAgICAgICBzcmM6IGljb25cclxuICAgIH0pKTtcclxuXHJcbiAgICAvLyB0ZXh0IGJlc3RpbW1lbiwgYWJow6RuZ2lnIHZvbiBkZXIgRWluc3RlbGx1bmcgaW0gTGF5ZXJ0cmVlXHJcbiAgICBpZiAoJGxheWVydHJlZV90cG9wX25yLmlzKCc6Y2hlY2tlZCcpKSB7XHJcbiAgICAgICAgdGV4dF9pbmhhbHQgPSBmZWF0dXJlLmdldCgndHBvcF9ucl9sYWJlbCcpO1xyXG4gICAgfSBlbHNlIGlmICgkKCcjbGF5ZXJ0cmVlX3Rwb3BfbmFtZScpLmlzKCc6Y2hlY2tlZCcpKSB7XHJcbiAgICAgICAgdGV4dF9pbmhhbHQgPSBmZWF0dXJlLmdldCgndHBvcF9uYW1lJyk7XHJcbiAgICB9XHJcblxyXG4gICAgdGV4dF9zdHlsZSA9IG5ldyBvbC5zdHlsZS5UZXh0KHtcclxuICAgICAgICBmb250OiAnYm9sZCAxMXB4IEFyaWFsLCBWZXJkYW5hLCBIZWx2ZXRpY2EsIHNhbnMtc2VyaWYnLFxyXG4gICAgICAgIHRleHQ6IHRleHRfaW5oYWx0LFxyXG4gICAgICAgIGZpbGw6IG5ldyBvbC5zdHlsZS5GaWxsKHtcclxuICAgICAgICAgICAgY29sb3I6ICdibGFjaydcclxuICAgICAgICB9KSxcclxuICAgICAgICBzdHJva2U6IG5ldyBvbC5zdHlsZS5TdHJva2Uoe1xyXG4gICAgICAgICAgICBjb2xvcjogc3Ryb2tlX2NvbG9yLFxyXG4gICAgICAgICAgICB3aWR0aDogN1xyXG4gICAgICAgIH0pXHJcbiAgICB9KTtcclxuXHJcbiAgICBzdHlsZV93aXRoX3RleHQgPSBuZXcgb2wuc3R5bGUuU3R5bGUoe1xyXG4gICAgICAgIGltYWdlOiBpbWFnZV9zdHlsZSxcclxuICAgICAgICB0ZXh0OiB0ZXh0X3N0eWxlXHJcbiAgICB9KTtcclxuICAgIHN0eWxlX3dpdGhvdXRfdGV4dCA9IG5ldyBvbC5zdHlsZS5TdHlsZSh7XHJcbiAgICAgICAgaW1hZ2U6IGltYWdlX3N0eWxlXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBzdHlsZSBiZXN0aW1tZW5cclxuICAgIGlmICgkbGF5ZXJ0cmVlX3Rwb3BfbnIuaXMoJzpjaGVja2VkJykpIHtcclxuICAgICAgICBzdHlsZSA9IHN0eWxlX3dpdGhfdGV4dDtcclxuICAgIH0gZWxzZSBpZiAoJCgnI2xheWVydHJlZV90cG9wX25hbWUnKS5pcygnOmNoZWNrZWQnKSkge1xyXG4gICAgICAgIHN0eWxlID0gc3R5bGVfd2l0aF90ZXh0O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBzdHlsZSA9IHN0eWxlX3dpdGhvdXRfdGV4dDtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gW3N0eWxlXTtcclxufTtcclxuXHJcbndpbmRvdy5hcGYub2xtYXAubWVzc2UgPSBmdW5jdGlvbihlbGVtZW50KSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG4gICAgd2luZG93LmFwZi5vbG1hcC5kZWFjdGl2YXRlTWVudUl0ZW1zKCk7XHJcblx0aWYgKGVsZW1lbnQudmFsdWUgPT09ICdsaW5lJyAmJiBlbGVtZW50LmNoZWNrZWQpIHtcclxuXHRcdHdpbmRvdy5hcGYub2xtYXAuYWRkTWVhc3VyZUludGVyYWN0aW9uKCdMaW5lU3RyaW5nJyk7XHJcblx0fSBlbHNlIGlmIChlbGVtZW50LnZhbHVlID09PSAncG9seWdvbicgJiYgZWxlbWVudC5jaGVja2VkKSB7XHJcblx0XHR3aW5kb3cuYXBmLm9sbWFwLmFkZE1lYXN1cmVJbnRlcmFjdGlvbignUG9seWdvbicpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHR3aW5kb3cuYXBmLm9sbWFwLnJlbW92ZU1lYXN1cmVJbnRlcmFjdGlvbigpO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5hcGYub2xtYXAucmVtb3ZlTWVhc3VyZUludGVyYWN0aW9uID0gZnVuY3Rpb24oKSB7XHJcblx0d2luZG93LmFwZi5vbG1hcC5lbnRmZXJuZUxheWVyTmFjaE5hbWUoJ21lc3NlbicpO1xyXG5cdHdpbmRvdy5hcGYub2xtYXAubWFwLnJlbW92ZUludGVyYWN0aW9uKHdpbmRvdy5hcGYub2xtYXAuZHJhd01lYXN1cmUpO1xyXG5cdGRlbGV0ZSB3aW5kb3cuYXBmLm9sbWFwLmRyYXdNZWFzdXJlO1xyXG5cdCQoXCIjZXJnZWJuaXNNZXNzdW5nXCIpLnRleHQoXCJcIik7XHJcblx0JCh3aW5kb3cuYXBmLm9sbWFwLm1hcC5nZXRWaWV3cG9ydCgpKS5vZmYoJ21vdXNlbW92ZScpO1xyXG59O1xyXG5cclxuLy8gZXJow6RsdCBkZW4gVHlwIGRlciBJbnRlcmFrdGlvbjogJ1BvbHlnb24nIG9kZXIgJ0xpbmVTdHJpbmcnXHJcbndpbmRvdy5hcGYub2xtYXAuYWRkTWVhc3VyZUludGVyYWN0aW9uID0gZnVuY3Rpb24odHlwZSkge1xyXG5cdC8vIGFsbGbDpGxsaWdlIFJlc3RlbiBlbnRmZXJuZW5cclxuXHR3aW5kb3cuYXBmLm9sbWFwLnJlbW92ZU1lYXN1cmVJbnRlcmFjdGlvbigpO1xyXG5cdC8vIG5ldSBhdWZiYXVlblxyXG5cdHZhciBzb3VyY2UgPSBuZXcgb2wuc291cmNlLlZlY3RvcigpO1xyXG5cdHZhciBtZXNzZW5fbGF5ZXIgPSBuZXcgb2wubGF5ZXIuVmVjdG9yKHtcclxuXHRcdHRpdGxlOiAnbWVzc2VuJyxcclxuICAgICAgICBzb3VyY2U6IHNvdXJjZSxcclxuICAgICAgICBzdHlsZTogbmV3IG9sLnN0eWxlLlN0eWxlKHtcclxuICAgICAgICAgICAgZmlsbDogbmV3IG9sLnN0eWxlLkZpbGwoe1xyXG4gICAgICAgICAgICAgICAgY29sb3I6ICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMiknXHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICBzdHJva2U6IG5ldyBvbC5zdHlsZS5TdHJva2Uoe1xyXG4gICAgICAgICAgICAgICAgY29sb3I6ICdyZ2JhKDI1NSwgMCwgMCwgMSknLFxyXG4gICAgICAgICAgICAgICAgd2lkdGg6IDMsXHJcbiAgICAgICAgICAgICAgICBsaW5lRGFzaDogWzIsIDJdLFxyXG4gICAgICAgICAgICAgICAgbGluZUNhcDogJ3NxdWFyZSdcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgIGltYWdlOiBuZXcgb2wuc3R5bGUuQ2lyY2xlKHtcclxuICAgICAgICAgICAgICAgIHJhZGl1czogNyxcclxuICAgICAgICAgICAgICAgIGZpbGw6IG5ldyBvbC5zdHlsZS5GaWxsKHtcclxuICAgICAgICAgICAgICAgICAgICBjb2xvcjogJyNmZmNjMzMnXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcbiAgICB9KTtcclxuXHJcbiAgICB3aW5kb3cuYXBmLm9sbWFwLm1hcC5hZGRMYXllcihtZXNzZW5fbGF5ZXIpO1xyXG5cclxuICAgIC8vIEN1cnJlbnRseSBkcmF3ZWQgZmVhdHVyZVxyXG4gICAgLy8gQHR5cGUge29sLkZlYXR1cmV9XHJcbiAgICB2YXIgc2tldGNoID0gbnVsbDtcclxuXHJcbiAgICAvLyBFbGVtZW50IGZvciBjdXJyZW50bHkgZHJhd2VkIGZlYXR1cmVcclxuICAgIC8vIEB0eXBlIHtFbGVtZW50fVxyXG4gICAgdmFyIHNrZXRjaEVsZW1lbnQ7XHJcblxyXG4gICAgLy8gaGFuZGxlIHBvaW50ZXIgbW92ZVxyXG4gICAgLy8gQHBhcmFtIHtFdmVudH0gZXZ0XHJcbiAgICB2YXIgbW91c2VNb3ZlSGFuZGxlciA9IGZ1bmN0aW9uKGV2dCkge1xyXG4gICAgICAgIGlmIChza2V0Y2gpIHtcclxuICAgICAgICAgICAgdmFyIG91dHB1dCxcclxuICAgICAgICAgICAgXHRnZW9tID0gKHNrZXRjaC5nZXRHZW9tZXRyeSgpKTtcclxuICAgICAgICAgICAgaWYgKGdlb20gaW5zdGFuY2VvZiBvbC5nZW9tLlBvbHlnb24pIHtcclxuICAgICAgICAgICAgICAgIG91dHB1dCA9IHdpbmRvdy5hcGYub2xtYXAuZm9ybWF0QXJlYSgvKiogQHR5cGUge29sLmdlb20uUG9seWdvbn0gKi8gKGdlb20pKTtcclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZ2VvbSBpbnN0YW5jZW9mIG9sLmdlb20uTGluZVN0cmluZykge1xyXG4gICAgICAgICAgICAgICAgb3V0cHV0ID0gd2luZG93LmFwZi5vbG1hcC5mb3JtYXRMZW5ndGgoIC8qKiBAdHlwZSB7b2wuZ2VvbS5MaW5lU3RyaW5nfSAqLyAoZ2VvbSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNrZXRjaEVsZW1lbnQuaW5uZXJIVE1MID0gb3V0cHV0O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgJCh3aW5kb3cuYXBmLm9sbWFwLm1hcC5nZXRWaWV3cG9ydCgpKS5vbignbW91c2Vtb3ZlJywgbW91c2VNb3ZlSGFuZGxlcik7XHJcblxyXG4gICAgd2luZG93LmFwZi5vbG1hcC5kcmF3TWVhc3VyZSA9IG5ldyBvbC5pbnRlcmFjdGlvbi5EcmF3KHtcclxuICAgICAgICBzb3VyY2U6IHNvdXJjZSxcclxuICAgICAgICB0eXBlOiAvKiogQHR5cGUge29sLmdlb20uR2VvbWV0cnlUeXBlfSAqLyAodHlwZSlcclxuICAgIH0pO1xyXG4gICAgd2luZG93LmFwZi5vbG1hcC5tYXAuYWRkSW50ZXJhY3Rpb24od2luZG93LmFwZi5vbG1hcC5kcmF3TWVhc3VyZSk7XHJcblxyXG4gICAgd2luZG93LmFwZi5vbG1hcC5kcmF3TWVhc3VyZS5vbignZHJhd3N0YXJ0JyxcclxuICAgICAgICBmdW5jdGlvbihldnQpIHtcclxuICAgICAgICAgICAgLy8gc2V0IHNrZXRjaFxyXG4gICAgICAgICAgICBza2V0Y2ggPSBldnQuZmVhdHVyZTtcclxuICAgICAgICAgICAgc2tldGNoRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgICAgICAgICAgIHZhciBvdXRwdXRMaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VyZ2VibmlzTWVzc3VuZycpO1xyXG4gICAgICAgICAgICBpZiAob3V0cHV0TGlzdC5jaGlsZE5vZGVzKSB7XHJcbiAgICAgICAgICAgICAgICBvdXRwdXRMaXN0Lmluc2VydEJlZm9yZShza2V0Y2hFbGVtZW50LCBvdXRwdXRMaXN0LmZpcnN0Q2hpbGQpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgb3V0cHV0TGlzdC5hcHBlbmRDaGlsZChza2V0Y2hFbGVtZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIHRoaXMpO1xyXG5cclxuICAgIHdpbmRvdy5hcGYub2xtYXAuZHJhd01lYXN1cmUub24oJ2RyYXdlbmQnLFxyXG4gICAgICAgIGZ1bmN0aW9uKGV2dCkge1xyXG4gICAgICAgICAgICAvLyB1bnNldCBza2V0Y2hcclxuICAgICAgICAgICAgc2tldGNoID0gbnVsbDtcclxuICAgICAgICAgICAgc2tldGNoRWxlbWVudCA9IG51bGw7XHJcbiAgICAgICAgfSwgdGhpcyk7XHJcbn07XHJcblxyXG4vKipcclxuICogZm9ybWF0IGxlbmd0aCBvdXRwdXRcclxuICogQHBhcmFtIHtvbC5nZW9tLkxpbmVTdHJpbmd9IGxpbmVcclxuICogQHJldHVybiB7c3RyaW5nfVxyXG4qL1xyXG53aW5kb3cuYXBmLm9sbWFwLmZvcm1hdExlbmd0aCA9IGZ1bmN0aW9uKGxpbmUpIHtcclxuICAgIHZhciBsZW5ndGggPSBNYXRoLnJvdW5kKGxpbmUuZ2V0TGVuZ3RoKCkgKiAxMDApIC8gMTAwLFxyXG4gICAgXHRvdXRwdXQ7XHJcbiAgICBpZiAobGVuZ3RoID4gMTAwKSB7XHJcbiAgICAgICAgb3V0cHV0ID0gKE1hdGgucm91bmQobGVuZ3RoIC8gMTAwMCAqIDEwMCkgLyAxMDApICsgJyBrbSc7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIG91dHB1dCA9IChNYXRoLnJvdW5kKGxlbmd0aCAqIDEwMCkgLyAxMDApICsgJyBtJztcclxuICAgIH1cclxuICAgIHJldHVybiBvdXRwdXQ7XHJcbn07XHJcblxyXG4vKipcclxuICogZm9ybWF0IGxlbmd0aCBvdXRwdXRcclxuICogQHBhcmFtIHtvbC5nZW9tLlBvbHlnb259IHBvbHlnb25cclxuICogQHJldHVybiB7c3RyaW5nfVxyXG4qL1xyXG53aW5kb3cuYXBmLm9sbWFwLmZvcm1hdEFyZWEgPSBmdW5jdGlvbihwb2x5Z29uKSB7XHJcbiAgICB2YXIgYXJlYSA9IHBvbHlnb24uZ2V0QXJlYSgpLFxyXG4gICAgXHRvdXRwdXQ7XHJcbiAgICBpZiAoYXJlYSA+IDEwMDAwKSB7XHJcbiAgICAgICAgb3V0cHV0ID0gKE1hdGgucm91bmQoYXJlYSAvIDEwMDAwMDAgKiAxMDApIC8gMTAwKSArICcga208c3VwPjI8L3N1cD4nO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBvdXRwdXQgPSAoTWF0aC5yb3VuZChhcmVhICogMTAwKSAvIDEwMCkgKyAnIG08c3VwPjI8L3N1cD4nO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG91dHB1dDtcclxufTtcclxuXHJcbndpbmRvdy5hcGYub2xtYXAud8OkaGxlQXVzID0gZnVuY3Rpb24oKSB7XHJcbiAgICB3aW5kb3cuYXBmLm9sbWFwLmRlYWN0aXZhdGVNZW51SXRlbXMoKTtcclxuICAgIHdpbmRvdy5hcGYub2xtYXAuYWRkU2VsZWN0RmVhdHVyZXNJblNlbGVjdGFibGVMYXllcnMoKTtcclxufTtcclxuXHJcbndpbmRvdy5hcGYub2xtYXAuc2NobGllc3NlTGF5ZXJvcHRpb25lbiA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuICAgICQoXCIjb2xtYXBfbGF5ZXJ0cmVlXCIpLmFjY29yZGlvbihcIm9wdGlvblwiLCBcImFjdGl2ZVwiLCBmYWxzZSk7XHJcbn07XHJcblxyXG53aW5kb3cuYXBmLmVyc3RlbGxlR2VtZWluZGVsaXN0ZSA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRpZiAoIXdpbmRvdy5hcGYuZ2VtZWluZGVuKSB7XHJcblx0XHR2YXIgZ2V0R2VtZWluZGVuID0gJC5hamF4KHtcclxuXHRcdFx0dHlwZTogJ2dldCcsXHJcblx0XHRcdHVybDogJ2FwaS9nZW1laW5kZW4nLFxyXG5cdFx0XHRkYXRhVHlwZTogJ2pzb24nXHJcblx0XHR9KTtcclxuXHRcdGdldEdlbWVpbmRlbi5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRpZiAoZGF0YSkge1xyXG5cdFx0XHRcdC8vIEdlbWVpbmRlbiBiZXJlaXRzdGVsbGVuXHJcblx0XHRcdFx0Ly8gRmVsZCBtaXQgRGF0ZW4gYmVsaWVmZXJuXHJcbiAgICAgICAgICAgICAgICB2YXIgZ2VtZWluZGVuID0gXy5tYXAoZGF0YSwgZnVuY3Rpb24oZ2VtZWluZGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZ2VtZWluZGUuR21kTmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2VtZWluZGUuR21kTmFtZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHRcdFx0XHR3aW5kb3cuYXBmLmdlbWVpbmRlbiA9IGdlbWVpbmRlbjtcclxuXHRcdFx0XHQvLyBhdXRvY29tcGxldGUtd2lkZ2V0IGbDvHIgR2VtZWluZGVuIGluaXRpaWVyZW5cclxuXHRcdFx0XHQkKFwiI1RQb3BHZW1laW5kZVwiKS5hdXRvY29tcGxldGUoe1xyXG5cdFx0XHRcdFx0c291cmNlOiBnZW1laW5kZW4sXHJcblx0XHRcdFx0XHRkZWxheTogMCxcclxuXHRcdFx0XHRcdC8vIENoYW5nZS1FdmVudCB3aXJkIG5pY2h0IGF1c2dlbMO2c3QgPiBoaWVyIGF1ZnJ1ZmVuXHJcblx0XHRcdFx0XHRjaGFuZ2U6IGZ1bmN0aW9uKGV2ZW50LCB1aSkge1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYXBmLnNwZWljaGVybihldmVudC50YXJnZXQpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRcdGdldEdlbWVpbmRlbi5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IERpZSBMaXN0ZSBkZXIgR2VtZWluZGVuIGtvbm50ZSBuaWNodCBiZXJlaXRnZXN0ZWxsdCB3ZXJkZW5cIik7XHJcblx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IERpZSBMaXN0ZSBkZXIgR2VtZWluZGVuIGtvbm50ZSBuaWNodCBiZXJlaXRnZXN0ZWxsdCB3ZXJkZW4nKTtcclxuXHRcdH0pO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5hcGYud8OkaGxlQXAgPSBmdW5jdGlvbihhcF9pZCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRpZiAoYXBfaWQpIHtcclxuXHRcdC8vIGVpbmVuIEFQIGdld8OkaGx0XHJcblx0XHQkKFwiI2FwX3dhZWhsZW5fbGFiZWxcIikuaGlkZSgpO1xyXG5cdFx0bG9jYWxTdG9yYWdlLmFwX2lkID0gYXBfaWQ7XHJcblx0XHRpZiAoJChcIltuYW1lPSdwcm9ncmFtbV93YWhsJ106Y2hlY2tlZFwiKS5hdHRyKFwiaWRcIikgPT09IFwicHJvZ3JhbW1fbmV1XCIpIHtcclxuXHRcdFx0Ly8genVlcnN0IGVpbmVuIG5ldWVuIERhdGVuc2F0eiBhbmxlZ2VuXHJcblx0XHRcdHZhciBpbnNlcnRBcCA9ICQuYWpheCh7XHJcblx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdHVybDogJ3BocC9hcF9pbnNlcnQucGhwJyxcclxuXHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHRcdFwiaWRcIjogbG9jYWxTdG9yYWdlLmFwX2lkLFxyXG5cdFx0XHRcdFx0XCJ1c2VyXCI6IHNlc3Npb25TdG9yYWdlLlVzZXJcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRpbnNlcnRBcC5hbHdheXMoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0Ly8gbmFjaGRlbSBlaW4gbmV1ZXMgUHJvZ3JhbW0gZXJzdGVsbHQgd3VyZGUsIHNvbGwgbmljaHQgbWVociBcIm5ldVwiIHp1ciBXYWhsIHN0ZWhlbiwgc29uZGVybiBcImFsbGVcIlxyXG5cdFx0XHRcdCQoXCIjcHJvZ3JhbW1fbmV1XCIpLmF0dHIoXCJjaGVja2VkXCIsIGZhbHNlKTtcclxuXHRcdFx0XHQkKFwiI3Byb2dyYW1tX2FsbGVcIikuYXR0cihcImNoZWNrZWRcIiwgdHJ1ZSk7XHJcblx0XHRcdFx0JChcIiNwcm9ncmFtbV93YWhsXCIpLmJ1dHRvbnNldCgpO1xyXG5cdFx0XHRcdC8vIEF1c3dhaGxsaXN0ZSBmw7xyIFByb2dyYW1tZSB1cGRhdGVuXHJcblx0XHRcdFx0JC53aGVuKHdpbmRvdy5hcGYud8OkaGxlQXBMaXN0ZShcInByb2dyYW1tX2FsbGVcIikpXHJcblx0XHRcdFx0XHQudGhlbihmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0Ly8gU3RydWt0dXJiYXVtIHVwZGF0ZW5cclxuXHRcdFx0XHRcdFx0JC53aGVuKHdpbmRvdy5hcGYuZXJzdGVsbGVfdHJlZShsb2NhbFN0b3JhZ2UuYXBfaWQpKVxyXG5cdFx0XHRcdFx0XHRcdC50aGVuKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gZ2V3w6RobHRlIEFydCBpbiBBdXN3YWhsbGlzdGUgYW56ZWlnZW5cclxuXHRcdFx0XHRcdFx0XHRcdCQoJyNhcF93YWVobGVuJykudmFsKGxvY2FsU3RvcmFnZS5hcF9pZCk7XHJcblx0XHRcdFx0XHRcdFx0XHQkKCcjYXBfd2FlaGxlbiBvcHRpb25bdmFsdWUgPScgKyBsb2NhbFN0b3JhZ2UuYXBfaWQgKyAnXScpLmF0dHIoJ3NlbGVjdGVkJywgdHJ1ZSk7XHJcblx0XHRcdFx0XHRcdFx0XHQkKFwiI0FwQXJ0SWRcIikudmFsKGxvY2FsU3RvcmFnZS5hcF9pZCk7XHJcblx0XHRcdFx0XHRcdFx0XHQvLyBnZXfDpGhsdGUgQXJ0IGluIEZvcm11bGFyIGFuemVpZ2VuXHJcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuYXBmLmluaXRpaWVyZV9hcCgpO1xyXG5cdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9KTtcclxuXHRcdFx0aW5zZXJ0QXAuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IEtlaW5lIERhdGVuIGbDvHIgUHJvZ3JhbW1lIGVyaGFsdGVuXCIpO1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IEtlaW5lIERhdGVuIGbDvHIgUHJvZ3JhbW1lIGVyaGFsdGVuJyk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0d2luZG93LmFwZi5lcnN0ZWxsZV90cmVlKGFwX2lkKTtcclxuXHRcdFx0JChcIiNhcFwiKS5zaG93KCk7XHJcblx0XHRcdHdpbmRvdy5hcGYuaW5pdGlpZXJlX2FwKCk7XHJcblx0XHR9XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vIGxlZXJlbiBXZXJ0IGdld8OkaGx0XHJcblx0XHQkKFwiI2FwX3dhZWhsZW5fbGFiZWxcIikuaHRtbChcIkFydGbDtnJkZXJwcm9ncmFtbSB3w6RobGVuOlwiKS5zaG93KCk7XHJcblx0XHQkKFwiI3RyZWVcIikuaGlkZSgpO1xyXG5cdFx0JChcIiNzdWNoZW5cIikuaGlkZSgpO1xyXG5cdFx0JChcIiNleHBvcnRpZXJlbl8yXCIpLmhpZGUoKTtcclxuXHRcdCQoXCIjaGlsZmVcIikuaGlkZSgpO1xyXG5cdFx0JChcIiNhcF9sb2VzY2hlblwiKS5oaWRlKCk7XHJcblx0XHQkKFwiI2V4cG9ydGllcmVuXzFcIikuc2hvdygpO1xyXG5cdFx0JChcIiNhcFwiKS5oaWRlKCk7XHJcblx0XHR3aW5kb3cuYXBmLnplaWdlRm9ybXVsYXIoKTtcclxuXHRcdGhpc3RvcnkucmVwbGFjZVN0YXRlKHthcDogXCJhcFwifSwgXCJhcFwiLCBcImluZGV4Lmh0bWxcIik7XHJcblx0fVxyXG59O1xyXG5cclxud2luZG93LmFwZi5rb3BpZXJlS29vcmRpbmF0ZW5JblBvcCA9IGZ1bmN0aW9uKHhfa29vcmQsIHlfa29vcmQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gcHLDvGZlbiwgb2IgWC0gdW5kIFktS29vcmRpbmF0ZW4gdmVyZ2ViZW4gc2luZFxyXG5cdGlmICh4X2tvb3JkID4gMTAwMDAwICYmIHlfa29vcmQgPiAxMDAwMDApIHtcclxuXHRcdC8vIEtvb3JkaW5hdGVuIGRlciBQb3AgbmFjaGbDvGhyZW5cclxuXHRcdHZhciB1cGRhdGVfcG9wID0gJC5hamF4KHtcclxuXHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHR1cmw6ICdwaHAvcG9wX3VwZGF0ZS5waHAnLFxyXG5cdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxyXG5cdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XCJpZFwiOiBsb2NhbFN0b3JhZ2UucG9wX2lkLFxyXG5cdFx0XHRcdFwiRmVsZFwiOiBcIlBvcFhLb29yZFwiLFxyXG5cdFx0XHRcdFwiV2VydFwiOiB4X2tvb3JkLFxyXG5cdFx0XHRcdFwidXNlclwiOiBzZXNzaW9uU3RvcmFnZS5Vc2VyXHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0dXBkYXRlX3BvcC5hbHdheXMoZnVuY3Rpb24oKSB7XHJcblx0XHRcdHZhciB1cGRhdGVQb3BfNCA9ICQuYWpheCh7XHJcblx0XHRcdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0XHRcdHVybDogJ3BocC9wb3BfdXBkYXRlLnBocCcsXHJcblx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0XHRkYXRhOiB7XHJcblx0XHRcdFx0XHRcImlkXCI6IGxvY2FsU3RvcmFnZS5wb3BfaWQsXHJcblx0XHRcdFx0XHRcIkZlbGRcIjogXCJQb3BZS29vcmRcIixcclxuXHRcdFx0XHRcdFwiV2VydFwiOiB5X2tvb3JkLFxyXG5cdFx0XHRcdFx0XCJ1c2VyXCI6IHNlc3Npb25TdG9yYWdlLlVzZXJcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0XHR1cGRhdGVQb3BfNC5hbHdheXMoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0JChcIiNrb3BpZXJlS29vcmRpbmF0ZW5JblBvcFJ1ZWNrbWVsZHVuZ1wiKS5mYWRlSW4oJ3Nsb3cnKTtcclxuXHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0JChcIiNrb3BpZXJlS29vcmRpbmF0ZW5JblBvcFJ1ZWNrbWVsZHVuZ1wiKS5mYWRlT3V0KCdzbG93Jyk7XHJcblx0XHRcdFx0fSwgMzAwMCk7XHJcblx0XHRcdH0pO1xyXG5cdFx0XHR1cGRhdGVQb3BfNC5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogWS1Lb29yZGluYXRlIHd1cmRlIG5pY2h0IGtvcGllcnQgKGRpZSBYLUtvb3JkaW5hdGUgb2ZmZW5iYXIgc2Nob24pXCIpO1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKCdGZWhsZXI6IFktS29vcmRpbmF0ZSB3dXJkZSBuaWNodCBrb3BpZXJ0IChkaWUgWC1Lb29yZGluYXRlIG9mZmVuYmFyIHNjaG9uKScpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cdFx0dXBkYXRlX3BvcC5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHQvL3dpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IEtvb3JkaW5hdGVuIHd1cmRlbiBuaWNodCBrb3BpZXJ0XCIpO1xyXG5cdFx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBLb29yZGluYXRlbiB3dXJkZW4gbmljaHQga29waWVydCcpO1xyXG5cdFx0fSk7XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vIGF1ZmZvcmRlcm4sIGRpZSBLb29yZGluYXRlbiB6dSB2ZXJnZWJlbiB1bmQgU3BlaWNoZXJuIGFiYnJlY2hlblxyXG5cdFx0d2luZG93LmFwZi5tZWxkZShcIlNpZSBtw7xzc2VuIHp1ZXJzdCBLb29yZGluYXRlbiBlcmZhc3NlblwiLCBcIktvb3JkaW5hdGVuIG5pY2h0IGtvcGllcnRcIik7XHJcblx0fVxyXG59O1xyXG5cclxud2luZG93LmFwZi5wcsO8ZmVBbm1lbGR1bmcgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcbiAgICB2YXIgJGFubWVsZHVuZ19uYW1lID0gJChcIiNhbm1lbGR1bmdfbmFtZVwiKS52YWwoKSxcclxuICAgICAgICAkYW5tZWxkdW5nX3Bhc3N3b3J0ID0gJChcIiNhbm1lbGR1bmdfcGFzc3dvcnRcIikudmFsKCk7XHJcblx0Ly8gTGVzZXJlY2h0ZSB6dXLDvGNrc2V0emVuXHJcblx0ZGVsZXRlIHNlc3Npb25TdG9yYWdlLk51ckxlc2VuO1xyXG5cdGlmICgkYW5tZWxkdW5nX25hbWUgJiYgJGFubWVsZHVuZ19wYXNzd29ydCkge1xyXG5cdFx0dmFyIGdldEFubWVsZHVuZyA9ICQuYWpheCh7XHJcblx0XHRcdHR5cGU6ICdnZXQnLFxyXG5cdFx0XHR1cmw6ICdhcGkvYW5tZWxkdW5nL25hbWU9JyArICRhbm1lbGR1bmdfbmFtZSArICcvcHdkPScgKyAkYW5tZWxkdW5nX3Bhc3N3b3J0LFxyXG5cdFx0XHRkYXRhVHlwZTogJ2pzb24nXHJcblx0XHR9KTtcclxuXHRcdGdldEFubWVsZHVuZy5hbHdheXMoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRpZiAoZGF0YSAmJiBkYXRhLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0XHRzZXNzaW9uU3RvcmFnZS5Vc2VyID0gJGFubWVsZHVuZ19uYW1lO1xyXG5cdFx0XHRcdC8vIHdlbm4gTnVyTGVzZW4sIGdsb2JhbGUgVmFyaWFibGUgc2V0emVuXHJcblx0XHRcdFx0aWYgKGRhdGFbMF0uTnVyTGVzZW4gPT09IC0xKSB7XHJcblx0XHRcdFx0XHRzZXNzaW9uU3RvcmFnZS5OdXJMZXNlbiA9IHRydWU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdCQoXCIjYW5tZWxkdW5nX3J1ZWNrbWVsZHVuZ1wiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5odG1sKFwiV2lsbGtvbW1lbiBcIiArICRhbm1lbGR1bmdfbmFtZSlcclxuICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoXCJ1aS1zdGF0ZS1oaWdobGlnaHRcIik7XHJcblx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdCQoXCIjYW5tZWxkZV9kaWFsb2dcIikuZGlhbG9nKFwiY2xvc2VcIiwgMjAwMCk7XHJcblx0XHRcdFx0fSwgMTAwMCk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0JChcIiNhbm1lbGR1bmdfcnVlY2ttZWxkdW5nXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLmh0bWwoXCJBbm1lbGR1bmcgZ2VzY2hlaXRlcnRcIilcclxuICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoXCJ1aS1zdGF0ZS1oaWdobGlnaHRcIik7XHJcblx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdCQoXCIjYW5tZWxkdW5nX3J1ZWNrbWVsZHVuZ1wiKS5yZW1vdmVDbGFzcyhcInVpLXN0YXRlLWhpZ2hsaWdodFwiLCAxNTAwKTtcclxuXHRcdFx0XHR9LCA1MDApO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRcdGdldEFubWVsZHVuZy5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR3aW5kb3cuYXBmLm1lbGRlKFwiQW5tZWxkdW5nIGdlc2NoZWl0ZXJ0XCIsIFwiT29wcyFcIik7XHJcblx0XHRcdC8vY29uc29sZS5sb2coJ0FubWVsZHVuZyBnZXNjaGVpdGVydCcpO1xyXG5cdFx0fSk7XHJcblx0fSBlbHNlIHtcclxuXHRcdCQoXCIjYW5tZWxkdW5nX3J1ZWNrbWVsZHVuZ1wiKVxyXG4gICAgICAgICAgICAuaHRtbChcIkJpdHRlIE5hbWUgdW5kIFBhc3N3b3J0IGF1c2bDvGxsZW5cIilcclxuICAgICAgICAgICAgLmFkZENsYXNzKCBcInVpLXN0YXRlLWhpZ2hsaWdodFwiICk7XHJcblx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG5cdFx0XHQkKFwiI2FubWVsZHVuZ19ydWVja21lbGR1bmdcIikucmVtb3ZlQ2xhc3MoXCJ1aS1zdGF0ZS1oaWdobGlnaHRcIiwgMTUwMCk7XHJcblx0XHR9LCA1MDApO1xyXG5cdH1cclxufTtcclxuXHJcbi8vIGVyd2FydGV0IGFrdHVlbGxlIFdlcnRlIGbDvHIgamFociB1bmQgdHlwXHJcbi8vIGVyc3RlbGx0IGRlbiBsYWJlbCBmw7xyIGRlbiBCYXVtXHJcbndpbmRvdy5hcGYuZXJzdGVsbGVMYWJlbEbDvHJGZWxka29udHJvbGxlID0gZnVuY3Rpb24oamFociwgdHlwKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICh0eXBlb2YgamFociA9PT0gXCJ1bmRlZmluZWRcIikge1xyXG5cdFx0amFociA9IFwiKGtlaW4gSmFocilcIjtcclxuXHR9XHJcblx0aWYgKHR5cGVvZiB0eXAgPT09IFwidW5kZWZpbmVkXCIpIHtcclxuXHRcdHR5cCA9IFwiKGtlaW4gVHlwKVwiO1xyXG5cdH1cclxuXHRyZXR1cm4gamFociArIFwiOiBcIiArIHR5cDtcclxufTtcclxuXHJcbi8vIGVyd2FydGV0IGFrdHVlbGxlIFdlcnRlIGbDvHIgamFociB1bmQgYmV1cnRlaWx1bmdcclxuLy8gZXJzdGVsbHQgZGVuIGxhYmVsIGbDvHIgZGVuIEJhdW1cclxud2luZG93LmFwZi5lcnN0ZWxsZUxhYmVsRsO8ck1hc3NuYWhtZSA9IGZ1bmN0aW9uKGphaHIsIGJldXJ0ZWlsdW5nKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICh0eXBlb2YgamFociA9PT0gXCJ1bmRlZmluZWRcIikge1xyXG5cdFx0amFociA9IFwiKGtlaW4gSmFocilcIjtcclxuXHR9XHJcblx0aWYgKHR5cGVvZiBiZXVydGVpbHVuZyA9PT0gXCJ1bmRlZmluZWRcIikge1xyXG5cdFx0YmV1cnRlaWx1bmcgPSBcIihrZWluZSBCZXVydGVpbHVuZylcIjtcclxuXHR9XHJcblx0cmV0dXJuIGphaHIgKyBcIjogXCIgKyBiZXVydGVpbHVuZztcclxufTtcclxuXHJcbi8vIGdpYnQgSFRNTCB6dXLDvGNrLCBtaXQgZGVtIGRpZSBJbmZvcm1hdGlvbmVuIMO8YmVyIGVpbmUgQmVvYmFjaHR1bmcgZGFyZ2VzdGVsbHQgd2VyZGVuXHJcbi8vIGVyd2FydGV0IGRpZSBEYXRlbiBkZXIgQmVvYmFjaHR1bmdcclxud2luZG93LmFwZi5lcnN0ZWxsZUZlbGRlckbDvHJCZW9iID0gZnVuY3Rpb24oZGF0YSwgYmVvYnR5cCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBUaXRlbCBmw7xyIEJlb2IgaW0gRm9ybXVsYXIgZXJzdGVsbGVuXHJcblx0dmFyIGJlb2J0aXRlbCA9IFwiPGgxPkluZm9ybWF0aW9uZW4gYXVzIFwiO1xyXG5cdGlmIChiZW9idHlwID09PSBcImluZm9zcGV6aWVzXCIpIHtcclxuXHRcdGJlb2J0aXRlbCArPSBcIkluZm8gU3Blemllc1wiO1xyXG5cdH0gZWxzZSB7XHJcblx0XHRiZW9idGl0ZWwgKz0gXCJFdkFCXCI7XHJcblx0fVxyXG5cdGJlb2J0aXRlbCArPSBcIiAobmljaHQgdmVyw6RuZGVyYmFyKTwvaDE+XCI7XHJcblx0Ly8gQmVvYi1GZWxkZXIgZHluYW1pc2NoIGF1ZmJhdWVuXHJcblx0dmFyIGh0bWxfYmVvYmZlbGRlciA9IFwiPHRhYmxlPlwiLFxyXG5cdFx0aHRtbF9iZW9iZmVsZCxcclxuXHRcdG5pY2h0QW56dXplaWdlbmRlRmVsZGVyID0gW1wiTk9fSVNGU1wiLCBcIkVTUEVDRVwiLCBcIkNVU1RPTV9URVhUXzVfXCIsIFwiT0JKRUNUSURcIiwgXCJGTlNfR0lTTEFZRVJcIiwgXCJGTlNfSVNGU1wiLCBcIklEXCIsIFwiRk5TX0pBSFJcIiwgXCJOT01fQ09NUExFVFwiLCBcIkZBTUlMTEVcIl07XHJcblx0JC5lYWNoKGRhdGEsIGZ1bmN0aW9uKGluZGV4LCB2YWx1ZSkge1xyXG5cdFx0aWYgKCh2YWx1ZSB8fCB2YWx1ZSA9PT0gMCkgJiYgbmljaHRBbnp1emVpZ2VuZGVGZWxkZXIuaW5kZXhPZihpbmRleCkgPT09IC0xKSB7XHJcblx0XHRcdC8vIFRPRE86IFphaGxlbiwgdGV4dCB1bmQgTWVtb2ZlbGRlciB1bnRlcnNjaGVpZGVuXHJcblx0XHRcdC8vIFRPRE86IEZlbGRlciBkdXJjaCBleHRlcm5lIEZ1bmt0aW9uIGVyc3RlbGxlbiBsYXNzZW5cclxuXHRcdFx0Ly8gSUQ6IGJlb2JmZWxkZXJfIHZvcmFuc3RlbGxlbiwgdW0gTmFtZW5zLUtvbGxpc2lvbmVuIHp1IHZlcm1laWRlblxyXG5cdFx0XHRodG1sX2Jlb2JmZWxkID0gJzx0ciBjbGFzcz1cImZpZWxkY29udGFpblwiPjx0ZCBjbGFzcz1cImxhYmVsXCIgc3R5bGU9XCJwYWRkaW5nLWJvdHRvbTozcHg7XCI+PGxhYmVsIGZvcj1cImJlb2JmZWxkZXJfJztcclxuXHRcdFx0aHRtbF9iZW9iZmVsZCArPSBpbmRleDtcclxuXHRcdFx0aHRtbF9iZW9iZmVsZCArPSAnXCI+JztcclxuXHRcdFx0aHRtbF9iZW9iZmVsZCArPSBpbmRleDtcclxuXHRcdFx0aHRtbF9iZW9iZmVsZCArPSAnOjwvbGFiZWw+PC90ZD48dGQgY2xhc3M9XCJEYXRlbmZlbGRlclwiIHN0eWxlPVwicGFkZGluZy1ib3R0b206M3B4O1wiPjxpbnB1dCBpZD1cImJlb2JmZWxkZXJfJztcclxuXHRcdFx0aHRtbF9iZW9iZmVsZCArPSBpbmRleDtcclxuXHRcdFx0aHRtbF9iZW9iZmVsZCArPSAnXCIgY2xhc3M9XCJEYXRlbmZlbGRlclwiIHR5cGU9XCJ0ZXh0XCIgcmVhZG9ubHk9XCJyZWFkb25seVwiIHZhbHVlPVwiJztcclxuXHRcdFx0aHRtbF9iZW9iZmVsZCArPSB2YWx1ZTtcclxuXHRcdFx0aHRtbF9iZW9iZmVsZCArPSAnXCJcIj48L3RkPjwvdHI+JztcclxuXHRcdFx0aHRtbF9iZW9iZmVsZGVyICs9IGh0bWxfYmVvYmZlbGQ7XHJcblx0XHR9XHJcblx0fSk7XHJcblx0aHRtbF9iZW9iZmVsZGVyICs9IFwiPC90YWJsZT5cIjtcclxuXHRyZXR1cm4gYmVvYnRpdGVsICsgaHRtbF9iZW9iZmVsZGVyO1xyXG59O1xyXG5cclxuLy8gaW4gRE9NLU9iamVrdGVuIHNpbmQgdmllbGUgSUQncyBkZXIgTmFtZSBkZXMgRE9NLUVsZW1lbnRzIHZvcmFuZ2VzdGVsbHQsIGRhbWl0IGRpZSBJRCBlaW5kZXV0aWcgaXN0XHJcbi8vIEFDSFRVTkcgYXVmIGRpZSBSZWloZW5mb2xnZSBkZXIgRXJzYXR6YmVmZWhsZS4gU29uc3Qgd2lyZCB6LkIuIGluICd0cG9wYmVyJyAncG9wYmVyJyBlcnNldHp0IHVuZCBlcyBibGVpYnQgJ3QnXHJcbndpbmRvdy5hcGYuZXJzdGVsbGVJZEF1c0RvbUF0dHJpYnV0SWQgPSBmdW5jdGlvbihkb21BdHRyaWJ1dElkKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciByZXR1cm5XZXJ0ID0gZG9tQXR0cmlidXRJZC5yZXBsYWNlKCdhcF9vcmRuZXJfcG9wJywgJycpLnJlcGxhY2UoJ2FwX29yZG5lcl9hcHppZWwnLCAnJykucmVwbGFjZSgnYXBfb3JkbmVyX2VyZmtyaXQnLCAnJykucmVwbGFjZSgnYXBfb3JkbmVyX2piZXInLCAnJykucmVwbGFjZSgnYXBfb3JkbmVyX2JlcicsICcnKS5yZXBsYWNlKCdhcF9vcmRuZXJfYmVvYl9uaWNodF9iZXVydGVpbHQnLCAnJykucmVwbGFjZSgnYXBfb3JkbmVyX2Jlb2JfbmljaHRfenV6dW9yZG5lbicsICcnKS5yZXBsYWNlKCdpZGVhbGJpb3RvcCcsICcnKS5yZXBsYWNlKCdhcF9vcmRuZXJfYXNzb3phcnRlbicsICcnKS5yZXBsYWNlKCd0cG9wX29yZG5lcl9tYXNzbmJlcicsICcnKS5yZXBsYWNlKCd0cG9wX29yZG5lcl9tYXNzbicsICcnKS5yZXBsYWNlKCd0cG9wbWFzc25iZXInLCAnJykucmVwbGFjZSgncG9wX29yZG5lcl9tYXNzbmJlcicsICcnKS5yZXBsYWNlKCdwb3BtYXNzbmJlcicsICcnKS5yZXBsYWNlKCd0cG9wX29yZG5lcl9mZWxka29udHInLCAnJykucmVwbGFjZSgndHBvcF9vcmRuZXJfZnJlaXdrb250cicsICcnKS5yZXBsYWNlKCd0cG9wX29yZG5lcl90cG9wYmVyJywgJycpLnJlcGxhY2UoJ3Rwb3BiZXInLCAnJykucmVwbGFjZSgncG9wX29yZG5lcl9wb3BiZXInLCAnJykucmVwbGFjZSgncG9wYmVyJywgJycpLnJlcGxhY2UoJ3Rwb3Bfb3JkbmVyX2Jlb2JfenVnZW9yZG5ldCcsICcnKS5yZXBsYWNlKCdiZW9iJywgJycpLnJlcGxhY2UoJ2JlcicsICcnKTtcclxuXHRpZiAoZG9tQXR0cmlidXRJZCA9PSByZXR1cm5XZXJ0ICYmIHBhcnNlSW50KHJldHVybldlcnQpICYmIHBhcnNlSW50KHJldHVybldlcnQpICE9IHJldHVybldlcnQpIHtcclxuXHRcdGNvbnNvbGUubG9nKCd3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkIG1lbGRldDogZXJoYWx0ZW4gJyArIGRvbUF0dHJpYnV0SWQgKyAnLCB6dXLDvGNrZ2VnZWJlbjogJyArIHJldHVybldlcnQgKyAnLiBEaWUgUmVnZWwgaW4gZGVyIGZ1bmN0aW9uIG11c3Mgd29obCBhbmdlcGFzc3Qgd2VyZGVuJyk7XHJcblx0fVxyXG5cdHJldHVybiByZXR1cm5XZXJ0O1xyXG59O1xyXG5cclxud2luZG93LmFwZi56ZWlnZUJlb2JLb29yZGluYXRlbkltR2lzQnJvd3NlciA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgVVJMLFxyXG4gICAgICAgIHRhcmdldCxcclxuICAgICAgICAkYmVvYmZlbGRlcl9GTlNfWEdJUyA9ICQoXCIjYmVvYmZlbGRlcl9GTlNfWEdJU1wiKSxcclxuICAgICAgICAkYmVvYmZlbGRlcl9GTlNfWUdJUyA9ICQoXCIjYmVvYmZlbGRlcl9GTlNfWUdJU1wiKSxcclxuICAgICAgICAkYmVvYmZlbGRlcl9DT09SRE9OTkVFX0ZFRF9FID0gJChcIiNiZW9iZmVsZGVyX0NPT1JET05ORUVfRkVEX0VcIiksXHJcbiAgICAgICAgJGJlb2JmZWxkZXJfQ09PUkRPTk5FRV9GRURfTiA9ICQoXCIjYmVvYmZlbGRlcl9DT09SRE9OTkVFX0ZFRF9OXCIpLFxyXG4gICAgICAgICRUUG9wWEtvb3JkID0gJChcIiNUUG9wWEtvb3JkXCIpLFxyXG4gICAgICAgICRUUG9wWUtvb3JkID0gJChcIiNUUG9wWUtvb3JkXCIpLFxyXG4gICAgICAgICRQb3BYS29vcmQgPSAkKFwiI1BvcFhLb29yZFwiKSxcclxuICAgICAgICAkUG9wWUtvb3JkID0gJChcIiNQb3BZS29vcmRcIik7XHJcblx0aWYgKCRiZW9iZmVsZGVyX0ZOU19YR0lTLnZhbCgpICYmICRiZW9iZmVsZGVyX0ZOU19ZR0lTLnZhbCgpKSB7XHJcblx0XHRVUkwgPSBcIi8vd3d3Lm1hcHMuemguY2gvP3g9XCIgKyAkYmVvYmZlbGRlcl9GTlNfWEdJUy52YWwoKSArIFwiJnk9XCIgKyAkYmVvYmZlbGRlcl9GTlNfWUdJUy52YWwoKSArIFwiJnNjYWxlPTMwMDAmbWFya2Vycz1yaW5nXCI7XHJcblx0XHR3aW5kb3cub3BlbihVUkwsIHRhcmdldD1cIl9ibGFua1wiKTtcclxuXHR9IGVsc2UgaWYgKCRiZW9iZmVsZGVyX0NPT1JET05ORUVfRkVEX0UudmFsKCkgJiYgJGJlb2JmZWxkZXJfQ09PUkRPTk5FRV9GRURfTi52YWwoKSkge1xyXG5cdFx0VVJMID0gXCIvL3d3dy5tYXBzLnpoLmNoLz94PVwiICsgJGJlb2JmZWxkZXJfQ09PUkRPTk5FRV9GRURfRS52YWwoKSArIFwiJnk9XCIgKyAkYmVvYmZlbGRlcl9DT09SRE9OTkVFX0ZFRF9OLnZhbCgpICsgXCImc2NhbGU9MzAwMCZtYXJrZXJzPXJpbmdcIjtcclxuXHRcdHdpbmRvdy5vcGVuKFVSTCwgdGFyZ2V0PVwiX2JsYW5rXCIpO1xyXG5cdH0gZWxzZSBpZiAoJFRQb3BYS29vcmQudmFsKCkgJiYgJFRQb3BZS29vcmQudmFsKCkpIHtcclxuXHRcdFVSTCA9IFwiLy93d3cubWFwcy56aC5jaC8/eD1cIiArICRUUG9wWEtvb3JkLnZhbCgpICsgXCImeT1cIiArICRUUG9wWUtvb3JkLnZhbCgpICsgXCImc2NhbGU9MzAwMCZtYXJrZXJzPXJpbmdcIjtcclxuXHRcdHdpbmRvdy5vcGVuKFVSTCwgdGFyZ2V0PVwiX2JsYW5rXCIpO1xyXG5cdH0gZWxzZSBpZiAoJFBvcFhLb29yZC52YWwoKSAmJiAkUG9wWUtvb3JkLnZhbCgpKSB7XHJcblx0XHRVUkwgPSBcIi8vd3d3Lm1hcHMuemguY2gvP3g9XCIgKyAkUG9wWEtvb3JkLnZhbCgpICsgXCImeT1cIiArICRQb3BZS29vcmQudmFsKCkgKyBcIiZzY2FsZT0zMDAwJm1hcmtlcnM9cmluZ1wiO1xyXG5cdFx0d2luZG93Lm9wZW4oVVJMLCB0YXJnZXQ9XCJfYmxhbmtcIik7XHJcblx0fSBlbHNlIHtcclxuXHRcdHdpbmRvdy5hcGYubWVsZGUoXCJGZWhsZXI6IEtlaW5lIEtvb3JkaW5hdGVuIHp1bSBBbnplaWdlblwiLCBcIkFrdGlvbiBhYmdlYnJvY2hlblwiKTtcclxuXHR9XHJcbn07XHJcblxyXG4vLyByZXRvdXJuaWVydCBkaWUgQmVzY2hyaWZ0dW5nIGbDvHIgVFBvcCBhdWYgS2FydGVuXHJcbi8vIFdlbm4gVFBvcCBtaXQgaWhyZXIgTnVtbWVyIGJlc2NocmlmdGV0IHNlaW4gc29sbGVuXHJcbi8vIHRwb3BfbnIgdW5kIHBvcF9uciB3aXJkIMO8YmVybm9tbWVuXHJcbndpbmRvdy5hcGYuYmVzY2hyaWZ0ZVRQb3BNaXROckbDvHJLYXJ0ZSA9IGZ1bmN0aW9uKHBvcF9uciwgdHBvcF9ucikge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgdHBvcF9iZXNjaHJpZnR1bmc7XHJcblx0cG9wX25yID0gcG9wX25yIHx8IFwiP1wiO1xyXG5cdGlmICh0cG9wX25yKSB7XHJcblx0XHR0cG9wX2Jlc2NocmlmdHVuZyA9IHBvcF9uciArIFwiL1wiICsgdHBvcF9ucjtcclxuXHR9IGVsc2Uge1xyXG5cdFx0dHBvcF9iZXNjaHJpZnR1bmcgPSBwb3BfbnIgKyBcIi8/XCI7XHJcblx0fVxyXG5cdHJldHVybiB0cG9wX2Jlc2NocmlmdHVuZztcclxufTtcclxuXHJcbi8vw7ZmZm5ldCBlaW4gbW9kYWwgdW5kIHRlaWx0IGV0d2FzIG1pdFxyXG53aW5kb3cuYXBmLm1lbGRlID0gZnVuY3Rpb24obWVsZHVuZywgdGl0bGUpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcbiAgICB2YXIgdGl0bGUgPSB0aXRsZSB8fCAnICc7XHJcblx0JChcIiNNZWxkdW5nXCIpXHJcblx0XHQuaHRtbChtZWxkdW5nKVxyXG4gICAgICAgIC5hdHRyKCd0aXRsZScsIHRpdGxlKVxyXG5cdFx0LmRpYWxvZyh7XHJcblx0XHRcdG1vZGFsOiB0cnVlLFxyXG5cdFx0XHRidXR0b25zOiB7XHJcblx0XHRcdFx0T2s6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0JCh0aGlzKS5kaWFsb2coXCJjbG9zZVwiKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG59O1xyXG5cclxuLy8gemVpZ3Qgd8OkaHJlbmQgMjUgU2VrdW5kZW4gZWluZW4gSGlud2VpcyBhbiB1bmQgZWluZW4gTGluaywgbWl0IGRlbSBlaW5lIEFrdGlvbiByw7xja2fDpG5naWcgZ2VtYWNodCB3ZXJkZW4ga2FublxyXG4vLyBlcndhcnRldCBkaWUgTWl0dGVpbHVuZywgd2FzIHBhc3NpZXJ0IGlzdFxyXG53aW5kb3cuYXBmLmZyYWdlT2JBa3Rpb25Sw7xja2fDpG5naWdHZW1hY2h0V2VyZGVuU29sbCA9IGZ1bmN0aW9uKHdhc0lzdFBhc3NpZXJ0KSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIEhpbndlaXMgenVtIHLDvGNrZ8OkbmdpZyBtYWNoZW4gYW56ZWlnZW5cclxuXHQkKFwiI3VuZGVsZXRlX2RpdlwiKS5odG1sKHdhc0lzdFBhc3NpZXJ0ICsgXCIgPGEgaHJlZj0nIycgaWQ9J3VuZGVsZXRlJz5Sw7xja2fDpG5naWcgbWFjaGVuPzwvYT5cIik7XHJcblx0JChcIi51bmRlbGV0ZVwiKS5zaG93KCk7XHJcblx0aWYgKCQoIHdpbmRvdyApLndpZHRoKCkgPiAxMDAwKSB7XHJcblx0XHQkKFwiI2Zvcm1zXCIpLmNzcyhcInRvcFwiLCBcIjM3cHhcIik7XHJcblx0fVxyXG5cdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcblx0XHQkKFwiI3VuZGVsZXRlX2RpdlwiKS5odG1sKFwiXCIpO1xyXG5cdFx0JChcIi51bmRlbGV0ZVwiKS5oaWRlKCk7XHJcblx0XHQkKFwiI2Zvcm1zXCIpLmNzcyhcInRvcFwiLCBcIlwiKTtcclxuXHR9LCAzMDAwMCk7XHJcbn07XHJcblxyXG5cclxuLy8gQmF1dCBlaW5lbiBuZXVlbiBLbm90ZW4gYXVmIGRlcnNlbGJlbiBIaWVyYXJjaGllc3R1ZmUsIHZvbiB3ZWxjaGVyIGRlciBCZWZlaGwgYXVmZ2VydWZlbiB3dXJkZVxyXG53aW5kb3cuYXBmLmluc2VydE5ldWVuTm9kZUF1ZkdsZWljaGVySGllcmFyY2hpZXN0dWZlID0gZnVuY3Rpb24oYWt0aXZlcl9ub2RlLCBwYXJlbnRfbm9kZSwgc3RydWt0dXJ0eXAsIGRzX2lkLCBiZXNjaHJpZnR1bmcpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIE5ldWVyTm9kZTtcclxuXHQvLyBpZCBnbG9iYWwgdmVyZsO8Z2JhciBtYWNoZW5cclxuXHRsb2NhbFN0b3JhZ2Vbc3RydWt0dXJ0eXAgKyBcIl9pZFwiXSA9IGRzX2lkO1xyXG5cdC8vIGxldHp0ZSBnbG9iYWxlIFZhcmlhYmxlIGVudGZlcm5lblxyXG5cdGRlbGV0ZSB3aW5kb3cuYXBmW3N0cnVrdHVydHlwXTtcclxuXHQvLyBuZXVlbiBOb2RlIGJhdWVuXHJcblx0TmV1ZXJOb2RlID0gJC5qc3RyZWUuX3JlZmVyZW5jZShwYXJlbnRfbm9kZSkuY3JlYXRlX25vZGUocGFyZW50X25vZGUsIFwibGFzdFwiLCB7XHJcblx0XHRcImRhdGFcIjogYmVzY2hyaWZ0dW5nLFxyXG5cdFx0XCJhdHRyXCI6IHtcclxuXHRcdFx0XCJpZFwiOiBkc19pZCxcclxuXHRcdFx0XCJ0eXBcIjogc3RydWt0dXJ0eXBcclxuXHRcdH1cclxuXHR9KTtcclxuXHQvLyBhbGxmw6RsbGlnZSBVbnRlcm9yZG5lciBhbmxlZ2VuXHJcblx0aWYgKHN0cnVrdHVydHlwID09PSBcInBvcFwiKSB7XHJcblx0XHR3aW5kb3cuYXBmLmluc2VydE9yZG5lclZvblBvcChOZXVlck5vZGUsIGRzX2lkKTtcclxuXHR9XHJcblx0aWYgKHN0cnVrdHVydHlwID09PSBcInRwb3BcIikge1xyXG5cdFx0d2luZG93LmFwZi5pbnNlcnRPcmRuZXJWb25UUG9wKE5ldWVyTm9kZSwgZHNfaWQpO1xyXG5cdH1cclxuXHRpZiAoc3RydWt0dXJ0eXAgPT09IFwiYXB6aWVsXCIpIHtcclxuXHRcdCQuanN0cmVlLl9yZWZlcmVuY2UoTmV1ZXJOb2RlKS5jcmVhdGVfbm9kZShOZXVlck5vZGUsIFwibGFzdFwiLCB7XHJcblx0XHRcdFwiZGF0YVwiOiBcIjAgWmllbC1CZXJpY2h0ZVwiLFxyXG5cdFx0XHRcImF0dHJcIjoge1xyXG5cdFx0XHRcdFwiaWRcIjogZHNfaWQsXHJcblx0XHRcdFx0XCJ0eXBcIjogXCJ6aWVsYmVyX29yZG5lclwiXHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0Ly8gUGFyZW50IE5vZGUtQmVzY2hyaWZ0dW5nOiBBbnphaGwgYW5wYXNzZW5cclxuXHRpZiAoc3RydWt0dXJ0eXAgPT09IFwiYXB6aWVsXCIpIHtcclxuXHRcdHZhciBncmFuZHBhcmVudF9ub2RlID0gJC5qc3RyZWUuX3JlZmVyZW5jZShwYXJlbnRfbm9kZSkuX2dldF9wYXJlbnQocGFyZW50X25vZGUpO1xyXG5cdFx0Ly8gZ3JhbmRwYXJlbnQgTm9kZS1CZXNjaHJpZnR1bmc6IEFuemFobCBhbnBhc3NlblxyXG5cdFx0d2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl9hcHppZWwoZ3JhbmRwYXJlbnRfbm9kZSk7XHJcblx0XHQvLyBwYXJlbnQgTm9kZS1CZXNjaHJpZnR1bmc6IEFuemFobCBhbnBhc3NlblxyXG5cdFx0Ly8gbnVyLCB3ZW5uIGVzIG5pY2h0IGRlciBPcmRuZXIgaXN0LCBkZXIgXCJuZXVlIEFQLVppZWxlXCIgaGVpc3N0XHJcblx0XHRpZiAoJC5qc3RyZWUuX3JlZmVyZW5jZShwYXJlbnRfbm9kZSkuZ2V0X3RleHQocGFyZW50X25vZGUpICE9PSBcIm5ldWUgQVAtWmllbGVcIikge1xyXG5cdFx0XHR3aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX2FwemllbGphaHIocGFyZW50X25vZGUpO1xyXG5cdFx0fVxyXG5cdH0gZWxzZSB7XHJcblx0XHQvLyBOb3JtYWxmYWxsXHJcblx0XHR3aW5kb3cuYXBmW1wiYmVzY2hyaWZ0ZV9vcmRuZXJfXCIrc3RydWt0dXJ0eXBdKHBhcmVudF9ub2RlKTtcclxuXHR9XHJcblx0XHJcblx0Ly8gbm9kZSBzZWxlY3RlblxyXG5cdCQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5kZXNlbGVjdF9hbGwoKTtcclxuXHQkLmpzdHJlZS5fcmVmZXJlbmNlKE5ldWVyTm9kZSkuc2VsZWN0X25vZGUoTmV1ZXJOb2RlKTtcclxuXHQvLyBGb3JtdWxhciBpbml0aWllcmVuXHJcblx0aWYgKHN0cnVrdHVydHlwID09PSBcInRwb3BmcmVpd2tvbnRyXCIpIHtcclxuXHRcdC8vIGRlciBJbml0aWllcnVuZyBtaXR0ZWlsZW4sIGRhc3MgZXMgZWluZSBGcmVpd2lsbGlnZW5rb250cm9sbGUgaXN0IHVuZCBrZWluZSBGZWxka29udHJvbGxlXHJcblx0XHRsb2NhbFN0b3JhZ2UudHBvcGZyZWl3a29udHIgPSB0cnVlO1xyXG5cdFx0Ly8gRnJlaXdpbGxpZ2VuLUtvbnRyb2xsZW4gd2VyZGVuIHZvbiBkZXJzZWxiZW4gRnVua3Rpb24gaW5pdGlpZXJ0LCB3aWUgRmVsZGtvbnRyb2xsZW5cclxuXHRcdHdpbmRvdy5hcGZbXCJpbml0aWllcmVfdHBvcGZlbGRrb250clwiXSgpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHR3aW5kb3cuYXBmW1wiaW5pdGlpZXJlX1wiK3N0cnVrdHVydHlwXSgpO1xyXG5cdH1cclxufTtcclxuXHJcbi8vIEJhdXQgZWluZW4gbmV1ZW4gS25vdGVuIGF1ZiBkZXIgbsOkY3NodHRpZWZlcmVuIEhpZXJhcmNoaWVzdHVmZSwgYWxzIGRlciBCZWZlaGwgYXVmZ2VydWZlbiB3dXJkZVxyXG4vLyBwYXJlbnRfbm9kZSB3aXJkIG51ciB2b24gU3RydWt0dXJ0eXAgYXB6aWVsIGJlbnV0enRcclxud2luZG93LmFwZi5pbnNlcnROZXVlbk5vZGVFaW5lSGllcmFyY2hpZXN0dWZlVGllZmVyID0gZnVuY3Rpb24oYWt0aXZlcl9ub2RlLCBwYXJlbnRfbm9kZSwgc3RydWt0dXJ0eXAsIGRzX2lkLCBiZXNjaHJpZnR1bmcpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIE5ldWVyTm9kZTtcclxuXHQvLyBpZCBnbG9iYWwgdmVyZsO8Z2JhciBtYWNoZW5cclxuXHRsb2NhbFN0b3JhZ2Vbc3RydWt0dXJ0eXAgKyBcIl9pZFwiXSA9IGRzX2lkO1xyXG5cdC8vIGxldHp0ZSBnbG9iYWxlIFZhcmlhYmxlIGVudGZlcm5lblxyXG5cdGRlbGV0ZSB3aW5kb3cuYXBmW3N0cnVrdHVydHlwXTtcclxuXHRpZiAoc3RydWt0dXJ0eXAgPT09IFwiYXB6aWVsXCIgJiYgbG9jYWxTdG9yYWdlLmFwemllbF92b25fb3JkbmVyX2FwemllbCkge1xyXG5cdFx0Ly8gbG9jYWxTdG9yYWdlLmFwemllbF92b25fb3JkbmVyX2FwemllbCBzYWd0OiBhcHppZWwgd2lyZCB2b20gb3JkbmVyX2FwemllbCBhdXMgYW5nZWxlZ3QgPiB0ZW1wb3LDpHJlbiBVbnRlcm9yZG5lciBhbmxlZ2VuXHJcblx0XHR2YXIgbmV1ZV9hcHppZWxlX25vZGUgPSAkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkuY3JlYXRlX25vZGUoYWt0aXZlcl9ub2RlLCBcImxhc3RcIiwge1xyXG5cdFx0XHRcImRhdGFcIjogXCJuZXVlIEFQLVppZWxlXCIsXHJcblx0XHRcdFwiYXR0clwiOiB7XHJcblx0XHRcdFx0XCJpZFwiOiB3aW5kb3cuYXBmLmVyc3RlbGxlSWRBdXNEb21BdHRyaWJ1dElkKCQoYWt0aXZlcl9ub2RlKS5hdHRyKFwiaWRcIikpLFxyXG5cdFx0XHRcdFwidHlwXCI6IFwiYXB6aWVsamFoclwiXHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0Ly8gZGFydW50ZXIgbmV1ZW4gTm9kZSBiYXVlblxyXG5cdFx0TmV1ZXJOb2RlID0gJC5qc3RyZWUuX3JlZmVyZW5jZShuZXVlX2FwemllbGVfbm9kZSkuY3JlYXRlX25vZGUobmV1ZV9hcHppZWxlX25vZGUsIFwibGFzdFwiLCB7XHJcblx0XHRcdFwiZGF0YVwiOiBiZXNjaHJpZnR1bmcsXHJcblx0XHRcdFwiYXR0clwiOiB7XHJcblx0XHRcdFx0XCJpZFwiOiBkc19pZCxcclxuXHRcdFx0XHRcInR5cFwiOiBzdHJ1a3R1cnR5cFxyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRcdGRlbGV0ZSBsb2NhbFN0b3JhZ2UuYXB6aWVsX3Zvbl9vcmRuZXJfYXB6aWVsO1xyXG5cdH0gZWxzZSB7XHJcblx0XHQvLyBOb3JtYWxmYWxsXHJcblx0XHQvLyBuZXVlbiBOb2RlIGJhdWVuXHJcblx0XHROZXVlck5vZGUgPSAkLmpzdHJlZS5fcmVmZXJlbmNlKGFrdGl2ZXJfbm9kZSkuY3JlYXRlX25vZGUoYWt0aXZlcl9ub2RlLCBcImxhc3RcIiwge1xyXG5cdFx0XHRcImRhdGFcIjogYmVzY2hyaWZ0dW5nLFxyXG5cdFx0XHRcImF0dHJcIjoge1xyXG5cdFx0XHRcdFwiaWRcIjogZHNfaWQsXHJcblx0XHRcdFx0XCJ0eXBcIjogc3RydWt0dXJ0eXBcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG5cdC8vIGFsbGbDpGxsaWdlIFVudGVyb3JkbmVyIGFubGVnZW5cclxuXHRpZiAoc3RydWt0dXJ0eXAgPT09IFwicG9wXCIpIHtcclxuXHRcdHdpbmRvdy5hcGYuaW5zZXJ0T3JkbmVyVm9uUG9wKE5ldWVyTm9kZSwgZHNfaWQpO1xyXG5cdH1cclxuXHRpZiAoc3RydWt0dXJ0eXAgPT09IFwidHBvcFwiKSB7XHJcblx0XHR3aW5kb3cuYXBmLmluc2VydE9yZG5lclZvblRQb3AoTmV1ZXJOb2RlLCBkc19pZCk7XHJcblx0fVxyXG5cdGlmIChzdHJ1a3R1cnR5cCA9PT0gXCJhcHppZWxcIikge1xyXG5cdFx0JC5qc3RyZWUuX3JlZmVyZW5jZShOZXVlck5vZGUpLmNyZWF0ZV9ub2RlKE5ldWVyTm9kZSwgXCJsYXN0XCIsIHtcclxuXHRcdFx0XCJkYXRhXCI6IFwiMCBaaWVsLUJlcmljaHRlXCIsXHJcblx0XHRcdFwiYXR0clwiOiB7XHJcblx0XHRcdFx0XCJpZFwiOiBkc19pZCxcclxuXHRcdFx0XHRcInR5cFwiOiBcInppZWxiZXJfb3JkbmVyXCJcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHQvLyBpbSBjcmVhdGVfbm9kZS1FdmVudCB2b24ganN0cmVlIHdpcmQgSmFociBlaW5nZWbDvGd0IHVuZCBnZXNwZWljaGVydFxyXG5cdH1cclxuXHQvLyBOb2RlLUJlc2NocmlmdHVuZzogQW56YWhsIGFucGFzc2VuXHJcblx0aWYgKHN0cnVrdHVydHlwID09PSBcImFwemllbFwiICYmIGxvY2FsU3RvcmFnZS5hcHppZWxfdm9uX2FwemllbGphaHIpIHtcclxuXHRcdC8vIGhpZXIgaXN0IGVpbiBPcmRuZXIgendpc2NoZW5nZXNjaGFsdGV0XHJcblx0XHQvLyBQYXJlbnQgTm9kZS1CZXNjaHJpZnR1bmc6IEFuemFobCBhbnBhc3Nlbiwgd2VubnMgbmljaHQgZGVyIG5ldWUgT3JkbmVyIGlzdFxyXG5cdFx0aWYgKCQuanN0cmVlLl9yZWZlcmVuY2UocGFyZW50X25vZGUpLmdldF90ZXh0KHBhcmVudF9ub2RlKSAhPT0gXCJuZXVlIEFQLVppZWxlXCIpIHtcclxuXHRcdFx0d2luZG93LmFwZi5iZXNjaHJpZnRlX29yZG5lcl9hcHppZWwocGFyZW50X25vZGUpO1xyXG5cdFx0fVxyXG5cdFx0Ly8gYWt0aXZlciBOb2RlLUJlc2NocmlmdHVuZzogQW56YWhsIGFucGFzc2VuXHJcblx0XHR3aW5kb3cuYXBmLmJlc2NocmlmdGVfb3JkbmVyX2FwemllbGphaHIoYWt0aXZlcl9ub2RlKTtcclxuXHRcdGRlbGV0ZSBsb2NhbFN0b3JhZ2UuYXB6aWVsX3Zvbl9hcHppZWxqYWhyO1xyXG5cdH0gZWxzZSBpZiAoc3RydWt0dXJ0eXAgIT09IFwiamJlcl91ZWJlcnNpY2h0XCIpIHtcclxuXHRcdHdpbmRvdy5hcGZbXCJiZXNjaHJpZnRlX29yZG5lcl9cIitzdHJ1a3R1cnR5cF0oYWt0aXZlcl9ub2RlKTtcclxuXHR9XHJcblx0Ly8gbm9kZSBzZWxlY3RlblxyXG5cdCQuanN0cmVlLl9yZWZlcmVuY2UoYWt0aXZlcl9ub2RlKS5kZXNlbGVjdF9hbGwoKTtcclxuXHQkLmpzdHJlZS5fcmVmZXJlbmNlKE5ldWVyTm9kZSkuc2VsZWN0X25vZGUoTmV1ZXJOb2RlKTtcclxuXHQvLyBGb3JtdWxhciBpbml0aWllcmVuXHJcblx0aWYgKHN0cnVrdHVydHlwID09PSBcInRwb3BmcmVpd2tvbnRyXCIpIHtcclxuXHRcdC8vIGRlciBJbml0aWllcnVuZyBtaXR0ZWlsZW4sIGRhc3MgZXMgZWluZSBGcmVpd2lsbGlnZW5rb250cm9sbGUgaXN0IHVuZCBrZWluZSBGZWxka29udHJvbGxlXHJcblx0XHRsb2NhbFN0b3JhZ2UudHBvcGZyZWl3a29udHIgPSB0cnVlO1xyXG5cdFx0Ly8gRnJlaXdpbGxpZ2VuLUtvbnRyb2xsZW4gd2VyZGVuIHZvbiBkZXJzZWxiZW4gRnVua3Rpb24gaW5pdGlpZXJ0LCB3aWUgRmVsZGtvbnRyb2xsZW5cclxuXHRcdHdpbmRvdy5hcGZbXCJpbml0aWllcmVfdHBvcGZlbGRrb250clwiXSgpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHR3aW5kb3cuYXBmW1wiaW5pdGlpZXJlX1wiK3N0cnVrdHVydHlwXSgpO1xyXG5cdH1cclxufTtcclxuXHJcbi8vIGVyc3RlbGx0IGFsbGUgVW50ZXJvcmRuZXIgZGVzIE9yZG5lcnMgdm9tIFR5cCBwb3BcclxuLy8gZXJ3YXJ0ZXQgZGVuIG5vZGUgZGVzIHBvcC1vcmRuZXJzXHJcbndpbmRvdy5hcGYuaW5zZXJ0T3JkbmVyVm9uUG9wID0gZnVuY3Rpb24ocG9wX25vZGUsIHBvcF9pZCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQkLmpzdHJlZS5fcmVmZXJlbmNlKHBvcF9ub2RlKS5jcmVhdGVfbm9kZShwb3Bfbm9kZSwgXCJsYXN0XCIsIHtcclxuXHRcdFwiZGF0YVwiOiBcIlRlaWxwb3B1bGF0aW9uZW5cIixcclxuXHRcdFwiYXR0clwiOiB7XHJcblx0XHRcdFwiaWRcIjogcG9wX2lkLFxyXG5cdFx0XHRcInR5cFwiOiBcInBvcF9vcmRuZXJfdHBvcFwiXHJcblx0XHR9XHJcblx0fSk7XHJcblx0JC5qc3RyZWUuX3JlZmVyZW5jZShwb3Bfbm9kZSkuY3JlYXRlX25vZGUocG9wX25vZGUsIFwibGFzdFwiLCB7XHJcblx0XHRcImRhdGFcIjogXCJQb3B1bGF0aW9ucy1CZXJpY2h0ZVwiLFxyXG5cdFx0XCJhdHRyXCI6IHtcclxuXHRcdFx0XCJpZFwiOiBwb3BfaWQsXHJcblx0XHRcdFwidHlwXCI6IFwicG9wX29yZG5lcl9wb3BiZXJcIlxyXG5cdFx0fVxyXG5cdH0pO1xyXG5cdCQuanN0cmVlLl9yZWZlcmVuY2UocG9wX25vZGUpLmNyZWF0ZV9ub2RlKHBvcF9ub2RlLCBcImxhc3RcIiwge1xyXG5cdFx0XCJkYXRhXCI6IFwiTWFzc25haG1lbi1CZXJpY2h0ZVwiLFxyXG5cdFx0XCJhdHRyXCI6IHtcclxuXHRcdFx0XCJpZFwiOiBwb3BfaWQsXHJcblx0XHRcdFwidHlwXCI6IFwicG9wX29yZG5lcl9tYXNzbmJlclwiXHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG4vLyBlcnN0ZWxsdCBhbGxlIFVudGVyb3JkbmVyIGRlcyBPcmRuZXJzIHZvbSBUeXAgdHBvcFxyXG4vLyBlcndhcnRldCBkZW4gbm9kZSBkZXMgdHBvcC1vcmRuZXJzXHJcbndpbmRvdy5hcGYuaW5zZXJ0T3JkbmVyVm9uVFBvcCA9IGZ1bmN0aW9uKFRQb3BOb2RlLCB0cG9wX2lkKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdCQuanN0cmVlLl9yZWZlcmVuY2UoVFBvcE5vZGUpLmNyZWF0ZV9ub2RlKFRQb3BOb2RlLCBcImxhc3RcIiwge1xyXG5cdFx0XCJkYXRhXCI6IFwiTWFzc25haG1lblwiLFxyXG5cdFx0XCJhdHRyXCI6IHtcclxuXHRcdFx0XCJpZFwiOiB0cG9wX2lkLFxyXG5cdFx0XHRcInR5cFwiOiBcInRwb3Bfb3JkbmVyX21hc3NuXCJcclxuXHRcdH1cclxuXHR9KTtcclxuXHQkLmpzdHJlZS5fcmVmZXJlbmNlKFRQb3BOb2RlKS5jcmVhdGVfbm9kZShUUG9wTm9kZSwgXCJsYXN0XCIsIHtcclxuXHRcdFwiZGF0YVwiOiBcIk1hc3NuYWhtZW4tQmVyaWNodGVcIixcclxuXHRcdFwiYXR0clwiOiB7XHJcblx0XHRcdFwiaWRcIjogdHBvcF9pZCxcclxuXHRcdFx0XCJ0eXBcIjogXCJ0cG9wX29yZG5lcl9tYXNzbmJlclwiXHJcblx0XHR9XHJcblx0fSk7XHJcblx0JC5qc3RyZWUuX3JlZmVyZW5jZShUUG9wTm9kZSkuY3JlYXRlX25vZGUoVFBvcE5vZGUsIFwibGFzdFwiLCB7XHJcblx0XHRcImRhdGFcIjogXCJGZWxka29udHJvbGxlblwiLFxyXG5cdFx0XCJhdHRyXCI6IHtcclxuXHRcdFx0XCJpZFwiOiB0cG9wX2lkLFxyXG5cdFx0XHRcInR5cFwiOiBcInRwb3Bfb3JkbmVyX2ZlbGRrb250clwiXHJcblx0XHR9XHJcblx0fSk7XHJcblx0JC5qc3RyZWUuX3JlZmVyZW5jZShUUG9wTm9kZSkuY3JlYXRlX25vZGUoVFBvcE5vZGUsIFwibGFzdFwiLCB7XHJcblx0XHRcImRhdGFcIjogXCJGcmVpd2lsbGlnZW4tS29udHJvbGxlblwiLFxyXG5cdFx0XCJhdHRyXCI6IHtcclxuXHRcdFx0XCJpZFwiOiB0cG9wX2lkLFxyXG5cdFx0XHRcInR5cFwiOiBcInRwb3Bfb3JkbmVyX2ZyZWl3a29udHJcIlxyXG5cdFx0fVxyXG5cdH0pO1xyXG5cdCQuanN0cmVlLl9yZWZlcmVuY2UoVFBvcE5vZGUpLmNyZWF0ZV9ub2RlKFRQb3BOb2RlLCBcImxhc3RcIiwge1xyXG5cdFx0XCJkYXRhXCI6IFwiVGVpbHBvcHVsYXRpb25zLUJlcmljaHRlXCIsXHJcblx0XHRcImF0dHJcIjoge1xyXG5cdFx0XHRcImlkXCI6IHRwb3BfaWQsXHJcblx0XHRcdFwidHlwXCI6IFwidHBvcF9vcmRuZXJfdHBvcGJlclwiXHJcblx0XHR9XHJcblx0fSk7XHJcblx0JC5qc3RyZWUuX3JlZmVyZW5jZShUUG9wTm9kZSkuY3JlYXRlX25vZGUoVFBvcE5vZGUsIFwibGFzdFwiLCB7XHJcblx0XHRcImRhdGFcIjogXCJCZW9iYWNodHVuZ2VuXCIsXHJcblx0XHRcImF0dHJcIjoge1xyXG5cdFx0XHRcImlkXCI6IHRwb3BfaWQsXHJcblx0XHRcdFwidHlwXCI6IFwidHBvcF9vcmRuZXJfYmVvYl96dWdlb3JkbmV0XCJcclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbndpbmRvdy5hcGYubMO2c2NoZUFwID0gZnVuY3Rpb24oYXBfaWQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly9WYXJpYWJsZSB6dW0gcsO8Y2tnw6RuZ2lnIG1hY2hlbiBlcnN0ZWxsZW5cclxuXHR3aW5kb3cuYXBmLmRlbGV0ZWQgPSB3aW5kb3cuYXBmO1xyXG5cdHdpbmRvdy5hcGYuZGVsZXRlZC50eXAgPSBcImFwXCI7XHJcblx0Ly9BcnRuYW1lIGluIFRleHRmb3JtIG1lcmtlblxyXG5cdHdpbmRvdy5hcGYuZGVsZXRlZC5BcnRuYW1lID0gJChcIiNhcF93YWVobGVuIG9wdGlvblt2YWx1ZT0nXCIgKyAkKFwiI2FwX3dhZWhsZW5cIikudmFsKCkgKyBcIiddXCIpLnRleHQoKTtcclxuXHR2YXIgZGVsZXRlQXAgPSAkLmFqYXgoe1xyXG5cdFx0dHlwZTogJ3Bvc3QnLFxyXG5cdFx0dXJsOiAncGhwL2FwX2RlbGV0ZS5waHAnLFxyXG5cdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdGRhdGE6IHtcclxuXHRcdFx0XCJpZFwiOiBhcF9pZFxyXG5cdFx0fVxyXG5cdH0pO1xyXG5cdGRlbGV0ZUFwLmFsd2F5cyhmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgJGV4cG9ydGllcmVuXzIgPSAkKFwiI2V4cG9ydGllcmVuXzJcIik7XHJcblx0XHRkZWxldGUgbG9jYWxTdG9yYWdlLmFwX2lkO1xyXG5cdFx0ZGVsZXRlIHdpbmRvdy5hcGYuYXA7XHJcblx0XHRkZWxldGUgbG9jYWxTdG9yYWdlLmFwO1xyXG5cdFx0JChcIiNwcm9ncmFtbV9uZXVcIikuYXR0cihcImNoZWNrZWRcIiwgZmFsc2UpO1xyXG5cdFx0JChcIiNwcm9ncmFtbV9hbGxlXCIpLmF0dHIoXCJjaGVja2VkXCIsIHRydWUpO1xyXG5cdFx0JChcIiNwcm9ncmFtbV93YWhsXCIpLmJ1dHRvbnNldCgpO1xyXG5cdFx0d2luZG93LmFwZi5lcnN0ZWxsZV9hcF9saXN0ZShcInByb2dyYW1tX2FsbGVcIik7XHJcblx0XHQkKCcjYXBfd2FlaGxlbicpLnZhbCgnJyk7XHJcblx0XHQkKFwiI2FwX3dhZWhsZW5fbGFiZWxcIikuaHRtbChcIkFydGbDtnJkZXJwcm9ncmFtbSB3w6RobGVuOlwiKS5zaG93KCk7XHJcblx0XHQkKFwiI3RyZWVcIikuaGlkZSgpO1xyXG5cdFx0JChcIiNzdWNoZW5cIikuaGlkZSgpO1xyXG5cdFx0JGV4cG9ydGllcmVuXzIuaGlkZSgpO1xyXG5cdFx0JChcIiNoaWxmZVwiKS5oaWRlKCk7XHJcblx0XHQkKFwiI2FwX2xvZXNjaGVuXCIpLmhpZGUoKTtcclxuXHRcdCRleHBvcnRpZXJlbl8yLnNob3coKTtcclxuXHRcdCQoXCIjYXBcIikuaGlkZSgpO1xyXG5cdFx0JChcIiNmb3Jtc1wiKS5oaWRlKCk7XHJcblx0XHQvL0hpbndlaXMgenVtIHLDvGNrZ8OkbmdpZyBtYWNoZW4gYW56ZWlnZW5cclxuXHRcdHdpbmRvdy5hcGYuZnJhZ2VPYkFrdGlvblLDvGNrZ8OkbmdpZ0dlbWFjaHRXZXJkZW5Tb2xsKFwiRGFzIFByb2dyYW1tIGRlciBBcnQgJ1wiICsgd2luZG93LmFwZi5kZWxldGVkLkFydG5hbWUgKyBcIicgd3VyZGUgZ2Vsw7ZzY2h0LlwiKTtcclxuXHRcdC8vQXJ0bmFtZSB3aXJkIG5pY2h0IG1laHIgZ2VicmF1Y2h0IHVuZCBzb2xsIHNww6R0ZXIgbmljaHQgaW4gRGF0ZW5zYXR6IGVpbmdlZsO8Z3Qgd2VyZGVuXHJcblx0XHRkZWxldGUgd2luZG93LmFwZi5kZWxldGVkLkFydG5hbWU7XHJcblx0XHQvL2Zvcm1zIG11c3MgZWluZ2VibGVuZGV0IHNlaW4sIHdlaWwgdW5kZWxldGVfZGl2IGRhcmluIGlzdFxyXG5cdFx0d2luZG93LmFwZi56ZWlnZUZvcm11bGFyKFwia2VpbmVzXCIpO1xyXG5cdH0pO1xyXG5cdGRlbGV0ZUFwLmZhaWwoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0Ly93aW5kb3cuYXBmLm1lbGRlKFwiRmVobGVyOiBEYXMgUHJvZ3JhbW0gd3VyZGUgbmljaHQgZ2Vsw7ZzY2h0XCIpO1xyXG5cdFx0Y29uc29sZS5sb2coJ0ZlaGxlcjogRGFzIFByb2dyYW1tIHd1cmRlIG5pY2h0IGdlbMO2c2NodCcpO1xyXG5cdH0pO1xyXG59O1xyXG5cclxuLy8gU3RlbGx0IGVpbmVuIERhdGVuc2F0eiBhdXMgd2luZG93LmFwZi5kZWxldGVkIHdpZWRlciBoZXJcclxuLypcclxuKiogVE9ET1xyXG4qKiBJZGVlOiAkLmRhdGEoKSBhdWYgI3VuZGVsZXRlIG51dHplblxyXG4qKiBpbiBlaW5lbiBTY2hsw7xzc2VsIFwidW5kZWxldGVcIiBlaW5lbiBBcnJheSB2b24gT2JqZWt0ZW4gdmVyc3RhdWVuXHJcbioqIGRhbm4ga8O2bm5lbiBBTExFIMOEbmRlcnVuZ2VuIHLDvGNrZ8OkbmdpZyBnZW1hY2h0IHdlcmRlbjpcclxuKiogRm9ybXVsYXIgemVpZ3QgSW5oYWx0IHZvbiAkKFwiI3VuZGVsZXRlXCIpLmRhdGEoXCJ1bmRlbGV0ZVwiKSBhblxyXG4qKiBqZWRlciBEYXRlbnNhdHogaGF0IFNjaGFsdGZsw6RjaGVcclxuKiogYmVpIEtsaWNrOiBKYSBuYWNoIFR5cCBkZXIgRGF0ZW4gV2llZGVyaGVyc3RlbGx1bmcgc3RhcnRlbiB1bmQgRXJmb2xnIG1lbGRlblxyXG4qL1xyXG53aW5kb3cuYXBmLnVuZGVsZXRlRGF0ZW5zYXR6ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciB0YWJlbGxlLFxyXG5cdFx0ZGF0YSA9IHt9LFxyXG5cdFx0dHlwLFxyXG5cdFx0aWQ7XHJcblx0XHJcblx0aWYgKCF3aW5kb3cuYXBmLmRlbGV0ZWQpIHtcclxuXHRcdHdpbmRvdy5hcGYubWVsZGUoXCJXaWVkZXJoZXJzdGVsbHVuZyBnZXNjaGVpdGVydFwiLCBcIkZlaGxlclwiKTtcclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9XHJcblx0XHJcblx0Ly9BcnRuYW1lIHd1cmRlIGbDvHIgZGllIEFuemVpZ2UgaW4gdW5kZWxldGVfZGl2IGdlc3BlaWNoZXJ0IC0gZW50ZmVybmVuLCBkYSBrZWluIEZlbGQgaW4gVGFiZWxsZVxyXG5cdGRlbGV0ZSB3aW5kb3cuYXBmLmRlbGV0ZWQuQXJ0bmFtZTtcclxuXHRcclxuXHQvLyB0YWJlbGxlIHNldHplblxyXG5cdHR5cCA9IHdpbmRvdy5hcGYuZGVsZXRlZC50eXA7XHJcblx0Ly8gdHlwIGdlaMO2cnQgbmljaHQgenVtIERhdGVuc2F0eiA+IGzDtnNjaGVuXHJcblx0ZGVsZXRlIHdpbmRvdy5hcGYuZGVsZXRlZC50eXA7XHJcblxyXG5cdHN3aXRjaCAodHlwKSB7XHJcblx0XHRjYXNlIFwiYXBcIjpcclxuXHRcdFx0dGFiZWxsZSA9IFwidGJsQWt0aW9uc3BsYW5cIjtcclxuXHRcdFx0aWQgPSB3aW5kb3cuYXBmLmRlbGV0ZWQuQXBBcnRJZDtcclxuXHRcdFx0Ly9BcnRuYW1lIHd1cmRlIGbDvHIgZGllIEFuemVpZ2UgaW4gdW5kZWxldGVfZGl2IGdlc3BlaWNoZXJ0IC0gZW50ZmVybmVuLCBkYSBrZWluIEZlbGQgaW4gVGFiZWxsZVxyXG5cdFx0XHRkZWxldGUgd2luZG93LmFwZi5kZWxldGVkLkFydG5hbWU7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0Y2FzZSBcImFwemllbFwiOlxyXG5cdFx0XHR0YWJlbGxlID0gXCJ0YmxaaWVsXCI7XHJcblx0XHRcdGlkID0gd2luZG93LmFwZi5kZWxldGVkLlppZWxJZDtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRjYXNlIFwiemllbGJlclwiOlxyXG5cdFx0XHR0YWJlbGxlID0gXCJ0YmxaaWVsQmVyaWNodFwiO1xyXG5cdFx0XHRpZCA9IHdpbmRvdy5hcGYuZGVsZXRlZC5aaWVsQmVySWQ7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0Y2FzZSBcImVyZmtyaXRcIjpcclxuXHRcdFx0dGFiZWxsZSA9IFwidGJsRXJmS3JpdFwiO1xyXG5cdFx0XHRpZCA9IHdpbmRvdy5hcGYuZGVsZXRlZC5FcmZrcml0SWQ7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0Y2FzZSBcInBvcFwiOlxyXG5cdFx0XHR0YWJlbGxlID0gXCJ0YmxQb3B1bGF0aW9uXCI7XHJcblx0XHRcdGlkID0gd2luZG93LmFwZi5kZWxldGVkLlBvcElkO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgXCJwb3BiZXJcIjpcclxuXHRcdFx0dGFiZWxsZSA9IFwidGJsUG9wQmVyaWNodFwiO1xyXG5cdFx0XHRpZCA9IHdpbmRvdy5hcGYuZGVsZXRlZC5Qb3BCZXJJZDtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRjYXNlIFwicG9wbWFzc25iZXJcIjpcclxuXHRcdFx0dGFiZWxsZSA9IFwidGJsUG9wTWFzc25CZXJpY2h0XCI7XHJcblx0XHRcdGlkID0gd2luZG93LmFwZi5kZWxldGVkLlBvcE1hc3NuQmVySWQ7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0Y2FzZSBcInRwb3BcIjpcclxuXHRcdFx0dGFiZWxsZSA9IFwidGJsVGVpbHBvcHVsYXRpb25cIjtcclxuXHRcdFx0aWQgPSB3aW5kb3cuYXBmLmRlbGV0ZWQuVFBvcElkO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgXCJ0cG9wbWFzc25cIjpcclxuXHRcdFx0dGFiZWxsZSA9IFwidGJsVGVpbFBvcE1hc3NuYWhtZVwiO1xyXG5cdFx0XHRpZCA9IHdpbmRvdy5hcGYuZGVsZXRlZC5UUG9wTWFzc25JZDtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRjYXNlIFwidHBvcG1hc3NuYmVyXCI6XHJcblx0XHRcdHRhYmVsbGUgPSBcInRibFRlaWxQb3BNYXNzbkJlcmljaHRcIjtcclxuXHRcdFx0aWQgPSB3aW5kb3cuYXBmLmRlbGV0ZWQuVFBvcE1hc3NuQmVySWQ7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0Y2FzZSBcInRwb3BiZXJcIjpcclxuXHRcdFx0dGFiZWxsZSA9IFwidGJsVGVpbFBvcEJlcmljaHRcIjtcclxuXHRcdFx0aWQgPSB3aW5kb3cuYXBmLmRlbGV0ZWQuVFBvcEJlcklkO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgXCJ0cG9wZmVsZGtvbnRyXCI6XHJcblx0XHRjYXNlIFwidHBvcGZyZWl3a29udHJcIjpcclxuXHRcdFx0dGFiZWxsZSA9IFwidGJsVGVpbFBvcEZlbGRrb250cm9sbGVcIjtcclxuXHRcdFx0aWQgPSB3aW5kb3cuYXBmLmRlbGV0ZWQuVFBvcEtvbnRySWQ7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0Y2FzZSBcImpiZXJcIjpcclxuXHRcdFx0dGFiZWxsZSA9IFwidGJsSkJlclwiO1xyXG5cdFx0XHRpZCA9IHdpbmRvdy5hcGYuZGVsZXRlZC5KQmVySWQ7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0Y2FzZSBcImpiZXJfdWViZXJzaWNodFwiOlxyXG5cdFx0XHR0YWJlbGxlID0gXCJ0YmxKQmVyVWViZXJzaWNodFwiO1xyXG5cdFx0XHRpZCA9IHdpbmRvdy5hcGYuZGVsZXRlZC5KYnVKYWhyO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgXCJiZXJcIjpcclxuXHRcdFx0dGFiZWxsZSA9IFwidGJsQmVyXCI7XHJcblx0XHRcdGlkID0gd2luZG93LmFwZi5kZWxldGVkLkJlcklkO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgXCJhc3NvemFydGVuXCI6XHJcblx0XHRcdHRhYmVsbGUgPSBcInRibEFzc296QXJ0ZW5cIjtcclxuXHRcdFx0aWQgPSB3aW5kb3cuYXBmLmRlbGV0ZWQuQWFJZDtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRkZWZhdWx0OlxyXG5cdFx0XHR3aW5kb3cuYXBmLm1lbGRlKFwiV2llZGVyaGVyc3RlbGx1bmcgZ2VzY2hlaXRlcnRcIiwgXCJGZWhsZXJcIik7XHJcblx0fVxyXG5cclxuXHQvLyB0YWJlbGxlIHdpcmQgaW4gcGhwIGJlbnV0enQsIHVtIHp1IHdpc3NlbiwgaW4gd2VsY2hlIFRhYmVsbGUgZGVyIERhdGVuc2F0eiBlaW5nZWbDvGd0IHdlcmRlbiBzb2xsXHJcblx0Ly8gd2lyZCBkYW5hY2ggYXVzIGRlbSBGZWxkZXJhcnJheSBlbnRmZXJudFxyXG5cdGRhdGEudGFiZWxsZSA9IHRhYmVsbGU7XHJcblxyXG5cdC8vIHdpbmRvdy5hcGYuZGVsZXRlZCBlbnRow6RsdCBhbGxlIEZlbGRuYW1lbiAtIHZpZWxlIGvDtm5uZW4gbGVlciBzZWluXHJcblx0Ly8gZGFoZXIgbnVyIHNvbGNoZSBtaXQgV2VydGVuIMO8YmVybmVobWVuXHJcbiAgICBfLmVhY2god2luZG93LmFwZi5kZWxldGVkLCBmdW5jdGlvbihmZWxkd2VydCwgZmVsZG5hbWUpIHtcclxuICAgICAgICBpZiAoZmVsZHdlcnQpIHtcclxuICAgICAgICAgICAgZGF0YVtmZWxkbmFtZV0gPSBmZWxkd2VydDtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcblx0Ly8gRGF0ZW5zYXR6IGhpbnp1ZsO8Z2VuXHJcblx0dmFyIGluc2VydE11bHRpcGxlID0gJC5hamF4KHtcclxuXHRcdHR5cGU6ICdwb3N0JyxcclxuXHRcdHVybDogJ3BocC9pbnNlcnRfbXVsdGlwbGUucGhwJyxcclxuXHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRkYXRhOiBkYXRhXHJcblx0fSk7XHJcblxyXG5cdGluc2VydE11bHRpcGxlLmFsd2F5cyhmdW5jdGlvbigpIHtcclxuXHRcdCQoXCIudW5kZWxldGVcIikuaGlkZSgpO1xyXG5cdFx0JChcIiNmb3Jtc1wiKS5jc3MoXCJ0b3BcIiwgXCJcIik7XHJcblx0XHQvLyBhcCBrYW5uIG5pY2h0IHZpYSBTdHJ1a3R1cmJhdW0gZ2V3w6RobHQgd2VyZGVuXHJcblx0XHRpZiAodHlwID09PSBcImFwXCIpIHtcclxuXHRcdFx0Ly9Gb3JtdWxhcmUgYXVzYmxlbmRlblxyXG5cdFx0XHR3aW5kb3cuYXBmLnplaWdlRm9ybXVsYXIoKTtcclxuXHRcdFx0Ly9uZXUgaW5pdGlpZXJlbiwgZGFtaXQgZGllIGdlbMO2c2NodGUgQXJ0IGdld8OkaGx0IHdlcmRlbiBrYW5uXHJcblx0XHRcdHdpbmRvdy5hcGYuaW5pdGlpZXJlX2luZGV4KCk7XHJcblx0XHRcdC8vIFRPRE86IERBUyBURVNURU5cclxuXHRcdFx0Ly8gRm9ybXVsYXJlIGJsZW5kZW5cclxuXHRcdFx0d2luZG93LmFwZi56ZWlnZUZvcm11bGFyKFwiYXBcIik7XHJcblx0XHRcdGhpc3RvcnkucmVwbGFjZVN0YXRlKHthcDogXCJhcFwifSwgXCJhcFwiLCBcImluZGV4Lmh0bWw/YXA9XCIgKyBpZCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHQvL3RyZWUgbmV1IGF1ZmJhdWVuXHJcblx0XHRcdCQud2hlbih3aW5kb3cuYXBmLmVyc3RlbGxlX3RyZWUod2luZG93LmFwZi5vbG1hcC5lcnN0ZWxsZVBvcExheWVyKSlcclxuXHRcdFx0XHQudGhlbihmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdCQoXCIjdHJlZVwiKS5qc3RyZWUoXCJzZWxlY3Rfbm9kZVwiLCBcIlt0eXA9J1wiICsgdHlwICsgXCInXSNcIiArIGlkKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdH1cclxuXHR9KTtcclxuXHJcblx0aW5zZXJ0TXVsdGlwbGUuZmFpbChmdW5jdGlvbigpIHtcclxuXHRcdC8vd2luZG93LmFwZi5tZWxkZShcIkZlaGxlcjogV2llZGVyaGVyc3RlbGx1bmcgZ2VzY2hlaXRlcnRcIik7XHJcblx0XHRjb25zb2xlLmxvZygnRmVobGVyOiBXaWVkZXJoZXJzdGVsbHVuZyBnZXNjaGVpdGVydCcpO1xyXG5cdH0pO1xyXG59O1xyXG5cclxud2luZG93LmFwZi5vbG1hcC5leHBvcnRpZXJlS2FydGUgPSBmdW5jdGlvbihldmVudCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgZXhwb3J0UE5HRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvbG1hcF9leHBvcnRpZXJlbicpO1xyXG5cdGlmICgnZG93bmxvYWQnIGluIGV4cG9ydFBOR0VsZW1lbnQpIHtcclxuXHQgIFx0ZXhwb3J0UE5HRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuXHRcdCAgICB3aW5kb3cuYXBmLm9sbWFwLm1hcC5vbmNlKCdwb3N0Y29tcG9zZScsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcblx0ICAgIFx0XHR2YXIgY2FudmFzID0gZXZlbnQuY29udGV4dC5jYW52YXM7XHJcblx0ICAgIFx0XHRleHBvcnRQTkdFbGVtZW50LmhyZWYgPSBjYW52YXMudG9EYXRhVVJMKCdpbWFnZS9wbmcnKTtcclxuXHRcdCAgICB9KTtcclxuXHQgICAgXHR3aW5kb3cuYXBmLm9sbWFwLm1hcC5yZW5kZXJTeW5jKCk7XHJcblx0ICBcdH0sIGZhbHNlKTtcclxuICAgICAgICBpZiAoIXdpbmRvdy5hcGYub2xtYXAucmVjZW50bHlDbGlja2VkKSB7XHJcbiAgICAgICAgICAgIC8vIGJlaW0gZXJzdGVuIG1hbCBzb2xsIGRlciBFdmVudCBnbGVpY2ggd2llZGVyaG9sdCB3ZXJkZW5cclxuICAgICAgICAgICAgd2luZG93LmFwZi5vbG1hcC5yZWNlbnRseUNsaWNrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAvLyB3YXJ0ZW4sIHNvbnN0IGtvbW1lbiB6d2VpIERvd25sb2Fkc1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgZXhwb3J0UE5HRWxlbWVudC5jbGljaygpO1xyXG4gICAgICAgICAgICB9LCAyMDApO1xyXG4gICAgICAgIH1cclxuXHR9IGVsc2Uge1xyXG5cdFx0dmFyIGluZm8gPSAnRGVyIERvd25sb2FkIGlzdCBudXIgbcO2Z2xpY2gsIHdlbm4gSWhyIEJyb3dzZXIgZGFzIG1vZGVybmUgRG93bmxvYWQtQXR0cmlidXQgdW50ZXJzdMO8dHp0IDxhIGhyZWY9XCJodHRwOi8vY2FuaXVzZS5jb20vI2ZlYXQ9ZG93bmxvYWRcIj4oaGllciBlaW5lIGFrdHVlbGxlIExpc3RlIGRlciB1bnRlcnN0w7x0emVuZGVuIEJyb3dzZXIpPC9hPic7XHJcblx0XHR3aW5kb3cuYXBmLm1lbGRlKGluZm8sIFwiRXhwb3J0IGFiZ2Vicm9jaGVuXCIpO1xyXG5cdH1cclxufTtcclxuXHJcbi8vIGRhbWl0IGthbm4gbWFuIGRpZSB2ZXJibGVpYmVuZGUgQW56YWhsIFplaWNoZW4sIGRpZSBpbiBlaW5lbSBGZWxkIGVyZmFzc3Qgd2VyZGVuLCBhbnplaWdlblxyXG4vLyBRdWVsbGU6IGh0dHBzOi8vd3d3LnNjcmlwdGlueS5jb20vMjAxMi8wOS9qcXVlcnktaW5wdXQtdGV4dGFyZWEtbGltaXRlci9cclxuKGZ1bmN0aW9uKCQpIHtcclxuXHQkLmZuLmV4dGVuZCgge1xyXG5cdFx0bGltaXRlcjogZnVuY3Rpb24obGltaXQsIGVsZW0pIHtcclxuXHRcdFx0JCh0aGlzKS5vbihcImtleXVwIGZvY3VzXCIsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHNldENvdW50KHRoaXMsIGVsZW0pO1xyXG5cdFx0XHR9KTtcclxuXHRcdFx0ZnVuY3Rpb24gc2V0Q291bnQoc3JjLCBlbGVtKSB7XHJcblx0XHRcdFx0dmFyIGNoYXJzID0gc3JjLnZhbHVlLmxlbmd0aDtcclxuXHRcdFx0XHRpZiAoY2hhcnMgPiBsaW1pdCkge1xyXG5cdFx0XHRcdFx0c3JjLnZhbHVlID0gc3JjLnZhbHVlLnN1YnN0cigwLCBsaW1pdCk7XHJcblx0XHRcdFx0XHRjaGFycyA9IGxpbWl0O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbGVtLmh0bWwoIGxpbWl0IC0gY2hhcnMgKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRzZXRDb3VudCgkKHRoaXMpWzBdLCBlbGVtKTtcclxuXHRcdH1cclxuXHR9KTtcclxufSkoalF1ZXJ5KTtcclxuXHJcbi8vIGVyc3RlbGx0IGVpbmVuIGd1aWRcclxuLy8gUXVlbGxlOiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzEwNTAzNC9ob3ctdG8tY3JlYXRlLWEtZ3VpZC11dWlkLWluLWphdmFzY3JpcHRcclxud2luZG93LmFwZi5lcnN0ZWxsZUd1aWQgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0cmV0dXJuICd4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHgnLnJlcGxhY2UoL1t4eV0vZywgZnVuY3Rpb24oYykge1xyXG5cdCAgICB2YXIgciA9IE1hdGgucmFuZG9tKCkqMTZ8MCwgdiA9IGMgPT0gJ3gnID8gciA6IChyJjB4M3wweDgpO1xyXG5cdCAgICByZXR1cm4gdi50b1N0cmluZygxNik7XHJcblx0fSk7XHJcbn07IiwiLyoqXHJcbiAqIEhpZXIgd2VyZGVuIHplbnRyYWwgYWxsZSBLb25maWd1cmF0aW9uc3BhcmFtZXRlciBnZXNhbW1lbHRcclxuICovXHJcblxyXG4ndXNlIHN0cmljdCc7XHJcblxyXG52YXIgY29uZmlnID0ge31cclxuICAgICwgZGJQYXNzZmlsZSA9IHJlcXVpcmUoJy4vZGJQYXNzJylcclxuICAgIDtcclxuXHJcbmNvbmZpZy5kYiA9IHt9O1xyXG5jb25maWcuZGIudXNlck5hbWUgPSBkYlBhc3NmaWxlLnVzZXI7XHJcbmNvbmZpZy5kYi5wYXNzV29yZCA9IGRiUGFzc2ZpbGUucGFzcztcclxuXHJcbi8vIGbDvHIgYWxsZSBGb3JtdWxhcmUgYXVmbGlzdGVuOlxyXG4vLyBGb3JtdWxhcm5hbWUsIE5hbWUgZGVyIGVudHNwcmVjaGVuZGVuIFRhYmVsbGUgaW4gZGVyIERCLCBOYW1lIGRlciBJRCBkaWVzZXIgVGFiZWxsZVxyXG4vLyB3aXJkIGJlbnV0enQsIHVtIG1pdCBkZW5zZWxiZW4gQWJmcmFnZW4gaW4gZGllc2VuIFRhYmVsbGUgZHVyY2h6dWbDvGhyZW46IHVwZGF0ZSwgaW5zZXJ0LCBkZWxldGVcclxuY29uZmlnLmZvcm1zID0ge1xyXG4gICAgYXA6IHtcclxuICAgICAgICB0YWJlbGxlSW5EYjogJ3RibEFrdGlvbnNwbGFuJyxcclxuICAgICAgICBpZEluVGFiZWxsZTogJ0FwQXJ0SWQnXHJcbiAgICB9LFxyXG4gICAgcG9wOiB7XHJcbiAgICAgICAgdGFiZWxsZUluRGI6ICd0YmxQb3B1bGF0aW9uJyxcclxuICAgICAgICBpZEluVGFiZWxsZTogJ1BvcElkJ1xyXG4gICAgfSxcclxuICAgIHRwb3A6IHtcclxuICAgICAgICB0YWJlbGxlSW5EYjogJ3RibFRlaWxwb3B1bGF0aW9uJyxcclxuICAgICAgICBpZEluVGFiZWxsZTogJ1RQb3BJZCdcclxuICAgIH0sXHJcbiAgICB0cG9wZmVsZGtvbnRyOiB7XHJcbiAgICAgICAgdGFiZWxsZUluRGI6ICd0YmxUZWlsUG9wRmVsZGtvbnRyb2xsZScsXHJcbiAgICAgICAgaWRJblRhYmVsbGU6ICdUUG9wS29udHJJZCdcclxuICAgIH0sXHJcbiAgICB0cG9wbWFzc246IHtcclxuICAgICAgICB0YWJlbGxlSW5EYjogJ3RibFRlaWxQb3BNYXNzbmFobWUnLFxyXG4gICAgICAgIGlkSW5UYWJlbGxlOiAnVFBvcE1hc3NuSWQnXHJcbiAgICB9LFxyXG4gICAgYXB6aWVsOiB7XHJcbiAgICAgICAgdGFiZWxsZUluRGI6ICd0YmxaaWVsJyxcclxuICAgICAgICBpZEluVGFiZWxsZTogJ1ppZWxJZCdcclxuICAgIH0sXHJcbiAgICB6aWVsYmVyOiB7XHJcbiAgICAgICAgdGFiZWxsZUluRGI6ICd0YmxaaWVsQmVyaWNodCcsXHJcbiAgICAgICAgaWRJblRhYmVsbGU6ICdaaWVsQmVySWQnXHJcbiAgICB9LFxyXG4gICAgZXJma3JpdDoge1xyXG4gICAgICAgIHRhYmVsbGVJbkRiOiAndGJsRXJmS3JpdCcsXHJcbiAgICAgICAgaWRJblRhYmVsbGU6ICdFcmZrcml0SWQnXHJcbiAgICB9LFxyXG4gICAgamJlcjoge1xyXG4gICAgICAgIHRhYmVsbGVJbkRiOiAndGJsSkJlcicsXHJcbiAgICAgICAgaWRJblRhYmVsbGU6ICdKQmVySWQnXHJcbiAgICB9LFxyXG4gICAgamJlcl91ZWJlcnNpY2h0OiB7XHJcbiAgICAgICAgdGFiZWxsZUluRGI6ICd0YmxKQmVyVWViZXJzaWNodCcsXHJcbiAgICAgICAgaWRJblRhYmVsbGU6ICdKYnVKYWhyJ1xyXG4gICAgfSxcclxuICAgIGJlcjoge1xyXG4gICAgICAgIHRhYmVsbGVJbkRiOiAndGJsQmVyJyxcclxuICAgICAgICBpZEluVGFiZWxsZTogJ0JlcklkJ1xyXG4gICAgfSxcclxuICAgIGlkZWFsYmlvdG9wOiB7XHJcbiAgICAgICAgdGFiZWxsZUluRGI6ICd0YmxJZGVhbGJpb3RvcCcsXHJcbiAgICAgICAgaWRJblRhYmVsbGU6ICdJYkFwQXJ0SWQnXHJcbiAgICB9LFxyXG4gICAgYXNzb3phcnRlbjoge1xyXG4gICAgICAgIHRhYmVsbGVJbkRiOiAndGJsQXNzb3pBcnRlbicsXHJcbiAgICAgICAgaWRJblRhYmVsbGU6ICdBYUlkJ1xyXG4gICAgfSxcclxuICAgIHBvcGJlcjoge1xyXG4gICAgICAgIHRhYmVsbGVJbkRiOiAndGJsUG9wQmVyaWNodCcsXHJcbiAgICAgICAgaWRJblRhYmVsbGU6ICdQb3BCZXJJZCdcclxuICAgIH0sXHJcbiAgICBwb3BtYXNzbmJlcjoge1xyXG4gICAgICAgIHRhYmVsbGVJbkRiOiAndGJsUG9wTWFzc25CZXJpY2h0JyxcclxuICAgICAgICBpZEluVGFiZWxsZTogJ1BvcE1hc3NuQmVySWQnXHJcbiAgICB9LFxyXG4gICAgdHBvcGJlcjoge1xyXG4gICAgICAgIHRhYmVsbGVJbkRiOiAndGJsVGVpbFBvcEJlcmljaHQnLFxyXG4gICAgICAgIGlkSW5UYWJlbGxlOiAnVFBvcEJlcklkJ1xyXG4gICAgfSxcclxuICAgIHRwb3BtYXNzbmJlcjoge1xyXG4gICAgICAgIHRhYmVsbGVJbkRiOiAndGJsUG9wTWFzc25CZXJpY2h0JyxcclxuICAgICAgICBpZEluVGFiZWxsZTogJ1BvcE1hc3NuQmVySWQnXHJcbiAgICB9LFxyXG4gICAgYmVvYjoge1xyXG4gICAgICAgIHRhYmVsbGVJbkRiOiAndGJsQmVvYlp1b3JkbnVuZycsXHJcbiAgICAgICAgaWRJblRhYmVsbGU6ICdOT19OT1RFJ1xyXG4gICAgfVxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBjb25maWc7IiwibW9kdWxlLmV4cG9ydHM9e1xyXG4gICAgXCJ1c2VyXCI6IFwiYWxleGFuZGVcIixcclxuICAgIFwicGFzc1wiOiBcInkzb1lrc0ZzUUw0OWVzOXhcIlxyXG59Il19
