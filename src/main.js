function Hammer(e,t,i){function n(e){return e.touches?e.touches.length:1}function o(e){if(e=e||window.event,B){for(var t,i=[],n=0,o=e.touches.length;o>n;n++)t=e.touches[n],i.push({x:t.pageX,y:t.pageY});return i}var a=document,s=a.body;return[{x:e.pageX||e.clientX+(a&&a.scrollLeft||s&&s.scrollLeft||0)-(a&&a.clientLeft||s&&a.clientLeft||0),y:e.pageY||e.clientY+(a&&a.scrollTop||s&&s.scrollTop||0)-(a&&a.clientTop||s&&a.clientTop||0)}]}function a(e,t){return 180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI}function s(e,t){var i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)}function r(e,t){if(2==e.length&&2==t.length){var i=s(e[0],e[1]),n=s(t[0],t[1]);return n/i}return 0}function l(e,t){if(2==e.length&&2==t.length){var i=a(e[1],e[0]),n=a(t[1],t[0]);return n-i}return 0}function p(e,t){t.touches=o(t.originalEvent),t.type=e,m(b["on"+e])&&b["on"+e].call(b,t)}function h(e){e=e||window.event,e.preventDefault?(e.preventDefault(),e.stopPropagation()):(e.returnValue=!1,e.cancelBubble=!0)}function d(){S={},z=!1,I=0,M=0,T=0,C=null}function c(i){switch(i.type){case"mousedown":case"touchstart":S.start=o(i),D=(new Date).getTime(),I=n(i),z=!0,y=i;var a=e.getBoundingClientRect(),s=e.clientTop||document.body.clientTop||0,c=e.clientLeft||document.body.clientLeft||0,u=window.pageYOffset||e.scrollTop||document.body.scrollTop,f=window.pageXOffset||e.scrollLeft||document.body.scrollLeft;F={top:a.top+u-s,left:a.left+f-c},N=!0,L.hold(i),t.prevent_default&&h(i);break;case"mousemove":case"touchmove":if(!N)return!1;k=i,S.move=o(i),L.transform(i)||L.drag(i);break;case"mouseup":case"mouseout":case"touchcancel":case"touchend":if(!N||"transform"!=C&&i.touches&&i.touches.length>0)return!1;N=!1,x=i,L.swipe(i),"drag"==C?p("dragend",{originalEvent:i,direction:P,distance:M,angle:T}):"transform"==C?p("transformend",{originalEvent:i,position:S.center,scale:r(S.start,S.move),rotation:l(S.start,S.move)}):L.tap(y),$=C,p("release",{originalEvent:i,gesture:C}),d()}}function u(t){f(e,t.relatedTarget)||c(t)}function f(e,t){if(!t&&window.event&&window.event.toElement&&(t=window.event.toElement),e===t)return!0;if(t)for(var i=t.parentNode;null!==i;){if(i===e)return!0;i=i.parentNode}return!1}function g(e,t){var i={};if(!t)return e;for(var n in e)i[n]=n in t?t[n]:e[n];return i}function m(e){return"[object Function]"==Object.prototype.toString.call(e)}function _(e,t,i){t=t.split(" ");for(var n=0,o=t.length;o>n;n++)e.addEventListener?e.addEventListener(t[n],i,!1):document.attachEvent&&e.attachEvent("on"+t[n],i)}function w(e,t,i){t=t.split(" ");for(var n=0,o=t.length;o>n;n++)e.removeEventListener?e.removeEventListener(t[n],i,!1):document.detachEvent&&e.detachEvent("on"+t[n],i)}var b=this,v={prevent_default:!1,css_hacks:!0,swipe:!0,swipe_time:200,swipe_min_distance:20,drag:!0,drag_vertical:!0,drag_horizontal:!0,drag_min_distance:20,transform:!0,scale_treshold:.1,rotation_treshold:15,tap:!0,tap_double:!0,tap_max_interval:300,tap_max_distance:10,tap_double_distance:20,hold:!0,hold_timeout:500};t=g(v,t),function(){if(!t.css_hacks)return!1;for(var i=["webkit","moz","ms","o",""],n={userSelect:"none",touchCallout:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"},o="",a=0;a<i.length;a++)for(var s in n)o=s,i[a]&&(o=i[a]+o.substring(0,1).toUpperCase()+o.substring(1)),e.style[o]=n[s]}();var y,k,x,M=0,T=0,P=0,S={},I=0,z=!1,C=null,$=null,D=null,j={x:0,y:0},A=null,E=null,F={},N=!1,B="ontouchstart"in window;this.option=function(e,n){return n!=i&&(t[e]=n),t[e]},this.getDirectionFromAngle=function(e){var t,i,n={down:e>=45&&135>e,left:e>=135||-135>=e,up:-45>e&&e>-135,right:e>=-45&&45>=e};for(i in n)if(n[i]){t=i;break}return t},this.destroy=function(){B?w(e,"touchstart touchmove touchend touchcancel",c):(w(e,"mouseup mousedown mousemove",c),w(e,"mouseout",u))};var L={hold:function(e){t.hold&&(C="hold",clearTimeout(E),E=setTimeout(function(){"hold"==C&&p("hold",{originalEvent:e,position:S.start})},t.hold_timeout))},swipe:function(e){if(S.move){var i=S.move[0].x-S.start[0].x,n=S.move[0].y-S.start[0].y;M=Math.sqrt(i*i+n*n);var o=(new Date).getTime(),s=o-D;if(t.swipe&&t.swipe_time>s&&M>t.swipe_min_distance){T=a(S.start[0],S.move[0]),P=b.getDirectionFromAngle(T),C="swipe";var r={x:S.move[0].x-F.left,y:S.move[0].y-F.top},l={originalEvent:e,position:r,direction:P,distance:M,distanceX:i,distanceY:n,angle:T};p("swipe",l)}}},drag:function(e){var i=S.move[0].x-S.start[0].x,n=S.move[0].y-S.start[0].y;if(M=Math.sqrt(i*i+n*n),t.drag&&M>t.drag_min_distance||"drag"==C){T=a(S.start[0],S.move[0]),P=b.getDirectionFromAngle(T);var o="up"==P||"down"==P;if((o&&!t.drag_vertical||!o&&!t.drag_horizontal)&&M>t.drag_min_distance)return;C="drag";var s={x:S.move[0].x-F.left,y:S.move[0].y-F.top},r={originalEvent:e,position:s,direction:P,distance:M,distanceX:i,distanceY:n,angle:T};z&&(p("dragstart",r),z=!1),p("drag",r),h(e)}},transform:function(e){if(t.transform){if(2!=n(e))return!1;var i=l(S.start,S.move),o=r(S.start,S.move);if("drag"!=C&&("transform"==C||Math.abs(1-o)>t.scale_treshold||Math.abs(i)>t.rotation_treshold)){C="transform",S.center={x:(S.move[0].x+S.move[1].x)/2-F.left,y:(S.move[0].y+S.move[1].y)/2-F.top};var a={originalEvent:e,position:S.center,scale:o,rotation:i};return z&&(p("transformstart",a),z=!1),p("transform",a),h(e),!0}}return!1},tap:function(e){var i=(new Date).getTime(),n=i-D;if(!t.hold||t.hold&&t.hold_timeout>n){var o=function(){if(j&&t.tap_double&&"tap"==$&&D-A<t.tap_max_interval){var e=Math.abs(j[0].x-S.start[0].x),i=Math.abs(j[0].y-S.start[0].y);return j&&S.start&&Math.max(e,i)<t.tap_double_distance}return!1}();if(o)C="double_tap",A=null,p("doubletap",{originalEvent:e,position:S.start}),h(e);else{var a=S.move?Math.abs(S.move[0].x-S.start[0].x):0,s=S.move?Math.abs(S.move[0].y-S.start[0].y):0;M=Math.max(a,s),M<t.tap_max_distance&&(C="tap",A=i,j=S.start,t.tap&&(p("tap",{originalEvent:e,position:S.start}),h(e)))}}}};B?_(e,"touchstart touchmove touchend touchcancel",c):(_(e,"mouseup mousedown mousemove",c),_(e,"mouseout",u))}function ClusterIcon(e,t){e.getMarkerClusterer().extend(ClusterIcon,google.maps.OverlayView),this.cluster_=e,this.className_=e.getMarkerClusterer().getClusterClass(),this.styles_=t,this.center_=null,this.div_=null,this.sums_=null,this.visible_=!1,this.setMap(e.getMap())}function Cluster(e){this.markerClusterer_=e,this.map_=e.getMap(),this.gridSize_=e.getGridSize(),this.minClusterSize_=e.getMinimumClusterSize(),this.averageCenter_=e.getAverageCenter(),this.markers_=[],this.center_=null,this.bounds_=null,this.clusterIcon_=new ClusterIcon(this,e.getStyles())}function MarkerClusterer(e,t,i){this.extend(MarkerClusterer,google.maps.OverlayView),t=t||[],i=i||{},this.markers_=[],this.clusters_=[],this.listeners_=[],this.activeMap_=null,this.ready_=!1,this.gridSize_=i.gridSize||60,this.minClusterSize_=i.minimumClusterSize||2,this.maxZoom_=i.maxZoom||null,this.styles_=i.styles||[],this.title_=i.title||"",this.zoomOnClick_=!0,void 0!==i.zoomOnClick&&(this.zoomOnClick_=i.zoomOnClick),this.averageCenter_=!1,void 0!==i.averageCenter&&(this.averageCenter_=i.averageCenter),this.ignoreHidden_=!1,void 0!==i.ignoreHidden&&(this.ignoreHidden_=i.ignoreHidden),this.enableRetinaIcons_=!1,void 0!==i.enableRetinaIcons&&(this.enableRetinaIcons_=i.enableRetinaIcons),this.imagePath_=i.imagePath||MarkerClusterer.IMAGE_PATH,this.imageExtension_=i.imageExtension||MarkerClusterer.IMAGE_EXTENSION,this.imageSizes_=i.imageSizes||MarkerClusterer.IMAGE_SIZES,this.calculator_=i.calculator||MarkerClusterer.CALCULATOR,this.batchSize_=i.batchSize||MarkerClusterer.BATCH_SIZE,this.batchSizeIE_=i.batchSizeIE||MarkerClusterer.BATCH_SIZE_IE,this.clusterClass_=i.clusterClass||"cluster",-1!==navigator.userAgent.toLowerCase().indexOf("msie")&&(this.batchSize_=this.batchSizeIE_),this.setupStyles_(),this.addMarkers(t,!0),this.setMap(e)}function inherits(e,t){function i(){}i.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new i,e.prototype.constructor=e}function MarkerLabel_(e,t){this.marker_=e,this.handCursorURL_=e.handCursorURL,this.labelDiv_=document.createElement("div"),this.labelDiv_.style.cssText="position: absolute; overflow: hidden;",this.eventDiv_=document.createElement("div"),this.eventDiv_.style.cssText=this.labelDiv_.style.cssText,this.eventDiv_.setAttribute("onselectstart","return false;"),this.eventDiv_.setAttribute("ondragstart","return false;"),this.crossDiv_=MarkerLabel_.getSharedCross(t)}function MarkerWithLabel(e){e=e||{},e.labelContent=e.labelContent||"",e.labelAnchor=e.labelAnchor||new google.maps.Point(0,0),e.labelClass=e.labelClass||"markerLabels",e.labelStyle=e.labelStyle||{},e.labelInBackground=e.labelInBackground||!1,"undefined"==typeof e.labelVisible&&(e.labelVisible=!0),"undefined"==typeof e.raiseOnDrag&&(e.raiseOnDrag=!0),"undefined"==typeof e.clickable&&(e.clickable=!0),"undefined"==typeof e.draggable&&(e.draggable=!1),"undefined"==typeof e.optimized&&(e.optimized=!1),e.crossImage=e.crossImage||"http"+("https:"===document.location.protocol?"s":"")+"://maps.gstatic.com/intl/en_us/mapfiles/drag_cross_67_16.png",e.handCursor=e.handCursor||"http"+("https:"===document.location.protocol?"s":"")+"://maps.gstatic.com/intl/en_us/mapfiles/closedhand_8_8.cur",e.optimized=!1,this.label=new MarkerLabel_(this,e.crossImage,e.handCursor),google.maps.Marker.apply(this,arguments)}function addruler(){var e,t,i,n,o,a,s;t=map.getCenter(),e=map.getBounds().getNorthEast(),map_sw=map.getBounds().getSouthWest(),n=map_sw.lat()+(e.lat()-t.lat())/8,o=map_sw.lng()+(t.lng()-map_sw.lng())/8,s=map_sw.lng()+(t.lng()-map_sw.lng())/8*2,i=new google.maps.LatLng(n,o),a=new google.maps.LatLng(n,s),ruler1=new google.maps.Marker({position:i,map:map,title:"Beginn Messung",draggable:!0}),ruler2=new google.maps.Marker({position:a,map:map,title:"Ende Messung",draggable:!0}),ruler1label=new Label({map:map}),ruler2label=new Label({map:map}),ruler1label.bindTo("position",ruler1,"position"),ruler2label.bindTo("position",ruler2,"position"),rulerpoly=new google.maps.Polyline({path:[ruler1.position,ruler2.position],strokeColor:"#FFFF00",strokeOpacity:.7,strokeWeight:7}),rulerpoly.setMap(map),ruler1label.set("text",distance(ruler1.getPosition().lat(),ruler1.getPosition().lng(),ruler2.getPosition().lat(),ruler2.getPosition().lng())),ruler2label.set("text",distance(ruler1.getPosition().lat(),ruler1.getPosition().lng(),ruler2.getPosition().lat(),ruler2.getPosition().lng())),google.maps.event.addListener(ruler1,"drag",function(){rulerpoly.setPath([ruler1.getPosition(),ruler2.getPosition()]),ruler1label.set("text",distance(ruler1.getPosition().lat(),ruler1.getPosition().lng(),ruler2.getPosition().lat(),ruler2.getPosition().lng())),ruler2label.set("text",distance(ruler1.getPosition().lat(),ruler1.getPosition().lng(),ruler2.getPosition().lat(),ruler2.getPosition().lng()))}),google.maps.event.addListener(ruler2,"drag",function(){rulerpoly.setPath([ruler1.getPosition(),ruler2.getPosition()]),ruler1label.set("text",distance(ruler1.getPosition().lat(),ruler1.getPosition().lng(),ruler2.getPosition().lat(),ruler2.getPosition().lng())),ruler2label.set("text",distance(ruler1.getPosition().lat(),ruler1.getPosition().lng(),ruler2.getPosition().lat(),ruler2.getPosition().lng()))})}function removeruler(){google.maps.event.clearListeners(ruler1,"drag"),ruler1.setMap(null),google.maps.event.clearListeners(ruler2,"drag"),ruler2.setMap(null),ruler1label.setMap(null),ruler2label.setMap(null),rulerpoly.setMap(null)}function distance(e,t,i,n){var o=6371,a=(i-e)*Math.PI/180,s=(n-t)*Math.PI/180,r=Math.sin(a/2)*Math.sin(a/2)+Math.cos(e*Math.PI/180)*Math.cos(i*Math.PI/180)*Math.sin(s/2)*Math.sin(s/2),l=2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)),p=o*l;return p>10?Math.round(p)+"km":10>=p?Math.round(1e3*p)+"m":p}function Label(e){this.setValues(e);var t=this.span_=document.createElement("span");t.style.cssText='position: relative; left: 0%; top: -8px; white-space: nowrap; border: 0px; font-family:arial; font-weight:bold;padding: 2px; background-color: #ddd; opacity: .75; filter: alpha(opacity=75); -ms-filter: "alpha(opacity=75)"; -khtml-opacity: .75; -moz-opacity: .75;';var i=this.div_=document.createElement("div");i.appendChild(t),i.style.cssText="position: absolute; display: none"}function bound(e,t,i){return null!=t&&(e=Math.max(e,t)),null!=i&&(e=Math.min(e,i)),e}function degreesToRadians(e){return e*(Math.PI/180)}function radiansToDegrees(e){return e/(Math.PI/180)}function MercatorProjection(){var e=256;this.pixelOrigin_=new google.maps.Point(e/2,e/2),this.pixelsPerLonDegree_=e/360,this.pixelsPerLonRadian_=e/(2*Math.PI)}function loadWMS(e,t,i){var n=256,o=256,a=.75,s=!0,r=2,l=28,p=["REQUEST=GetMap","SERVICE=WMS","VERSION=1.1.1","STYLES=default","TRANSPARENT=TRUE","FORMAT=image/gif"];p=p.concat(i);var h={getTileUrl:function(e,i){var n=new google.maps.Point(256*e.x,256*(e.y+1)),o=new google.maps.Point(256*(e.x+1),256*e.y),a=new MercatorProjection,s=a.fromDivPixelToSphericalMercator(n,i),r=a.fromDivPixelToSphericalMercator(o,i),l=s.y,h=s.x,d=r.y,c=r.x;h>c&&(c=Math.abs(c));var u=t+p.join("&")+"&bbox="+h+","+l+","+c+","+d;return u},tileSize:new google.maps.Size(n,o),minZoom:r,maxZoom:l,opacity:a,isPng:s},d=new google.maps.ImageMapType(h);e.overlayMapTypes.insertAt(0,d),e.setOptions({mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.TERRAIN,google.maps.MapTypeId.SATELLITE,google.maps.MapTypeId.HYBRID],style:google.maps.MapTypeControlStyle.DROPDOWN_MENU}})}!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){function t(t,n){var o,a,s,r=t.nodeName.toLowerCase();return"area"===r?(o=t.parentNode,a=o.name,t.href&&a&&"map"===o.nodeName.toLowerCase()?(s=e("img[usemap=#"+a+"]")[0],!!s&&i(s)):!1):(/input|select|textarea|button|object/.test(r)?!t.disabled:"a"===r?t.href||n:n)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}function n(e){for(var t,i;e.length&&e[0]!==document;){if(t=e.css("position"),("absolute"===t||"relative"===t||"fixed"===t)&&(i=parseInt(e.css("zIndex"),10),!isNaN(i)&&0!==i))return i;e=e.parent()}return 0}function o(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.regional.en=e.extend(!0,{},this.regional[""]),this.regional["en-US"]=e.extend(!0,{},this.regional.en),this.dpDiv=a(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function a(t){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(i,"mouseout",function(){e(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",function(){e.datepicker._isDisabledDatepicker(m.inline?t.parent()[0]:m.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))})}function s(t,i){e.extend(t,i);for(var n in i)null==i[n]&&(t[n]=i[n]);return t}function r(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}e.ui=e.ui||{},e.extend(e.ui,{version:"1.11.0",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(){var t=this.css("position"),i="absolute"===t,n=this.parents().filter(function(){var t=e(this);return i&&"static"===t.css("position")?!1:/(auto|scroll)/.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==t&&n.length?n:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,n){return!!e.data(t,n[3])},focusable:function(i){return t(i,!isNaN(e.attr(i,"tabindex")))},tabbable:function(i){var n=e.attr(i,"tabindex"),o=isNaN(n);return(o||n>=0)&&t(i,!o)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,i){function n(t,i,n,a){return e.each(o,function(){i-=parseFloat(e.css(t,"padding"+this))||0,n&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),a&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var o="Width"===i?["Left","Right"]:["Top","Bottom"],a=i.toLowerCase(),s={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(t){return void 0===t?s["inner"+i].call(this):this.each(function(){e(this).css(a,n(this,t)+"px")})},e.fn["outer"+i]=function(t,o){return"number"!=typeof t?s["outer"+i].call(this,t):this.each(function(){e(this).css(a,n(this,t,!0,o)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(i,n){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),n&&n.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var i,n,o=e(this[0]);o.length&&o[0]!==document;){if(i=o.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(n=parseInt(o.css("zIndex"),10),!isNaN(n)&&0!==n))return n;o=o.parent()}return 0}}),e.ui.plugin={add:function(t,i,n){var o,a=e.ui[t].prototype;for(o in n)a.plugins[o]=a.plugins[o]||[],a.plugins[o].push([i,n[o]])},call:function(e,t,i,n){var o,a=e.plugins[t];if(a&&(n||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(o=0;o<a.length;o++)e.options[a[o][0]]&&a[o][1].apply(e.element,i)}};var l=0,p=Array.prototype.slice;e.cleanData=function(t){return function(i){for(var n,o=0;null!=(n=i[o]);o++)try{e(n).triggerHandler("remove")}catch(a){}t(i)}}(e.cleanData),e.widget=function(t,i,n){var o,a,s,r,l={},p=t.split(".")[0];return t=t.split(".")[1],o=p+"-"+t,n||(n=i,i=e.Widget),e.expr[":"][o.toLowerCase()]=function(t){return!!e.data(t,o)},e[p]=e[p]||{},a=e[p][t],s=e[p][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new s(e,t)},e.extend(s,a,{version:n.version,_proto:e.extend({},n),_childConstructors:[]}),r=new i,r.options=e.widget.extend({},r.options),e.each(n,function(t,n){return e.isFunction(n)?void(l[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},o=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,a=this._superApply;return this._super=e,this._superApply=o,t=n.apply(this,arguments),this._super=i,this._superApply=a,t}}()):void(l[t]=n)}),s.prototype=e.widget.extend(r,{widgetEventPrefix:a?r.widgetEventPrefix||t:t},l,{constructor:s,namespace:p,widgetName:t,widgetFullName:o}),a?(e.each(a._childConstructors,function(t,i){var n=i.prototype;e.widget(n.namespace+"."+n.widgetName,s,i._proto)}),delete a._childConstructors):i._childConstructors.push(s),e.widget.bridge(t,s),s},e.widget.extend=function(t){for(var i,n,o=p.call(arguments,1),a=0,s=o.length;s>a;a++)for(i in o[a])n=o[a][i],o[a].hasOwnProperty(i)&&void 0!==n&&(t[i]=e.isPlainObject(n)?e.isPlainObject(t[i])?e.widget.extend({},t[i],n):e.widget.extend({},n):n);return t},e.widget.bridge=function(t,i){var n=i.prototype.widgetFullName||t;e.fn[t]=function(o){var a="string"==typeof o,s=p.call(arguments,1),r=this;return o=!a&&s.length?e.widget.extend.apply(null,[o].concat(s)):o,this.each(a?function(){var i,a=e.data(this,n);return"instance"===o?(r=a,!1):a?e.isFunction(a[o])&&"_"!==o.charAt(0)?(i=a[o].apply(a,s),i!==a&&void 0!==i?(r=i&&i.jquery?r.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+o+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+o+"'")}:function(){var t=e.data(this,n);t?(t.option(o||{}),t._init&&t._init()):e.data(this,n,new i(o,this))}),r}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=l++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var n,o,a,s=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(s={},n=t.split("."),t=n.shift(),n.length){for(o=s[t]=e.widget.extend({},this.options[t]),a=0;a<n.length-1;a++)o[n[a]]=o[n[a]]||{},o=o[n[a]];if(t=n.pop(),1===arguments.length)return void 0===o[t]?null:o[t];o[t]=i}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];s[t]=i}return this._setOptions(s),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,n){var o,a=this;"boolean"!=typeof t&&(n=i,i=t,t=!1),n?(i=o=e(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,o=this.widget()),e.each(n,function(n,s){function r(){return t||a.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof s?a[s]:s).apply(a,arguments):void 0}"string"!=typeof s&&(r.guid=s.guid=s.guid||r.guid||e.guid++);var l=n.match(/^([\w:-]*)\s*(.*)$/),p=l[1]+a.eventNamespace,h=l[2];h?o.delegate(h,p,r):i.bind(p,r)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function i(){return("string"==typeof e?n[e]:e).apply(n,arguments)}var n=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,n){var o,a,s=this.options[t];if(n=n||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],a=i.originalEvent)for(o in a)o in i||(i[o]=a[o]);return this.element.trigger(i,n),!(e.isFunction(s)&&s.apply(this.element[0],[i].concat(n))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(n,o,a){"string"==typeof o&&(o={effect:o});var s,r=o?o===!0||"number"==typeof o?i:o.effect||i:t;o=o||{},"number"==typeof o&&(o={duration:o}),s=!e.isEmptyObject(o),o.complete=a,o.delay&&n.delay(o.delay),s&&e.effects&&e.effects.effect[r]?n[t](o):r!==t&&n[r]?n[r](o.duration,o.easing,a):n.queue(function(i){e(this)[t](),a&&a.call(n[0]),i()})}});var h=(e.widget,!1);e(document).mouseup(function(){h=!1});e.widget("ui.mouse",{version:"1.11.0",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!h){this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var i=this,n=1===t.which,o="string"==typeof this.options.cancel&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;return n&&!o&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(t)!==!1,!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),h=!0,!0)):!0}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button?this._mouseUp(t):t.which?this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted):this._mouseUp(t)},_mouseUp:function(t){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),h=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}});!function(){function t(e,t,i){return[parseFloat(e[0])*(u.test(e[0])?t/100:1),parseFloat(e[1])*(u.test(e[1])?i/100:1)]}function i(t,i){return parseInt(e.css(t,i),10)||0}function n(t){var i=t[0];return 9===i.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(i)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var o,a,s=Math.max,r=Math.abs,l=Math.round,p=/left|center|right/,h=/top|center|bottom/,d=/[\+\-]\d+(\.[\d]+)?%?/,c=/^\w+/,u=/%$/,f=e.fn.position;e.position={scrollbarWidth:function(){if(void 0!==o)return o;var t,i,n=e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),a=n.children()[0];return e("body").append(n),t=a.offsetWidth,n.css("overflow","scroll"),i=a.offsetWidth,t===i&&(i=n[0].clientWidth),n.remove(),o=t-i},getScrollInfo:function(t){var i=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),n=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),o="scroll"===i||"auto"===i&&t.width<t.element[0].scrollWidth,a="scroll"===n||"auto"===n&&t.height<t.element[0].scrollHeight;return{width:a?e.position.scrollbarWidth():0,height:o?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var i=e(t||window),n=e.isWindow(i[0]),o=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:n,isDocument:o,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:n?i.width():i.outerWidth(),height:n?i.height():i.outerHeight()}}},e.fn.position=function(o){if(!o||!o.of)return f.apply(this,arguments);o=e.extend({},o);var u,g,m,_,w,b,v=e(o.of),y=e.position.getWithinInfo(o.within),k=e.position.getScrollInfo(y),x=(o.collision||"flip").split(" "),M={};return b=n(v),v[0].preventDefault&&(o.at="left top"),g=b.width,m=b.height,_=b.offset,w=e.extend({},_),e.each(["my","at"],function(){var e,t,i=(o[this]||"").split(" ");1===i.length&&(i=p.test(i[0])?i.concat(["center"]):h.test(i[0])?["center"].concat(i):["center","center"]),i[0]=p.test(i[0])?i[0]:"center",i[1]=h.test(i[1])?i[1]:"center",e=d.exec(i[0]),t=d.exec(i[1]),M[this]=[e?e[0]:0,t?t[0]:0],o[this]=[c.exec(i[0])[0],c.exec(i[1])[0]]}),1===x.length&&(x[1]=x[0]),"right"===o.at[0]?w.left+=g:"center"===o.at[0]&&(w.left+=g/2),"bottom"===o.at[1]?w.top+=m:"center"===o.at[1]&&(w.top+=m/2),u=t(M.at,g,m),w.left+=u[0],w.top+=u[1],this.each(function(){var n,p,h=e(this),d=h.outerWidth(),c=h.outerHeight(),f=i(this,"marginLeft"),b=i(this,"marginTop"),T=d+f+i(this,"marginRight")+k.width,P=c+b+i(this,"marginBottom")+k.height,S=e.extend({},w),I=t(M.my,h.outerWidth(),h.outerHeight());
"right"===o.my[0]?S.left-=d:"center"===o.my[0]&&(S.left-=d/2),"bottom"===o.my[1]?S.top-=c:"center"===o.my[1]&&(S.top-=c/2),S.left+=I[0],S.top+=I[1],a||(S.left=l(S.left),S.top=l(S.top)),n={marginLeft:f,marginTop:b},e.each(["left","top"],function(t,i){e.ui.position[x[t]]&&e.ui.position[x[t]][i](S,{targetWidth:g,targetHeight:m,elemWidth:d,elemHeight:c,collisionPosition:n,collisionWidth:T,collisionHeight:P,offset:[u[0]+I[0],u[1]+I[1]],my:o.my,at:o.at,within:y,elem:h})}),o.using&&(p=function(e){var t=_.left-S.left,i=t+g-d,n=_.top-S.top,a=n+m-c,l={target:{element:v,left:_.left,top:_.top,width:g,height:m},element:{element:h,left:S.left,top:S.top,width:d,height:c},horizontal:0>i?"left":t>0?"right":"center",vertical:0>a?"top":n>0?"bottom":"middle"};d>g&&r(t+i)<g&&(l.horizontal="center"),c>m&&r(n+a)<m&&(l.vertical="middle"),l.important=s(r(t),r(i))>s(r(n),r(a))?"horizontal":"vertical",o.using.call(this,e,l)}),h.offset(e.extend(S,{using:p}))})},e.ui.position={fit:{left:function(e,t){var i,n=t.within,o=n.isWindow?n.scrollLeft:n.offset.left,a=n.width,r=e.left-t.collisionPosition.marginLeft,l=o-r,p=r+t.collisionWidth-a-o;t.collisionWidth>a?l>0&&0>=p?(i=e.left+l+t.collisionWidth-a-o,e.left+=l-i):e.left=p>0&&0>=l?o:l>p?o+a-t.collisionWidth:o:l>0?e.left+=l:p>0?e.left-=p:e.left=s(e.left-r,e.left)},top:function(e,t){var i,n=t.within,o=n.isWindow?n.scrollTop:n.offset.top,a=t.within.height,r=e.top-t.collisionPosition.marginTop,l=o-r,p=r+t.collisionHeight-a-o;t.collisionHeight>a?l>0&&0>=p?(i=e.top+l+t.collisionHeight-a-o,e.top+=l-i):e.top=p>0&&0>=l?o:l>p?o+a-t.collisionHeight:o:l>0?e.top+=l:p>0?e.top-=p:e.top=s(e.top-r,e.top)}},flip:{left:function(e,t){var i,n,o=t.within,a=o.offset.left+o.scrollLeft,s=o.width,l=o.isWindow?o.scrollLeft:o.offset.left,p=e.left-t.collisionPosition.marginLeft,h=p-l,d=p+t.collisionWidth-s-l,c="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,u="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];0>h?(i=e.left+c+u+f+t.collisionWidth-s-a,(0>i||i<r(h))&&(e.left+=c+u+f)):d>0&&(n=e.left-t.collisionPosition.marginLeft+c+u+f-l,(n>0||r(n)<d)&&(e.left+=c+u+f))},top:function(e,t){var i,n,o=t.within,a=o.offset.top+o.scrollTop,s=o.height,l=o.isWindow?o.scrollTop:o.offset.top,p=e.top-t.collisionPosition.marginTop,h=p-l,d=p+t.collisionHeight-s-l,c="top"===t.my[1],u=c?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,g=-2*t.offset[1];0>h?(n=e.top+u+f+g+t.collisionHeight-s-a,e.top+u+f+g>h&&(0>n||n<r(h))&&(e.top+=u+f+g)):d>0&&(i=e.top-t.collisionPosition.marginTop+u+f+g-l,e.top+u+f+g>d&&(i>0||r(i)<d)&&(e.top+=u+f+g))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,i,n,o,s,r=document.getElementsByTagName("body")[0],l=document.createElement("div");t=document.createElement(r?"div":"body"),n={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},r&&e.extend(n,{position:"absolute",left:"-1000px",top:"-1000px"});for(s in n)t.style[s]=n[s];t.appendChild(l),i=r||document.documentElement,i.insertBefore(t,i.firstChild),l.style.cssText="position: absolute; left: 10.7432222px;",o=e(l).offset().left,a=o>10&&11>o,t.innerHTML="",i.removeChild(t)}()}();e.ui.position;e.widget("ui.draggable",e.ui.mouse,{version:"1.11.0",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(t){var i=this.document[0],n=this.options;try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()&&e(i.activeElement).blur()}catch(o){}return this.helper||n.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(e(n.iframeFix===!0?"iframe":n.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var i=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,i){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var n=this._uiHash();if(this._trigger("drag",t,n)===!1)return this._mouseUp({}),!1;this.position=n.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var i=this,n=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(n=e.ui.ddmanager.drop(this,t)),this.dropped&&(n=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!n||"valid"===this.options.revert&&n||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",t)!==!1&&i._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.element.focus(),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this._removeHandleClassName(),e(this.options.handle||this.element).addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.element.find(".ui-draggable-handle").addBack().removeClass("ui-draggable-handle")},_createHelper:function(t){var i=this.options,n=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,n,o=this.options,a=this.document[0];return this.relative_container=null,o.containment?"window"===o.containment?void(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===o.containment?void(this.containment=[0,0,e(a).width()-this.helperProportions.width-this.margins.left,(e(a).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):o.containment.constructor===Array?void(this.containment=o.containment):("parent"===o.containment&&(o.containment=this.helper[0].parentNode),i=e(o.containment),n=i[0],void(n&&(t="hidden"!==i.css("overflow"),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(t?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=i))):void(this.containment=null)},_convertPositionTo:function(e,t){t||(t=this.position);var i="absolute"===e?1:-1,n=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:n?0:this.offset.scroll.top)*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:n?0:this.offset.scroll.left)*i}},_generatePosition:function(e,t){var i,n,o,a,s=this.options,r=this._isRootNode(this.scrollParent[0]),l=e.pageX,p=e.pageY;return r&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relative_container?(n=this.relative_container.offset(),i=[this.containment[0]+n.left,this.containment[1]+n.top,this.containment[2]+n.left,this.containment[3]+n.top]):i=this.containment,e.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),e.pageY-this.offset.click.top<i[1]&&(p=i[1]+this.offset.click.top),e.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),e.pageY-this.offset.click.top>i[3]&&(p=i[3]+this.offset.click.top)),s.grid&&(o=s.grid[1]?this.originalPageY+Math.round((p-this.originalPageY)/s.grid[1])*s.grid[1]:this.originalPageY,p=i?o-this.offset.click.top>=i[1]||o-this.offset.click.top>i[3]?o:o-this.offset.click.top>=i[1]?o-s.grid[1]:o+s.grid[1]:o,a=s.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/s.grid[0])*s.grid[0]:this.originalPageX,l=i?a-this.offset.click.left>=i[0]||a-this.offset.click.left>i[2]?a:a-this.offset.click.left>=i[0]?a-s.grid[0]:a+s.grid[0]:a),"y"===s.axis&&(l=this.originalPageX),"x"===s.axis&&(p=this.originalPageY)),{top:p-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(t,i,n){return n=n||this._uiHash(),e.ui.plugin.call(this,t,[i,n,this],!0),"drag"===t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,i,n)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,i,n){var o=n.options,a=e.extend({},i,{item:n.element});n.sortables=[],e(o.connectToSortable).each(function(){var i=e(this).sortable("instance");i&&!i.options.disabled&&(n.sortables.push({instance:i,shouldRevert:i.options.revert}),i.refreshPositions(),i._trigger("activate",t,a))})},stop:function(t,i,n){var o=e.extend({},i,{item:n.element});e.each(n.sortables,function(){this.instance.isOver?(this.instance.isOver=0,n.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"===n.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,o))})},drag:function(t,i,n){var o=this;e.each(n.sortables,function(){var a=!1,s=this;this.instance.positionAbs=n.positionAbs,this.instance.helperProportions=n.helperProportions,this.instance.offset.click=n.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(a=!0,e.each(n.sortables,function(){return this.instance.positionAbs=n.positionAbs,this.instance.helperProportions=n.helperProportions,this.instance.offset.click=n.offset.click,this!==s&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(s.instance.element[0],this.instance.element[0])&&(a=!1),a})),a?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(o).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return i.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=n.offset.click.top,this.instance.offset.click.left=n.offset.click.left,this.instance.offset.parent.left-=n.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=n.offset.parent.top-this.instance.offset.parent.top,n._trigger("toSortable",t),n.dropped=this.instance.element,n.currentItem=n.element,this.instance.fromOutside=n),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),n._trigger("fromSortable",t),n.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,i,n){var o=e("body"),a=n.options;o.css("cursor")&&(a._cursor=o.css("cursor")),o.css("cursor",a.cursor)},stop:function(t,i,n){var o=n.options;o._cursor&&e("body").css("cursor",o._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,i,n){var o=e(i.helper),a=n.options;o.css("opacity")&&(a._opacity=o.css("opacity")),o.css("opacity",a.opacity)},stop:function(t,i,n){var o=n.options;o._opacity&&e(i.helper).css("opacity",o._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,i){i.scrollParent[0]!==i.document[0]&&"HTML"!==i.scrollParent[0].tagName&&(i.overflowOffset=i.scrollParent.offset())},drag:function(t,i,n){var o=n.options,a=!1,s=n.document[0];n.scrollParent[0]!==s&&"HTML"!==n.scrollParent[0].tagName?(o.axis&&"x"===o.axis||(n.overflowOffset.top+n.scrollParent[0].offsetHeight-t.pageY<o.scrollSensitivity?n.scrollParent[0].scrollTop=a=n.scrollParent[0].scrollTop+o.scrollSpeed:t.pageY-n.overflowOffset.top<o.scrollSensitivity&&(n.scrollParent[0].scrollTop=a=n.scrollParent[0].scrollTop-o.scrollSpeed)),o.axis&&"y"===o.axis||(n.overflowOffset.left+n.scrollParent[0].offsetWidth-t.pageX<o.scrollSensitivity?n.scrollParent[0].scrollLeft=a=n.scrollParent[0].scrollLeft+o.scrollSpeed:t.pageX-n.overflowOffset.left<o.scrollSensitivity&&(n.scrollParent[0].scrollLeft=a=n.scrollParent[0].scrollLeft-o.scrollSpeed))):(o.axis&&"x"===o.axis||(t.pageY-e(s).scrollTop()<o.scrollSensitivity?a=e(s).scrollTop(e(s).scrollTop()-o.scrollSpeed):e(window).height()-(t.pageY-e(s).scrollTop())<o.scrollSensitivity&&(a=e(s).scrollTop(e(s).scrollTop()+o.scrollSpeed))),o.axis&&"y"===o.axis||(t.pageX-e(s).scrollLeft()<o.scrollSensitivity?a=e(s).scrollLeft(e(s).scrollLeft()-o.scrollSpeed):e(window).width()-(t.pageX-e(s).scrollLeft())<o.scrollSensitivity&&(a=e(s).scrollLeft(e(s).scrollLeft()+o.scrollSpeed)))),a!==!1&&e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(n,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,i,n){var o=n.options;n.snapElements=[],e(o.snap.constructor!==String?o.snap.items||":data(ui-draggable)":o.snap).each(function(){var t=e(this),i=t.offset();this!==n.element[0]&&n.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:i.top,left:i.left})})},drag:function(t,i,n){var o,a,s,r,l,p,h,d,c,u,f=n.options,g=f.snapTolerance,m=i.offset.left,_=m+n.helperProportions.width,w=i.offset.top,b=w+n.helperProportions.height;for(c=n.snapElements.length-1;c>=0;c--)l=n.snapElements[c].left,p=l+n.snapElements[c].width,h=n.snapElements[c].top,d=h+n.snapElements[c].height,l-g>_||m>p+g||h-g>b||w>d+g||!e.contains(n.snapElements[c].item.ownerDocument,n.snapElements[c].item)?(n.snapElements[c].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,t,e.extend(n._uiHash(),{snapItem:n.snapElements[c].item})),n.snapElements[c].snapping=!1):("inner"!==f.snapMode&&(o=Math.abs(h-b)<=g,a=Math.abs(d-w)<=g,s=Math.abs(l-_)<=g,r=Math.abs(p-m)<=g,o&&(i.position.top=n._convertPositionTo("relative",{top:h-n.helperProportions.height,left:0}).top-n.margins.top),a&&(i.position.top=n._convertPositionTo("relative",{top:d,left:0}).top-n.margins.top),s&&(i.position.left=n._convertPositionTo("relative",{top:0,left:l-n.helperProportions.width}).left-n.margins.left),r&&(i.position.left=n._convertPositionTo("relative",{top:0,left:p}).left-n.margins.left)),u=o||a||s||r,"outer"!==f.snapMode&&(o=Math.abs(h-w)<=g,a=Math.abs(d-b)<=g,s=Math.abs(l-m)<=g,r=Math.abs(p-_)<=g,o&&(i.position.top=n._convertPositionTo("relative",{top:h,left:0}).top-n.margins.top),a&&(i.position.top=n._convertPositionTo("relative",{top:d-n.helperProportions.height,left:0}).top-n.margins.top),s&&(i.position.left=n._convertPositionTo("relative",{top:0,left:l}).left-n.margins.left),r&&(i.position.left=n._convertPositionTo("relative",{top:0,left:p-n.helperProportions.width}).left-n.margins.left)),!n.snapElements[c].snapping&&(o||a||s||r||u)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,t,e.extend(n._uiHash(),{snapItem:n.snapElements[c].item})),n.snapElements[c].snapping=o||a||s||r||u)}}),e.ui.plugin.add("draggable","stack",{start:function(t,i,n){var o,a=n.options,s=e.makeArray(e(a.stack)).sort(function(t,i){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(i).css("zIndex"),10)||0)});s.length&&(o=parseInt(e(s[0]).css("zIndex"),10)||0,e(s).each(function(t){e(this).css("zIndex",o+t)}),this.css("zIndex",o+s.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,i,n){var o=e(i.helper),a=n.options;o.css("zIndex")&&(a._zIndex=o.css("zIndex")),o.css("zIndex",a.zIndex)},stop:function(t,i,n){var o=n.options;o._zIndex&&e(i.helper).css("zIndex",o._zIndex)}});e.ui.draggable;e.widget("ui.droppable",{version:"1.11.0",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,i=this.options,n=i.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(n)?n:function(e){return e.is(n)},this.proportions=function(){return arguments.length?void(t=arguments[0]):t?t:t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(i.scope),i.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[],e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){for(var t=0;t<e.length;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,i){if("accept"===t)this.accept=e.isFunction(i)?i:function(e){return e.is(i)};else if("scope"===t){var n=e.ui.ddmanager.droppables[this.options.scope];this._splice(n),this._addToManager(i)}this._super(t,i)},_activate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",t,this.ui(i))},_deactivate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",t,this.ui(i))},_over:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(i)))},_out:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(i)))},_drop:function(t,i){var n=i||e.ui.ddmanager.current,o=!1;return n&&(n.currentItem||n.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var t=e(this).droppable("instance");return t.options.greedy&&!t.options.disabled&&t.options.scope===n.options.scope&&t.accept.call(t.element[0],n.currentItem||n.element)&&e.ui.intersect(n,e.extend(t,{offset:t.element.offset()}),t.options.tolerance)?(o=!0,!1):void 0}),o?!1:this.accept.call(this.element[0],n.currentItem||n.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(n)),this.element):!1):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(){function e(e,t,i){return e>=t&&t+i>e}return function(t,i,n){if(!i.offset)return!1;var o,a,s=(t.positionAbs||t.position.absolute).left,r=(t.positionAbs||t.position.absolute).top,l=s+t.helperProportions.width,p=r+t.helperProportions.height,h=i.offset.left,d=i.offset.top,c=h+i.proportions().width,u=d+i.proportions().height;switch(n){case"fit":return s>=h&&c>=l&&r>=d&&u>=p;case"intersect":return h<s+t.helperProportions.width/2&&l-t.helperProportions.width/2<c&&d<r+t.helperProportions.height/2&&p-t.helperProportions.height/2<u;case"pointer":return o=(t.positionAbs||t.position.absolute).left+(t.clickOffset||t.offset.click).left,a=(t.positionAbs||t.position.absolute).top+(t.clickOffset||t.offset.click).top,e(a,d,i.proportions().height)&&e(o,h,i.proportions().width);case"touch":return(r>=d&&u>=r||p>=d&&u>=p||d>r&&p>u)&&(s>=h&&c>=s||l>=h&&c>=l||h>s&&l>c);default:return!1}}}(),e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,i){var n,o,a=e.ui.ddmanager.droppables[t.options.scope]||[],s=i?i.type:null,r=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(n=0;n<a.length;n++)if(!(a[n].options.disabled||t&&!a[n].accept.call(a[n].element[0],t.currentItem||t.element))){for(o=0;o<r.length;o++)if(r[o]===a[n].element[0]){a[n].proportions().height=0;continue e}a[n].visible="none"!==a[n].element.css("display"),a[n].visible&&("mousedown"===s&&a[n]._activate.call(a[n],i),a[n].offset=a[n].element.offset(),a[n].proportions({width:a[n].element[0].offsetWidth,height:a[n].element[0].offsetHeight}))}},drop:function(t,i){var n=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance)&&(n=this._drop.call(this,i)||n),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),n},dragStart:function(t,i){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)})},drag:function(t,i){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,i),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var n,o,a,s=e.ui.intersect(t,this,this.options.tolerance),r=!s&&this.isover?"isout":s&&!this.isover?"isover":null;r&&(this.options.greedy&&(o=this.options.scope,a=this.element.parents(":data(ui-droppable)").filter(function(){return e(this).droppable("instance").options.scope===o}),a.length&&(n=e(a[0]).droppable("instance"),n.greedyChild="isover"===r)),n&&"isover"===r&&(n.isover=!1,n.isout=!0,n._out.call(n,i)),this[r]=!0,this["isout"===r?"isover":"isout"]=!1,this["isover"===r?"_over":"_out"].call(this,i),n&&"isout"===r&&(n.isout=!1,n.isover=!0,n._over.call(n,i)))}})},dragStop:function(t,i){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)}};e.ui.droppable;e.widget("ui.resizable",e.ui.mouse,{version:"1.11.0",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(e){return parseInt(e,10)||0},_isNumber:function(e){return!isNaN(parseInt(e,10))},_hasScroll:function(t,i){if("hidden"===e(t).css("overflow"))return!1;var n=i&&"left"===i?"scrollLeft":"scrollTop",o=!1;return t[n]>0?!0:(t[n]=1,o=t[n]>0,t[n]=0,o)},_create:function(){var t,i,n,o,a,s=this,r=this.options;if(this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!r.aspectRatio,aspectRatio:r.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:r.helper||r.ghost||r.animate?r.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=r.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={},i=0;i<t.length;i++)n=e.trim(t[i]),a="ui-resizable-"+n,o=e("<div class='ui-resizable-handle "+a+"'></div>"),o.css({zIndex:r.zIndex}),"se"===n&&o.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[n]=".ui-resizable-"+n,this.element.append(o);this._renderAxis=function(t){var i,n,o,a;t=t||this.element;for(i in this.handles)this.handles[i].constructor===String&&(this.handles[i]=this.element.children(this.handles[i]).first().show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(n=e(this.handles[i],this.element),a=/sw|ne|nw|se|n|s/.test(i)?n.outerHeight():n.outerWidth(),o=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),t.css(o,a),this._proportionallyResize()),e(this.handles[i]).length},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){s.resizing||(this.className&&(o=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),s.axis=o&&o[1]?o[1]:"se")}),r.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){r.disabled||(e(this).removeClass("ui-resizable-autohide"),s._handles.show())}).mouseleave(function(){r.disabled||s.resizing||(e(this).addClass("ui-resizable-autohide"),s._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,i=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this
},_mouseCapture:function(t){var i,n,o=!1;for(i in this.handles)n=e(this.handles[i])[0],(n===t.target||e.contains(n,t.target))&&(o=!0);return!this.options.disabled&&o},_mouseStart:function(t){var i,n,o,a=this.options,s=this.element;return this.resizing=!0,this._renderProxy(),i=this._num(this.helper.css("left")),n=this._num(this.helper.css("top")),a.containment&&(i+=e(a.containment).scrollLeft()||0,n+=e(a.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:n},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:s.width(),height:s.height()},this.originalSize=this._helper?{width:s.outerWidth(),height:s.outerHeight()}:{width:s.width(),height:s.height()},this.originalPosition={left:i,top:n},this.sizeDiff={width:s.outerWidth()-s.width(),height:s.outerHeight()-s.height()},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof a.aspectRatio?a.aspectRatio:this.originalSize.width/this.originalSize.height||1,o=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"===o?this.axis+"-resize":o),s.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var i,n=this.helper,o={},a=this.originalMousePosition,s=this.axis,r=t.pageX-a.left||0,l=t.pageY-a.top||0,p=this._change[s];return this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height},p?(i=p.apply(this,[t,r,l]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(i=this._updateRatio(i,t)),i=this._respectSize(i,t),this._updateCache(i),this._propagate("resize",t),this.position.top!==this.prevPosition.top&&(o.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(o.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(o.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(o.height=this.size.height+"px"),n.css(o),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(o)||this._trigger("resize",t,this.ui()),!1):!1},_mouseStop:function(t){this.resizing=!1;var i,n,o,a,s,r,l,p=this.options,h=this;return this._helper&&(i=this._proportionallyResizeElements,n=i.length&&/textarea/i.test(i[0].nodeName),o=n&&this._hasScroll(i[0],"left")?0:h.sizeDiff.height,a=n?0:h.sizeDiff.width,s={width:h.helper.width()-a,height:h.helper.height()-o},r=parseInt(h.element.css("left"),10)+(h.position.left-h.originalPosition.left)||null,l=parseInt(h.element.css("top"),10)+(h.position.top-h.originalPosition.top)||null,p.animate||this.element.css(e.extend(s,{top:l,left:r})),h.helper.height(h.size.height),h.helper.width(h.size.width),this._helper&&!p.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(e){var t,i,n,o,a,s=this.options;a={minWidth:this._isNumber(s.minWidth)?s.minWidth:0,maxWidth:this._isNumber(s.maxWidth)?s.maxWidth:1/0,minHeight:this._isNumber(s.minHeight)?s.minHeight:0,maxHeight:this._isNumber(s.maxHeight)?s.maxHeight:1/0},(this._aspectRatio||e)&&(t=a.minHeight*this.aspectRatio,n=a.minWidth/this.aspectRatio,i=a.maxHeight*this.aspectRatio,o=a.maxWidth/this.aspectRatio,t>a.minWidth&&(a.minWidth=t),n>a.minHeight&&(a.minHeight=n),i<a.maxWidth&&(a.maxWidth=i),o<a.maxHeight&&(a.maxHeight=o)),this._vBoundaries=a},_updateCache:function(e){this.offset=this.helper.offset(),this._isNumber(e.left)&&(this.position.left=e.left),this._isNumber(e.top)&&(this.position.top=e.top),this._isNumber(e.height)&&(this.size.height=e.height),this._isNumber(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,i=this.size,n=this.axis;return this._isNumber(e.height)?e.width=e.height*this.aspectRatio:this._isNumber(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===n&&(e.left=t.left+(i.width-e.width),e.top=null),"nw"===n&&(e.top=t.top+(i.height-e.height),e.left=t.left+(i.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,i=this.axis,n=this._isNumber(e.width)&&t.maxWidth&&t.maxWidth<e.width,o=this._isNumber(e.height)&&t.maxHeight&&t.maxHeight<e.height,a=this._isNumber(e.width)&&t.minWidth&&t.minWidth>e.width,s=this._isNumber(e.height)&&t.minHeight&&t.minHeight>e.height,r=this.originalPosition.left+this.originalSize.width,l=this.position.top+this.size.height,p=/sw|nw|w/.test(i),h=/nw|ne|n/.test(i);return a&&(e.width=t.minWidth),s&&(e.height=t.minHeight),n&&(e.width=t.maxWidth),o&&(e.height=t.maxHeight),a&&p&&(e.left=r-t.minWidth),n&&p&&(e.left=r-t.maxWidth),s&&h&&(e.top=l-t.minHeight),o&&h&&(e.top=l-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var e,t,i,n,o,a=this.helper||this.element;for(e=0;e<this._proportionallyResizeElements.length;e++){if(o=this._proportionallyResizeElements[e],!this.borderDif)for(this.borderDif=[],i=[o.css("borderTopWidth"),o.css("borderRightWidth"),o.css("borderBottomWidth"),o.css("borderLeftWidth")],n=[o.css("paddingTop"),o.css("paddingRight"),o.css("paddingBottom"),o.css("paddingLeft")],t=0;t<i.length;t++)this.borderDif[t]=(parseInt(i[t],10)||0)+(parseInt(n[t],10)||0);o.css({height:a.height()-this.borderDif[0]-this.borderDif[2]||0,width:a.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var t=this.element,i=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var i=this.originalSize,n=this.originalPosition;return{left:n.left+t,width:i.width-t}},n:function(e,t,i){var n=this.originalSize,o=this.originalPosition;return{top:o.top+i,height:n.height-i}},s:function(e,t,i){return{height:this.originalSize.height+i}},se:function(t,i,n){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,i,n]))},sw:function(t,i,n){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,i,n]))},ne:function(t,i,n){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,i,n]))},nw:function(t,i,n){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,i,n]))}},_propagate:function(t,i){e.ui.plugin.call(this,t,[i,this.ui()]),"resize"!==t&&this._trigger(t,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition,prevSize:this.prevSize,prevPosition:this.prevPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var i=e(this).resizable("instance"),n=i.options,o=i._proportionallyResizeElements,a=o.length&&/textarea/i.test(o[0].nodeName),s=a&&i._hasScroll(o[0],"left")?0:i.sizeDiff.height,r=a?0:i.sizeDiff.width,l={width:i.size.width-r,height:i.size.height-s},p=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,h=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(e.extend(l,h&&p?{top:h,left:p}:{}),{duration:n.animateDuration,easing:n.animateEasing,step:function(){var n={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};o&&o.length&&e(o[0]).css({width:n.width,height:n.height}),i._updateCache(n),i._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var t,i,n,o,a,s,r,l=e(this).resizable("instance"),p=l.options,h=l.element,d=p.containment,c=d instanceof e?d.get(0):/parent/.test(d)?h.parent().get(0):d;c&&(l.containerElement=e(c),/document/.test(d)||d===document?(l.containerOffset={left:0,top:0},l.containerPosition={left:0,top:0},l.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(t=e(c),i=[],e(["Top","Right","Left","Bottom"]).each(function(e,n){i[e]=l._num(t.css("padding"+n))}),l.containerOffset=t.offset(),l.containerPosition=t.position(),l.containerSize={height:t.innerHeight()-i[3],width:t.innerWidth()-i[1]},n=l.containerOffset,o=l.containerSize.height,a=l.containerSize.width,s=l._hasScroll(c,"left")?c.scrollWidth:a,r=l._hasScroll(c)?c.scrollHeight:o,l.parentData={element:c,left:n.left,top:n.top,width:s,height:r}))},resize:function(t,i){var n,o,a,s,r=e(this).resizable("instance"),l=r.options,p=r.containerOffset,h=r.position,d=r._aspectRatio||t.shiftKey,c={top:0,left:0},u=r.containerElement,f=!0;u[0]!==document&&/static/.test(u.css("position"))&&(c=p),h.left<(r._helper?p.left:0)&&(r.size.width=r.size.width+(r._helper?r.position.left-p.left:r.position.left-c.left),d&&(r.size.height=r.size.width/r.aspectRatio,f=!1),r.position.left=l.helper?p.left:0),h.top<(r._helper?p.top:0)&&(r.size.height=r.size.height+(r._helper?r.position.top-p.top:r.position.top),d&&(r.size.width=r.size.height*r.aspectRatio,f=!1),r.position.top=r._helper?p.top:0),r.offset.left=r.parentData.left+r.position.left,r.offset.top=r.parentData.top+r.position.top,n=Math.abs((r._helper?r.offset.left-c.left:r.offset.left-p.left)+r.sizeDiff.width),o=Math.abs((r._helper?r.offset.top-c.top:r.offset.top-p.top)+r.sizeDiff.height),a=r.containerElement.get(0)===r.element.parent().get(0),s=/relative|absolute/.test(r.containerElement.css("position")),a&&s&&(n-=Math.abs(r.parentData.left)),n+r.size.width>=r.parentData.width&&(r.size.width=r.parentData.width-n,d&&(r.size.height=r.size.width/r.aspectRatio,f=!1)),o+r.size.height>=r.parentData.height&&(r.size.height=r.parentData.height-o,d&&(r.size.width=r.size.height*r.aspectRatio,f=!1)),f||(r.position.left=i.prevPosition.left,r.position.top=i.prevPosition.top,r.size.width=i.prevSize.width,r.size.height=i.prevSize.height)},stop:function(){var t=e(this).resizable("instance"),i=t.options,n=t.containerOffset,o=t.containerPosition,a=t.containerElement,s=e(t.helper),r=s.offset(),l=s.outerWidth()-t.sizeDiff.width,p=s.outerHeight()-t.sizeDiff.height;t._helper&&!i.animate&&/relative/.test(a.css("position"))&&e(this).css({left:r.left-o.left-n.left,width:l,height:p}),t._helper&&!i.animate&&/static/.test(a.css("position"))&&e(this).css({left:r.left-o.left-n.left,width:l,height:p})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).resizable("instance"),i=t.options,n=function(t){e(t).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};"object"!=typeof i.alsoResize||i.alsoResize.parentNode?n(i.alsoResize):i.alsoResize.length?(i.alsoResize=i.alsoResize[0],n(i.alsoResize)):e.each(i.alsoResize,function(e){n(e)})},resize:function(t,i){var n=e(this).resizable("instance"),o=n.options,a=n.originalSize,s=n.originalPosition,r={height:n.size.height-a.height||0,width:n.size.width-a.width||0,top:n.position.top-s.top||0,left:n.position.left-s.left||0},l=function(t,n){e(t).each(function(){var t=e(this),o=e(this).data("ui-resizable-alsoresize"),a={},s=n&&n.length?n:t.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(s,function(e,t){var i=(o[t]||0)+(r[t]||0);i&&i>=0&&(a[t]=i||null)}),t.css(a)})};"object"!=typeof o.alsoResize||o.alsoResize.nodeType?l(o.alsoResize):e.each(o.alsoResize,function(e,t){l(e,t)})},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).resizable("instance"),i=t.options,n=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:n.height,width:n.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).resizable("instance");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).resizable("instance");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t=e(this).resizable("instance"),i=t.options,n=t.size,o=t.originalSize,a=t.originalPosition,s=t.axis,r="number"==typeof i.grid?[i.grid,i.grid]:i.grid,l=r[0]||1,p=r[1]||1,h=Math.round((n.width-o.width)/l)*l,d=Math.round((n.height-o.height)/p)*p,c=o.width+h,u=o.height+d,f=i.maxWidth&&i.maxWidth<c,g=i.maxHeight&&i.maxHeight<u,m=i.minWidth&&i.minWidth>c,_=i.minHeight&&i.minHeight>u;i.grid=r,m&&(c+=l),_&&(u+=p),f&&(c-=l),g&&(u-=p),/^(se|s|e)$/.test(s)?(t.size.width=c,t.size.height=u):/^(ne)$/.test(s)?(t.size.width=c,t.size.height=u,t.position.top=a.top-d):/^(sw)$/.test(s)?(t.size.width=c,t.size.height=u,t.position.left=a.left-h):(u-p>0?(t.size.height=u,t.position.top=a.top-d):(t.size.height=p,t.position.top=a.top+o.height-p),c-l>0?(t.size.width=c,t.position.left=a.left-h):(t.size.width=l,t.position.left=a.left+o.width-l))}});e.ui.resizable,e.widget("ui.selectable",e.ui.mouse,{version:"1.11.0",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t,i=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t=e(i.options.filter,i.element[0]),t.addClass("ui-selectee"),t.each(function(){var t=e(this),i=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:i.left,top:i.top,right:i.left+t.outerWidth(),bottom:i.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=t.addClass("ui-selectee"),this._mouseInit(),this.helper=e("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(t){var i=this,n=this.options;this.opos=[t.pageX,t.pageY],this.options.disabled||(this.selectees=e(n.filter,this.element[0]),this._trigger("start",t),e(n.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),n.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var n=e.data(this,"selectable-item");n.startselected=!0,t.metaKey||t.ctrlKey||(n.$element.removeClass("ui-selected"),n.selected=!1,n.$element.addClass("ui-unselecting"),n.unselecting=!0,i._trigger("unselecting",t,{unselecting:n.element}))}),e(t.target).parents().addBack().each(function(){var n,o=e.data(this,"selectable-item");return o?(n=!t.metaKey&&!t.ctrlKey||!o.$element.hasClass("ui-selected"),o.$element.removeClass(n?"ui-unselecting":"ui-selected").addClass(n?"ui-selecting":"ui-unselecting"),o.unselecting=!n,o.selecting=n,o.selected=n,n?i._trigger("selecting",t,{selecting:o.element}):i._trigger("unselecting",t,{unselecting:o.element}),!1):void 0}))},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){var i,n=this,o=this.options,a=this.opos[0],s=this.opos[1],r=t.pageX,l=t.pageY;return a>r&&(i=r,r=a,a=i),s>l&&(i=l,l=s,s=i),this.helper.css({left:a,top:s,width:r-a,height:l-s}),this.selectees.each(function(){var i=e.data(this,"selectable-item"),p=!1;i&&i.element!==n.element[0]&&("touch"===o.tolerance?p=!(i.left>r||i.right<a||i.top>l||i.bottom<s):"fit"===o.tolerance&&(p=i.left>a&&i.right<r&&i.top>s&&i.bottom<l),p?(i.selected&&(i.$element.removeClass("ui-selected"),i.selected=!1),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=!1),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=!0,n._trigger("selecting",t,{selecting:i.element}))):(i.selecting&&((t.metaKey||t.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.$element.addClass("ui-selected"),i.selected=!0):(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=!0),n._trigger("unselecting",t,{unselecting:i.element}))),i.selected&&(t.metaKey||t.ctrlKey||i.startselected||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,n._trigger("unselecting",t,{unselecting:i.element})))))}),!1}},_mouseStop:function(t){var i=this;return this.dragged=!1,e(".ui-unselecting",this.element[0]).each(function(){var n=e.data(this,"selectable-item");n.$element.removeClass("ui-unselecting"),n.unselecting=!1,n.startselected=!1,i._trigger("unselected",t,{unselected:n.element})}),e(".ui-selecting",this.element[0]).each(function(){var n=e.data(this,"selectable-item");n.$element.removeClass("ui-selecting").addClass("ui-selected"),n.selecting=!1,n.selected=!0,n.startselected=!0,i._trigger("selected",t,{selected:n.element})}),this._trigger("stop",t),this.helper.remove(),!1}}),e.widget("ui.sortable",e.ui.mouse,{version:"1.11.0",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,i){return e>=t&&t+i>e},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===e.axis||this._isFloating(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),e.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,i){var n=null,o=!1,a=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(t),e(t.target).parents().each(function(){return e.data(this,a.widgetName+"-item")===a?(n=e(this),!1):void 0}),e.data(t.target,a.widgetName+"-item")===a&&(n=e(t.target)),n&&(!this.options.handle||i||(e(this.options.handle,n).find("*").addBack().each(function(){this===t.target&&(o=!0)}),o))?(this.currentItem=n,this._removeCurrentsFromItems(),!0):!1)},_mouseStart:function(t,i,n){var o,a,s=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,s.cursorAt&&this._adjustOffsetFromHelper(s.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),s.containment&&this._setContainment(),s.cursor&&"auto"!==s.cursor&&(a=this.document.find("body"),this.storedCursor=a.css("cursor"),a.css("cursor",s.cursor),this.storedStylesheet=e("<style>*{ cursor: "+s.cursor+" !important; }</style>").appendTo(a)),s.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",s.opacity)),s.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",s.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!n)for(o=this.containers.length-1;o>=0;o--)this.containers[o]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!s.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var i,n,o,a,s=this.options,r=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<s.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+s.scrollSpeed:t.pageY-this.overflowOffset.top<s.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-s.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<s.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+s.scrollSpeed:t.pageX-this.overflowOffset.left<s.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-s.scrollSpeed)):(t.pageY-e(document).scrollTop()<s.scrollSensitivity?r=e(document).scrollTop(e(document).scrollTop()-s.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<s.scrollSensitivity&&(r=e(document).scrollTop(e(document).scrollTop()+s.scrollSpeed)),t.pageX-e(document).scrollLeft()<s.scrollSensitivity?r=e(document).scrollLeft(e(document).scrollLeft()-s.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<s.scrollSensitivity&&(r=e(document).scrollLeft(e(document).scrollLeft()+s.scrollSpeed))),r!==!1&&e.ui.ddmanager&&!s.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(n=this.items[i],o=n.item[0],a=this._intersectsWithPointer(n),a&&n.instance===this.currentContainer&&o!==this.currentItem[0]&&this.placeholder[1===a?"next":"prev"]()[0]!==o&&!e.contains(this.placeholder[0],o)&&("semi-dynamic"===this.options.type?!e.contains(this.element[0],o):!0)){if(this.direction=1===a?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(n))break;this._rearrange(t,n),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,i){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var n=this,o=this.placeholder.offset(),a=this.options.axis,s={};a&&"x"!==a||(s.left=o.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),a&&"y"!==a||(s.top=o.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(s,parseInt(this.options.revert,10)||500,function(){n._clear(t)})}else this._clear(t,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var i=this._getItemsAsjQuery(t&&t.connected),n=[];return t=t||{},e(i).each(function(){var i=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);i&&n.push((t.key||i[1]+"[]")+"="+(t.key&&t.expression?i[1]:i[2]))}),!n.length&&t.key&&n.push(t.key+"="),n.join("&")},toArray:function(t){var i=this._getItemsAsjQuery(t&&t.connected),n=[];return t=t||{},i.each(function(){n.push(e(t.item||this).attr(t.attribute||"id")||"")}),n},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,n=this.positionAbs.top,o=n+this.helperProportions.height,a=e.left,s=a+e.width,r=e.top,l=r+e.height,p=this.offset.click.top,h=this.offset.click.left,d="x"===this.options.axis||n+p>r&&l>n+p,c="y"===this.options.axis||t+h>a&&s>t+h,u=d&&c;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?u:a<t+this.helperProportions.width/2&&i-this.helperProportions.width/2<s&&r<n+this.helperProportions.height/2&&o-this.helperProportions.height/2<l},_intersectsWithPointer:function(e){var t="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),i="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),n=t&&i,o=this._getDragVerticalDirection(),a=this._getDragHorizontalDirection();return n?this.floating?a&&"right"===a||"down"===o?2:1:o&&("down"===o?2:1):!1},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),n=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return this.floating&&o?"right"===o&&i||"left"===o&&!i:n&&("down"===n&&t||"up"===n&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){function i(){r.push(this)}var n,o,a,s,r=[],l=[],p=this._connectWith();if(p&&t)for(n=p.length-1;n>=0;n--)for(a=e(p[n]),o=a.length-1;o>=0;o--)s=e.data(a[o],this.widgetFullName),s&&s!==this&&!s.options.disabled&&l.push([e.isFunction(s.options.items)?s.options.items.call(s.element):e(s.options.items,s.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),s]);for(l.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),n=l.length-1;n>=0;n--)l[n][0].each(i);return e(r)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var i=0;i<t.length;i++)if(t[i]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var i,n,o,a,s,r,l,p,h=this.items,d=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],c=this._connectWith();if(c&&this.ready)for(i=c.length-1;i>=0;i--)for(o=e(c[i]),n=o.length-1;n>=0;n--)a=e.data(o[n],this.widgetFullName),a&&a!==this&&!a.options.disabled&&(d.push([e.isFunction(a.options.items)?a.options.items.call(a.element[0],t,{item:this.currentItem}):e(a.options.items,a.element),a]),this.containers.push(a));for(i=d.length-1;i>=0;i--)for(s=d[i][1],r=d[i][0],n=0,p=r.length;p>n;n++)l=e(r[n]),l.data(this.widgetName+"-item",s),h.push({item:l,instance:s,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,n,o,a;for(i=this.items.length-1;i>=0;i--)n=this.items[i],n.instance!==this.currentContainer&&this.currentContainer&&n.item[0]!==this.currentItem[0]||(o=this.options.toleranceElement?e(this.options.toleranceElement,n.item):n.item,t||(n.width=o.outerWidth(),n.height=o.outerHeight()),a=o.offset(),n.left=a.left,n.top=a.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)a=this.containers[i].element.offset(),this.containers[i].containerCache.left=a.left,this.containers[i].containerCache.top=a.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var i,n=t.options;n.placeholder&&n.placeholder.constructor!==String||(i=n.placeholder,n.placeholder={element:function(){var n=t.currentItem[0].nodeName.toLowerCase(),o=e("<"+n+">",t.document[0]).addClass(i||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===n?t.currentItem.children().each(function(){e("<td>&#160;</td>",t.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(o)}):"img"===n&&o.attr("src",t.currentItem.attr("src")),i||o.css("visibility","hidden"),o},update:function(e,o){(!i||n.forcePlaceholderSize)&&(o.height()||o.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),o.width()||o.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(n.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),n.placeholder.update(t,t.placeholder)},_contactContainers:function(t){var i,n,o,a,s,r,l,p,h,d,c=null,u=null;for(i=this.containers.length-1;i>=0;i--)if(!e.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(c&&e.contains(this.containers[i].element[0],c.element[0]))continue;c=this.containers[i],u=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",t,this._uiHash(this)),this.containers[i].containerCache.over=0);if(c)if(1===this.containers.length)this.containers[u].containerCache.over||(this.containers[u]._trigger("over",t,this._uiHash(this)),this.containers[u].containerCache.over=1);
else{for(o=1e4,a=null,h=c.floating||this._isFloating(this.currentItem),s=h?"left":"top",r=h?"width":"height",d=h?"clientX":"clientY",n=this.items.length-1;n>=0;n--)e.contains(this.containers[u].element[0],this.items[n].item[0])&&this.items[n].item[0]!==this.currentItem[0]&&(l=this.items[n].item.offset()[s],p=!1,t[d]-l>this.items[n][r]/2&&(p=!0),Math.abs(t[d]-l)<o&&(o=Math.abs(t[d]-l),a=this.items[n],this.direction=p?"up":"down"));if(!a&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[u])return;a?this._rearrange(t,a,null,!0):this._rearrange(t,null,this.containers[u].element,!0),this._trigger("change",t,this._uiHash()),this.containers[u]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[u],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[u]._trigger("over",t,this._uiHash(this)),this.containers[u].containerCache.over=1}},_createHelper:function(t){var i=this.options,n=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return n.parents("body").length||e("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(n[0]),n[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!n[0].style.width||i.forceHelperSize)&&n.width(this.currentItem.width()),(!n[0].style.height||i.forceHelperSize)&&n.height(this.currentItem.height()),n},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,n,o=this.options;"parent"===o.containment&&(o.containment=this.helper[0].parentNode),("document"===o.containment||"window"===o.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e("document"===o.containment?document:window).width()-this.helperProportions.width-this.margins.left,(e("document"===o.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(o.containment)||(t=e(o.containment)[0],i=e(o.containment).offset(),n="hidden"!==e(t).css("overflow"),this.containment=[i.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,i.left+(n?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(n?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,i){i||(i=this.position);var n="absolute"===t?1:-1,o="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(o[0].tagName);return{top:i.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():a?0:o.scrollTop())*n,left:i.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():a?0:o.scrollLeft())*n}},_generatePosition:function(t){var i,n,o=this.options,a=t.pageX,s=t.pageY,r="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(r[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(a=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(s=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(a=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(s=this.containment[3]+this.offset.click.top)),o.grid&&(i=this.originalPageY+Math.round((s-this.originalPageY)/o.grid[1])*o.grid[1],s=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-o.grid[1]:i+o.grid[1]:i,n=this.originalPageX+Math.round((a-this.originalPageX)/o.grid[0])*o.grid[0],a=this.containment?n-this.offset.click.left>=this.containment[0]&&n-this.offset.click.left<=this.containment[2]?n:n-this.offset.click.left>=this.containment[0]?n-o.grid[0]:n+o.grid[0]:n)),{top:s-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:r.scrollTop()),left:a-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:r.scrollLeft())}},_rearrange:function(e,t,i,n){i?i[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var o=this.counter;this._delay(function(){o===this.counter&&this.refreshPositions(!n)})},_clear:function(e,t){function i(e,t,i){return function(n){i._trigger(e,n,t._uiHash(t))}}this.reverting=!1;var n,o=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(n in this._storedCSS)("auto"===this._storedCSS[n]||"static"===this._storedCSS[n])&&(this._storedCSS[n]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&o.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||o.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(o.push(function(e){this._trigger("remove",e,this._uiHash())}),o.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),o.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),n=this.containers.length-1;n>=0;n--)t||o.push(i("deactivate",this,this.containers[n])),this.containers[n].containerCache.over&&(o.push(i("out",this,this.containers[n])),this.containers[n].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!t){for(this._trigger("beforeStop",e,this._uiHash()),n=0;n<o.length;n++)o[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!1}if(t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!t){for(n=0;n<o.length;n++)o[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var i=t||this;return{helper:i.helper,placeholder:i.placeholder||e([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:t?t.element:null}}}),e.widget("ui.accordion",{version:"1.11.0",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var t=this.options;this.prevShow=this.prevHide=e(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),t.collapsible||t.active!==!1&&null!=t.active||(t.active=0),this._processPanels(),t.active<0&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():e()}},_createIcons:function(){var t=this.options.icons;t&&(e("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId(),this._destroyIcons(),e=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){return"active"===e?void this._activate(t):("event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"!==e||t||this.options.active!==!1||this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons()),void("disabled"===e&&(this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t))))},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var i=e.ui.keyCode,n=this.headers.length,o=this.headers.index(t.target),a=!1;switch(t.keyCode){case i.RIGHT:case i.DOWN:a=this.headers[(o+1)%n];break;case i.LEFT:case i.UP:a=this.headers[(o-1+n)%n];break;case i.SPACE:case i.ENTER:this._eventHandler(t);break;case i.HOME:a=this.headers[0];break;case i.END:a=this.headers[n-1]}a&&(e(t.target).attr("tabIndex",-1),e(a).attr("tabIndex",0),a.focus(),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().focus()},refresh:function(){var t=this.options;this._processPanels(),t.active===!1&&t.collapsible===!0||!this.headers.length?(t.active=!1,this.active=e()):t.active===!1?this._activate(0):this.active.length&&!e.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=e()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all"),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var t,i=this.options,n=i.heightStyle,o=this.element.parent();this.active=this._findActive(i.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(){var t=e(this),i=t.uniqueId().attr("id"),n=t.next(),o=n.uniqueId().attr("id");t.attr("aria-controls",o),n.attr("aria-labelledby",i)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(i.event),"fill"===n?(t=o.height(),this.element.siblings(":visible").each(function(){var i=e(this),n=i.css("position");"absolute"!==n&&"fixed"!==n&&(t-=i.outerHeight(!0))}),this.headers.each(function(){t-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,t-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===n&&(t=0,this.headers.next().each(function(){t=Math.max(t,e(this).css("height","").height())}).height(t))},_activate:function(t){var i=this._findActive(t)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):e()},_setupEvents:function(t){var i={keydown:"_keydown"};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var i=this.options,n=this.active,o=e(t.currentTarget),a=o[0]===n[0],s=a&&i.collapsible,r=s?e():o.next(),l=n.next(),p={oldHeader:n,oldPanel:l,newHeader:s?e():o,newPanel:r};t.preventDefault(),a&&!i.collapsible||this._trigger("beforeActivate",t,p)===!1||(i.active=s?!1:this.headers.index(o),this.active=a?e():o,this._toggle(p),n.removeClass("ui-accordion-header-active ui-state-active"),i.icons&&n.children(".ui-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header),a||(o.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),i.icons&&o.children(".ui-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader),o.next().addClass("ui-accordion-content-active")))},_toggle:function(t){var i=t.newPanel,n=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=n,this.options.animate?this._animate(i,n,t):(n.hide(),i.show(),this._toggleComplete(t)),n.attr({"aria-hidden":"true"}),n.prev().attr("aria-selected","false"),i.length&&n.length?n.prev().attr({tabIndex:-1,"aria-expanded":"false"}):i.length&&this.headers.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),i.attr("aria-hidden","false").prev().attr({"aria-selected":"true",tabIndex:0,"aria-expanded":"true"})},_animate:function(e,t,i){var n,o,a,s=this,r=0,l=e.length&&(!t.length||e.index()<t.index()),p=this.options.animate||{},h=l&&p.down||p,d=function(){s._toggleComplete(i)};return"number"==typeof h&&(a=h),"string"==typeof h&&(o=h),o=o||h.easing||p.easing,a=a||h.duration||p.duration,t.length?e.length?(n=e.show().outerHeight(),t.animate(this.hideProps,{duration:a,easing:o,step:function(e,t){t.now=Math.round(e)}}),void e.hide().animate(this.showProps,{duration:a,easing:o,complete:d,step:function(e,i){i.now=Math.round(e),"height"!==i.prop?r+=i.now:"content"!==s.options.heightStyle&&(i.now=Math.round(n-t.outerHeight()-r),r=0)}})):t.animate(this.hideProps,a,o,d):e.animate(this.showProps,a,o,d)},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}}),e.widget("ui.menu",{version:"1.11.0",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(e){e.preventDefault()},"click .ui-menu-item":function(t){var i=e(t.target);!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),i.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&e(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){var i=e(t.currentTarget);i.siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(t,i)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var i=this.active||this.element.find(this.options.items).eq(0);t||this.focus(e,i)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){this._closeOnDocumentClick(e)&&this.collapseAll(e),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){function i(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var n,o,a,s,r,l=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:l=!1,o=this.previousFilter||"",a=String.fromCharCode(t.keyCode),s=!1,clearTimeout(this.filterTimer),a===o?s=!0:a=o+a,r=new RegExp("^"+i(a),"i"),n=this.activeMenu.find(this.options.items).filter(function(){return r.test(e(this).text())}),n=s&&-1!==n.index(this.active.next())?this.active.nextAll(".ui-menu-item"):n,n.length||(a=String.fromCharCode(t.keyCode),r=new RegExp("^"+i(a),"i"),n=this.activeMenu.find(this.options.items).filter(function(){return r.test(e(this).text())})),n.length?(this.focus(t,n),n.length>1?(this.previousFilter=a,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}l&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(e):this.select(e))},refresh:function(){var t,i,n=this,o=this.options.icons.submenu,a=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),a.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),i=t.parent(),n=e("<span>").addClass("ui-menu-icon ui-icon "+o).data("ui-menu-submenu-carat",!0);i.attr("aria-haspopup","true").prepend(n),t.attr("aria-labelledby",i.attr("id"))}),t=a.add(this.element),i=t.find(this.options.items),i.not(".ui-menu-item").each(function(){var t=e(this);n._isDivider(t)&&t.addClass("ui-widget-content ui-menu-divider")}),i.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),i.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},focus:function(e,t){var i,n;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),n=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",n.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=t.children(".ui-menu"),i.length&&e&&/^mouse/.test(e.type)&&this._startOpening(i),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var i,n,o,a,s,r;this._hasScroll()&&(i=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,n=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,o=t.offset().top-this.activeMenu.offset().top-i-n,a=this.activeMenu.scrollTop(),s=this.activeMenu.height(),r=t.outerHeight(),0>o?this.activeMenu.scrollTop(a+o):o+r>s&&this.activeMenu.scrollTop(a+o-s+r))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var i=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(t,i){clearTimeout(this.timer),this.timer=this._delay(function(){var n=i?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));n.length||(n=this.element),this._close(n),this.blur(t),this.activeMenu=n},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(t){return!e(t.target).closest(".ui-menu").length},_isDivider:function(e){return!/[^\-\u2014\u2013\s]/.test(e.text())},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,i){var n;this.active&&(n="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),n&&n.length&&this.active||(n=this.activeMenu.find(this.options.items)[t]()),this.focus(i,n)},nextPage:function(t){var i,n,o;return this.active?void(this.isLastItem()||(this._hasScroll()?(n=this.active.offset().top,o=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=e(this),i.offset().top-n-o<0}),this.focus(t,i)):this.focus(t,this.activeMenu.find(this.options.items)[this.active?"last":"first"]()))):void this.next(t)},previousPage:function(t){var i,n,o;return this.active?void(this.isFirstItem()||(this._hasScroll()?(n=this.active.offset().top,o=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=e(this),i.offset().top-n+o>0}),this.focus(t,i)):this.focus(t,this.activeMenu.find(this.options.items).first()))):void this.next(t)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,i)}});e.widget("ui.autocomplete",{version:"1.11.0",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var t,i,n,o=this.element[0].nodeName.toLowerCase(),a="textarea"===o,s="input"===o;this.isMultiLine=a?!0:s?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[a||s?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(o){if(this.element.prop("readOnly"))return t=!0,n=!0,void(i=!0);t=!1,n=!1,i=!1;var a=e.ui.keyCode;switch(o.keyCode){case a.PAGE_UP:t=!0,this._move("previousPage",o);break;case a.PAGE_DOWN:t=!0,this._move("nextPage",o);break;case a.UP:t=!0,this._keyEvent("previous",o);break;case a.DOWN:t=!0,this._keyEvent("next",o);break;case a.ENTER:this.menu.active&&(t=!0,o.preventDefault(),this.menu.select(o));break;case a.TAB:this.menu.active&&this.menu.select(o);break;case a.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(o),o.preventDefault());break;default:i=!0,this._searchTimeout(o)}},keypress:function(n){if(t)return t=!1,void((!this.isMultiLine||this.menu.element.is(":visible"))&&n.preventDefault());if(!i){var o=e.ui.keyCode;switch(n.keyCode){case o.PAGE_UP:this._move("previousPage",n);break;case o.PAGE_DOWN:this._move("nextPage",n);break;case o.UP:this._keyEvent("previous",n);break;case o.DOWN:this._keyEvent("next",n)}}},input:function(e){return n?(n=!1,void e.preventDefault()):void this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(e),void this._change(e))}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(n){n.target===t.element[0]||n.target===i||e.contains(i,n.target)||t.close()})})},menufocus:function(t,i){var n,o;return this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type))?(this.menu.blur(),void this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)})):(o=i.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",t,{item:o})&&t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(o.value),n=i.item.attr("aria-label")||o.value,void(n&&jQuery.trim(n).length&&(this.liveRegion.children().hide(),e("<div>").text(n).appendTo(this.liveRegion))))},menuselect:function(e,t){var i=t.item.data("ui-autocomplete-item"),n=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=n,this._delay(function(){this.previous=n,this.selectedItem=i})),!1!==this._trigger("select",e,{item:i})&&this._value(i.value),this.term=this._value(),this.close(e),this.selectedItem=i}}),this.liveRegion=e("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,i,n=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(i,n){n(e.ui.autocomplete.filter(t,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(t,o){n.xhr&&n.xhr.abort(),n.xhr=e.ajax({url:i,data:t,dataType:"json",success:function(e){o(e)},error:function(){o([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){var t=this.term===this._value(),i=this.menu.element.is(":visible"),n=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey;(!t||t&&!i&&!n)&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):this._trigger("search",t)!==!1?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())
},_response:function(){var t=++this.requestIndex;return e.proxy(function(e){t===this.requestIndex&&this.__response(e),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({},t,{label:t.label||t.value,value:t.value||t.label})})},_suggest:function(t){var i=this.menu.element.empty();this._renderMenu(i,t),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,i){var n=this;e.each(i,function(e,i){n._renderItemData(t,i)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,i){return e("<li>").text(i.label).appendTo(t)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[e](t):void this.search(null,t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,i){var n=new RegExp(e.ui.autocomplete.escapeRegex(i),"i");return e.grep(t,function(e){return n.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var i;this._superApply(arguments),this.options.disabled||this.cancelSearch||(i=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,this.liveRegion.children().hide(),e("<div>").text(i).appendTo(this.liveRegion))}});var d,c=(e.ui.autocomplete,"ui-button ui-widget ui-state-default ui-corner-all"),u="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",f=function(){var t=e(this);setTimeout(function(){t.find(":ui-button").button("refresh")},1)},g=function(t){var i=t.name,n=t.form,o=e([]);return i&&(i=i.replace(/'/g,"\\'"),o=n?e(n).find("[name='"+i+"'][type=radio]"):e("[name='"+i+"'][type=radio]",t.ownerDocument).filter(function(){return!this.form})),o};e.widget("ui.button",{version:"1.11.0",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,f),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var t=this,i=this.options,n="checkbox"===this.type||"radio"===this.type,o=n?"":"ui-state-active";null===i.label&&(i.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(c).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){i.disabled||this===d&&e(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){i.disabled||e(this).removeClass(o)}).bind("click"+this.eventNamespace,function(e){i.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),n&&this.element.bind("change"+this.eventNamespace,function(){t.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return i.disabled?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(i.disabled)return!1;e(this).addClass("ui-state-active"),t.buttonElement.attr("aria-pressed","true");var n=t.element[0];g(n).not(n).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return i.disabled?!1:(e(this).addClass("ui-state-active"),d=this,void t.document.one("mouseup",function(){d=null}))}).bind("mouseup"+this.eventNamespace,function(){return i.disabled?!1:void e(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(t){return i.disabled?!1:void((t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption("disabled",i.disabled),this._resetButton()},_determineButtonType:function(){var e,t,i;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),i=this.element.is(":checked"),i&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(c+" ui-state-active "+u).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){return this._super(e,t),"disabled"===e?(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),void(t&&this.buttonElement.removeClass("checkbox"===this.type||"radio"===this.type?"ui-state-focus":"ui-state-focus ui-state-active"))):void this._resetButton()},refresh:function(){var t=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOption("disabled",t),"radio"===this.type?g(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return void(this.options.label&&this.element.val(this.options.label));var t=this.buttonElement.removeClass(u),i=e("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),n=this.options.icons,o=n.primary&&n.secondary,a=[];n.primary||n.secondary?(this.options.text&&a.push("ui-button-text-icon"+(o?"s":n.primary?"-primary":"-secondary")),n.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+n.primary+"'></span>"),n.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+n.secondary+"'></span>"),this.options.text||(a.push(o?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",e.trim(i)))):a.push("ui-button-text-only"),t.addClass(a.join(" "))}}),e.widget("ui.buttonset",{version:"1.11.0",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){"disabled"===e&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var t="rtl"===this.element.css("direction"),i=this.element.find(this.options.items),n=i.filter(":ui-button");i.not(":ui-button").button(),n.button("refresh"),this.buttons=i.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}});e.ui.button;e.extend(e.ui,{datepicker:{version:"1.11.0"}});var m;e.extend(o.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return s(this._defaults,e||{}),this},_attachDatepicker:function(t,i){var n,o,a;n=t.nodeName.toLowerCase(),o="div"===n||"span"===n,t.id||(this.uuid+=1,t.id="dp"+this.uuid),a=this._newInst(e(t),o),a.settings=e.extend({},i||{}),"input"===n?this._connectDatepicker(t,a):o&&this._inlineDatepicker(t,a)},_newInst:function(t,i){var n=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:n,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?a(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,i){var n=e(t);i.append=e([]),i.trigger=e([]),n.hasClass(this.markerClassName)||(this._attachments(n,i),n.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),e.data(t,"datepicker",i),i.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,i){var n,o,a,s=this._get(i,"appendText"),r=this._get(i,"isRTL");i.append&&i.append.remove(),s&&(i.append=e("<span class='"+this._appendClass+"'>"+s+"</span>"),t[r?"before":"after"](i.append)),t.unbind("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),n=this._get(i,"showOn"),("focus"===n||"both"===n)&&t.focus(this._showDatepicker),("button"===n||"both"===n)&&(o=this._get(i,"buttonText"),a=this._get(i,"buttonImage"),i.trigger=e(this._get(i,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:a,alt:o,title:o}):e("<button type='button'></button>").addClass(this._triggerClass).html(a?e("<img/>").attr({src:a,alt:o,title:o}):o)),t[r?"before":"after"](i.trigger),i.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1}))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,i,n,o,a=new Date(2009,11,20),s=this._get(e,"dateFormat");s.match(/[DM]/)&&(t=function(e){for(i=0,n=0,o=0;o<e.length;o++)e[o].length>i&&(i=e[o].length,n=o);return n},a.setMonth(t(this._get(e,s.match(/MM/)?"monthNames":"monthNamesShort"))),a.setDate(t(this._get(e,s.match(/DD/)?"dayNames":"dayNamesShort"))+20-a.getDay())),e.input.attr("size",this._formatDate(e,a).length)}},_inlineDatepicker:function(t,i){var n=e(t);n.hasClass(this.markerClassName)||(n.addClass(this.markerClassName).append(i.dpDiv),e.data(t,"datepicker",i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(t),i.dpDiv.css("display","block"))},_dialogDatepicker:function(t,i,n,o,a){var r,l,p,h,d,c=this._dialogInst;return c||(this.uuid+=1,r="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+r+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),c=this._dialogInst=this._newInst(this._dialogInput,!1),c.settings={},e.data(this._dialogInput[0],"datepicker",c)),s(c.settings,o||{}),i=i&&i.constructor===Date?this._formatDate(c,i):i,this._dialogInput.val(i),this._pos=a?a.length?a:[a.pageX,a.pageY]:null,this._pos||(l=document.documentElement.clientWidth,p=document.documentElement.clientHeight,h=document.documentElement.scrollLeft||document.body.scrollLeft,d=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[l/2-100+h,p/2-150+d]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),c.settings.onSelect=n,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],"datepicker",c),this},_destroyDatepicker:function(t){var i,n=e(t),o=e.data(t,"datepicker");n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),e.removeData(t,"datepicker"),"input"===i?(o.append.remove(),o.trigger.remove(),n.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===i||"span"===i)&&n.removeClass(this.markerClassName).empty())},_enableDatepicker:function(t){var i,n,o=e(t),a=e.data(t,"datepicker");o.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!1,a.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&(n=o.children("."+this._inlineClass),n.children().removeClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var i,n,o=e(t),a=e.data(t,"datepicker");o.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!0,a.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&(n=o.children("."+this._inlineClass),n.children().addClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,"datepicker")}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,i,n){var o,a,r,l,p=this._getInst(t);return 2===arguments.length&&"string"==typeof i?"defaults"===i?e.extend({},e.datepicker._defaults):p?"all"===i?e.extend({},p.settings):this._get(p,i):null:(o=i||{},"string"==typeof i&&(o={},o[i]=n),void(p&&(this._curInst===p&&this._hideDatepicker(),a=this._getDateDatepicker(t,!0),r=this._getMinMaxDate(p,"min"),l=this._getMinMaxDate(p,"max"),s(p.settings,o),null!==r&&void 0!==o.dateFormat&&void 0===o.minDate&&(p.settings.minDate=this._formatDate(p,r)),null!==l&&void 0!==o.dateFormat&&void 0===o.maxDate&&(p.settings.maxDate=this._formatDate(p,l)),"disabled"in o&&(o.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(e(t),p),this._autoSize(p),this._setDate(p,a),this._updateAlternate(p),this._updateDatepicker(p))))},_changeDatepicker:function(e,t,i){this._optionDatepicker(e,t,i)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var i=this._getInst(e);i&&(this._setDate(i,t),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(e,t){var i=this._getInst(e);return i&&!i.inline&&this._setDateFromField(i,t),i?this._getDate(i):null},_doKeyDown:function(t){var i,n,o,a=e.datepicker._getInst(t.target),s=!0,r=a.dpDiv.is(".ui-datepicker-rtl");if(a._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),s=!1;break;case 13:return o=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",a.dpDiv),o[0]&&e.datepicker._selectDay(t.target,a.selectedMonth,a.selectedYear,o[0]),i=e.datepicker._get(a,"onSelect"),i?(n=e.datepicker._formatDate(a),i.apply(a.input?a.input[0]:null,[n,a])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(a,"stepBigMonths"):-e.datepicker._get(a,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(a,"stepBigMonths"):+e.datepicker._get(a,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),s=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),s=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,r?1:-1,"D"),s=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(a,"stepBigMonths"):-e.datepicker._get(a,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),s=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,r?-1:1,"D"),s=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(a,"stepBigMonths"):+e.datepicker._get(a,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),s=t.ctrlKey||t.metaKey;break;default:s=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):s=!1;s&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var i,n,o=e.datepicker._getInst(t.target);return e.datepicker._get(o,"constrainInput")?(i=e.datepicker._possibleChars(e.datepicker._get(o,"dateFormat")),n=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||" ">n||!i||i.indexOf(n)>-1):void 0},_doKeyUp:function(t){var i,n=e.datepicker._getInst(t.target);if(n.input.val()!==n.lastVal)try{i=e.datepicker.parseDate(e.datepicker._get(n,"dateFormat"),n.input?n.input.val():null,e.datepicker._getFormatConfig(n)),i&&(e.datepicker._setDateFromField(n),e.datepicker._updateAlternate(n),e.datepicker._updateDatepicker(n))}catch(o){}return!0},_showDatepicker:function(t){if(t=t.target||t,"input"!==t.nodeName.toLowerCase()&&(t=e("input",t.parentNode)[0]),!e.datepicker._isDisabledDatepicker(t)&&e.datepicker._lastInput!==t){var i,o,a,r,l,p,h;i=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==i&&(e.datepicker._curInst.dpDiv.stop(!0,!0),i&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),o=e.datepicker._get(i,"beforeShow"),a=o?o.apply(t,[t,i]):{},a!==!1&&(s(i.settings,a),i.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(i),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),r=!1,e(t).parents().each(function(){return r|="fixed"===e(this).css("position"),!r}),l={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(i),l=e.datepicker._checkOffset(i,l,r),i.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":r?"fixed":"absolute",display:"none",left:l.left+"px",top:l.top+"px"}),i.inline||(p=e.datepicker._get(i,"showAnim"),h=e.datepicker._get(i,"duration"),i.dpDiv.css("z-index",n(e(t))+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[p]?i.dpDiv.show(p,e.datepicker._get(i,"showOptions"),h):i.dpDiv[p||"show"](p?h:null),e.datepicker._shouldFocusInput(i)&&i.input.focus(),e.datepicker._curInst=i))}},_updateDatepicker:function(t){this.maxRows=4,m=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t),t.dpDiv.find("."+this._dayOverClass+" a");var i,n=this._getNumberOfMonths(t),o=n[1],a=17;t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),o>1&&t.dpDiv.addClass("ui-datepicker-multi-"+o).css("width",a*o+"em"),t.dpDiv[(1!==n[0]||1!==n[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(i=t.yearshtml,setTimeout(function(){i===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),i=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,i,n){var o=t.dpDiv.outerWidth(),a=t.dpDiv.outerHeight(),s=t.input?t.input.outerWidth():0,r=t.input?t.input.outerHeight():0,l=document.documentElement.clientWidth+(n?0:e(document).scrollLeft()),p=document.documentElement.clientHeight+(n?0:e(document).scrollTop());return i.left-=this._get(t,"isRTL")?o-s:0,i.left-=n&&i.left===t.input.offset().left?e(document).scrollLeft():0,i.top-=n&&i.top===t.input.offset().top+r?e(document).scrollTop():0,i.left-=Math.min(i.left,i.left+o>l&&l>o?Math.abs(i.left+o-l):0),i.top-=Math.min(i.top,i.top+a>p&&p>a?Math.abs(a+r):0),i},_findPos:function(t){for(var i,n=this._getInst(t),o=this._get(n,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||e.expr.filters.hidden(t));)t=t[o?"previousSibling":"nextSibling"];return i=e(t).offset(),[i.left,i.top]},_hideDatepicker:function(t){var i,n,o,a,s=this._curInst;!s||t&&s!==e.data(t,"datepicker")||this._datepickerShowing&&(i=this._get(s,"showAnim"),n=this._get(s,"duration"),o=function(){e.datepicker._tidyDialog(s)},e.effects&&(e.effects.effect[i]||e.effects[i])?s.dpDiv.hide(i,e.datepicker._get(s,"showOptions"),n,o):s.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?n:null,o),i||o(),this._datepickerShowing=!1,a=this._get(s,"onClose"),a&&a.apply(s.input?s.input[0]:null,[s.input?s.input.val():"",s]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var i=e(t.target),n=e.datepicker._getInst(i[0]);(i[0].id!==e.datepicker._mainDivId&&0===i.parents("#"+e.datepicker._mainDivId).length&&!i.hasClass(e.datepicker.markerClassName)&&!i.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||i.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==n)&&e.datepicker._hideDatepicker()}},_adjustDate:function(t,i,n){var o=e(t),a=this._getInst(o[0]);this._isDisabledDatepicker(o[0])||(this._adjustInstDate(a,i+("M"===n?this._get(a,"showCurrentAtPos"):0),n),this._updateDatepicker(a))},_gotoToday:function(t){var i,n=e(t),o=this._getInst(n[0]);this._get(o,"gotoCurrent")&&o.currentDay?(o.selectedDay=o.currentDay,o.drawMonth=o.selectedMonth=o.currentMonth,o.drawYear=o.selectedYear=o.currentYear):(i=new Date,o.selectedDay=i.getDate(),o.drawMonth=o.selectedMonth=i.getMonth(),o.drawYear=o.selectedYear=i.getFullYear()),this._notifyChange(o),this._adjustDate(n)},_selectMonthYear:function(t,i,n){var o=e(t),a=this._getInst(o[0]);a["selected"+("M"===n?"Month":"Year")]=a["draw"+("M"===n?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(a),this._adjustDate(o)},_selectDay:function(t,i,n,o){var a,s=e(t);e(o).hasClass(this._unselectableClass)||this._isDisabledDatepicker(s[0])||(a=this._getInst(s[0]),a.selectedDay=a.currentDay=e("a",o).html(),a.selectedMonth=a.currentMonth=i,a.selectedYear=a.currentYear=n,this._selectDate(t,this._formatDate(a,a.currentDay,a.currentMonth,a.currentYear)))},_clearDate:function(t){var i=e(t);this._selectDate(i,"")},_selectDate:function(t,i){var n,o=e(t),a=this._getInst(o[0]);i=null!=i?i:this._formatDate(a),a.input&&a.input.val(i),this._updateAlternate(a),n=this._get(a,"onSelect"),n?n.apply(a.input?a.input[0]:null,[i,a]):a.input&&a.input.trigger("change"),a.inline?this._updateDatepicker(a):(this._hideDatepicker(),this._lastInput=a.input[0],"object"!=typeof a.input[0]&&a.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var i,n,o,a=this._get(t,"altField");a&&(i=this._get(t,"altFormat")||this._get(t,"dateFormat"),n=this._getDate(t),o=this.formatDate(i,n,this._getFormatConfig(t)),e(a).each(function(){e(this).val(o)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,""]},iso8601Week:function(e){var t,i=new Date(e.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),t=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((t-i)/864e5)/7)+1},parseDate:function(t,i,n){if(null==t||null==i)throw"Invalid arguments";if(i="object"==typeof i?i.toString():i+"",""===i)return null;var o,a,s,r,l=0,p=(n?n.shortYearCutoff:null)||this._defaults.shortYearCutoff,h="string"!=typeof p?p:(new Date).getFullYear()%100+parseInt(p,10),d=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,c=(n?n.dayNames:null)||this._defaults.dayNames,u=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,f=(n?n.monthNames:null)||this._defaults.monthNames,g=-1,m=-1,_=-1,w=-1,b=!1,v=function(e){var i=o+1<t.length&&t.charAt(o+1)===e;return i&&o++,i},y=function(e){var t=v(e),n="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,o=new RegExp("^\\d{1,"+n+"}"),a=i.substring(l).match(o);if(!a)throw"Missing number at position "+l;return l+=a[0].length,parseInt(a[0],10)},k=function(t,n,o){var a=-1,s=e.map(v(t)?o:n,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(e.each(s,function(e,t){var n=t[1];return i.substr(l,n.length).toLowerCase()===n.toLowerCase()?(a=t[0],l+=n.length,!1):void 0}),-1!==a)return a+1;throw"Unknown name at position "+l},x=function(){if(i.charAt(l)!==t.charAt(o))throw"Unexpected literal at position "+l;l++};for(o=0;o<t.length;o++)if(b)"'"!==t.charAt(o)||v("'")?x():b=!1;else switch(t.charAt(o)){case"d":_=y("d");break;case"D":k("D",d,c);break;case"o":w=y("o");break;case"m":m=y("m");break;case"M":m=k("M",u,f);break;case"y":g=y("y");break;case"@":r=new Date(y("@")),g=r.getFullYear(),m=r.getMonth()+1,_=r.getDate();break;case"!":r=new Date((y("!")-this._ticksTo1970)/1e4),g=r.getFullYear(),m=r.getMonth()+1,_=r.getDate();break;case"'":v("'")?x():b=!0;break;default:x()}if(l<i.length&&(s=i.substr(l),!/^\s+/.test(s)))throw"Extra/unparsed characters found in date: "+s;if(-1===g?g=(new Date).getFullYear():100>g&&(g+=(new Date).getFullYear()-(new Date).getFullYear()%100+(h>=g?0:-100)),w>-1)for(m=1,_=w;;){if(a=this._getDaysInMonth(g,m-1),a>=_)break;m++,_-=a}if(r=this._daylightSavingAdjust(new Date(g,m-1,_)),r.getFullYear()!==g||r.getMonth()+1!==m||r.getDate()!==_)throw"Invalid date";return r},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(e,t,i){if(!t)return"";var n,o=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,a=(i?i.dayNames:null)||this._defaults.dayNames,s=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,r=(i?i.monthNames:null)||this._defaults.monthNames,l=function(t){var i=n+1<e.length&&e.charAt(n+1)===t;return i&&n++,i},p=function(e,t,i){var n=""+t;if(l(e))for(;n.length<i;)n="0"+n;return n},h=function(e,t,i,n){return l(e)?n[t]:i[t]},d="",c=!1;if(t)for(n=0;n<e.length;n++)if(c)"'"!==e.charAt(n)||l("'")?d+=e.charAt(n):c=!1;else switch(e.charAt(n)){case"d":d+=p("d",t.getDate(),2);break;case"D":d+=h("D",t.getDay(),o,a);break;case"o":d+=p("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":d+=p("m",t.getMonth()+1,2);break;case"M":d+=h("M",t.getMonth(),s,r);break;case"y":d+=l("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":d+=t.getTime();break;case"!":d+=1e4*t.getTime()+this._ticksTo1970;break;case"'":l("'")?d+="'":c=!0;break;default:d+=e.charAt(n)}return d},_possibleChars:function(e){var t,i="",n=!1,o=function(i){var n=t+1<e.length&&e.charAt(t+1)===i;return n&&t++,n};for(t=0;t<e.length;t++)if(n)"'"!==e.charAt(t)||o("'")?i+=e.charAt(t):n=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":o("'")?i+="'":n=!0;break;default:i+=e.charAt(t)}return i},_get:function(e,t){return void 0!==e.settings[t]?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var i=this._get(e,"dateFormat"),n=e.lastVal=e.input?e.input.val():null,o=this._getDefaultDate(e),a=o,s=this._getFormatConfig(e);try{a=this.parseDate(i,n,s)||o}catch(r){n=t?"":n}e.selectedDay=a.getDate(),e.drawMonth=e.selectedMonth=a.getMonth(),e.drawYear=e.selectedYear=a.getFullYear(),e.currentDay=n?a.getDate():0,e.currentMonth=n?a.getMonth():0,e.currentYear=n?a.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,i,n){var o=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},a=function(i){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),i,e.datepicker._getFormatConfig(t))}catch(n){}for(var o=(i.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,a=o.getFullYear(),s=o.getMonth(),r=o.getDate(),l=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,p=l.exec(i);p;){switch(p[2]||"d"){case"d":case"D":r+=parseInt(p[1],10);break;case"w":case"W":r+=7*parseInt(p[1],10);break;case"m":case"M":s+=parseInt(p[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(a,s));break;case"y":case"Y":a+=parseInt(p[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(a,s))}p=l.exec(i)}return new Date(a,s,r)},s=null==i||""===i?n:"string"==typeof i?a(i):"number"==typeof i?isNaN(i)?n:o(i):new Date(i.getTime());return s=s&&"Invalid Date"===s.toString()?n:s,s&&(s.setHours(0),s.setMinutes(0),s.setSeconds(0),s.setMilliseconds(0)),this._daylightSavingAdjust(s)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,i){var n=!t,o=e.selectedMonth,a=e.selectedYear,s=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=s.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=s.getMonth(),e.drawYear=e.selectedYear=e.currentYear=s.getFullYear(),o===e.selectedMonth&&a===e.selectedYear||i||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(n?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var i=this._get(t,"stepMonths"),n="#"+t.id.replace(/\\\\/g,"\\");
t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(n,-i,"M")},next:function(){e.datepicker._adjustDate(n,+i,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(n)},selectDay:function(){return e.datepicker._selectDay(n,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(n,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(n,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,i,n,o,a,s,r,l,p,h,d,c,u,f,g,m,_,w,b,v,y,k,x,M,T,P,S,I,z,C,$,D,j,A,E,F,N,B,L,K=new Date,O=this._daylightSavingAdjust(new Date(K.getFullYear(),K.getMonth(),K.getDate())),H=this._get(e,"isRTL"),W=this._get(e,"showButtonPanel"),R=this._get(e,"hideIfNoPrevNext"),q=this._get(e,"navigationAsDateFormat"),G=this._getNumberOfMonths(e),U=this._get(e,"showCurrentAtPos"),V=this._get(e,"stepMonths"),Y=1!==G[0]||1!==G[1],J=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),Z=this._getMinMaxDate(e,"min"),X=this._getMinMaxDate(e,"max"),Q=e.drawMonth-U,et=e.drawYear;if(0>Q&&(Q+=12,et--),X)for(t=this._daylightSavingAdjust(new Date(X.getFullYear(),X.getMonth()-G[0]*G[1]+1,X.getDate())),t=Z&&Z>t?Z:t;this._daylightSavingAdjust(new Date(et,Q,1))>t;)Q--,0>Q&&(Q=11,et--);for(e.drawMonth=Q,e.drawYear=et,i=this._get(e,"prevText"),i=q?this.formatDate(i,this._daylightSavingAdjust(new Date(et,Q-V,1)),this._getFormatConfig(e)):i,n=this._canAdjustMonth(e,-1,et,Q)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(H?"e":"w")+"'>"+i+"</span></a>":R?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(H?"e":"w")+"'>"+i+"</span></a>",o=this._get(e,"nextText"),o=q?this.formatDate(o,this._daylightSavingAdjust(new Date(et,Q+V,1)),this._getFormatConfig(e)):o,a=this._canAdjustMonth(e,1,et,Q)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+o+"'><span class='ui-icon ui-icon-circle-triangle-"+(H?"w":"e")+"'>"+o+"</span></a>":R?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+o+"'><span class='ui-icon ui-icon-circle-triangle-"+(H?"w":"e")+"'>"+o+"</span></a>",s=this._get(e,"currentText"),r=this._get(e,"gotoCurrent")&&e.currentDay?J:O,s=q?this.formatDate(s,r,this._getFormatConfig(e)):s,l=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",p=W?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(H?l:"")+(this._isInRange(e,r)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+s+"</button>":"")+(H?"":l)+"</div>":"",h=parseInt(this._get(e,"firstDay"),10),h=isNaN(h)?0:h,d=this._get(e,"showWeek"),c=this._get(e,"dayNames"),u=this._get(e,"dayNamesMin"),f=this._get(e,"monthNames"),g=this._get(e,"monthNamesShort"),m=this._get(e,"beforeShowDay"),_=this._get(e,"showOtherMonths"),w=this._get(e,"selectOtherMonths"),b=this._getDefaultDate(e),v="",k=0;k<G[0];k++){for(x="",this.maxRows=4,M=0;M<G[1];M++){if(T=this._daylightSavingAdjust(new Date(et,Q,e.selectedDay)),P=" ui-corner-all",S="",Y){if(S+="<div class='ui-datepicker-group",G[1]>1)switch(M){case 0:S+=" ui-datepicker-group-first",P=" ui-corner-"+(H?"right":"left");break;case G[1]-1:S+=" ui-datepicker-group-last",P=" ui-corner-"+(H?"left":"right");break;default:S+=" ui-datepicker-group-middle",P=""}S+="'>"}for(S+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+P+"'>"+(/all|left/.test(P)&&0===k?H?a:n:"")+(/all|right/.test(P)&&0===k?H?n:a:"")+this._generateMonthYearHeader(e,Q,et,Z,X,k>0||M>0,f,g)+"</div><table class='ui-datepicker-calendar'><thead><tr>",I=d?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",y=0;7>y;y++)z=(y+h)%7,I+="<th scope='col'"+((y+h+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+c[z]+"'>"+u[z]+"</span></th>";for(S+=I+"</tr></thead><tbody>",C=this._getDaysInMonth(et,Q),et===e.selectedYear&&Q===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,C)),$=(this._getFirstDayOfMonth(et,Q)-h+7)%7,D=Math.ceil(($+C)/7),j=Y&&this.maxRows>D?this.maxRows:D,this.maxRows=j,A=this._daylightSavingAdjust(new Date(et,Q,1-$)),E=0;j>E;E++){for(S+="<tr>",F=d?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(A)+"</td>":"",y=0;7>y;y++)N=m?m.apply(e.input?e.input[0]:null,[A]):[!0,""],B=A.getMonth()!==Q,L=B&&!w||!N[0]||Z&&Z>A||X&&A>X,F+="<td class='"+((y+h+6)%7>=5?" ui-datepicker-week-end":"")+(B?" ui-datepicker-other-month":"")+(A.getTime()===T.getTime()&&Q===e.selectedMonth&&e._keyEvent||b.getTime()===A.getTime()&&b.getTime()===T.getTime()?" "+this._dayOverClass:"")+(L?" "+this._unselectableClass+" ui-state-disabled":"")+(B&&!_?"":" "+N[1]+(A.getTime()===J.getTime()?" "+this._currentClass:"")+(A.getTime()===O.getTime()?" ui-datepicker-today":""))+"'"+(B&&!_||!N[2]?"":" title='"+N[2].replace(/'/g,"&#39;")+"'")+(L?"":" data-handler='selectDay' data-event='click' data-month='"+A.getMonth()+"' data-year='"+A.getFullYear()+"'")+">"+(B&&!_?"&#xa0;":L?"<span class='ui-state-default'>"+A.getDate()+"</span>":"<a class='ui-state-default"+(A.getTime()===O.getTime()?" ui-state-highlight":"")+(A.getTime()===J.getTime()?" ui-state-active":"")+(B?" ui-priority-secondary":"")+"' href='#'>"+A.getDate()+"</a>")+"</td>",A.setDate(A.getDate()+1),A=this._daylightSavingAdjust(A);S+=F+"</tr>"}Q++,Q>11&&(Q=0,et++),S+="</tbody></table>"+(Y?"</div>"+(G[0]>0&&M===G[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),x+=S}v+=x}return v+=p,e._keyEvent=!1,v},_generateMonthYearHeader:function(e,t,i,n,o,a,s,r){var l,p,h,d,c,u,f,g,m=this._get(e,"changeMonth"),_=this._get(e,"changeYear"),w=this._get(e,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",v="";if(a||!m)v+="<span class='ui-datepicker-month'>"+s[t]+"</span>";else{for(l=n&&n.getFullYear()===i,p=o&&o.getFullYear()===i,v+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",h=0;12>h;h++)(!l||h>=n.getMonth())&&(!p||h<=o.getMonth())&&(v+="<option value='"+h+"'"+(h===t?" selected='selected'":"")+">"+r[h]+"</option>");v+="</select>"}if(w||(b+=v+(!a&&m&&_?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",a||!_)b+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(d=this._get(e,"yearRange").split(":"),c=(new Date).getFullYear(),u=function(e){var t=e.match(/c[+\-].*/)?i+parseInt(e.substring(1),10):e.match(/[+\-].*/)?c+parseInt(e,10):parseInt(e,10);return isNaN(t)?c:t},f=u(d[0]),g=Math.max(f,u(d[1]||"")),f=n?Math.max(f,n.getFullYear()):f,g=o?Math.min(g,o.getFullYear()):g,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";g>=f;f++)e.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";e.yearshtml+="</select>",b+=e.yearshtml,e.yearshtml=null}return b+=this._get(e,"yearSuffix"),w&&(b+=(!a&&m&&_?"":"&#xa0;")+v),b+="</div>"},_adjustInstDate:function(e,t,i){var n=e.drawYear+("Y"===i?t:0),o=e.drawMonth+("M"===i?t:0),a=Math.min(e.selectedDay,this._getDaysInMonth(n,o))+("D"===i?t:0),s=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(n,o,a)));e.selectedDay=s.getDate(),e.drawMonth=e.selectedMonth=s.getMonth(),e.drawYear=e.selectedYear=s.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var i=this._getMinMaxDate(e,"min"),n=this._getMinMaxDate(e,"max"),o=i&&i>t?i:t;return n&&o>n?n:o},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i,n){var o=this._getNumberOfMonths(e),a=this._daylightSavingAdjust(new Date(i,n+(0>t?t:o[0]*o[1]),1));return 0>t&&a.setDate(this._getDaysInMonth(a.getFullYear(),a.getMonth())),this._isInRange(e,a)},_isInRange:function(e,t){var i,n,o=this._getMinMaxDate(e,"min"),a=this._getMinMaxDate(e,"max"),s=null,r=null,l=this._get(e,"yearRange");return l&&(i=l.split(":"),n=(new Date).getFullYear(),s=parseInt(i[0],10),r=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(s+=n),i[1].match(/[+\-].*/)&&(r+=n)),(!o||t.getTime()>=o.getTime())&&(!a||t.getTime()<=a.getTime())&&(!s||t.getFullYear()>=s)&&(!r||t.getFullYear()<=r)},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,i,n){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var o=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(n,i,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),o,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e("#"+e.datepicker._mainDivId).length&&e("body").append(e.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(i)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i))},e.datepicker=new o,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.11.0";var _=(e.datepicker,e.widget("ui.dialog",{version:"1.11.0",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"Close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var i=e(this).css(t).offset().top;0>i&&e(this).css("top",t.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&e.fn.draggable&&this._makeDraggable(),this.options.resizable&&e.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?e(t):this.document.find(t||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:e.noop,enable:e.noop,close:function(t){var i,n=this;if(this._isOpen&&this._trigger("beforeClose",t)!==!1){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(":focusable").focus().length)try{i=this.document[0].activeElement,i&&"body"!==i.nodeName.toLowerCase()&&e(i).blur()}catch(o){}this._hide(this.uiDialog,this.options.hide,function(){n._trigger("close",t)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(t,i){var n=!1,o=this.uiDialog.siblings(".ui-front:visible").map(function(){return+e(this).css("z-index")}).get(),a=Math.max.apply(null,o);return a>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",a+1),n=!0),n&&!i&&this._trigger("focus",t),n},open:function(){var t=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=e(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this._show(this.uiDialog,this.options.show,function(){t._focusTabbable(),t._trigger("focus")}),void this._trigger("open"))},_focusTabbable:function(){var e=this._focusedElement;e||(e=this.element.find("[autofocus]")),e.length||(e=this.element.find(":tabbable")),e.length||(e=this.uiDialogButtonPane.find(":tabbable")),e.length||(e=this.uiDialogTitlebarClose.filter(":tabbable")),e.length||(e=this.uiDialog),e.eq(0).focus()},_keepFocus:function(t){function i(){var t=this.document[0].activeElement,i=this.uiDialog[0]===t||e.contains(this.uiDialog[0],t);i||this._focusTabbable()}t.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=e("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE)return t.preventDefault(),void this.close(t);if(t.keyCode===e.ui.keyCode.TAB&&!t.isDefaultPrevented()){var i=this.uiDialog.find(":tabbable"),n=i.filter(":first"),o=i.filter(":last");t.target!==o[0]&&t.target!==this.uiDialog[0]||t.shiftKey?t.target!==n[0]&&t.target!==this.uiDialog[0]||!t.shiftKey||(this._delay(function(){o.focus()}),t.preventDefault()):(this._delay(function(){n.focus()}),t.preventDefault())}},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=e("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(t){e(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=e("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),t=e("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(t),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(e){this.options.title||e.html("&#160;"),e.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=e("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=e("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var t=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),e.isEmptyObject(i)||e.isArray(i)&&!i.length?void this.uiDialog.removeClass("ui-dialog-buttons"):(e.each(i,function(i,n){var o,a;n=e.isFunction(n)?{click:n,text:i}:n,n=e.extend({type:"button"},n),o=n.click,n.click=function(){o.apply(t.element[0],arguments)},a={icons:n.icons,text:n.showText},delete n.icons,delete n.showText,e("<button></button>",n).button(a).appendTo(t.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function t(e){return{position:e.position,offset:e.offset}}var i=this,n=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(n,o){e(this).addClass("ui-dialog-dragging"),i._blockFrames(),i._trigger("dragStart",n,t(o))},drag:function(e,n){i._trigger("drag",e,t(n))},stop:function(o,a){var s=a.offset.left-i.document.scrollLeft(),r=a.offset.top-i.document.scrollTop();n.position={my:"left top",at:"left"+(s>=0?"+":"")+s+" top"+(r>=0?"+":"")+r,of:i.window},e(this).removeClass("ui-dialog-dragging"),i._unblockFrames(),i._trigger("dragStop",o,t(a))}})},_makeResizable:function(){function t(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var i=this,n=this.options,o=n.resizable,a=this.uiDialog.css("position"),s="string"==typeof o?o:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:n.maxWidth,maxHeight:n.maxHeight,minWidth:n.minWidth,minHeight:this._minHeight(),handles:s,start:function(n,o){e(this).addClass("ui-dialog-resizing"),i._blockFrames(),i._trigger("resizeStart",n,t(o))},resize:function(e,n){i._trigger("resize",e,t(n))},stop:function(o,a){var s=i.uiDialog.offset(),r=s.left-i.document.scrollLeft(),l=s.top-i.document.scrollTop();n.height=i.uiDialog.height(),n.width=i.uiDialog.width(),n.position={my:"left top",at:"left"+(r>=0?"+":"")+r+" top"+(l>=0?"+":"")+l,of:i.window},e(this).removeClass("ui-dialog-resizing"),i._unblockFrames(),i._trigger("resizeStop",o,t(a))}}).css("position",a)},_trackFocus:function(){this._on(this.widget(),{focusin:function(t){this._untrackInstance(),this._trackingInstances().unshift(this),this._focusedElement=e(t.target)}})},_untrackInstance:function(){var t=this._trackingInstances(),i=e.inArray(this,t);-1!==i&&t.splice(i,1)},_trackingInstances:function(){var e=this.document.data("ui-dialog-instances");return e||(e=[],this.document.data("ui-dialog-instances",e)),e},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(t){var i=this,n=!1,o={};e.each(t,function(e,t){i._setOption(e,t),e in i.sizeRelatedOptions&&(n=!0),e in i.resizableRelatedOptions&&(o[e]=t)}),n&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",o)},_setOption:function(e,t){var i,n,o=this.uiDialog;"dialogClass"===e&&o.removeClass(this.options.dialogClass).addClass(t),"disabled"!==e&&(this._super(e,t),"appendTo"===e&&this.uiDialog.appendTo(this._appendTo()),"buttons"===e&&this._createButtons(),"closeText"===e&&this.uiDialogTitlebarClose.button({label:""+t}),"draggable"===e&&(i=o.is(":data(ui-draggable)"),i&&!t&&o.draggable("destroy"),!i&&t&&this._makeDraggable()),"position"===e&&this._position(),"resizable"===e&&(n=o.is(":data(ui-resizable)"),n&&!t&&o.resizable("destroy"),n&&"string"==typeof t&&o.resizable("option","handles",t),n||t===!1||this._makeResizable()),"title"===e&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var e,t,i,n=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),n.minWidth>n.width&&(n.width=n.minWidth),e=this.uiDialog.css({height:"auto",width:n.width}).outerHeight(),t=Math.max(0,n.minHeight-e),i="number"==typeof n.maxHeight?Math.max(0,n.maxHeight-e):"none","auto"===n.height?this.element.css({minHeight:t,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,n.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var t=e(this);return e("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return e(t.target).closest(".ui-dialog").length?!0:!!e(t.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var t=!0;this._delay(function(){t=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(e){t||this._allowInteraction(e)||(e.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=e("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var e=this.document.data("ui-dialog-overlays")-1;e?this.document.data("ui-dialog-overlays",e):this.document.unbind("focusin").removeData("ui-dialog-overlays"),this.overlay.remove(),this.overlay=null}}}),e.widget("ui.progressbar",{version:"1.11.0",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(e){return void 0===e?this.options.value:(this.options.value=this._constrainedValue(e),void this._refreshValue())},_constrainedValue:function(e){return void 0===e&&(e=this.options.value),this.indeterminate=e===!1,"number"!=typeof e&&(e=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){"max"===e&&(t=Math.max(this.min,t)),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).toggleClass("ui-corner-right",t===this.options.max).width(i.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=e("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),t===this.options.max&&this._trigger("complete")}}),e.widget("ui.selectmenu",{version:"1.11.0",defaultElement:"<select>",options:{appendTo:null,disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var e=this.element.uniqueId().attr("id");this.ids={element:e,button:e+"-button",menu:e+"-menu"},this._drawButton(),this._drawMenu(),this.options.disabled&&this.disable()},_drawButton:function(){var t=this,i=this.element.attr("tabindex");this.label=e("label[for='"+this.ids.element+"']").attr("for",this.ids.button),this._on(this.label,{click:function(e){this.button.focus(),e.preventDefault()}}),this.element.hide(),this.button=e("<span>",{"class":"ui-selectmenu-button ui-widget ui-state-default ui-corner-all",tabindex:i||this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true"}).insertAfter(this.element),e("<span>",{"class":"ui-icon "+this.options.icons.button}).prependTo(this.button),this.buttonText=e("<span>",{"class":"ui-selectmenu-text"}).appendTo(this.button),this._setText(this.buttonText,this.element.find("option:selected").text()),this._setOption("width",this.options.width),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){t.menuItems||t._refreshMenu()}),this._hoverable(this.button),this._focusable(this.button)},_drawMenu:function(){var t=this;this.menu=e("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=e("<div>",{"class":"ui-selectmenu-menu ui-front"}).append(this.menu).appendTo(this._appendTo()),this.menuInstance=this.menu.menu({role:"listbox",select:function(e,i){e.preventDefault(),t._select(i.item.data("ui-selectmenu-item"),e)},focus:function(e,i){var n=i.item.data("ui-selectmenu-item");null!=t.focusIndex&&n.index!==t.focusIndex&&(t._trigger("focus",e,{item:n}),t.isOpen||t._select(n,e)),t.focusIndex=n.index,t.button.attr("aria-activedescendant",t.menuItems.eq(n.index).attr("id"))}}).menu("instance"),this.menu.addClass("ui-corner-bottom").removeClass("ui-corner-all"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this._setText(this.buttonText,this._getSelectedItem().text()),this._setOption("width",this.options.width)},_refreshMenu:function(){this.menu.empty();var e,t=this.element.find("option");t.length&&(this._parseOptions(t),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup"),e=this._getSelectedItem(),this.menuInstance.focus(null,e),this._setAria(e.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(e){this.options.disabled||(this.menuItems?(this.menu.find(".ui-state-focus").removeClass("ui-state-focus"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",e))},_position:function(){this.menuWrap.position(e.extend({of:this.button},this.options.position))},close:function(e){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this._off(this.document),this._trigger("close",e))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderMenu:function(t,i){var n=this,o="";e.each(i,function(i,a){a.optgroup!==o&&(e("<li>",{"class":"ui-selectmenu-optgroup ui-menu-divider"+(a.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""),text:a.optgroup}).appendTo(t),o=a.optgroup),n._renderItemData(t,a)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-selectmenu-item",t)},_renderItem:function(t,i){var n=e("<li>");return i.disabled&&n.addClass("ui-state-disabled"),this._setText(n,i.label),n.appendTo(t)},_setText:function(e,t){t?e.text(t):e.html("&#160;")},_move:function(e,t){var i,n,o=".ui-menu-item";this.isOpen?i=this.menuItems.eq(this.focusIndex):(i=this.menuItems.eq(this.element[0].selectedIndex),o+=":not(.ui-state-disabled)"),n="first"===e||"last"===e?i["first"===e?"prevAll":"nextAll"](o).eq(-1):i[e+"All"](o).eq(0),n.length&&this.menuInstance.focus(t,n)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex)},_toggle:function(e){this[this.isOpen?"close":"open"](e)},_documentClick:{mousedown:function(t){this.isOpen&&(e(t.target).closest(".ui-selectmenu-menu, #"+this.ids.button).length||this.close(t))}},_buttonEvents:{click:"_toggle",keydown:function(t){var i=!0;switch(t.keyCode){case e.ui.keyCode.TAB:case e.ui.keyCode.ESCAPE:this.close(t),i=!1;break;case e.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(t);break;case e.ui.keyCode.UP:t.altKey?this._toggle(t):this._move("prev",t);break;case e.ui.keyCode.DOWN:t.altKey?this._toggle(t):this._move("next",t);break;case e.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(t):this._toggle(t);break;case e.ui.keyCode.LEFT:this._move("prev",t);break;case e.ui.keyCode.RIGHT:this._move("next",t);break;case e.ui.keyCode.HOME:case e.ui.keyCode.PAGE_UP:this._move("first",t);break;case e.ui.keyCode.END:case e.ui.keyCode.PAGE_DOWN:this._move("last",t);break;default:this.menu.trigger(t),i=!1}i&&t.preventDefault()}},_selectFocusedItem:function(e){var t=this.menuItems.eq(this.focusIndex);t.hasClass("ui-state-disabled")||this._select(t.data("ui-selectmenu-item"),e)},_select:function(e,t){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=e.index,this._setText(this.buttonText,e.label),this._setAria(e),this._trigger("select",t,{item:e}),e.index!==i&&this._trigger("change",t,{item:e}),this.close(t)},_setAria:function(e){var t=this.menuItems.eq(e.index).attr("id");this.button.attr({"aria-labelledby":t,"aria-activedescendant":t}),this.menu.attr("aria-activedescendant",t)},_setOption:function(e,t){"icons"===e&&this.button.find("span.ui-icon").removeClass(this.options.icons.button).addClass(t.button),this._super(e,t),"appendTo"===e&&this.menuWrap.appendTo(this._appendTo()),"disabled"===e&&(this.menuInstance.option("disabled",t),this.button.toggleClass("ui-state-disabled",t).attr("aria-disabled",t),this.element.prop("disabled",t),t?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)),"width"===e&&(t||(t=this.element.outerWidth()),this.button.outerWidth(t))},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_toggleAttr:function(){this.button.toggleClass("ui-corner-top",this.isOpen).toggleClass("ui-corner-all",!this.isOpen).attr("aria-expanded",this.isOpen),this.menuWrap.toggleClass("ui-selectmenu-open",this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){return{disabled:this.element.prop("disabled")}},_parseOptions:function(t){var i=[];t.each(function(t,n){var o=e(n),a=o.parent("optgroup");i.push({element:o,index:t,value:o.attr("value"),label:o.text(),optgroup:a.attr("label")||"",disabled:a.prop("disabled")||o.prop("disabled")})}),this.items=i},_destroy:function(){this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.label.attr("for",this.ids.element)}}),e.widget("ui.slider",e.ui.mouse,{version:"1.11.0",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1
},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,i,n=this.options,o=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),a="<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>",s=[];for(i=n.values&&n.values.length||1,o.length>i&&(o.slice(i).remove(),o=o.slice(0,i)),t=o.length;i>t;t++)s.push(a);this.handles=o.add(e(s.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,i="";t.range?(t.range===!0&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:e.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=e("<div></div>").appendTo(this.element),i="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(i+("min"===t.range||"max"===t.range?" ui-slider-range-"+t.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var i,n,o,a,s,r,l,p,h=this,d=this.options;return d.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:t.pageX,y:t.pageY},n=this._normValueFromMouse(i),o=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var i=Math.abs(n-h.values(t));(o>i||o===i&&(t===h._lastChangedValue||h.values(t)===d.min))&&(o=i,a=e(this),s=t)}),r=this._start(t,s),r===!1?!1:(this._mouseSliding=!0,this._handleIndex=s,a.addClass("ui-state-active").focus(),l=a.offset(),p=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=p?{left:0,top:0}:{left:t.pageX-l.left-a.width()/2,top:t.pageY-l.top-a.height()/2-(parseInt(a.css("borderTopWidth"),10)||0)-(parseInt(a.css("borderBottomWidth"),10)||0)+(parseInt(a.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,s,n),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},i=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,i),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,i,n,o,a;return"horizontal"===this.orientation?(t=this.elementSize.width,i=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,i=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),n=i/t,n>1&&(n=1),0>n&&(n=0),"vertical"===this.orientation&&(n=1-n),o=this._valueMax()-this._valueMin(),a=this._valueMin()+n*o,this._trimAlignValue(a)},_start:function(e,t){var i={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("start",e,i)},_slide:function(e,t,i){var n,o,a;this.options.values&&this.options.values.length?(n=this.values(t?0:1),2===this.options.values.length&&this.options.range===!0&&(0===t&&i>n||1===t&&n>i)&&(i=n),i!==this.values(t)&&(o=this.values(),o[t]=i,a=this._trigger("slide",e,{handle:this.handles[t],value:i,values:o}),n=this.values(t?0:1),a!==!1&&this.values(t,i))):i!==this.value()&&(a=this._trigger("slide",e,{handle:this.handles[t],value:i}),a!==!1&&this.value(i))},_stop:function(e,t){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("stop",e,i)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,i)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),void this._change(null,0)):this._value()},values:function(t,i){var n,o,a;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(i),this._refreshValue(),void this._change(null,t);if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(n=this.options.values,o=arguments[0],a=0;a<n.length;a+=1)n[a]=this._trimAlignValue(o[a]),this._change(null,a);this._refreshValue()},_setOption:function(t,i){var n,o=0;switch("range"===t&&this.options.range===!0&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),e.isArray(this.options.values)&&(o=this.options.values.length),"disabled"===t&&this.element.toggleClass("ui-state-disabled",!!i),this._super(t,i),t){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),n=0;o>n;n+=1)this._change(null,n);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,i,n;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),n=0;n<i.length;n+=1)i[n]=this._trimAlignValue(i[n]);return i}return[]},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,i=(e-this._valueMin())%t,n=e-i;return 2*Math.abs(i)>=t&&(n+=i>0?t:-t),parseFloat(n.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,i,n,o,a,s=this.options.range,r=this.options,l=this,p=this._animateOff?!1:r.animate,h={};this.options.values&&this.options.values.length?this.handles.each(function(n){i=(l.values(n)-l._valueMin())/(l._valueMax()-l._valueMin())*100,h["horizontal"===l.orientation?"left":"bottom"]=i+"%",e(this).stop(1,1)[p?"animate":"css"](h,r.animate),l.options.range===!0&&("horizontal"===l.orientation?(0===n&&l.range.stop(1,1)[p?"animate":"css"]({left:i+"%"},r.animate),1===n&&l.range[p?"animate":"css"]({width:i-t+"%"},{queue:!1,duration:r.animate})):(0===n&&l.range.stop(1,1)[p?"animate":"css"]({bottom:i+"%"},r.animate),1===n&&l.range[p?"animate":"css"]({height:i-t+"%"},{queue:!1,duration:r.animate}))),t=i}):(n=this.value(),o=this._valueMin(),a=this._valueMax(),i=a!==o?(n-o)/(a-o)*100:0,h["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[p?"animate":"css"](h,r.animate),"min"===s&&"horizontal"===this.orientation&&this.range.stop(1,1)[p?"animate":"css"]({width:i+"%"},r.animate),"max"===s&&"horizontal"===this.orientation&&this.range[p?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:r.animate}),"min"===s&&"vertical"===this.orientation&&this.range.stop(1,1)[p?"animate":"css"]({height:i+"%"},r.animate),"max"===s&&"vertical"===this.orientation&&this.range[p?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:r.animate}))},_handleEvents:{keydown:function(t){var i,n,o,a,s=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(t.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(t.target).addClass("ui-state-active"),i=this._start(t,s),i===!1))return}switch(a=this.options.step,n=o=this.options.values&&this.options.values.length?this.values(s):this.value(),t.keyCode){case e.ui.keyCode.HOME:o=this._valueMin();break;case e.ui.keyCode.END:o=this._valueMax();break;case e.ui.keyCode.PAGE_UP:o=this._trimAlignValue(n+(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.PAGE_DOWN:o=this._trimAlignValue(n-(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(n===this._valueMax())return;o=this._trimAlignValue(n+a);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(n===this._valueMin())return;o=this._trimAlignValue(n-a)}this._slide(t,s,o)},keyup:function(t){var i=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,i),this._change(t,i),e(t.target).removeClass("ui-state-active"))}}}),e.widget("ui.spinner",{version:"1.11.0",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t={},i=this.element;return e.each(["min","max","step"],function(e,n){var o=i.attr(n);void 0!==o&&o.length&&(t[n]=o)}),t},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(this._stop(),this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",e)))},mousewheel:function(e,t){if(t){if(!this.spinning&&!this._start(e))return!1;this._spin((t>0?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(e)},100),e.preventDefault()}},"mousedown .ui-spinner-button":function(t){function i(){var e=this.element[0]===this.document[0].activeElement;e||(this.element.focus(),this.previous=n,this._delay(function(){this.previous=n}))}var n;n=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),t.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),this._start(t)!==!1&&this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){return e(t.currentTarget).hasClass("ui-state-active")?this._start(t)===!1?!1:void this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*e.height())&&e.height()>0&&e.height(e.height()),this.options.disabled&&this.disable()},_keydown:function(t){var i=this.options,n=e.ui.keyCode;switch(t.keyCode){case n.UP:return this._repeat(null,1,t),!0;case n.DOWN:return this._repeat(null,-1,t),!0;case n.PAGE_UP:return this._repeat(null,i.page,t),!0;case n.PAGE_DOWN:return this._repeat(null,-i.page,t),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(e){return this.spinning||this._trigger("start",e)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(e,t,i){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,i)},e),this._spin(t*this.options.step,i)},_spin:function(e,t){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+e*this._increment(this.counter)),this.spinning&&this._trigger("spin",t,{value:i})===!1||(this._value(i),this.counter++)},_increment:function(t){var i=this.options.incremental;return i?e.isFunction(i)?i(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=e.toString(),i=t.indexOf(".");return-1===i?0:t.length-i-1},_adjustValue:function(e){var t,i,n=this.options;return t=null!==n.min?n.min:0,i=e-t,i=Math.round(i/n.step)*n.step,e=t+i,e=parseFloat(e.toFixed(this._precision())),null!==n.max&&e>n.max?n.max:null!==n.min&&e<n.min?n.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e))},_setOption:function(e,t){if("culture"===e||"numberFormat"===e){var i=this._parse(this.element.val());return this.options[e]=t,void this.element.val(this._format(i))}("max"===e||"min"===e||"step"===e)&&"string"==typeof t&&(t=this._parse(t)),"icons"===e&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(t.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(t.down)),this._super(e,t),"disabled"===e&&(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),this.buttons.button(t?"disable":"enable"))},_setOptions:r(function(e){this._super(e)}),_parse:function(e){return"string"==typeof e&&""!==e&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),""===e||isNaN(e)?null:e},_format:function(e){return""===e?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var e=this.value();return null===e?!1:e===this._adjustValue(e)},_value:function(e,t){var i;""!==e&&(i=this._parse(e),null!==i&&(t||(i=this._adjustValue(i)),e=this._format(i))),this.element.val(e),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:r(function(e){this._stepUp(e)}),_stepUp:function(e){this._start()&&(this._spin((e||1)*this.options.step),this._stop())},stepDown:r(function(e){this._stepDown(e)}),_stepDown:function(e){this._start()&&(this._spin((e||1)*-this.options.step),this._stop())},pageUp:r(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:r(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){return arguments.length?void r(this._value).call(this,e):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),e.widget("ui.tabs",{version:"1.11.0",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var e=/#.*$/;return function(t){var i,n;t=t.cloneNode(!1),i=t.href.replace(e,""),n=location.href.replace(e,"");try{i=decodeURIComponent(i)}catch(o){}try{n=decodeURIComponent(n)}catch(o){}return t.hash.length>1&&i===n}}(),_create:function(){var t=this,i=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",i.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),i.active=this._initialActive(),e.isArray(i.disabled)&&(i.disabled=e.unique(i.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(i.active):e(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var t=this.options.active,i=this.options.collapsible,n=location.hash.substring(1);return null===t&&(n&&this.tabs.each(function(i,o){return e(o).attr("aria-controls")===n?(t=i,!1):void 0}),null===t&&(t=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===t||-1===t)&&(t=this.tabs.length?0:!1)),t!==!1&&(t=this.tabs.index(this.tabs.eq(t)),-1===t&&(t=i?!1:0)),!i&&t===!1&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var i=e(this.document[0].activeElement).closest("li"),n=this.tabs.index(i),o=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:n++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:o=!1,n--;break;case e.ui.keyCode.END:n=this.anchors.length-1;break;case e.ui.keyCode.HOME:n=0;break;case e.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),void this._activate(n);case e.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),void this._activate(n===this.options.active?!1:n);default:return}t.preventDefault(),clearTimeout(this.activating),n=this._focusNextTab(n,o),t.ctrlKey||(i.attr("aria-selected","false"),this.tabs.eq(n).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",n)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){return t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,i){function n(){return t>o&&(t=0),0>t&&(t=o),t}for(var o=this.tabs.length-1;-1!==e.inArray(n(),this.options.disabled);)t=i?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){return"active"===e?void this._activate(t):"disabled"===e?void this._setupDisabled(t):(this._super(e,t),"collapsible"===e&&(this.element.toggleClass("ui-tabs-collapsible",t),t||this.options.active!==!1||this._activate(0)),"event"===e&&this._setupEvents(t),void("heightStyle"===e&&this._setupHeightStyle(t)))},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,i=this.tablist.children(":has(a[href])");t.disabled=e.map(i.filter(".ui-state-disabled"),function(e){return i.index(e)}),this._processTabs(),t.active!==!1&&this.anchors.length?this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=e()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return e("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=e(),this.anchors.each(function(i,n){var o,a,s,r=e(n).uniqueId().attr("id"),l=e(n).closest("li"),p=l.attr("aria-controls");t._isLocal(n)?(o=n.hash,s=o.substring(1),a=t.element.find(t._sanitizeSelector(o))):(s=l.attr("aria-controls")||e({}).uniqueId()[0].id,o="#"+s,a=t.element.find(o),a.length||(a=t._createPanel(s),a.insertAfter(t.panels[i-1]||t.tablist)),a.attr("aria-live","polite")),a.length&&(t.panels=t.panels.add(a)),p&&l.data("ui-tabs-aria-controls",p),l.attr({"aria-controls":s,"aria-labelledby":r}),a.attr("aria-labelledby",r)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var i,n=0;i=this.tabs[n];n++)t===!0||-1!==e.inArray(n,t)?e(i).addClass("ui-state-disabled").attr("aria-disabled","true"):e(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var i={};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(e){e.preventDefault()}}),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var i,n=this.element.parent();"fill"===t?(i=n.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=e(this),n=t.css("position");"absolute"!==n&&"fixed"!==n&&(i-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,i-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===t&&(i=0,this.panels.each(function(){i=Math.max(i,e(this).height("").height())}).height(i))},_eventHandler:function(t){var i=this.options,n=this.active,o=e(t.currentTarget),a=o.closest("li"),s=a[0]===n[0],r=s&&i.collapsible,l=r?e():this._getPanelForTab(a),p=n.length?this._getPanelForTab(n):e(),h={oldTab:n,oldPanel:p,newTab:r?e():a,newPanel:l};t.preventDefault(),a.hasClass("ui-state-disabled")||a.hasClass("ui-tabs-loading")||this.running||s&&!i.collapsible||this._trigger("beforeActivate",t,h)===!1||(i.active=r?!1:this.tabs.index(a),this.active=s?e():a,this.xhr&&this.xhr.abort(),p.length||l.length||e.error("jQuery UI Tabs: Mismatching fragment identifier."),l.length&&this.load(this.tabs.index(a),t),this._toggle(t,h))},_toggle:function(t,i){function n(){a.running=!1,a._trigger("activate",t,i)}function o(){i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),s.length&&a.options.show?a._show(s,a.options.show,n):(s.show(),n())}var a=this,s=i.newPanel,r=i.oldPanel;this.running=!0,r.length&&this.options.hide?this._hide(r,this.options.hide,function(){i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),o()}):(i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),r.hide(),o()),r.attr("aria-hidden","true"),i.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),s.length&&r.length?i.oldTab.attr("tabIndex",-1):s.length&&this.tabs.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),s.attr("aria-hidden","false"),i.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(t){var i,n=this._findActive(t);n[0]!==this.active[0]&&(n.length||(n=this.active),i=n.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return t===!1?e():this.tabs.eq(t)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=e(this),i=t.data("ui-tabs-aria-controls");i?t.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(t){var i=this.options.disabled;i!==!1&&(void 0===t?i=!1:(t=this._getIndex(t),i=e.isArray(i)?e.map(i,function(e){return e!==t?e:null}):e.map(this.tabs,function(e,i){return i!==t?i:null})),this._setupDisabled(i))},disable:function(t){var i=this.options.disabled;if(i!==!0){if(void 0===t)i=!0;else{if(t=this._getIndex(t),-1!==e.inArray(t,i))return;i=e.isArray(i)?e.merge([t],i).sort():[t]}this._setupDisabled(i)}},load:function(t,i){t=this._getIndex(t);var n=this,o=this.tabs.eq(t),a=o.find(".ui-tabs-anchor"),s=this._getPanelForTab(o),r={tab:o,panel:s};this._isLocal(a[0])||(this.xhr=e.ajax(this._ajaxSettings(a,i,r)),this.xhr&&"canceled"!==this.xhr.statusText&&(o.addClass("ui-tabs-loading"),s.attr("aria-busy","true"),this.xhr.success(function(e){setTimeout(function(){s.html(e),n._trigger("load",i,r)},1)}).complete(function(e,t){setTimeout(function(){"abort"===t&&n.panels.stop(!1,!0),o.removeClass("ui-tabs-loading"),s.removeAttr("aria-busy"),e===n.xhr&&delete n.xhr},1)})))},_ajaxSettings:function(t,i,n){var o=this;return{url:t.attr("href"),beforeSend:function(t,a){return o._trigger("beforeLoad",i,e.extend({jqXHR:t,ajaxSettings:a},n))}}},_getPanelForTab:function(t){var i=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}}),e.widget("ui.tooltip",{version:"1.11.0",options:{content:function(){var t=e(this).attr("title")||"";return e("<a>").text(t).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_addDescribedBy:function(t,i){var n=(t.attr("aria-describedby")||"").split(/\s+/);n.push(i),t.data("ui-tooltip-id",i).attr("aria-describedby",e.trim(n.join(" ")))},_removeDescribedBy:function(t){var i=t.data("ui-tooltip-id"),n=(t.attr("aria-describedby")||"").split(/\s+/),o=e.inArray(i,n);-1!==o&&n.splice(o,1),t.removeData("ui-tooltip-id"),n=e.trim(n.join(" ")),n?t.attr("aria-describedby",n):t.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable(),this.liveRegion=e("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body)},_setOption:function(t,i){var n=this;return"disabled"===t?(this[i?"_disable":"_enable"](),void(this.options[t]=i)):(this._super(t,i),void("content"===t&&e.each(this.tooltips,function(e,t){n._updateContent(t)})))},_disable:function(){var t=this;e.each(this.tooltips,function(i,n){var o=e.Event("blur");o.target=o.currentTarget=n[0],t.close(o,!0)}),this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.is("[title]")&&t.data("ui-tooltip-title",t.attr("title")).removeAttr("title")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))})},open:function(t){var i=this,n=e(t?t.target:this.element).closest(this.options.items);n.length&&!n.data("ui-tooltip-id")&&(n.attr("title")&&n.data("ui-tooltip-title",n.attr("title")),n.data("ui-tooltip-open",!0),t&&"mouseover"===t.type&&n.parents().each(function(){var t,n=e(this);n.data("ui-tooltip-open")&&(t=e.Event("blur"),t.target=t.currentTarget=this,i.close(t,!0)),n.attr("title")&&(n.uniqueId(),i.parents[this.id]={element:this,title:n.attr("title")},n.attr("title",""))}),this._updateContent(n,t))},_updateContent:function(e,t){var i,n=this.options.content,o=this,a=t?t.type:null;return"string"==typeof n?this._open(t,e,n):(i=n.call(e[0],function(i){e.data("ui-tooltip-open")&&o._delay(function(){t&&(t.type=a),this._open(t,e,i)})}),void(i&&this._open(t,e,i)))},_open:function(t,i,n){function o(e){p.of=e,a.is(":hidden")||a.position(p)}var a,s,r,l,p=e.extend({},this.options.position);if(n){if(a=this._find(i),a.length)return void a.find(".ui-tooltip-content").html(n);i.is("[title]")&&(t&&"mouseover"===t.type?i.attr("title",""):i.removeAttr("title")),a=this._tooltip(i),this._addDescribedBy(i,a.attr("id")),a.find(".ui-tooltip-content").html(n),this.liveRegion.children().hide(),n.clone?(l=n.clone(),l.removeAttr("id").find("[id]").removeAttr("id")):l=n,e("<div>").html(l).appendTo(this.liveRegion),this.options.track&&t&&/^mouse/.test(t.type)?(this._on(this.document,{mousemove:o}),o(t)):a.position(e.extend({of:i},this.options.position)),a.hide(),this._show(a,this.options.show),this.options.show&&this.options.show.delay&&(r=this.delayedShow=setInterval(function(){a.is(":visible")&&(o(p.of),clearInterval(r))},e.fx.interval)),this._trigger("open",t,{tooltip:a}),s={keyup:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var n=e.Event(t);n.currentTarget=i[0],this.close(n,!0)}}},i[0]!==this.element[0]&&(s.remove=function(){this._removeTooltip(a)}),t&&"mouseover"!==t.type||(s.mouseleave="close"),t&&"focusin"!==t.type||(s.focusout="close"),this._on(!0,i,s)}},close:function(t){var i=this,n=e(t?t.currentTarget:this.element),o=this._find(n);this.closing||(clearInterval(this.delayedShow),n.data("ui-tooltip-title")&&!n.attr("title")&&n.attr("title",n.data("ui-tooltip-title")),this._removeDescribedBy(n),o.stop(!0),this._hide(o,this.options.hide,function(){i._removeTooltip(e(this))}),n.removeData("ui-tooltip-open"),this._off(n,"mouseleave focusout keyup"),n[0]!==this.element[0]&&this._off(n,"remove"),this._off(this.document,"mousemove"),t&&"mouseleave"===t.type&&e.each(this.parents,function(t,n){e(n.element).attr("title",n.title),delete i.parents[t]}),this.closing=!0,this._trigger("close",t,{tooltip:o}),this.closing=!1)
},_tooltip:function(t){var i=e("<div>").attr("role","tooltip").addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||"")),n=i.uniqueId().attr("id");return e("<div>").addClass("ui-tooltip-content").appendTo(i),i.appendTo(this.document[0].body),this.tooltips[n]=t,i},_find:function(t){var i=t.data("ui-tooltip-id");return i?e("#"+i):e()},_removeTooltip:function(e){e.remove(),delete this.tooltips[e.attr("id")]},_destroy:function(){var t=this;e.each(this.tooltips,function(i,n){var o=e.Event("blur");o.target=o.currentTarget=n[0],t.close(o,!0),e("#"+i).remove(),n.data("ui-tooltip-title")&&(n.attr("title")||n.attr("title",n.data("ui-tooltip-title")),n.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}}),"ui-effects-");e.effects={effect:{}},function(e,t){function i(e,t,i){var n=d[t.type]||{};return null==e?i||!t.def?null:t.def:(e=n.floor?~~e:parseFloat(e),isNaN(e)?t.def:n.mod?(e+n.mod)%n.mod:0>e?0:n.max<e?n.max:e)}function n(t){var i=p(),n=i._rgba=[];return t=t.toLowerCase(),f(l,function(e,o){var a,s=o.re.exec(t),r=s&&o.parse(s),l=o.space||"rgba";return r?(a=i[l](r),i[h[l].cache]=a[h[l].cache],n=i._rgba=a._rgba,!1):void 0}),n.length?("0,0,0,0"===n.join()&&e.extend(n,a.transparent),i):a[t]}function o(e,t,i){return i=(i+1)%1,1>6*i?e+(t-e)*i*6:1>2*i?t:2>3*i?e+(t-e)*(2/3-i)*6:e}var a,s="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",r=/^([\-+])=\s*(\d+\.?\d*)/,l=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],p=e.Color=function(t,i,n,o){return new e.Color.fn.parse(t,i,n,o)},h={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},d={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},c=p.support={},u=e("<p>")[0],f=e.each;u.style.cssText="background-color:rgba(1,1,1,.5)",c.rgba=u.style.backgroundColor.indexOf("rgba")>-1,f(h,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),p.fn=e.extend(p.prototype,{parse:function(o,s,r,l){if(o===t)return this._rgba=[null,null,null,null],this;(o.jquery||o.nodeType)&&(o=e(o).css(s),s=t);var d=this,c=e.type(o),u=this._rgba=[];return s!==t&&(o=[o,s,r,l],c="array"),"string"===c?this.parse(n(o)||a._default):"array"===c?(f(h.rgba.props,function(e,t){u[t.idx]=i(o[t.idx],t)}),this):"object"===c?(o instanceof p?f(h,function(e,t){o[t.cache]&&(d[t.cache]=o[t.cache].slice())}):f(h,function(t,n){var a=n.cache;f(n.props,function(e,t){if(!d[a]&&n.to){if("alpha"===e||null==o[e])return;d[a]=n.to(d._rgba)}d[a][t.idx]=i(o[e],t,!0)}),d[a]&&e.inArray(null,d[a].slice(0,3))<0&&(d[a][3]=1,n.from&&(d._rgba=n.from(d[a])))}),this):void 0},is:function(e){var t=p(e),i=!0,n=this;return f(h,function(e,o){var a,s=t[o.cache];return s&&(a=n[o.cache]||o.to&&o.to(n._rgba)||[],f(o.props,function(e,t){return null!=s[t.idx]?i=s[t.idx]===a[t.idx]:void 0})),i}),i},_space:function(){var e=[],t=this;return f(h,function(i,n){t[n.cache]&&e.push(i)}),e.pop()},transition:function(e,t){var n=p(e),o=n._space(),a=h[o],s=0===this.alpha()?p("transparent"):this,r=s[a.cache]||a.to(s._rgba),l=r.slice();return n=n[a.cache],f(a.props,function(e,o){var a=o.idx,s=r[a],p=n[a],h=d[o.type]||{};null!==p&&(null===s?l[a]=p:(h.mod&&(p-s>h.mod/2?s+=h.mod:s-p>h.mod/2&&(s-=h.mod)),l[a]=i((p-s)*t+s,o)))}),this[o](l)},blend:function(t){if(1===this._rgba[3])return this;var i=this._rgba.slice(),n=i.pop(),o=p(t)._rgba;return p(e.map(i,function(e,t){return(1-n)*o[t]+n*e}))},toRgbaString:function(){var t="rgba(",i=e.map(this._rgba,function(e,t){return null==e?t>2?1:0:e});return 1===i[3]&&(i.pop(),t="rgb("),t+i.join()+")"},toHslaString:function(){var t="hsla(",i=e.map(this.hsla(),function(e,t){return null==e&&(e=t>2?1:0),t&&3>t&&(e=Math.round(100*e)+"%"),e});return 1===i[3]&&(i.pop(),t="hsl("),t+i.join()+")"},toHexString:function(t){var i=this._rgba.slice(),n=i.pop();return t&&i.push(~~(255*n)),"#"+e.map(i,function(e){return e=(e||0).toString(16),1===e.length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),p.fn.parse.prototype=p.fn,h.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,i,n=e[0]/255,o=e[1]/255,a=e[2]/255,s=e[3],r=Math.max(n,o,a),l=Math.min(n,o,a),p=r-l,h=r+l,d=.5*h;return t=l===r?0:n===r?60*(o-a)/p+360:o===r?60*(a-n)/p+120:60*(n-o)/p+240,i=0===p?0:.5>=d?p/h:p/(2-h),[Math.round(t)%360,i,d,null==s?1:s]},h.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,i=e[1],n=e[2],a=e[3],s=.5>=n?n*(1+i):n+i-n*i,r=2*n-s;return[Math.round(255*o(r,s,t+1/3)),Math.round(255*o(r,s,t)),Math.round(255*o(r,s,t-1/3)),a]},f(h,function(n,o){var a=o.props,s=o.cache,l=o.to,h=o.from;p.fn[n]=function(n){if(l&&!this[s]&&(this[s]=l(this._rgba)),n===t)return this[s].slice();var o,r=e.type(n),d="array"===r||"object"===r?n:arguments,c=this[s].slice();return f(a,function(e,t){var n=d["object"===r?e:t.idx];null==n&&(n=c[t.idx]),c[t.idx]=i(n,t)}),h?(o=p(h(c)),o[s]=c,o):p(c)},f(a,function(t,i){p.fn[t]||(p.fn[t]=function(o){var a,s=e.type(o),l="alpha"===t?this._hsla?"hsla":"rgba":n,p=this[l](),h=p[i.idx];return"undefined"===s?h:("function"===s&&(o=o.call(this,h),s=e.type(o)),null==o&&i.empty?this:("string"===s&&(a=r.exec(o),a&&(o=h+parseFloat(a[2])*("+"===a[1]?1:-1))),p[i.idx]=o,this[l](p)))})})}),p.hook=function(t){var i=t.split(" ");f(i,function(t,i){e.cssHooks[i]={set:function(t,o){var a,s,r="";if("transparent"!==o&&("string"!==e.type(o)||(a=n(o)))){if(o=p(a||o),!c.rgba&&1!==o._rgba[3]){for(s="backgroundColor"===i?t.parentNode:t;(""===r||"transparent"===r)&&s&&s.style;)try{r=e.css(s,"backgroundColor"),s=s.parentNode}catch(l){}o=o.blend(r&&"transparent"!==r?r:"_default")}o=o.toRgbaString()}try{t.style[i]=o}catch(l){}}},e.fx.step[i]=function(t){t.colorInit||(t.start=p(t.elem,i),t.end=p(t.end),t.colorInit=!0),e.cssHooks[i].set(t.elem,t.start.transition(t.end,t.pos))}})},p.hook(s),e.cssHooks.borderColor={expand:function(e){var t={};return f(["Top","Right","Bottom","Left"],function(i,n){t["border"+n+"Color"]=e}),t}},a=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function t(t){var i,n,o=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,a={};if(o&&o.length&&o[0]&&o[o[0]])for(n=o.length;n--;)i=o[n],"string"==typeof o[i]&&(a[e.camelCase(i)]=o[i]);else for(i in o)"string"==typeof o[i]&&(a[i]=o[i]);return a}function i(t,i){var n,a,s={};for(n in i)a=i[n],t[n]!==a&&(o[n]||(e.fx.step[n]||!isNaN(parseFloat(a)))&&(s[n]=a));return s}var n=["add","remove","toggle"],o={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,i){e.fx.step[i]=function(e){("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(jQuery.style(e.elem,i,e.end),e.setAttr=!0)}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e.effects.animateClass=function(o,a,s,r){var l=e.speed(a,s,r);return this.queue(function(){var a,s=e(this),r=s.attr("class")||"",p=l.children?s.find("*").addBack():s;p=p.map(function(){var i=e(this);return{el:i,start:t(this)}}),a=function(){e.each(n,function(e,t){o[t]&&s[t+"Class"](o[t])})},a(),p=p.map(function(){return this.end=t(this.el[0]),this.diff=i(this.start,this.end),this}),s.attr("class",r),p=p.map(function(){var t=this,i=e.Deferred(),n=e.extend({},l,{queue:!1,complete:function(){i.resolve(t)}});return this.el.animate(this.diff,n),i.promise()}),e.when.apply(e,p.get()).done(function(){a(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})}),l.complete.call(s[0])})})},e.fn.extend({addClass:function(t){return function(i,n,o,a){return n?e.effects.animateClass.call(this,{add:i},n,o,a):t.apply(this,arguments)}}(e.fn.addClass),removeClass:function(t){return function(i,n,o,a){return arguments.length>1?e.effects.animateClass.call(this,{remove:i},n,o,a):t.apply(this,arguments)}}(e.fn.removeClass),toggleClass:function(t){return function(i,n,o,a,s){return"boolean"==typeof n||void 0===n?o?e.effects.animateClass.call(this,n?{add:i}:{remove:i},o,a,s):t.apply(this,arguments):e.effects.animateClass.call(this,{toggle:i},n,o,a)}}(e.fn.toggleClass),switchClass:function(t,i,n,o,a){return e.effects.animateClass.call(this,{add:i,remove:t},n,o,a)}})}(),function(){function t(t,i,n,o){return e.isPlainObject(t)&&(i=t,t=t.effect),t={effect:t},null==i&&(i={}),e.isFunction(i)&&(o=i,n=null,i={}),("number"==typeof i||e.fx.speeds[i])&&(o=n,n=i,i={}),e.isFunction(n)&&(o=n,n=null),i&&e.extend(t,i),n=n||i.duration,t.duration=e.fx.off?0:"number"==typeof n?n:n in e.fx.speeds?e.fx.speeds[n]:e.fx.speeds._default,t.complete=o||i.complete,t}function i(t){return!t||"number"==typeof t||e.fx.speeds[t]?!0:"string"!=typeof t||e.effects.effect[t]?e.isFunction(t)?!0:"object"!=typeof t||t.effect?!1:!0:!0}e.extend(e.effects,{version:"1.11.0",save:function(e,t){for(var i=0;i<t.length;i++)null!==t[i]&&e.data(_+t[i],e[0].style[t[i]])},restore:function(e,t){var i,n;for(n=0;n<t.length;n++)null!==t[n]&&(i=e.data(_+t[n]),void 0===i&&(i=""),e.css(t[n],i))},setMode:function(e,t){return"toggle"===t&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var i,n;switch(e[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=e[0]/t.height}switch(e[1]){case"left":n=0;break;case"center":n=.5;break;case"right":n=1;break;default:n=e[1]/t.width}return{x:n,y:i}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var i={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},n=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),o={width:t.width(),height:t.height()},a=document.activeElement;try{a.id}catch(s){a=document.body}return t.wrap(n),(t[0]===a||e.contains(t[0],a))&&e(a).focus(),n=t.parent(),"static"===t.css("position")?(n.css({position:"relative"}),t.css({position:"relative"})):(e.extend(i,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,n){i[n]=t.css(n),isNaN(parseInt(i[n],10))&&(i[n]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(o),n.css(i).show()},removeWrapper:function(t){var i=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===i||e.contains(t[0],i))&&e(i).focus()),t},setTransition:function(t,i,n,o){return o=o||{},e.each(i,function(e,i){var a=t.cssUnit(i);a[0]>0&&(o[i]=a[0]*n+a[1])}),o}}),e.fn.extend({effect:function(){function i(t){function i(){e.isFunction(a)&&a.call(o[0]),e.isFunction(t)&&t()}var o=e(this),a=n.complete,r=n.mode;(o.is(":hidden")?"hide"===r:"show"===r)?(o[r](),i()):s.call(o[0],n,i)}var n=t.apply(this,arguments),o=n.mode,a=n.queue,s=e.effects.effect[n.effect];return e.fx.off||!s?o?this[o](n.duration,n.complete):this.each(function(){n.complete&&n.complete.call(this)}):a===!1?this.each(i):this.queue(a||"fx",i)},show:function(e){return function(n){if(i(n))return e.apply(this,arguments);var o=t.apply(this,arguments);return o.mode="show",this.effect.call(this,o)}}(e.fn.show),hide:function(e){return function(n){if(i(n))return e.apply(this,arguments);var o=t.apply(this,arguments);return o.mode="hide",this.effect.call(this,o)}}(e.fn.hide),toggle:function(e){return function(n){if(i(n)||"boolean"==typeof n)return e.apply(this,arguments);var o=t.apply(this,arguments);return o.mode="toggle",this.effect.call(this,o)}}(e.fn.toggle),cssUnit:function(t){var i=this.css(t),n=[];return e.each(["em","px","%","pt"],function(e,t){i.indexOf(t)>0&&(n=[parseFloat(i),t])}),n}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,i){t[i]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,i=4;e<((t=Math.pow(2,--i))-1)/11;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*t-2)/22-e,2)}}),e.each(t,function(t,i){e.easing["easeIn"+t]=i,e.easing["easeOut"+t]=function(e){return 1-i(1-e)},e.easing["easeInOut"+t]=function(e){return.5>e?i(2*e)/2:1-i(-2*e+2)/2}})}();e.effects,e.effects.effect.blind=function(t,i){var n,o,a,s=e(this),r=/up|down|vertical/,l=/up|left|vertical|horizontal/,p=["position","top","bottom","left","right","height","width"],h=e.effects.setMode(s,t.mode||"hide"),d=t.direction||"up",c=r.test(d),u=c?"height":"width",f=c?"top":"left",g=l.test(d),m={},_="show"===h;s.parent().is(".ui-effects-wrapper")?e.effects.save(s.parent(),p):e.effects.save(s,p),s.show(),n=e.effects.createWrapper(s).css({overflow:"hidden"}),o=n[u](),a=parseFloat(n.css(f))||0,m[u]=_?o:0,g||(s.css(c?"bottom":"right",0).css(c?"top":"left","auto").css({position:"absolute"}),m[f]=_?a:o+a),_&&(n.css(u,0),g||n.css(f,a+o)),n.animate(m,{duration:t.duration,easing:t.easing,queue:!1,complete:function(){"hide"===h&&s.hide(),e.effects.restore(s,p),e.effects.removeWrapper(s),i()}})},e.effects.effect.bounce=function(t,i){var n,o,a,s=e(this),r=["position","top","bottom","left","right","height","width"],l=e.effects.setMode(s,t.mode||"effect"),p="hide"===l,h="show"===l,d=t.direction||"up",c=t.distance,u=t.times||5,f=2*u+(h||p?1:0),g=t.duration/f,m=t.easing,_="up"===d||"down"===d?"top":"left",w="up"===d||"left"===d,b=s.queue(),v=b.length;for((h||p)&&r.push("opacity"),e.effects.save(s,r),s.show(),e.effects.createWrapper(s),c||(c=s["top"===_?"outerHeight":"outerWidth"]()/3),h&&(a={opacity:1},a[_]=0,s.css("opacity",0).css(_,w?2*-c:2*c).animate(a,g,m)),p&&(c/=Math.pow(2,u-1)),a={},a[_]=0,n=0;u>n;n++)o={},o[_]=(w?"-=":"+=")+c,s.animate(o,g,m).animate(a,g,m),c=p?2*c:c/2;p&&(o={opacity:0},o[_]=(w?"-=":"+=")+c,s.animate(o,g,m)),s.queue(function(){p&&s.hide(),e.effects.restore(s,r),e.effects.removeWrapper(s),i()}),v>1&&b.splice.apply(b,[1,0].concat(b.splice(v,f+1))),s.dequeue()},e.effects.effect.clip=function(t,i){var n,o,a,s=e(this),r=["position","top","bottom","left","right","height","width"],l=e.effects.setMode(s,t.mode||"hide"),p="show"===l,h=t.direction||"vertical",d="vertical"===h,c=d?"height":"width",u=d?"top":"left",f={};e.effects.save(s,r),s.show(),n=e.effects.createWrapper(s).css({overflow:"hidden"}),o="IMG"===s[0].tagName?n:s,a=o[c](),p&&(o.css(c,0),o.css(u,a/2)),f[c]=p?a:0,f[u]=p?0:a/2,o.animate(f,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){p||s.hide(),e.effects.restore(s,r),e.effects.removeWrapper(s),i()}})},e.effects.effect.drop=function(t,i){var n,o=e(this),a=["position","top","bottom","left","right","opacity","height","width"],s=e.effects.setMode(o,t.mode||"hide"),r="show"===s,l=t.direction||"left",p="up"===l||"down"===l?"top":"left",h="up"===l||"left"===l?"pos":"neg",d={opacity:r?1:0};e.effects.save(o,a),o.show(),e.effects.createWrapper(o),n=t.distance||o["top"===p?"outerHeight":"outerWidth"](!0)/2,r&&o.css("opacity",0).css(p,"pos"===h?-n:n),d[p]=(r?"pos"===h?"+=":"-=":"pos"===h?"-=":"+=")+n,o.animate(d,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===s&&o.hide(),e.effects.restore(o,a),e.effects.removeWrapper(o),i()}})},e.effects.effect.explode=function(t,i){function n(){b.push(this),b.length===d*c&&o()}function o(){u.css({visibility:"visible"}),e(b).remove(),g||u.hide(),i()}var a,s,r,l,p,h,d=t.pieces?Math.round(Math.sqrt(t.pieces)):3,c=d,u=e(this),f=e.effects.setMode(u,t.mode||"hide"),g="show"===f,m=u.show().css("visibility","hidden").offset(),_=Math.ceil(u.outerWidth()/c),w=Math.ceil(u.outerHeight()/d),b=[];for(a=0;d>a;a++)for(l=m.top+a*w,h=a-(d-1)/2,s=0;c>s;s++)r=m.left+s*_,p=s-(c-1)/2,u.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-s*_,top:-a*w}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:_,height:w,left:r+(g?p*_:0),top:l+(g?h*w:0),opacity:g?0:1}).animate({left:r+(g?0:p*_),top:l+(g?0:h*w),opacity:g?1:0},t.duration||500,t.easing,n)},e.effects.effect.fade=function(t,i){var n=e(this),o=e.effects.setMode(n,t.mode||"toggle");n.animate({opacity:o},{queue:!1,duration:t.duration,easing:t.easing,complete:i})},e.effects.effect.fold=function(t,i){var n,o,a=e(this),s=["position","top","bottom","left","right","height","width"],r=e.effects.setMode(a,t.mode||"hide"),l="show"===r,p="hide"===r,h=t.size||15,d=/([0-9]+)%/.exec(h),c=!!t.horizFirst,u=l!==c,f=u?["width","height"]:["height","width"],g=t.duration/2,m={},_={};e.effects.save(a,s),a.show(),n=e.effects.createWrapper(a).css({overflow:"hidden"}),o=u?[n.width(),n.height()]:[n.height(),n.width()],d&&(h=parseInt(d[1],10)/100*o[p?0:1]),l&&n.css(c?{height:0,width:h}:{height:h,width:0}),m[f[0]]=l?o[0]:h,_[f[1]]=l?o[1]:0,n.animate(m,g,t.easing).animate(_,g,t.easing,function(){p&&a.hide(),e.effects.restore(a,s),e.effects.removeWrapper(a),i()})},e.effects.effect.highlight=function(t,i){var n=e(this),o=["backgroundImage","backgroundColor","opacity"],a=e.effects.setMode(n,t.mode||"show"),s={backgroundColor:n.css("backgroundColor")};"hide"===a&&(s.opacity=0),e.effects.save(n,o),n.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(s,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===a&&n.hide(),e.effects.restore(n,o),i()}})},e.effects.effect.size=function(t,i){var n,o,a,s=e(this),r=["position","top","bottom","left","right","width","height","overflow","opacity"],l=["position","top","bottom","left","right","overflow","opacity"],p=["width","height","overflow"],h=["fontSize"],d=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],c=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],u=e.effects.setMode(s,t.mode||"effect"),f=t.restore||"effect"!==u,g=t.scale||"both",m=t.origin||["middle","center"],_=s.css("position"),w=f?r:l,b={height:0,width:0,outerHeight:0,outerWidth:0};"show"===u&&s.show(),n={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()},"toggle"===t.mode&&"show"===u?(s.from=t.to||b,s.to=t.from||n):(s.from=t.from||("show"===u?b:n),s.to=t.to||("hide"===u?b:n)),a={from:{y:s.from.height/n.height,x:s.from.width/n.width},to:{y:s.to.height/n.height,x:s.to.width/n.width}},("box"===g||"both"===g)&&(a.from.y!==a.to.y&&(w=w.concat(d),s.from=e.effects.setTransition(s,d,a.from.y,s.from),s.to=e.effects.setTransition(s,d,a.to.y,s.to)),a.from.x!==a.to.x&&(w=w.concat(c),s.from=e.effects.setTransition(s,c,a.from.x,s.from),s.to=e.effects.setTransition(s,c,a.to.x,s.to))),("content"===g||"both"===g)&&a.from.y!==a.to.y&&(w=w.concat(h).concat(p),s.from=e.effects.setTransition(s,h,a.from.y,s.from),s.to=e.effects.setTransition(s,h,a.to.y,s.to)),e.effects.save(s,w),s.show(),e.effects.createWrapper(s),s.css("overflow","hidden").css(s.from),m&&(o=e.effects.getBaseline(m,n),s.from.top=(n.outerHeight-s.outerHeight())*o.y,s.from.left=(n.outerWidth-s.outerWidth())*o.x,s.to.top=(n.outerHeight-s.to.outerHeight)*o.y,s.to.left=(n.outerWidth-s.to.outerWidth)*o.x),s.css(s.from),("content"===g||"both"===g)&&(d=d.concat(["marginTop","marginBottom"]).concat(h),c=c.concat(["marginLeft","marginRight"]),p=r.concat(d).concat(c),s.find("*[width]").each(function(){var i=e(this),n={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};f&&e.effects.save(i,p),i.from={height:n.height*a.from.y,width:n.width*a.from.x,outerHeight:n.outerHeight*a.from.y,outerWidth:n.outerWidth*a.from.x},i.to={height:n.height*a.to.y,width:n.width*a.to.x,outerHeight:n.height*a.to.y,outerWidth:n.width*a.to.x},a.from.y!==a.to.y&&(i.from=e.effects.setTransition(i,d,a.from.y,i.from),i.to=e.effects.setTransition(i,d,a.to.y,i.to)),a.from.x!==a.to.x&&(i.from=e.effects.setTransition(i,c,a.from.x,i.from),i.to=e.effects.setTransition(i,c,a.to.x,i.to)),i.css(i.from),i.animate(i.to,t.duration,t.easing,function(){f&&e.effects.restore(i,p)})})),s.animate(s.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){0===s.to.opacity&&s.css("opacity",s.from.opacity),"hide"===u&&s.hide(),e.effects.restore(s,w),f||("static"===_?s.css({position:"relative",top:s.to.top,left:s.to.left}):e.each(["top","left"],function(e,t){s.css(t,function(t,i){var n=parseInt(i,10),o=e?s.to.left:s.to.top;return"auto"===i?o+"px":n+o+"px"})})),e.effects.removeWrapper(s),i()}})},e.effects.effect.scale=function(t,i){var n=e(this),o=e.extend(!0,{},t),a=e.effects.setMode(n,t.mode||"effect"),s=parseInt(t.percent,10)||(0===parseInt(t.percent,10)?0:"hide"===a?0:100),r=t.direction||"both",l=t.origin,p={height:n.height(),width:n.width(),outerHeight:n.outerHeight(),outerWidth:n.outerWidth()},h={y:"horizontal"!==r?s/100:1,x:"vertical"!==r?s/100:1};o.effect="size",o.queue=!1,o.complete=i,"effect"!==a&&(o.origin=l||["middle","center"],o.restore=!0),o.from=t.from||("show"===a?{height:0,width:0,outerHeight:0,outerWidth:0}:p),o.to={height:p.height*h.y,width:p.width*h.x,outerHeight:p.outerHeight*h.y,outerWidth:p.outerWidth*h.x},o.fade&&("show"===a&&(o.from.opacity=0,o.to.opacity=1),"hide"===a&&(o.from.opacity=1,o.to.opacity=0)),n.effect(o)},e.effects.effect.puff=function(t,i){var n=e(this),o=e.effects.setMode(n,t.mode||"hide"),a="hide"===o,s=parseInt(t.percent,10)||150,r=s/100,l={height:n.height(),width:n.width(),outerHeight:n.outerHeight(),outerWidth:n.outerWidth()};e.extend(t,{effect:"scale",queue:!1,fade:!0,mode:o,complete:i,percent:a?s:100,from:a?l:{height:l.height*r,width:l.width*r,outerHeight:l.outerHeight*r,outerWidth:l.outerWidth*r}}),n.effect(t)},e.effects.effect.pulsate=function(t,i){var n,o=e(this),a=e.effects.setMode(o,t.mode||"show"),s="show"===a,r="hide"===a,l=s||"hide"===a,p=2*(t.times||5)+(l?1:0),h=t.duration/p,d=0,c=o.queue(),u=c.length;for((s||!o.is(":visible"))&&(o.css("opacity",0).show(),d=1),n=1;p>n;n++)o.animate({opacity:d},h,t.easing),d=1-d;o.animate({opacity:d},h,t.easing),o.queue(function(){r&&o.hide(),i()}),u>1&&c.splice.apply(c,[1,0].concat(c.splice(u,p+1))),o.dequeue()},e.effects.effect.shake=function(t,i){var n,o=e(this),a=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(o,t.mode||"effect"),r=t.direction||"left",l=t.distance||20,p=t.times||3,h=2*p+1,d=Math.round(t.duration/h),c="up"===r||"down"===r?"top":"left",u="up"===r||"left"===r,f={},g={},m={},_=o.queue(),w=_.length;for(e.effects.save(o,a),o.show(),e.effects.createWrapper(o),f[c]=(u?"-=":"+=")+l,g[c]=(u?"+=":"-=")+2*l,m[c]=(u?"-=":"+=")+2*l,o.animate(f,d,t.easing),n=1;p>n;n++)o.animate(g,d,t.easing).animate(m,d,t.easing);o.animate(g,d,t.easing).animate(f,d/2,t.easing).queue(function(){"hide"===s&&o.hide(),e.effects.restore(o,a),e.effects.removeWrapper(o),i()}),w>1&&_.splice.apply(_,[1,0].concat(_.splice(w,h+1))),o.dequeue()},e.effects.effect.slide=function(t,i){var n,o=e(this),a=["position","top","bottom","left","right","width","height"],s=e.effects.setMode(o,t.mode||"show"),r="show"===s,l=t.direction||"left",p="up"===l||"down"===l?"top":"left",h="up"===l||"left"===l,d={};e.effects.save(o,a),o.show(),n=t.distance||o["top"===p?"outerHeight":"outerWidth"](!0),e.effects.createWrapper(o).css({overflow:"hidden"}),r&&o.css(p,h?isNaN(n)?"-"+n:-n:n),d[p]=(r?h?"+=":"-=":h?"-=":"+=")+n,o.animate(d,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===s&&o.hide(),e.effects.restore(o,a),e.effects.removeWrapper(o),i()}})},e.effects.effect.transfer=function(t,i){var n=e(this),o=e(t.to),a="fixed"===o.css("position"),s=e("body"),r=a?s.scrollTop():0,l=a?s.scrollLeft():0,p=o.offset(),h={top:p.top-r,left:p.left-l,height:o.innerHeight(),width:o.innerWidth()},d=n.offset(),c=e("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(t.className).css({top:d.top-r,left:d.left-l,height:n.innerHeight(),width:n.innerWidth(),position:a?"fixed":"absolute"}).animate(h,t.duration,t.easing,function(){c.remove(),i()})}}),function(e){function t(e,t){if(!(e.originalEvent.touches.length>1)){e.preventDefault();var i=e.originalEvent.changedTouches[0],n=document.createEvent("MouseEvents");n.initMouseEvent(t,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(n)}}if(e.support.touch="ontouchend"in document,e.support.touch){var i,n=e.ui.mouse.prototype,o=n._mouseInit;n._touchStart=function(e){var n=this;!i&&n._mouseCapture(e.originalEvent.changedTouches[0])&&(i=!0,n._touchMoved=!1,t(e,"mouseover"),t(e,"mousemove"),t(e,"mousedown"))},n._touchMove=function(e){i&&(this._touchMoved=!0,t(e,"mousemove"))},n._touchEnd=function(e){i&&(t(e,"mouseup"),t(e,"mouseout"),this._touchMoved||t(e,"click"),i=!1)},n._mouseInit=function(){var t=this;t.element.bind("touchstart",e.proxy(t,"_touchStart")).bind("touchmove",e.proxy(t,"_touchMove")).bind("touchend",e.proxy(t,"_touchEnd")),o.call(t)}}}(jQuery),jQuery.cookie=function(e,t,i){if("undefined"==typeof t){var n=null;if(document.cookie&&""!=document.cookie)for(var o=document.cookie.split(";"),a=0;a<o.length;a++){var s=jQuery.trim(o[a]);if(s.substring(0,e.length+1)==e+"="){n=decodeURIComponent(s.substring(e.length+1));break}}return n}i=i||{},null===t&&(t="",i.expires=-1);var r="";if(i.expires&&("number"==typeof i.expires||i.expires.toUTCString)){var l;"number"==typeof i.expires?(l=new Date,l.setTime(l.getTime()+24*i.expires*60*60*1e3)):l=i.expires,r="; expires="+l.toUTCString()}var p=i.path?"; path="+i.path:"",h=i.domain?"; domain="+i.domain:"",d=i.secure?"; secure":"";document.cookie=[e,"=",encodeURIComponent(t),r,p,h,d].join("")},function(e){function t(t){if("string"==typeof t.data){var i=t.handler,n=t.data.toLowerCase().split(" ");t.handler=function(t){if(this===t.target||!/textarea|select/i.test(t.target.nodeName)&&"text"!==t.target.type){var o="keypress"!==t.type&&e.hotkeys.specialKeys[t.which],a=String.fromCharCode(t.which).toLowerCase(),s="",r={};t.altKey&&"alt"!==o&&(s+="alt+"),t.ctrlKey&&"ctrl"!==o&&(s+="ctrl+"),t.metaKey&&!t.ctrlKey&&"meta"!==o&&(s+="meta+"),t.shiftKey&&"shift"!==o&&(s+="shift+"),o?r[s+o]=!0:(r[s+a]=!0,r[s+e.hotkeys.shiftNums[a]]=!0,"shift+"===s&&(r[e.hotkeys.shiftNums[a]]=!0));for(var l=0,p=n.length;p>l;l++)if(r[n[l]])return i.apply(this,arguments)}}}}e.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}},e.each(["keydown","keyup","keypress"],function(){e.event.special[this]={add:t}})}(jQuery),jQuery.fn.hammer=function(e){return this.each(function(){var t=new Hammer(this,e),i=jQuery(this);i.data("hammer",t);for(var n=["hold","tap","doubletap","transformstart","transform","transformend","dragstart","drag","dragend","swipe","release"],o=0;o<n.length;o++)t["on"+n[o]]=function(e,t){return function(i){e.trigger(jQuery.Event(t,i))}}(i,n[o])})},ClusterIcon.prototype.onAdd=function(){var e,t,i=this;this.div_=document.createElement("div"),this.div_.className=this.className_,this.visible_&&this.show(),this.getPanes().overlayMouseTarget.appendChild(this.div_),this.boundsChangedListener_=google.maps.event.addListener(this.getMap(),"bounds_changed",function(){t=e}),google.maps.event.addDomListener(this.div_,"mousedown",function(){e=!0,t=!1}),google.maps.event.addDomListener(this.div_,"click",function(n){if(e=!1,!t){var o,a,s=i.cluster_.getMarkerClusterer();google.maps.event.trigger(s,"click",i.cluster_),google.maps.event.trigger(s,"clusterclick",i.cluster_),s.getZoomOnClick()&&(a=s.getMaxZoom(),o=i.cluster_.getBounds(),s.getMap().fitBounds(o),setTimeout(function(){s.getMap().fitBounds(o),null!==a&&s.getMap().getZoom()>a&&s.getMap().setZoom(a+1)},100)),n.cancelBubble=!0,n.stopPropagation&&n.stopPropagation()}}),google.maps.event.addDomListener(this.div_,"mouseover",function(){var e=i.cluster_.getMarkerClusterer();google.maps.event.trigger(e,"mouseover",i.cluster_)}),google.maps.event.addDomListener(this.div_,"mouseout",function(){var e=i.cluster_.getMarkerClusterer();google.maps.event.trigger(e,"mouseout",i.cluster_)})},ClusterIcon.prototype.onRemove=function(){this.div_&&this.div_.parentNode&&(this.hide(),google.maps.event.removeListener(this.boundsChangedListener_),google.maps.event.clearInstanceListeners(this.div_),this.div_.parentNode.removeChild(this.div_),this.div_=null)},ClusterIcon.prototype.draw=function(){if(this.visible_){var e=this.getPosFromLatLng_(this.center_);this.div_.style.top=e.y+"px",this.div_.style.left=e.x+"px"}},ClusterIcon.prototype.hide=function(){this.div_&&(this.div_.style.display="none"),this.visible_=!1},ClusterIcon.prototype.show=function(){if(this.div_){var e="",t=this.backgroundPosition_.split(" "),i=parseInt(t[0].trim(),10),n=parseInt(t[1].trim(),10),o=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(o),e="<img src='"+this.url_+"' style='position: absolute; top: "+n+"px; left: "+i+"px; ",this.cluster_.getMarkerClusterer().enableRetinaIcons_||(e+="clip: rect("+-1*n+"px, "+(-1*i+this.width_)+"px, "+(-1*n+this.height_)+"px, "+-1*i+"px);"),e+="'>",this.div_.innerHTML=e+"<div style='position: absolute;top: "+this.anchorText_[0]+"px;left: "+this.anchorText_[1]+"px;color: "+this.textColor_+";font-size: "+this.textSize_+"px;font-family: "+this.fontFamily_+";font-weight: "+this.fontWeight_+";font-style: "+this.fontStyle_+";text-decoration: "+this.textDecoration_+";text-align: center;width: "+this.width_+"px;line-height:"+this.height_+"px;'>"+this.sums_.text+"</div>",this.div_.title="undefined"==typeof this.sums_.title||""===this.sums_.title?this.cluster_.getMarkerClusterer().getTitle():this.sums_.title,this.div_.style.display=""}this.visible_=!0},ClusterIcon.prototype.useStyle=function(e){this.sums_=e;var t=Math.max(0,e.index-1);t=Math.min(this.styles_.length-1,t);var i=this.styles_[t];this.url_=i.url,this.height_=i.height,this.width_=i.width,this.anchorText_=i.anchorText||[0,0],this.anchorIcon_=i.anchorIcon||[parseInt(this.height_/2,10),parseInt(this.width_/2,10)],this.textColor_=i.textColor||"black",this.textSize_=i.textSize||11,this.textDecoration_=i.textDecoration||"none",this.fontWeight_=i.fontWeight||"bold",this.fontStyle_=i.fontStyle||"normal",this.fontFamily_=i.fontFamily||"Arial,sans-serif",this.backgroundPosition_=i.backgroundPosition||"0 0"},ClusterIcon.prototype.setCenter=function(e){this.center_=e
},ClusterIcon.prototype.createCss=function(e){var t=[];return t.push("cursor: pointer;"),t.push("position: absolute; top: "+e.y+"px; left: "+e.x+"px;"),t.push("width: "+this.width_+"px; height: "+this.height_+"px;"),t.join("")},ClusterIcon.prototype.getPosFromLatLng_=function(e){var t=this.getProjection().fromLatLngToDivPixel(e);return t.x-=this.anchorIcon_[1],t.y-=this.anchorIcon_[0],t.x=parseInt(t.x,10),t.y=parseInt(t.y,10),t},Cluster.prototype.getSize=function(){return this.markers_.length},Cluster.prototype.getMarkers=function(){return this.markers_},Cluster.prototype.getCenter=function(){return this.center_},Cluster.prototype.getMap=function(){return this.map_},Cluster.prototype.getMarkerClusterer=function(){return this.markerClusterer_},Cluster.prototype.getBounds=function(){var e,t=new google.maps.LatLngBounds(this.center_,this.center_),i=this.getMarkers();for(e=0;e<i.length;e++)t.extend(i[e].getPosition());return t},Cluster.prototype.remove=function(){this.clusterIcon_.setMap(null),this.markers_=[],delete this.markers_},Cluster.prototype.addMarker=function(e){var t,i,n;if(this.isMarkerAlreadyAdded_(e))return!1;if(this.center_){if(this.averageCenter_){var o=this.markers_.length+1,a=(this.center_.lat()*(o-1)+e.getPosition().lat())/o,s=(this.center_.lng()*(o-1)+e.getPosition().lng())/o;this.center_=new google.maps.LatLng(a,s),this.calculateBounds_()}}else this.center_=e.getPosition(),this.calculateBounds_();if(e.isAdded=!0,this.markers_.push(e),i=this.markers_.length,n=this.markerClusterer_.getMaxZoom(),null!==n&&this.map_.getZoom()>n)e.getMap()!==this.map_&&e.setMap(this.map_);else if(i<this.minClusterSize_)e.getMap()!==this.map_&&e.setMap(this.map_);else if(i===this.minClusterSize_)for(t=0;i>t;t++)this.markers_[t].setMap(null);else e.setMap(null);return this.updateIcon_(),!0},Cluster.prototype.isMarkerInClusterBounds=function(e){return this.bounds_.contains(e.getPosition())},Cluster.prototype.calculateBounds_=function(){var e=new google.maps.LatLngBounds(this.center_,this.center_);this.bounds_=this.markerClusterer_.getExtendedBounds(e)},Cluster.prototype.updateIcon_=function(){var e=this.markers_.length,t=this.markerClusterer_.getMaxZoom();if(null!==t&&this.map_.getZoom()>t)return void this.clusterIcon_.hide();if(e<this.minClusterSize_)return void this.clusterIcon_.hide();var i=this.markerClusterer_.getStyles().length,n=this.markerClusterer_.getCalculator()(this.markers_,i);this.clusterIcon_.setCenter(this.center_),this.clusterIcon_.useStyle(n),this.clusterIcon_.show()},Cluster.prototype.isMarkerAlreadyAdded_=function(e){var t;if(this.markers_.indexOf)return-1!==this.markers_.indexOf(e);for(t=0;t<this.markers_.length;t++)if(e===this.markers_[t])return!0;return!1},MarkerClusterer.prototype.onAdd=function(){var e=this;this.activeMap_=this.getMap(),this.ready_=!0,this.repaint(),this.listeners_=[google.maps.event.addListener(this.getMap(),"zoom_changed",function(){e.resetViewport_(!1),(this.getZoom()===(this.get("minZoom")||0)||this.getZoom()===this.get("maxZoom"))&&google.maps.event.trigger(this,"idle")}),google.maps.event.addListener(this.getMap(),"idle",function(){e.redraw_()})]},MarkerClusterer.prototype.onRemove=function(){var e;for(e=0;e<this.markers_.length;e++)this.markers_[e].getMap()!==this.activeMap_&&this.markers_[e].setMap(this.activeMap_);for(e=0;e<this.clusters_.length;e++)this.clusters_[e].remove();for(this.clusters_=[],e=0;e<this.listeners_.length;e++)google.maps.event.removeListener(this.listeners_[e]);this.listeners_=[],this.activeMap_=null,this.ready_=!1},MarkerClusterer.prototype.draw=function(){},MarkerClusterer.prototype.setupStyles_=function(){var e,t;if(!(this.styles_.length>0))for(e=0;e<this.imageSizes_.length;e++)t=this.imageSizes_[e],this.styles_.push({url:this.imagePath_+(e+1)+"."+this.imageExtension_,height:t,width:t})},MarkerClusterer.prototype.fitMapToMarkers=function(){var e,t=this.getMarkers(),i=new google.maps.LatLngBounds;for(e=0;e<t.length;e++)i.extend(t[e].getPosition());this.getMap().fitBounds(i)},MarkerClusterer.prototype.getGridSize=function(){return this.gridSize_},MarkerClusterer.prototype.setGridSize=function(e){this.gridSize_=e},MarkerClusterer.prototype.getMinimumClusterSize=function(){return this.minClusterSize_},MarkerClusterer.prototype.setMinimumClusterSize=function(e){this.minClusterSize_=e},MarkerClusterer.prototype.getMaxZoom=function(){return this.maxZoom_},MarkerClusterer.prototype.setMaxZoom=function(e){this.maxZoom_=e},MarkerClusterer.prototype.getStyles=function(){return this.styles_},MarkerClusterer.prototype.setStyles=function(e){this.styles_=e},MarkerClusterer.prototype.getTitle=function(){return this.title_},MarkerClusterer.prototype.setTitle=function(e){this.title_=e},MarkerClusterer.prototype.getZoomOnClick=function(){return this.zoomOnClick_},MarkerClusterer.prototype.setZoomOnClick=function(e){this.zoomOnClick_=e},MarkerClusterer.prototype.getAverageCenter=function(){return this.averageCenter_},MarkerClusterer.prototype.setAverageCenter=function(e){this.averageCenter_=e},MarkerClusterer.prototype.getIgnoreHidden=function(){return this.ignoreHidden_},MarkerClusterer.prototype.setIgnoreHidden=function(e){this.ignoreHidden_=e},MarkerClusterer.prototype.getEnableRetinaIcons=function(){return this.enableRetinaIcons_},MarkerClusterer.prototype.setEnableRetinaIcons=function(e){this.enableRetinaIcons_=e},MarkerClusterer.prototype.getImageExtension=function(){return this.imageExtension_},MarkerClusterer.prototype.setImageExtension=function(e){this.imageExtension_=e},MarkerClusterer.prototype.getImagePath=function(){return this.imagePath_},MarkerClusterer.prototype.setImagePath=function(e){this.imagePath_=e},MarkerClusterer.prototype.getImageSizes=function(){return this.imageSizes_},MarkerClusterer.prototype.setImageSizes=function(e){this.imageSizes_=e},MarkerClusterer.prototype.getCalculator=function(){return this.calculator_},MarkerClusterer.prototype.setCalculator=function(e){this.calculator_=e},MarkerClusterer.prototype.getBatchSizeIE=function(){return this.batchSizeIE_},MarkerClusterer.prototype.setBatchSizeIE=function(e){this.batchSizeIE_=e},MarkerClusterer.prototype.getClusterClass=function(){return this.clusterClass_},MarkerClusterer.prototype.setClusterClass=function(e){this.clusterClass_=e},MarkerClusterer.prototype.getMarkers=function(){return this.markers_},MarkerClusterer.prototype.getTotalMarkers=function(){return this.markers_.length},MarkerClusterer.prototype.getClusters=function(){return this.clusters_},MarkerClusterer.prototype.getTotalClusters=function(){return this.clusters_.length},MarkerClusterer.prototype.addMarker=function(e,t){this.pushMarkerTo_(e),t||this.redraw_()},MarkerClusterer.prototype.addMarkers=function(e,t){var i;for(i in e)e.hasOwnProperty(i)&&this.pushMarkerTo_(e[i]);t||this.redraw_()},MarkerClusterer.prototype.pushMarkerTo_=function(e){if(e.getDraggable()){var t=this;google.maps.event.addListener(e,"dragend",function(){t.ready_&&(this.isAdded=!1,t.repaint())})}e.isAdded=!1,this.markers_.push(e)},MarkerClusterer.prototype.removeMarker=function(e,t){var i=this.removeMarker_(e);return!t&&i&&this.repaint(),i},MarkerClusterer.prototype.removeMarkers=function(e,t){var i,n,o=!1;for(i=0;i<e.length;i++)n=this.removeMarker_(e[i]),o=o||n;return!t&&o&&this.repaint(),o},MarkerClusterer.prototype.removeMarker_=function(e){var t,i=-1;if(this.markers_.indexOf)i=this.markers_.indexOf(e);else for(t=0;t<this.markers_.length;t++)if(e===this.markers_[t]){i=t;break}return-1===i?!1:(e.setMap(null),this.markers_.splice(i,1),!0)},MarkerClusterer.prototype.clearMarkers=function(){this.resetViewport_(!0),this.markers_=[]},MarkerClusterer.prototype.repaint=function(){var e=this.clusters_.slice();this.clusters_=[],this.resetViewport_(!1),this.redraw_(),setTimeout(function(){var t;for(t=0;t<e.length;t++)e[t].remove()},0)},MarkerClusterer.prototype.getExtendedBounds=function(e){var t=this.getProjection(),i=new google.maps.LatLng(e.getNorthEast().lat(),e.getNorthEast().lng()),n=new google.maps.LatLng(e.getSouthWest().lat(),e.getSouthWest().lng()),o=t.fromLatLngToDivPixel(i);o.x+=this.gridSize_,o.y-=this.gridSize_;var a=t.fromLatLngToDivPixel(n);a.x-=this.gridSize_,a.y+=this.gridSize_;var s=t.fromDivPixelToLatLng(o),r=t.fromDivPixelToLatLng(a);return e.extend(s),e.extend(r),e},MarkerClusterer.prototype.redraw_=function(){this.createClusters_(0)},MarkerClusterer.prototype.resetViewport_=function(e){var t,i;for(t=0;t<this.clusters_.length;t++)this.clusters_[t].remove();for(this.clusters_=[],t=0;t<this.markers_.length;t++)i=this.markers_[t],i.isAdded=!1,e&&i.setMap(null)},MarkerClusterer.prototype.distanceBetweenPoints_=function(e,t){var i=6371,n=(t.lat()-e.lat())*Math.PI/180,o=(t.lng()-e.lng())*Math.PI/180,a=Math.sin(n/2)*Math.sin(n/2)+Math.cos(e.lat()*Math.PI/180)*Math.cos(t.lat()*Math.PI/180)*Math.sin(o/2)*Math.sin(o/2),s=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),r=i*s;return r},MarkerClusterer.prototype.isMarkerInBounds_=function(e,t){return t.contains(e.getPosition())},MarkerClusterer.prototype.addToClosestCluster_=function(e){var t,i,n,o,a=4e4,s=null;for(t=0;t<this.clusters_.length;t++)n=this.clusters_[t],o=n.getCenter(),o&&(i=this.distanceBetweenPoints_(o,e.getPosition()),a>i&&(a=i,s=n));s&&s.isMarkerInClusterBounds(e)?s.addMarker(e):(n=new Cluster(this),n.addMarker(e),this.clusters_.push(n))},MarkerClusterer.prototype.createClusters_=function(e){var t,i,n,o=this;if(this.ready_){0===e&&(google.maps.event.trigger(this,"clusteringbegin",this),"undefined"!=typeof this.timerRefStatic&&(clearTimeout(this.timerRefStatic),delete this.timerRefStatic)),n=this.getMap().getZoom()>3?new google.maps.LatLngBounds(this.getMap().getBounds().getSouthWest(),this.getMap().getBounds().getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,-178.48388434375),new google.maps.LatLng(-85.08136444384544,178.00048865625));var a=this.getExtendedBounds(n),s=Math.min(e+this.batchSize_,this.markers_.length);for(t=e;s>t;t++)i=this.markers_[t],!i.isAdded&&this.isMarkerInBounds_(i,a)&&(!this.ignoreHidden_||this.ignoreHidden_&&i.getVisible())&&this.addToClosestCluster_(i);s<this.markers_.length?this.timerRefStatic=setTimeout(function(){o.createClusters_(s)},0):(delete this.timerRefStatic,google.maps.event.trigger(this,"clusteringend",this))}},MarkerClusterer.prototype.extend=function(e,t){return function(e){var t;for(t in e.prototype)this.prototype[t]=e.prototype[t];return this}.apply(e,[t])},MarkerClusterer.CALCULATOR=function(e,t){for(var i=0,n="",o=e.length.toString(),a=o;0!==a;)a=parseInt(a/10,10),i++;return i=Math.min(i,t),{text:o,index:i,title:n}},MarkerClusterer.BATCH_SIZE=2e3,MarkerClusterer.BATCH_SIZE_IE=500,MarkerClusterer.IMAGE_PATH="http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclustererplus/images/m",MarkerClusterer.IMAGE_EXTENSION="png",MarkerClusterer.IMAGE_SIZES=[53,56,66,78,90],"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),inherits(MarkerLabel_,google.maps.OverlayView),MarkerLabel_.getSharedCross=function(e){var t;return"undefined"==typeof MarkerLabel_.getSharedCross.crossDiv&&(t=document.createElement("img"),t.style.cssText="position: absolute; z-index: 1000002; display: none;",t.style.marginLeft="-8px",t.style.marginTop="-9px",t.src=e,MarkerLabel_.getSharedCross.crossDiv=t),MarkerLabel_.getSharedCross.crossDiv},MarkerLabel_.prototype.onAdd=function(){var e,t,i,n,o,a,s,r=this,l=!1,p=!1,h=20,d="url("+this.handCursorURL_+")",c=function(e){e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()},u=function(){r.marker_.setAnimation(null)};this.getPanes().overlayImage.appendChild(this.labelDiv_),this.getPanes().overlayMouseTarget.appendChild(this.eventDiv_),"undefined"==typeof MarkerLabel_.getSharedCross.processed&&(this.getPanes().overlayImage.appendChild(this.crossDiv_),MarkerLabel_.getSharedCross.processed=!0),this.listeners_=[google.maps.event.addDomListener(this.eventDiv_,"mouseover",function(e){(r.marker_.getDraggable()||r.marker_.getClickable())&&(this.style.cursor="pointer",google.maps.event.trigger(r.marker_,"mouseover",e))}),google.maps.event.addDomListener(this.eventDiv_,"mouseout",function(e){!r.marker_.getDraggable()&&!r.marker_.getClickable()||p||(this.style.cursor=r.marker_.getCursor(),google.maps.event.trigger(r.marker_,"mouseout",e))}),google.maps.event.addDomListener(this.eventDiv_,"mousedown",function(e){p=!1,r.marker_.getDraggable()&&(l=!0,this.style.cursor=d),(r.marker_.getDraggable()||r.marker_.getClickable())&&(google.maps.event.trigger(r.marker_,"mousedown",e),c(e))}),google.maps.event.addDomListener(document,"mouseup",function(t){var i;if(l&&(l=!1,r.eventDiv_.style.cursor="pointer",google.maps.event.trigger(r.marker_,"mouseup",t)),p){if(o){i=r.getProjection().fromLatLngToDivPixel(r.marker_.getPosition()),i.y+=h,r.marker_.setPosition(r.getProjection().fromDivPixelToLatLng(i));try{r.marker_.setAnimation(google.maps.Animation.BOUNCE),setTimeout(u,1406)}catch(a){}}r.crossDiv_.style.display="none",r.marker_.setZIndex(e),n=!0,p=!1,t.latLng=r.marker_.getPosition(),google.maps.event.trigger(r.marker_,"dragend",t)}}),google.maps.event.addListener(r.marker_.getMap(),"mousemove",function(n){var d;l&&(p?(n.latLng=new google.maps.LatLng(n.latLng.lat()-t,n.latLng.lng()-i),d=r.getProjection().fromLatLngToDivPixel(n.latLng),o&&(r.crossDiv_.style.left=d.x+"px",r.crossDiv_.style.top=d.y+"px",r.crossDiv_.style.display="",d.y-=h),r.marker_.setPosition(r.getProjection().fromDivPixelToLatLng(d)),o&&(r.eventDiv_.style.top=d.y+h+"px"),google.maps.event.trigger(r.marker_,"drag",n)):(t=n.latLng.lat()-r.marker_.getPosition().lat(),i=n.latLng.lng()-r.marker_.getPosition().lng(),e=r.marker_.getZIndex(),a=r.marker_.getPosition(),s=r.marker_.getMap().getCenter(),o=r.marker_.get("raiseOnDrag"),p=!0,r.marker_.setZIndex(1e6),n.latLng=r.marker_.getPosition(),google.maps.event.trigger(r.marker_,"dragstart",n)))}),google.maps.event.addDomListener(document,"keydown",function(e){p&&27===e.keyCode&&(o=!1,r.marker_.setPosition(a),r.marker_.getMap().setCenter(s),google.maps.event.trigger(document,"mouseup",e))}),google.maps.event.addDomListener(this.eventDiv_,"click",function(e){(r.marker_.getDraggable()||r.marker_.getClickable())&&(n?n=!1:(google.maps.event.trigger(r.marker_,"click",e),c(e)))}),google.maps.event.addDomListener(this.eventDiv_,"dblclick",function(e){(r.marker_.getDraggable()||r.marker_.getClickable())&&(google.maps.event.trigger(r.marker_,"dblclick",e),c(e))}),google.maps.event.addListener(this.marker_,"dragstart",function(){p||(o=this.get("raiseOnDrag"))}),google.maps.event.addListener(this.marker_,"drag",function(){p||o&&(r.setPosition(h),r.labelDiv_.style.zIndex=1e6+(this.get("labelInBackground")?-1:1))}),google.maps.event.addListener(this.marker_,"dragend",function(){p||o&&r.setPosition(0)}),google.maps.event.addListener(this.marker_,"position_changed",function(){r.setPosition()}),google.maps.event.addListener(this.marker_,"zindex_changed",function(){r.setZIndex()}),google.maps.event.addListener(this.marker_,"visible_changed",function(){r.setVisible()}),google.maps.event.addListener(this.marker_,"labelvisible_changed",function(){r.setVisible()}),google.maps.event.addListener(this.marker_,"title_changed",function(){r.setTitle()}),google.maps.event.addListener(this.marker_,"labelcontent_changed",function(){r.setContent()}),google.maps.event.addListener(this.marker_,"labelanchor_changed",function(){r.setAnchor()}),google.maps.event.addListener(this.marker_,"labelclass_changed",function(){r.setStyles()}),google.maps.event.addListener(this.marker_,"labelstyle_changed",function(){r.setStyles()})]},MarkerLabel_.prototype.onRemove=function(){var e;for(this.labelDiv_.parentNode.removeChild(this.labelDiv_),this.eventDiv_.parentNode.removeChild(this.eventDiv_),e=0;e<this.listeners_.length;e++)google.maps.event.removeListener(this.listeners_[e])},MarkerLabel_.prototype.draw=function(){this.setContent(),this.setTitle(),this.setStyles()},MarkerLabel_.prototype.setContent=function(){var e=this.marker_.get("labelContent");"undefined"==typeof e.nodeType?(this.labelDiv_.innerHTML=e,this.eventDiv_.innerHTML=this.labelDiv_.innerHTML):(this.labelDiv_.innerHTML="",this.labelDiv_.appendChild(e),e=e.cloneNode(!0),this.eventDiv_.appendChild(e))},MarkerLabel_.prototype.setTitle=function(){this.eventDiv_.title=this.marker_.getTitle()||""},MarkerLabel_.prototype.setStyles=function(){var e,t;this.labelDiv_.className=this.marker_.get("labelClass"),this.eventDiv_.className=this.labelDiv_.className,this.labelDiv_.style.cssText="",this.eventDiv_.style.cssText="",t=this.marker_.get("labelStyle");for(e in t)t.hasOwnProperty(e)&&(this.labelDiv_.style[e]=t[e],this.eventDiv_.style[e]=t[e]);this.setMandatoryStyles()},MarkerLabel_.prototype.setMandatoryStyles=function(){this.labelDiv_.style.position="absolute",this.labelDiv_.style.overflow="hidden","undefined"!=typeof this.labelDiv_.style.opacity&&""!==this.labelDiv_.style.opacity&&(this.labelDiv_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(opacity='+100*this.labelDiv_.style.opacity+')"',this.labelDiv_.style.filter="alpha(opacity="+100*this.labelDiv_.style.opacity+")"),this.eventDiv_.style.position=this.labelDiv_.style.position,this.eventDiv_.style.overflow=this.labelDiv_.style.overflow,this.eventDiv_.style.opacity=.01,this.eventDiv_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(opacity=1)"',this.eventDiv_.style.filter="alpha(opacity=1)",this.setAnchor(),this.setPosition(),this.setVisible()},MarkerLabel_.prototype.setAnchor=function(){var e=this.marker_.get("labelAnchor");this.labelDiv_.style.marginLeft=-e.x+"px",this.labelDiv_.style.marginTop=-e.y+"px",this.eventDiv_.style.marginLeft=-e.x+"px",this.eventDiv_.style.marginTop=-e.y+"px"},MarkerLabel_.prototype.setPosition=function(e){var t=this.getProjection().fromLatLngToDivPixel(this.marker_.getPosition());"undefined"==typeof e&&(e=0),this.labelDiv_.style.left=Math.round(t.x)+"px",this.labelDiv_.style.top=Math.round(t.y-e)+"px",this.eventDiv_.style.left=this.labelDiv_.style.left,this.eventDiv_.style.top=this.labelDiv_.style.top,this.setZIndex()},MarkerLabel_.prototype.setZIndex=function(){var e=this.marker_.get("labelInBackground")?-1:1;"undefined"==typeof this.marker_.getZIndex()?(this.labelDiv_.style.zIndex=parseInt(this.labelDiv_.style.top,10)+e,this.eventDiv_.style.zIndex=this.labelDiv_.style.zIndex):(this.labelDiv_.style.zIndex=this.marker_.getZIndex()+e,this.eventDiv_.style.zIndex=this.labelDiv_.style.zIndex)},MarkerLabel_.prototype.setVisible=function(){this.labelDiv_.style.display=this.marker_.get("labelVisible")&&this.marker_.getVisible()?"block":"none",this.eventDiv_.style.display=this.labelDiv_.style.display},inherits(MarkerWithLabel,google.maps.Marker),MarkerWithLabel.prototype.setMap=function(e){google.maps.Marker.prototype.setMap.apply(this,arguments),this.label.setMap(e)},Label.prototype=new google.maps.OverlayView,Label.prototype.onAdd=function(){var e=this.getPanes().overlayLayer;e.appendChild(this.div_);var t=this;this.listeners_=[google.maps.event.addListener(this,"position_changed",function(){t.draw()}),google.maps.event.addListener(this,"text_changed",function(){t.draw()})]},Label.prototype.onRemove=function(){this.div_.parentNode.removeChild(this.div_);for(var e=0,t=this.listeners_.length;t>e;++e)google.maps.event.removeListener(this.listeners_[e])},Label.prototype.draw=function(){var e=this.getProjection(),t=e.fromLatLngToDivPixel(this.get("position")),i=this.div_;i.style.left=t.x+"px",i.style.top=t.y+"px",i.style.display="block",this.span_.innerHTML=this.get("text").toString()};var Query=function(e){"use strict";var t=function(e){var t,i,n,o,a=[];if("undefined"==typeof e||null===e||""===e)return a;for(0===e.indexOf("?")&&(e=e.substring(1)),i=e.toString().split(/[&;]/),t=0;t<i.length;t++)n=i[t],o=n.split("="),a.push([o[0],o[1]]);return a},i=t(e),n=function(){var e,t,n="";for(e=0;e<i.length;e++)t=i[e],n.length>0&&(n+="&"),n+=t.join("=");return n.length>0?"?"+n:n},o=function(e){return e=decodeURIComponent(e),e=e.replace("+"," ")},a=function(e){var t,n;for(n=0;n<i.length;n++)if(t=i[n],o(e)===o(t[0]))return t[1]},s=function(e){var t,n,a=[];for(t=0;t<i.length;t++)n=i[t],o(e)===o(n[0])&&a.push(n[1]);return a},r=function(e,t){var n,a,s,r,l=[];for(n=0;n<i.length;n++)a=i[n],s=o(a[0])===o(e),r=o(a[1])===o(t),(1===arguments.length&&!s||2===arguments.length&&!s&&!r)&&l.push(a);return i=l,this},l=function(e,t,n){return 3===arguments.length&&-1!==n?(n=Math.min(n,i.length),i.splice(n,0,[e,t])):arguments.length>0&&i.push([e,t]),this},p=function(e,t,n){var a,s,p=-1;if(3===arguments.length){for(a=0;a<i.length;a++)if(s=i[a],o(s[0])===o(e)&&decodeURIComponent(s[1])===o(n)){p=a;break}r(e,n).addParam(e,t,p)}else{for(a=0;a<i.length;a++)if(s=i[a],o(s[0])===o(e)){p=a;break}r(e),l(e,t,p)}return this};return{getParamValue:a,getParamValues:s,deleteParam:r,addParam:l,replaceParam:p,toString:n}},Uri=function(e){"use strict";var t=!1,i=function(e){for(var i={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],o={name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},a=i[t?"strict":"loose"].exec(e),s={},r=14;r--;)s[n[r]]=a[r]||"";return s[o.name]={},s[n[12]].replace(o.parser,function(e,t,i){t&&(s[o.name][t]=i)}),s},n=i(e||""),o=new Query(n.query),a=function(e){return"undefined"!=typeof e&&(n.protocol=e),n.protocol},s=null,r=function(e){return"undefined"!=typeof e&&(s=e),null===s?-1!==n.source.indexOf("//"):s},l=function(e){return"undefined"!=typeof e&&(n.userInfo=e),n.userInfo},p=function(e){return"undefined"!=typeof e&&(n.host=e),n.host},h=function(e){return"undefined"!=typeof e&&(n.port=e),n.port},d=function(e){return"undefined"!=typeof e&&(n.path=e),n.path},c=function(e){return"undefined"!=typeof e&&(o=new Query(e)),o},u=function(e){return"undefined"!=typeof e&&(n.anchor=e),n.anchor},f=function(e){return a(e),this},g=function(e){return r(e),this},m=function(e){return l(e),this},_=function(e){return p(e),this},w=function(e){return h(e),this},b=function(e){return d(e),this},v=function(e){return c(e),this},y=function(e){return u(e),this},k=function(e){return c().getParamValue(e)},x=function(e){return c().getParamValues(e)},M=function(e,t){return 2===arguments.length?c().deleteParam(e,t):c().deleteParam(e),this},T=function(e,t,i){return 3===arguments.length?c().addParam(e,t,i):c().addParam(e,t),this},P=function(e,t,i){return 3===arguments.length?c().replaceParam(e,t,i):c().replaceParam(e,t),this},S=function(){var e="",t=function(e){return null!==e&&""!==e};return t(a())?(e+=a(),a().indexOf(":")!==a().length-1&&(e+=":"),e+="//"):r()&&t(p())&&(e+="//"),t(l())&&t(p())&&(e+=l(),l().indexOf("@")!==l().length-1&&(e+="@")),t(p())&&(e+=p(),t(h())&&(e+=":"+h())),t(d())?e+=d():t(p())&&(t(c().toString())||t(u()))&&(e+="/"),t(c().toString())&&(0!==c().toString().indexOf("?")&&(e+="?"),e+=c().toString()),t(u())&&(0!==u().indexOf("#")&&(e+="#"),e+=u()),e},I=function(){return new Uri(S())};return{protocol:a,hasAuthorityPrefix:r,userInfo:l,host:p,port:h,path:d,query:c,anchor:u,setProtocol:f,setHasAuthorityPrefix:g,setUserInfo:m,setHost:_,setPort:w,setPath:b,setQuery:v,setAnchor:y,getQueryParamValue:k,getQueryParamValues:x,deleteQueryParam:M,addQueryParam:T,replaceQueryParam:P,toString:S,clone:I}},jsUri=Uri;!function(e,t,i){!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):jQuery&&!jQuery.fn.qtip&&e(jQuery)}(function(n){"use strict";function o(e,t,i,o){this.id=i,this.target=e,this.tooltip=C,this.elements={target:e},this._id=W+"-"+i,this.timers={img:{}},this.options=t,this.plugins={},this.cache={event:{},target:n(),disabled:z,attr:o,onTooltip:z,lastClass:""},this.rendered=this.destroyed=this.disabled=this.waiting=this.hiddenDuringWait=this.positioning=this.triggering=z}function a(e){return e===C||"object"!==n.type(e)}function s(e){return!(n.isFunction(e)||e&&e.attr||e.length||"object"===n.type(e)&&(e.jquery||e.then))}function r(e){var t,i,o,r;return a(e)?z:(a(e.metadata)&&(e.metadata={type:e.metadata}),"content"in e&&(t=e.content,a(t)||t.jquery||t.done?t=e.content={text:i=s(t)?z:t}:i=t.text,"ajax"in t&&(o=t.ajax,r=o&&o.once!==z,delete t.ajax,t.text=function(e,t){var a=i||n(this).attr(t.options.content.attr)||"Loading...",s=n.ajax(n.extend({},o,{context:t})).then(o.success,C,o.error).then(function(e){return e&&r&&t.set("content.text",e),e},function(e,i,n){t.destroyed||0===e.status||t.set("content.text",i+": "+n)});return r?a:(t.set("content.text",a),s)}),"title"in t&&(a(t.title)||(t.button=t.title.button,t.title=t.title.text),s(t.title||z)&&(t.title=z))),"position"in e&&a(e.position)&&(e.position={my:e.position,at:e.position}),"show"in e&&a(e.show)&&(e.show=e.show.jquery?{target:e.show}:e.show===I?{ready:I}:{event:e.show}),"hide"in e&&a(e.hide)&&(e.hide=e.hide.jquery?{target:e.hide}:{event:e.hide}),"style"in e&&a(e.style)&&(e.style={classes:e.style}),n.each(H,function(){this.sanitize&&this.sanitize(e)}),e)}function l(e,t){for(var i,n=0,o=e,a=t.split(".");o=o[a[n++]];)n<a.length&&(i=o);return[i||e,a.pop()]}function p(e,t){var i,n,o;for(i in this.checks)for(n in this.checks[i])(o=new RegExp(n,"i").exec(e))&&(t.push(o),("builtin"===i||this.plugins[i])&&this.checks[i][n].apply(this.plugins[i]||this,t))}function h(e){return G.concat("").join(e?"-"+e+" ":" ")}function d(i){return i&&{type:i.type,pageX:i.pageX,pageY:i.pageY,target:i.target,relatedTarget:i.relatedTarget,scrollX:i.scrollX||e.pageXOffset||t.body.scrollLeft||t.documentElement.scrollLeft,scrollY:i.scrollY||e.pageYOffset||t.body.scrollTop||t.documentElement.scrollTop}||{}}function c(e,t){return t>0?setTimeout(n.proxy(e,this),t):void e.call(this)}function u(e){return this.tooltip.hasClass(Q)?z:(clearTimeout(this.timers.show),clearTimeout(this.timers.hide),void(this.timers.show=c.call(this,function(){this.toggle(I,e)},this.options.show.delay)))}function f(e){if(this.tooltip.hasClass(Q))return z;var t=n(e.relatedTarget),i=t.closest(U)[0]===this.tooltip[0],o=t[0]===this.options.show.target[0];if(clearTimeout(this.timers.show),clearTimeout(this.timers.hide),this!==t[0]&&"mouse"===this.options.position.target&&i||this.options.hide.fixed&&/mouse(out|leave|move)/.test(e.type)&&(i||o))try{e.preventDefault(),e.stopImmediatePropagation()}catch(a){}else this.timers.hide=c.call(this,function(){this.toggle(z,e)},this.options.hide.delay,this)}function g(e){return this.tooltip.hasClass(Q)||!this.options.hide.inactive?z:(clearTimeout(this.timers.inactive),void(this.timers.inactive=c.call(this,function(){this.hide(e)},this.options.hide.inactive)))}function m(e){this.rendered&&this.tooltip[0].offsetWidth>0&&this.reposition(e)}function _(e,i,o){n(t.body).delegate(e,(i.split?i:i.join(st+" "))+st,function(){var e=x.api[n.attr(this,q)];e&&!e.disabled&&o.apply(e,arguments)})}function w(e,i,a){var s,l,p,h,d,c=n(t.body),u=e[0]===t?c:e,f=e.metadata?e.metadata(a.metadata):C,g="html5"===a.metadata.type&&f?f[a.metadata.name]:C,m=e.data(a.metadata.name||"qtipopts");try{m="string"==typeof m?n.parseJSON(m):m}catch(_){}if(h=n.extend(I,{},x.defaults,a,"object"==typeof m?r(m):C,r(g||f)),l=h.position,h.id=i,"boolean"==typeof h.content.text){if(p=e.attr(h.content.attr),h.content.attr===z||!p)return z;h.content.text=p}if(l.container.length||(l.container=c),l.target===z&&(l.target=u),h.show.target===z&&(h.show.target=u),h.show.solo===I&&(h.show.solo=l.container.closest("body")),h.hide.target===z&&(h.hide.target=u),h.position.viewport===I&&(h.position.viewport=l.container),l.container=l.container.eq(0),l.at=new T(l.at,I),l.my=new T(l.my),e.data(W))if(h.overwrite)e.qtip("destroy",!0);else if(h.overwrite===z)return z;return e.attr(R,i),h.suppress&&(d=e.attr("title"))&&e.removeAttr("title").attr(tt,d).attr("title",""),s=new o(e,h,i,!!p),e.data(W,s),e.one("remove.qtip-"+i+" removeqtip.qtip-"+i,function(){var e;(e=n(this).data(W))&&e.destroy(!0)}),s}function b(e){return e.charAt(0).toUpperCase()+e.slice(1)}function v(e,t){var n,o,a=t.charAt(0).toUpperCase()+t.slice(1),s=(t+" "+_t.join(a+" ")+a).split(" "),r=0;if(mt[t])return e.css(mt[t]);for(;n=s[r++];)if((o=e.css(n))!==i)return mt[t]=n,o}function y(e,t){return Math.ceil(parseFloat(v(e,t)))}function k(e,t){this._ns="tip",this.options=t,this.offset=t.offset,this.size=[t.width,t.height],this.init(this.qtip=e)}var x,M,T,P,S,I=!0,z=!1,C=null,$="x",D="y",j="width",A="height",E="top",F="left",N="bottom",B="right",L="center",K="flipinvert",O="shift",H={},W="qtip",R="data-hasqtip",q="data-qtip-id",G=["ui-widget","ui-tooltip"],U="."+W,V="click dblclick mousedown mouseup mousemove mouseleave mouseenter".split(" "),Y=W+"-fixed",J=W+"-default",Z=W+"-focus",X=W+"-hover",Q=W+"-disabled",et="_replacedByqTip",tt="oldtitle",it={ie:function(){for(var e=3,i=t.createElement("div");(i.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->")&&i.getElementsByTagName("i")[0];);return e>4?e:0/0}(),iOS:parseFloat((""+(/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))||z};M=o.prototype,M._when=function(e){return n.when.apply(n,e)},M.render=function(e){if(this.rendered||this.destroyed)return this;var t,i=this,o=this.options,a=this.cache,s=this.elements,r=o.content.text,l=o.content.title,p=o.content.button,h=o.position,d=("."+this._id+" ",[]);return n.attr(this.target[0],"aria-describedby",this._id),this.tooltip=s.tooltip=t=n("<div/>",{id:this._id,"class":[W,J,o.style.classes,W+"-pos-"+o.position.my.abbrev()].join(" "),width:o.style.width||"",height:o.style.height||"",tracking:"mouse"===h.target&&h.adjust.mouse,role:"alert","aria-live":"polite","aria-atomic":z,"aria-describedby":this._id+"-content","aria-hidden":I}).toggleClass(Q,this.disabled).attr(q,this.id).data(W,this).appendTo(h.container).append(s.content=n("<div />",{"class":W+"-content",id:this._id+"-content","aria-atomic":I})),this.rendered=-1,this.positioning=I,l&&(this._createTitle(),n.isFunction(l)||d.push(this._updateTitle(l,z))),p&&this._createButton(),n.isFunction(r)||d.push(this._updateContent(r,z)),this.rendered=I,this._setWidget(),n.each(H,function(e){var t;"render"===this.initialize&&(t=this(i))&&(i.plugins[e]=t)}),this._unassignEvents(),this._assignEvents(),this._when(d).then(function(){i._trigger("render"),i.positioning=z,i.hiddenDuringWait||!o.show.ready&&!e||i.toggle(I,a.event,z),i.hiddenDuringWait=z}),x.api[this.id]=this,this},M.destroy=function(e){function t(){if(!this.destroyed){this.destroyed=I;var e=this.target,t=e.attr(tt);this.rendered&&this.tooltip.stop(1,0).find("*").remove().end().remove(),n.each(this.plugins,function(){this.destroy&&this.destroy()}),clearTimeout(this.timers.show),clearTimeout(this.timers.hide),this._unassignEvents(),e.removeData(W).removeAttr(q).removeAttr(R).removeAttr("aria-describedby"),this.options.suppress&&t&&e.attr("title",t).removeAttr(tt),this._unbind(e),this.options=this.elements=this.cache=this.timers=this.plugins=this.mouse=C,delete x.api[this.id]}}return this.destroyed?this.target:(e===I&&"hide"!==this.triggering||!this.rendered?t.call(this):(this.tooltip.one("tooltiphidden",n.proxy(t,this)),!this.triggering&&this.hide()),this.target)},P=M.checks={builtin:{"^id$":function(e,t,i,o){var a=i===I?x.nextid:i,s=W+"-"+a;a!==z&&a.length>0&&!n("#"+s).length?(this._id=s,this.rendered&&(this.tooltip[0].id=this._id,this.elements.content[0].id=this._id+"-content",this.elements.title[0].id=this._id+"-title")):e[t]=o},"^prerender":function(e,t,i){i&&!this.rendered&&this.render(this.options.show.ready)},"^content.text$":function(e,t,i){this._updateContent(i)
},"^content.attr$":function(e,t,i,n){this.options.content.text===this.target.attr(n)&&this._updateContent(this.target.attr(i))},"^content.title$":function(e,t,i){return i?(i&&!this.elements.title&&this._createTitle(),void this._updateTitle(i)):this._removeTitle()},"^content.button$":function(e,t,i){this._updateButton(i)},"^content.title.(text|button)$":function(e,t,i){this.set("content."+t,i)},"^position.(my|at)$":function(e,t,i){"string"==typeof i&&(e[t]=new T(i,"at"===t))},"^position.container$":function(e,t,i){this.rendered&&this.tooltip.appendTo(i)},"^show.ready$":function(e,t,i){i&&(!this.rendered&&this.render(I)||this.toggle(I))},"^style.classes$":function(e,t,i,n){this.rendered&&this.tooltip.removeClass(n).addClass(i)},"^style.(width|height)":function(e,t,i){this.rendered&&this.tooltip.css(t,i)},"^style.widget|content.title":function(){this.rendered&&this._setWidget()},"^style.def":function(e,t,i){this.rendered&&this.tooltip.toggleClass(J,!!i)},"^events.(render|show|move|hide|focus|blur)$":function(e,t,i){this.rendered&&this.tooltip[(n.isFunction(i)?"":"un")+"bind"]("tooltip"+t,i)},"^(show|hide|position).(event|target|fixed|inactive|leave|distance|viewport|adjust)":function(){if(this.rendered){var e=this.options.position;this.tooltip.attr("tracking","mouse"===e.target&&e.adjust.mouse),this._unassignEvents(),this._assignEvents()}}}},M.get=function(e){if(this.destroyed)return this;var t=l(this.options,e.toLowerCase()),i=t[0][t[1]];return i.precedance?i.string():i};var nt=/^position\.(my|at|adjust|target|container|viewport)|style|content|show\.ready/i,ot=/^prerender|show\.ready/i;M.set=function(e,t){if(this.destroyed)return this;{var i,o=this.rendered,a=z,s=this.options;this.checks}return"string"==typeof e?(i=e,e={},e[i]=t):e=n.extend({},e),n.each(e,function(t,i){if(o&&ot.test(t))return void delete e[t];var r,p=l(s,t.toLowerCase());r=p[0][p[1]],p[0][p[1]]=i&&i.nodeType?n(i):i,a=nt.test(t)||a,e[t]=[p[0],p[1],i,r]}),r(s),this.positioning=I,n.each(e,n.proxy(p,this)),this.positioning=z,this.rendered&&this.tooltip[0].offsetWidth>0&&a&&this.reposition("mouse"===s.position.target?C:this.cache.event),this},M._update=function(e,t){var i=this,o=this.cache;return this.rendered&&e?(n.isFunction(e)&&(e=e.call(this.elements.target,o.event,this)||""),n.isFunction(e.then)?(o.waiting=I,e.then(function(e){return o.waiting=z,i._update(e,t)},C,function(e){return i._update(e,t)})):e===z||!e&&""!==e?z:(e.jquery&&e.length>0?t.empty().append(e.css({display:"block",visibility:"visible"})):t.html(e),this._waitForContent(t).then(function(e){e.images&&e.images.length&&i.rendered&&i.tooltip[0].offsetWidth>0&&i.reposition(o.event,!e.length)}))):z},M._waitForContent=function(e){var t=this.cache;return t.waiting=I,(n.fn.imagesLoaded?e.imagesLoaded():n.Deferred().resolve([])).done(function(){t.waiting=z}).promise()},M._updateContent=function(e,t){this._update(e,this.elements.content,t)},M._updateTitle=function(e,t){this._update(e,this.elements.title,t)===z&&this._removeTitle(z)},M._createTitle=function(){var e=this.elements,t=this._id+"-title";e.titlebar&&this._removeTitle(),e.titlebar=n("<div />",{"class":W+"-titlebar "+(this.options.style.widget?h("header"):"")}).append(e.title=n("<div />",{id:t,"class":W+"-title","aria-atomic":I})).insertBefore(e.content).delegate(".qtip-close","mousedown keydown mouseup keyup mouseout",function(e){n(this).toggleClass("ui-state-active ui-state-focus","down"===e.type.substr(-4))}).delegate(".qtip-close","mouseover mouseout",function(e){n(this).toggleClass("ui-state-hover","mouseover"===e.type)}),this.options.content.button&&this._createButton()},M._removeTitle=function(e){var t=this.elements;t.title&&(t.titlebar.remove(),t.titlebar=t.title=t.button=C,e!==z&&this.reposition())},M.reposition=function(i,o){if(!this.rendered||this.positioning||this.destroyed)return this;this.positioning=I;var a,s,r=this.cache,l=this.tooltip,p=this.options.position,h=p.target,d=p.my,c=p.at,u=p.viewport,f=p.container,g=p.adjust,m=g.method.split(" "),_=l.outerWidth(z),w=l.outerHeight(z),b=0,v=0,y=l.css("position"),k={left:0,top:0},x=l[0].offsetWidth>0,M=i&&"scroll"===i.type,T=n(e),P=f[0].ownerDocument,S=this.mouse;if(n.isArray(h)&&2===h.length)c={x:F,y:E},k={left:h[0],top:h[1]};else if("mouse"===h)c={x:F,y:E},!S||!S.pageX||!g.mouse&&i&&i.pageX?i&&i.pageX||((!g.mouse||this.options.show.distance)&&r.origin&&r.origin.pageX?i=r.origin:(!i||i&&("resize"===i.type||"scroll"===i.type))&&(i=r.event)):i=S,"static"!==y&&(k=f.offset()),P.body.offsetWidth!==(e.innerWidth||P.documentElement.clientWidth)&&(s=n(t.body).offset()),k={left:i.pageX-k.left+(s&&s.left||0),top:i.pageY-k.top+(s&&s.top||0)},g.mouse&&M&&S&&(k.left-=(S.scrollX||0)-T.scrollLeft(),k.top-=(S.scrollY||0)-T.scrollTop());else{if("event"===h?i&&i.target&&"scroll"!==i.type&&"resize"!==i.type?r.target=n(i.target):i.target||(r.target=this.elements.target):"event"!==h&&(r.target=n(h.jquery?h:this.elements.target)),h=r.target,h=n(h).eq(0),0===h.length)return this;h[0]===t||h[0]===e?(b=it.iOS?e.innerWidth:h.width(),v=it.iOS?e.innerHeight:h.height(),h[0]===e&&(k={top:(u||h).scrollTop(),left:(u||h).scrollLeft()})):H.imagemap&&h.is("area")?a=H.imagemap(this,h,c,H.viewport?m:z):H.svg&&h&&h[0].ownerSVGElement?a=H.svg(this,h,c,H.viewport?m:z):(b=h.outerWidth(z),v=h.outerHeight(z),k=h.offset()),a&&(b=a.width,v=a.height,s=a.offset,k=a.position),k=this.reposition.offset(h,k,f),(it.iOS>3.1&&it.iOS<4.1||it.iOS>=4.3&&it.iOS<4.33||!it.iOS&&"fixed"===y)&&(k.left-=T.scrollLeft(),k.top-=T.scrollTop()),(!a||a&&a.adjustable!==z)&&(k.left+=c.x===B?b:c.x===L?b/2:0,k.top+=c.y===N?v:c.y===L?v/2:0)}return k.left+=g.x+(d.x===B?-_:d.x===L?-_/2:0),k.top+=g.y+(d.y===N?-w:d.y===L?-w/2:0),H.viewport?(k.adjusted=H.viewport(this,k,p,b,v,_,w),s&&k.adjusted.left&&(k.left+=s.left),s&&k.adjusted.top&&(k.top+=s.top)):k.adjusted={left:0,top:0},this._trigger("move",[k,u.elem||u],i)?(delete k.adjusted,o===z||!x||isNaN(k.left)||isNaN(k.top)||"mouse"===h||!n.isFunction(p.effect)?l.css(k):n.isFunction(p.effect)&&(p.effect.call(l,this,n.extend({},k)),l.queue(function(e){n(this).css({opacity:"",height:""}),it.ie&&this.style.removeAttribute("filter"),e()})),this.positioning=z,this):this},M.reposition.offset=function(e,i,o){function a(e,t){i.left+=t*e.scrollLeft(),i.top+=t*e.scrollTop()}if(!o[0])return i;var s,r,l,p,h=n(e[0].ownerDocument),d=!!it.ie&&"CSS1Compat"!==t.compatMode,c=o[0];do"static"!==(r=n.css(c,"position"))&&("fixed"===r?(l=c.getBoundingClientRect(),a(h,-1)):(l=n(c).position(),l.left+=parseFloat(n.css(c,"borderLeftWidth"))||0,l.top+=parseFloat(n.css(c,"borderTopWidth"))||0),i.left-=l.left+(parseFloat(n.css(c,"marginLeft"))||0),i.top-=l.top+(parseFloat(n.css(c,"marginTop"))||0),s||"hidden"===(p=n.css(c,"overflow"))||"visible"===p||(s=n(c)));while(c=c.offsetParent);return s&&(s[0]!==h[0]||d)&&a(s,1),i};var at=(T=M.reposition.Corner=function(e,t){e=(""+e).replace(/([A-Z])/," $1").replace(/middle/gi,L).toLowerCase(),this.x=(e.match(/left|right/i)||e.match(/center/)||["inherit"])[0].toLowerCase(),this.y=(e.match(/top|bottom|center/i)||["inherit"])[0].toLowerCase(),this.forceY=!!t;var i=e.charAt(0);this.precedance="t"===i||"b"===i?D:$}).prototype;at.invert=function(e,t){this[e]=this[e]===F?B:this[e]===B?F:t||this[e]},at.string=function(){var e=this.x,t=this.y;return e===t?e:this.precedance===D||this.forceY&&"center"!==t?t+" "+e:e+" "+t},at.abbrev=function(){var e=this.string().split(" ");return e[0].charAt(0)+(e[1]&&e[1].charAt(0)||"")},at.clone=function(){return new T(this.string(),this.forceY)},M.toggle=function(e,i){var o=this.cache,a=this.options,s=this.tooltip;if(i){if(/over|enter/.test(i.type)&&/out|leave/.test(o.event.type)&&a.show.target.add(i.target).length===a.show.target.length&&s.has(i.relatedTarget).length)return this;o.event=d(i)}if(this.waiting&&!e&&(this.hiddenDuringWait=I),!this.rendered)return e?this.render(1):this;if(this.destroyed||this.disabled)return this;var r,l,p,h=e?"show":"hide",c=this.options[h],u=(this.options[e?"hide":"show"],this.options.position),f=this.options.content,g=this.tooltip.css("width"),m=this.tooltip.is(":visible"),_=e||1===c.target.length,w=!i||c.target.length<2||o.target[0]===i.target;return(typeof e).search("boolean|number")&&(e=!m),r=!s.is(":animated")&&m===e&&w,l=r?C:!!this._trigger(h,[90]),this.destroyed?this:(l!==z&&e&&this.focus(i),!l||r?this:(n.attr(s[0],"aria-hidden",!e),e?(o.origin=d(this.mouse),n.isFunction(f.text)&&this._updateContent(f.text,z),n.isFunction(f.title)&&this._updateTitle(f.title,z),!S&&"mouse"===u.target&&u.adjust.mouse&&(n(t).bind("mousemove."+W,this._storeMouse),S=I),g||s.css("width",s.outerWidth(z)),this.reposition(i,arguments[2]),g||s.css("width",""),c.solo&&("string"==typeof c.solo?n(c.solo):n(U,c.solo)).not(s).not(c.target).qtip("hide",n.Event("tooltipsolo"))):(clearTimeout(this.timers.show),delete o.origin,S&&!n(U+'[tracking="true"]:visible',c.solo).not(s).length&&(n(t).unbind("mousemove."+W),S=z),this.blur(i)),p=n.proxy(function(){e?(it.ie&&s[0].style.removeAttribute("filter"),s.css("overflow",""),"string"==typeof c.autofocus&&n(this.options.show.autofocus,s).focus(),this.options.show.target.trigger("qtip-"+this.id+"-inactive")):s.css({display:"",visibility:"",opacity:"",left:"",top:""}),this._trigger(e?"visible":"hidden")},this),c.effect===z||_===z?(s[h](),p()):n.isFunction(c.effect)?(s.stop(1,1),c.effect.call(s,this),s.queue("fx",function(e){p(),e()})):s.fadeTo(90,e?1:0,p),e&&c.target.trigger("qtip-"+this.id+"-inactive"),this))},M.show=function(e){return this.toggle(I,e)},M.hide=function(e){return this.toggle(z,e)},M.focus=function(e){if(!this.rendered||this.destroyed)return this;var t=n(U),i=this.tooltip,o=parseInt(i[0].style.zIndex,10),a=x.zindex+t.length;return i.hasClass(Z)||this._trigger("focus",[a],e)&&(o!==a&&(t.each(function(){this.style.zIndex>o&&(this.style.zIndex=this.style.zIndex-1)}),t.filter("."+Z).qtip("blur",e)),i.addClass(Z)[0].style.zIndex=a),this},M.blur=function(e){return!this.rendered||this.destroyed?this:(this.tooltip.removeClass(Z),this._trigger("blur",[this.tooltip.css("zIndex")],e),this)},M.disable=function(e){return this.destroyed?this:("toggle"===e?e=!(this.rendered?this.tooltip.hasClass(Q):this.disabled):"boolean"!=typeof e&&(e=I),this.rendered&&this.tooltip.toggleClass(Q,e).attr("aria-disabled",e),this.disabled=!!e,this)},M.enable=function(){return this.disable(z)},M._createButton=function(){var e=this,t=this.elements,i=t.tooltip,o=this.options.content.button,a="string"==typeof o,s=a?o:"Close tooltip";t.button&&t.button.remove(),t.button=o.jquery?o:n("<a />",{"class":"qtip-close "+(this.options.style.widget?"":W+"-icon"),title:s,"aria-label":s}).prepend(n("<span />",{"class":"ui-icon ui-icon-close",html:"&times;"})),t.button.appendTo(t.titlebar||i).attr("role","button").click(function(t){return i.hasClass(Q)||e.hide(t),z})},M._updateButton=function(e){if(!this.rendered)return z;var t=this.elements.button;e?this._createButton():t.remove()},M._setWidget=function(){var e=this.options.style.widget,t=this.elements,i=t.tooltip,n=i.hasClass(Q);i.removeClass(Q),Q=e?"ui-state-disabled":"qtip-disabled",i.toggleClass(Q,n),i.toggleClass("ui-helper-reset "+h(),e).toggleClass(J,this.options.style.def&&!e),t.content&&t.content.toggleClass(h("content"),e),t.titlebar&&t.titlebar.toggleClass(h("header"),e),t.button&&t.button.toggleClass(W+"-icon",!e)},M._storeMouse=function(e){(this.mouse=d(e)).type="mousemove"},M._bind=function(e,t,i,o,a){var s="."+this._id+(o?"-"+o:"");t.length&&n(e).bind((t.split?t:t.join(s+" "))+s,n.proxy(i,a||this))},M._unbind=function(e,t){n(e).unbind("."+this._id+(t?"-"+t:""))};var st="."+W;n(function(){_(U,["mouseenter","mouseleave"],function(e){var t="mouseenter"===e.type,i=n(e.currentTarget),o=n(e.relatedTarget||e.target),a=this.options;t?(this.focus(e),i.hasClass(Y)&&!i.hasClass(Q)&&clearTimeout(this.timers.hide)):"mouse"===a.position.target&&a.hide.event&&a.show.target&&!o.closest(a.show.target[0]).length&&this.hide(e),i.toggleClass(X,t)}),_("["+q+"]",V,g)}),M._trigger=function(e,t,i){var o=n.Event("tooltip"+e);return o.originalEvent=i&&n.extend({},i)||this.cache.event||C,this.triggering=e,this.tooltip.trigger(o,[this].concat(t||[])),this.triggering=z,!o.isDefaultPrevented()},M._bindEvents=function(e,t,i,o,a,s){if(o.add(i).length===o.length){var r=[];t=n.map(t,function(t){var i=n.inArray(t,e);return i>-1?void r.push(e.splice(i,1)[0]):t}),r.length&&this._bind(i,r,function(e){var t=this.rendered?this.tooltip[0].offsetWidth>0:!1;(t?s:a).call(this,e)})}this._bind(i,e,a),this._bind(o,t,s)},M._assignInitialEvents=function(e){function t(e){return this.disabled||this.destroyed?z:(this.cache.event=d(e),this.cache.target=e?n(e.target):[i],clearTimeout(this.timers.show),void(this.timers.show=c.call(this,function(){this.render("object"==typeof e||o.show.ready)},o.show.delay)))}var o=this.options,a=o.show.target,s=o.hide.target,r=o.show.event?n.trim(""+o.show.event).split(" "):[],l=o.hide.event?n.trim(""+o.hide.event).split(" "):[];/mouse(over|enter)/i.test(o.show.event)&&!/mouse(out|leave)/i.test(o.hide.event)&&l.push("mouseleave"),this._bind(a,"mousemove",function(e){this._storeMouse(e),this.cache.onTarget=I}),this._bindEvents(r,l,a,s,t,function(){clearTimeout(this.timers.show)}),(o.show.ready||o.prerender)&&t.call(this,e)},M._assignEvents=function(){var i=this,o=this.options,a=o.position,s=this.tooltip,r=o.show.target,l=o.hide.target,p=a.container,h=a.viewport,d=n(t),c=(n(t.body),n(e)),_=o.show.event?n.trim(""+o.show.event).split(" "):[],w=o.hide.event?n.trim(""+o.hide.event).split(" "):[];n.each(o.events,function(e,t){i._bind(s,"toggle"===e?["tooltipshow","tooltiphide"]:["tooltip"+e],t,null,s)}),/mouse(out|leave)/i.test(o.hide.event)&&"window"===o.hide.leave&&this._bind(d,["mouseout","blur"],function(e){/select|option/.test(e.target.nodeName)||e.relatedTarget||this.hide(e)}),o.hide.fixed?l=l.add(s.addClass(Y)):/mouse(over|enter)/i.test(o.show.event)&&this._bind(l,"mouseleave",function(){clearTimeout(this.timers.show)}),(""+o.hide.event).indexOf("unfocus")>-1&&this._bind(p.closest("html"),["mousedown","touchstart"],function(e){var t=n(e.target),i=this.rendered&&!this.tooltip.hasClass(Q)&&this.tooltip[0].offsetWidth>0,o=t.parents(U).filter(this.tooltip[0]).length>0;t[0]===this.target[0]||t[0]===this.tooltip[0]||o||this.target.has(t[0]).length||!i||this.hide(e)}),"number"==typeof o.hide.inactive&&(this._bind(r,"qtip-"+this.id+"-inactive",g),this._bind(l.add(s),x.inactiveEvents,g,"-inactive")),this._bindEvents(_,w,r,l,u,f),this._bind(r.add(s),"mousemove",function(e){if("number"==typeof o.hide.distance){var t=this.cache.origin||{},i=this.options.hide.distance,n=Math.abs;(n(e.pageX-t.pageX)>=i||n(e.pageY-t.pageY)>=i)&&this.hide(e)}this._storeMouse(e)}),"mouse"===a.target&&a.adjust.mouse&&(o.hide.event&&this._bind(r,["mouseenter","mouseleave"],function(e){this.cache.onTarget="mouseenter"===e.type}),this._bind(d,"mousemove",function(e){this.rendered&&this.cache.onTarget&&!this.tooltip.hasClass(Q)&&this.tooltip[0].offsetWidth>0&&this.reposition(e)})),(a.adjust.resize||h.length)&&this._bind(n.event.special.resize?h:c,"resize",m),a.adjust.scroll&&this._bind(c.add(a.container),"scroll",m)},M._unassignEvents=function(){var i=[this.options.show.target[0],this.options.hide.target[0],this.rendered&&this.tooltip[0],this.options.position.container[0],this.options.position.viewport[0],this.options.position.container.closest("html")[0],e,t];this._unbind(n([]).pushStack(n.grep(i,function(e){return"object"==typeof e})))},x=n.fn.qtip=function(e,t,o){var a=(""+e).toLowerCase(),s=C,l=n.makeArray(arguments).slice(1),p=l[l.length-1],h=this[0]?n.data(this[0],W):C;return!arguments.length&&h||"api"===a?h:"string"==typeof e?(this.each(function(){var e=n.data(this,W);if(!e)return I;if(p&&p.timeStamp&&(e.cache.event=p),!t||"option"!==a&&"options"!==a)e[a]&&e[a].apply(e,l);else{if(o===i&&!n.isPlainObject(t))return s=e.get(t),z;e.set(t,o)}}),s!==C?s:this):"object"!=typeof e&&arguments.length?void 0:(h=r(n.extend(I,{},e)),this.each(function(e){var t,i;return i=n.isArray(h.id)?h.id[e]:h.id,i=!i||i===z||i.length<1||x.api[i]?x.nextid++:i,t=w(n(this),i,h),t===z?I:(x.api[i]=t,n.each(H,function(){"initialize"===this.initialize&&this(t)}),void t._assignInitialEvents(p))}))},n.qtip=o,x.api={},n.each({attr:function(e,t){if(this.length){var i=this[0],o="title",a=n.data(i,"qtip");if(e===o&&a&&"object"==typeof a&&a.options.suppress)return arguments.length<2?n.attr(i,tt):(a&&a.options.content.attr===o&&a.cache.attr&&a.set("content.text",t),this.attr(tt,t))}return n.fn["attr"+et].apply(this,arguments)},clone:function(e){var t=(n([]),n.fn["clone"+et].apply(this,arguments));return e||t.filter("["+tt+"]").attr("title",function(){return n.attr(this,tt)}).removeAttr(tt),t}},function(e,t){if(!t||n.fn[e+et])return I;var i=n.fn[e+et]=n.fn[e];n.fn[e]=function(){return t.apply(this,arguments)||i.apply(this,arguments)}}),n.ui||(n["cleanData"+et]=n.cleanData,n.cleanData=function(e){for(var t,i=0;(t=n(e[i])).length;i++)if(t.attr(R))try{t.triggerHandler("removeqtip")}catch(o){}n["cleanData"+et].apply(this,arguments)}),x.version="2.2.0",x.nextid=0,x.inactiveEvents=V,x.zindex=15e3,x.defaults={prerender:z,id:z,overwrite:I,suppress:I,content:{text:I,attr:"title",title:z,button:z},position:{my:"top left",at:"bottom right",target:z,container:z,viewport:z,adjust:{x:0,y:0,mouse:I,scroll:I,resize:I,method:"flipinvert flipinvert"},effect:function(e,t){n(this).animate(t,{duration:200,queue:z})}},show:{target:z,event:"mouseenter",effect:I,delay:90,solo:z,ready:z,autofocus:z},hide:{target:z,event:"mouseleave",effect:I,delay:0,fixed:z,inactive:z,leave:"window",distance:z},style:{classes:"",widget:z,width:z,height:z,def:I},events:{render:C,move:C,show:C,hide:C,toggle:C,visible:C,hidden:C,focus:C,blur:C}};var rt,lt="margin",pt="border",ht="color",dt="background-color",ct="transparent",ut=" !important",ft=!!t.createElement("canvas").getContext,gt=/rgba?\(0, 0, 0(, 0)?\)|transparent|#123456/i,mt={},_t=["Webkit","O","Moz","ms"];if(ft)var wt=e.devicePixelRatio||1,bt=function(){var e=t.createElement("canvas").getContext("2d");return e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||1}(),vt=wt/bt;else var yt=function(e,t,i){return"<qtipvml:"+e+' xmlns="urn:schemas-microsoft.com:vml" class="qtip-vml" '+(t||"")+' style="behavior: url(#default#VML); '+(i||"")+'" />'};n.extend(k.prototype,{init:function(e){var t,i;i=this.element=e.elements.tip=n("<div />",{"class":W+"-tip"}).prependTo(e.tooltip),ft?(t=n("<canvas />").appendTo(this.element)[0].getContext("2d"),t.lineJoin="miter",t.miterLimit=1e5,t.save()):(t=yt("shape",'coordorigin="0,0"',"position:absolute;"),this.element.html(t+t),e._bind(n("*",i).add(i),["click","mousedown"],function(e){e.stopPropagation()},this._ns)),e._bind(e.tooltip,"tooltipmove",this.reposition,this._ns,this),this.create()},_swapDimensions:function(){this.size[0]=this.options.height,this.size[1]=this.options.width},_resetDimensions:function(){this.size[0]=this.options.width,this.size[1]=this.options.height},_useTitle:function(e){var t=this.qtip.elements.titlebar;return t&&(e.y===E||e.y===L&&this.element.position().top+this.size[1]/2+this.options.offset<t.outerHeight(I))},_parseCorner:function(e){var t=this.qtip.options.position.my;return e===z||t===z?e=z:e===I?e=new T(t.string()):e.string||(e=new T(e),e.fixed=I),e},_parseWidth:function(e,t,i){var n=this.qtip.elements,o=pt+b(t)+"Width";return(i?y(i,o):y(n.content,o)||y(this._useTitle(e)&&n.titlebar||n.content,o)||y(n.tooltip,o))||0},_parseRadius:function(e){var t=this.qtip.elements,i=pt+b(e.y)+b(e.x)+"Radius";return it.ie<9?0:y(this._useTitle(e)&&t.titlebar||t.content,i)||y(t.tooltip,i)||0},_invalidColour:function(e,t,i){var n=e.css(t);return!n||i&&n===e.css(i)||gt.test(n)?z:n},_parseColours:function(e){var t=this.qtip.elements,i=this.element.css("cssText",""),o=pt+b(e[e.precedance])+b(ht),a=this._useTitle(e)&&t.titlebar||t.content,s=this._invalidColour,r=[];return r[0]=s(i,dt)||s(a,dt)||s(t.content,dt)||s(t.tooltip,dt)||i.css(dt),r[1]=s(i,o,ht)||s(a,o,ht)||s(t.content,o,ht)||s(t.tooltip,o,ht)||t.tooltip.css(o),n("*",i).add(i).css("cssText",dt+":"+ct+ut+";"+pt+":0"+ut+";"),r},_calculateSize:function(e){var t,i,n,o=e.precedance===D,a=this.options.width,s=this.options.height,r="c"===e.abbrev(),l=(o?a:s)*(r?.5:1),p=Math.pow,h=Math.round,d=Math.sqrt(p(l,2)+p(s,2)),c=[this.border/l*d,this.border/s*d];return c[2]=Math.sqrt(p(c[0],2)-p(this.border,2)),c[3]=Math.sqrt(p(c[1],2)-p(this.border,2)),t=d+c[2]+c[3]+(r?0:c[0]),i=t/d,n=[h(i*a),h(i*s)],o?n:n.reverse()},_calculateTip:function(e,t,i){i=i||1,t=t||this.size;var n=t[0]*i,o=t[1]*i,a=Math.ceil(n/2),s=Math.ceil(o/2),r={br:[0,0,n,o,n,0],bl:[0,0,n,0,0,o],tr:[0,o,n,0,n,o],tl:[0,0,0,o,n,o],tc:[0,o,a,0,n,o],bc:[0,0,n,0,a,o],rc:[0,0,n,s,0,o],lc:[n,0,n,o,0,s]};return r.lt=r.br,r.rt=r.bl,r.lb=r.tr,r.rb=r.tl,r[e.abbrev()]},_drawCoords:function(e,t){e.beginPath(),e.moveTo(t[0],t[1]),e.lineTo(t[2],t[3]),e.lineTo(t[4],t[5]),e.closePath()},create:function(){var e=this.corner=(ft||it.ie)&&this._parseCorner(this.options.corner);return(this.enabled=!!this.corner&&"c"!==this.corner.abbrev())&&(this.qtip.cache.corner=e.clone(),this.update()),this.element.toggle(this.enabled),this.corner},update:function(t,i){if(!this.enabled)return this;var o,a,s,r,l,p,h,d,c=this.qtip.elements,u=this.element,f=u.children(),g=this.options,m=this.size,_=g.mimic,w=Math.round;t||(t=this.qtip.cache.corner||this.corner),_===z?_=t:(_=new T(_),_.precedance=t.precedance,"inherit"===_.x?_.x=t.x:"inherit"===_.y?_.y=t.y:_.x===_.y&&(_[t.precedance]=t[t.precedance])),a=_.precedance,t.precedance===$?this._swapDimensions():this._resetDimensions(),o=this.color=this._parseColours(t),o[1]!==ct?(d=this.border=this._parseWidth(t,t[t.precedance]),g.border&&1>d&&!gt.test(o[1])&&(o[0]=o[1]),this.border=d=g.border!==I?g.border:d):this.border=d=0,h=this.size=this._calculateSize(t),u.css({width:h[0],height:h[1],lineHeight:h[1]+"px"}),p=t.precedance===D?[w(_.x===F?d:_.x===B?h[0]-m[0]-d:(h[0]-m[0])/2),w(_.y===E?h[1]-m[1]:0)]:[w(_.x===F?h[0]-m[0]:0),w(_.y===E?d:_.y===N?h[1]-m[1]-d:(h[1]-m[1])/2)],ft?(s=f[0].getContext("2d"),s.restore(),s.save(),s.clearRect(0,0,6e3,6e3),r=this._calculateTip(_,m,vt),l=this._calculateTip(_,this.size,vt),f.attr(j,h[0]*vt).attr(A,h[1]*vt),f.css(j,h[0]).css(A,h[1]),this._drawCoords(s,l),s.fillStyle=o[1],s.fill(),s.translate(p[0]*vt,p[1]*vt),this._drawCoords(s,r),s.fillStyle=o[0],s.fill()):(r=this._calculateTip(_),r="m"+r[0]+","+r[1]+" l"+r[2]+","+r[3]+" "+r[4]+","+r[5]+" xe",p[2]=d&&/^(r|b)/i.test(t.string())?8===it.ie?2:1:0,f.css({coordsize:h[0]+d+" "+(h[1]+d),antialias:""+(_.string().indexOf(L)>-1),left:p[0]-p[2]*Number(a===$),top:p[1]-p[2]*Number(a===D),width:h[0]+d,height:h[1]+d}).each(function(e){var t=n(this);t[t.prop?"prop":"attr"]({coordsize:h[0]+d+" "+(h[1]+d),path:r,fillcolor:o[0],filled:!!e,stroked:!e}).toggle(!(!d&&!e)),!e&&t.html(yt("stroke",'weight="'+2*d+'px" color="'+o[1]+'" miterlimit="1000" joinstyle="miter"'))})),e.opera&&setTimeout(function(){c.tip.css({display:"inline-block",visibility:"visible"})},1),i!==z&&this.calculate(t,h)},calculate:function(e,t){if(!this.enabled)return z;var i,o,a=this,s=this.qtip.elements,r=this.element,l=this.options.offset,p=(s.tooltip.hasClass("ui-widget"),{});return e=e||this.corner,i=e.precedance,t=t||this._calculateSize(e),o=[e.x,e.y],i===$&&o.reverse(),n.each(o,function(n,o){var r,h,d;o===L?(r=i===D?F:E,p[r]="50%",p[lt+"-"+r]=-Math.round(t[i===D?0:1]/2)+l):(r=a._parseWidth(e,o,s.tooltip),h=a._parseWidth(e,o,s.content),d=a._parseRadius(e),p[o]=Math.max(-a.border,n?h:l+(d>r?d:-r)))}),p[e[i]]-=t[i===$?0:1],r.css({margin:"",top:"",bottom:"",left:"",right:""}).css(p),p},reposition:function(e,t,n){function o(e,t,i,n,o){e===O&&p.precedance===t&&h[n]&&p[i]!==L?p.precedance=p.precedance===$?D:$:e!==O&&h[n]&&(p[t]=p[t]===L?h[n]>0?n:o:p[t]===n?o:n)}function a(e,t,o){p[e]===L?g[lt+"-"+t]=f[e]=s[lt+"-"+t]-h[t]:(r=s[o]!==i?[h[t],-s[t]]:[-h[t],s[t]],(f[e]=Math.max(r[0],r[1]))>r[0]&&(n[t]-=h[t],f[t]=z),g[s[o]!==i?o:t]=f[e])}if(this.enabled){var s,r,l=t.cache,p=this.corner.clone(),h=n.adjusted,d=t.options.position.adjust.method.split(" "),c=d[0],u=d[1]||d[0],f={left:z,top:z,x:0,y:0},g={};this.corner.fixed!==I&&(o(c,$,D,F,B),o(u,D,$,E,N),p.string()===l.corner.string()||l.cornerTop===h.top&&l.cornerLeft===h.left||this.update(p,z)),s=this.calculate(p),s.right!==i&&(s.left=-s.right),s.bottom!==i&&(s.top=-s.bottom),s.user=this.offset,(f.left=c===O&&!!h.left)&&a($,F,B),(f.top=u===O&&!!h.top)&&a(D,E,N),this.element.css(g).toggle(!(f.x&&f.y||p.x===L&&f.y||p.y===L&&f.x)),n.left-=s.left.charAt?s.user:c!==O||f.top||!f.left&&!f.top?s.left+this.border:0,n.top-=s.top.charAt?s.user:u!==O||f.left||!f.left&&!f.top?s.top+this.border:0,l.cornerLeft=h.left,l.cornerTop=h.top,l.corner=p.clone()}},destroy:function(){this.qtip._unbind(this.qtip.tooltip,this._ns),this.qtip.elements.tip&&this.qtip.elements.tip.find("*").remove().end().remove()}}),rt=H.tip=function(e){return new k(e,e.options.style.tip)},rt.initialize="render",rt.sanitize=function(e){if(e.style&&"tip"in e.style){var t=e.style.tip;"object"!=typeof t&&(t=e.style.tip={corner:t}),/string|boolean/i.test(typeof t.corner)||(t.corner=I)}},P.tip={"^position.my|style.tip.(corner|mimic|border)$":function(){this.create(),this.qtip.reposition()},"^style.tip.(height|width)$":function(e){this.size=[e.width,e.height],this.update(),this.qtip.reposition()},"^content.title|style.(classes|widget)$":function(){this.update()}},n.extend(I,x.defaults,{style:{tip:{corner:I,mimic:z,width:6,height:6,border:I,offset:0}}}),H.viewport=function(i,n,o,a,s,r,l){function p(e,t,i,o,a,s,r,l,p){var h=n[a],c=y[e],b=k[e],v=i===O,x=c===a?p:c===s?-p:-p/2,M=b===a?l:b===s?-l:-l/2,T=_[a]+w[a]-(f?0:u[a]),P=T-h,S=h+p-(r===j?g:m)-T,I=x-(y.precedance===e||c===y[t]?M:0)-(b===L?l/2:0);return v?(I=(c===a?1:-1)*x,n[a]+=P>0?P:S>0?-S:0,n[a]=Math.max(-u[a]+w[a],h-I,Math.min(Math.max(-u[a]+w[a]+(r===j?g:m),h+I),n[a],"center"===c?h-x:1e9))):(o*=i===K?2:0,P>0&&(c!==a||S>0)?(n[a]-=I+o,d.invert(e,a)):S>0&&(c!==s||P>0)&&(n[a]-=(c===L?-I:I)+o,d.invert(e,s)),n[a]<_&&-n[a]>S&&(n[a]=h,d=y.clone())),n[a]-h}var h,d,c,u,f,g,m,_,w,b=o.target,v=i.elements.tooltip,y=o.my,k=o.at,x=o.adjust,M=x.method.split(" "),T=M[0],P=M[1]||M[0],S=o.viewport,I=o.container,C=i.cache,H={left:0,top:0};return S.jquery&&b[0]!==e&&b[0]!==t.body&&"none"!==x.method?(u=I.offset()||H,f="static"===I.css("position"),h="fixed"===v.css("position"),g=S[0]===e?S.width():S.outerWidth(z),m=S[0]===e?S.height():S.outerHeight(z),_={left:h?0:S.scrollLeft(),top:h?0:S.scrollTop()},w=S.offset()||H,("shift"!==T||"shift"!==P)&&(d=y.clone()),H={left:"none"!==T?p($,D,T,x.x,F,B,j,a,r):0,top:"none"!==P?p(D,$,P,x.y,E,N,A,s,l):0},d&&C.lastClass!==(c=W+"-pos-"+d.abbrev())&&v.removeClass(i.cache.lastClass).addClass(i.cache.lastClass=c),H):H},H.polys={polygon:function(e,t){var i,n,o,a={width:0,height:0,position:{top:1e10,right:0,bottom:0,left:1e10},adjustable:z},s=0,r=[],l=1,p=1,h=0,d=0;for(s=e.length;s--;)i=[parseInt(e[--s],10),parseInt(e[s+1],10)],i[0]>a.position.right&&(a.position.right=i[0]),i[0]<a.position.left&&(a.position.left=i[0]),i[1]>a.position.bottom&&(a.position.bottom=i[1]),i[1]<a.position.top&&(a.position.top=i[1]),r.push(i);if(n=a.width=Math.abs(a.position.right-a.position.left),o=a.height=Math.abs(a.position.bottom-a.position.top),"c"===t.abbrev())a.position={left:a.position.left+a.width/2,top:a.position.top+a.height/2};else{for(;n>0&&o>0&&l>0&&p>0;)for(n=Math.floor(n/2),o=Math.floor(o/2),t.x===F?l=n:t.x===B?l=a.width-n:l+=Math.floor(n/2),t.y===E?p=o:t.y===N?p=a.height-o:p+=Math.floor(o/2),s=r.length;s--&&!(r.length<2);)h=r[s][0]-a.position.left,d=r[s][1]-a.position.top,(t.x===F&&h>=l||t.x===B&&l>=h||t.x===L&&(l>h||h>a.width-l)||t.y===E&&d>=p||t.y===N&&p>=d||t.y===L&&(p>d||d>a.height-p))&&r.splice(s,1);a.position={left:r[0][0],top:r[0][1]}}return a},rect:function(e,t,i,n){return{width:Math.abs(i-e),height:Math.abs(n-t),position:{left:Math.min(e,i),top:Math.min(t,n)}}},_angles:{tc:1.5,tr:7/4,tl:5/4,bc:.5,br:.25,bl:.75,rc:2,lc:1,c:0},ellipse:function(e,t,i,n,o){var a=H.polys._angles[o.abbrev()],s=0===a?0:i*Math.cos(a*Math.PI),r=n*Math.sin(a*Math.PI);return{width:2*i-Math.abs(s),height:2*n-Math.abs(r),position:{left:e+s,top:t+r},adjustable:z}},circle:function(e,t,i,n){return H.polys.ellipse(e,t,i,i,n)}},H.svg=function(e,i,o){for(var a,s,r,l,p,h,d,c,u,f,g,m=n(t),_=i[0],w=n(_.ownerSVGElement),b=1,v=1,y=!0;!_.getBBox;)_=_.parentNode;if(!_.getBBox||!_.parentNode)return z;a=w.attr("width")||w.width()||parseInt(w.css("width"),10),s=w.attr("height")||w.height()||parseInt(w.css("height"),10);var k=(parseInt(i.css("stroke-width"),10)||0)/2;switch(k&&(b+=k/a,v+=k/s),_.nodeName){case"ellipse":case"circle":f=H.polys.ellipse(_.cx.baseVal.value,_.cy.baseVal.value,(_.rx||_.r).baseVal.value+k,(_.ry||_.r).baseVal.value+k,o);break;case"line":case"polygon":case"polyline":for(u=_.points||[{x:_.x1.baseVal.value,y:_.y1.baseVal.value},{x:_.x2.baseVal.value,y:_.y2.baseVal.value}],f=[],c=-1,h=u.numberOfItems||u.length;++c<h;)d=u.getItem?u.getItem(c):u[c],f.push.apply(f,[d.x,d.y]);f=H.polys.polygon(f,o);break;default:f=_.getBoundingClientRect(),f={width:f.width,height:f.height,position:{left:f.left,top:f.top}},y=!1}return g=f.position,w=w[0],y&&(w.createSVGPoint&&(r=_.getScreenCTM(),u=w.createSVGPoint(),u.x=g.left,u.y=g.top,l=u.matrixTransform(r),g.left=l.x,g.top=l.y),w.viewBox&&(p=w.viewBox.baseVal)&&p.width&&p.height&&(b*=a/p.width,v*=s/p.height)),g.left+=m.scrollLeft(),g.top+=m.scrollTop(),f}})}(window,document),!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.proj4=e()}}(function(){return function e(t,i,n){function o(s,r){if(!i[s]){if(!t[s]){var l="function"==typeof require&&require;if(!r&&l)return l(s,!0);if(a)return a(s,!0);throw new Error("Cannot find module '"+s+"'")}var p=i[s]={exports:{}};t[s][0].call(p.exports,function(e){var i=t[s][1][e];return o(i?i:e)},p,p.exports,e,t,i,n)}return i[s].exports}for(var a="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t){function i(e,t,n){if(!(this instanceof i))return new i(e,t,n);if(Array.isArray(e))this.x=e[0],this.y=e[1],this.z=e[2]||0;else if("object"==typeof e)this.x=e.x,this.y=e.y,this.z=e.z||0;else if("string"==typeof e&&"undefined"==typeof t){var o=e.split(",");this.x=parseFloat(o[0],10),this.y=parseFloat(o[1],10),this.z=parseFloat(o[2],10)||0}else this.x=e,this.y=t,this.z=n||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}var n=e("mgrs");i.fromMGRS=function(e){return new i(n.toPoint(e))},i.prototype.toMGRS=function(e){return n.forward([this.x,this.y],e)},t.exports=i},{mgrs:66}],2:[function(e,t){function i(e,t){if(!(this instanceof i))return new i(e);t=t||function(e){if(e)throw e};var a=n(e);if("object"!=typeof a)return void t(e);var r=s(a),l=i.projections.get(r.projName);l?(o(this,r),o(this,l),this.init(),t(null,this)):t(e)}var n=e("./parseCode"),o=e("./extend"),a=e("./projections"),s=e("./deriveConstants");i.projections=a,i.projections.start(),t.exports=i},{"./deriveConstants":32,"./extend":33,"./parseCode":36,"./projections":38}],3:[function(e,t){t.exports=function(e,t,i){var n,o,a,s=i.x,r=i.y,l=i.z||0;for(a=0;3>a;a++)if(!t||2!==a||void 0!==i.z)switch(0===a?(n=s,o="x"):1===a?(n=r,o="y"):(n=l,o="z"),e.axis[a]){case"e":i[o]=n;break;case"w":i[o]=-n;break;case"n":i[o]=n;break;case"s":i[o]=-n;break;case"u":void 0!==i[o]&&(i.z=n);break;case"d":void 0!==i[o]&&(i.z=-n);break;default:return null}return i}},{}],4:[function(e,t){var i=Math.PI/2,n=e("./sign");t.exports=function(e){return Math.abs(e)<i?e:e-n(e)*Math.PI}},{"./sign":21}],5:[function(e,t){var i=2*Math.PI,n=e("./sign");t.exports=function(e){return Math.abs(e)<Math.PI?e:e-n(e)*i}},{"./sign":21}],6:[function(e,t){t.exports=function(e){return Math.abs(e)>1&&(e=e>1?1:-1),Math.asin(e)
}},{}],7:[function(e,t){t.exports=function(e){return 1-.25*e*(1+e/16*(3+1.25*e))}},{}],8:[function(e,t){t.exports=function(e){return.375*e*(1+.25*e*(1+.46875*e))}},{}],9:[function(e,t){t.exports=function(e){return.05859375*e*e*(1+.75*e)}},{}],10:[function(e,t){t.exports=function(e){return e*e*e*(35/3072)}},{}],11:[function(e,t){t.exports=function(e,t,i){var n=t*i;return e/Math.sqrt(1-n*n)}},{}],12:[function(e,t){t.exports=function(e,t,i,n,o){var a,s;a=e/t;for(var r=0;15>r;r++)if(s=(e-(t*a-i*Math.sin(2*a)+n*Math.sin(4*a)-o*Math.sin(6*a)))/(t-2*i*Math.cos(2*a)+4*n*Math.cos(4*a)-6*o*Math.cos(6*a)),a+=s,Math.abs(s)<=1e-10)return a;return 0/0}},{}],13:[function(e,t){var i=Math.PI/2;t.exports=function(e,t){var n=1-(1-e*e)/(2*e)*Math.log((1-e)/(1+e));if(Math.abs(Math.abs(t)-n)<1e-6)return 0>t?-1*i:i;for(var o,a,s,r,l=Math.asin(.5*t),p=0;30>p;p++)if(a=Math.sin(l),s=Math.cos(l),r=e*a,o=Math.pow(1-r*r,2)/(2*s)*(t/(1-e*e)-a/(1-r*r)+.5/e*Math.log((1-r)/(1+r))),l+=o,Math.abs(o)<=1e-10)return l;return 0/0}},{}],14:[function(e,t){t.exports=function(e,t,i,n,o){return e*o-t*Math.sin(2*o)+i*Math.sin(4*o)-n*Math.sin(6*o)}},{}],15:[function(e,t){t.exports=function(e,t,i){var n=e*t;return i/Math.sqrt(1-n*n)}},{}],16:[function(e,t){var i=Math.PI/2;t.exports=function(e,t){for(var n,o,a=.5*e,s=i-2*Math.atan(t),r=0;15>=r;r++)if(n=e*Math.sin(s),o=i-2*Math.atan(t*Math.pow((1-n)/(1+n),a))-s,s+=o,Math.abs(o)<=1e-10)return s;return-9999}},{}],17:[function(e,t){var i=1,n=.25,o=.046875,a=.01953125,s=.01068115234375,r=.75,l=.46875,p=.013020833333333334,h=.007120768229166667,d=.3645833333333333,c=.005696614583333333,u=.3076171875;t.exports=function(e){var t=[];t[0]=i-e*(n+e*(o+e*(a+e*s))),t[1]=e*(r-e*(o+e*(a+e*s)));var f=e*e;return t[2]=f*(l-e*(p+e*h)),f*=e,t[3]=f*(d-e*c),t[4]=f*e*u,t}},{}],18:[function(e,t){var i=e("./pj_mlfn"),n=1e-10,o=20;t.exports=function(e,t,a){for(var s=1/(1-t),r=e,l=o;l;--l){var p=Math.sin(r),h=1-t*p*p;if(h=(i(r,p,Math.cos(r),a)-e)*h*Math.sqrt(h)*s,r-=h,Math.abs(h)<n)return r}return r}},{"./pj_mlfn":19}],19:[function(e,t){t.exports=function(e,t,i,n){return i*=t,t*=t,n[0]*e-i*(n[1]+t*(n[2]+t*(n[3]+t*n[4])))}},{}],20:[function(e,t){t.exports=function(e,t){var i;return e>1e-7?(i=e*t,(1-e*e)*(t/(1-i*i)-.5/e*Math.log((1-i)/(1+i)))):2*t}},{}],21:[function(e,t){t.exports=function(e){return 0>e?-1:1}},{}],22:[function(e,t){t.exports=function(e,t){return Math.pow((1-e)/(1+e),t)}},{}],23:[function(e,t){t.exports=function(e){var t={x:e[0],y:e[1]};return e.length>2&&(t.z=e[2]),e.length>3&&(t.m=e[3]),t}},{}],24:[function(e,t){var i=Math.PI/2;t.exports=function(e,t,n){var o=e*n,a=.5*e;return o=Math.pow((1-o)/(1+o),a),Math.tan(.5*(i-t))/o}},{}],25:[function(e,t,i){i.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},i.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},i.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},i.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},i.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},i.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},i.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},i.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},i.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},i.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},i.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},i.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},i.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},i.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},i.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},i.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}},{}],26:[function(e,t,i){i.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"},i.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},i.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},i.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"},i.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},i.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},i.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},i.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},i.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},i.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},i.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},i.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},i.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},i.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},i.clrk80={a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},i.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},i.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},i.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},i.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},i.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},i.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},i.evrst56={a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},i.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},i.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},i.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},i.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"},i.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"},i.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"},i.hough={a:6378270,rf:297,ellipseName:"Hough"},i.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},i.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"},i.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"},i.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"},i.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},i.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},i.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},i.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},i.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"},i.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"},i.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"},i.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"},i.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"},i.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}},{}],27:[function(e,t,i){i.greenwich=0,i.lisbon=-9.131906111111,i.paris=2.337229166667,i.bogota=-74.080916666667,i.madrid=-3.687938888889,i.rome=12.452333333333,i.bern=7.439583333333,i.jakarta=106.807719444444,i.ferro=-17.666666666667,i.brussels=4.367975,i.stockholm=18.058277777778,i.athens=23.7163375,i.oslo=10.722916666667},{}],28:[function(e,t){function i(e,t,i){var n;return Array.isArray(i)?(n=s(e,t,i),3===i.length?[n.x,n.y,n.z]:[n.x,n.y]):s(e,t,i)}function n(e){return e instanceof a?e:e.oProj?e.oProj:a(e)}function o(e,t,o){e=n(e);var a,s=!1;return"undefined"==typeof t?(t=e,e=r,s=!0):("undefined"!=typeof t.x||Array.isArray(t))&&(o=t,t=e,e=r,s=!0),t=n(t),o?i(e,t,o):(a={forward:function(n){return i(e,t,n)},inverse:function(n){return i(t,e,n)}},s&&(a.oProj=t),a)}var a=e("./Proj"),s=e("./transform"),r=a("WGS84");t.exports=o},{"./Proj":2,"./transform":64}],29:[function(e,t){var i=Math.PI/2,n=1,o=2,a=3,s=4,r=5,l=484813681109536e-20,p=1.0026,h=.3826834323650898,d=function(e){if(!(this instanceof d))return new d(e);if(this.datum_type=s,e){if(e.datumCode&&"none"===e.datumCode&&(this.datum_type=r),e.datum_params){for(var t=0;t<e.datum_params.length;t++)e.datum_params[t]=parseFloat(e.datum_params[t]);(0!==e.datum_params[0]||0!==e.datum_params[1]||0!==e.datum_params[2])&&(this.datum_type=n),e.datum_params.length>3&&(0!==e.datum_params[3]||0!==e.datum_params[4]||0!==e.datum_params[5]||0!==e.datum_params[6])&&(this.datum_type=o,e.datum_params[3]*=l,e.datum_params[4]*=l,e.datum_params[5]*=l,e.datum_params[6]=e.datum_params[6]/1e6+1)}this.datum_type=e.grids?a:this.datum_type,this.a=e.a,this.b=e.b,this.es=e.es,this.ep2=e.ep2,this.datum_params=e.datum_params,this.datum_type===a&&(this.grids=e.grids)}};d.prototype={compare_datums:function(e){return this.datum_type!==e.datum_type?!1:this.a!==e.a||Math.abs(this.es-e.es)>5e-11?!1:this.datum_type===n?this.datum_params[0]===e.datum_params[0]&&this.datum_params[1]===e.datum_params[1]&&this.datum_params[2]===e.datum_params[2]:this.datum_type===o?this.datum_params[0]===e.datum_params[0]&&this.datum_params[1]===e.datum_params[1]&&this.datum_params[2]===e.datum_params[2]&&this.datum_params[3]===e.datum_params[3]&&this.datum_params[4]===e.datum_params[4]&&this.datum_params[5]===e.datum_params[5]&&this.datum_params[6]===e.datum_params[6]:this.datum_type===a||e.datum_type===a?this.nadgrids===e.nadgrids:!0},geodetic_to_geocentric:function(e){var t,n,o,a,s,r,l,p=e.x,h=e.y,d=e.z?e.z:0,c=0;if(-i>h&&h>-1.001*i)h=-i;else if(h>i&&1.001*i>h)h=i;else if(-i>h||h>i)return null;return p>Math.PI&&(p-=2*Math.PI),s=Math.sin(h),l=Math.cos(h),r=s*s,a=this.a/Math.sqrt(1-this.es*r),t=(a+d)*l*Math.cos(p),n=(a+d)*l*Math.sin(p),o=(a*(1-this.es)+d)*s,e.x=t,e.y=n,e.z=o,c},geocentric_to_geodetic:function(e){var t,n,o,a,s,r,l,p,h,d,c,u,f,g,m,_,w,b=1e-12,v=b*b,y=30,k=e.x,x=e.y,M=e.z?e.z:0;if(f=!1,t=Math.sqrt(k*k+x*x),n=Math.sqrt(k*k+x*x+M*M),t/this.a<b){if(f=!0,m=0,n/this.a<b)return _=i,void(w=-this.b)}else m=Math.atan2(x,k);o=M/n,a=t/n,s=1/Math.sqrt(1-this.es*(2-this.es)*a*a),p=a*(1-this.es)*s,h=o*s,g=0;do g++,l=this.a/Math.sqrt(1-this.es*h*h),w=t*p+M*h-l*(1-this.es*h*h),r=this.es*l/(l+w),s=1/Math.sqrt(1-r*(2-r)*a*a),d=a*(1-r)*s,c=o*s,u=c*p-d*h,p=d,h=c;while(u*u>v&&y>g);return _=Math.atan(c/Math.abs(d)),e.x=m,e.y=_,e.z=w,e},geocentric_to_geodetic_noniter:function(e){var t,n,o,a,s,r,l,d,c,u,f,g,m,_,w,b,v,y=e.x,k=e.y,x=e.z?e.z:0;if(y=parseFloat(y),k=parseFloat(k),x=parseFloat(x),v=!1,0!==y)t=Math.atan2(k,y);else if(k>0)t=i;else if(0>k)t=-i;else if(v=!0,t=0,x>0)n=i;else{if(!(0>x))return n=i,void(o=-this.b);n=-i}return s=y*y+k*k,a=Math.sqrt(s),r=x*p,d=Math.sqrt(r*r+s),u=r/d,g=a/d,f=u*u*u,l=x+this.b*this.ep2*f,b=a-this.a*this.es*g*g*g,c=Math.sqrt(l*l+b*b),m=l/c,_=b/c,w=this.a/Math.sqrt(1-this.es*m*m),o=_>=h?a/_-w:-h>=_?a/-_-w:x/m+w*(this.es-1),v===!1&&(n=Math.atan(m/_)),e.x=t,e.y=n,e.z=o,e},geocentric_to_wgs84:function(e){if(this.datum_type===n)e.x+=this.datum_params[0],e.y+=this.datum_params[1],e.z+=this.datum_params[2];else if(this.datum_type===o){var t=this.datum_params[0],i=this.datum_params[1],a=this.datum_params[2],s=this.datum_params[3],r=this.datum_params[4],l=this.datum_params[5],p=this.datum_params[6],h=p*(e.x-l*e.y+r*e.z)+t,d=p*(l*e.x+e.y-s*e.z)+i,c=p*(-r*e.x+s*e.y+e.z)+a;e.x=h,e.y=d,e.z=c}},geocentric_from_wgs84:function(e){if(this.datum_type===n)e.x-=this.datum_params[0],e.y-=this.datum_params[1],e.z-=this.datum_params[2];else if(this.datum_type===o){var t=this.datum_params[0],i=this.datum_params[1],a=this.datum_params[2],s=this.datum_params[3],r=this.datum_params[4],l=this.datum_params[5],p=this.datum_params[6],h=(e.x-t)/p,d=(e.y-i)/p,c=(e.z-a)/p;e.x=h+l*d-r*c,e.y=-l*h+d+s*c,e.z=r*h-s*d+c}}},t.exports=d},{}],30:[function(e,t){var i=1,n=2,o=3,a=5,s=6378137,r=.006694379990141316;t.exports=function(e,t,l){function p(e){return e===i||e===n}var h,d,c;if(e.compare_datums(t))return l;if(e.datum_type===a||t.datum_type===a)return l;var u=e.a,f=e.es,g=t.a,m=t.es,_=e.datum_type;if(_===o)if(0===this.apply_gridshift(e,0,l))e.a=s,e.es=r;else{if(!e.datum_params)return e.a=u,e.es=e.es,l;for(h=1,d=0,c=e.datum_params.length;c>d;d++)h*=e.datum_params[d];if(0===h)return e.a=u,e.es=e.es,l;_=e.datum_params.length>3?n:i}return t.datum_type===o&&(t.a=s,t.es=r),(e.es!==t.es||e.a!==t.a||p(_)||p(t.datum_type))&&(e.geodetic_to_geocentric(l),p(e.datum_type)&&e.geocentric_to_wgs84(l),p(t.datum_type)&&t.geocentric_from_wgs84(l),t.geocentric_to_geodetic(l)),t.datum_type===o&&this.apply_gridshift(t,1,l),e.a=u,e.es=f,t.a=g,t.es=m,l}},{}],31:[function(e,t){function i(e){var t=this;if(2===arguments.length)i[e]="+"===arguments[1][0]?o(arguments[1]):a(arguments[1]);else if(1===arguments.length)return Array.isArray(e)?e.map(function(e){Array.isArray(e)?i.apply(t,e):i(e)}):void("string"==typeof e||("EPSG"in e?i["EPSG:"+e.EPSG]=e:"ESRI"in e?i["ESRI:"+e.ESRI]=e:"IAU2000"in e?i["IAU2000:"+e.IAU2000]=e:console.log(e)))}var n=e("./global"),o=e("./projString"),a=e("./wkt");n(i),t.exports=i},{"./global":34,"./projString":37,"./wkt":65}],32:[function(e,t){var i=e("./constants/Datum"),n=e("./constants/Ellipsoid"),o=e("./extend"),a=e("./datum"),s=1e-10,r=.16666666666666666,l=.04722222222222222,p=.022156084656084655;t.exports=function(e){if(e.datumCode&&"none"!==e.datumCode){var t=i[e.datumCode];t&&(e.datum_params=t.towgs84?t.towgs84.split(","):null,e.ellps=t.ellipse,e.datumName=t.datumName?t.datumName:e.datumCode)}if(!e.a){var h=n[e.ellps]?n[e.ellps]:n.WGS84;o(e,h)}return e.rf&&!e.b&&(e.b=(1-1/e.rf)*e.a),(0===e.rf||Math.abs(e.a-e.b)<s)&&(e.sphere=!0,e.b=e.a),e.a2=e.a*e.a,e.b2=e.b*e.b,e.es=(e.a2-e.b2)/e.a2,e.e=Math.sqrt(e.es),e.R_A&&(e.a*=1-e.es*(r+e.es*(l+e.es*p)),e.a2=e.a*e.a,e.b2=e.b*e.b,e.es=0),e.ep2=(e.a2-e.b2)/e.b2,e.k0||(e.k0=1),e.axis||(e.axis="enu"),e.datum=a(e),e}},{"./constants/Datum":25,"./constants/Ellipsoid":26,"./datum":29,"./extend":33}],33:[function(e,t){t.exports=function(e,t){e=e||{};var i,n;if(!t)return e;for(n in t)i=t[n],void 0!==i&&(e[n]=i);return e}},{}],34:[function(e,t){t.exports=function(e){e("WGS84","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),e("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),e("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),e("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),e["EPSG:3785"]=e["EPSG:3857"],e.GOOGLE=e["EPSG:3857"],e["EPSG:900913"]=e["EPSG:3857"],e["EPSG:102113"]=e["EPSG:3857"]}},{}],35:[function(e,t){var i=e("./core");i.defaultDatum="WGS84",i.Proj=e("./Proj"),i.WGS84=new i.Proj("WGS84"),i.Point=e("./Point"),i.toPoint=e("./common/toPoint"),i.defs=e("./defs"),i.transform=e("./transform"),i.mgrs=e("mgrs"),i.version=e("../package.json").version,e("./includedProjections")(i),t.exports=i},{"../package.json":67,"./Point":1,"./Proj":2,"./common/toPoint":23,"./core":28,"./defs":31,"./includedProjections":"gWUPNW","./transform":64,mgrs:66}],36:[function(e,t){function i(e){return"string"==typeof e}function n(e){return e in r}function o(e){var t=["GEOGCS","GEOCCS","PROJCS","LOCAL_CS"];return t.reduce(function(t,i){return t+1+e.indexOf(i)},0)}function a(e){return"+"===e[0]}function s(e){return i(e)?n(e)?r[e]:o(e)?l(e):a(e)?p(e):void 0:e}var r=e("./defs"),l=e("./wkt"),p=e("./projString");t.exports=s},{"./defs":31,"./projString":37,"./wkt":65}],37:[function(e,t){var i=.017453292519943295,n=e("./constants/PrimeMeridian");t.exports=function(e){var t={},o={};e.split("+").map(function(e){return e.trim()}).filter(function(e){return e}).forEach(function(e){var t=e.split("=");t.push(!0),o[t[0].toLowerCase()]=t[1]});var a,s,r,l={proj:"projName",datum:"datumCode",rf:function(e){t.rf=parseFloat(e,10)},lat_0:function(e){t.lat0=e*i},lat_1:function(e){t.lat1=e*i},lat_2:function(e){t.lat2=e*i},lat_ts:function(e){t.lat_ts=e*i},lon_0:function(e){t.long0=e*i},lon_1:function(e){t.long1=e*i},lon_2:function(e){t.long2=e*i},alpha:function(e){t.alpha=parseFloat(e)*i},lonc:function(e){t.longc=e*i},x_0:function(e){t.x0=parseFloat(e,10)},y_0:function(e){t.y0=parseFloat(e,10)},k_0:function(e){t.k0=parseFloat(e,10)},k:function(e){t.k0=parseFloat(e,10)},r_a:function(){t.R_A=!0},zone:function(e){t.zone=parseInt(e,10)},south:function(){t.utmSouth=!0},towgs84:function(e){t.datum_params=e.split(",").map(function(e){return parseFloat(e,10)})},to_meter:function(e){t.to_meter=parseFloat(e,10)},from_greenwich:function(e){t.from_greenwich=e*i},pm:function(e){t.from_greenwich=(n[e]?n[e]:parseFloat(e,10))*i},nadgrids:function(e){"@null"===e?t.datumCode="none":t.nadgrids=e},axis:function(e){var i="ewnsud";3===e.length&&-1!==i.indexOf(e.substr(0,1))&&-1!==i.indexOf(e.substr(1,1))&&-1!==i.indexOf(e.substr(2,1))&&(t.axis=e)}};for(a in o)s=o[a],a in l?(r=l[a],"function"==typeof r?r(s):t[r]=s):t[a]=s;return"string"==typeof t.datumCode&&"WGS84"!==t.datumCode&&(t.datumCode=t.datumCode.toLowerCase()),t}},{"./constants/PrimeMeridian":27}],38:[function(e,t,i){function n(e,t){var i=s.length;return e.names?(s[i]=e,e.names.forEach(function(e){a[e.toLowerCase()]=i}),this):(console.log(t),!0)}var o=[e("./projections/merc"),e("./projections/longlat")],a={},s=[];i.add=n,i.get=function(e){if(!e)return!1;var t=e.toLowerCase();return"undefined"!=typeof a[t]&&s[a[t]]?s[a[t]]:void 0},i.start=function(){o.forEach(n)}},{"./projections/longlat":50,"./projections/merc":51}],39:[function(e,t,i){var n=1e-10,o=e("../common/msfnz"),a=e("../common/qsfnz"),s=e("../common/adjust_lon"),r=e("../common/asinz");i.init=function(){Math.abs(this.lat1+this.lat2)<n||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=o(this.e3,this.sin_po,this.cos_po),this.qs1=a(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=o(this.e3,this.sin_po,this.cos_po),this.qs2=a(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=a(this.e3,this.sin_po,this.cos_po),this.ns0=Math.abs(this.lat1-this.lat2)>n?(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},i.forward=function(e){var t=e.x,i=e.y;this.sin_phi=Math.sin(i),this.cos_phi=Math.cos(i);var n=a(this.e3,this.sin_phi,this.cos_phi),o=this.a*Math.sqrt(this.c-this.ns0*n)/this.ns0,r=this.ns0*s(t-this.long0),l=o*Math.sin(r)+this.x0,p=this.rh-o*Math.cos(r)+this.y0;return e.x=l,e.y=p,e},i.inverse=function(e){var t,i,n,o,a,r;return e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns0>=0?(t=Math.sqrt(e.x*e.x+e.y*e.y),n=1):(t=-Math.sqrt(e.x*e.x+e.y*e.y),n=-1),o=0,0!==t&&(o=Math.atan2(n*e.x,n*e.y)),n=t*this.ns0/this.a,this.sphere?r=Math.asin((this.c-n*n)/(2*this.ns0)):(i=(this.c-n*n)/this.ns0,r=this.phi1z(this.e3,i)),a=s(o/this.ns0+this.long0),e.x=a,e.y=r,e},i.phi1z=function(e,t){var i,o,a,s,l,p=r(.5*t);if(n>e)return p;for(var h=e*e,d=1;25>=d;d++)if(i=Math.sin(p),o=Math.cos(p),a=e*i,s=1-a*a,l=.5*s*s/o*(t/(1-h)-i/s+.5/e*Math.log((1-a)/(1+a))),p+=l,Math.abs(l)<=1e-7)return p;return null},i.names=["Albers_Conic_Equal_Area","Albers","aea"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/msfnz":15,"../common/qsfnz":20}],40:[function(e,t,i){var n=e("../common/adjust_lon"),o=Math.PI/2,a=1e-10,s=e("../common/mlfn"),r=e("../common/e0fn"),l=e("../common/e1fn"),p=e("../common/e2fn"),h=e("../common/e3fn"),d=e("../common/gN"),c=e("../common/asinz"),u=e("../common/imlfn");i.init=function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},i.forward=function(e){var t,i,c,u,f,g,m,_,w,b,v,y,k,x,M,T,P,S,I,z,C,$,D,j=e.x,A=e.y,E=Math.sin(e.y),F=Math.cos(e.y),N=n(j-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=a?(e.x=this.x0+this.a*(o-A)*Math.sin(N),e.y=this.y0-this.a*(o-A)*Math.cos(N),e):Math.abs(this.sin_p12+1)<=a?(e.x=this.x0+this.a*(o+A)*Math.sin(N),e.y=this.y0+this.a*(o+A)*Math.cos(N),e):(S=this.sin_p12*E+this.cos_p12*F*Math.cos(N),T=Math.acos(S),P=T/Math.sin(T),e.x=this.x0+this.a*P*F*Math.sin(N),e.y=this.y0+this.a*P*(this.cos_p12*E-this.sin_p12*F*Math.cos(N)),e):(t=r(this.es),i=l(this.es),c=p(this.es),u=h(this.es),Math.abs(this.sin_p12-1)<=a?(f=this.a*s(t,i,c,u,o),g=this.a*s(t,i,c,u,A),e.x=this.x0+(f-g)*Math.sin(N),e.y=this.y0-(f-g)*Math.cos(N),e):Math.abs(this.sin_p12+1)<=a?(f=this.a*s(t,i,c,u,o),g=this.a*s(t,i,c,u,A),e.x=this.x0+(f+g)*Math.sin(N),e.y=this.y0+(f+g)*Math.cos(N),e):(m=E/F,_=d(this.a,this.e,this.sin_p12),w=d(this.a,this.e,E),b=Math.atan((1-this.es)*m+this.es*_*this.sin_p12/(w*F)),v=Math.atan2(Math.sin(N),this.cos_p12*Math.tan(b)-this.sin_p12*Math.cos(N)),I=0===v?Math.asin(this.cos_p12*Math.sin(b)-this.sin_p12*Math.cos(b)):Math.abs(Math.abs(v)-Math.PI)<=a?-Math.asin(this.cos_p12*Math.sin(b)-this.sin_p12*Math.cos(b)):Math.asin(Math.sin(N)*Math.cos(b)/Math.sin(v)),y=this.e*this.sin_p12/Math.sqrt(1-this.es),k=this.e*this.cos_p12*Math.cos(v)/Math.sqrt(1-this.es),x=y*k,M=k*k,z=I*I,C=z*I,$=C*I,D=$*I,T=_*I*(1-z*M*(1-M)/6+C/8*x*(1-2*M)+$/120*(M*(4-7*M)-3*y*y*(1-7*M))-D/48*x),e.x=this.x0+T*Math.sin(v),e.y=this.y0+T*Math.cos(v),e))},i.inverse=function(e){e.x-=this.x0,e.y-=this.y0;var t,i,f,g,m,_,w,b,v,y,k,x,M,T,P,S,I,z,C,$,D,j,A;if(this.sphere){if(t=Math.sqrt(e.x*e.x+e.y*e.y),t>2*o*this.a)return;return i=t/this.a,f=Math.sin(i),g=Math.cos(i),m=this.long0,Math.abs(t)<=a?_=this.lat0:(_=c(g*this.sin_p12+e.y*f*this.cos_p12/t),w=Math.abs(this.lat0)-o,m=n(Math.abs(w)<=a?this.lat0>=0?this.long0+Math.atan2(e.x,-e.y):this.long0-Math.atan2(-e.x,e.y):this.long0+Math.atan2(e.x*f,t*this.cos_p12*g-e.y*this.sin_p12*f))),e.x=m,e.y=_,e}return b=r(this.es),v=l(this.es),y=p(this.es),k=h(this.es),Math.abs(this.sin_p12-1)<=a?(x=this.a*s(b,v,y,k,o),t=Math.sqrt(e.x*e.x+e.y*e.y),M=x-t,_=u(M/this.a,b,v,y,k),m=n(this.long0+Math.atan2(e.x,-1*e.y)),e.x=m,e.y=_,e):Math.abs(this.sin_p12+1)<=a?(x=this.a*s(b,v,y,k,o),t=Math.sqrt(e.x*e.x+e.y*e.y),M=t-x,_=u(M/this.a,b,v,y,k),m=n(this.long0+Math.atan2(e.x,e.y)),e.x=m,e.y=_,e):(t=Math.sqrt(e.x*e.x+e.y*e.y),S=Math.atan2(e.x,e.y),T=d(this.a,this.e,this.sin_p12),I=Math.cos(S),z=this.e*this.cos_p12*I,C=-z*z/(1-this.es),$=3*this.es*(1-C)*this.sin_p12*this.cos_p12*I/(1-this.es),D=t/T,j=D-C*(1+C)*Math.pow(D,3)/6-$*(1+3*C)*Math.pow(D,4)/24,A=1-C*j*j/2-D*j*j*j/6,P=Math.asin(this.sin_p12*Math.cos(j)+this.cos_p12*Math.sin(j)*I),m=n(this.long0+Math.asin(Math.sin(S)*Math.sin(j)/Math.cos(P))),_=Math.atan((1-this.es*A*this.sin_p12/Math.sin(P))*Math.tan(P)/(1-this.es)),e.x=m,e.y=_,e)},i.names=["Azimuthal_Equidistant","aeqd"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],41:[function(e,t,i){var n=e("../common/mlfn"),o=e("../common/e0fn"),a=e("../common/e1fn"),s=e("../common/e2fn"),r=e("../common/e3fn"),l=e("../common/gN"),p=e("../common/adjust_lon"),h=e("../common/adjust_lat"),d=e("../common/imlfn"),c=Math.PI/2,u=1e-10;i.init=function(){this.sphere||(this.e0=o(this.es),this.e1=a(this.es),this.e2=s(this.es),this.e3=r(this.es),this.ml0=this.a*n(this.e0,this.e1,this.e2,this.e3,this.lat0))},i.forward=function(e){var t,i,o=e.x,a=e.y;if(o=p(o-this.long0),this.sphere)t=this.a*Math.asin(Math.cos(a)*Math.sin(o)),i=this.a*(Math.atan2(Math.tan(a),Math.cos(o))-this.lat0);else{var s=Math.sin(a),r=Math.cos(a),h=l(this.a,this.e,s),d=Math.tan(a)*Math.tan(a),c=o*Math.cos(a),u=c*c,f=this.es*r*r/(1-this.es),g=this.a*n(this.e0,this.e1,this.e2,this.e3,a);t=h*c*(1-u*d*(1/6-(8-d+8*f)*u/120)),i=g-this.ml0+h*s/r*u*(.5+(5-d+6*f)*u/24)}return e.x=t+this.x0,e.y=i+this.y0,e},i.inverse=function(e){e.x-=this.x0,e.y-=this.y0;var t,i,n=e.x/this.a,o=e.y/this.a;if(this.sphere){var a=o+this.lat0;t=Math.asin(Math.sin(a)*Math.cos(n)),i=Math.atan2(Math.tan(n),Math.cos(a))}else{var s=this.ml0/this.a+o,r=d(s,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(r)-c)<=u)return e.x=this.long0,e.y=c,0>o&&(e.y*=-1),e;var f=l(this.a,this.e,Math.sin(r)),g=f*f*f/this.a/this.a*(1-this.es),m=Math.pow(Math.tan(r),2),_=n*this.a/f,w=_*_;t=r-f*Math.tan(r)/g*_*_*(.5-(1+3*m)*_*_/24),i=_*(1-w*(m/3+(1+3*m)*m*w/15))/Math.cos(r)}return e.x=p(i+this.long0),e.y=h(t),e},i.names=["Cassini","Cassini_Soldner","cass"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],42:[function(e,t,i){var n=e("../common/adjust_lon"),o=e("../common/qsfnz"),a=e("../common/msfnz"),s=e("../common/iqsfnz");i.init=function(){this.sphere||(this.k0=a(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},i.forward=function(e){var t,i,a=e.x,s=e.y,r=n(a-this.long0);if(this.sphere)t=this.x0+this.a*r*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(s)/Math.cos(this.lat_ts);else{var l=o(this.e,Math.sin(s));t=this.x0+this.a*this.k0*r,i=this.y0+this.a*l*.5/this.k0}return e.x=t,e.y=i,e},i.inverse=function(e){e.x-=this.x0,e.y-=this.y0;var t,i;return this.sphere?(t=n(this.long0+e.x/this.a/Math.cos(this.lat_ts)),i=Math.asin(e.y/this.a*Math.cos(this.lat_ts))):(i=s(this.e,2*e.y*this.k0/this.a),t=n(this.long0+e.x/(this.a*this.k0))),e.x=t,e.y=i,e},i.names=["cea"]},{"../common/adjust_lon":5,"../common/iqsfnz":13,"../common/msfnz":15,"../common/qsfnz":20}],43:[function(e,t,i){var n=e("../common/adjust_lon"),o=e("../common/adjust_lat");i.init=function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},i.forward=function(e){var t=e.x,i=e.y,a=n(t-this.long0),s=o(i-this.lat0);return e.x=this.x0+this.a*a*this.rc,e.y=this.y0+this.a*s,e},i.inverse=function(e){var t=e.x,i=e.y;return e.x=n(this.long0+(t-this.x0)/(this.a*this.rc)),e.y=o(this.lat0+(i-this.y0)/this.a),e},i.names=["Equirectangular","Equidistant_Cylindrical","eqc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5}],44:[function(e,t,i){var n=e("../common/e0fn"),o=e("../common/e1fn"),a=e("../common/e2fn"),s=e("../common/e3fn"),r=e("../common/msfnz"),l=e("../common/mlfn"),p=e("../common/adjust_lon"),h=e("../common/adjust_lat"),d=e("../common/imlfn"),c=1e-10;i.init=function(){Math.abs(this.lat1+this.lat2)<c||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=n(this.es),this.e1=o(this.es),this.e2=a(this.es),this.e3=s(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=r(this.e,this.sinphi,this.cosphi),this.ml1=l(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<c?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=r(this.e,this.sinphi,this.cosphi),this.ml2=l(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=l(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},i.forward=function(e){var t,i=e.x,n=e.y;if(this.sphere)t=this.a*(this.g-n);else{var o=l(this.e0,this.e1,this.e2,this.e3,n);t=this.a*(this.g-o)}var a=this.ns*p(i-this.long0),s=this.x0+t*Math.sin(a),r=this.y0+this.rh-t*Math.cos(a);return e.x=s,e.y=r,e},i.inverse=function(e){e.x-=this.x0,e.y=this.rh-e.y+this.y0;var t,i,n,o;this.ns>=0?(i=Math.sqrt(e.x*e.x+e.y*e.y),t=1):(i=-Math.sqrt(e.x*e.x+e.y*e.y),t=-1);var a=0;if(0!==i&&(a=Math.atan2(t*e.x,t*e.y)),this.sphere)return o=p(this.long0+a/this.ns),n=h(this.g-i/this.a),e.x=o,e.y=n,e;var s=this.g-i/this.a;return n=d(s,this.e0,this.e1,this.e2,this.e3),o=p(this.long0+a/this.ns),e.x=o,e.y=n,e},i.names=["Equidistant_Conic","eqdc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/imlfn":12,"../common/mlfn":14,"../common/msfnz":15}],45:[function(e,t,i){var n=Math.PI/4,o=e("../common/srat"),a=Math.PI/2,s=20;i.init=function(){var e=Math.sin(this.lat0),t=Math.cos(this.lat0);t*=t,this.rc=Math.sqrt(1-this.es)/(1-this.es*e*e),this.C=Math.sqrt(1+this.es*t*t/(1-this.es)),this.phic0=Math.asin(e/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+n)/(Math.pow(Math.tan(.5*this.lat0+n),this.C)*o(this.e*e,this.ratexp))},i.forward=function(e){var t=e.x,i=e.y;return e.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*i+n),this.C)*o(this.e*Math.sin(i),this.ratexp))-a,e.x=this.C*t,e},i.inverse=function(e){for(var t=1e-14,i=e.x/this.C,r=e.y,l=Math.pow(Math.tan(.5*r+n)/this.K,1/this.C),p=s;p>0&&(r=2*Math.atan(l*o(this.e*Math.sin(e.y),-.5*this.e))-a,!(Math.abs(r-e.y)<t));--p)e.y=r;return p?(e.x=i,e.y=r,e):null},i.names=["gauss"]},{"../common/srat":22}],46:[function(e,t,i){var n=e("../common/adjust_lon"),o=1e-10,a=e("../common/asinz");i.init=function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},i.forward=function(e){var t,i,a,s,r,l,p,h,d=e.x,c=e.y;return a=n(d-this.long0),t=Math.sin(c),i=Math.cos(c),s=Math.cos(a),l=this.sin_p14*t+this.cos_p14*i*s,r=1,l>0||Math.abs(l)<=o?(p=this.x0+this.a*r*i*Math.sin(a)/l,h=this.y0+this.a*r*(this.cos_p14*t-this.sin_p14*i*s)/l):(p=this.x0+this.infinity_dist*i*Math.sin(a),h=this.y0+this.infinity_dist*(this.cos_p14*t-this.sin_p14*i*s)),e.x=p,e.y=h,e},i.inverse=function(e){var t,i,o,s,r,l;return e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,(t=Math.sqrt(e.x*e.x+e.y*e.y))?(s=Math.atan2(t,this.rc),i=Math.sin(s),o=Math.cos(s),l=a(o*this.sin_p14+e.y*i*this.cos_p14/t),r=Math.atan2(e.x*i,t*this.cos_p14*o-e.y*this.sin_p14*i),r=n(this.long0+r)):(l=this.phic0,r=0),e.x=r,e.y=l,e},i.names=["gnom"]},{"../common/adjust_lon":5,"../common/asinz":6}],47:[function(e,t,i){var n=e("../common/adjust_lon");i.init=function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},i.forward=function(e){var t,i,o,a,s,r,l,p=e.x,h=e.y,d=n(p-this.long0);return t=Math.pow((1+this.e*Math.sin(h))/(1-this.e*Math.sin(h)),this.alfa*this.e/2),i=2*(Math.atan(this.k*Math.pow(Math.tan(h/2+this.s45),this.alfa)/t)-this.s45),o=-d*this.alfa,a=Math.asin(Math.cos(this.ad)*Math.sin(i)+Math.sin(this.ad)*Math.cos(i)*Math.cos(o)),s=Math.asin(Math.cos(i)*Math.sin(o)/Math.cos(a)),r=this.n*s,l=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(a/2+this.s45),this.n),e.y=l*Math.cos(r)/1,e.x=l*Math.sin(r)/1,this.czech||(e.y*=-1,e.x*=-1),e},i.inverse=function(e){var t,i,n,o,a,s,r,l,p=e.x;e.x=e.y,e.y=p,this.czech||(e.y*=-1,e.x*=-1),s=Math.sqrt(e.x*e.x+e.y*e.y),a=Math.atan2(e.y,e.x),o=a/Math.sin(this.s0),n=2*(Math.atan(Math.pow(this.ro0/s,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),t=Math.asin(Math.cos(this.ad)*Math.sin(n)-Math.sin(this.ad)*Math.cos(n)*Math.cos(o)),i=Math.asin(Math.cos(n)*Math.sin(o)/Math.cos(t)),e.x=this.long0-i/this.alfa,r=t,l=0;var h=0;do e.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(t/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(r))/(1-this.e*Math.sin(r)),this.e/2))-this.s45),Math.abs(r-e.y)<1e-10&&(l=1),r=e.y,h+=1;
while(0===l&&15>h);return h>=15?null:e},i.names=["Krovak","krovak"]},{"../common/adjust_lon":5}],48:[function(e,t,i){var n=Math.PI/2,o=Math.PI/4,a=1e-10,s=e("../common/qsfnz"),r=e("../common/adjust_lon");i.S_POLE=1,i.N_POLE=2,i.EQUIT=3,i.OBLIQ=4,i.init=function(){var e=Math.abs(this.lat0);if(this.mode=Math.abs(e-n)<a?this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(e)<a?this.EQUIT:this.OBLIQ,this.es>0){var t;switch(this.qp=s(this.e,1),this.mmf=.5/(1-this.es),this.apa=this.authset(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=s(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},i.forward=function(e){var t,i,l,p,h,d,c,u,f,g,m=e.x,_=e.y;if(m=r(m-this.long0),this.sphere){if(h=Math.sin(_),g=Math.cos(_),l=Math.cos(m),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(i=this.mode===this.EQUIT?1+g*l:1+this.sinph0*h+this.cosph0*g*l,a>=i)return null;i=Math.sqrt(2/i),t=i*g*Math.sin(m),i*=this.mode===this.EQUIT?h:this.cosph0*h-this.sinph0*g*l}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(l=-l),Math.abs(_+this.phi0)<a)return null;i=o-.5*_,i=2*(this.mode===this.S_POLE?Math.cos(i):Math.sin(i)),t=i*Math.sin(m),i*=l}}else{switch(c=0,u=0,f=0,l=Math.cos(m),p=Math.sin(m),h=Math.sin(_),d=s(this.e,h),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(c=d/this.qp,u=Math.sqrt(1-c*c)),this.mode){case this.OBLIQ:f=1+this.sinb1*c+this.cosb1*u*l;break;case this.EQUIT:f=1+u*l;break;case this.N_POLE:f=n+_,d=this.qp-d;break;case this.S_POLE:f=_-n,d=this.qp+d}if(Math.abs(f)<a)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:f=Math.sqrt(2/f),i=this.mode===this.OBLIQ?this.ymf*f*(this.cosb1*c-this.sinb1*u*l):(f=Math.sqrt(2/(1+u*l)))*c*this.ymf,t=this.xmf*f*u*p;break;case this.N_POLE:case this.S_POLE:d>=0?(t=(f=Math.sqrt(d))*p,i=l*(this.mode===this.S_POLE?f:-f)):t=i=0}}return e.x=this.a*t+this.x0,e.y=this.a*i+this.y0,e},i.inverse=function(e){e.x-=this.x0,e.y-=this.y0;var t,i,o,s,l,p,h,d=e.x/this.a,c=e.y/this.a;if(this.sphere){var u,f=0,g=0;if(u=Math.sqrt(d*d+c*c),i=.5*u,i>1)return null;switch(i=2*Math.asin(i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(g=Math.sin(i),f=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(u)<=a?0:Math.asin(c*g/u),d*=g,c=f*u;break;case this.OBLIQ:i=Math.abs(u)<=a?this.phi0:Math.asin(f*this.sinph0+c*g*this.cosph0/u),d*=g*this.cosph0,c=(f-Math.sin(i)*this.sinph0)*u;break;case this.N_POLE:c=-c,i=n-i;break;case this.S_POLE:i-=n}t=0!==c||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(d,c):0}else{if(h=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(d/=this.dd,c*=this.dd,p=Math.sqrt(d*d+c*c),a>p)return e.x=0,e.y=this.phi0,e;s=2*Math.asin(.5*p/this.rq),o=Math.cos(s),d*=s=Math.sin(s),this.mode===this.OBLIQ?(h=o*this.sinb1+c*s*this.cosb1/p,l=this.qp*h,c=p*this.cosb1*o-c*this.sinb1*s):(h=c*s/p,l=this.qp*h,c=p*o)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(c=-c),l=d*d+c*c,!l)return e.x=0,e.y=this.phi0,e;h=1-l/this.qp,this.mode===this.S_POLE&&(h=-h)}t=Math.atan2(d,c),i=this.authlat(Math.asin(h),this.apa)}return e.x=r(this.long0+t),e.y=i,e},i.P00=.3333333333333333,i.P01=.17222222222222222,i.P02=.10257936507936508,i.P10=.06388888888888888,i.P11=.0664021164021164,i.P20=.016415012942191543,i.authset=function(e){var t,i=[];return i[0]=e*this.P00,t=e*e,i[0]+=t*this.P01,i[1]=t*this.P10,t*=e,i[0]+=t*this.P02,i[1]+=t*this.P11,i[2]=t*this.P20,i},i.authlat=function(e,t){var i=e+e;return e+t[0]*Math.sin(i)+t[1]*Math.sin(i+i)+t[2]*Math.sin(i+i+i)},i.names=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"]},{"../common/adjust_lon":5,"../common/qsfnz":20}],49:[function(e,t,i){var n=1e-10,o=e("../common/msfnz"),a=e("../common/tsfnz"),s=Math.PI/2,r=e("../common/sign"),l=e("../common/adjust_lon"),p=e("../common/phi2z");i.init=function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<n)){var e=this.b/this.a;this.e=Math.sqrt(1-e*e);var t=Math.sin(this.lat1),i=Math.cos(this.lat1),s=o(this.e,t,i),r=a(this.e,this.lat1,t),l=Math.sin(this.lat2),p=Math.cos(this.lat2),h=o(this.e,l,p),d=a(this.e,this.lat2,l),c=a(this.e,this.lat0,Math.sin(this.lat0));this.ns=Math.abs(this.lat1-this.lat2)>n?Math.log(s/h)/Math.log(r/d):t,isNaN(this.ns)&&(this.ns=t),this.f0=s/(this.ns*Math.pow(r,this.ns)),this.rh=this.a*this.f0*Math.pow(c,this.ns),this.title||(this.title="Lambert Conformal Conic")}},i.forward=function(e){var t=e.x,i=e.y;Math.abs(2*Math.abs(i)-Math.PI)<=n&&(i=r(i)*(s-2*n));var o,p,h=Math.abs(Math.abs(i)-s);if(h>n)o=a(this.e,i,Math.sin(i)),p=this.a*this.f0*Math.pow(o,this.ns);else{if(h=i*this.ns,0>=h)return null;p=0}var d=this.ns*l(t-this.long0);return e.x=this.k0*p*Math.sin(d)+this.x0,e.y=this.k0*(this.rh-p*Math.cos(d))+this.y0,e},i.inverse=function(e){var t,i,n,o,a,r=(e.x-this.x0)/this.k0,h=this.rh-(e.y-this.y0)/this.k0;this.ns>0?(t=Math.sqrt(r*r+h*h),i=1):(t=-Math.sqrt(r*r+h*h),i=-1);var d=0;if(0!==t&&(d=Math.atan2(i*r,i*h)),0!==t||this.ns>0){if(i=1/this.ns,n=Math.pow(t/(this.a*this.f0),i),o=p(this.e,n),-9999===o)return null}else o=-s;return a=l(d/this.ns+this.long0),e.x=a,e.y=o,e},i.names=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],50:[function(e,t,i){function n(e){return e}i.init=function(){},i.forward=n,i.inverse=n,i.names=["longlat","identity"]},{}],51:[function(e,t,i){var n=e("../common/msfnz"),o=Math.PI/2,a=1e-10,s=57.29577951308232,r=e("../common/adjust_lon"),l=Math.PI/4,p=e("../common/tsfnz"),h=e("../common/phi2z");i.init=function(){var e=this.b/this.a;this.es=1-e*e,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.k0=this.sphere?Math.cos(this.lat_ts):n(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k0=this.k?this.k:1)},i.forward=function(e){var t=e.x,i=e.y;if(i*s>90&&-90>i*s&&t*s>180&&-180>t*s)return null;var n,h;if(Math.abs(Math.abs(i)-o)<=a)return null;if(this.sphere)n=this.x0+this.a*this.k0*r(t-this.long0),h=this.y0+this.a*this.k0*Math.log(Math.tan(l+.5*i));else{var d=Math.sin(i),c=p(this.e,i,d);n=this.x0+this.a*this.k0*r(t-this.long0),h=this.y0-this.a*this.k0*Math.log(c)}return e.x=n,e.y=h,e},i.inverse=function(e){var t,i,n=e.x-this.x0,a=e.y-this.y0;if(this.sphere)i=o-2*Math.atan(Math.exp(-a/(this.a*this.k0)));else{var s=Math.exp(-a/(this.a*this.k0));if(i=h(this.e,s),-9999===i)return null}return t=r(this.long0+n/(this.a*this.k0)),e.x=t,e.y=i,e},i.names=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/tsfnz":24}],52:[function(e,t,i){var n=e("../common/adjust_lon");i.init=function(){},i.forward=function(e){var t=e.x,i=e.y,o=n(t-this.long0),a=this.x0+this.a*o,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+i/2.5))*1.25;return e.x=a,e.y=s,e},i.inverse=function(e){e.x-=this.x0,e.y-=this.y0;var t=n(this.long0+e.x/this.a),i=2.5*(Math.atan(Math.exp(.8*e.y/this.a))-Math.PI/4);return e.x=t,e.y=i,e},i.names=["Miller_Cylindrical","mill"]},{"../common/adjust_lon":5}],53:[function(e,t,i){var n=e("../common/adjust_lon"),o=1e-10;i.init=function(){},i.forward=function(e){for(var t=e.x,i=e.y,a=n(t-this.long0),s=i,r=Math.PI*Math.sin(i),l=0;!0;l++){var p=-(s+Math.sin(s)-r)/(1+Math.cos(s));if(s+=p,Math.abs(p)<o)break}s/=2,Math.PI/2-Math.abs(i)<o&&(a=0);var h=.900316316158*this.a*a*Math.cos(s)+this.x0,d=1.4142135623731*this.a*Math.sin(s)+this.y0;return e.x=h,e.y=d,e},i.inverse=function(e){var t,i;e.x-=this.x0,e.y-=this.y0,i=e.y/(1.4142135623731*this.a),Math.abs(i)>.999999999999&&(i=.999999999999),t=Math.asin(i);var o=n(this.long0+e.x/(.900316316158*this.a*Math.cos(t)));o<-Math.PI&&(o=-Math.PI),o>Math.PI&&(o=Math.PI),i=(2*t+Math.sin(2*t))/Math.PI,Math.abs(i)>1&&(i=1);var a=Math.asin(i);return e.x=o,e.y=a,e},i.names=["Mollweide","moll"]},{"../common/adjust_lon":5}],54:[function(e,t,i){var n=484813681109536e-20;i.iterations=1,i.init=function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},i.forward=function(e){var t,i=e.x,o=e.y,a=o-this.lat0,s=i-this.long0,r=a/n*1e-5,l=s,p=1,h=0;for(t=1;10>=t;t++)p*=r,h+=this.A[t]*p;var d,c,u=h,f=l,g=1,m=0,_=0,w=0;for(t=1;6>=t;t++)d=g*u-m*f,c=m*u+g*f,g=d,m=c,_=_+this.B_re[t]*g-this.B_im[t]*m,w=w+this.B_im[t]*g+this.B_re[t]*m;return e.x=w*this.a+this.x0,e.y=_*this.a+this.y0,e},i.inverse=function(e){var t,i,o,a=e.x,s=e.y,r=a-this.x0,l=s-this.y0,p=l/this.a,h=r/this.a,d=1,c=0,u=0,f=0;for(t=1;6>=t;t++)i=d*p-c*h,o=c*p+d*h,d=i,c=o,u=u+this.C_re[t]*d-this.C_im[t]*c,f=f+this.C_im[t]*d+this.C_re[t]*c;for(var g=0;g<this.iterations;g++){var m,_,w=u,b=f,v=p,y=h;for(t=2;6>=t;t++)m=w*u-b*f,_=b*u+w*f,w=m,b=_,v+=(t-1)*(this.B_re[t]*w-this.B_im[t]*b),y+=(t-1)*(this.B_im[t]*w+this.B_re[t]*b);w=1,b=0;var k=this.B_re[1],x=this.B_im[1];for(t=2;6>=t;t++)m=w*u-b*f,_=b*u+w*f,w=m,b=_,k+=t*(this.B_re[t]*w-this.B_im[t]*b),x+=t*(this.B_im[t]*w+this.B_re[t]*b);var M=k*k+x*x;u=(v*k+y*x)/M,f=(y*k-v*x)/M}var T=u,P=f,S=1,I=0;for(t=1;9>=t;t++)S*=T,I+=this.D[t]*S;var z=this.lat0+I*n*1e5,C=this.long0+P;return e.x=C,e.y=z,e},i.names=["New_Zealand_Map_Grid","nzmg"]},{}],55:[function(e,t,i){var n=e("../common/tsfnz"),o=e("../common/adjust_lon"),a=e("../common/phi2z"),s=Math.PI/2,r=Math.PI/4,l=1e-10;i.init=function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var e=Math.sin(this.lat0),t=Math.cos(this.lat0),i=this.e*e;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(t,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-i*i);var a=n(this.e,this.lat0,e),s=this.bl/t*Math.sqrt((1-this.es)/(1-i*i));1>s*s&&(s=1);var r,l;if(isNaN(this.longc)){var p=n(this.e,this.lat1,Math.sin(this.lat1)),h=n(this.e,this.lat2,Math.sin(this.lat2));this.el=this.lat0>=0?(s+Math.sqrt(s*s-1))*Math.pow(a,this.bl):(s-Math.sqrt(s*s-1))*Math.pow(a,this.bl);var d=Math.pow(p,this.bl),c=Math.pow(h,this.bl);r=this.el/d,l=.5*(r-1/r);var u=(this.el*this.el-c*d)/(this.el*this.el+c*d),f=(c-d)/(c+d),g=o(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(u*Math.tan(.5*this.bl*g)/f)/this.bl,this.long0=o(this.long0);var m=o(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*m)/l),this.alpha=Math.asin(s*Math.sin(this.gamma0))}else r=this.lat0>=0?s+Math.sqrt(s*s-1):s-Math.sqrt(s*s-1),this.el=r*Math.pow(a,this.bl),l=.5*(r-1/r),this.gamma0=Math.asin(Math.sin(this.alpha)/s),this.long0=this.longc-Math.asin(l*Math.tan(this.gamma0))/this.bl;this.uc=this.no_off?0:this.lat0>=0?this.al/this.bl*Math.atan2(Math.sqrt(s*s-1),Math.cos(this.alpha)):-1*this.al/this.bl*Math.atan2(Math.sqrt(s*s-1),Math.cos(this.alpha))},i.forward=function(e){var t,i,a,p=e.x,h=e.y,d=o(p-this.long0);if(Math.abs(Math.abs(h)-s)<=l)a=h>0?-1:1,i=this.al/this.bl*Math.log(Math.tan(r+a*this.gamma0*.5)),t=-1*a*s*this.al/this.bl;else{var c=n(this.e,h,Math.sin(h)),u=this.el/Math.pow(c,this.bl),f=.5*(u-1/u),g=.5*(u+1/u),m=Math.sin(this.bl*d),_=(f*Math.sin(this.gamma0)-m*Math.cos(this.gamma0))/g;i=Math.abs(Math.abs(_)-1)<=l?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-_)/(1+_))/this.bl,t=Math.abs(Math.cos(this.bl*d))<=l?this.al*this.bl*d:this.al*Math.atan2(f*Math.cos(this.gamma0)+m*Math.sin(this.gamma0),Math.cos(this.bl*d))/this.bl}return this.no_rot?(e.x=this.x0+t,e.y=this.y0+i):(t-=this.uc,e.x=this.x0+i*Math.cos(this.alpha)+t*Math.sin(this.alpha),e.y=this.y0+t*Math.cos(this.alpha)-i*Math.sin(this.alpha)),e},i.inverse=function(e){var t,i;this.no_rot?(i=e.y-this.y0,t=e.x-this.x0):(i=(e.x-this.x0)*Math.cos(this.alpha)-(e.y-this.y0)*Math.sin(this.alpha),t=(e.y-this.y0)*Math.cos(this.alpha)+(e.x-this.x0)*Math.sin(this.alpha),t+=this.uc);var n=Math.exp(-1*this.bl*i/this.al),r=.5*(n-1/n),p=.5*(n+1/n),h=Math.sin(this.bl*t/this.al),d=(h*Math.cos(this.gamma0)+r*Math.sin(this.gamma0))/p,c=Math.pow(this.el/Math.sqrt((1+d)/(1-d)),1/this.bl);return Math.abs(d-1)<l?(e.x=this.long0,e.y=s):Math.abs(d+1)<l?(e.x=this.long0,e.y=-1*s):(e.y=a(this.e,c),e.x=o(this.long0-Math.atan2(r*Math.cos(this.gamma0)-h*Math.sin(this.gamma0),Math.cos(this.bl*t/this.al))/this.bl)),e},i.names=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},{"../common/adjust_lon":5,"../common/phi2z":16,"../common/tsfnz":24}],56:[function(e,t,i){var n=e("../common/e0fn"),o=e("../common/e1fn"),a=e("../common/e2fn"),s=e("../common/e3fn"),r=e("../common/adjust_lon"),l=e("../common/adjust_lat"),p=e("../common/mlfn"),h=1e-10,d=e("../common/gN"),c=20;i.init=function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=n(this.es),this.e1=o(this.es),this.e2=a(this.es),this.e3=s(this.es),this.ml0=this.a*p(this.e0,this.e1,this.e2,this.e3,this.lat0)},i.forward=function(e){var t,i,n,o=e.x,a=e.y,s=r(o-this.long0);if(n=s*Math.sin(a),this.sphere)Math.abs(a)<=h?(t=this.a*s,i=-1*this.a*this.lat0):(t=this.a*Math.sin(n)/Math.tan(a),i=this.a*(l(a-this.lat0)+(1-Math.cos(n))/Math.tan(a)));else if(Math.abs(a)<=h)t=this.a*s,i=-1*this.ml0;else{var c=d(this.a,this.e,Math.sin(a))/Math.tan(a);t=c*Math.sin(n),i=this.a*p(this.e0,this.e1,this.e2,this.e3,a)-this.ml0+c*(1-Math.cos(n))}return e.x=t+this.x0,e.y=i+this.y0,e},i.inverse=function(e){var t,i,n,o,a,s,l,d,u;if(n=e.x-this.x0,o=e.y-this.y0,this.sphere)if(Math.abs(o+this.a*this.lat0)<=h)t=r(n/this.a+this.long0),i=0;else{s=this.lat0+o/this.a,l=n*n/this.a/this.a+s*s,d=s;var f;for(a=c;a;--a)if(f=Math.tan(d),u=-1*(s*(d*f+1)-d-.5*(d*d+l)*f)/((d-s)/f-1),d+=u,Math.abs(u)<=h){i=d;break}t=r(this.long0+Math.asin(n*Math.tan(d)/this.a)/Math.sin(i))}else if(Math.abs(o+this.ml0)<=h)i=0,t=r(this.long0+n/this.a);else{s=(this.ml0+o)/this.a,l=n*n/this.a/this.a+s*s,d=s;var g,m,_,w,b;for(a=c;a;--a)if(b=this.e*Math.sin(d),g=Math.sqrt(1-b*b)*Math.tan(d),m=this.a*p(this.e0,this.e1,this.e2,this.e3,d),_=this.e0-2*this.e1*Math.cos(2*d)+4*this.e2*Math.cos(4*d)-6*this.e3*Math.cos(6*d),w=m/this.a,u=(s*(g*w+1)-w-.5*g*(w*w+l))/(this.es*Math.sin(2*d)*(w*w+l-2*s*w)/(4*g)+(s-w)*(g*_-2/Math.sin(2*d))-_),d-=u,Math.abs(u)<=h){i=d;break}g=Math.sqrt(1-this.es*Math.pow(Math.sin(i),2))*Math.tan(i),t=r(this.long0+Math.asin(n*g/this.a)/Math.sin(i))}return e.x=t,e.y=i,e},i.names=["Polyconic","poly"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/mlfn":14}],57:[function(e,t,i){var n=e("../common/adjust_lon"),o=e("../common/adjust_lat"),a=e("../common/pj_enfn"),s=20,r=e("../common/pj_mlfn"),l=e("../common/pj_inv_mlfn"),p=Math.PI/2,h=1e-10,d=e("../common/asinz");i.init=function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=a(this.es)},i.forward=function(e){var t,i,o=e.x,a=e.y;if(o=n(o-this.long0),this.sphere){if(this.m)for(var l=this.n*Math.sin(a),p=s;p;--p){var d=(this.m*a+Math.sin(a)-l)/(this.m+Math.cos(a));if(a-=d,Math.abs(d)<h)break}else a=1!==this.n?Math.asin(this.n*Math.sin(a)):a;t=this.a*this.C_x*o*(this.m+Math.cos(a)),i=this.a*this.C_y*a}else{var c=Math.sin(a),u=Math.cos(a);i=this.a*r(a,c,u,this.en),t=this.a*o*u/Math.sqrt(1-this.es*c*c)}return e.x=t,e.y=i,e},i.inverse=function(e){var t,i,a,s;return e.x-=this.x0,a=e.x/this.a,e.y-=this.y0,t=e.y/this.a,this.sphere?(t/=this.C_y,a/=this.C_x*(this.m+Math.cos(t)),this.m?t=d((this.m*t+Math.sin(t))/this.n):1!==this.n&&(t=d(Math.sin(t)/this.n)),a=n(a+this.long0),t=o(t)):(t=l(e.y/this.a,this.es,this.en),s=Math.abs(t),p>s?(s=Math.sin(t),i=this.long0+e.x*Math.sqrt(1-this.es*s*s)/(this.a*Math.cos(t)),a=n(i)):p>s-h&&(a=this.long0)),e.x=a,e.y=t,e},i.names=["Sinusoidal","sinu"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/asinz":6,"../common/pj_enfn":17,"../common/pj_inv_mlfn":18,"../common/pj_mlfn":19}],58:[function(e,t,i){i.init=function(){var e=this.lat0;this.lambda0=this.long0;var t=Math.sin(e),i=this.a,n=this.rf,o=1/n,a=2*o-Math.pow(o,2),s=this.e=Math.sqrt(a);this.R=this.k0*i*Math.sqrt(1-a)/(1-a*Math.pow(t,2)),this.alpha=Math.sqrt(1+a/(1-a)*Math.pow(Math.cos(e),4)),this.b0=Math.asin(t/this.alpha);var r=Math.log(Math.tan(Math.PI/4+this.b0/2)),l=Math.log(Math.tan(Math.PI/4+e/2)),p=Math.log((1+s*t)/(1-s*t));this.K=r-this.alpha*l+this.alpha*s/2*p},i.forward=function(e){var t=Math.log(Math.tan(Math.PI/4-e.y/2)),i=this.e/2*Math.log((1+this.e*Math.sin(e.y))/(1-this.e*Math.sin(e.y))),n=-this.alpha*(t+i)+this.K,o=2*(Math.atan(Math.exp(n))-Math.PI/4),a=this.alpha*(e.x-this.lambda0),s=Math.atan(Math.sin(a)/(Math.sin(this.b0)*Math.tan(o)+Math.cos(this.b0)*Math.cos(a))),r=Math.asin(Math.cos(this.b0)*Math.sin(o)-Math.sin(this.b0)*Math.cos(o)*Math.cos(a));return e.y=this.R/2*Math.log((1+Math.sin(r))/(1-Math.sin(r)))+this.y0,e.x=this.R*s+this.x0,e},i.inverse=function(e){for(var t=e.x-this.x0,i=e.y-this.y0,n=t/this.R,o=2*(Math.atan(Math.exp(i/this.R))-Math.PI/4),a=Math.asin(Math.cos(this.b0)*Math.sin(o)+Math.sin(this.b0)*Math.cos(o)*Math.cos(n)),s=Math.atan(Math.sin(n)/(Math.cos(this.b0)*Math.cos(n)-Math.sin(this.b0)*Math.tan(o))),r=this.lambda0+s/this.alpha,l=0,p=a,h=-1e3,d=0;Math.abs(p-h)>1e-7;){if(++d>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+a/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(p))/2)),h=p,p=2*Math.atan(Math.exp(l))-Math.PI/2}return e.x=r,e.y=p,e},i.names=["somerc"]},{}],59:[function(e,t,i){var n=Math.PI/2,o=1e-10,a=e("../common/sign"),s=e("../common/msfnz"),r=e("../common/tsfnz"),l=e("../common/phi2z"),p=e("../common/adjust_lon");i.ssfn_=function(e,t,i){return t*=i,Math.tan(.5*(n+e))*Math.pow((1-t)/(1+t),.5*i)},i.init=function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=o&&(this.k0=.5*(1+a(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=o&&(this.con=this.lat0>0?1:-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=o&&(this.k0=.5*this.cons*s(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/r(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=s(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-n,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},i.forward=function(e){var t,i,a,s,l,h,d=e.x,c=e.y,u=Math.sin(c),f=Math.cos(c),g=p(d-this.long0);return Math.abs(Math.abs(d-this.long0)-Math.PI)<=o&&Math.abs(c+this.lat0)<=o?(e.x=0/0,e.y=0/0,e):this.sphere?(t=2*this.k0/(1+this.sinlat0*u+this.coslat0*f*Math.cos(g)),e.x=this.a*t*f*Math.sin(g)+this.x0,e.y=this.a*t*(this.coslat0*u-this.sinlat0*f*Math.cos(g))+this.y0,e):(i=2*Math.atan(this.ssfn_(c,u,this.e))-n,s=Math.cos(i),a=Math.sin(i),Math.abs(this.coslat0)<=o?(l=r(this.e,c*this.con,this.con*u),h=2*this.a*this.k0*l/this.cons,e.x=this.x0+h*Math.sin(d-this.long0),e.y=this.y0-this.con*h*Math.cos(d-this.long0),e):(Math.abs(this.sinlat0)<o?(t=2*this.a*this.k0/(1+s*Math.cos(g)),e.y=t*a):(t=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*a+this.cosX0*s*Math.cos(g))),e.y=t*(this.cosX0*a-this.sinX0*s*Math.cos(g))+this.y0),e.x=t*s*Math.sin(g)+this.x0,e))},i.inverse=function(e){e.x-=this.x0,e.y-=this.y0;var t,i,a,s,r,h=Math.sqrt(e.x*e.x+e.y*e.y);if(this.sphere){var d=2*Math.atan(h/(.5*this.a*this.k0));return t=this.long0,i=this.lat0,o>=h?(e.x=t,e.y=i,e):(i=Math.asin(Math.cos(d)*this.sinlat0+e.y*Math.sin(d)*this.coslat0/h),t=p(Math.abs(this.coslat0)<o?this.lat0>0?this.long0+Math.atan2(e.x,-1*e.y):this.long0+Math.atan2(e.x,e.y):this.long0+Math.atan2(e.x*Math.sin(d),h*this.coslat0*Math.cos(d)-e.y*this.sinlat0*Math.sin(d))),e.x=t,e.y=i,e)}if(Math.abs(this.coslat0)<=o){if(o>=h)return i=this.lat0,t=this.long0,e.x=t,e.y=i,e;e.x*=this.con,e.y*=this.con,a=h*this.cons/(2*this.a*this.k0),i=this.con*l(this.e,a),t=this.con*p(this.con*this.long0+Math.atan2(e.x,-1*e.y))}else s=2*Math.atan(h*this.cosX0/(2*this.a*this.k0*this.ms1)),t=this.long0,o>=h?r=this.X0:(r=Math.asin(Math.cos(s)*this.sinX0+e.y*Math.sin(s)*this.cosX0/h),t=p(this.long0+Math.atan2(e.x*Math.sin(s),h*this.cosX0*Math.cos(s)-e.y*this.sinX0*Math.sin(s)))),i=-1*l(this.e,Math.tan(.5*(n+r)));return e.x=t,e.y=i,e},i.names=["stere"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],60:[function(e,t,i){var n=e("./gauss"),o=e("../common/adjust_lon");i.init=function(){n.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},i.forward=function(e){var t,i,a,s;return e.x=o(e.x-this.long0),n.forward.apply(this,[e]),t=Math.sin(e.y),i=Math.cos(e.y),a=Math.cos(e.x),s=this.k0*this.R2/(1+this.sinc0*t+this.cosc0*i*a),e.x=s*i*Math.sin(e.x),e.y=s*(this.cosc0*t-this.sinc0*i*a),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e},i.inverse=function(e){var t,i,a,s,r;if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,r=Math.sqrt(e.x*e.x+e.y*e.y)){var l=2*Math.atan2(r,this.R2);t=Math.sin(l),i=Math.cos(l),s=Math.asin(i*this.sinc0+e.y*t*this.cosc0/r),a=Math.atan2(e.x*t,r*this.cosc0*i-e.y*this.sinc0*t)}else s=this.phic0,a=0;return e.x=a,e.y=s,n.inverse.apply(this,[e]),e.x=o(e.x+this.long0),e},i.names=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative"]},{"../common/adjust_lon":5,"./gauss":45}],61:[function(e,t,i){var n=e("../common/e0fn"),o=e("../common/e1fn"),a=e("../common/e2fn"),s=e("../common/e3fn"),r=e("../common/mlfn"),l=e("../common/adjust_lon"),p=Math.PI/2,h=1e-10,d=e("../common/sign"),c=e("../common/asinz");i.init=function(){this.e0=n(this.es),this.e1=o(this.es),this.e2=a(this.es),this.e3=s(this.es),this.ml0=this.a*r(this.e0,this.e1,this.e2,this.e3,this.lat0)},i.forward=function(e){var t,i,n,o=e.x,a=e.y,s=l(o-this.long0),p=Math.sin(a),h=Math.cos(a);if(this.sphere){var d=h*Math.sin(s);if(Math.abs(Math.abs(d)-1)<1e-10)return 93;i=.5*this.a*this.k0*Math.log((1+d)/(1-d)),t=Math.acos(h*Math.cos(s)/Math.sqrt(1-d*d)),0>a&&(t=-t),n=this.a*this.k0*(t-this.lat0)}else{var c=h*s,u=Math.pow(c,2),f=this.ep2*Math.pow(h,2),g=Math.tan(a),m=Math.pow(g,2);t=1-this.es*Math.pow(p,2);var _=this.a/Math.sqrt(t),w=this.a*r(this.e0,this.e1,this.e2,this.e3,a);i=this.k0*_*c*(1+u/6*(1-m+f+u/20*(5-18*m+Math.pow(m,2)+72*f-58*this.ep2)))+this.x0,n=this.k0*(w-this.ml0+_*g*u*(.5+u/24*(5-m+9*f+4*Math.pow(f,2)+u/30*(61-58*m+Math.pow(m,2)+600*f-330*this.ep2))))+this.y0}return e.x=i,e.y=n,e},i.inverse=function(e){var t,i,n,o,a,s,r=6;if(this.sphere){var u=Math.exp(e.x/(this.a*this.k0)),f=.5*(u-1/u),g=this.lat0+e.y/(this.a*this.k0),m=Math.cos(g);t=Math.sqrt((1-m*m)/(1+f*f)),a=c(t),0>g&&(a=-a),s=0===f&&0===m?this.long0:l(Math.atan2(f,m)+this.long0)}else{var _=e.x-this.x0,w=e.y-this.y0;for(t=(this.ml0+w/this.k0)/this.a,i=t,o=0;n=(t+this.e1*Math.sin(2*i)-this.e2*Math.sin(4*i)+this.e3*Math.sin(6*i))/this.e0-i,i+=n,!(Math.abs(n)<=h);o++)if(o>=r)return 95;if(Math.abs(i)<p){var b=Math.sin(i),v=Math.cos(i),y=Math.tan(i),k=this.ep2*Math.pow(v,2),x=Math.pow(k,2),M=Math.pow(y,2),T=Math.pow(M,2);t=1-this.es*Math.pow(b,2);var P=this.a/Math.sqrt(t),S=P*(1-this.es)/t,I=_/(P*this.k0),z=Math.pow(I,2);a=i-P*y*z/S*(.5-z/24*(5+3*M+10*k-4*x-9*this.ep2-z/30*(61+90*M+298*k+45*T-252*this.ep2-3*x))),s=l(this.long0+I*(1-z/6*(1+2*M+k-z/20*(5-2*k+28*M-3*x+8*this.ep2+24*T)))/v)}else a=p*d(w),s=this.long0}return e.x=s,e.y=a,e},i.names=["Transverse_Mercator","Transverse Mercator","tmerc"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/mlfn":14,"../common/sign":21}],62:[function(e,t,i){var n=.017453292519943295,o=e("./tmerc");i.dependsOn="tmerc",i.init=function(){this.zone&&(this.lat0=0,this.long0=(6*Math.abs(this.zone)-183)*n,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,o.init.apply(this),this.forward=o.forward,this.inverse=o.inverse)},i.names=["Universal Transverse Mercator System","utm"]},{"./tmerc":61}],63:[function(e,t,i){var n=e("../common/adjust_lon"),o=Math.PI/2,a=1e-10,s=e("../common/asinz");i.init=function(){this.R=this.a},i.forward=function(e){var t,i,r=e.x,l=e.y,p=n(r-this.long0);Math.abs(l)<=a&&(t=this.x0+this.R*p,i=this.y0);var h=s(2*Math.abs(l/Math.PI));(Math.abs(p)<=a||Math.abs(Math.abs(l)-o)<=a)&&(t=this.x0,i=l>=0?this.y0+Math.PI*this.R*Math.tan(.5*h):this.y0+Math.PI*this.R*-Math.tan(.5*h));var d=.5*Math.abs(Math.PI/p-p/Math.PI),c=d*d,u=Math.sin(h),f=Math.cos(h),g=f/(u+f-1),m=g*g,_=g*(2/u-1),w=_*_,b=Math.PI*this.R*(d*(g-w)+Math.sqrt(c*(g-w)*(g-w)-(w+c)*(m-w)))/(w+c);0>p&&(b=-b),t=this.x0+b;var v=c+g;return b=Math.PI*this.R*(_*v-d*Math.sqrt((w+c)*(c+1)-v*v))/(w+c),i=l>=0?this.y0+b:this.y0-b,e.x=t,e.y=i,e},i.inverse=function(e){var t,i,o,s,r,l,p,h,d,c,u,f,g;return e.x-=this.x0,e.y-=this.y0,u=Math.PI*this.R,o=e.x/u,s=e.y/u,r=o*o+s*s,l=-Math.abs(s)*(1+r),p=l-2*s*s+o*o,h=-2*l+1+2*s*s+r*r,g=s*s/h+(2*p*p*p/h/h/h-9*l*p/h/h)/27,d=(l-p*p/3/h)/h,c=2*Math.sqrt(-d/3),u=3*g/d/c,Math.abs(u)>1&&(u=u>=0?1:-1),f=Math.acos(u)/3,i=e.y>=0?(-c*Math.cos(f+Math.PI/3)-p/3/h)*Math.PI:-(-c*Math.cos(f+Math.PI/3)-p/3/h)*Math.PI,t=Math.abs(o)<a?this.long0:n(this.long0+Math.PI*(r-1+Math.sqrt(1+2*(o*o-s*s)+r*r))/2/o),e.x=t,e.y=i,e},i.names=["Van_der_Grinten_I","VanDerGrinten","vandg"]},{"../common/adjust_lon":5,"../common/asinz":6}],64:[function(e,t){var i=.017453292519943295,n=57.29577951308232,o=1,a=2,s=e("./datum_transform"),r=e("./adjust_axis"),l=e("./Proj"),p=e("./common/toPoint");t.exports=function h(e,t,d){function c(e,t){return(e.datum.datum_type===o||e.datum.datum_type===a)&&"WGS84"!==t.datumCode}var u;return Array.isArray(d)&&(d=p(d)),e.datum&&t.datum&&(c(e,t)||c(t,e))&&(u=new l("WGS84"),h(e,u,d),e=u),"enu"!==e.axis&&r(e,!1,d),"longlat"===e.projName?(d.x*=i,d.y*=i):(e.to_meter&&(d.x*=e.to_meter,d.y*=e.to_meter),e.inverse(d)),e.from_greenwich&&(d.x+=e.from_greenwich),d=s(e.datum,t.datum,d),t.from_greenwich&&(d.x-=t.from_greenwich),"longlat"===t.projName?(d.x*=n,d.y*=n):(t.forward(d),t.to_meter&&(d.x/=t.to_meter,d.y/=t.to_meter)),"enu"!==t.axis&&r(t,!0,d),d}},{"./Proj":2,"./adjust_axis":3,"./common/toPoint":23,"./datum_transform":30}],65:[function(e,t){function i(e,t,i){e[t]=i.map(function(e){var t={};return n(e,t),t}).reduce(function(e,t){return l(e,t)},{})}function n(e,t){var o;return Array.isArray(e)?(o=e.shift(),"PARAMETER"===o&&(o=e.shift()),void(1===e.length?Array.isArray(e[0])?(t[o]={},n(e[0],t[o])):t[o]=e[0]:e.length?"TOWGS84"===o?t[o]=e:(t[o]={},["UNIT","PRIMEM","VERT_DATUM"].indexOf(o)>-1?(t[o]={name:e[0].toLowerCase(),convert:e[1]},3===e.length&&(t[o].auth=e[2])):"SPHEROID"===o?(t[o]={name:e[0],a:e[1],rf:e[2]},4===e.length&&(t[o].auth=e[3])):["GEOGCS","GEOCCS","DATUM","VERT_CS","COMPD_CS","LOCAL_CS","FITTED_CS","LOCAL_DATUM"].indexOf(o)>-1?(e[0]=["name",e[0]],i(t,o,e)):e.every(function(e){return Array.isArray(e)})?i(t,o,e):n(e,t[o])):t[o]=!0)):void(t[e]=!0)}function o(e,t){var i=t[0],n=t[1];!(i in e)&&n in e&&(e[i]=e[n],3===t.length&&(e[i]=t[2](e[i])))}function a(e){return e*r}function s(e){function t(t){var i=e.to_meter||1;return parseFloat(t,10)*i}"GEOGCS"===e.type?e.projName="longlat":"LOCAL_CS"===e.type?(e.projName="identity",e.local=!0):e.projName="object"==typeof e.PROJECTION?Object.keys(e.PROJECTION)[0]:e.PROJECTION,e.UNIT&&(e.units=e.UNIT.name.toLowerCase(),"metre"===e.units&&(e.units="meter"),e.UNIT.convert&&(e.to_meter=parseFloat(e.UNIT.convert,10))),e.GEOGCS&&(e.datumCode=e.GEOGCS.DATUM?e.GEOGCS.DATUM.name.toLowerCase():e.GEOGCS.name.toLowerCase(),"d_"===e.datumCode.slice(0,2)&&(e.datumCode=e.datumCode.slice(2)),("new_zealand_geodetic_datum_1949"===e.datumCode||"new_zealand_1949"===e.datumCode)&&(e.datumCode="nzgd49"),"wgs_1984"===e.datumCode&&("Mercator_Auxiliary_Sphere"===e.PROJECTION&&(e.sphere=!0),e.datumCode="wgs84"),"_ferro"===e.datumCode.slice(-6)&&(e.datumCode=e.datumCode.slice(0,-6)),"_jakarta"===e.datumCode.slice(-8)&&(e.datumCode=e.datumCode.slice(0,-8)),~e.datumCode.indexOf("belge")&&(e.datumCode="rnb72"),e.GEOGCS.DATUM&&e.GEOGCS.DATUM.SPHEROID&&(e.ellps=e.GEOGCS.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===e.ellps.toLowerCase().slice(0,13)&&(e.ellps="intl"),e.a=e.GEOGCS.DATUM.SPHEROID.a,e.rf=parseFloat(e.GEOGCS.DATUM.SPHEROID.rf,10))),e.b&&!isFinite(e.b)&&(e.b=e.a);var i=function(t){return o(e,t)},n=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",a],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",a],["x0","false_easting",t],["y0","false_northing",t],["long0","central_meridian",a],["lat0","latitude_of_origin",a],["lat0","standard_parallel_1",a],["lat1","standard_parallel_1",a],["lat2","standard_parallel_2",a],["alpha","azimuth",a],["srsCode","name"]];n.forEach(i),e.long0||!e.longc||"Albers_Conic_Equal_Area"!==e.PROJECTION&&"Lambert_Azimuthal_Equal_Area"!==e.PROJECTION||(e.long0=e.longc)}var r=.017453292519943295,l=e("./extend");t.exports=function(e,t){var i=JSON.parse((","+e).replace(/\s*\,\s*([A-Z_0-9]+?)(\[)/g,',["$1",').slice(1).replace(/\s*\,\s*([A-Z_0-9]+?)\]/g,',"$1"]')),o=i.shift(),a=i.shift();i.unshift(["name",a]),i.unshift(["type",o]),i.unshift("output");var r={};return n(i,r),s(r.output),l(t,r.output)}},{"./extend":33}],66:[function(e,t,i){function n(e){return e*(Math.PI/180)}function o(e){return 180*(e/Math.PI)}function a(e){var t,i,o,a,s,l,p,h,d,c=e.lat,u=e.lon,f=6378137,g=.00669438,m=.9996,_=n(c),w=n(u);d=Math.floor((u+180)/6)+1,180===u&&(d=60),c>=56&&64>c&&u>=3&&12>u&&(d=32),c>=72&&84>c&&(u>=0&&9>u?d=31:u>=9&&21>u?d=33:u>=21&&33>u?d=35:u>=33&&42>u&&(d=37)),t=6*(d-1)-180+3,h=n(t),i=g/(1-g),o=f/Math.sqrt(1-g*Math.sin(_)*Math.sin(_)),a=Math.tan(_)*Math.tan(_),s=i*Math.cos(_)*Math.cos(_),l=Math.cos(_)*(w-h),p=f*((1-g/4-3*g*g/64-5*g*g*g/256)*_-(3*g/8+3*g*g/32+45*g*g*g/1024)*Math.sin(2*_)+(15*g*g/256+45*g*g*g/1024)*Math.sin(4*_)-35*g*g*g/3072*Math.sin(6*_));var b=m*o*(l+(1-a+s)*l*l*l/6+(5-18*a+a*a+72*s-58*i)*l*l*l*l*l/120)+5e5,v=m*(p+o*Math.tan(_)*(l*l/2+(5-a+9*s+4*s*s)*l*l*l*l/24+(61-58*a+a*a+600*s-330*i)*l*l*l*l*l*l/720));return 0>c&&(v+=1e7),{northing:Math.round(v),easting:Math.round(b),zoneNumber:d,zoneLetter:r(c)}
}function s(e){var t=e.northing,i=e.easting,n=e.zoneLetter,a=e.zoneNumber;if(0>a||a>60)return null;var r,l,p,h,d,c,u,f,g,m,_=.9996,w=6378137,b=.00669438,v=(1-Math.sqrt(1-b))/(1+Math.sqrt(1-b)),y=i-5e5,k=t;"N">n&&(k-=1e7),f=6*(a-1)-180+3,r=b/(1-b),u=k/_,g=u/(w*(1-b/4-3*b*b/64-5*b*b*b/256)),m=g+(3*v/2-27*v*v*v/32)*Math.sin(2*g)+(21*v*v/16-55*v*v*v*v/32)*Math.sin(4*g)+151*v*v*v/96*Math.sin(6*g),l=w/Math.sqrt(1-b*Math.sin(m)*Math.sin(m)),p=Math.tan(m)*Math.tan(m),h=r*Math.cos(m)*Math.cos(m),d=w*(1-b)/Math.pow(1-b*Math.sin(m)*Math.sin(m),1.5),c=y/(l*_);var x=m-l*Math.tan(m)/d*(c*c/2-(5+3*p+10*h-4*h*h-9*r)*c*c*c*c/24+(61+90*p+298*h+45*p*p-252*r-3*h*h)*c*c*c*c*c*c/720);x=o(x);var M=(c-(1+2*p+h)*c*c*c/6+(5-2*h+28*p-3*h*h+8*r+24*p*p)*c*c*c*c*c/120)/Math.cos(m);M=f+o(M);var T;if(e.accuracy){var P=s({northing:e.northing+e.accuracy,easting:e.easting+e.accuracy,zoneLetter:e.zoneLetter,zoneNumber:e.zoneNumber});T={top:P.lat,right:P.lon,bottom:x,left:M}}else T={lat:x,lon:M};return T}function r(e){var t="Z";return 84>=e&&e>=72?t="X":72>e&&e>=64?t="W":64>e&&e>=56?t="V":56>e&&e>=48?t="U":48>e&&e>=40?t="T":40>e&&e>=32?t="S":32>e&&e>=24?t="R":24>e&&e>=16?t="Q":16>e&&e>=8?t="P":8>e&&e>=0?t="N":0>e&&e>=-8?t="M":-8>e&&e>=-16?t="L":-16>e&&e>=-24?t="K":-24>e&&e>=-32?t="J":-32>e&&e>=-40?t="H":-40>e&&e>=-48?t="G":-48>e&&e>=-56?t="F":-56>e&&e>=-64?t="E":-64>e&&e>=-72?t="D":-72>e&&e>=-80&&(t="C"),t}function l(e,t){var i=""+e.easting,n=""+e.northing;return e.zoneNumber+e.zoneLetter+p(e.easting,e.northing,e.zoneNumber)+i.substr(i.length-5,t)+n.substr(n.length-5,t)}function p(e,t,i){var n=h(i),o=Math.floor(e/1e5),a=Math.floor(t/1e5)%20;return d(o,a,n)}function h(e){var t=e%m;return 0===t&&(t=m),t}function d(e,t,i){var n=i-1,o=_.charCodeAt(n),a=w.charCodeAt(n),s=o+e-1,r=a+t,l=!1;s>x&&(s=s-x+b-1,l=!0),(s===v||v>o&&s>v||(s>v||v>o)&&l)&&s++,(s===y||y>o&&s>y||(s>y||y>o)&&l)&&(s++,s===v&&s++),s>x&&(s=s-x+b-1),r>k?(r=r-k+b-1,l=!0):l=!1,(r===v||v>a&&r>v||(r>v||v>a)&&l)&&r++,(r===y||y>a&&r>y||(r>y||y>a)&&l)&&(r++,r===v&&r++),r>k&&(r=r-k+b-1);var p=String.fromCharCode(s)+String.fromCharCode(r);return p}function c(e){if(e&&0===e.length)throw"MGRSPoint coverting from nothing";for(var t,i=e.length,n=null,o="",a=0;!/[A-Z]/.test(t=e.charAt(a));){if(a>=2)throw"MGRSPoint bad conversion from: "+e;o+=t,a++}var s=parseInt(o,10);if(0===a||a+3>i)throw"MGRSPoint bad conversion from: "+e;var r=e.charAt(a++);if("A">=r||"B"===r||"Y"===r||r>="Z"||"I"===r||"O"===r)throw"MGRSPoint zone letter "+r+" not handled: "+e;n=e.substring(a,a+=2);for(var l=h(s),p=u(n.charAt(0),l),d=f(n.charAt(1),l);d<g(r);)d+=2e6;var c=i-a;if(c%2!==0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+e;var m,_,w,b,v,y=c/2,k=0,x=0;return y>0&&(m=1e5/Math.pow(10,y),_=e.substring(a,a+y),k=parseFloat(_)*m,w=e.substring(a+y),x=parseFloat(w)*m),b=k+p,v=x+d,{easting:b,northing:v,zoneLetter:r,zoneNumber:s,accuracy:m}}function u(e,t){for(var i=_.charCodeAt(t-1),n=1e5,o=!1;i!==e.charCodeAt(0);){if(i++,i===v&&i++,i===y&&i++,i>x){if(o)throw"Bad character: "+e;i=b,o=!0}n+=1e5}return n}function f(e,t){if(e>"V")throw"MGRSPoint given invalid Northing "+e;for(var i=w.charCodeAt(t-1),n=0,o=!1;i!==e.charCodeAt(0);){if(i++,i===v&&i++,i===y&&i++,i>k){if(o)throw"Bad character: "+e;i=b,o=!0}n+=1e5}return n}function g(e){var t;switch(e){case"C":t=11e5;break;case"D":t=2e6;break;case"E":t=28e5;break;case"F":t=37e5;break;case"G":t=46e5;break;case"H":t=55e5;break;case"J":t=64e5;break;case"K":t=73e5;break;case"L":t=82e5;break;case"M":t=91e5;break;case"N":t=0;break;case"P":t=8e5;break;case"Q":t=17e5;break;case"R":t=26e5;break;case"S":t=35e5;break;case"T":t=44e5;break;case"U":t=53e5;break;case"V":t=62e5;break;case"W":t=7e6;break;case"X":t=79e5;break;default:t=-1}if(t>=0)return t;throw"Invalid zone letter: "+e}var m=6,_="AJSAJS",w="AFAFAF",b=65,v=73,y=79,k=86,x=90;i.forward=function(e,t){return t=t||5,l(a({lat:e[1],lon:e[0]}),t)},i.inverse=function(e){var t=s(c(e.toUpperCase()));return[t.left,t.bottom,t.right,t.top]},i.toPoint=function(e){var t=i.inverse(e);return[(t[2]+t[0])/2,(t[3]+t[1])/2]}},{}],67:[function(e,t){t.exports={name:"proj4",version:"2.1.4",description:"Proj4js is a JavaScript library to transform point coordinates from one coordinate system to another, including datum transformations.",main:"lib/index.js",directories:{test:"test",doc:"docs"},scripts:{test:"./node_modules/istanbul/lib/cli.js test ./node_modules/mocha/bin/_mocha test/test.js"},repository:{type:"git",url:"git://github.com/proj4js/proj4js.git"},author:"",license:"MIT",jam:{main:"dist/proj4.js",include:["dist/proj4.js","README.md","AUTHORS","LICENSE.md"]},devDependencies:{"grunt-cli":"~0.1.13",grunt:"~0.4.2","grunt-contrib-connect":"~0.6.0","grunt-contrib-jshint":"~0.8.0",chai:"~1.8.1",mocha:"~1.17.1","grunt-mocha-phantomjs":"~0.4.0",browserify:"~3.24.5","grunt-browserify":"~1.3.0","grunt-contrib-uglify":"~0.3.2",curl:"git://github.com/cujojs/curl.git",istanbul:"~0.2.4",tin:"~0.4.0"},dependencies:{mgrs:"0.0.0"}}},{}],"./includedProjections":[function(e,t){t.exports=e("gWUPNW")},{}],gWUPNW:[function(e,t){var i=[e("./lib/projections/tmerc"),e("./lib/projections/utm"),e("./lib/projections/sterea"),e("./lib/projections/stere"),e("./lib/projections/somerc"),e("./lib/projections/omerc"),e("./lib/projections/lcc"),e("./lib/projections/krovak"),e("./lib/projections/cass"),e("./lib/projections/laea"),e("./lib/projections/aea"),e("./lib/projections/gnom"),e("./lib/projections/cea"),e("./lib/projections/eqc"),e("./lib/projections/poly"),e("./lib/projections/nzmg"),e("./lib/projections/mill"),e("./lib/projections/sinu"),e("./lib/projections/moll"),e("./lib/projections/eqdc"),e("./lib/projections/vandg"),e("./lib/projections/aeqd")];t.exports=function(e){i.forEach(function(t){e.Proj.projections.add(t)})}},{"./lib/projections/aea":39,"./lib/projections/aeqd":40,"./lib/projections/cass":41,"./lib/projections/cea":42,"./lib/projections/eqc":43,"./lib/projections/eqdc":44,"./lib/projections/gnom":46,"./lib/projections/krovak":47,"./lib/projections/laea":48,"./lib/projections/lcc":49,"./lib/projections/mill":52,"./lib/projections/moll":53,"./lib/projections/nzmg":54,"./lib/projections/omerc":55,"./lib/projections/poly":56,"./lib/projections/sinu":57,"./lib/projections/somerc":58,"./lib/projections/stere":59,"./lib/projections/sterea":60,"./lib/projections/tmerc":61,"./lib/projections/utm":62,"./lib/projections/vandg":63}]},{},[35])(35)}),function(e,t){var i=/[<>&\r\n"']/gm,n={"<":"lt;",">":"gt;","&":"amp;","\r":"#13;","\n":"#10;",'"':"quot;","'":"#39;"};e.extend({fileDownload:function(o,a){function s(){if(-1!=document.cookie.indexOf(u.cookieName+"="+u.cookieValue)){w.onSuccess(o);var t=u.cookieName+"=; path="+u.cookiePath+"; expires="+new Date(0).toUTCString()+";";return u.cookieDomain&&(t+=" domain="+u.cookieDomain+";"),document.cookie=t,void l(!1)}if(v||b)try{var i=v?v.document:r(b);if(i&&null!=i.body&&i.body.innerHTML.length){var n=!0;if(k&&k.length){var a=e(i.body).contents().first();try{a.length&&a[0]===k[0]&&(n=!1)}catch(p){if(!p||-2146828218!=p.number)throw p;n=!0}}if(n)return void setTimeout(function(){w.onFail(i.body.innerHTML,o),l(!0)},100)}}catch(h){return w.onFail("",o),void l(!0)}setTimeout(s,u.checkInterval)}function r(e){var t=e[0].contentWindow||e[0].contentDocument;return t.document&&(t=t.document),t}function l(e){setTimeout(function(){v&&(d&&v.close(),h&&v.focus&&(v.focus(),e&&v.close()))},0)}function p(e){return e.replace(i,function(e){return"&"+n[e]})}var h,d,c,u=e.extend({preparingMessageHtml:null,failMessageHtml:null,androidPostUnsupportedMessageHtml:"Unfortunately your Android browser doesn't support this type of file download. Please try again with a different browser.",dialogOptions:{modal:!0},prepareCallback:function(){},successCallback:function(){},failCallback:function(){},httpMethod:"GET",data:null,checkInterval:100,cookieName:"fileDownload",cookieValue:"true",cookiePath:"/",cookieDomain:null,popupWindowTitle:"Initiating file download...",encodeHTMLEntities:!0},a),f=new e.Deferred,g=(navigator.userAgent||navigator.vendor||t.opera).toLowerCase();/ip(ad|hone|od)/.test(g)?h=!0:-1!==g.indexOf("android")?d=!0:c=/avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|playbook|silk|iemobile|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(g)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(g.substr(0,4));var m=u.httpMethod.toUpperCase();if(d&&"GET"!==m)return e().dialog?e("<div>").html(u.androidPostUnsupportedMessageHtml).dialog(u.dialogOptions):alert(u.androidPostUnsupportedMessageHtml),f.reject();var _=null,w={onPrepare:function(t){u.preparingMessageHtml?_=e("<div>").html(u.preparingMessageHtml).dialog(u.dialogOptions):u.prepareCallback&&u.prepareCallback(t)},onSuccess:function(e){_&&_.dialog("close"),u.successCallback(e),f.resolve(e)},onFail:function(t,i){_&&_.dialog("close"),u.failMessageHtml&&e("<div>").html(u.failMessageHtml).dialog(u.dialogOptions),u.failCallback(t,i),f.reject(t,i)}};w.onPrepare(o),null!==u.data&&"string"!=typeof u.data&&(u.data=e.param(u.data));var b,v,y,k;if("GET"===m){if(null!==u.data){var x=o.indexOf("?");-1!==x?"&"!==o.substring(o.length-1)&&(o+="&"):o+="?",o+=u.data}h||d?(v=t.open(o),v.document.title=u.popupWindowTitle,t.focus()):c?t.location(o):b=e("<iframe>").hide().prop("src",o).appendTo("body")}else{var M="";null!==u.data&&e.each(u.data.replace(/\+/g," ").split("&"),function(){var e=this.split("="),t=u.encodeHTMLEntities?p(decodeURIComponent(e[0])):decodeURIComponent(e[0]);if(t){var i=u.encodeHTMLEntities?p(decodeURIComponent(e[1])):decodeURIComponent(e[1]);M+='<input type="hidden" name="'+t+'" value="'+i+'" />'}}),c?(k=e("<form>").appendTo("body"),k.hide().prop("method",u.httpMethod).prop("action",o).html(M)):(h?(v=t.open("about:blank"),v.document.title=u.popupWindowTitle,y=v.document,t.focus()):(b=e("<iframe style='display: none' src='about:blank'></iframe>").appendTo("body"),y=r(b)),y.write("<html><head></head><body><form method='"+u.httpMethod+"' action='"+o+"'>"+M+"</form>"+u.popupWindowTitle+"</body></html>"),k=e(y).find("form")),k.submit()}return setTimeout(s,u.checkInterval),f.promise()}})}(jQuery,this),window.apf=window.apf||{},window.apf.gmap=window.apf.gmap||{},window.apf.olmap=window.apf.olmap||{},window.apf.initiiere_index=function(){"use strict";$("#programm_wahl").buttonset({create:function(){$("#programm_wahl").show()}}),$("#messen").buttonset(),$("button").button(),$("#tpopfeldkontr_tabs").tabs(),$(".apf-resizable").resizable(),$("#label_olmap_infos_abfragen, #label_olmap_distanz_messen, #label_olmap_flaeche_messen, #label_olmap_auswaehlen, #olmap_exportieren_div, .apf_tooltip").tooltip({tooltipClass:"tooltip-styling-hinterlegt",content:function(){return $(this).attr("title")}}),$(".export_abschnitt").tooltip({tooltipClass:"export_abschnitt_tooltip_class",content:function(){return $(this).attr("title")}}),$("#olmap_exportieren").button({icons:{primary:"ui-icon-circle-arrow-s"},text:!1,disabled:!0}),window.apf.erstelleGemeindeliste();var e=["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],t=["So","Mo","Di","Mi","Do","Fr","Sa"],i=["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"];$("#TPopKontrDatum").datepicker({dateFormat:"dd.mm.yy",altField:"#TPopKontrJahr",altFormat:"yy",defaultDate:0,showOn:"button",buttonImage:"style/images/calendar.gif",buttonImageOnly:!0,monthNames:e,dayNamesMin:t,dayNames:i,firstDay:1}),$("#TPopMassnDatum").datepicker({dateFormat:"dd.mm.yy",altField:"#TPopMassnJahr",altFormat:"yy",defaultDate:0,showOn:"button",buttonImage:"style/images/calendar.gif",buttonImageOnly:!0,monthNames:e,dayNamesMin:t,dayNames:i,firstDay:1}),$("#JBerDatum, #IbErstelldatum").datepicker({dateFormat:"dd.mm.yy",defaultDate:0,showOn:"button",buttonImage:"style/images/calendar.gif",buttonImageOnly:!0,monthNames:e,dayNamesMin:t,dayNames:i,firstDay:1}),window.apf.feldliste_feldkontr=["TPopKontrJahr","TPopKontrDatum","TPopKontrMethode1","TPopKontrAnz1","TPopKontrMethode2","TPopKontrAnz2","TPopKontrMethode3","TPopKontrAnz3","TPopKontrTxt","TPopKontrBearb","TPopKontrZaehleinheit1","TPopKontrZaehleinheit2","TPopKontrZaehleinheit3","TPopKontrTyp","TPopKontrJungpfl","TPopKontrVitalitaet","TPopKontrUeberleb","TPopKontrEntwicklung","TPopKontrUrsach","TPopKontrUrteil","TPopKontrAendUms","TPopKontrAendKontr","TPopKontrGuid","TPopKontrFlaeche","TPopKontrVegTyp","TPopKontrKonkurrenz","TPopKontrMoosschicht","TPopKontrKrautschicht","TPopKontrStrauchschicht","TPopKontrBaumschicht","TPopKontrBodenTyp","TPopKontrBodenKalkgehalt","TPopKontrBodenDurchlaessigkeit","TPopKontrBodenHumus","TPopKontrBodenNaehrstoffgehalt","TPopKontrBodenAbtrag","TPopKontrWasserhaushalt","TPopKontrHandlungsbedarf","TPopKontrIdealBiotopUebereinst","TPopKontrLeb","TPopKontrLebUmg"],window.apf.feldliste_freiwkontr=["TPopKontrJahr","TPopKontrDatum","TPopKontrMethode1","TPopKontrAnz1","TPopKontrMethode2","TPopKontrAnz2","TPopKontrMethode3","TPopKontrAnz3","TPopKontrTxt","TPopKontrBearb","TPopKontrZaehleinheit1","TPopKontrZaehleinheit2","TPopKontrZaehleinheit3","TPopKontrPlan","TPopKontrUebFlaeche","TPopKontrUebPfl","TPopKontrNaBo","TPopKontrJungPflJN","TPopKontrVegHoeMax","TPopKontrVegHoeMit","TPopKontrGefaehrdung","TPopKontrGuid"],$("#ap_loeschen").hide(),window.apf.erstelle_artlisten(),$.when(window.apf.wähleApListe("programm_alle")).then(function(){window.apf.öffneUri()})},window.apf.initiiere_ap=function(){"use strict";if(localStorage.ap_id){var e;if(e=$("[name='programm_wahl']:checked").attr("id"),window.apf.leereFelderVonFormular("ap"),$("#ap_waehlen").val()&&"programm_neu"!==e){var t=$.ajax({type:"get",url:"php/ap.php",dataType:"json",data:{id:localStorage.ap_id}});t.always(function(e){if(e){if(window.apf.ap=e,$("#ApStatus"+e.ApStatus).prop("checked",!0),$("#ApUmsetzung"+e.ApUmsetzung).prop("checked",!0),$("#ApJahr").val(e.ApJahr),$("#ApArtwert").val(e.ApArtwert),$("#Artname").val(e.Artname),window.apf.adressen_html)$("#ApBearb").html(window.apf.adressen_html).val(window.apf.ApBearb);else{var t=$.ajax({type:"get",url:"php/adressen.php",dataType:"json"});t.always(function(e){if(e){var t;t="<option></option>",_.each(e.rows,function(e){t+='<option value="'+e.id+'">'+e.AdrName+"</option>"}),window.apf.adressen_html=t,$("#ApBearb").html(t).val(window.apf.ApBearb)}})}window.apf.zeigeFormular("ap"),history.replaceState({ap:"ap"},"ap","index.html?ap="+e.ApArtId)}})}else $("#ap_waehlen").val()&&"programm_neu"===e&&window.apf.zeigeFormular("ap")}},window.apf.setzeWindowAp=function(e){"use strict";localStorage.ap_id=e;var t=$.ajax({type:"get",url:"php/ap.php",dataType:"json",data:{id:localStorage.ap_id}});t.always(function(e){e&&(window.apf.ap=e)})},window.apf.hole_artliste_html=function(){"use strict";var e=$.Deferred();if(window.apf.artliste_html)e.resolve();else{var t=$.ajax({type:"get",url:"php/artliste.php",dataType:"json"});t.always(function(t){var i;i="<option></option>",_.each(t.rows,function(e){i+='<option value="'+e.id+'">'+e.Artname+"</option>"}),window.apf.artliste_html=i,e.resolve()})}return e.promise()},window.apf.erstelle_artlisten=function(){"use strict";var e=$.Deferred();return $.when(window.apf.hole_artliste_html()).then(function(){$("#AaSisfNr").html(window.apf.artliste_html),$("#TPopMassnAnsiedWirtspfl").html(window.apf.artliste_html),e.resolve()}),e.promise()},window.apf.initiiere_pop=function(e){"use strict";if(!localStorage.pop_id)return void window.apf.initiiere_ap();window.apf.leereFelderVonFormular("pop");var t=$.ajax({type:"get",url:"php/pop.php",dataType:"json",data:{id:localStorage.pop_id}}),i=$("#PopName"),n=$("#PopNr");t.always(function(t){t&&(window.apf.pop=t,$("#PopHerkunft"+t.PopHerkunft).prop("checked",!0),1==t.PopHerkunftUnklar?$("#PopHerkunftUnklar").prop("checked",!0):$("#PopHerkunftUnklar").prop("checked",!1),$("#PopHerkunftUnklarBegruendung").val(t.PopHerkunftUnklarBegruendung).limiter(255,$("#PopHerkunftUnklarBegruendung_limit")),i.val(t.PopName).limiter(150,$("#PopName_limit")),n.val(t.PopNr),$("#PopBekanntSeit").val(t.PopBekanntSeit),$("#PopXKoord").val(t.PopXKoord),$("#PopYKoord").val(t.PopYKoord),e||(window.apf.zeigeFormular("pop"),history.replaceState({pop:"pop"},"pop","index.html?ap="+localStorage.ap_id+"&pop="+localStorage.pop_id),i.val()||n.focus()))})},window.apf.setzeWindowPop=function(e){"use strict";localStorage.pop_id=e;var t=$.ajax({type:"get",url:"php/pop.php",dataType:"json",data:{id:localStorage.pop_id}});t.always(function(e){e&&(window.apf.pop=e)})},window.apf.initiiere_apziel=function(){"use strict";if(!localStorage.apziel_id)return void window.apf.initiiere_ap();var e=$.Deferred(),t=$("#ZielJahr");window.apf.leereFelderVonFormular("apziel");var i=$.ajax({type:"get",url:"php/apziel.php",dataType:"json",data:{id:localStorage.apziel_id}});return i.always(function(i){i&&(window.apf.apziel=i,t.val(i.ZielJahr),$("#ZielTyp"+i.ZielTyp).prop("checked",!0),$("#ZielBezeichnung").val(i.ZielBezeichnung),window.apf.zeigeFormular("apziel"),history.replaceState({apziel:"apziel"},"apziel","index.html?ap="+localStorage.ap_id+"&apziel="+localStorage.apziel_id),t.val()||t.focus(),e.resolve())}),e.promise()},window.apf.setzeWindowApziel=function(e){"use strict";localStorage.apziel_id=e;var t=$.ajax({type:"get",url:"php/apziel.php",dataType:"json",data:{id:localStorage.apziel_id}});t.always(function(e){e&&(window.apf.apziel=e)})},window.apf.initiiere_zielber=function(){"use strict";if(!localStorage.zielber_id)return void window.apf.initiiere_ap();window.apf.leereFelderVonFormular("zielber");var e=$.ajax({type:"get",url:"php/zielber.php",dataType:"json",data:{id:localStorage.zielber_id}}),t=$("#ZielBerJahr");e.always(function(e){e&&(window.apf.zielber=e,t.val(e.ZielBerJahr),$("#ZielBerErreichung").val(e.ZielBerErreichung),$("#ZielBerTxt").val(e.ZielBerTxt),window.apf.zeigeFormular("zielber"),history.replaceState({zielber:"zielber"},"zielber","index.html?ap="+localStorage.ap_id+"&apziel="+localStorage.apziel_id+"&zielber="+localStorage.zielber_id),t.val()||t.focus())})},window.apf.setzeWindowZielber=function(e){"use strict";localStorage.zielber_id=e;var t=$.ajax({type:"get",url:"php/zielber.php",dataType:"json",data:{id:localStorage.zielber_id}});t.always(function(e){e&&(window.apf.zielber=e)})},window.apf.initiiere_erfkrit=function(){"use strict";if(!localStorage.erfkrit_id)return void window.apf.initiiere_ap();window.apf.leereFelderVonFormular("erfkrit");var e=$.ajax({type:"get",url:"php/erfkrit.php",dataType:"json",data:{id:localStorage.erfkrit_id}}),t=$("#ErfkritErreichungsgrad");e.always(function(e){e&&(window.apf.erfkrit=e,$("#ErfkritErreichungsgrad"+e.ErfkritErreichungsgrad).prop("checked",!0),$("#ErfkritTxt").val(e.ErfkritTxt).limiter(255,$("#ErfkritTxt_limit")),window.apf.zeigeFormular("erfkrit"),history.replaceState({erfkrit:"erfkrit"},"erfkrit","index.html?ap="+localStorage.ap_id+"&erfkrit="+localStorage.erfkrit_id),t.val()||t.focus())})},window.apf.setzeWindowErfkrit=function(e){"use strict";localStorage.erfkrit_id=e;var t=$.ajax({type:"get",url:"php/erfkrit.php",dataType:"json",data:{id:localStorage.erfkrit_id}});t.always(function(e){e&&(window.apf.erfkrit=e)})},window.apf.initiiere_jber=function(){"use strict";if(!localStorage.jber_id)return void window.apf.initiiere_ap();window.apf.leereFelderVonFormular("jber");var e=$.ajax({type:"get",url:"php/jber.php",dataType:"json",data:{id:localStorage.jber_id}}),t=$("#JBerJahr");e.always(function(e){if(e){if(window.apf.jber=e,t.val(e.JBerJahr),$("#JBerSituation").val(e.JBerSituation),$("#JBerVergleichVorjahrGesamtziel").val(e.JBerVergleichVorjahrGesamtziel),$("#JBerBeurteilung"+e.JBerBeurteilung).prop("checked",!0),$("#JBerVeraenGegenVorjahr\\"+e.JBerVeraenGegenVorjahr).prop("checked",!0),$("#JBerAnalyse").val(e.JBerAnalyse).limiter(255,$("#JBerAnalyse_limit")),$("#JBerUmsetzung").val(e.JBerUmsetzung),$("#JBerErfko").val(e.JBerErfko),$("#JBerATxt").val(e.JBerATxt),$("#JBerBTxt").val(e.JBerBTxt),$("#JBerCTxt").val(e.JBerCTxt),$("#JBerDTxt").val(e.JBerDTxt),$("#JBerDatum").val("01.01.1970"!==e.JBerDatum?e.JBerDatum:""),window.apf.adressen_html)$("#JBerBearb").html(window.apf.adressen_html).val(window.apf.jber.JBerBearb);else{var i=$.ajax({type:"get",url:"php/adressen.php",dataType:"json"});i.always(function(e){if(e){var t;t="<option></option>",_.each(e.rows,function(e){t+='<option value="'+e.id+'">'+e.AdrName+"</option>"}),window.apf.adressen_html=t,$("#JBerBearb").html(t).val(window.apf.jber.JBerBearb)}})}window.apf.zeigeFormular("jber"),history.replaceState({jber:"jber"},"jber","index.html?ap="+localStorage.ap_id+"&jber="+localStorage.jber_id),t.val()||t.focus()}})},window.apf.setzeWindowJber=function(e){"use strict";localStorage.jber_id=e;var t=$.ajax({type:"get",url:"php/jber.php",dataType:"json",data:{id:localStorage.jber_id}});t.always(function(e){e&&(window.apf.jber=e)})},window.apf.initiiere_jber_uebersicht=function(){"use strict";if(!localStorage.jber_uebersicht_id)return void window.apf.initiiere_ap();window.apf.leereFelderVonFormular("jber_uebersicht");var e=$.ajax({type:"get",url:"php/jber_uebersicht.php",dataType:"json",data:{JbuJahr:localStorage.jber_uebersicht_id}}),t=$("#JbuJahr");e.always(function(e){e&&(window.apf.jber_übersicht=e,t.val(e.JbuJahr),$("#JbuBemerkungen").val(e.JbuBemerkungen),window.apf.zeigeFormular("jber_uebersicht"),history.replaceState({jber_uebersicht:"jber_uebersicht"},"jber_uebersicht","index.html?ap="+localStorage.ap_id+"&jber_uebersicht="+localStorage.jber_uebersicht_id),t.val()||t.focus())})},window.apf.setzeWindowJberUebersicht=function(e){"use strict";localStorage.jber_uebersicht_id=e;var t=$.ajax({type:"get",url:"php/jber_uebersicht.php",dataType:"json",data:{id:localStorage.jber_uebersicht_id}});t.always(function(e){e&&(window.apf.jber_übersicht=e)})},window.apf.initiiere_ber=function(){"use strict";if(!localStorage.ber_id)return void window.apf.initiiere_ap();window.apf.leereFelderVonFormular("ber");var e=$.ajax({type:"get",url:"php/ber.php",dataType:"json",data:{id:localStorage.ber_id}}),t=$("#BerAutor"),i=$("#BerJahr"),n=$("#BerTitel"),o=$("#BerURL");e.always(function(e){e&&(window.apf.ber=e,t.val(e.BerAutor),i.val(e.BerJahr),n.val(e.BerTitel).limiter(255,$("#BerTitel_limit")),o.val(e.BerURL).limiter(255,$("#BerURL_limit")),$("#BerURLHref").attr("onClick","window.open('"+e.BerURL+"', target='_blank')"),window.apf.zeigeFormular("ber"),history.replaceState({ber:"ber"},"ber","index.html?ap="+localStorage.ap_id+"&ber="+localStorage.ber_id),t.val()?i.val()?n.val()?o.val()||o.focus():n.focus():i.focus():t.focus())})},window.apf.setzeWindowBer=function(e){"use strict";localStorage.ber_id=e;var t=$.ajax({type:"get",url:"php/ber.php",dataType:"json",data:{id:localStorage.ber_id}});t.always(function(e){e&&(window.apf.ber=e)})},window.apf.initiiere_idealbiotop=function(){"use strict";if(!localStorage.ap_id)return void window.apf.initiiere_ap();window.apf.leereFelderVonFormular("idealbiotop");var e=$.ajax({type:"get",url:"php/idealbiotop.php",dataType:"json",data:{id:localStorage.ap_id}}),t=$("#IbErstelldatum");e.always(function(e){if(e)localStorage.idealbiotop_id=e.IbApArtId,window.apf.idealbiotop=e,"01.01.1970"!==e.IbErstelldatum&&$("#IbErstelldatum").val(e.IbErstelldatum),$("#IbHoehenlage").val(e.IbHoehenlage),$("#IbRegion").val(e.IbRegion),$("#IbExposition").val(e.IbExposition),$("#IbBesonnung").val(e.IbBesonnung),$("#IbHangneigung").val(e.IbHangneigung),$("#IbBodenTyp").val(e.IbBodenTyp),$("#IbBodenKalkgehalt").val(e.IbBodenKalkgehalt),$("#IbBodenDurchlaessigkeit").val(e.IbBodenDurchlaessigkeit),$("#IbBodenHumus").val(e.IbBodenHumus),$("#IbBodenNaehrstoffgehalt").val(e.IbBodenNaehrstoffgehalt),$("#IbWasserhaushalt").val(e.IbWasserhaushalt),$("#IbKonkurrenz").val(e.IbKonkurrenz),$("#IbMoosschicht").val(e.IbMoosschicht),$("#IbKrautschicht").val(e.IbKrautschicht),$("#IbStrauchschicht").val(e.IbStrauchschicht),$("#IbBaumschicht").val(e.IbBaumschicht),$("#IbBemerkungen").val(e.IbBemerkungen),window.apf.zeigeFormular("idealbiotop"),history.replaceState({idealbiotop:"idealbiotop"},"idealbiotop","index.html?ap="+localStorage.ap_id+"&idealbiotop="+localStorage.idealbiotop_id),t.val()||t.focus();else{if(!window.apf.prüfeSchreibvoraussetzungen())return;var i=$.ajax({type:"post",url:"php/idealbiotop_insert.php",dataType:"json",data:{id:localStorage.ap_id,user:sessionStorage.User}});i.always(function(e){localStorage.idealbiotop_id=e.IbApArtId,window.apf.initiiere_idealbiotop()}),i.fail(function(){console.log("Fehler: Kein Idealbiotop erstellt")})}})},window.apf.setzeWindowIdealbiotop=function(e){"use strict";localStorage.idealbiotop_id=e;var t=$.ajax({type:"get",url:"php/idealbiotop.php",dataType:"json",data:{id:localStorage.idealbiotop_id}});t.always(function(e){e&&(window.apf.idealbiotop=e)})},window.apf.initiiere_assozarten=function(){"use strict";if(!localStorage.assozarten_id)return void window.apf.initiiere_ap();window.apf.leereFelderVonFormular("assozarten");var e=$.ajax({type:"get",url:"php/assozarten.php",dataType:"json",data:{id:localStorage.assozarten_id}}),t=$("#AaSisfNr");e.always(function(e){e&&(window.apf.assozarten=e,t.val(e.AaSisfNr),$("#AaBem").val(e.AaBem),window.apf.zeigeFormular("assozarten"),history.replaceState({assozarten:"assozarten"},"assozarten","index.html?ap="+localStorage.ap_id+"&assozarten="+localStorage.assozarten_id),t.val()||t.focus())})},window.apf.setzeWindowAssozarten=function(e){"use strict";localStorage.assozarten_id=e;var t=$.ajax({type:"get",url:"php/assozarten.php",dataType:"json",data:{id:localStorage.assozarten_id}});t.always(function(e){e&&(window.apf.assozarten=e)})},window.apf.initiiere_popmassnber=function(){"use strict";if(!localStorage.popmassnber_id)return void window.apf.initiiere_pop();window.apf.leereFelderVonFormular("popmassnber");var e=$.ajax({type:"get",url:"php/popmassnber.php",dataType:"json",data:{id:localStorage.popmassnber_id}});e.always(function(e){e&&(window.apf.popmassnber=e,$("#PopMassnBerJahr").val(e.PopMassnBerJahr),$("#PopMassnBerErfolgsbeurteilung"+e.PopMassnBerErfolgsbeurteilung).prop("checked",!0),$("#PopMassnBerTxt").val(e.PopMassnBerTxt),window.apf.zeigeFormular("popmassnber"),history.replaceState({popmassnber:"popmassnber"},"popmassnber","index.html?ap="+localStorage.ap_id+"&pop="+localStorage.pop_id+"&popmassnber="+localStorage.popmassnber_id),$("#PopMassnBerJahr").focus())})},window.apf.setzeWindowPopmassnber=function(e){"use strict";localStorage.popmassnber_id=e;var t=$.ajax({type:"get",url:"php/popmassnber.php",dataType:"json",data:{id:localStorage.popmassnber_id}});t.always(function(e){e&&(window.apf.popmassnber=e)})},window.apf.initiiere_tpop=function(e){"use strict";var t=$("#TPopFlurname");if(!localStorage.tpop_id)return void window.apf.initiiere_pop();window.apf.leereFelderVonFormular("tpop");var i=$.ajax({type:"get",url:"php/tpop.php",dataType:"json",data:{id:localStorage.tpop_id}});i.always(function(i){if(i){if(window.apf.tpop=i,t.val(i.TPopFlurname).limiter(255,$("#TPopFlurname_limit")),$("#TPopNr").val(i.TPopNr),$("#TPopHerkunft"+i.TPopHerkunft).prop("checked",!0),1==i.TPopHerkunftUnklar?$("#TPopHerkunftUnklar").prop("checked",!0):$("#TPopHerkunftUnklar").prop("checked",!1),$("#TPopHerkunftUnklarBegruendung").val(i.TPopHerkunftUnklarBegruendung).limiter(255,$("#TPopHerkunftUnklarBegruendung_limit")),$("#TPopApBerichtRelevant"+i.TPopApBerichtRelevant).prop("checked",!0),$("#TPopBekanntSeit").val(i.TPopBekanntSeit),$("#TPopGemeinde").val(i.TPopGemeinde).limiter(255,$("#TPopGemeinde_limit")),$("#TPopXKoord").val(i.TPopXKoord),$("#TPopYKoord").val(i.TPopYKoord),$("#TPopRadius").val(i.TPopRadius),$("#TPopHoehe").val(i.TPopHoehe),$("#TPopExposition").val(i.TPopExposition).limiter(50,$("#TPopExposition_limit")),$("#TPopKlima").val(i.TPopKlima).limiter(50,$("#TPopKlima_limit")),$("#TPopNeigung").val(i.TPopNeigung).limiter(50,$("#TPopNeigung_limit")),$("#TPopBeschr").val(i.TPopBeschr).limiter(255,$("#TPopBeschr_limit")),$("#TPopKatNr").val(i.TPopKatNr).limiter(255,$("#TPopKatNr_limit")),$("#TPopEigen").val(i.TPopEigen).limiter(255,$("#TPopEigen_limit")),$("#TPopKontakt").val(i.TPopKontakt).limiter(255,$("#TPopKontakt_limit")),$("#TPopNutzungszone").val(i.TPopNutzungszone).limiter(255,$("#TPopNutzungszone_limit")),$("#TPopBewirtschafterIn").val(i.TPopBewirtschafterIn).limiter(255,$("#TPopBewirtschafterIn_limit")),$("#TPopBewirtschaftung").val(i.TPopBewirtschaftung).limiter(255,$("#TPopBewirtschaftung_limit")),$("#TPopTxt").val(i.TPopTxt),window.apf.adressen_html)$("#TPopVerantw").html(window.apf.adressen_html).val(window.apf.tpop.TPopVerantw);else{var n=$.ajax({type:"get",url:"php/adressen.php",dataType:"json"});n.always(function(e){if(e){window.apf.adressen=e,localStorage.adressen=JSON.stringify(e);var t;t="<option></option>",_.each(e.rows,function(e){t+='<option value="'+e.id+'">'+e.AdrName+"</option>"}),window.apf.adressen_html=t,$("#TPopVerantw").html(t).val(window.apf.tpop.TPopVerantw)}})}e||(window.apf.zeigeFormular("tpop"),history.replaceState({tpop:"tpop"},"tpop","index.html?ap="+localStorage.ap_id+"&pop="+localStorage.pop_id+"&tpop="+localStorage.tpop_id),t.val()||$("#TPopNr").focus())}}),i.fail(function(){console.log("Fehler: keine Daten für die Teilpopulation erhalten")})},window.apf.setzeWindowTpop=function(e){"use strict";localStorage.tpop_id=e;var t=$.ajax({type:"get",url:"php/tpop.php",dataType:"json",data:{id:localStorage.tpop_id}});t.always(function(e){e&&(window.apf.tpop=e)})},window.apf.initiiere_popber=function(){"use strict";if(!localStorage.popber_id)return void window.apf.initiiere_pop();window.apf.leereFelderVonFormular("popber");var e=$.ajax({type:"get",url:"php/popber.php",dataType:"json",data:{id:localStorage.popber_id}});e.always(function(e){e&&(window.apf.popber=e,$("#PopBerJahr").val(e.PopBerJahr),$("#PopBerEntwicklung"+e.PopBerEntwicklung).prop("checked",!0),$("#PopBerTxt").val(e.PopBerTxt),window.apf.zeigeFormular("popber"),history.replaceState({tpopber:"popber"},"popber","index.html?ap="+localStorage.ap_id+"&pop="+localStorage.pop_id+"&popber="+localStorage.popber_id),$("#PopBerJahr").focus())})},window.apf.setzeWindowPopber=function(e){"use strict";localStorage.popber_id=e;var t=$.ajax({type:"get",url:"php/popber.php",dataType:"json",data:{id:localStorage.popber_id}});
t.always(function(e){e&&(window.apf.popber=e)})},window.apf.initiiere_tpopfeldkontr=function(){"use strict";if(!localStorage.tpopfeldkontr_id)return void window.apf.initiiere_pop();window.apf.leereFelderVonFormular("tpopfeldkontr"),$(".feld_tpopfeldkontr").each(function(){$(this).hide()});var e=$.ajax({type:"get",url:"php/tpopfeldkontr.php",dataType:"json",data:{id:localStorage.tpopfeldkontr_id}}),t=$("#TPopKontrJahr"),i=$("#TPopKontrJungPflJN_ja"),n=$("#TPopKontrJungPflJN_nein"),o=$("#TPopKontrJungPflJN_leer");e.always(function(e){if(e){if(window.apf.tpopfeldkontr=e,t.val(e.TPopKontrJahr),$("#TPopKontrDatum").val("01.01.1970"!==e.TPopKontrDatum?e.TPopKontrDatum:""),$("#TPopKontrMethode1"+e.TPopKontrMethode1).prop("checked",!0),$("#TPopKontrAnz1").val(e.TPopKontrAnz1),$("#TPopKontrMethode2"+e.TPopKontrMethode2).prop("checked",!0),$("#TPopKontrAnz2").val(e.TPopKontrAnz2),$("#TPopKontrMethode3"+e.TPopKontrMethode3).prop("checked",!0),$("#TPopKontrAnz3").val(e.TPopKontrAnz3),$("#TPopKontrTxt").val(e.TPopKontrTxt),$("#TPopKontrGuid").val(e.TPopKontrGuid),window.apf.adressen_html)$("#TPopKontrBearb").html(window.apf.adressen_html).val(window.apf.tpopfeldkontr.TPopKontrBearb);else{var a=$.ajax({type:"get",url:"php/adressen.php",dataType:"json"});a.always(function(e){if(e){var t;t="<option></option>",_.each(e.rows,function(e){t+='<option value="'+e.id+'">'+e.AdrName+"</option>"}),window.apf.adressen_html=t,$("#TPopKontrBearb").html(t).val(window.apf.tpopfeldkontr.TPopKontrBearb)}})}if(window.apf.TPopKontrZähleinheit_html)$("#TPopKontrZaehleinheit1").html(window.apf.TPopKontrZähleinheit_html).val(window.apf.tpopfeldkontr.TPopKontrZaehleinheit1),$("#TPopKontrZaehleinheit2").html(window.apf.TPopKontrZähleinheit_html).val(window.apf.tpopfeldkontr.TPopKontrZaehleinheit2),$("#TPopKontrZaehleinheit3").html(window.apf.TPopKontrZähleinheit_html).val(window.apf.tpopfeldkontr.TPopKontrZaehleinheit3);else{var s=$.ajax({type:"get",url:"php/tpopfeldkontr_zaehleinheit.php",dataType:"json"});s.always(function(e){if(e){var t;t="<option></option>",_.each(e.rows,function(e){t+='<option value="'+e.id+'">'+e.ZaehleinheitTxt+"</option>"}),window.apf.TPopKontrZähleinheit_html=t,$("#TPopKontrZaehleinheit1").html(t).val(window.apf.tpopfeldkontr.TPopKontrZaehleinheit1),$("#TPopKontrZaehleinheit2").html(t).val(window.apf.tpopfeldkontr.TPopKontrZaehleinheit2),$("#TPopKontrZaehleinheit3").html(t).val(window.apf.tpopfeldkontr.TPopKontrZaehleinheit3)}})}if(!localStorage.tpopfreiwkontr)if($("#TPopKontrTyp"+e.TPopKontrTyp).prop("checked",!0),$("#TPopKontrJungpfl").val(e.TPopKontrJungpfl),$("#TPopKontrVitalitaet").val(e.TPopKontrVitalitaet).limiter(255,$("#TPopKontrVitalitaet_limit")),$("#TPopKontrUeberleb").val(e.TPopKontrUeberleb),$("#TPopKontrEntwicklung"+e.TPopKontrEntwicklung).prop("checked",!0),$("#TPopKontrUrsach").val(e.TPopKontrUrsach).limiter(255,$("#TPopKontrUrsach_limit")),$("#TPopKontrUrteil").val(e.TPopKontrUrteil).limiter(255,$("#TPopKontrUrteil_limit")),$("#TPopKontrAendUms").val(e.TPopKontrAendUms).limiter(255,$("#TPopKontrAendUms_limit")),$("#TPopKontrAendKontr").val(e.TPopKontrAendKontr).limiter(255,$("#TPopKontrAendKontr_limit")),$("#TPopKontrFlaeche").val(e.TPopKontrFlaeche),$("#TPopKontrVegTyp").val(e.TPopKontrVegTyp).limiter(100,$("#TPopKontrVegTyp_limit")),$("#TPopKontrKonkurrenz").val(e.TPopKontrKonkurrenz).limiter(100,$("#TPopKontrKonkurrenz_limit")),$("#TPopKontrMoosschicht").val(e.TPopKontrMoosschicht).limiter(100,$("#TPopKontrMoosschicht_limit")),$("#TPopKontrKrautschicht").val(e.TPopKontrKrautschicht).limiter(100,$("#TPopKontrKrautschicht_limit")),$("#TPopKontrStrauchschicht").val(e.TPopKontrStrauchschicht).limiter(255,$("#TPopKontrStrauchschicht_limit")),$("#TPopKontrBaumschicht").val(e.TPopKontrBaumschicht).limiter(100,$("#TPopKontrBaumschicht_limit")),$("#TPopKontrBodenTyp").val(e.TPopKontrBodenTyp).limiter(255,$("#TPopKontrBodenTyp_limit")),$("#TPopKontrBodenKalkgehalt").val(e.TPopKontrBodenKalkgehalt).limiter(100,$("#TPopKontrBodenKalkgehalt_limit")),$("#TPopKontrBodenDurchlaessigkeit").val(e.TPopKontrBodenDurchlaessigkeit).limiter(100,$("#TPopKontrBodenDurchlaessigkeit_limit")),$("#TPopKontrBodenHumus").val(e.TPopKontrBodenHumus).limiter(100,$("#TPopKontrBodenHumus_limit")),$("#TPopKontrBodenNaehrstoffgehalt").val(e.TPopKontrBodenNaehrstoffgehalt).limiter(100,$("#TPopKontrBodenNaehrstoffgehalt_limit")),$("#TPopKontrBodenAbtrag").val(e.TPopKontrBodenAbtrag).limiter(255,$("#TPopKontrBodenAbtrag_limit")),$("#TPopKontrWasserhaushalt").val(e.TPopKontrWasserhaushalt).limiter(255,$("#TPopKontrWasserhaushalt_limit")),$("#TPopKontrHandlungsbedarf").val(e.TPopKontrHandlungsbedarf),$("#TPopKontrIdealBiotopUebereinst"+e.TPopKontrIdealBiotopUebereinst).prop("checked",!0),window.apf.lrdelarze_html)$("#TPopKontrLeb").html(window.apf.lrdelarze_html).val(window.apf.tpopfeldkontr.TPopKontrLeb),$("#TPopKontrLebUmg").html(window.apf.lrdelarze_html).val(window.apf.tpopfeldkontr.TPopKontrLebUmg);else{var r=$.ajax({type:"get",url:"php/lrdelarze.php",dataType:"json"});r.always(function(e){if(e){var t;t="<option></option>",_.each(e.rows,function(e){t+='<option value="'+e.id+'">'+e.Einheit+"</option>"}),window.apf.lrdelarze_html=t,$("#TPopKontrLeb").html(t).val(window.apf.tpopfeldkontr.TPopKontrLeb),$("#TPopKontrLebUmg").html(t).val(window.apf.tpopfeldkontr.TPopKontrLebUmg)}})}if(window.apf.IdealBiotopÜbereinst_html)$("#TPopKontrIdealBiotopUebereinst").html(window.apf.IdealBiotopÜbereinst_html).val(window.apf.tpopfeldkontr.TPopKontrIdealBiotopUebereinst);else{var l=$.ajax({type:"get",url:"php/idealbiotopuebereinst.php",dataType:"json"});l.always(function(e){if(e){var t;t="<option></option>",_.each(e.rows,function(e){t+='<option value="'+e.id+'">'+e.DomainTxt+"</option>"}),window.apf.IdealBiotopÜbereinst_html=t,$("#TPopKontrIdealBiotopUebereinst").html(t).val(window.apf.tpopfeldkontr.TPopKontrIdealBiotopUebereinst)}})}localStorage.tpopfreiwkontr&&(1==e.TPopKontrPlan?$("#TPopKontrPlan").prop("checked",!0):$("#TPopKontrPlan").prop("checked",!1),$("#TPopKontrUebFlaeche").val(e.TPopKontrUebFlaeche),$("#TPopKontrUebPfl").val(e.TPopKontrUebPfl),$("#TPopKontrNaBo").val(e.TPopKontrNaBo),i.prop("checked",!1),n.prop("checked",!1),o.prop("checked",!1),1==e.TPopKontrJungPflJN?i.prop("checked",!0):0==e.TPopKontrJungPflJN?n.prop("checked",!0):o.prop("checked",!0),$("#TPopKontrVegHoeMax").val(e.TPopKontrVegHoeMax),$("#TPopKontrVegHoeMit").val(e.TPopKontrVegHoeMit),$("#TPopKontrGefaehrdung").val(e.TPopKontrGefaehrdung).limiter(255,$("#TPopKontrGefaehrdung_limit"))),localStorage.tpopfreiwkontr?_.each(window.apf.feldliste_freiwkontr,function(e){$("#fieldcontain_"+e).show()}):_.each(window.apf.feldliste_feldkontr,function(e){$("#fieldcontain_"+e).show()}),window.apf.zeigeFormular("tpopfeldkontr"),localStorage.tpopfreiwkontr?history.replaceState({tpopfreiwkontr:"tpopfreiwkontr"},"tpopfreiwkontr","index.html?ap="+localStorage.ap_id+"&pop="+localStorage.pop_id+"&tpop="+localStorage.tpop_id+"&tpopfreiwkontr="+localStorage.tpopfeldkontr_id):history.replaceState({tpopfeldkontr:"tpopfeldkontr"},"tpopfeldkontr","index.html?ap="+localStorage.ap_id+"&pop="+localStorage.pop_id+"&tpop="+localStorage.tpop_id+"&tpopfeldkontr="+localStorage.tpopfeldkontr_id),localStorage.tpopfreiwkontr?($("#tpopfeldkontr_tabs_biotop").hide(),$("#biotop_tab_li").hide(),$("#tpopfeldkontr_tabs").tabs("option","active",0)):($("#tpopfeldkontr_tabs_biotop").show(),$("#biotop_tab_li").show(),$("#tpopfeldkontr_tabs_biotop").hide()),t.focus(),$(window).scrollTop(0)}})},window.apf.setzeWindowTpopfeldkontr=function(e){"use strict";localStorage.tpopfeldkontr_id=e;var t=$.ajax({type:"get",url:"php/tpopfeldkontr.php",dataType:"json",data:{id:localStorage.tpopfeldkontr_id}});t.always(function(e){e&&(window.apf.tpopfeldkontr=e)})},window.apf.initiiere_tpopmassn=function(){"use strict";if(!localStorage.tpopmassn_id)return void window.apf.initiiere_pop();window.apf.leereFelderVonFormular("tpopmassn");var e=$.ajax({type:"get",url:"php/tpopmassn.php",dataType:"json",data:{id:localStorage.tpopmassn_id}});e.always(function(e){if(e){if(window.apf.tpopmassn=e,window.apf.tpopmassntyp_html)$("#TPopMassnTyp").html(window.apf.tpopmassntyp_html).val(window.apf.tpopmassn.TPopMassnTyp);else{var t=$.ajax({type:"get",url:"php/tpopmassn_typ.php",dataType:"json"});t.always(function(e){if(e){window.apf.tpopmassn_typ=e;var t;t="<option></option>",_.each(e.rows,function(e){t+='<option value="'+e.id+'">'+e.MassnTypTxt+"</option>"}),window.apf.tpopmassntyp_html=t,$("#TPopMassnTyp").html(t).val(window.apf.tpopmassn.TPopMassnTyp)}})}if($("#TPopMassnTxt").val(e.TPopMassnTxt).limiter(255,$("#TPopMassnTxt_limit")),$("#TPopMassnJahr").val(e.TPopMassnJahr),$("#TPopMassnDatum").val("01.01.1970"!==e.TPopMassnDatum?e.TPopMassnDatum:""),window.apf.adressen_html)$("#TPopMassnBearb").html(window.apf.adressen_html).val(window.apf.tpopmassn.TPopMassnBearb);else{var i=$.ajax({type:"get",url:"php/adressen.php",dataType:"json"});i.always(function(e){if(e){var t;t="<option></option>",_.each(e.rows,function(e){t+='<option value="'+e.id+'">'+e.AdrName+"</option>"}),window.apf.adressen_html=t,$("#TPopMassnBearb").html(t).val(window.apf.tpopmassn.TPopMassnBearb)}})}$("#TPopMassnBemTxt").val(e.TPopMassnBemTxt),1==e.TPopMassnPlan?$("#TPopMassnPlan").prop("checked",!0):$("#TPopMassnPlan").prop("checked",!1),$("#TPopMassnPlanBez").val(e.TPopMassnPlanBez).limiter(255,$("#TPopMassnPlanBez_limit")),$("#TPopMassnFlaeche").val(e.TPopMassnFlaeche),$("#TPopMassnAnsiedForm").val(e.TPopMassnAnsiedForm).limiter(255,$("#TPopMassnAnsiedForm_limit")),$("#TPopMassnAnsiedPflanzanordnung").val(e.TPopMassnAnsiedPflanzanordnung).limiter(255,$("#TPopMassnAnsiedPflanzanordnung_limit")),$("#TPopMassnMarkierung").val(e.TPopMassnMarkierung).limiter(255,$("#TPopMassnMarkierung_limit")),$("#TPopMassnAnsiedAnzTriebe").val(e.TPopMassnAnsiedAnzTriebe),$("#TPopMassnAnsiedAnzPfl").val(e.TPopMassnAnsiedAnzPfl),$("#TPopMassnAnzPflanzstellen").val(e.TPopMassnAnzPflanzstellen),$.when(window.apf.erstelle_artlisten()).then(function(){$("#TPopMassnAnsiedWirtspfl").val(e.TPopMassnAnsiedWirtspfl),$("#TPopMassnAnsiedHerkunftPop").val(e.TPopMassnAnsiedHerkunftPop).limiter(255,$("#TPopMassnAnsiedHerkunftPop_limit")),$("#TPopMassnAnsiedDatSamm").val(e.TPopMassnAnsiedDatSamm).limiter(50,$("#TPopMassnAnsiedDatSamm_limit")),$("#TPopMassnGuid").val(e.TPopMassnGuid),window.apf.zeigeFormular("tpopmassn"),history.replaceState({tpopmassn:"tpopmassn"},"tpopmassn","index.html?ap="+localStorage.ap_id+"&pop="+localStorage.pop_id+"&tpop="+localStorage.tpop_id+"&tpopmassn="+localStorage.tpopmassn_id),$("#TPopMassnJahr").focus()})}})},window.apf.setzeWindowTpopmassn=function(e){"use strict";localStorage.tpopmassn_id=e;var t=$.ajax({type:"get",url:"php/tpopmassn.php",dataType:"json",data:{id:localStorage.tpopmassn_id}});t.always(function(e){e&&(window.apf.tpopmassn=e)})},window.apf.initiiere_tpopmassnber=function(){"use strict";if(!localStorage.tpopmassnber_id)return void window.apf.initiiere_pop();window.apf.leereFelderVonFormular("tpopmassnber");var e=$.ajax({type:"get",url:"php/tpopmassnber.php",dataType:"json",data:{id:localStorage.tpopmassnber_id}});e.always(function(e){e&&(window.apf.tpopmassnber=e,$("#TPopMassnBerJahr").val(e.TPopMassnBerJahr),$("#TPopMassnBerErfolgsbeurteilung"+e.TPopMassnBerErfolgsbeurteilung).prop("checked",!0),$("#TPopMassnBerTxt").val(e.TPopMassnBerTxt),window.apf.zeigeFormular("tpopmassnber"),history.replaceState({tpopmassnber:"tpopmassnber"},"tpopmassnber","index.html?ap="+localStorage.ap_id+"&pop="+localStorage.pop_id+"&tpop="+localStorage.tpop_id+"&tpopmassnber="+localStorage.tpopmassnber_id),$("#TPopMassnBerJahr").focus())})},window.apf.setzeWindowTpopmassnber=function(e){"use strict";localStorage.tpopmassnber_id=e;var t=$.ajax({type:"get",url:"php/tpopmassnber.php",dataType:"json",data:{id:localStorage.tpopmassnber_id}});t.always(function(e){e&&(window.apf.tpopmassnber=e)})},window.apf.initiiereTpopber=function(){"use strict";if(!localStorage.tpopber_id)return void window.apf.initiiere_pop();window.apf.leereFelderVonFormular("tpopber");var e=$.ajax({type:"get",url:"php/tpopber.php",dataType:"json",data:{id:localStorage.tpopber_id}});e.always(function(e){e&&(window.apf.tpopber=e,$("#TPopBerJahr").val(e.TPopBerJahr),$("#TPopBerEntwicklung"+e.TPopBerEntwicklung).prop("checked",!0),$("#TPopBerTxt").val(e.TPopBerTxt),window.apf.zeigeFormular("tpopber"),history.replaceState({tpopber:"tpopber"},"tpopber","index.html?ap="+localStorage.ap_id+"&pop="+localStorage.pop_id+"&tpop="+localStorage.tpop_id+"&tpopber="+localStorage.tpopber_id),$("#TPopBerJahr").focus())})},window.apf.setzeWindowTpopber=function(e){"use strict";localStorage.tpopber_id=e;var t=$.ajax({type:"get",url:"php/tpopber.php",dataType:"json",data:{id:localStorage.tpopber_id}});t.always(function(e){e&&(window.apf.tpopber=e)})},window.apf.initiiere_beob=function(e,t,i,n){"use strict";localStorage.beob_status=i,localStorage.beobtyp=e;var o,a;if(!t&&!n)return void("nicht_beurteilt"===i||"nicht_zuzuordnen"===i?window.apf.initiiere_ap():window.apf.initiiere_pop());t.indexOf("beob")>-1&&(t=t.replace("beob","")),localStorage.beob_id=t,o="php/beob_"+e+".php";var s=$.ajax({type:"get",url:o,dataType:"json",data:{id:t}}),r=$("#BeobBemerkungen");s.always(function(o){if(o){var s=window.apf.erstelleFelderFürBeob(o,e);$("#beob_table").html(s),a="php/beob_distzutpop_"+e+".php";var l=$.ajax({type:"get",url:a,dataType:"json",data:{beobid:t}});l.always(function(e){var o='<tr class="fieldcontain DistZuTPop"><td class="label"><label id="DistZuTPop_label" for="DistZuTPop">Einer Teilpopulation zuordnen:</label></td><td class="Datenfelder"><div class="Datenfelder" id="DistZuTPop_Felder">';if(e)if(_.each(e,function(e,t){t>0&&(o+="<br>"),o+='<input type="radio" name="DistZuTPop" id="DistZuTPop',o+=e.TPopId,o+='" class="DistZuTPop" formular="beob" value="',o+=e.TPopId,o+='" DistZuTPop="',o+=e.DistZuTPop,o+='">',o+=parseInt(e.DistZuTPop,10)>=0?parseInt(e.DistZuTPop)+"m: "+e.TPopFlurname:e.TPopFlurname}),o+="</div></td></tr>",$("#beob_zuordnungsfelder").html(o),r.attr("placeholder",""),"nicht_beurteilt"!==i){var a=$.ajax({type:"get",url:"php/beob_zuordnung.php",dataType:"json",data:{id:t}});a.always(function(e){$("#BeobNichtBeurteilt").prop("checked",!1),1==e.BeobNichtZuordnen?$("#BeobNichtZuordnen").prop("checked",!0):$("#BeobNichtZuordnen").prop("checked",!1),$("#DistZuTPop"+e.TPopId).prop("checked",!0),$("#BeobBemerkungen").val(e.BeobBemerkungen),$("#BeobMutWann").val(e.BeobMutWann),$("#BeobMutWer").val(e.BeobMutWer),n||(window.apf.zeigeFormular("beob"),"zugeordnet"===i?history.replaceState({beob_zugeordnet:"beob_zugeordnet"},"beob_zugeordnet","index.html?ap="+localStorage.ap_id+"&pop="+localStorage.pop_id+"&tpop="+localStorage.tpop_id+"&beob_zugeordnet="+t):"nicht_zuzuordnen"===i&&history.replaceState({beob_nicht_zuzuordnen:"beob_nicht_zuzuordnen"},"beob_nicht_zuzuordnen","index.html?ap="+localStorage.ap_id+"&beob_nicht_zuzuordnen="+t))})}else $("#BeobNichtBeurteilt").prop("checked",!0),$("#BeobNichtZuordnen").prop("checked",!1),r.val("").attr("placeholder","Bemerkungen sind nur in zugeordneten oder nicht zuzuordnenden Beobachtungen möglich"),n||(window.apf.zeigeFormular("beob"),history.replaceState({beob_nicht_beurteilt:"beob_nicht_beurteilt"},"beob_nicht_beurteilt","index.html?ap="+localStorage.ap_id+"&beob_nicht_beurteilt="+t))})}})},window.apf.initiiere_exporte=function(e){"use strict";$("#testart_div").hide(),$("#forms_titelzeile").hide(),window.apf.zeigeFormular("exporte"),history.replaceState({ex:"ex"},"ex","index.html?exporte=true"),e&&(location.hash="#"+e)},window.apf.zeigeFormular=function(e){"use strict";var t,i=$.Deferred(),n=$("#forms"),o=$("form"),a=$("#testart_div"),s=$("#forms_titelzeile"),r=$("#ap_waehlen");return n.hide(),o.each(function(){$(this).hide()}),$(".karte").each(function(){$(this).hide()}),window.apf.kartenhöhe_manuell=!1,n.height("auto"),a.hide(),s.hide(),r.val()&&(s.css("display","none"),r.val()<=150&&"jber_uebersicht"!==e&&"exporte"!==e&&"GeoAdminKarte"!==e?($("#forms_titelzeile").css("display","inline-block"),a.css("color","#03970F").show().html("Das ist eine Testart - hier kann man alles ausprobieren!")):$("#ap_waehlen").val()<=150&&"jber_uebersicht"===e&&($("#forms_titelzeile").css("display","inline-block"),a.css("color","#DF0303").show().html("Vorsicht: Die Übericht ist für alle Arten, daher HIER NICHT TESTEN"))),e&&(n.show(),$("#ap_loeschen").show(),$("#exportieren_1").hide(),"google_karte"===e||"GeoAdminKarte"===e?($("#forms_titelzeile").css("display","none"),t=$("#"+e),t.css("height",$(window).height()-17+"px"),window.apf.kartenhöhe_manuell=!0,window.apf.setzeKartenhöhe(),t.show(),"GeoAdminKarte"===e&&window.apf.initiiereOlmap()):(n.css("background-color","#FFE"),o.each(function(){$(this).hide(),$(this).attr("id")===e&&($(this).show(),$("textarea").each(function(){window.apf.fitTextareaToContent(this,document.documentElement.clientHeight)}))}),$(window).scrollTop(0)),i.resolve()),i.promise()},window.apf.leereFelderVonFormular=function(e){"use strict";$("#"+e+' input[type="text"]').each(function(){$(this).val("")}),$("#"+e+' input[type="radio"]:checked').each(function(){$(this).prop("checked",!1)}),$("#"+e+" select").each(function(){$(this).val("")})},window.apf.setzeTreehöhe=function(){"use strict";$(window).width()>1e3?$(".jstree-no-icons").height()+157>$(window).height()&&$("#tree").css("max-height",$(window).height()-139):$(".jstree-no-icons").height()+157>$(window).height()-75&&$("#tree").css("max-height",$(window).height()-220)},window.apf.setzeKartenhöhe=function(){"use strict";var e,t,i=window.apf.berechneOlmapLayertreeMaxhöhe;window.apf.kartenhöhe_manuell?(e=$(window).height()-17,t=$("#forms").width(),$("#forms").height(e),$("#ga_karten_div").css("max-width",t).css("max-height",e),$(".apf-resizable").resizable(),window.apf.olmap&&window.apf.olmap.map&&(window.apf.olmap.map.updateSize(),$("#olmap_layertree_layers").css("max-height",i)),"undefined"!=typeof google&&google.maps&&window.apf.gmap&&void 0!==window.apf.gmap.map&&google.maps.event.trigger(window.apf.gmap.map,"resize")):$("#forms").height("auto")},window.apf.olmap.blendeOlmapExportieren=function(){"use strict";var e,t,i;e=window.apf.olmap.map.getSize(),t=e[0]*e[1],t>5e5?($("#olmap_exportieren").button("disable"),i="Karte als png herunterladen<br>Diese Funktion ist inaktiv<br>Um sie zu aktivieren, müssen Sie die Karte verkleinern<br>Packen Sie dazu die untere rechte Ecke und ziehen Sie sie nach oben links"):($("#olmap_exportieren").button("enable"),i="Karte als png herunterladen"),$("#olmap_exportieren_div").tooltip({tooltipClass:"tooltip-styling-hinterlegt",content:i})},window.apf.berechneOlmapLayertreeMaxhöhe=function(){var e;return e=$(window).width()>1e3?$(window).height()-115:200},function(e){e.fn.hasScrollBar=function(){return this.get(0).scrollHeight>this.height()}}(jQuery),window.apf.fitTextareaToContent=function(e,t){"use strict";var i=e&&e.style?e:document.getElementById(e);if(i){i.clientHeight==i.scrollHeight&&(i.style.height="30px");var n=i.clientHeight;(!t||t>n)&&(n=Math.max(i.scrollHeight,n),t&&(n=Math.min(t,n)),n>i.clientHeight&&(i.style.height=n+"px"))}},window.apf.erstelle_ap_liste=function(e){"use strict";var t=$.Deferred(),i=$.ajax({type:"get",url:"php/apliste.php",dataType:"json",data:{programm:e}});return i.always(function(e){var i;i="<option></option>",_.each(e.rows,function(e){i+='<option value="'+e.id+'">'+e.ap_name+"</option>"}),$("#ap_waehlen").html(i),t.resolve()}),t.promise()},window.apf.wähleApListe=function(e){"use strict";var t=$.Deferred(),i=$("#ap_waehlen_label"),n=$("#ap_waehlen");return i.html("Daten werden aufbereitet..."),n.html(""),$("#ap").hide(),$("#forms").hide(),$("#tree").hide(),$("#suchen").hide(),$("#exportieren_2").hide(),$("#hilfe").hide(),$("#ap_loeschen").hide(),$("#exportieren_1").show(),n.val(""),window.apf.initiiere_ap(),$.when(window.apf.erstelle_ap_liste(e)).then(function(){var e=$("[name='programm_wahl']:checked");i.html("programm_neu"===e.attr("id")?"Art für neues Förderprogramm wählen:":"programm_ap"===e.attr("id")?"Aktionsplan wählen:":"Artförderprogramm wählen:"),i.show(),t.resolve()}),t.promise()},window.apf.erstelle_tree=function(e){"use strict";var t=$.Deferred();return $("#tree").jstree({json_data:{ajax:{url:"php/tree.php",progressive_render:!0,data:function(){return{id:e}}}},core:{open_parents:!0,strings:{loading:"hole Daten...",new_node:"neuer Knoten"}},ui:{select_limit:1,selected_parent_open:!0,select_prev_on_delete:!0},search:{case_insensitive:!0},sort:function(e,t){return $(e).attr("sort")&&$(t).attr("sort")?parseInt($(e).attr("sort"),10)>parseInt($(t).attr("sort"),10)?1:-1:void 0},themes:{icons:!1},contextmenu:{items:window.apf.treeKontextmenu,select_node:!0},crrm:{move:{default_position:"first",check_move:function(e){return"pop"===e.o.attr("typ")?"pop"===e.r.attr("typ")?{after:!0,before:!0,inside:!1}:!1:"tpop"===e.o.attr("typ")?"tpop"===e.r.attr("typ")?{after:!0,before:!0,inside:!1}:"pop_ordner_tpop"===e.r.attr("typ")?{after:!1,before:!1,inside:!0}:!1:"tpopmassn"===e.o.attr("typ")?"tpopmassn"===e.r.attr("typ")?{after:!0,before:!0,inside:!1}:"tpop_ordner_massn"===e.r.attr("typ")?{after:!1,before:!1,inside:!0}:!1:"tpopfeldkontr"===e.o.attr("typ")?"tpopfeldkontr"===e.r.attr("typ")?{after:!0,before:!0,inside:!1}:"tpop_ordner_feldkontr"===e.r.attr("typ")?{after:!1,before:!1,inside:!0}:!1:"tpopfreiwkontr"===e.o.attr("typ")?"tpopfreiwkontr"===e.r.attr("typ")?{after:!0,before:!0,inside:!1}:"tpop_ordner_freiwkontr"===e.r.attr("typ")?{after:!1,before:!1,inside:!0}:!1:"beob_zugeordnet"===e.o.attr("typ")?"beob_zugeordnet"===e.r.attr("typ")?{after:!0,before:!0,inside:!1}:"tpop_ordner_beob_zugeordnet"===e.r.attr("typ")?{after:!1,before:!1,inside:!0}:"ap_ordner_beob_nicht_beurteilt"===e.r.attr("typ")?{after:!1,before:!1,inside:!0}:"beob_nicht_beurteilt"===e.r.attr("typ")?{after:!0,before:!0,inside:!1}:"ap_ordner_beob_nicht_zuzuordnen"===e.r.attr("typ")?{after:!1,before:!1,inside:!0}:"beob_nicht_zuzuordnen"===e.r.attr("typ")?{after:!0,before:!0,inside:!1}:!1:"beob_nicht_beurteilt"===e.o.attr("typ")?"beob_zugeordnet"===e.r.attr("typ")?{after:!0,before:!0,inside:!1}:"tpop_ordner_beob_zugeordnet"===e.r.attr("typ")?{after:!1,before:!1,inside:!0}:"ap_ordner_beob_nicht_beurteilt"===e.r.attr("typ")?{after:!1,before:!1,inside:!0}:"beob_nicht_beurteilt"===e.r.attr("typ")?{after:!0,before:!0,inside:!1}:"ap_ordner_beob_nicht_zuzuordnen"===e.r.attr("typ")?{after:!1,before:!1,inside:!0}:"beob_nicht_zuzuordnen"===e.r.attr("typ")?{after:!0,before:!0,inside:!1}:!1:"beob_nicht_zuzuordnen"===e.o.attr("typ")?"beob_zugeordnet"===e.r.attr("typ")?{after:!0,before:!0,inside:!1}:"tpop_ordner_beob_zugeordnet"===e.r.attr("typ")?{after:!1,before:!1,inside:!0}:"ap_ordner_beob_nicht_beurteilt"===e.r.attr("typ")?{after:!1,before:!1,inside:!0}:"beob_nicht_beurteilt"===e.r.attr("typ")?{after:!0,before:!0,inside:!1}:"ap_ordner_beob_nicht_zuzuordnen"===e.r.attr("typ")?{after:!1,before:!1,inside:!0}:"beob_nicht_zuzuordnen"===e.r.attr("typ")?{after:!0,before:!0,inside:!1}:!1:!1}}},types:{type_attr:"typ",max_children:-2,max_depth:-2,valid_children:["ap_ordner_pop","ap_ordner_apziel","ap_ordner_erfkrit","ap_ordner_jber","ap_ordner_ber","ap_ordner_beob_nicht_beurteilt","ap_ordner_beob_nicht_zuzuordnen","idealbiotop","ap_ordner_assozarten"],types:{ap_ordner_pop:{valid_children:"pop"},pop:{valid_children:["pop_ordner_tpop","pop_ordner_popber","pop_ordner_massnber"],new_node:"neue Population"},pop_ordner_tpop:{valid_children:"tpop"},tpop:{valid_children:["tpop_ordner_massn","tpop_ordner_massnber","tpop_ordner_feldkontr","tpop_ordner_freiwkontr","tpop_ordner_tpopber","tpop_ordner_beob_zugeordnet"],new_node:"neue Teilpopulation"},tpop_ordner_massn:{valid_children:"tpopmassn"},tpopmassn:{valid_children:"none",new_node:"neue Massnahme"},tpop_ordner_massnber:{valid_children:"tpopmassnber"},tpopmassnber:{valid_children:"none",new_node:"neuer Massnahmen-Bericht"},tpop_ordner_feldkontr:{valid_children:"tpopfeldkontr"},tpopfeldkontr:{valid_children:"none",new_node:"neue Feldkontrolle"},tpop_ordner_freiwkontr:{valid_children:"tpopfreiwkontr"},tpopfreiwkontr:{valid_children:"none",new_node:"neue Freiwilligen-Kontrolle"},tpop_ordner_tpopber:{valid_children:"tpopber"},tpopber:{valid_children:"none",new_node:"neuer Teilpopulations-Bericht"},tpop_ordner_beob_zugeordnet:{valid_children:"beob_zugeordnet"},beob_zugeordnet:{valid_children:"none"},pop_ordner_popber:{valid_children:"popber"},popber:{valid_children:"none",new_node:"neuer Populations-Bericht"},pop_ordner_massnber:{valid_children:"massnber"},massnber:{valid_children:"none",new_node:"neuer Massnahmen-Bericht"},ap_ordner_apziel:{valid_children:"apzieljahr"},apzieljahr:{valid_children:"apziel"},apziel:{valid_children:"zielber_ordner",new_node:"neues AP-Ziel"},zielber_ordner:{valid_children:"zielber"},zielber:{valid_children:"none",new_node:"neuer Ziel-Bericht"},ap_ordner_erfkrit:{valid_children:"erfkrit"},erfkrit:{valid_children:"none",new_node:"neues Erfolgskriterium"},ap_ordner_jber:{valid_children:"jber"},jber:{valid_children:"jber_uebersicht",new_node:"neuer AP-Bericht"},jber_uebersicht:{valid_children:"none",new_node:"neue Übersicht zu allen Arten"},ap_ordner_ber:{valid_children:"ber"},ber:{valid_children:"none",new_node:"neuer Bericht"},ap_ordner_beob_nicht_beurteilt:{valid_children:"beob_nicht_beurteilt"},beob_nicht_beurteilt:{valid_children:"none"},ap_ordner_beob_nicht_zuzuordnen:{valid_children:"beob_nicht_zuzuordnen"},beob_nicht_zuzuordnen:{valid_children:"none"},idealbiotop:{valid_children:"none"},ap_ordner_assozarten:{valid_children:"assozarten"},assozarten:{valid_children:"none",new_node:"neue assoziierte Art"}}},plugins:["themes","json_data","ui","hotkeys","search","contextmenu","crrm","types"]}).show().bind("loaded.jstree",function(){t.resolve(),window.apf.setzeTreehöhe(),$("#suchen").show(),$("#exportieren_2").show(),$("#exportieren_1").hide(),$("#hilfe").show(),window.apf.pop_zeigen&&($("#tree").jstree("select_node","[typ='pop']#"+localStorage.pop_id),delete window.apf.pop_zeigen),window.apf.popber_zeigen&&($("#tree").jstree("select_node","[typ='popber']#"+localStorage.popber_id),delete window.apf.popber_zeigen),window.apf.popmassnber_zeigen&&($("#tree").jstree("select_node","[typ='popmassnber']#"+localStorage.popmassnber_id),delete window.apf.popmassnber_zeigen),window.apf.tpop_zeigen&&($("#tree").jstree("select_node","[typ='tpop']#"+localStorage.tpop_id),delete window.apf.tpop_zeigen),window.apf.tpopfeldkontr_zeigen&&($("#tree").jstree("select_node","[typ='tpopfeldkontr']#"+localStorage.tpopfeldkontr_id),delete window.apf.tpopfeldkontr_zeigen),window.apf.tpopfreiwkontr_zeigen&&($("#tree").jstree("select_node","[typ='tpopfreiwkontr']#"+localStorage.tpopfeldkontr_id),delete window.apf.tpopfreiwkontr_zeigen),window.apf.tpopmassn_zeigen&&($("#tree").jstree("select_node","[typ='tpopmassn']#"+localStorage.tpopmassn_id),delete window.apf.tpopmassn_zeigen),window.apf.tpopber_zeigen&&($("#tree").jstree("select_node","[typ='tpopber']#"+localStorage.tpopber_id),delete window.apf.tpopber_zeigen),window.apf.beob_zugeordnet_zeigen&&($("#tree").jstree("select_node","#beob"+localStorage.beob_id),delete window.apf.beob_zugeordnet_zeigen),window.apf.tpopmassnber_zeigen&&($("#tree").jstree("select_node","[typ='tpopmassnber']#"+localStorage.tpopmassnber_id),delete window.apf.tpopmassnber_zeigen),window.apf.apziel_zeigen&&($("#tree").jstree("select_node","[typ='apziel']#"+localStorage.apziel_id),delete window.apf.apziel_zeigen),window.apf.zielber_zeigen&&($("#tree").jstree("select_node","[typ='zielber']#"+localStorage.zielber_id),delete window.apf.zielber_zeigen),window.apf.erfkrit_zeigen&&($("#tree").jstree("select_node","[typ='erfkrit']#"+localStorage.erfkrit_id),delete window.apf.erfkrit_zeigen),window.apf.jber_zeigen&&($("#tree").jstree("select_node","[typ='jber']#"+localStorage.jber_id),delete window.apf.jber_zeigen),window.apf.jber_übersicht_zeigen&&($("#tree").jstree("select_node","[typ='jber_uebersicht']#"+localStorage.jber_uebersicht_id),delete window.apf.jber_übersicht_zeigen),window.apf.ber_zeigen&&($("#tree").jstree("select_node","[typ='ber']#"+localStorage.ber_id),delete window.apf.ber_zeigen),window.apf.idealbiotop_zeigen&&($("#tree").jstree("select_node","[typ='idealbiotop']#"+localStorage.idealbiotop_id),delete window.apf.idealbiotop_zeigen),window.apf.assozarten_zeigen&&($("#tree").jstree("select_node","[typ='assozarten']#"+localStorage.assozarten_id),delete window.apf.assozarten_zeigen),window.apf.beob_nicht_beurteilt_zeigen&&($("#tree").jstree("select_node","#beob"+localStorage.beob_id),delete window.apf.beob_nicht_beurteilt_zeigen),window.apf.beob_nicht_zuzuordnen_zeigen&&($("#tree").jstree("select_node","#beob"+localStorage.beob_id),delete window.apf.beob_nicht_zuzuordnen_zeigen),window.apf.ap_zeigen&&(window.apf.initiiere_ap(),delete window.apf.ap_zeigen)}).hammer().bind("hold doubletap",function(){$(window).width()<1e3&&setTimeout(function(){$("#tree").jstree("get_selected").children("a").trigger("contextmenu")},500)}).bind("select_node.jstree",function(e,t){var i;delete localStorage.tpopfreiwkontr,i=t.rslt.obj;var n=i.attr("typ"),o=window.apf.erstelleIdAusDomAttributId(i.attr("id"));$.jstree._reference(i).open_node(i),"ap_"===n.slice(0,3)||"apzieljahr"===n?$("#ap").is(":visible")&&localStorage.ap_id===o||(localStorage.ap_id=o,delete localStorage.pop_id,window.apf.initiiere_ap()):"pop"===n||"pop_"===n.slice(0,4)?$("#pop").is(":visible")&&localStorage.pop_id===o||(localStorage.pop_id=o,window.apf.initiiere_pop()):"apziel"===n||"zielber_ordner"===n?$("#apziel").is(":visible")&&localStorage.apziel_id===o||(localStorage.apziel_id=o,window.apf.initiiere_apziel()):"zielber"===n?$("#zielber").is(":visible")&&localStorage.zielber_id===o||(localStorage.zielber_id=o,window.apf.initiiere_zielber()):"erfkrit"===n?$("#erfkrit").is(":visible")&&localStorage.erfkrit_id===o||(localStorage.erfkrit_id=o,window.apf.initiiere_erfkrit()):"jber"===n?$("#jber").is(":visible")&&localStorage.jber_id===o||(localStorage.jber_id=o,window.apf.initiiere_jber()):"jber_uebersicht"===n?$("#jber_uebersicht").is(":visible")&&localStorage.jber_uebersicht_id===o||(localStorage.jber_uebersicht_id=o,window.apf.initiiere_jber_uebersicht()):"ber"===n?$("#ber").is(":visible")&&localStorage.ber_id===o||(localStorage.ber_id=o,window.apf.initiiere_ber()):"idealbiotop"===n?$("#idealbiotop").is(":visible")||window.apf.initiiere_idealbiotop():"assozarten"===n?$("#assozarten").is(":visible")&&localStorage.assozarten_id===o||(localStorage.assozarten_id=o,window.apf.initiiere_assozarten()):"popber"===n?$("#popber").is(":visible")&&localStorage.popber_id===o||(localStorage.popber_id=o,window.apf.initiiere_popber()):"popmassnber"===n?$("#popmassnber").is(":visible")&&localStorage.popmassnber_id===o||(localStorage.popmassnber_id=o,window.apf.initiiere_popmassnber()):"tpop"===n||"tpop_"===n.slice(0,5)?$("#tpop").is(":visible")&&localStorage.tpop_id===o||(localStorage.tpop_id=o,window.apf.initiiere_tpop()):"tpopfeldkontr"===n?$("#tpopfeldkontr").is(":visible")&&localStorage.tpopfeldkontr_id===o||(localStorage.tpopfeldkontr_id=o,window.apf.initiiere_tpopfeldkontr()):"tpopfreiwkontr"===n?$("#tpopfeldkontr").is(":visible")&&localStorage.tpopfeldkontr_id===o||(localStorage.tpopfeldkontr_id=o,localStorage.tpopfreiwkontr=!0,window.apf.initiiere_tpopfeldkontr()):"tpopmassn"===n?$("#tpopmassn").is(":visible")&&localStorage.tpopmassn_id===o||(localStorage.tpopmassn_id=o,window.apf.initiiere_tpopmassn()):"tpopber"===n?$("#tpopber").is(":visible")&&localStorage.tpopber_id===o||(localStorage.tpopber_id=o,window.apf.initiiereTpopber()):"beob_zugeordnet"===n?$("#beob").is(":visible")&&localStorage.beob_id===o&&"zugeordnet"===localStorage.beob_status||(localStorage.beob_id=o,localStorage.beobtyp=i.attr("beobtyp"),window.apf.initiiere_beob(i.attr("beobtyp"),o,"zugeordnet")):"beob_nicht_beurteilt"===n?$("#beob").is(":visible")&&localStorage.beob_id===o&&"nicht_beurteilt"===localStorage.beob_status||(localStorage.beob_id=o,localStorage.beobtyp=i.attr("beobtyp"),window.apf.initiiere_beob(i.attr("beobtyp"),o,"nicht_beurteilt")):"beob_nicht_zuzuordnen"===n?$("#beob").is(":visible")&&localStorage.beob_id===o&&"nicht_zuzuordnen"===localStorage.beob_status||(localStorage.beob_id=o,localStorage.beobtyp=i.attr("beobtyp"),window.apf.initiiere_beob(i.attr("beobtyp"),o,"nicht_zuzuordnen")):"tpopmassnber"===n&&($("#tpopmassnber").is(":visible")&&localStorage.tpopmassnber_id===o||(localStorage.tpopmassnber_id=o,window.apf.initiiere_tpopmassnber()))
}).bind("after_open.jstree",function(){window.apf.setzeTreehöhe()}).bind("after_close.jstree",function(){window.apf.setzeTreehöhe()}).bind("prepare_move.jstree",function(e,t){window.apf.herkunft_parent_node=$.jstree._reference(t.rslt.o)._get_parent(t.rslt.o)}).bind("create_node.jstree",function(e,t){if("apzieljahr"===t.rslt.parent[0].attributes.typ.nodeValue){var i={};i.name="ZielJahr",i.formular="apziel",window.apf.speichern(i),$("#ZielJahr").val(t.rslt.parent[0].innerText.slice(1,5)).focus()}}).bind("move_node.jstree",function(e,t){var i,n,o,a,s,r,l,p;if(window.apf.prüfeSchreibvoraussetzungen()){if(i=t.rslt.o,n=window.apf.erstelleIdAusDomAttributId($(i).attr("id")),o=i.attr("typ"),a=t.rslt.r,s=window.apf.erstelleIdAusDomAttributId($(a).attr("id")),r=a.attr("typ"),l=$.jstree._reference(t.rslt.r)._get_parent(t.rslt.r),$(l).attr("id")&&(p=window.apf.erstelleIdAusDomAttributId($(l).attr("id"))),"pop"===o){if("pop"===r){var h=$.ajax({type:"post",url:"php/pop_einfuegen.php",dataType:"json",data:{ap_art_id:p,pop_id:s,user:sessionStorage.User}});h.always(function(){window.apf.beschrifte_ordner_pop(l),window.apf.beschrifte_ordner_pop(window.apf.herkunft_parent_node),$.jstree._reference(a).deselect_all(),$.jstree._reference(i).select_node(i),localStorage.pop_id=n,delete window.apf.pop,delete window.apf.herkunft_parent_node,window.apf.initiiere_pop()}),h.fail(function(){console.log("Fehler: Die Teilpopulation wurde nicht verschoben")})}if("tpop"===r){var d=$.ajax({type:"post",url:"php/tpop_einfuegen.php",dataType:"json",data:{pop_id:p,tpop_id:s,user:sessionStorage.User}});d.always(function(){window.apf.beschrifte_ordner_tpop(l),window.apf.beschrifte_ordner_tpop(window.apf.herkunft_parent_node),$.jstree._reference(a).deselect_all(),$.jstree._reference(i).select_node(i),localStorage.tpop_id=n,delete window.apf.tpop,delete window.apf.tpop_node_ausgeschnitten,delete window.apf.herkunft_parent_node,window.apf.initiiere_tpop()}),d.fail(function(){console.log("Fehler: Die Teilpopulation wurde nicht verschoben")})}if("pop_ordner_tpop"===r){var c=$.ajax({type:"post",url:"php/tpop_einfuegen.php",dataType:"json",data:{pop_id:s,tpop_id:n,user:sessionStorage.User}});c.always(function(){window.apf.beschrifte_ordner_tpop(a),window.apf.beschrifte_ordner_tpop(window.apf.herkunft_parent_node),$.jstree._reference(a).deselect_all(),$.jstree._reference(a).select_node(i),localStorage.tpop_id=n,delete window.apf.tpop,delete window.apf.tpop_node_ausgeschnitten,window.apf.initiiere_tpop()}),c.fail(function(){console.log("Fehler: Die Teilpopulation wurde nicht verschoben")})}}if("tpop"===o){if("tpop"===r){var u=$.ajax({type:"post",url:"php/tpop_einfuegen.php",dataType:"json",data:{pop_id:p,tpop_id:n,user:sessionStorage.User}});u.always(function(){window.apf.beschrifte_ordner_tpop(l),window.apf.beschrifte_ordner_tpop(window.apf.herkunft_parent_node),$.jstree._reference(i).deselect_all(),$.jstree._reference(l).select_node(i),localStorage.tpop_id=n,delete window.apf.tpop,delete window.apf.tpop_node_ausgeschnitten,delete window.apf.herkunft_parent_node,window.apf.initiiere_tpop()}),u.fail(function(){console.log("Fehler: Die Teilpopulation wurde nicht verschoben")})}if("pop_ordner_tpop"===r){var f=$.ajax({type:"post",url:"php/tpop_einfuegen.php",dataType:"json",data:{pop_id:s,tpop_id:n,user:sessionStorage.User}});f.always(function(){window.apf.beschrifte_ordner_tpop(a),window.apf.beschrifte_ordner_tpop(window.apf.herkunft_parent_node),$.jstree._reference(i).deselect_all(),$.jstree._reference(i).select_node(i),localStorage.tpop_id=n,delete window.apf.tpop,delete window.apf.tpop_node_ausgeschnitten,delete window.apf.herkunft_parent_node,window.apf.initiiere_tpop()}),f.fail(function(){console.log("Fehler: Die Teilpopulation wurde nicht verschoben")})}}if("tpopmassn"===o){if("tpopmassn"===r){var g=$.ajax({type:"post",url:"php/tpopmassn_einfuegen.php",dataType:"json",data:{tpop_id:p,tpopmassn_id:n,user:sessionStorage.User}});g.always(function(){window.apf.beschrifte_ordner_tpopmassn(l),window.apf.beschrifte_ordner_tpopmassn(window.apf.herkunft_parent_node),$.jstree._reference(i).deselect_all(),$.jstree._reference(l).select_node(i),localStorage.tpopmassn_id=n,delete window.apf.tpopmassn,delete window.apf.tpopmassn_node_ausgeschnitten,delete window.apf.herkunft_parent_node,window.apf.initiiere_tpopmassn()}),g.fail(function(){console.log("Fehler: Die Massnahme wurde nicht verschoben")})}if("tpop_ordner_massn"===r){var m=$.ajax({type:"post",url:"php/tpopmassn_einfuegen.php",dataType:"json",data:{tpop_id:s,tpopmassn_id:n,user:sessionStorage.User}});m.always(function(){window.apf.beschrifte_ordner_tpopmassn(a),window.apf.beschrifte_ordner_tpopmassn(window.apf.herkunft_parent_node),$.jstree._reference(i).deselect_all(),$.jstree._reference(i).select_node(i),localStorage.tpopmassn_id=n,delete window.apf.tpopmassn,delete window.apf.tpopmassn_node_ausgeschnitten,delete window.apf.herkunft_parent_node,window.apf.initiiere_tpopmassn()}),m.fail(function(){console.log("Fehler: Die Massnahme wurde nicht verschoben")})}}if("tpopfeldkontr"===o){if("tpopfeldkontr"===r){var _=$.ajax({type:"post",url:"php/tpopfeldkontr_einfuegen.php",dataType:"json",data:{tpop_id:p,tpopfeldkontr_id:n,user:sessionStorage.User}});_.always(function(){window.apf.beschrifte_ordner_tpopfeldkontr(l),window.apf.beschrifte_ordner_tpopfeldkontr(window.apf.herkunft_parent_node),$.jstree._reference(i).deselect_all(),$.jstree._reference(i).select_node(i),localStorage.tpopfeldkontr_id=n,delete window.apf.tpopfeldkontr,delete window.apf.tpopfeldkontr_node_ausgeschnitten,delete window.apf.herkunft_parent_node,window.apf.initiiere_tpopfeldkontr()}),_.fail(function(){console.log("Fehler: Die Feldkontrolle wurde nicht verschoben")})}if("tpop_ordner_feldkontr"===r){var w=$.ajax({type:"post",url:"php/tpopfeldkontr_einfuegen.php",dataType:"json",data:{tpop_id:s,tpopfeldkontr_id:n,user:sessionStorage.User}});w.always(function(){window.apf.beschrifte_ordner_tpopfeldkontr(a),window.apf.beschrifte_ordner_tpopfeldkontr(window.apf.herkunft_parent_node),$.jstree._reference(i).deselect_all(),$.jstree._reference(i).select_node(i),localStorage.tpopfeldkontr_id=n,delete window.apf.tpopfeldkontr,delete window.apf.tpopfeldkontr_node_ausgeschnitten,delete window.apf.herkunft_parent_node,window.apf.initiiere_tpopfeldkontr()}),w.fail(function(){console.log("Fehler: Die Feldkontrolle wurde nicht verschoben")})}}if("tpopfreiwkontr"===o){if("tpopfreiwkontr"===r){var b=$.ajax({type:"post",url:"php/tpopfeldkontr_einfuegen.php",dataType:"json",data:{tpop_id:p,tpopfeldkontr_id:n,user:sessionStorage.User}});b.always(function(){window.apf.beschrifte_ordner_tpopfreiwkontr(l),window.apf.beschrifte_ordner_tpopfreiwkontr(window.apf.herkunft_parent_node),$.jstree._reference(i).deselect_all(),$.jstree._reference(i).select_node(i),localStorage.tpopfeldkontr_id=n,delete window.apf.tpopfeldkontr,delete window.apf.tpopfreiwkontr_node_ausgeschnitten,delete window.apf.herkunft_parent_node,localStorage.tpopfreiwkontr=!0,window.apf.initiiere_tpopfeldkontr()}),b.fail(function(){console.log("Fehler: Die Freiwilligen-Kontrolle wurde nicht verschoben")})}if("tpop_ordner_freiwkontr"===r){var v=$.ajax({type:"post",url:"php/tpopfeldkontr_einfuegen.php",dataType:"json",data:{tpop_id:s,tpopfeldkontr_id:n,user:sessionStorage.User}});v.always(function(){window.apf.beschrifte_ordner_tpopfreiwkontr(a),window.apf.beschrifte_ordner_tpopfreiwkontr(window.apf.herkunft_parent_node),$.jstree._reference(i).deselect_all(),$.jstree._reference(i).select_node(i),localStorage.tpopfeldkontr_id=n,delete window.apf.tpopfeldkontr,delete window.apf.tpopfreiwkontr_node_ausgeschnitten,delete window.apf.herkunft_parent_node,localStorage.tpopfreiwkontr=!0,window.apf.initiiere_tpopfeldkontr()}),v.fail(function(){console.log("Fehler: Die Freiwilligen-Kontrolle wurde nicht verschoben")})}}if("beob_zugeordnet"===o){if("beob_nicht_beurteilt"===r||"ap_ordner_beob_nicht_beurteilt"===r){var y=$.ajax({type:"post",url:"php/beob_zuordnung_delete.php",dataType:"json",data:{id:n}});y.always(function(){i.attr("typ","beob_nicht_beurteilt"),localStorage.beobtyp="beob_nicht_beurteilt",window.apf.beschrifte_ordner_beob_nicht_beurteilt("beob_nicht_beurteilt"===r?l:a),window.apf.beschrifte_ordner_beob_zugeordnet(window.apf.herkunft_parent_node),window.apf.initiiere_beob(i.attr("beobtyp"),n,"nicht_beurteilt"),delete window.apf.beob_zugeordnet_node_ausgeschnitten,delete window.apf.herkunft_parent_node}),y.fail(function(){console.log("Fehler: Die Beobachtung wurde nicht auf 'nicht beurteilt' gesetzt")})}if("beob_zugeordnet"===r||"tpop_ordner_beob_zugeordnet"===r){S="tpop_ordner_beob_zugeordnet"===r?s:p;var k=$.ajax({type:"post",url:"php/beob_update.php",dataType:"json",data:{id:localStorage.beob_id,Feld:"TPopId",Wert:S,user:sessionStorage.User}});k.always(function(){window.apf.beschrifte_ordner_beob_zugeordnet("tpop_ordner_beob_zugeordnet"===r?a:l),window.apf.beschrifte_ordner_beob_zugeordnet(window.apf.herkunft_parent_node),localStorage.karte_fokussieren?delete localStorage.karte_fokussieren:window.apf.initiiere_beob(i.attr("beobtyp"),n,"zugeordnet"),delete window.apf.beob_zugeordnet_node_ausgeschnitten,delete window.apf.herkunft_parent_node}),k.fail(function(){console.log("Fehler: Die Beobachtung wurde nicht verschoben")})}if("beob_nicht_zuzuordnen"===r||"ap_ordner_beob_nicht_zuzuordnen"===r){var x=$.ajax({type:"post",url:"php/beob_update.php",dataType:"json",data:{id:n,Feld:"BeobNichtZuordnen",Wert:1,user:sessionStorage.User}});x.always(function(){var e=$.ajax({type:"post",url:"php/beob_update.php",dataType:"json",data:{id:n,Feld:"TPopId",Wert:"",user:sessionStorage.User}});e.always(function(){i.attr("typ","beob_nicht_zuzuordnen"),localStorage.beobtyp="beob_nicht_zuzuordnen",window.apf.beschrifte_ordner_beob_nicht_zuzuordnen("ap_ordner_beob_nicht_zuzuordnen"===r?a:l),window.apf.beschrifte_ordner_beob_zugeordnet(window.apf.herkunft_parent_node),window.apf.initiiere_beob(i.attr("beobtyp"),n,"nicht_zuzuordnen"),delete window.apf.beob_node_ausgeschnitten,delete window.apf.herkunft_parent_node}),e.fail(function(){console.log("fehler beim Leeren von TPopId")})}),x.fail(function(){console.log("Fehler: Die Beobachtung wurde nicht verschoben")})}}if("beob_nicht_beurteilt"===o){if("beob_zugeordnet"===r||"tpop_ordner_beob_zugeordnet"===r){S="tpop_ordner_beob_zugeordnet"===r?s:p;var M=$.ajax({type:"post",url:"php/beob_zuordnung_insert.php",dataType:"json",data:{no_note:n,user:sessionStorage.User}});M.always(function(){var e=$.ajax({type:"post",url:"php/beob_update.php",dataType:"json",data:{id:n,Feld:"TPopId",Wert:S,user:sessionStorage.User}});e.always(function(){i.attr("typ","beob_zugeordnet"),localStorage.beobtyp="beob_zugeordnet",window.apf.beschrifte_ordner_beob_nicht_beurteilt(window.apf.herkunft_parent_node),window.apf.beschrifte_ordner_beob_zugeordnet("tpop_ordner_beob_zugeordnet"===r?a:l),localStorage.karte_fokussieren?delete localStorage.karte_fokussieren:window.apf.initiiere_beob(i.attr("beobtyp"),n,"zugeordnet"),delete window.apf.beob_node_ausgeschnitten,delete window.apf.herkunft_parent_node}),e.fail(function(){console.log("Fehler: Die Beobachtung wurde nicht zugeordnet")})}),M.fail(function(){console.log("Fehler: Die Beobachtung wurde nicht zugeordnet")})}if("beob_nicht_zuzuordnen"===r||"ap_ordner_beob_nicht_zuzuordnen"===r){var T=$.ajax({type:"post",url:"php/beob_zuordnung_insert.php",dataType:"json",data:{no_note:n,user:sessionStorage.User}});T.always(function(){var e=$.ajax({type:"post",url:"php/beob_update.php",dataType:"json",data:{id:n,Feld:"BeobNichtZuordnen",Wert:1,user:sessionStorage.User}});e.always(function(){$(i).attr("typ","beob_nicht_zuzuordnen"),localStorage.beobtyp="beob_nicht_zuzuordnen",window.apf.beschrifte_ordner_beob_nicht_beurteilt(window.apf.herkunft_parent_node),window.apf.beschrifte_ordner_beob_nicht_zuzuordnen("ap_ordner_beob_nicht_zuzuordnen"===r?a:l),window.apf.initiiere_beob(i.attr("beobtyp"),n,"nicht_zuzuordnen"),delete window.apf.beob_node_ausgeschnitten,delete window.apf.herkunft_parent_node}),e.fail(function(){console.log("Fehler: Die Beobachtung wurde nicht zugeordnet")})}),T.fail(function(){console.log("Fehler: Die Beobachtung wurde nicht zugeordnet")})}}if("beob_nicht_zuzuordnen"===o){if("beob_nicht_beurteilt"===r||"ap_ordner_beob_nicht_beurteilt"===r){var P=$.ajax({type:"post",url:"php/beob_zuordnung_delete.php",dataType:"json",data:{id:n}});P.always(function(){$(i).attr("typ","beob_nicht_beurteilt"),localStorage.beobtyp="beob_nicht_beurteilt",window.apf.beschrifte_ordner_beob_nicht_zuzuordnen(window.apf.herkunft_parent_node),window.apf.beschrifte_ordner_beob_nicht_beurteilt("ap_ordner_beob_nicht_beurteilt"===r?a:l),window.apf.initiiere_beob(i.attr("beobtyp"),n,"nicht_beurteilt"),delete window.apf.beob_node_ausgeschnitten,delete window.apf.herkunft_parent_node}),P.fail(function(){console.log("Fehler: Die Zuordnung der Beobachtung wurde nicht entfernt")})}if("beob_zugeordnet"===r||"tpop_ordner_beob_zugeordnet"===r){var S;S="tpop_ordner_beob_zugeordnet"===r?s:p;var I=$.ajax({type:"post",url:"php/beob_update.php",dataType:"json",data:{id:n,Feld:"BeobNichtZuordnen",Wert:"",user:sessionStorage.User}});I.always(function(){var e=$.ajax({type:"post",url:"php/beob_update.php",dataType:"json",data:{id:n,Feld:"TPopId",Wert:S,user:sessionStorage.User}});e.always(function(){$(i).attr("typ","beob_zugeordnet"),localStorage.beobtyp="beob_zugeordnet",window.apf.beschrifte_ordner_beob_nicht_zuzuordnen(window.apf.herkunft_parent_node),window.apf.beschrifte_ordner_beob_zugeordnet("tpop_ordner_beob_zugeordnet"===r?a:l),window.apf.initiiere_beob(i.attr("beobtyp"),n,"zugeordnet"),delete window.apf.beob_node_ausgeschnitten,delete window.apf.herkunft_parent_node}),e.fail(function(){console.log("Fehler: Die Beobachtung wurde nicht zugeordnet")})}),I.fail(function(){console.log("Fehler: Die Beobachtung wurde nicht zugeordnet")})}}}}),t.promise()},window.apf.beschrifte_ordner_pop=function(e){"use strict";var t=$(e).find("> ul > li").length,i="Populationen ("+t+")";$.jstree._reference(e).rename_node(e,i)},window.apf.beschrifte_ordner_apziel=function(e){"use strict";var t,i=0;$($.jstree._reference(e)._get_children(e)).each(function(){$($(this).find("> ul > li")).each(function(){i+=1})}),t="AP-Ziele ("+i+")",$.jstree._reference(e).rename_node(e,t)},window.apf.beschrifte_ordner_apzieljahr=function(e){"use strict";var t,i=$(e).find("> ul > li").length;t=$.jstree._reference(e).get_text(e).slice(0,6),t+=i+")",$.jstree._reference(e).rename_node(e,t)},window.apf.beschrifte_ordner_zielber=function(e){"use strict";var t=$(e).find("> ul > li").length,i="Ziel-Berichte ("+t+")";$.jstree._reference(e).rename_node(e,i)},window.apf.beschrifte_ordner_erfkrit=function(e){"use strict";var t=$(e).find("> ul > li").length,i="AP-Erfolgskriterien ("+t+")";$.jstree._reference(e).rename_node(e,i)},window.apf.beschrifte_ordner_jber=function(e){"use strict";var t=$(e).find("> ul > li").length,i="AP-Berichte ("+t+")";$.jstree._reference(e).rename_node(e,i)},window.apf.beschrifte_ordner_ber=function(e){"use strict";var t=$(e).find("> ul > li").length,i="Berichte ("+t+")";$.jstree._reference(e).rename_node(e,i)},window.apf.beschrifte_ordner_assozarten=function(e){"use strict";var t=$(e).find("> ul > li").length,i="assoziierte Arten ("+t+")";$.jstree._reference(e).rename_node(e,i)},window.apf.beschrifte_ordner_tpop=function(e){"use strict";var t=$(e).find("> ul > li").length,i="Teilpopulationen ("+t+")";$.jstree._reference(e).rename_node(e,i)},window.apf.beschrifte_ordner_popber=function(e){"use strict";var t=$(e).find("> ul > li").length,i="Populations-Berichte ("+t+")";$.jstree._reference(e).rename_node(e,i)},window.apf.beschrifte_ordner_popmassnber=function(e){"use strict";var t=$(e).find("> ul > li").length,i="Massnahmen-Berichte ("+t+")";$.jstree._reference(e).rename_node(e,i)},window.apf.beschrifte_ordner_tpopmassnber=function(e){"use strict";var t=$(e).find("> ul > li").length,i="Massnahmen-Berichte ("+t+")";$.jstree._reference(e).rename_node(e,i)},window.apf.beschrifte_ordner_tpopmassn=function(e){"use strict";var t=$(e).find("> ul > li").length,i="Massnahmen ("+t+")";$.jstree._reference(e).rename_node(e,i)},window.apf.beschrifte_ordner_tpopber=function(e){"use strict";var t=$(e).find("> ul > li").length,i="Teilpopulations-Berichte ("+t+")";$.jstree._reference(e).rename_node(e,i)},window.apf.beschrifte_ordner_tpopfeldkontr=function(e){"use strict";var t=$(e).find("> ul > li").length,i="Feldkontrollen ("+t+")";$.jstree._reference(e).rename_node(e,i)},window.apf.beschrifte_ordner_tpopfreiwkontr=function(e){"use strict";var t=$(e).find("> ul > li").length,i="Freiwilligen-Kontrollen ("+t+")";$.jstree._reference(e).rename_node(e,i)},window.apf.beschrifte_ordner_beob_zugeordnet=function(e){"use strict";var t=$(e).find("> ul > li").length,i="Beobachtungen ("+t+")";$.jstree._reference(e).rename_node(e,i)},window.apf.beschrifte_ordner_beob_nicht_beurteilt=function(e){"use strict";var t=$(e).find("> ul > li").length,i="nicht beurteilte Beobachtungen ("+t+")";$.jstree._reference(e).rename_node(e,i)},window.apf.beschrifte_ordner_beob_nicht_zuzuordnen=function(e){"use strict";var t=$(e).find("> ul > li").length,i="nicht zuzuordnende Beobachtungen ("+t+")";$.jstree._reference(e).rename_node(e,i)},window.apf.treeKontextmenu=function(e){"use strict";var t,i,n,o,a,s;switch(i=$("#tree").jstree("get_selected"),n=$.jstree._reference(i).get_text(i),"ap_ordner"!==$(i).attr("typ").slice(0,9)&&"idealbiotop"!==$(i).attr("typ")&&(o=$.jstree._reference(i)._get_parent(i),a=$.jstree._reference(o).get_text(o)),$(i).attr("typ")){case"ap_ordner_pop":return t={untergeordneteKnotenOeffnen:{label:"untergeordnete Knoten öffnen",icon:"style/images/tree16x16.png",action:function(){$.jstree._reference(e).open_all(e)}},neu:{label:"neue Population",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/pop_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id")),typ:"pop",user:sessionStorage.User}});e.always(function(e){var t="pop",n="neue Population";window.apf.insertNeuenNodeEineHierarchiestufeTiefer(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Keine neue Population erstellt")})}},GeoAdminMaps:{label:"auf CH-Karten zeigen",separator_before:!0,icon:"style/images/flora_icon_gelb.png",action:function(){var e=$.ajax({type:"get",url:"php/pops_ch_karte.php",dataType:"json",data:{ApArtId:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});e.always(function(e){e.rows.length>0?window.apf.zeigePopAufOlmap():window.apf.melde("Die Population hat keine Koordinaten","Aktion abgebrochen")}),e.fail(function(){console.log("Fehler: Keine Daten erhalten")})}},GoogleMaps:{label:"auf Google-Karten zeigen",separator_before:!0,icon:"style/images/flora_icon.png",action:function(){var e=$.ajax({type:"get",url:"php/ap_karte.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});e.always(function(e){e.rows.length>0?window.apf.gmap.zeigeTPop(e):window.apf.melde("Es gibt keine Teilpopulation mit Koordinaten","Aktion abgebrochen")}),e.fail(function(){console.log("Fehler: Keine Daten erhalten")})}}},window.apf.pop_zum_verschieben_gemerkt&&(t.einfuegen={label:"'"+window.apf.pop_bezeichnung+"' einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){var e=$.ajax({type:"post",url:"php/pop_update.php",dataType:"json",data:{id:window.apf.pop_id,Feld:"ApArtId",Wert:window.apf.erstelleIdAusDomAttributId($(i).attr("id")),user:sessionStorage.User}});e.always(function(){$.when(window.apf.erstelle_tree(window.apf.erstelleIdAusDomAttributId($(i).attr("id")))).then(function(){$("#tree").jstree("select_node","[typ='pop']#"+localStorage.pop_id)}),delete window.apf.pop_zum_verschieben_gemerkt,delete window.apf.pop_bezeichnung,delete window.apf.pop_id}),e.fail(function(){console.log("Fehler: Die Population wurde nicht verschoben")})}}),t;case"ap_ordner_apziel":return t={untergeordneteKnotenOeffnen:{label:"untergeordnete Knoten öffnen",icon:"style/images/tree16x16.png",action:function(){$.jstree._reference(e).open_all(e)}},neu:{label:"neues Ziel",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/apziel_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id")),typ:"apziel",user:sessionStorage.User}});e.always(function(e){var t="apziel",n="neues Ziel";localStorage.apziel_von_ordner_apziel=!0,delete localStorage.apziel_von_apzieljahr,window.apf.insertNeuenNodeEineHierarchiestufeTiefer(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Keine neues AP-Ziel erstellt")})}}};case"apzieljahr":return t={untergeordneteKnotenOeffnen:{label:"untergeordnete Knoten öffnen",icon:"style/images/tree16x16.png",action:function(){$.jstree._reference(e).open_all(e)}},neu:{label:"neues Ziel",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/apziel_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(o).attr("id")),typ:"apziel",user:sessionStorage.User}});e.always(function(e){var t="apziel",n="neues Ziel";localStorage.apziel_von_apzieljahr=!0,delete localStorage.apziel_von_ordner_apziel,window.apf.insertNeuenNodeEineHierarchiestufeTiefer(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Keine neues Ziel erstellt")})}}};case"apziel":return t={neu:{label:"neues Ziel",icon:"style/images/neu.png",action:function(){if(window.apf.prüfeSchreibvoraussetzungen()){s=$.jstree._reference(o)._get_parent(o);var e=$.ajax({type:"post",url:"php/apziel_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(s).attr("id")),user:sessionStorage.User}});e.always(function(e){var t="apziel",n="neues Ziel";window.apf.insertNeuenNodeAufGleicherHierarchiestufe(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Kein neues AP-Ziel erstellt")})}}},loeschen:{label:"löschen",separator_before:!0,icon:"style/images/loeschen.png",action:function(){if(window.apf.prüfeSchreibvoraussetzungen()){$.jstree._reference(i).deselect_all(),$.jstree._reference(i).open_all(i),$.jstree._reference(i).deselect_all(),$.jstree._reference(i).select_node(i);var e=$.jstree._reference(i).get_text(i);$("#loeschen_dialog_mitteilung").html("Das AP-Ziel '"+e+"' wird gelöscht."),$("#loeschen_dialog").dialog({resizable:!1,height:"auto",width:400,modal:!0,buttons:{"ja, löschen!":function(){$(this).dialog("close"),window.apf.deleted=window.apf.apziel,window.apf.deleted.typ="apziel";var t=$.ajax({type:"post",url:"php/apziel_delete.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});t.always(function(){delete localStorage.apziel_id,delete window.apf.apziel,$.jstree._reference(i).delete_node(i),s=$.jstree._reference(o)._get_parent(o),window.apf.beschrifte_ordner_apziel(s),"neue AP-Ziele"!==$.jstree._reference(o).get_text(o)&&window.apf.beschrifte_ordner_apzieljahr(o),window.apf.frageObAktionRückgängigGemachtWerdenSoll("Das AP-Ziel '"+e+"' wurde gelöscht.")}),t.fail(function(){console.log("Fehler: Das AP-Ziel wurde nicht gelöscht")})},abbrechen:function(){$(this).dialog("close")}}})}}}};case"zielber_ordner":return t={neu:{label:"neuer Ziel-Bericht",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/zielber_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id")),user:sessionStorage.User}});e.always(function(e){var t="zielber",n="neuer Ziel-Bericht";window.apf.insertNeuenNodeEineHierarchiestufeTiefer(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Keinen neuen Ziel-Bericht erstellt")})}}};case"zielber":return t={neu:{label:"neuer Ziel-Bericht",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/zielber_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(o).attr("id")),typ:"zielber",user:sessionStorage.User}});e.always(function(e){var t="zielber",n="neuer Ziel-Bericht";window.apf.insertNeuenNodeAufGleicherHierarchiestufe(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Keinen neuen Ziel-Bericht erstellt")})}},loeschen:{label:"löschen",separator_before:!0,icon:"style/images/loeschen.png",action:function(){if(window.apf.prüfeSchreibvoraussetzungen()){$.jstree._reference(i).deselect_all(),$.jstree._reference(i).open_all(i),$.jstree._reference(i).deselect_all(),$.jstree._reference(i).select_node(i);var e=$.jstree._reference(i).get_text(i);$("#loeschen_dialog_mitteilung").html("Der Ziel-Bericht '"+e+"' wird gelöscht."),$("#loeschen_dialog").dialog({resizable:!1,height:"auto",width:400,modal:!0,buttons:{"ja, löschen!":function(){$(this).dialog("close"),window.apf.deleted=window.apf.zielber,window.apf.deleted.typ="zielber";var t=$.ajax({type:"post",url:"php/zielber_delete.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});t.always(function(){delete localStorage.zielber_id,delete window.apf.zielber,$.jstree._reference(i).delete_node(i),window.apf.beschrifte_ordner_zielber(o),window.apf.frageObAktionRückgängigGemachtWerdenSoll("Der Ziel-Bericht '"+e+"' wurde gelöscht.")}),t.fail(function(){console.log("Fehler: Der Ziel-Bericht wurde nicht gelöscht")})},abbrechen:function(){$(this).dialog("close")}}})}}}};case"ap_ordner_erfkrit":return t={neu:{label:"neues Erfolgskriterium",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/erfkrit_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id")),user:sessionStorage.User}});e.always(function(e){var t="erfkrit",n="neues Erfolgskriterium";window.apf.insertNeuenNodeEineHierarchiestufeTiefer(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Kein neues Erfolgskriterium erstellt")})}}};case"erfkrit":return t={neu:{label:"neues Erfolgskriterium",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/erfkrit_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(o).attr("id")),typ:"erfkrit",user:sessionStorage.User}});e.always(function(e){var t="erfkrit",n="neues Erfolgskriterium";window.apf.insertNeuenNodeAufGleicherHierarchiestufe(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Kein neues Erfolgskriterium erstellt")})}},loeschen:{label:"löschen",separator_before:!0,icon:"style/images/loeschen.png",action:function(){if(window.apf.prüfeSchreibvoraussetzungen()){$.jstree._reference(i).deselect_all(),$.jstree._reference(i).open_all(i),$.jstree._reference(i).deselect_all(),$.jstree._reference(i).select_node(i);var e=$.jstree._reference(i).get_text(i);$("#loeschen_dialog_mitteilung").html("Das Erfolgskriterium '"+e+"' wird gelöscht."),$("#loeschen_dialog").dialog({resizable:!1,height:"auto",width:400,modal:!0,buttons:{"ja, löschen!":function(){$(this).dialog("close"),window.apf.deleted=window.apf.erfkrit,window.apf.deleted.typ="erfkrit";var t=$.ajax({type:"post",url:"php/erfkrit_delete.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});t.always(function(){delete localStorage.erfkrit_id,delete window.apf.erfkrit,$.jstree._reference(i).delete_node(i),window.apf.beschrifte_ordner_erfkrit(o),window.apf.frageObAktionRückgängigGemachtWerdenSoll("Das Erfolgskriterium '"+e+"' wurde gelöscht.")}),t.fail(function(){console.log("Fehler: Das Erfolgskriterium wurde nicht gelöscht")})},abbrechen:function(){$(this).dialog("close")}}})}}}};case"ap_ordner_jber":return t={untergeordneteKnotenOeffnen:{label:"untergeordnete Knoten öffnen",icon:"style/images/tree16x16.png",action:function(){$.jstree._reference(e).open_all(e)}},neu:{label:"neuer AP-Bericht",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/jber_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id")),user:sessionStorage.User}});e.always(function(e){var t="jber",n="neuer AP-Bericht";window.apf.insertNeuenNodeEineHierarchiestufeTiefer(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Keinen neuen AP-Bericht erstellt")})}}};case"jber":return t={neu:{label:"neuer AP-Bericht",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/jber_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(o).attr("id")),typ:"jber",user:sessionStorage.User}});e.always(function(e){var t="jber",n="neuer AP-Bericht";window.apf.insertNeuenNodeAufGleicherHierarchiestufe(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Keinen neuen AP-Bericht erstellt")})}},loeschen:{label:"löschen",separator_before:!0,icon:"style/images/loeschen.png",action:function(){if(window.apf.prüfeSchreibvoraussetzungen()){$.jstree._reference(i).deselect_all(),$.jstree._reference(i).open_all(i),$.jstree._reference(i).deselect_all(),$.jstree._reference(i).select_node(i);var e=$.jstree._reference(i).get_text(i);$("#loeschen_dialog_mitteilung").html("Der AP-Bericht '"+e+"' wird gelöscht."),$("#loeschen_dialog").dialog({resizable:!1,height:"auto",width:400,modal:!0,buttons:{"ja, löschen!":function(){$(this).dialog("close"),window.apf.deleted=window.apf.jber,window.apf.deleted.typ="jber";var t=$.ajax({type:"post",url:"php/jber_delete.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});t.always(function(){delete localStorage.jber_id,delete window.apf.jber,$.jstree._reference(i).delete_node(i),window.apf.beschrifte_ordner_jber(o),window.apf.frageObAktionRückgängigGemachtWerdenSoll("Der AP-Bericht '"+e+"' wurde gelöscht.")}),t.fail(function(){console.log("Fehler: Der AP-Bericht wurde nicht gelöscht")})},abbrechen:function(){$(this).dialog("close")}}})}}}},0===$.jstree._reference(i)._get_children(i).length&&(t.neu_jber_uebersicht={label:"neue Übersicht zu allen Arten",separator_before:!0,icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/jber_uebersicht_insert.php",dataType:"json",data:{JbuJahr:$.jstree._reference(i).get_text(i),user:sessionStorage.User}});e.always(function(){var e="jber_uebersicht",t=$.jstree._reference(i).get_text(i),n="neue Übersicht zu allen Arten";window.apf.insertNeuenNodeEineHierarchiestufeTiefer(i,o,e,t,n)}),e.fail(function(){console.log("Fehler: Keine Übersicht zu allen Arten erstellt")})}}),t;case"jber_uebersicht":return t={loeschen:{label:"lösche Übersicht zu allen Arten",icon:"style/images/loeschen.png",action:function(){window.apf.prüfeSchreibvoraussetzungen()&&($.jstree._reference(i).deselect_all(),$.jstree._reference(i).open_all(i),$.jstree._reference(i).deselect_all(),$.jstree._reference(i).select_node(i),$("#loeschen_dialog_mitteilung").html("Die Übersicht zu allen Arten wird gelöscht"),$("#loeschen_dialog").dialog({resizable:!1,height:"auto",width:400,modal:!0,buttons:{"ja, löschen!":function(){$(this).dialog("close"),window.apf.deleted=window.apf.jber_übersicht,window.apf.deleted.typ="jber_uebersicht";var e=$.ajax({type:"post",url:"php/jber_uebersicht_delete.php",dataType:"json",data:{jahr:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});e.always(function(){delete localStorage.jber_uebersicht_id,delete window.apf.jber_übersicht,$.jstree._reference(i).delete_node(i),window.apf.frageObAktionRückgängigGemachtWerdenSoll('Die Übersicht für den AP-Bericht des Jahrs "'+window.apf.deleted.JbuJahr+'" wurde gelöscht.')}),e.fail(function(){console.log("Fehler: Die Übersicht zu allen Arten wurde nicht gelöscht")})},abbrechen:function(){$(this).dialog("close")}}}))}}};case"ap_ordner_ber":return t={neu:{label:"neuer Bericht",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/ber_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id")),user:sessionStorage.User}});e.always(function(e){var t="ber",n="neuer Bericht";window.apf.insertNeuenNodeEineHierarchiestufeTiefer(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Keinen neuen Bericht erstellt")})}}};case"ber":return t={neu:{label:"Neuer Bericht",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/ber_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(o).attr("id")),typ:"ber",user:sessionStorage.User}});
e.always(function(e){var t="ber",n="neuer Bericht";window.apf.insertNeuenNodeAufGleicherHierarchiestufe(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Keinen neuen Bericht erstellt")})}},loeschen:{label:"löschen",separator_before:!0,icon:"style/images/loeschen.png",action:function(){if(window.apf.prüfeSchreibvoraussetzungen()){$.jstree._reference(i).deselect_all(),$.jstree._reference(i).open_all(i),$.jstree._reference(i).deselect_all(),$.jstree._reference(i).select_node(i);var e=$.jstree._reference(i).get_text(i);$("#loeschen_dialog_mitteilung").html("Der Bericht '"+e+"' wird gelöscht."),$("#loeschen_dialog").dialog({resizable:!1,height:"auto",width:400,modal:!0,buttons:{"ja, löschen!":function(){$(this).dialog("close"),window.apf.deleted=window.apf.ber,window.apf.deleted.typ="ber";var t=$.ajax({type:"post",url:"php/ber_delete.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});t.always(function(){delete localStorage.ber_id,delete window.apf.ber,$.jstree._reference(i).delete_node(i),window.apf.beschrifte_ordner_ber(o),window.apf.frageObAktionRückgängigGemachtWerdenSoll("Der Bericht '"+e+"' wurde gelöscht.")}),t.fail(function(){console.log("Fehler: Der Bericht wurde nicht gelöscht")})},abbrechen:function(){$(this).dialog("close")}}})}}}};case"ap_ordner_assozarten":return t={neu:{label:"neue assoziierte Art",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/assozarten_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id")),user:sessionStorage.User}});e.always(function(e){var t="assozarten",n="neue assoziierte Art";window.apf.insertNeuenNodeEineHierarchiestufeTiefer(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: keine assoziierte Art erstellt")})}}};case"assozarten":return t={neu:{label:"neue assoziierte Art",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/assozarten_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(o).attr("id")),typ:"assozarten",user:sessionStorage.User}});e.always(function(e){var t="assozarten",n="neue assoziierte Art";window.apf.insertNeuenNodeAufGleicherHierarchiestufe(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Keine assoziierte Art erstellt")})}},loeschen:{label:"löschen",separator_before:!0,icon:"style/images/loeschen.png",action:function(){if(window.apf.prüfeSchreibvoraussetzungen()){$.jstree._reference(i).deselect_all(),$.jstree._reference(i).open_all(i),$.jstree._reference(i).deselect_all(),$.jstree._reference(i).select_node(i);var e=$.jstree._reference(i).get_text(i);$("#loeschen_dialog_mitteilung").html("Die assoziierte Art '"+e+"' wird gelöscht."),$("#loeschen_dialog").dialog({resizable:!1,height:"auto",width:400,modal:!0,buttons:{"ja, löschen!":function(){$(this).dialog("close"),window.apf.deleted=window.apf.assozarten,window.apf.deleted.typ="assozarten";var t=$.ajax({type:"post",url:"php/assozarten_delete.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});t.always(function(){delete localStorage.assozarten_id,delete window.apf.assozarten,$.jstree._reference(i).delete_node(i),window.apf.beschrifte_ordner_assozarten(o),window.apf.frageObAktionRückgängigGemachtWerdenSoll("Die assoziierte Art '"+e+"' wurde gelöscht.")}),t.fail(function(){console.log("Fehler: Die assoziierte Art wurde nicht gelöscht")})},abbrechen:function(){$(this).dialog("close")}}})}}}};case"pop":return t={neu:{label:"neue Population",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/pop_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(o).attr("id")),typ:"pop",user:sessionStorage.User}});e.always(function(e){var t="pop",n="neue Population";window.apf.insertNeuenNodeAufGleicherHierarchiestufe(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Keine neue Population erstellt")})}},loeschen:{label:"löschen",separator_before:!0,icon:"style/images/loeschen.png",action:function(){if(window.apf.prüfeSchreibvoraussetzungen()){$.jstree._reference(i).deselect_all(),$.jstree._reference(i).open_all(i),$.jstree._reference(i).deselect_all(),$.jstree._reference(i).select_node(i);var e=$.jstree._reference(i).get_text(i);$("#loeschen_dialog_mitteilung").html("Die Population '"+e+"' wird gelöscht."),$("#loeschen_dialog").dialog({resizable:!1,height:"auto",width:400,modal:!0,buttons:{"ja, löschen!":function(){$(this).dialog("close"),window.apf.deleted=window.apf.pop,window.apf.deleted.typ="pop";var t=$.ajax({type:"post",url:"php/pop_delete.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});t.always(function(){delete localStorage.pop_id,delete window.apf.pop,$.jstree._reference(i).delete_node(i),window.apf.beschrifte_ordner_pop(o),window.apf.frageObAktionRückgängigGemachtWerdenSoll("Population '"+e+"' wurde gelöscht.")}),t.fail(function(){console.log("Fehler: Die Population wurde nicht gelöscht")})},abbrechen:function(){$(this).dialog("close")}}})}}},GeoAdminMaps:{label:"auf CH-Karten zeigen",separator_before:!0,icon:"style/images/flora_icon_gelb.png",action:function(){var e=$.ajax({type:"get",url:"php/pop_ch_karte.php",dataType:"json",data:{pop_id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});e.always(function(e){e.rows.length>0?window.apf.zeigePopAufOlmap(e):window.apf.melde("Die Population hat keine Koordinaten","Aktion abgebrochen")}),e.fail(function(){console.log("Fehler: Keine Populationen erhalten")})}},GoogleMaps:{label:"auf Google-Karten zeigen",separator_before:!0,icon:"style/images/flora_icon.png",action:function(){var e=$.ajax({type:"get",url:"php/pop_karte.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});e.always(function(e){e.rows.length>0?window.apf.gmap.zeigeTPop(e):window.apf.melde("Es gibt keine Teilpopulation mit Koordinaten","Aktion abgebrochen")}),e.fail(function(){console.log("Fehler: Keine Teilpopulationen erhalten")})}}},window.apf.pop_zum_verschieben_gemerkt||(t.ausschneiden={label:"zum Verschieben merken",separator_before:!0,icon:"style/images/ausschneiden.png",action:function(){window.apf.prüfeSchreibvoraussetzungen()&&(window.apf.pop_id=window.apf.erstelleIdAusDomAttributId($(i).attr("id")),window.apf.pop_zum_verschieben_gemerkt=!0,window.apf.pop_bezeichnung=$("#PopNr").val()+" "+$("#PopName").val())}}),window.apf.pop_zum_verschieben_gemerkt&&(t.einfuegen={label:"'"+window.apf.pop_bezeichnung+"' einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){var e=window.apf.pop_id,t=window.apf.erstelleIdAusDomAttributId($(o).attr("id")),i=$.ajax({type:"post",url:"php/pop_update.php",dataType:"json",data:{id:e,Feld:"ApArtId",Wert:t,user:sessionStorage.User}});i.always(function(){$.when(window.apf.erstelle_tree(t)).then(function(){$("#tree").jstree("select_node","[typ='pop']#"+e)}),delete window.apf.pop_zum_verschieben_gemerkt,delete window.apf.pop_bezeichnung,delete window.apf.pop_id}),i.fail(function(){console.log("Fehler: Die Population wurde nicht verschoben")})}}),t;case"pop_ordner_tpop":return t={untergeordneteKnotenOeffnen:{label:"untergeordnete Knoten öffnen",icon:"style/images/tree16x16.png",action:function(){$.jstree._reference(e).open_all(e)}},neu:{label:"neue Teilpopulation",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/tpop_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id")),typ:"tpop",user:sessionStorage.User}});e.always(function(e){var t="tpop",n="neue Teilpopulation";window.apf.insertNeuenNodeEineHierarchiestufeTiefer(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Keine neue Teilpopulation erstellt")})}},GeoAdminMaps:{label:"auf CH-Karten zeigen",separator_before:!0,icon:"style/images/flora_icon_gelb.png",action:function(){var e=$.ajax({type:"get",url:"php/tpops_karte.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});e.always(function(e){e.rows.length>0?window.apf.zeigeTPopAufOlmap(e):window.apf.melde("Es gibt keine Teilpopulation mit Koordinaten","Aktion abgebrochen")}),e.fail(function(){console.log("Fehler: Keine Teilpopulationen erhalten")})}},GoogleMaps:{label:"auf Google-Karten zeigen",separator_before:!0,icon:"style/images/flora_icon.png",action:function(){var e=$.ajax({type:"get",url:"php/pop_karte.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});e.always(function(e){e.rows.length>0?window.apf.gmap.zeigeTPop(e):window.apf.melde("Es gibt keine Teilpopulation mit Koordinaten","Aktion abgebrochen")}),e.fail(function(){console.log("Fehler: Keine Teilpopulationen erhalten")})}}},window.apf.tpop_node_ausgeschnitten&&(t.einfuegen={label:$.jstree._reference(window.apf.tpop_node_ausgeschnitten).get_text(window.apf.tpop_node_ausgeschnitten)+" einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){$.jstree._reference(i).move_node(window.apf.tpop_node_ausgeschnitten,i,"first",!1)}}),window.apf.tpop_node_kopiert&&(r="",r+=window.apf.tpop_objekt_kopiert.TPopNr?window.apf.tpop_objekt_kopiert.TPopNr:"(keine Nr.)",r+=": ",r+=window.apf.tpop_objekt_kopiert.TPopFlurname?window.apf.tpop_objekt_kopiert.TPopFlurname:"(kein Flurname)",t.einfuegen={label:r+" einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){window.apf.tpopKopiertInPopOrdnerTpopEinfügen(i)}}),t;case"tpop":if(t={untergeordneteKnotenOeffnen:{label:"untergeordnete Knoten öffnen",icon:"style/images/tree16x16.png",action:function(){$.jstree._reference(e).open_all(e)}},neu:{label:"neue Teilpopulation",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/tpop_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(o).attr("id")),typ:"tpop",user:sessionStorage.User}});e.always(function(e){var t="tpop",n="neue Teilpopulation";window.apf.insertNeuenNodeAufGleicherHierarchiestufe(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Keine neue Teilpopulation erstellt")})}},loeschen:{label:"löschen",separator_before:!0,icon:"style/images/loeschen.png",action:function(){if(window.apf.prüfeSchreibvoraussetzungen()){$.jstree._reference(i).deselect_all(),$.jstree._reference(i).open_all(i),$.jstree._reference(i).deselect_all(),$.jstree._reference(i).select_node(i);var e=$.jstree._reference(i).get_text(i);$("#loeschen_dialog_mitteilung").html("Die Teilpopulation '"+e+"' wird gelöscht."),$("#loeschen_dialog").dialog({resizable:!1,height:"auto",width:400,modal:!0,buttons:{"ja, löschen!":function(){$(this).dialog("close"),window.apf.deleted=window.apf.tpop,window.apf.deleted.typ="tpop";var t=$.ajax({type:"post",url:"php/tpop_delete.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});t.always(function(){delete localStorage.tpop_id,delete window.apf.tpop,$.jstree._reference(i).delete_node(i),window.apf.beschrifte_ordner_tpop(o),window.apf.frageObAktionRückgängigGemachtWerdenSoll("Teilpopulation '"+e+"' wurde gelöscht.")}),t.fail(function(){console.log("Fehler: Die Teilpopulation wurde nicht gelöscht")})},abbrechen:function(){$(this).dialog("close")}}})}}},GeoAdminMaps:{label:"auf CH-Karten zeigen",separator_before:!0,icon:"style/images/flora_icon_gelb.png",action:function(){var e=$.ajax({type:"get",url:"php/tpop_karte.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});e.always(function(e){e.rows.length>0?window.apf.zeigeTPopAufOlmap(e):window.apf.melde("Die Teilpopulation hat keine Koordinaten","Aktion abgebrochen")}),e.fail(function(){console.log("Fehler: Keine Teilpopulationen erhalten")})}},verortenGeoAdmin:{label:"auf CH-Karten verorten",separator_before:!0,icon:"style/images/flora_icon_rot.png",action:function(){var e=$.ajax({type:"get",url:"php/tpop.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});e.always(function(e){window.apf.verorteTPopAufOlmap(e)}),e.fail(function(){console.log("Fehler: Keine Teilpopulation erhalten")})}},GoogleMaps:{label:"auf Google-Karten zeigen",separator_before:!0,icon:"style/images/flora_icon.png",action:function(){var e=$.ajax({type:"get",url:"php/tpop_karte.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});e.always(function(e){e.rows.length>0?window.apf.gmap.zeigeTPop(e):window.apf.melde("Die Teilpopulation hat keine Koordinaten","Aktion abgebrochen")}),e.fail(function(){console.log("Fehler: Keine Daten erhalten")})}},verorten:{label:"auf Google-Karten verorten",separator_before:!0,icon:"style/images/flora_icon_rot.png",action:function(){var e=$.ajax({type:"get",url:"php/tpop.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});e.always(function(e){window.apf.gmap.verorteTPop(e)}),e.fail(function(){console.log("Fehler: Keine Daten erhalten")})}},GisBrowser:{label:"im GIS-Browser zeigen",separator_before:!0,icon:"style/images/wappen_zuerich.png",action:function(){window.apf.zeigeBeobKoordinatenImGisBrowser()}}},window.apf.tpop_node_ausgeschnitten||(t.ausschneiden={label:"ausschneiden",separator_before:!0,icon:"style/images/ausschneiden.png",action:function(){window.apf.prüfeSchreibvoraussetzungen()&&(window.apf.tpop_node_ausgeschnitten=i,delete window.apf.tpop_node_kopiert,delete window.apf.tpop_objekt_kopiert)}}),window.apf.tpop_node_ausgeschnitten||(t.kopieren={label:"kopieren",separator_before:!0,icon:"style/images/kopieren.png",action:function(){if(window.apf.prüfeSchreibvoraussetzungen()){window.apf.tpop_node_kopiert=i;var e=$.ajax({type:"get",url:"php/tpop.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(window.apf.tpop_node_kopiert).attr("id"))}});e.always(function(e){window.apf.tpop_objekt_kopiert=e}),e.fail(function(){console.log("Fehler: Die Teilpopulation wurde nicht kopiert")})}}}),window.apf.tpop_node_kopiert){var r="";r+=window.apf.tpop_objekt_kopiert.TPopNr?window.apf.tpop_objekt_kopiert.TPopNr:"(keine Nr.)",r+=": ",r+=window.apf.tpop_objekt_kopiert.TPopFlurname?window.apf.tpop_objekt_kopiert.TPopFlurname:"(kein Flurname)",t.einfuegen={label:r+" einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){window.apf.tpopKopiertInPopOrdnerTpopEinfügen(o)}}}return window.apf.tpop_node_ausgeschnitten&&(t.einfuegen={label:$.jstree._reference(window.apf.tpop_node_ausgeschnitten).get_text(window.apf.tpop_node_ausgeschnitten)+" einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){$.jstree._reference(o).move_node(window.apf.tpop_node_ausgeschnitten,o,"first",!1)}}),t;case"pop_ordner_popber":return t={neu:{label:"neuer Populations-Bericht",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/popber_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id")),user:sessionStorage.User}});e.always(function(e){var t="popber",n="neuer Populations-Bericht";window.apf.insertNeuenNodeEineHierarchiestufeTiefer(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Keinen neuen Populations-Bericht erstellt")})}}};case"popber":return t={neu:{label:"neuer Populations-Bericht",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/popber_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(o).attr("id")),typ:"popber",user:sessionStorage.User}});e.always(function(e){var t="popber",n="neuer Populations-Bericht";window.apf.insertNeuenNodeAufGleicherHierarchiestufe(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Keinen neuen Populations-Bericht erstellt")})}},loeschen:{label:"löschen",separator_before:!0,icon:"style/images/loeschen.png",action:function(){if(window.apf.prüfeSchreibvoraussetzungen()){var e=$.jstree._reference(i).get_text(i);$("#loeschen_dialog_mitteilung").html("Der Populations-Bericht '"+e+"' wird gelöscht."),$("#loeschen_dialog").dialog({resizable:!1,height:"auto",width:400,modal:!0,buttons:{"ja, löschen!":function(){$(this).dialog("close"),window.apf.deleted=window.apf.popber,window.apf.deleted.typ="popber";var t=$.ajax({type:"post",url:"php/popber_delete.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});t.always(function(){delete localStorage.popber_id,delete window.apf.popber,$.jstree._reference(i).delete_node(i),window.apf.beschrifte_ordner_popber(o),window.apf.frageObAktionRückgängigGemachtWerdenSoll("Der Populations-Bericht '"+e+"' wurde gelöscht.")}),t.fail(function(){console.log("Fehler: Der Populations-Bericht wurde nicht gelöscht")})},abbrechen:function(){$(this).dialog("close")}}})}}}};case"pop_ordner_massnber":return t={neu:{label:"neuer Massnahmen-Bericht",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/popmassnber_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id")),user:sessionStorage.User}});e.always(function(e){var t="popmassnber",n="neuer Massnahmen-Bericht";window.apf.insertNeuenNodeEineHierarchiestufeTiefer(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Es wurde kein neuer Massnahmen-Bericht erstellt")})}}};case"popmassnber":return t={neu:{label:"neuer Massnahmen-Bericht",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/popmassnber_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(o).attr("id")),typ:"popmassnber",user:sessionStorage.User}});e.always(function(e){var t="popmassnber",n="neuer Massnahmen-Bericht";window.apf.insertNeuenNodeAufGleicherHierarchiestufe(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Es wurde kein neuer Massnahmen-Bericht erstellt")})}},loeschen:{label:"löschen",separator_before:!0,icon:"style/images/loeschen.png",action:function(){if(window.apf.prüfeSchreibvoraussetzungen()){var e=$.jstree._reference(i).get_text(i);$("#loeschen_dialog_mitteilung").html("Der Massnahmen-Bericht '"+e+"' wird gelöscht."),$("#loeschen_dialog").dialog({resizable:!1,height:"auto",width:400,modal:!0,buttons:{"ja, löschen!":function(){$(this).dialog("close"),window.apf.deleted=window.apf.popmassnber,window.apf.deleted.typ="popmassnber";var t=$.ajax({type:"post",url:"php/popmassnber_delete.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});t.always(function(){delete localStorage.popmassnber_id,delete window.apf.popmassnber,$.jstree._reference(i).delete_node(i),window.apf.beschrifte_ordner_popmassnber(o),window.apf.frageObAktionRückgängigGemachtWerdenSoll("Der Massnahmen-Bericht '"+e+"' wurde gelöscht.")}),t.fail(function(){console.log("Fehler: Der Massnahmen-Bericht wurde nicht gelöscht")})},abbrechen:function(){$(this).dialog("close")}}})}}}};case"tpop_ordner_feldkontr":return t={neu:{label:"neue Feldkontrolle",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/tpopfeldkontr_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id")),typ:"tpopfeldkontr",user:sessionStorage.User}});e.always(function(e){var t="tpopfeldkontr",n="neue Feldkontrolle";window.apf.insertNeuenNodeEineHierarchiestufeTiefer(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Keine neue Feldkontrolle erstellt")})}}},window.apf.tpopfeldkontr_node_ausgeschnitten&&(t.einfuegen={label:$.jstree._reference(window.apf.tpopfeldkontr_node_ausgeschnitten).get_text(window.apf.tpopfeldkontr_node_ausgeschnitten)+" einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){$.jstree._reference(i).move_node(window.apf.tpopfeldkontr_node_ausgeschnitten,i,"first",!1)}}),window.apf.tpopfeldkontr_node_kopiert&&(t.einfuegen={label:$.jstree._reference(window.apf.tpopfeldkontr_node_kopiert).get_text(window.apf.tpopfeldkontr_node_kopiert)+" einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){var e=$.ajax({type:"post",url:"php/tpopfeldkontr_insert_kopie.php",dataType:"json",data:{user:sessionStorage.User,TPopId:window.apf.erstelleIdAusDomAttributId($(i).attr("id")),TPopKontrId:window.apf.erstelleIdAusDomAttributId($(window.apf.tpopfeldkontr_node_kopiert).attr("id"))}});e.always(function(e){var t="tpopfeldkontr",n=window.apf.erstelleLabelFürFeldkontrolle(window.apf.tpopfeldkontr_objekt_kopiert.TPopKontrJahr,window.apf.tpopfeldkontr_objekt_kopiert.TPopKontrTyp);window.apf.insertNeuenNodeEineHierarchiestufeTiefer(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Die Feldkontrolle wurde nicht erstellt")})}}),t;case"tpopfeldkontr":return t={neu:{label:"neue Feldkontrolle",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/tpopfeldkontr_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(o).attr("id")),typ:"tpopfeldkontr",user:sessionStorage.User}});e.always(function(e){var t="tpopfeldkontr",n="neue Feldkontrolle";window.apf.insertNeuenNodeAufGleicherHierarchiestufe(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Keine neue Feldkontrolle erstellt")})}},loeschen:{label:"löschen",separator_before:!0,icon:"style/images/loeschen.png",action:function(){if(window.apf.prüfeSchreibvoraussetzungen()){var e=$.jstree._reference(i).get_text(i);$("#loeschen_dialog_mitteilung").html("Die Feldkontrolle '"+e+"' wird gelöscht."),$("#loeschen_dialog").dialog({resizable:!1,height:"auto",width:400,modal:!0,buttons:{"ja, löschen!":function(){$(this).dialog("close"),window.apf.deleted=window.apf.tpopfeldkontr,window.apf.deleted.typ="tpopfeldkontr";var t=$.ajax({type:"post",url:"php/tpopfeldkontr_delete.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});t.always(function(){delete localStorage.tpopfeldkontr_id,delete window.apf.tpopfeldkontr,$.jstree._reference(i).delete_node(i),window.apf.beschrifte_ordner_tpopfeldkontr(o),window.apf.frageObAktionRückgängigGemachtWerdenSoll("Die Feldkontrolle '"+e+"' wurde gelöscht.")}),t.fail(function(){console.log("Fehler: Die Feldkontrolle wurde nicht gelöscht")})},abbrechen:function(){$(this).dialog("close")}}})}}},biotop_kopieren:{label:"Biotop kopieren",separator_before:!0,icon:"style/images/kopieren.png",action:function(){if(window.apf.prüfeSchreibvoraussetzungen()){delete window.apf.feldkontr_biotop,window.apf.feldkontr_biotop={};var e=$("#TPopKontrFlaeche");e.val()&&(window.apf.feldkontr_biotop.TPopKontrFlaeche=e.val());var t=$("#TPopKontrLeb");t.val()&&(window.apf.feldkontr_biotop.TPopKontrLeb=t.val());var i=$("#TPopKontrLebUmg");i.val()&&(window.apf.feldkontr_biotop.TPopKontrLebUmg=i.val());var n=$("#TPopKontrVegTyp");n.val()&&(window.apf.feldkontr_biotop.TPopKontrVegTyp=n.val());var o=$("#TPopKontrKonkurrenz");o.val()&&(window.apf.feldkontr_biotop.TPopKontrKonkurrenz=o.val());var a=$("#TPopKontrMoosschicht");a.val()&&(window.apf.feldkontr_biotop.TPopKontrMoosschicht=a.val());var s=$("#TPopKontrKrautschicht");s.val()&&(window.apf.feldkontr_biotop.TPopKontrKrautschicht=s.val());var r=$("#TPopKontrStrauchschicht");r.val()&&(window.apf.feldkontr_biotop.TPopKontrStrauchschicht=r.val());var l=$("#TPopKontrBaumschicht");l.val()&&(window.apf.feldkontr_biotop.TPopKontrBaumschicht=l.val());var p=$("#TPopKontrBodenTyp");p.val()&&(window.apf.feldkontr_biotop.TPopKontrBodenTyp=p.val());var h=$("#TPopKontrBodenKalkgehalt");h.val()&&(window.apf.feldkontr_biotop.TPopKontrBodenKalkgehalt=h.val()),$("#TPopKontrBodenDurchlaessigkeit").val()&&(window.apf.feldkontr_biotop.TPopKontrBodenDurchlaessigkeit=$("#TPopKontrBodenDurchlaessigkeit").val()),$("#TPopKontrBodenHumus").val()&&(window.apf.feldkontr_biotop.TPopKontrBodenHumus=$("#TPopKontrBodenHumus").val()),$("#TPopKontrBodenNaehrstoffgehalt").val()&&(window.apf.feldkontr_biotop.TPopKontrBodenNaehrstoffgehalt=$("#TPopKontrBodenNaehrstoffgehalt").val()),$("#TPopKontrBodenAbtrag").val()&&(window.apf.feldkontr_biotop.TPopKontrBodenAbtrag=$("#TPopKontrBodenAbtrag").val()),$("#TPopKontrWasserhaushalt").val()&&(window.apf.feldkontr_biotop.TPopKontrWasserhaushalt=$("#TPopKontrWasserhaushalt").val()),$("#TPopKontrHandlungsbedarf").val()&&(window.apf.feldkontr_biotop.TPopKontrHandlungsbedarf=$("#TPopKontrHandlungsbedarf").val())}}}},window.apf.feldkontr_biotop&&(t.biotop_einfuegen={label:"Biotop einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){var e={};if(e.id=window.apf.erstelleIdAusDomAttributId($(i).attr("id")),e.user=sessionStorage.User,window.apf.prüfeSchreibvoraussetzungen()){_.each(window.apf.feldkontr_biotop,function(t,i){$("#"+i).val(t),e[i]=t});var t=$.ajax({type:"post",url:"php/tpopfeldkontr_update_multiple.php",dataType:"json",data:e});t.fail(function(){console.log("Fehler: Das kopierte Biotop wurde nicht eingefügt")})}}}),window.apf.tpopfeldkontr_node_ausgeschnitten||(t.ausschneiden={label:"ausschneiden",separator_before:!0,icon:"style/images/ausschneiden.png",action:function(){window.apf.prüfeSchreibvoraussetzungen()&&(window.apf.tpopfeldkontr_node_ausgeschnitten=i,delete window.apf.tpopfeldkontr_node_kopiert,delete window.apf.tpopfeldkontr_objekt_kopiert)}}),window.apf.tpopfeldkontr_node_ausgeschnitten||(t.kopieren={label:"kopieren",separator_before:!0,icon:"style/images/kopieren.png",action:function(){if(window.apf.prüfeSchreibvoraussetzungen()){window.apf.tpopfeldkontr_node_kopiert=i;var e=$.ajax({type:"get",url:"php/tpopfeldkontr.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(window.apf.tpopfeldkontr_node_kopiert).attr("id"))}});e.always(function(e){window.apf.tpopfeldkontr_objekt_kopiert=e}),e.fail(function(){console.log("Fehler: Die Feldkontrolle wurde nicht kopiert")})}}}),window.apf.tpopfeldkontr_node_ausgeschnitten&&(t.einfuegen={label:$.jstree._reference(window.apf.tpopfeldkontr_node_ausgeschnitten).get_text(window.apf.tpopfeldkontr_node_ausgeschnitten)+" einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){$.jstree._reference(o).move_node(window.apf.tpopfeldkontr_node_ausgeschnitten,o,"first",!1)}}),window.apf.tpopfeldkontr_node_kopiert&&(t.einfuegen={label:$.jstree._reference(window.apf.tpopfeldkontr_node_kopiert).get_text(window.apf.tpopfeldkontr_node_kopiert)+" einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){var e=$.ajax({type:"post",url:"php/tpopfeldkontr_insert_kopie.php",dataType:"json",data:{user:sessionStorage.User,TPopId:window.apf.erstelleIdAusDomAttributId($(o).attr("id")),TPopKontrId:window.apf.erstelleIdAusDomAttributId($(window.apf.tpopfeldkontr_node_kopiert).attr("id"))}});e.always(function(e){var t="tpopfeldkontr",n=window.apf.erstelleLabelFürFeldkontrolle(window.apf.tpopfeldkontr_objekt_kopiert.TPopKontrJahr,window.apf.tpopfeldkontr_objekt_kopiert.TPopKontrTyp);window.apf.insertNeuenNodeAufGleicherHierarchiestufe(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Die Feldkontrolle wurde nicht erstellt")})}}),t;case"tpop_ordner_freiwkontr":return t={neu:{label:"neue Freiwilligen-Kontrolle",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/tpopfeldkontr_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id")),user:sessionStorage.User,typ:"Freiwilligen-Erfolgskontrolle"}});e.always(function(e){var t="tpopfreiwkontr",n="neue Freiwilligen-Kontrolle";window.apf.insertNeuenNodeEineHierarchiestufeTiefer(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Keine neue Freiwilligen-Kontrolle erstellt")})}}},window.apf.tpopfreiwkontr_node_ausgeschnitten&&(t.einfuegen={label:$.jstree._reference(window.apf.tpopfreiwkontr_node_ausgeschnitten).get_text(window.apf.tpopfreiwkontr_node_ausgeschnitten)+" einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){$.jstree._reference(i).move_node(window.apf.tpopfreiwkontr_node_ausgeschnitten,i,"first",!1)}}),window.apf.tpopfreiwkontr_node_kopiert&&(t.einfuegen={label:$.jstree._reference(window.apf.tpopfreiwkontr_node_kopiert).get_text(window.apf.tpopfreiwkontr_node_kopiert)+" einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){var e=$.ajax({type:"post",url:"php/tpopfeldkontr_insert_kopie.php",dataType:"json",data:{user:sessionStorage.User,TPopId:window.apf.erstelleIdAusDomAttributId($(i).attr("id")),TPopKontrId:window.apf.erstelleIdAusDomAttributId($(window.apf.tpopfreiwkontr_node_kopiert).attr("id"))}});e.always(function(e){var t="tpopfreiwkontr",n=window.apf.tpopfreiwkontr_objekt_kopiert.TPopKontrJahr;window.apf.insertNeuenNodeEineHierarchiestufeTiefer(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Die Freiwilligen-Kontrolle wurde nicht erstellt")})}}),t;case"tpopfreiwkontr":return t={neu:{label:"neue Freiwilligen-Kontrolle",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/tpopfeldkontr_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(o).attr("id")),user:sessionStorage.User,typ:"Freiwilligen-Erfolgskontrolle"}});e.always(function(e){var t="tpopfreiwkontr",n="neue Freiwilligen-Kontrolle";window.apf.insertNeuenNodeAufGleicherHierarchiestufe(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Keine neue Freiwilligen-Kontrolle erstellt")})}},loeschen:{label:"löschen",separator_before:!0,icon:"style/images/loeschen.png",action:function(){if(window.apf.prüfeSchreibvoraussetzungen()){var e=$.jstree._reference(i).get_text(i);$("#loeschen_dialog_mitteilung").html("Die Freiwilligen-Kontrolle '"+e+"' wird gelöscht."),$("#loeschen_dialog").dialog({resizable:!1,height:"auto",width:400,modal:!0,buttons:{"ja, löschen!":function(){$(this).dialog("close"),window.apf.deleted=window.apf.tpopfeldkontr,window.apf.deleted.typ="tpopfreiwkontr";var t=$.ajax({type:"post",url:"php/tpopfeldkontr_delete.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});t.always(function(){delete localStorage.tpopfeldkontr_id,delete localStorage.tpopfreiwkontr,delete window.apf.tpopfeldkontr,$.jstree._reference(i).delete_node(i),window.apf.beschrifte_ordner_tpopfreiwkontr(o),window.apf.frageObAktionRückgängigGemachtWerdenSoll("Die Freiwilligen-Kontrolle '"+e+"' wurde gelöscht.")}),t.fail(function(){console.log("Fehler: Die Freiwilligen-Kontrolle wurde nicht gelöscht")})},abbrechen:function(){$(this).dialog("close")}}})}}}},window.apf.tpopfreiwkontr_node_ausgeschnitten||(t.ausschneiden={label:"ausschneiden",separator_before:!0,icon:"style/images/ausschneiden.png",action:function(){window.apf.prüfeSchreibvoraussetzungen()&&(window.apf.tpopfreiwkontr_node_ausgeschnitten=i,delete window.apf.tpopfreiwkontr_node_kopiert,delete window.apf.tpopfreiwkontr_objekt_kopiert)}}),window.apf.tpopfreiwkontr_node_ausgeschnitten||(t.kopieren={label:"kopieren",separator_before:!0,icon:"style/images/kopieren.png",action:function(){if(window.apf.prüfeSchreibvoraussetzungen()){window.apf.tpopfreiwkontr_node_kopiert=i;var e=$.ajax({type:"get",url:"php/tpopfeldkontr.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(window.apf.tpopfreiwkontr_node_kopiert).attr("id"))}});e.always(function(e){window.apf.tpopfreiwkontr_objekt_kopiert=e}),e.fail(function(){console.log("Fehler: Die Freiwilligen-Kontrolle wurde nicht kopiert")})}}}),window.apf.tpopfreiwkontr_node_ausgeschnitten&&(t.einfuegen={label:$.jstree._reference(window.apf.tpopfreiwkontr_node_ausgeschnitten).get_text(window.apf.tpopfreiwkontr_node_ausgeschnitten)+" einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){$.jstree._reference(o).move_node(window.apf.tpopfreiwkontr_node_ausgeschnitten,o,"first",!1),localStorage.tpopfreiwkontr=!0}}),window.apf.tpopfreiwkontr_node_kopiert&&(t.einfuegen={label:$.jstree._reference(window.apf.tpopfreiwkontr_node_kopiert).get_text(window.apf.tpopfreiwkontr_node_kopiert)+" einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){var e=$.ajax({type:"post",url:"php/tpopfeldkontr_insert_kopie.php",dataType:"json",data:{user:sessionStorage.User,TPopId:window.apf.erstelleIdAusDomAttributId($(o).attr("id")),TPopKontrId:window.apf.erstelleIdAusDomAttributId($(window.apf.tpopfreiwkontr_node_kopiert).attr("id"))}});
e.always(function(e){var t="tpopfreiwkontr",n=window.apf.tpopfreiwkontr_objekt_kopiert.TPopKontrJahr;window.apf.insertNeuenNodeAufGleicherHierarchiestufe(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Die Freiwilligen-Kontrolle wurde nicht erstellt")})}}),t;case"tpop_ordner_massn":return t={neu:{label:"neue Massnahme",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/tpopmassn_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id")),typ:"tpopmassn",user:sessionStorage.User}});e.always(function(e){var t="tpopmassn",n="neue Massnahme";window.apf.insertNeuenNodeEineHierarchiestufeTiefer(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Keine neue Massnahme erstellt")})}}},window.apf.tpopmassn_node_ausgeschnitten&&(t.einfuegen={label:$.jstree._reference(window.apf.tpopmassn_node_ausgeschnitten).get_text(window.apf.tpopmassn_node_ausgeschnitten)+" einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){$.jstree._reference(i).move_node(window.apf.tpopmassn_node_ausgeschnitten,i,"first",!1)}}),window.apf.tpopmassn_node_kopiert&&(t.einfuegen={label:$.jstree._reference(window.apf.tpopmassn_node_kopiert).get_text(window.apf.tpopmassn_node_kopiert)+" einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){var e=$.ajax({type:"post",url:"php/tpopmassn_insert_kopie.php",dataType:"json",data:{user:sessionStorage.User,TPopId:window.apf.erstelleIdAusDomAttributId($(i).attr("id")),TPopMassnId:window.apf.erstelleIdAusDomAttributId($(window.apf.tpopmassn_node_kopiert).attr("id"))}});e.always(function(e){var t="tpopmassn",n=window.apf.erstelleLabelFürMassnahme(window.apf.tpopmassn_objekt_kopiert.TPopMassnJahr,window.apf.tpopmassn_objekt_kopiert.TPopMassnBerErfolgsbeurteilung_txt);window.apf.insertNeuenNodeEineHierarchiestufeTiefer(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Die Massnahme wurde nicht erstellt")})}}),t;case"tpopmassn":return t={neu:{label:"neue Massnahme",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/tpopmassn_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(o).attr("id")),typ:"tpopmassn",user:sessionStorage.User}});e.always(function(e){var t="tpopmassn",n="neue Massnahme";window.apf.insertNeuenNodeAufGleicherHierarchiestufe(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Keine neue Massnahme erstellt")})}},loeschen:{label:"löschen",separator_before:!0,icon:"style/images/loeschen.png",action:function(){if(window.apf.prüfeSchreibvoraussetzungen()){var e=$.jstree._reference(i).get_text(i);$("#loeschen_dialog_mitteilung").html("Die Massnahme '"+e+"' wird gelöscht."),$("#loeschen_dialog").dialog({resizable:!1,height:"auto",width:400,modal:!0,buttons:{"ja, löschen!":function(){$(this).dialog("close"),window.apf.deleted=window.apf.tpopmassn,window.apf.deleted.typ="tpopmassn";var t=$.ajax({type:"post",url:"php/tpopmassn_delete.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});t.always(function(){delete localStorage.tpopmassn_id,delete window.apf.tpopmassn,$.jstree._reference(i).delete_node(i),window.apf.beschrifte_ordner_tpopmassn(o),window.apf.frageObAktionRückgängigGemachtWerdenSoll("Die Massnahme '"+e+"' wurde gelöscht.")}),t.fail(function(){console.log("Fehler: Die Massnahme wurde nicht gelöscht")})},abbrechen:function(){$(this).dialog("close")}}})}}}},window.apf.tpopmassn_node_ausgeschnitten||(t.ausschneiden={label:"ausschneiden",separator_before:!0,icon:"style/images/ausschneiden.png",action:function(){window.apf.prüfeSchreibvoraussetzungen()&&(window.apf.tpopmassn_node_ausgeschnitten=i,delete window.apf.tpopmassn_node_kopiert,delete window.apf.tpopmassn_objekt_kopiert)}}),window.apf.tpopmassn_node_ausgeschnitten||(t.kopieren={label:"kopieren",separator_before:!0,icon:"style/images/kopieren.png",action:function(){if(window.apf.prüfeSchreibvoraussetzungen()){window.apf.tpopmassn_node_kopiert=i;var e=$.ajax({type:"get",url:"php/tpopmassn.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(window.apf.tpopmassn_node_kopiert).attr("id"))}}),t=$("#TPopMassnTyp option:checked");e.always(function(e){window.apf.tpopmassn_objekt_kopiert=e,window.apf.tpopmassn_objekt_kopiert.TPopMassnBerErfolgsbeurteilung_txt="",t.text()&&(window.apf.tpopmassn_objekt_kopiert.TPopMassnBerErfolgsbeurteilung_txt=t.text())}),e.fail(function(){console.log("Fehler: Die Massnahme wurde nicht kopiert")})}}}),window.apf.tpopmassn_node_ausgeschnitten&&(t.einfuegen={label:$.jstree._reference(window.apf.tpopmassn_node_ausgeschnitten).get_text(window.apf.tpopmassn_node_ausgeschnitten)+" einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){$.jstree._reference(o).move_node(window.apf.tpopmassn_node_ausgeschnitten,o,"first",!1)}}),window.apf.tpopmassn_node_kopiert&&(t.einfuegen={label:$.jstree._reference(window.apf.tpopmassn_node_kopiert).get_text(window.apf.tpopmassn_node_kopiert)+" einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){var e=$.ajax({type:"post",url:"php/tpopmassn_insert_kopie.php",dataType:"json",data:{user:sessionStorage.User,TPopId:window.apf.erstelleIdAusDomAttributId($(o).attr("id")),TPopMassnId:window.apf.erstelleIdAusDomAttributId($(window.apf.tpopmassn_node_kopiert).attr("id"))}});e.always(function(e){var t="tpopmassn",n=window.apf.erstelleLabelFürMassnahme(window.apf.tpopmassn_objekt_kopiert.TPopMassnJahr,window.apf.tpopmassn_objekt_kopiert.TPopMassnBerErfolgsbeurteilung_txt);window.apf.insertNeuenNodeAufGleicherHierarchiestufe(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Die Massnahme wurde nicht erstellt")})}}),t;case"tpop_ordner_tpopber":return t={neu:{label:"neuer Teilpopulations-Bericht",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/tpopber_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id")),user:sessionStorage.User}});e.always(function(e){var t="tpopber",n="neuer Teilpopulations-Bericht";window.apf.insertNeuenNodeEineHierarchiestufeTiefer(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Keinen neuen Teilpopulations-Bericht erstellt")})}}};case"tpopber":return t={neu:{label:"neuer Teilpopulations-Bericht",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/tpopber_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(o).attr("id")),typ:"tpopber",user:sessionStorage.User}});e.always(function(e){var t="tpopber",n="neuer Teilpopulations-Bericht";window.apf.insertNeuenNodeAufGleicherHierarchiestufe(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Keinen neuen Teilpopulations-Bericht erstellt")})}},loeschen:{label:"löschen",separator_before:!0,icon:"style/images/loeschen.png",action:function(){if(window.apf.prüfeSchreibvoraussetzungen()){var e=$.jstree._reference(i).get_text(i);$("#loeschen_dialog_mitteilung").html("Der Teilpopulations-Bericht '"+e+"' wird gelöscht."),$("#loeschen_dialog").dialog({resizable:!1,height:"auto",width:400,modal:!0,buttons:{"ja, löschen!":function(){$(this).dialog("close"),window.apf.deleted=window.apf.tpopber,window.apf.deleted.typ="tpopber";var t=$.ajax({type:"post",url:"php/tpopber_delete.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});t.always(function(){delete localStorage.tpopber_id,delete window.apf.tpopber,$.jstree._reference(i).delete_node(i),window.apf.beschrifte_ordner_tpopber(o),window.apf.frageObAktionRückgängigGemachtWerdenSoll("Der Teilpopulations-Bericht '"+e+"' wurde gelöscht.")}),t.fail(function(){console.log("Fehler: Der Teilpopulations-Bericht wurde nicht gelöscht")})},abbrechen:function(){$(this).dialog("close")}}})}}}};case"tpop_ordner_beob_zugeordnet":return t={GoogleMaps:{label:"auf Luftbild zeigen",separator_before:!0,icon:"style/images/flora_icon.png",action:function(){var e=$.ajax({type:"get",url:"php/beob_karte.php",dataType:"json",data:{tpop_id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});e.always(function(e){e.rows.length>0?window.apf.gmap.zeigeTPopBeob(e):window.apf.melde("Es gibt keine Beobachtungen mit Koordinaten","Aktion abgebrochen")}),e.fail(function(){console.log("Fehler: Keine Daten erhalten")})}}},window.apf.beob_zugeordnet_node_ausgeschnitten&&(t={},t.einfuegen={label:$.jstree._reference(window.apf.beob_zugeordnet_node_ausgeschnitten).get_text(window.apf.beob_zugeordnet_node_ausgeschnitten)+" einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){$.jstree._reference(i).move_node(window.apf.beob_zugeordnet_node_ausgeschnitten,i,"first",!1)}}),window.apf.beob_node_ausgeschnitten&&(t.einfuegen={label:$.jstree._reference(window.apf.beob_node_ausgeschnitten).get_text(window.apf.beob_node_ausgeschnitten)+" einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){$("#tree").jstree("move_node",window.apf.beob_node_ausgeschnitten,i,"first")}}),t;case"beob_zugeordnet":return t={GoogleMaps:{label:"auf Luftbild zeigen",separator_before:!0,icon:"style/images/flora_icon.png",action:function(){var e=$.ajax({type:"get",url:"php/beob_karte.php",dataType:"json",data:{beobid:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});e.always(function(e){e.rows.length>0?window.apf.gmap.zeigeTPopBeob(e):window.apf.melde("Die Beobachtung hat keine Koordinaten","Aktion abgebrochen")}),e.fail(function(){console.log("Fehler: Keine Daten erhalten")})}},GoogleMapsMitTPopTPopBeob:{label:"auf Luftbild einer neuen<br>&nbsp;&nbsp;&nbsp;Teilpopulation zuordnen",separator_before:!0,icon:"style/images/flora_icon_violett.png",action:function(){var e=$.ajax({type:"get",url:"php/beob_karte.php",dataType:"json",data:{beobid:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});e.always(function(e){if(e.rows.length>0){var t=$.ajax({type:"get",url:"php/ap_karte.php",dataType:"json",data:{id:localStorage.ap_id}});t.always(function(t){t.rows.length>0?window.apf.gmap.zeigeBeobUndTPop(e,t):window.apf.gmap.zeigeBeob(e)})}else window.apf.melde("Die Beobachtung hat keine Koordinaten<br>Bitte im Formular zuordnen","Aktion abgebrochen")}),e.fail(function(){console.log("Fehler: Keine Daten erhalten")})}},GisBrowser:{label:"im GIS-Browser zeigen",separator_before:!0,icon:"style/images/wappen_zuerich.png",action:function(){window.apf.zeigeBeobKoordinatenImGisBrowser()}}},window.apf.beob_zugeordnet_node_ausgeschnitten||(t.ausschneiden={label:"ausschneiden",separator_before:!0,icon:"style/images/ausschneiden.png",action:function(){window.apf.prüfeSchreibvoraussetzungen()&&(window.apf.beob_zugeordnet_node_ausgeschnitten=i)}}),window.apf.beob_zugeordnet_node_ausgeschnitten&&(t.einfuegen_beob_zugeordnet={label:$.jstree._reference(window.apf.beob_zugeordnet_node_ausgeschnitten).get_text(window.apf.beob_zugeordnet_node_ausgeschnitten)+" einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){$.jstree._reference(o).move_node(window.apf.beob_zugeordnet_node_ausgeschnitten,o,"first",!1)}}),window.apf.beob_node_ausgeschnitten&&(t.einfuegen_beob={label:$.jstree._reference(window.apf.beob_node_ausgeschnitten).get_text(window.apf.beob_node_ausgeschnitten)+" einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){$.jstree._reference(o).move_node(window.apf.beob_node_ausgeschnitten,o,"first",!1)}}),t;case"tpop_ordner_massnber":return t={neu:{label:"neuer Massnahmen-Bericht",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/tpopmassnber_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id")),user:sessionStorage.User}});e.always(function(e){var t="tpopmassnber",n="neuer Massnahmen-Bericht";window.apf.insertNeuenNodeEineHierarchiestufeTiefer(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Keinen neuen Massnahmen-Bericht erstellt")})}}};case"tpopmassnber":return t={neu:{label:"neuer Massnahmen-Bericht",icon:"style/images/neu.png",action:function(){var e=$.ajax({type:"post",url:"php/tpopmassnber_insert.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(o).attr("id")),typ:"tpopmassnber",user:sessionStorage.User}});e.always(function(e){var t="tpopmassnber",n="neuer Massnahmen-Bericht";window.apf.insertNeuenNodeAufGleicherHierarchiestufe(i,o,t,e,n)}),e.fail(function(){console.log("Fehler: Keinen neuen Massnahmen-Bericht erstellt")})}},loeschen:{label:"löschen",separator_before:!0,icon:"style/images/loeschen.png",action:function(){if(window.apf.prüfeSchreibvoraussetzungen()){var e=$.jstree._reference(i).get_text(i);$("#loeschen_dialog_mitteilung").html("Der Massnahmen-Bericht '"+e+"' wird gelöscht."),$("#loeschen_dialog").dialog({resizable:!1,height:"auto",width:400,modal:!0,buttons:{"ja, löschen!":function(){$(this).dialog("close"),window.apf.deleted=window.apf.tpopmassnber,window.apf.deleted.typ="tpopmassnber";var t=$.ajax({type:"post",url:"php/tpopmassnber_delete.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});t.always(function(){delete localStorage.tpopmassnber_id,delete window.apf.tpopmassnber,$.jstree._reference(i).delete_node(i),window.apf.beschrifte_ordner_popmassnber(o),window.apf.frageObAktionRückgängigGemachtWerdenSoll("Der Massnahmen-Bericht '"+e+"' wurde gelöscht.")}),t.fail(function(){console.log("Fehler: Der Massnahmen-Bericht wurde nicht gelöscht")})},abbrechen:function(){$(this).dialog("close")}}})}}}};case"ap_ordner_beob_nicht_beurteilt":return t={GoogleMaps:{label:"auf Luftbild zeigen",separator_before:!0,icon:"style/images/flora_icon_violett.png",action:function(){var e=$.ajax({type:"get",url:"php/beob_karte.php",dataType:"json",data:{apart_id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});e.always(function(e){e.rows.length>0?window.apf.gmap.zeigeBeob(e):window.apf.melde("Es gibt keine Beobachtung mit Koordinaten","Aktion abgebrochen")}),e.fail(function(){console.log("Fehler: Keine Daten erhalten")})}},GoogleMapsMitTPop:{label:"auf Luftbild Teilpopulationen<br>&nbsp;&nbsp;&nbsp;zuordnen<br>&nbsp;&nbsp;&nbsp;Tipp: Beobachtungen auf<br>&nbsp;&nbsp;&nbsp;Teilpopulationen ziehen!",separator_before:!0,icon:"style/images/flora_icon_violett.png",action:function(){var e=$.ajax({type:"get",url:"php/beob_karte.php",dataType:"json",data:{apart_id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});e.always(function(e){e.rows.length>0?$.ajax({type:"get",url:"php/ap_karte.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))},success:function(t){t.rows.length>0?window.apf.gmap.zeigeBeobUndTPop(e,t):window.apf.gmap.zeigeBeob(e)}}):window.apf.melde("Es gibt keine Beobachtung mit Koordinaten","Aktion abgebrochen")}),e.fail(function(){console.log("Fehler: Keine Daten erhalten")})}}},window.apf.beob_zugeordnet_node_ausgeschnitten&&(t.einfuegen={label:$.jstree._reference(window.apf.beob_zugeordnet_node_ausgeschnitten).get_text(window.apf.beob_zugeordnet_node_ausgeschnitten)+" einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){$("#tree").jstree("move_node",window.apf.beob_zugeordnet_node_ausgeschnitten,i,"first")}}),t;case"beob_nicht_beurteilt":return t={GoogleMaps:{label:"auf Luftbild zeigen",separator_before:!0,icon:"style/images/flora_icon_violett.png",action:function(){var e=$.ajax({type:"get",url:"php/beob_karte.php",dataType:"json",data:{beobid:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});e.always(function(e){e.rows.length>0?window.apf.gmap.zeigeBeob(e):window.apf.melde("Es gibt keine Beobachtung mit Koordinaten","Aktion abgebrochen")}),e.fail(function(){console.log("Fehler: Keine Daten erhalten")})}},GoogleMapsMitTPopBeob:{label:"auf Luftbild einer Teilpopulation<br>&nbsp;&nbsp;&nbsp;zuordnen",separator_before:!0,icon:"style/images/flora_icon_violett.png",action:function(){var e=$.ajax({type:"get",url:"php/beob_karte.php",dataType:"json",data:{beobid:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});e.always(function(e){if(e.rows.length>0){var t=$.ajax({type:"get",url:"php/ap_karte.php",dataType:"json",data:{id:window.apf.erstelleIdAusDomAttributId($(o).attr("id"))}});t.always(function(t){t.rows.length>0?window.apf.gmap.zeigeBeobUndTPop(e,t):window.apf.gmap.zeigeBeob(e)})}else window.apf.melde("Die Beobachtung hat keine Koordinaten<br>Bitte im Formular zuordnen","Aktion abgebrochen")}),e.fail(function(){console.log("Fehler: Keine Daten erhalten")})}},GisBrowser:{label:"im GIS-Browser zeigen",separator_before:!0,icon:"style/images/wappen_zuerich.png",action:function(){window.apf.zeigeBeobKoordinatenImGisBrowser()}}},window.apf.beob_node_ausgeschnitten||(t.ausschneiden={label:"ausschneiden",separator_before:!0,icon:"style/images/ausschneiden.png",action:function(){window.apf.prüfeSchreibvoraussetzungen()&&(window.apf.beob_node_ausgeschnitten=i)}}),window.apf.beob_zugeordnet_node_ausgeschnitten&&(t.einfuegen={label:$.jstree._reference(window.apf.beob_zugeordnet_node_ausgeschnitten).get_text(window.apf.beob_zugeordnet_node_ausgeschnitten)+" einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){$("#tree").jstree("move_node",window.apf.beob_zugeordnet_node_ausgeschnitten,o,"first")}}),t;case"ap_ordner_beob_nicht_zuzuordnen":return t={GoogleMaps:{label:"auf Luftbild zeigen",separator_before:!0,icon:"style/images/flora_icon_violett.png",action:function(){var e=$.ajax({type:"get",url:"php/beob_karte.php",dataType:"json",data:{apart_id:window.apf.erstelleIdAusDomAttributId($(i).attr("id")),nicht_zuzuordnen:"1"}});e.always(function(e){e.rows.length>0?window.apf.gmap.zeigeBeob(e):window.apf.melde("Es gibt keine Beobachtung mit Koordinaten","Aktion abgebrochen")}),e.fail(function(){console.log("Fehler: Keine Daten erhalten")})}}},window.apf.beob_zugeordnet_node_ausgeschnitten&&(t.einfuegen={label:$.jstree._reference(window.apf.beob_zugeordnet_node_ausgeschnitten).get_text(window.apf.beob_zugeordnet_node_ausgeschnitten)+" einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){$("#tree").jstree("move_node",window.apf.beob_zugeordnet_node_ausgeschnitten,i,"first")}}),t;case"beob_nicht_zuzuordnen":return t={GoogleMaps:{label:"auf Luftbild zeigen",separator_before:!0,icon:"style/images/flora_icon_violett.png",action:function(){var e=$.ajax({type:"get",url:"php/beob_karte.php",dataType:"json",data:{beobid:window.apf.erstelleIdAusDomAttributId($(i).attr("id"))}});e.always(function(e){e.rows.length>0?window.apf.gmap.zeigeBeob(e):window.apf.melde("Es gibt keine Beobachtung mit Koordinaten","Aktion abgebrochen")}),e.fail(function(){console.log("Fehler: Keine Daten erhalten")})}},GisBrowser:{label:"im GIS-Browser zeigen",separator_before:!0,icon:"style/images/wappen_zuerich.png",action:function(){window.apf.zeigeBeobKoordinatenImGisBrowser()}}},window.apf.beob_node_ausgeschnitten||(t.ausschneiden={label:"ausschneiden",separator_before:!0,icon:"style/images/ausschneiden.png",action:function(){window.apf.prüfeSchreibvoraussetzungen()&&(window.apf.beob_node_ausgeschnitten=i)}}),window.apf.beob_zugeordnet_node_ausgeschnitten&&(t.einfuegen={label:$.jstree._reference(window.apf.beob_zugeordnet_node_ausgeschnitten).get_text(window.apf.beob_zugeordnet_node_ausgeschnitten)+" einfügen",separator_before:!0,icon:"style/images/einfuegen.png",action:function(){$("#tree").jstree("move_node",window.apf.beob_zugeordnet_node_ausgeschnitten,o,"first")}}),t}},window.apf.tpopKopiertInPopOrdnerTpopEinfügen=function(e){"use strict";var t=$.ajax({type:"post",url:"php/tpop_insert_kopie.php",dataType:"json",data:{user:sessionStorage.User,PopId:window.apf.erstelleIdAusDomAttributId($(e).attr("id")),TPopId:window.apf.erstelleIdAusDomAttributId($(window.apf.tpop_node_kopiert).attr("id"))}});t.always(function(t){var i="tpop",n=window.apf.tpop_objekt_kopiert.TPopFlurname;window.apf.tpop_objekt_kopiert.TPopNr&&(n=window.apf.tpop_objekt_kopiert.TPopNr+": "+window.apf.tpop_objekt_kopiert.TPopFlurname),window.apf.insertNeuenNodeEineHierarchiestufeTiefer(e,"",i,t,n)}),t.fail(function(){console.log("Fehler: Die Teilpopulation wurde nicht erstellt")})},window.apf.tpopKopiertInTpopEinfügen=function(e,t){"use strict";var i={};if(window.apf.prüfeSchreibvoraussetzungen()){t||(t=$.jstree._reference(e)._get_parent(e)),i.MutWer=sessionStorage.User,i.PopId=window.apf.erstelleIdAusDomAttributId($(t).attr("id")),delete window.apf.tpop_objekt_kopiert.PopId,delete window.apf.tpop_objekt_kopiert.TPopId,delete window.apf.tpop_objekt_kopiert.MutWann,delete window.apf.tpop_objekt_kopiert.MutWer,_.each(window.apf.tpop_objekt_kopiert,function(e,t){null!==e&&(i[t]=e)});var n=$.ajax({type:"post",url:"php/tpop_insert_kopie.php",dataType:"json",data:i});n.always(function(i){var n="tpop",o=window.apf.tpop_objekt_kopiert.TPopNr+" "+window.apf.tpop_objekt_kopiert.TPopFlurname;window.apf.insertNeuenNodeAufGleicherHierarchiestufe(e,t,n,i,o)}),n.fail(function(){console.log("Fehler: Die Teilpopulation wurde nicht erstellt")})}},window.apf.prüfeLesevoraussetzungen=function(){"use strict";return navigator.onLine?!0:(console.log("offline"),$("#offline_dialog").show().dialog({modal:!0,width:400,buttons:{Ok:function(){$(this).dialog("close")}}}),!1)},window.apf.prüfeSchreibvoraussetzungen=function(){"use strict";return window.apf.prüfeLesevoraussetzungen()?sessionStorage.NurLesen?(window.apf.melde("Sie haben keine Schreibrechte","Speichern abgebrochen"),!1):!0:void 0},window.apf.speichern=function(e){"use strict";var t,i,n,o,a,s=$("#PopName"),r=$("#PopNr"),l=$("#tree"),p=$("#PopBerJahr"),h=$('input[name="PopBerEntwicklung"]:checked'),d=$("#spanPopBerEntwicklung"+h.val()),c=$("#spanPopMassnBerErfolgsbeurteilung"+$('input[name="PopMassnBerErfolgsbeurteilung"]:checked').val()),u=$("#PopMassnBerJahr"),f=$("#TPopNr"),g=$("#TPopFlurname"),m=$("#TPopBerJahr"),_=$("#spanTPopBerEntwicklung"+$('input[name="TPopBerEntwicklung"]:checked').val()),w=$("#TPopMassnJahr"),b=$("#TPopMassnTyp option:checked"),v=$("#TPopMassnBerJahr"),y=$("#spanTPopMassnBerErfolgsbeurteilung"+$('input[name="TPopMassnBerErfolgsbeurteilung"]:checked').val()),k=$("#ZielBerJahr"),x=$("#ZielBerErreichung"),M=$("#SpanErfkritErreichungsgrad"+$("input:radio[name='ErfkritErreichungsgrad']:checked").val()),T=$("#BerJahr"),P=$("#BerTitel");if(window.apf.prüfeSchreibvoraussetzungen()){if(i=$(e).attr("formular"),n=e.name,t=$(e).attr("type")||null,o=t&&"checkbox"===t?$("input:checkbox[name="+n+"]:checked").val():t&&"radio"===t?$("input:radio[name="+n+"]:checked").val():$("#"+n).val(),("PopHerkunftUnklar"===n||"TPopHerkunftUnklar"===n||"TPopMassnPlan"===n||"TPopKontrPlan"===n)&&(o=o?1:""),"BeobBemerkungen"===n&&"nicht_beurteilt"===localStorage.beob_status)return $("#BeobBemerkungen").val(""),void window.apf.melde("Bemerkungen sind nur in zugeordneten oder nicht zuzuordnenden Beobachtungen möglich","Aktion abgebrochen");var S=$.ajax({type:"post",url:"php/"+i+"_update.php",dataType:"json",data:{id:localStorage[i+"_id"],Feld:n,Wert:o,user:sessionStorage.User}});switch(S.always(function(){return window.apf[i][n]=o,"ApArtId"===n&&o?void window.apf.wähleAp(o):("TPopKontrDatum"===n&&o&&(a={},a.name="TPopKontrJahr",a.formular="tpopfeldkontr",window.apf.speichern(a)),"TPopMassnDatum"===n&&o&&(a={},a.name="TPopMassnJahr",a.formular="tpopmassn",window.apf.speichern(a)),void(o||("TPopKontrZaehleinheit1"===n&&(window.apf.tpopfeldkontr.TPopKontrMethode1&&$("#TPopKontrMethode1"+window.apf.tpopfeldkontr.TPopKontrMethode1).prop("checked",!1),$("#TPopKontrAnz1").val(""),a={},a.name="TPopKontrMethode1",a.formular=i,window.apf.speichern(a),a={},a.name="TPopKontrAnz1",a.formular=i,window.apf.speichern(a)),"TPopKontrZaehleinheit2"===n&&(window.apf.tpopfeldkontr.TPopKontrMethode2&&$("#TPopKontrMethode2"+window.apf.tpopfeldkontr.TPopKontrMethode2).prop("checked",!1),$("#TPopKontrAnz2").val(""),a={},a.name="TPopKontrMethode2",a.formular=i,window.apf.speichern(a),a={},a.name="TPopKontrAnz2",a.formular=i,window.apf.speichern(a)),"TPopKontrZaehleinheit3"===n&&(window.apf.tpopfeldkontr.TPopKontrMethode3&&$("#TPopKontrMethode3"+window.apf.tpopfeldkontr.TPopKontrMethode3).prop("checked",!1),$("#TPopKontrAnz3").val(""),a={},a.name="TPopKontrMethode3",a.formular=i,window.apf.speichern(a),a={},a.name="TPopKontrAnz3",a.formular=i,window.apf.speichern(a)))))}),S.fail(function(){console.log("Fehler: Die letzte Änderung wurde nicht gespeichert")}),n){case"PopNr":case"PopName":var I;I=s.val()&&r.val()?r.val()+": "+s.val():s.val()?"(keine Nr): "+s.val():r.val()?r.val()+": (kein Name)":"(keine Nr, kein Name)",l.jstree("rename_node","[typ='ap_ordner_pop'] #"+localStorage.pop_id,I);break;case"PopBerJahr":case"PopBerEntwicklung":var z;z=p.val()&&d.text()?p.val()+": "+d.text():p.val()?p.val()+": (kein Status)":d.text()?"(kein Jahr): "+d.text():"(kein Jahr): (kein Status)",l.jstree("rename_node","[typ='pop_ordner_popber'] #"+localStorage.popber_id,z);break;case"PopMassnBerJahr":case"PopMassnBerErfolgsbeurteilung":var C;C=u.val()&&c.text()?u.val()+": "+c.text():u.val()?u.val()+": (nicht beurteilt)":c.text()?"(kein Jahr): "+c.text():"(kein Jahr): (nicht beurteilt)",l.jstree("rename_node","[typ='pop_ordner_massnber'] #"+localStorage.popmassnber_id,C);break;case"TPopNr":case"TPopFlurname":var D;D=f.val()&&g.val()?f.val()+": "+g.val():g.val()?"(keine Nr): "+g.val():f.val()?f.val()+": (kein Flurname)":"(keine Nr, kein Flurname)",l.jstree("rename_node","[typ='pop_ordner_tpop'] #"+localStorage.tpop_id,D);break;case"TPopKontrTyp":case"TPopKontrJahr":var j,A="(kein Jahr)",E=$("#TPopKontrJahr").val();E&&(A=E),l.jstree("rename_node","[typ='tpop_ordner_freiwkontr'] #"+localStorage.tpopfeldkontr_id,A),j=window.apf.erstelleLabelFürFeldkontrolle(E,$("#spanTPopKontrTyp"+$('input[name="TPopKontrTyp"]:checked').val()).text()),l.jstree("rename_node","[typ='tpop_ordner_feldkontr'] #"+localStorage.tpopfeldkontr_id,j);break;case"TPopBerJahr":case"TPopBerEntwicklung":var F,N;F=m.val()?m.val():"(kein Jahr)",N=_.text()?_.text():"(keine Beurteilung)",l.jstree("rename_node","[typ='tpop_ordner_tpopber'] #"+localStorage.tpopber_id,F+": "+N);break;case"TPopMassnJahr":case"TPopMassnTyp":var B;B=w.val()&&b.text()?w.val()+": "+b.text():w.val()?w.val()+": (kein Typ)":b.text()?"(kein Jahr): "+b.text():"(kein Jahr): (kein Typ)",B=window.apf.erstelleLabelFürMassnahme(w.val(),b.text()),l.jstree("rename_node","[typ='tpop_ordner_massn'] #"+localStorage.tpopmassn_id,B);break;case"TPopMassnBerJahr":case"TPopMassnBerErfolgsbeurteilung":var L;L=v.val()&&y.text()?v.val()+": "+y.text():v.val()?v.val()+": (keine Beurteilung)":y.text()?"(kein Jahr): "+y.text():"(kein Jahr): (keine Beurteilung)",l.jstree("rename_node","[typ='tpop_ordner_massnber'] #"+localStorage.tpopmassnber_id,L);break;case"ZielBezeichnung":var K;K=o?o:"(Ziel nicht beschrieben)",l.jstree("rename_node","[typ='apzieljahr'] #"+localStorage.apziel_id,K);break;case"ZielBerJahr":case"ZielBerErreichung":var O;O=k.val()&&x.val()?k.val()+": "+x.val():k.val()?k.val()+": (keine Beurteilung)":x.val()?"(kein Jahr): "+x.val():"(kein Jahr): (keine Beurteilung)",l.jstree("rename_node","[typ='zielber_ordner'] #"+localStorage.zielber_id,O);break;case"ErfkritErreichungsgrad":case"ErfkritTxt":var H;H=M.text()&&$("#ErfkritTxt").val()?M.text()+": "+$("#ErfkritTxt").val():M.text()?M.text()+": (kein Kriterium)":$("#ErfkritTxt").val()?"(keine Beurteilung): "+$("#ErfkritTxt").val():"(keine Beurteilung): (kein Kriterium)",l.jstree("rename_node","[typ='ap_ordner_erfkrit'] #"+localStorage.erfkrit_id,H);break;case"JBerJahr":var W;W=o?o:"(kein Jahr)",l.jstree("rename_node","[typ='ap_ordner_jber'] #"+localStorage.jber_id,W);break;case"BerTitel":case"BerJahr":var R;R=T.val()&&P.val()?T.val()+": "+P.val():T.val()?T.val()+": (kein Titel)":P.val()?"(kein Jahr): "+P.val():"(kein Jahr): (kein Titel)",l.jstree("rename_node","[typ='ap_ordner_ber'] #"+localStorage.ber_id,R);break;case"AaSisfNr":var q;q=o?$("#AaSisfNr option[value='"+o+"']").text():"(kein Artname)",l.jstree("rename_node","[typ='ap_ordner_assozarten'] #"+localStorage.assozarten_id,q)}}},function(e){e.fn.serializeObject=function(){var t,i;return t={},i=this.serializeArray(),e.each(i,function(){this.value&&(t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value)):t[this.name]=this.value)}),t}}(jQuery),window.apf.DdInWgs84BreiteGrad=function(e){"use strict";var t=Math.floor(e);return t},window.apf.DdInWgs84BreiteMin=function(e){"use strict";var t=Math.floor(e),i=Math.floor(60*(e-t));return i},window.apf.DdInWgs84BreiteSec=function(e){"use strict";var t=Math.floor(e),i=Math.floor(60*(e-t)),n=Math.round(60*(e-t-i/60)*60*100)/100;return n},window.apf.DdInWgs84LängeGrad=function(e){"use strict";var t=Math.floor(e);return t},window.apf.DdInWgs84LängeMin=function(e){"use strict";var t=Math.floor(e),i=Math.floor(60*(e-t));return i},window.apf.DdInWgs84LängeSec=function(e){"use strict";var t=Math.floor(e),i=Math.floor(60*(e-t)),n=Math.round(60*(e-t-i/60)*60*100)/100;return n},window.apf.Wgs84InChX=function(e,t,i,n,o,a){"use strict";var s=i+60*t+3600*e,r=a+60*o+3600*n,l=(s-169028.66)/1e4,p=(r-26782.5)/1e4,h=200147.07+308807.95*l+3745.25*Math.pow(p,2)+76.63*Math.pow(l,2)-194.56*Math.pow(p,2)*l+119.79*Math.pow(l,3);return h},window.apf.Wgs84InChY=function(e,t,i,n,o,a){"use strict";var s=i+60*t+3600*e,r=a+60*o+3600*n,l=(s-169028.66)/1e4,p=(r-26782.5)/1e4,h=600072.37+211455.93*p-10938.51*p*l-.36*p*Math.pow(l,2)-44.54*Math.pow(p,3);return h},window.apf.DdInChX=function(e,t){"use strict";var i=window.apf.DdInWgs84BreiteGrad(e),n=window.apf.DdInWgs84BreiteMin(e),o=window.apf.DdInWgs84BreiteSec(e),a=window.apf.DdInWgs84LängeGrad(t),s=window.apf.DdInWgs84LängeMin(t),r=window.apf.DdInWgs84LängeSec(t),l=Math.floor(window.apf.Wgs84InChX(i,n,o,a,s,r));return l},window.apf.DdInChY=function(e,t){"use strict";var i=window.apf.DdInWgs84BreiteGrad(e),n=window.apf.DdInWgs84BreiteMin(e),o=window.apf.DdInWgs84BreiteSec(e),a=window.apf.DdInWgs84LängeGrad(t),s=window.apf.DdInWgs84LängeMin(t),r=window.apf.DdInWgs84LängeSec(t),l=Math.floor(window.apf.Wgs84InChY(i,n,o,a,s,r));return l},window.apf.CHtoWGSlat=function(e,t){"use strict";var i=(e-6e5)/1e6,n=(t-2e5)/1e6,o=16.9023892+3.238272*n-.270978*Math.pow(i,2)-.002528*Math.pow(n,2)-.0447*Math.pow(i,2)*n-.014*Math.pow(n,3);return o=100*o/36},window.apf.CHtoWGSlng=function(e,t){"use strict";var i=(e-6e5)/1e6,n=(t-2e5)/1e6,o=2.6779094+4.728982*i+.791484*i*n+.1306*i*Math.pow(n,2)-.0436*Math.pow(i,3);return o=100*o/36},window.apf.gmap.zeigeTPop=function(e){"use strict";function t(e,t,i){google.maps.event.addListener(t,"click",function(){n.setContent(i),n.open(e,t)})}var i,n,o,a,s,r,l,p,h,d,c,u,f,g,m,w,b;window.apf.zeigeFormular("google_karte"),window.apf.gmap.markers_array=[],window.apf.gmap.info_window_array=[],n=new google.maps.InfoWindow,_.each(e.rows,function(t,i){t.TPopXKoord&&t.TPopYKoord?(t.Lat=window.apf.CHtoWGSlat(parseInt(t.TPopXKoord),parseInt(t.TPopYKoord)),t.Lng=window.apf.CHtoWGSlng(parseInt(t.TPopXKoord),parseInt(t.TPopYKoord))):delete e.rows[i]}),i=e.rows.length,a=47.383333,s=8.533333,r=new google.maps.LatLng(a,s),l={zoom:15,center:r,streetViewControl:!1,mapTypeId:google.maps.MapTypeId.SATELLITE},p=new google.maps.Map(document.getElementById("google_karten_div"),l),window.apf.gmap.map=p,h=new google.maps.LatLngBounds,d=[],_.each(e.rows,function(e){c=e.TPopId,o=window.apf.beschrifteTPopMitNrFürKarte(e.PopNr,e.TPopNr),u=new google.maps.LatLng(e.Lat,e.Lng),1===i?r=u:h.extend(u),f=new MarkerWithLabel({map:p,position:u,title:o,labelContent:o,labelAnchor:new google.maps.Point(75,0),labelClass:"MapLabel",icon:"img/flora_icon.png"}),d.push(f),b=e.TPopFlurname||"(kein Flurname)",g='<div id="content"><div id="siteNotice"></div><div id="bodyContent" class="GmInfowindow"><h3>'+e.Artname+"</h3><p>Population: "+e.PopName+"</p><p>TPop: "+b+"</p><p>Koordinaten: "+e.TPopXKoord+" / "+e.TPopYKoord+'</p><p><a href="#" onclick="window.apf.öffneTPop(\''+e.TPopId+'\')">Formular anstelle Karte öffnen</a></p><p><a href="#" onclick="window.apf.öffneFormularAlsPopup(\'tpop\', '+e.TPopId+')">Formular neben der Karte öffnen</a></p><p><a href="#" onclick="window.apf.öffneTPopInNeuemTab(\''+e.TPopId+"')\">Formular in neuem Fenster öffnen</a></p></div></div>",t(p,f,g)
}),m={maxZoom:17,styles:[{height:53,url:"img/m8.png",width:53}]},window.apf.google_karte_detailpläne=new google.maps.KmlLayer({url:"kml/rueteren.kmz",preserveViewport:!0}),window.apf.google_karte_detailpläne.setMap(null),w=new MarkerClusterer(p,d,m),1===i?(p.setCenter(r),p.setZoom(18)):p.fitBounds(h)},window.apf.olmap.getLayerNames=function(){var e=window.apf.olmap.map.getLayers().getArray(),t=_.map(e,function(e){return e.values_&&e.values_.title?e.values_.title:void 0});return t},window.apf.olmap.getLayersWithTitle=function(){var e=window.apf.olmap.map.getLayers().getArray(),t=_.map(e,function(e){return e.get("title")?e:void 0});return t||[]},window.apf.olmap.entferneLayerNachName=function(e){var t,i,n=window.apf.olmap.getLayersWithTitle();_.each(n,function(n){t=n.get("title"),i=n.get("kategorie"),t===e&&(window.apf.olmap.map.removeLayer(n),"Eigene Ebenen"===i&&(console.log("entferneLayerNachName meldet: lasse entfernen layer mit title "+t),window.apf.olmap.aktualisiereEbeneInLocalStorage(n,!0)))})},window.apf.olmap.entferneAlleApfloraLayer=function(){"use strict";if(window.apf.olmap&&window.apf.olmap.map){var e,t,i=window.apf.olmap.map.getLayers().getArray(),n=[];_.each(i,function(i){e=i.get("kategorie"),t=i.get("title"),e&&"AP Flora"===e&&"Detailpläne"!==t&&n.push(i)}),_.each(n,function(e){window.apf.olmap.map.removeLayer(e)}),window.apf.olmap.initiiereLayertree()}},window.apf.aktualisiereKoordinatenVonTPop=function(e){var t=$.Deferred(),i=$.ajax({type:"post",url:"php/tpop_update.php",dataType:"json",data:{id:e.TPopId,Feld:"TPopXKoord",Wert:e.TPopXKoord,user:sessionStorage.User}});return i.always(function(){var i=$.ajax({type:"post",url:"php/tpop_update.php",dataType:"json",data:{id:e.TPopId,Feld:"TPopYKoord",Wert:e.TPopYKoord,user:sessionStorage.User}});i.always(function(){t.resolve()})}),t.promise()},window.apf.olmap.stapleLayerZuoberst=function(e){var t,i=window.apf.olmap.map.getLayers(),n=window.apf.olmap.map.getLayers().getArray();_.each(n,function(o,a){o.get("title")===e&&(t=i.removeAt(a),i.insertAt(n.length,t))}),window.apf.olmap.initiiereLayertree()},window.apf.verorteTPopAufOlmap=function(e){"use strict";var t,i,n,o,a;e.PopNr=window.apf.pop.PopNr,e.PopName=window.apf.pop.PopName,e.Artname=window.apf.ap.Artname,$.when(window.apf.zeigeTPopAufOlmap()).then(function(){window.apf.olmap.deactivateMenuItems(),window.apf.olmap.modify_source=new ol.source.Vector;var s=new ol.layer.Vector({title:"verortende Teilpopulation",kategorie:"AP Flora",source:window.apf.olmap.modify_source,style:function(e,t){return window.apf.olmap.tpopStyle(e,t,!1,!0)}});if(window.apf.olmap.map.addLayer(s),e&&e.TPopXKoord&&e.TPopYKoord){i=parseInt(e.TPopXKoord)+200,n=parseInt(e.TPopXKoord)-200,o=parseInt(e.TPopYKoord)+200,a=parseInt(e.TPopYKoord)-200,t=[n,a,i,o];var r=new ol.Feature(new ol.geom.Point([e.TPopXKoord,e.TPopYKoord]));window.apf.olmap.modify_source.addFeature(r),window.apf.olmap.erstelleModifyInteractionFürTPop(),window.apf.olmap.map.updateSize(),window.apf.olmap.map.getView().fitExtent(t,window.apf.olmap.map.getSize()),setTimeout(function(){window.apf.olmap.stapleLayerZuoberst("verortende Teilpopulation")},200)}else window.apf.olmap.draw_interaction=new ol.interaction.Draw({source:window.apf.olmap.modify_source,type:"Point"}),window.apf.olmap.map.addInteraction(window.apf.olmap.draw_interaction),window.apf.olmap.draw_interaction.once("drawend",function(t){var i=t.feature.getGeometry().getCoordinates();e.TPopXKoord=parseInt(i[0]),e.TPopYKoord=parseInt(i[1]),$.when(window.apf.aktualisiereKoordinatenVonTPop(e)).then(function(){var t=window.apf.olmap.map.getLayers().getArray(),i=$("#olmap_layertree_Teilpopulationen").val(),n=t[i],o=n.getSource();o.addFeature(window.apf.olmap.erstelleMarkerFürTPopLayer(e)),window.apf.olmap.removeSelectFeaturesInSelectableLayers()}),window.apf.olmap.map.removeInteraction(window.apf.olmap.draw_interaction),window.apf.olmap.erstelleModifyInteractionFürTPop()},this),setTimeout(function(){window.apf.olmap.stapleLayerZuoberst("verortende Teilpopulation")},200)})},window.apf.olmap.entferneModifyInteractionFürTpop=function(){"use strict";window.apf.olmap.modify_interaction&&(window.apf.olmap.map.removeInteraction(window.apf.olmap.modify_interaction),delete window.apf.olmap.modify_interaction)},window.apf.olmap.erstelleModifyInteractionFürTPop=function(){"use strict";window.apf.olmap.entferneModifyInteractionFürTpop(),window.apf.olmap.modify_overlay=new ol.FeatureOverlay({style:function(e,t){return window.apf.olmap.tpopStyle(e,t,!1,!0)}}),window.apf.olmap.modify_overlay.addFeature(window.apf.olmap.modify_source.getFeatures()[0]),window.apf.olmap.modify_interaction=new ol.interaction.Modify({features:window.apf.olmap.modify_overlay.getFeatures()}),window.apf.olmap.modify_interaction.zähler=0,window.apf.olmap.modify_overlay.getFeatures().getArray()[0].on("change",function(){var e,t=this.getGeometry().getCoordinates();window.apf.olmap.modify_interaction.zähler++,e=window.apf.olmap.modify_interaction.zähler,setTimeout(function(){e===window.apf.olmap.modify_interaction.zähler&&(window.apf.tpop.TPopXKoord=parseInt(t[0]),window.apf.tpop.TPopYKoord=parseInt(t[1]),$.when(window.apf.aktualisiereKoordinatenVonTPop(window.apf.tpop)).then(function(){var e=window.apf.olmap.map.getLayers().getArray(),i=$("#olmap_layertree_Teilpopulationen").val(),n=e[i],o=n.getSource(),a=o.getFeatures(),s=_.find(a,function(e){return e.get("myId")===window.apf.tpop.TPopId});s.getGeometry().setCoordinates(t),s.set("xkoord",window.apf.tpop.TPopXKoord),s.set("ykoord",window.apf.tpop.TPopYKoord),s.set("popup_content",window.apf.olmap.erstelleContentFürTPop(window.apf.tpop))}))},200)}),window.apf.olmap.map.addInteraction(window.apf.olmap.modify_interaction)},window.apf.olmap.entferneModifyInteractionFürVectorLayer=function(e){"use strict";var t=$(".modify_layer");e=e||null,window.apf.olmap.modify_interaction_für_vectorlayer&&(window.apf.olmap.map.removeInteraction(window.apf.olmap.modify_interaction_für_vectorlayer),window.apf.olmap.map.removeInteraction(window.apf.olmap.select_interaction_für_vectorlayer),window.apf.olmap.map.removeInteraction(window.apf.olmap.draw_interaction_für_vectorlayer),delete window.apf.olmap.modify_interaction_für_vectorlayer,delete window.apf.olmap.select_interaction_für_vectorlayer,delete window.apf.olmap.draw_interaction_für_vectorlayer),t.button({icons:{primary:"ui-icon-locked"},text:!1}).button("refresh"),$(".modify_layer_label").attr("title","Ebene bearbeiten").tooltip({tooltipClass:"tooltip-styling-hinterlegt",content:"Ebene bearbeiten"}),$(".modify_layer_geom_type").hide(),t.each(function(){$(this).prop("checked")&&!$(this).is(e)&&$(this).prop("checked",!1).change()})},window.apf.olmap.erstelleModifyInteractionFürVectorLayer=function(e){"use strict";function t(){"leerwert"!==o.val()&&(window.apf.olmap.draw_interaction_für_vectorlayer=new ol.interaction.Draw({source:e.getSource(),type:o.val()}),window.apf.olmap.map.addInteraction(window.apf.olmap.draw_interaction_für_vectorlayer),window.apf.olmap.draw_interaction_für_vectorlayer.on("drawend",function(t){var i=_.uniqueId();t.feature.setId(i),window.apf.olmap.modified_features=window.apf.olmap.modified_features||[],window.apf.olmap.modified_features=_.union(window.apf.olmap.modified_features,[i]),window.apf.olmap.aktualisiereEbeneInLocalStorage(e)}))}var i={Point:[new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:"rgba(255,255,0,0.5)"}),radius:5,stroke:new ol.style.Stroke({color:"#ff0",width:1})})})],LineString:[new ol.style.Style({stroke:new ol.style.Stroke({color:"#f00",width:3})})],Polygon:[new ol.style.Style({fill:new ol.style.Fill({color:"rgba(0,255,255,0.5)"}),stroke:new ol.style.Stroke({color:"#0ff",width:1})})],MultiPoint:[new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:"rgba(255,0,255,0.5)"}),radius:5,stroke:new ol.style.Stroke({color:"#f0f",width:1})})})],MultiLineString:[new ol.style.Style({stroke:new ol.style.Stroke({color:"#0f0",width:3})})],MultiPolygon:[new ol.style.Style({fill:new ol.style.Fill({color:"rgba(0,0,255,0.5)"}),stroke:new ol.style.Stroke({color:"#00f",width:1})})]};if("neuer_layer"===e)return e=new ol.layer.Vector({guid:window.apf.erstelleGuid(),source:new ol.source.Vector,title:"neue Ebene",kategorie:"Eigene Ebenen",style:function(e){return i[e.getGeometry().getType()]}}),window.apf.olmap.map.addLayer(e),void window.apf.olmap.frageNameFürEbene(e);var n=e.get("title"),o=$("#modify_layer_geom_type_"+n.replace(" ","_"));window.apf.olmap.modified_features=[],window.apf.olmap.entferneModifyInteractionFürVectorLayer(),window.apf.olmap.select_interaction_für_vectorlayer=new ol.interaction.Select({layers:function(e){return e.get("title")===n}}),window.apf.olmap.selected_features=window.apf.olmap.select_interaction_für_vectorlayer.getFeatures(),window.apf.olmap.selected_features.on("add",function(t){var i=t.element,n=i.getId();n||i.setId(_.uniqueId()),i.on("change",function(t){var i=t.target,n=i.getId();window.apf.olmap.modified_features=window.apf.olmap.modified_features||[],window.apf.olmap.modified_features=_.union(window.apf.olmap.modified_features,[n]),window.apf.olmap.aktualisiereEbeneInLocalStorage(e)}),$(document).on("keyup",function(t){46==t.keyCode&&(window.apf.olmap.selected_features.forEach(function(t){var i=t.getId();window.apf.olmap.selected_features.remove(t);var n=e.getSource().getFeatures();n.forEach(function(t){var n=t.getId();n===i&&(e.getSource().removeFeature(t),window.apf.olmap.aktualisiereEbeneInLocalStorage(e))})}),$(document).off("keyup"))}),$.jstree._reference("[typ='ap_ordner_pop']").deselect_all()}),window.apf.olmap.selected_features.on("remove",function(t){var i=t.element,n=i.getId(),o=window.apf.olmap.modified_features.indexOf(n);o>-1&&(window.apf.olmap.aktualisiereEbeneInLocalStorage(e),window.apf.olmap.modified_features.splice(o,1))}),window.apf.olmap.modify_interaction_für_vectorlayer=new ol.interaction.Modify({features:window.apf.olmap.select_interaction_für_vectorlayer.getFeatures(),deleteCondition:function(e){return ol.events.condition.shiftKeyOnly(e)&&ol.events.condition.singleClick(e)}}),o.on("selectmenuchange",function(){window.apf.olmap.map.removeInteraction(window.apf.olmap.draw_interaction_für_vectorlayer),t()}),t(),window.apf.olmap.map.addInteraction(window.apf.olmap.select_interaction_für_vectorlayer),window.apf.olmap.map.addInteraction(window.apf.olmap.modify_interaction_für_vectorlayer)},window.apf.olmap.exportiereLayer=function(e,t){"use strict";var i,n,o=e.get("title")||"Eigene_Ebene",a=e.getSource().getFeatures(),s=new ol.format[t];o+="."+t;try{i=s.writeFeatures(a)}catch(r){return void window.apf.melde("Sorry, das kann Open Layers 3 noch nicht richtig","Fehler beim Export")}if("GeoJSON"===t)try{n=JSON.stringify(i,null,4)}catch(r){window.apf.melde("Sorry, das kann Open Layers 3 noch nicht richtig","Fehler beim Export")}else{var l=new XMLSerializer;try{n=l.serializeToString(i)}catch(r){window.apf.melde("Sorry, das kann Open Layers 3 noch nicht richtig","Fehler beim Export")}}window.apf.download(o,n)},window.apf.download=function(e,t){"use strict";var i=document.createElement("a");i.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),i.setAttribute("download",e),i.click()},window.apf.olmap.istLayerSichtbarNachName=function(e){"use strict";var t,i;return window.apf.olmap.map&&(t=window.apf.olmap.map.getLayers().getArray(),i=_.find(t,function(t){return t.get("title")===e&&t.get("visible")}))?!0:!1},window.apf.zeigeTPopAufOlmap=function(e){"use strict";var t=window.apf.olmap.istLayerSichtbarNachName("Populationen"),i=window.apf.olmap.istLayerSichtbarNachName("Populationen Nummern"),n=window.apf.olmap.wähleAusschnittFürÜbergebeneTPop(e);$.when(window.apf.zeigeFormular("GeoAdminKarte")).then(function(){window.apf.olmap.map.updateSize(),window.apf.olmap.map.getView().fitExtent(n.bounds,window.apf.olmap.map.getSize());var e=$.ajax({type:"get",url:"php/tpop_karte_alle.php",dataType:"json",data:{ApArtId:window.apf.ap.ApArtId}});e.always(function(e){$.when(window.apf.olmap.erstelleTPopLayer(e,n.tpopid_markiert,!0),window.apf.olmap.zeigePopInTPop(t,i)).then(function(){window.apf.olmap.initiiereLayertree()})}),e.fail(function(){console.log("Fehler: Es konnten keine Teilpopulationen aus der Datenbank abgerufen werden")})})},window.apf.zeigePopAufOlmap=function(e){"use strict";window.apf.olmap.LetzterKlickHandler&&window.apf.olmap.LetzterKlickHandler.deactivate();var t=window.apf.olmap.wähleAusschnittFürÜbergebenePop(e);$.when(window.apf.zeigeFormular("GeoAdminKarte")).then(function(){window.apf.olmap.auswahlPolygonLayer&&window.apf.olmap.auswahlPolygonLayer.features.length>0||(window.apf.olmap.map.updateSize(),window.apf.olmap.map.getView().fitExtent(t.bounds,window.apf.olmap.map.getSize()));var e=$.ajax({type:"get",url:"php/tpop_karte_alle.php",dataType:"json",data:{ApArtId:window.apf.ap.ApArtId}});e.always(function(e){$.when(window.apf.olmap.erstelleTPopLayer(e),window.apf.olmap.zeigePopInTPop(!0,!0,t.popid_markiert)).then(function(){window.apf.olmap.initiiereLayertree()})}),e.fail(function(){console.log("Fehler: Es konnten keine Daten aus der Datenbank abgerufen werden")})})},window.apf.olmap.wähleAusschnittFürÜbergebeneTPop=function(e){"use strict";var t,i,n,o,a,s=[],r=[],l=[];return e&&e.rows&&e.rows.length>0?(_.each(e.rows,function(e){l.push(e.TPopId),s.push(e.TPopXKoord),r.push(e.TPopYKoord)}),i=parseInt(_.max(s))+70,o=parseInt(_.min(s))-70,n=parseInt(_.max(r))+70,a=parseInt(_.min(r))-70,t=[o,a,i,n]):t=[669e3,222e3,717e3,284e3],{bounds:t,tpopid_markiert:l}},window.apf.olmap.wähleAusschnittFürÜbergebenePop=function(e){"use strict";var t,i,n,o,a,s=[],r=[],l=[];return e&&e.rows.length>0?(_.each(e.rows,function(e){l.push(e.PopId),s.push(e.PopXKoord),r.push(e.PopYKoord)}),i=parseInt(_.max(s))+70,o=parseInt(_.min(s))-70,n=parseInt(_.max(r))+70,a=parseInt(_.min(r))-70,t=[o,a,i,n]):t=[669e3,222e3,717e3,284e3],{bounds:t,popid_markiert:l}},window.apf.olmap.zeigePopInTPop=function(e,t,i){"use strict";var n=$.Deferred(),o=$.ajax({type:"get",url:"php/pop_karte_alle.php",dataType:"json",data:{ApArtId:window.apf.ap.ApArtId}});return o.always(function(t){$.when(window.apf.olmap.erstellePopLayer(t,i,e)).then(function(){window.apf.olmap.initiiereLayertree(),n.resolve()})}),o.fail(function(){console.log("Fehler: Es konnten keine Daten aus der Datenbank abgerufen werden"),n.resolve()}),n.promise()},window.apf.olmap.erstelleTPopulation=function(e){"use strict";var t,i=new OpenLayers.Style({externalGraphic:"//www.apflora.ch/img/flora_icon_rot.png",graphicWidth:32,graphicHeight:37,graphicYOffset:-37,title:"${tooltip}"}),n=(new OpenLayers.Style({externalGraphic:"//www.apflora.ch/img/flora_icon_gelb.png"}),new OpenLayers.Layer.Vector("Teilpopulation",{styleMap:new OpenLayers.StyleMap({"default":i,select:i})})),o=new OpenLayers.Geometry.Point(e.TPopXKoord,e.TPopYKoord),a=e.TPopFlurname||"(kein Flurname)";t=window.apf.pop.PopNr&&e.TPopNr?window.apf.pop.PopNr+"/"+e.TPopNr+" "+a:window.apf.pop.PopNr?window.apf.pop.PopNr+"/? "+a:e.TPopNr?"?/"+e.TPopNr+" "+a:"?/? "+a;var s=new OpenLayers.Feature.Vector(o,{tooltip:t});n.addFeatures(s);var r=new OpenLayers.Control.DragFeature(n,{onComplete:function(t){e.TPopXKoord=t.geometry.x,e.TPopYKoord=t.geometry.y,window.apf.speichereWert("tpop",localStorage.tpop_id,"TPopXKoord",e.TPopXKoord),window.apf.speichereWert("tpop",localStorage.tpop_id,"TPopYKoord",e.TPopYKoord)}});window.apf.olmap.addControl(r),r.activate(),window.apf.olmap.addLayer(n),window.selectControlTPop=new OpenLayers.Control.SelectFeature(n,{clickout:!0}),window.apf.olmap.addControl(window.selectControlTPop),window.selectControlTPop.activate()},window.apf.speichereWert=function(e,t,i,n){"use strict";var o=$.ajax({type:"post",url:"php/"+e+"_update.php",dataType:"json",data:{id:t,Feld:i,Wert:n,user:sessionStorage.User}});o.fail(function(){console.log("Fehler: Die letzte Änderung wurde nicht gespeichert")})},window.apf.olmap.erstelleContentFürTPop=function(e){"use strict";var t=e.TPopFlurname||"(kein Flurname)";return"<table><tr><td><p>Typ:</p></td><td><p>Teilpopulation</p></td></tr><tr><td><p>Population:</p></td><td><p>"+e.PopName+"</p></td></tr><tr><td><p>Teilpopulation:</p></td><td><p>"+t+"</p></td></tr><tr><td><p>Koordinaten:</p></td><td><p>"+e.TPopXKoord+" / "+e.TPopYKoord+'</p></td></tr></table><p><a href="#" onclick="window.apf.öffneTPop(\''+e.TPopId+'\')">Formular anstelle Karte öffnen</a></p><p><a href="#" onclick="window.apf.öffneFormularAlsPopup(\'tpop\', '+e.TPopId+')">Formular neben der Karte öffnen</a></p><p><a href="#" onclick="window.apf.öffneTPopInNeuemTab(\''+e.TPopId+"')\">Formular in neuem Fenster öffnen</a></p>"},window.apf.olmap.listSelectedFeatures=function(e){"use strict";var t,i=window.apf.olmap.map.olmap_select_interaction.getFeatures().getArray();return t=_.filter(i,function(t){return e?t.get("myTyp")===e:t.get("myTyp")})},window.apf.olmap.erstelleListeDerAusgewähltenPopTPop=function(e,t){"use strict";var i,n,o="";window.apf.olmap.pop_selected=e,window.apf.olmap.tpop_selected=t,e.length>0&&(e=_.sortBy(e,function(e){var t=e.get("pop_nr");return parseInt(t)}),t.length>0&&(o+="<p class='ergebnisAuswahlListeTitel'>"+e.length+" Populationen: </p>"),o+="<table>",_.each(e,function(e){i=e.get("myId"),o+='<tr><td><a href="#" onclick="window.apf.öffnePop(\''+i+"')\">",o+=e.get("pop_nr")+':</a></td><td><a href="#" onclick="window.apf.öffnePop(\''+i+"')\">"+e.get("pop_name")+"</a></td></tr>"}),o+="</table>"),t.length>0&&(t=_.sortBy(t,function(e){var t=e.get("pop_nr")||0,i=e.get("tpop_nr")||0,n=parseFloat(parseInt(t)+"."+parseInt(i));return n}),e.length>0&&(o+="<p class='ergebnisAuswahlListeTitel ergebnisAuswahlListeTitelTPop'>"+t.length+" Teilpopulationen: </p>"),o+="<table>",_.each(t,function(e){n=e.get("myId"),o+='<tr><td><a href="#" onclick="window.apf.öffneTPopInNeuemTab(\''+n+"')\">",o+=e.get("tpop_nr_label")+':</a></td><td><a href="#" onclick="window.apf.öffneTPopInNeuemTab(\''+n+"')\">",o+=e.get("tpop_name")+"</a></td></tr>"}),o+="</table>");var a="auto";t.length>25&&(a=650);var s,r="Exportieren: ",l="<a href='#' class='export_pop'>Populationen</a>",p="<a href='#' class='export_tpop'>Teilpopulationen</a>, <a href='#' class='export_kontr'>Kontrollen</a>, <a href='#' class='export_massn'>Massnahmen</a>";e.length>0&&t.length>0?(s="Gewählt wurden "+e.length+" Populationen und "+t.length+" Teilpopulationen",r+=l+", "+p):e.length>0?(s="Gewählt wurden "+e.length+" Populationen:",r+=l):t.length>0?(s="Gewählt wurden "+t.length+" Teilpopulationen:",r+=p):(s="Keine Populationen/Teilpopulationen gewählt",r=""),$("#ergebnisAuswahlHeaderText").html(s),$("#ergebnisAuswahlListe").html(o),$("#ergebnisAuswahlFooter").html(r),$("#ergebnisAuswahl").css("display","block")},window.apf.olmap.sucheFeatures=function(e){var t=[];return window.apf.olmap.map.forEachFeatureAtPixel(e,function(e){t.push(e)}),t},window.apf.olmap.entfernePopupOverlays=function(){var e=window.apf.olmap.map.getOverlays().getArray(),t=[];_.each(e,function(e){"popup"===e.get("typ")&&t.push(e)}),_.each(t,function(e){window.apf.olmap.map.removeOverlay(e)}),$(".qtip").each(function(){$(this).qtip("destroy",!0)})},window.apf.olmap.zeigeFeatureInfo=function(e,t){var i,n,o,a,s,r=window.apf.olmap.sucheFeatures(e),l=[],p="";s=_.filter(r,function(e){return e.get("myTyp")||e.get("popup_title")}),s&&s.length>0?(s.length>1?(_.each(s,function(e,t){"Detailplan"===e.get("myTyp")?(p+="<h3>Objekt ID: "+e.get("OBJECTID")+"</h3>",p+="<table><tr><td><p>Typ:</p></td><td><p>Detailplan</p></td></tr><tr><td><p>Fläche:</p></td><td><p>"+parseInt(e.get("SHAPE_Area")/10)+"</p></td></tr><tr><td><p>Bemerkunge:</p></td><td><p>"+(e.get("Bemerkunge")||"")+"</p></td></tr><tr><td><p>Bemerkun_1:</p></td><td><p>"+(e.get("Bemerkun_1")||"")+"</p></td></tr></table>"):(p+="<h3>"+e.get("popup_title")+"</h3>",p+=e.get("popup_content")),t+1<s.length&&(p+="<hr>")}),a=s.length+" Treffer",o=t):("Detailplan"===s[0].get("myTyp")?(p="<table><tr><td><p>Typ:</p></td><td><p>Detailplan</p></td></tr><tr><td><p>Fläche:</p></td><td><p>"+parseInt(s[0].get("SHAPE_Area")/10)+"</p></td></tr><tr><td><p>Bemerkunge:</p></td><td><p>"+(s[0].get("Bemerkunge")||"")+"</p></td></tr><tr><td><p>Bemerkun_1:</p></td><td><p>"+(s[0].get("Bemerkun_1")||"")+"</p></td></tr></table>",a="Objekt ID: "+s[0].get("OBJECTID")):(p=s[0].get("popup_content"),a=s[0].get("popup_title")),o=s[0].get("xkoord")&&s[0].get("ykoord")?[s[0].get("xkoord"),s[0].get("ykoord")]:t),$(".olmap_popup").each(function(){$(this).qtip({content:{text:p,title:a,button:"Close"},style:{widget:!0,def:!1,classes:"olmap_popup_styling",tip:{width:20,height:20}},position:{my:"top left",at:"bottom right",target:$(this),viewport:$("#GeoAdminKarte")}}),$(this).qtip("toggle",!0)}),$(".qtip").each(function(){l.push($(this).attr("data-qtip-id"))}),n=_.max(l),i=new ol.Overlay({element:$("#qtip-"+n)}),window.apf.olmap.map.addOverlay(i),i.setPosition(o),i.set("typ","popup")):window.apf.olmap.entfernePopupOverlays()},window.apf.olmap.erstelleContentFürPop=function(e){"use strict";return"<table><tr><td><p>Typ:</p></td><td><p>Population</p></td></tr><tr><td><p>Koordinaten:</p></td><td><p>"+e.PopXKoord+" / "+e.PopYKoord+'</p></td></tr></table><p><a href="#" onclick="window.apf.öffnePop(\''+e.PopId+'\')">Formular anstelle Karte öffnen</a></p><p><a href="#" onclick="window.apf.öffneFormularAlsPopup(\'pop\', '+e.PopId+')">Formular neben der Karte öffnen</a></p><p><a href="#" onclick="window.apf.öffnePopInNeuemTab(\''+e.PopId+"')\">Formular in neuem Fenster öffnen</a></p>"},window.apf.olmap.erstellePopLayer=function(e,t,i){"use strict";var n,o,a,s,r,l,p=$.Deferred(),h=[];return window.apf.olmap.map&&window.apf.olmap.map.olmap_select_interaction&&t?l=window.apf.olmap.map.olmap_select_interaction.getFeatures().getArray():t&&(window.apf.olmap.addSelectFeaturesInSelectableLayers(),l=window.apf.olmap.map.olmap_select_interaction.getFeatures().getArray()),null===i&&(i=!0),_.each(e.rows,function(e){a=e.PopName||"(kein Name)",s=window.apf.olmap.erstelleContentFürPop(e),o=e.PopNr?e.PopNr.toString():"?",n=new ol.Feature({geometry:new ol.geom.Point([e.PopXKoord,e.PopYKoord]),pop_nr:o,pop_name:a,name:o,popup_content:s,popup_title:a,xkoord:e.PopXKoord,ykoord:e.PopYKoord,myTyp:"pop",myId:e.PopId}),h.push(n),t&&-1!==t.indexOf(e.PopId)&&l.push(n)}),r=new ol.layer.Vector({title:"Populationen",selectable:!0,source:new ol.source.Vector({features:h}),style:function(e,t){return window.apf.olmap.popStyle(e,t)}}),r.set("visible",i),r.set("kategorie","AP Flora"),window.apf.olmap.map.addLayer(r),l&&l.length>0&&(setTimeout(function(){window.apf.olmap.prüfeObPopTpopGewähltWurden()},100),$("#olmap_auswaehlen").prop("checked",!0).button("refresh")),p.resolve(),p.promise()},window.apf.vergleicheTPopZumSortierenNachTooltip=function(e,t){"use strict";return e.tooltip<t.tooltip?-1:e.tooltip>t.tooltip?1:0},window.apf.deaktiviereGeoAdminAuswahl=function(){"use strict";window.apf.olmap.auswahlPolygonLayer&&window.apf.olmap.auswahlPolygonLayer.removeAllFeatures(),window.drawControl&&window.drawControl.deactivate(),$("#ergebnisAuswahl").css("display","none"),delete window.apf.tpop_id_array,delete window.tpop_id_liste,delete window.apf.pop_id_array,delete window.pop_id_liste},window.apf.erstelleTPopNrLabel=function(e,t){"use strict";return e&&t?e+"/"+t:e?e+"/?":t?"?/"+t:"?/?"},window.apf.olmap.erstelleMarkerFürTPopLayer=function(e){return new ol.Feature({geometry:new ol.geom.Point([e.TPopXKoord,e.TPopYKoord]),tpop_nr:e.TPopNr,pop_nr:e.PopNr,tpop_nr_label:window.apf.erstelleTPopNrLabel(e.PopNr,e.TPopNr),tpop_name:e.TPopFlurname||"(kein Name)",name:window.apf.erstelleTPopNrLabel(e.PopNr,e.TPopNr),popup_content:window.apf.olmap.erstelleContentFürTPop(e),popup_title:e.Artname,xkoord:e.TPopXKoord,ykoord:e.TPopYKoord,myTyp:"tpop",myId:e.TPopId})},window.apf.olmap.erstelleTPopLayer=function(e,t,i){"use strict";var n,o,a,s=$.Deferred(),r=[];return window.apf.olmap.map.olmap_select_interaction&&t?a=window.apf.olmap.map.olmap_select_interaction.getFeatures().getArray():t&&(window.apf.olmap.addSelectFeaturesInSelectableLayers(),a=window.apf.olmap.map.olmap_select_interaction.getFeatures().getArray()),null===i&&(i=!0),_.each(e.rows,function(e){o=window.apf.olmap.erstelleMarkerFürTPopLayer(e),r.push(o),t&&-1!==t.indexOf(e.TPopId)&&a.push(o)}),n=new ol.layer.Vector({title:"Teilpopulationen",source:new ol.source.Vector({features:r}),style:function(e,t){return window.apf.olmap.tpopStyle(e,t)}}),n.set("visible",i),n.set("kategorie","AP Flora"),window.apf.olmap.map.addLayer(n),a&&a.length>0&&(setTimeout(function(){window.apf.olmap.prüfeObPopTpopGewähltWurden()},100),$("#olmap_auswaehlen").prop("checked",!0).button("refresh")),s.resolve(),s.promise()},window.apf.olmap.onFeatureSelect=function(e){"use strict";var t=new OpenLayers.Popup.FramedCloud("popup",e.geometry.getBounds().getCenterLonLat(),null,e.attributes.message,null,!1);t.autoSize=!0,t.maxSize=new OpenLayers.Size(600,600),t.fixedRelativePosition=!0,e.popup=t,window.apf.gmap.addPopup(t)},window.apf.olmap.onFeatureUnselect=function(e){"use strict";e.popup.hide()},window.apf.gmap.zeigeBeobUndTPop=function(e,t){"use strict";function i(e,t,i){google.maps.event.addListener(t,"click",function(){l.setContent(i),l.open(e,t)})}function n(e,t,i){google.maps.event.addListener(t,"click",function(){r.setContent(i),r.open(e,t)})}function o(e,t){google.maps.event.addListener(e,"dragend",function(e){var i,n,o,a,s;s=this,i=e.latLng.lat(),n=e.latLng.lng(),o=window.apf.DdInChY(i,n),a=window.apf.DdInChX(i,n);var r=$.ajax({type:"get",url:"php/beob_naechste_tpop.php",data:{ApArtId:t.NO_ISFS,X:o,Y:a},dataType:"json"});r.always(function(e){var o;o=t.Autor?"Beobachtung von "+t.Autor+" aus dem Jahr "+t.A_NOTE:"Beobachtung ohne Autor aus dem Jahr "+t.A_NOTE,$("#Meldung").html("Soll die "+o+"<br>der Teilpopulation '"+e[0].TPopFlurname+"' zugeordnet werden?").dialog({modal:!0,title:"Zuordnung bestätigen",width:600,buttons:{Ja:function(){$(this).dialog("close"),localStorage.karte_fokussieren=!0,$("#tree").jstree("move_node","#beob"+t.NO_NOTE,"#tpop_ordner_beob_zugeordnet"+e[0].TPopId,"first"),s.setMap(null)},Nein:function(){$(this).dialog("close"),n=window.apf.CHtoWGSlng(t.X,t.Y),i=window.apf.CHtoWGSlat(t.X,t.Y);var e=new google.maps.LatLng(i,n);s.setPosition(e)}}})}),r.fail(function(){console.log("Fehler: Die Beobachtung wurde nicht zugeordnet")})})}window.tpop_liste=t;var a,s,r,l,p,h,d,c,u,f,g,m,w,b,v,y,k,x,M,T,P,S,I,z;window.apf.zeigeFormular("google_karte"),window.apf.gmap.markers_array=[],window.apf.gmap.info_window_array=[],r=new google.maps.InfoWindow,l=new google.maps.InfoWindow,_.each(e.rows,function(e){e.Lat=window.apf.CHtoWGSlat(parseInt(e.X),parseInt(e.Y)),e.Lng=window.apf.CHtoWGSlng(parseInt(e.X),parseInt(e.Y))}),_.each(t.rows,function(e,i){e.TPopXKoord&&e.TPopYKoord?(e.Lat=window.apf.CHtoWGSlat(parseInt(e.TPopXKoord),parseInt(e.TPopYKoord)),e.Lng=window.apf.CHtoWGSlng(parseInt(e.TPopXKoord),parseInt(e.TPopYKoord))):delete t.rows[i]}),a=e.rows.length,s=t.rows.length,p=47.383333,h=8.533333,d=new google.maps.LatLng(p,h),c={zoom:15,center:d,streetViewControl:!1,mapTypeId:google.maps.MapTypeId.SATELLITE},u=new google.maps.Map(document.getElementById("google_karten_div"),c),window.apf.gmap.map=u,f=new google.maps.LatLngBounds,g=[],_.each(t.rows,function(e){m=e.TPopId,w=new google.maps.LatLng(e.Lat,e.Lng),f.extend(w),S=window.apf.beschrifteTPopMitNrFürKarte(e.PopNr,e.TPopNr),v=new MarkerWithLabel({map:u,position:w,title:S,labelContent:S,labelAnchor:new google.maps.Point(75,0),labelClass:"MapLabel",icon:"img/flora_icon.png"}),g.push(v),z=e.TPopFlurname||"(kein Flurname)",k='<div id="content"><div id="siteNotice"></div><div id="bodyContent" class="GmInfowindow"><h3>'+e.Artname+"</h3><p>Population: "+e.PopName+"</p><p>TPop: "+z+"</p><p>Koordinaten: "+e.TPopXKoord+" / "+e.TPopYKoord+'</p><p><a href="#" onclick="window.apf.öffneTPop(\''+e.TPopId+'\')">Formular anstelle Karte öffnen</a></p><p><a href="#" onclick="window.apf.öffneFormularAlsPopup(\'tpop\', '+e.TPopId+')">Formular neben der Karte öffnen</a></p><p><a href="#" onclick="window.apf.öffneTPopInNeuemTab(\''+e.TPopId+"')\">Formular in neuem Fenster öffnen</a></p></div></div>",i(u,v,k)}),x={maxZoom:17,styles:[{height:53,url:"img/m8.png",width:53}]},M=new MarkerClusterer(u,g,x),window.markersBeob=[],_.each(e.rows,function(e){T=e.Datum,w=new google.maps.LatLng(e.Lat,e.Lng),1===a?d=w:f.extend(w),P=T?T.toString():"",I=e.A_NOTE?e.A_NOTE.toString():"",b=new MarkerWithLabel({map:u,position:w,title:P,labelContent:I,labelAnchor:new google.maps.Point(75,0),labelClass:"MapLabel",icon:"img/flora_icon_violett.png",draggable:!0}),window.markersBeob.push(b),o(b,e);var t=e.Autor||"(keiner)",i=e.PROJET||"(keines)",s=e.DESC_LOCALITE||"(keiner)";y='<div id="content"><div id="siteNotice"></div><div id="bodyContent" class="GmInfowindow"><h3>'+T+"</h3><p>Autor: "+t+"</p><p>Projekt: "+i+"</p><p>Ort: "+s+"</p><p>Koordinaten: "+e.X+" / "+e.Y+'</p><p><a href="#" onclick="window.apf.öffneBeob(\''+e.NO_NOTE+'\')">Formular anstelle Karte öffnen</a></p><p><a href="#" onclick="window.apf.öffneBeobInNeuemTab(\''+e.NO_NOTE+"')\">Formular in neuem Fenster öffnen</a></p></div></div>",n(u,b,y)}),s+a===1?(u.setCenter(d),u.setZoom(18)):u.fitBounds(f)},window.apf.gmap.zeigeBeob=function(e){"use strict";function t(e,t,i){google.maps.event.addListener(t,"click",function(){n.setContent(i),n.open(e,t)})}var i,n,o,a,s,r,l,p,h,d,c,u,f,g,m,w,b;window.apf.zeigeFormular("google_karte"),window.apf.gmap.markers_array=[],window.apf.gmap.info_window_array=[],n=new google.maps.InfoWindow,_.each(e.rows,function(e){e.Lat=window.apf.CHtoWGSlat(parseInt(e.X),parseInt(e.Y)),e.Lng=window.apf.CHtoWGSlng(parseInt(e.X),parseInt(e.Y))}),i=e.rows.length,o=47.383333,a=8.533333,s=new google.maps.LatLng(o,a),r={zoom:15,center:s,streetViewControl:!1,mapTypeId:google.maps.MapTypeId.SATELLITE,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.TERRAIN,google.maps.MapTypeId.SATELLITE,google.maps.MapTypeId.HYBRID]}},l=new google.maps.Map(document.getElementById("google_karten_div"),r),window.apf.gmap.map=l,p=new google.maps.LatLngBounds,h=[],_.each(e.rows,function(e){m=e.Datum,d=new google.maps.LatLng(e.Lat,e.Lng),1===i?s=d:p.extend(d),w=m?m.toString():"",b=e.A_NOTE?e.A_NOTE.toString():"",c=new MarkerWithLabel({map:l,position:d,title:w,labelContent:b,labelAnchor:new google.maps.Point(75,0),labelClass:"MapLabel",icon:"img/flora_icon_violett.png"}),c.metadata={typ:"beob_nicht_beurteilt",id:e.NO_NOTE},h.push(c);var n=e.Autor||"(keiner)",o=e.PROJET||"(keines)",a=e.DESC_LOCALITE||"(keiner)";u='<div id="content"><div id="siteNotice"></div><div id="bodyContent" class="GmInfowindow"><h3>'+m+"</h3><p>Autor: "+n+"</p><p>Projekt: "+o+"</p><p>Ort: "+a+"</p><p>Koordinaten: "+e.X+" / "+e.Y+'</p><p><a href="#" onclick="window.apf.öffneBeob(\''+e.NO_NOTE+'\')">Formular anstelle Karte öffnen</a></p><p><a href="#" onclick="window.apf.öffneBeobInNeuemTab(\''+e.NO_NOTE+"')\">Formular in neuem Fenster öffnen</a></p></div></div>",t(l,c,u)}),f={maxZoom:17,styles:[{height:53,url:"img/m5.png",width:53}]},g=new MarkerClusterer(l,h,f),1===i?(l.setCenter(s),l.setZoom(18)):l.fitBounds(p)},window.apf.gmap.zeigeTPopBeob=function(e){"use strict";function t(e,t,i){google.maps.event.addListener(t,"click",function(){n.setContent(i),n.open(e,t)})}var i,n,o,a,s,r,l,p,h,d,c,u,f,g,m,w;window.apf.zeigeFormular("google_karte"),window.apf.gmap.markers_array=[],window.apf.gmap.info_window_array=[],n=new google.maps.InfoWindow,_.each(e.rows,function(e){e.Lat=window.apf.CHtoWGSlat(parseInt(e.X),parseInt(e.Y)),e.Lng=window.apf.CHtoWGSlng(parseInt(e.X),parseInt(e.Y))}),i=e.rows.length,o=47.383333,a=8.533333,s=new google.maps.LatLng(o,a),r={zoom:15,center:s,streetViewControl:!1,mapTypeId:google.maps.MapTypeId.SATELLITE,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.TERRAIN,google.maps.MapTypeId.SATELLITE,google.maps.MapTypeId.HYBRID]}},l=new google.maps.Map(document.getElementById("google_karten_div"),r),window.apf.gmap.map=l,p=new google.maps.LatLngBounds,h=[],_.each(e.rows,function(e){m=e.Datum,d=new google.maps.LatLng(e.Lat,e.Lng),1===i?s=d:p.extend(d),w=m?m.toString():"",c=new MarkerWithLabel({map:l,position:d,title:w,labelContent:w,labelAnchor:new google.maps.Point(75,0),labelClass:"MapLabel",icon:"img/flora_icon_violett.png"}),h.push(c);
var n=e.Autor||"(keiner)",o=e.PROJET||"(keines)",a=e.DESC_LOCALITE||"(keiner)";u='<div id="content"><div id="siteNotice"></div><div id="bodyContent" class="GmInfowindow"><h3>'+m+"</h3><p>Autor: "+n+"</p><p>Projekt: "+o+"</p><p>Ort: "+a+"</p><p>Koordinaten: "+e.X+" / "+e.Y+'</p><p><a href="#" onclick="window.apf.öffneTPopBeob(\''+e.NO_NOTE+'\')">Formular anstelle Karte öffnen</a></p><p><a href="#" onclick="window.apf.öffneTPopBeobInNeuemTab(\''+e.NO_NOTE+"')\">Formular in neuem Fenster öffnen</a></p></div></div>",t(l,c,u)}),f={maxZoom:17,styles:[{height:53,url:"img/m5.png",width:53}]},g=new MarkerClusterer(l,h,f),1===i?(l.setCenter(s),l.setZoom(18)):l.fitBounds(p)},window.apf.gmap.verorteTPop=function(e){"use strict";var t,i,n,o,a,s,r,l,p,h,d,c=new google.maps.InfoWindow,u=$("#google_karten_div");window.apf.gmap.markers_array=[],window.apf.zeigeFormular("google_karte"),e&&e.TPopXKoord&&e.TPopYKoord?(t=window.apf.CHtoWGSlat(parseInt(e.TPopXKoord),parseInt(e.TPopYKoord)),i=window.apf.CHtoWGSlng(parseInt(e.TPopXKoord),parseInt(e.TPopYKoord)),o=15,r=!0):(t=47.360566,i=8.542829,o=12,r=!1),n=new google.maps.LatLng(t,i),a={zoom:o,center:n,streetViewControl:!1,mapTypeId:google.maps.MapTypeId.SATELLITE},s=new google.maps.Map(u[0],a),window.apf.gmap.map=s,r&&(h=window.apf.beschrifteTPopMitNrFürKarte(e.PopNr,e.TPopNr),l=new google.maps.Marker({position:n,map:s,title:h,icon:"img/flora_icon_rot.png",draggable:!0}),window.apf.gmap.markers_array.push(l),d=e.TPopFlurname||"(kein Flurname)",p='<div id="content"><div id="siteNotice"></div><div id="bodyContent" class="GmInfowindow"><h3>'+d+"</h3><p>Koordinaten: "+e.TPopXKoord+" / "+e.TPopYKoord+'</p><p><a href="#" onclick="window.apf.öffneTPop(\''+e.TPopId+'\')">Formular anstelle Karte öffnen</a></p><p><a href="#" onclick="window.apf.öffneFormularAlsPopup(\'tpop\', '+e.TPopId+')">Formular neben der Karte öffnen</a></p><p><a href="#" onclick="window.apf.öffneTPopInNeuemTab(\''+e.TPopId+"')\">Formular in neuem Fenster öffnen</a></p></div></div>",c=new google.maps.InfoWindow({content:p}),window.apf.gmap.info_window_array||(window.apf.gmap.info_window_array=[]),window.apf.gmap.info_window_array.push(c),google.maps.event.addListener(l,"click",function(){c.open(s,l)}),google.maps.event.addListener(l,"dragend",function(t){window.apf.gmap.SetLocationTPop(t.latLng,s,l,e)})),google.maps.event.addListener(s,"click",function(t){window.apf.gmap.erstelleMarker(t.latLng,s,l,e)})},window.apf.gmap.erstelleMarker=function(e,t,i,n){"use strict";var o;o=n&&n.TPopFlurname?n.TPopFlurname:"neue Teilpopulation",window.apf.gmap.clearMarkers();var i=new google.maps.Marker({position:e,map:t,title:o,icon:"img/flora_icon_rot.png",draggable:!0});window.apf.gmap.markers_array.push(i),google.maps.event.addListener(i,"dragend",function(e){window.apf.gmap.SetLocationTPop(e.latLng,t,i,n)}),window.apf.gmap.SetLocationTPop(e,t,i)},window.apf.gmap.SetLocationTPop=function(e,t,i,n){"use strict";var o,a,s,r,l,p,h;if(window.apf.prüfeSchreibvoraussetzungen()){l=n&&n.TPopFlurname?n.TPopFlurname:"neue Teilpopulation",o=e.lat(),a=e.lng(),p=window.apf.DdInChY(o,a),h=window.apf.DdInChX(o,a);var d=$.ajax({type:"post",url:"php/tpop_update.php",dataType:"json",data:{id:localStorage.tpop_id,Feld:"TPopXKoord",Wert:p,user:sessionStorage.User}});d.always(function(){var e=$.ajax({type:"post",url:"php/tpop_update.php",dataType:"json",data:{id:localStorage.tpop_id,Feld:"TPopYKoord",Wert:h,user:sessionStorage.User}});e.always(function(){window.apf.gmap.clearInfoWindows(),s='<div id="content"><div id="siteNotice"></div><div id="bodyContent" class="GmInfowindow"><h3>'+l+"</h3><p>Koordinaten: "+p+" / "+h+'</p><p><a href="#" onclick="window.apf.öffneTPop(\''+localStorage.tpop_id+'\')">Formular anstelle Karte öffnen</a></p><p><a href="#" onclick="window.apf.öffneFormularAlsPopup(\'tpop\', '+localStorage.tpop_id+')">Formular neben der Karte öffnen</a></p><p><a href="#" onclick="window.apf.öffneTPopInNeuemTab(\''+localStorage.tpop_id+"')\">Formular in neuem Fenster öffnen</a></p></div></div>",r=new google.maps.InfoWindow({content:s}),window.apf.gmap.info_window_array||(window.apf.gmap.info_window_array=[]),window.apf.gmap.info_window_array.push(r),google.maps.event.addListener(i,"click",function(){r.open(t,i)})}),e.fail(function(){console.log("Fehler: Die Y-Koordinate wurde nicht übernommen (die X-Koordinate offenbar schon)")})}),d.fail(function(){console.log("Fehler: Die Koordinaten wurden nicht übernommen")})}},window.apf.gmap.clearMarkers=function(){"use strict";_.each(window.apf.gmap.markers_array,function(e){e.setMap(null)})},window.apf.gmap.clearInfoWindows=function(){"use strict";_.each(window.apf.gmap.info_window_array,function(e){e.setMap(null)})},window.apf.öffneTPop=function(e){"use strict";localStorage.tpop_id=e,$.jstree._reference("[typ='tpop']#"+e).deselect_all(),$("#tree").jstree("select_node","[typ='tpop']#"+e)},window.apf.öffneTPopInNeuemTab=function(e){"use strict";window.open("index.html?ap="+localStorage.ap_id+"&pop="+localStorage.pop_id+"&tpop="+e,"_blank")},window.apf.öffnePop=function(e){"use strict";localStorage.pop_id=e,$.jstree._reference("[typ='pop']#"+e).deselect_all(),$("#tree").jstree("select_node","[typ='pop']#"+e)},window.apf.öffnePopInNeuemTab=function(e){"use strict";window.open("index.html?ap="+localStorage.ap_id+"&pop="+e,"_blank")},window.apf.öffneBeob=function(e){"use strict";localStorage.beob_id=e,$.jstree._reference("[typ='beob_nicht_beurteilt']#beob"+e).deselect_all(),$("#tree").jstree("select_node","[typ='beob_nicht_beurteilt']#beob"+e)},window.apf.öffneBeobInNeuemTab=function(e){"use strict";window.open("index.html?ap="+localStorage.ap_id+"&beob_nicht_beurteilt="+e,"_blank")},window.apf.öffneTPopBeob=function(e){"use strict";localStorage.beob_id=e,$.jstree._reference("[typ='beob_zugeordnet']#beob"+e).deselect_all(),$("#tree").jstree("select_node","[typ='beob_zugeordnet']#beob"+e)},window.apf.öffneTPopBeobInNeuemTab=function(e){"use strict";window.open("index.html?ap="+localStorage.ap_id+"&beob_nicht_beurteilt="+e,"_blank")},MercatorProjection.prototype.fromLatLngToPoint=function(e,t){var i=this,n=t||new google.maps.Point(0,0),o=i.pixelOrigin_;n.x=o.x+e.lng()*i.pixelsPerLonDegree_;var a=bound(Math.sin(degreesToRadians(e.lat())),-.9999,.9999);return n.y=o.y+.5*Math.log((1+a)/(1-a))*-i.pixelsPerLonRadian_,n},MercatorProjection.prototype.fromDivPixelToLatLng=function(e,t){var i=this,n=i.pixelOrigin_,o=Math.pow(2,t),a=(e.x/o-n.x)/i.pixelsPerLonDegree_,s=(e.y/o-n.y)/-i.pixelsPerLonRadian_,r=radiansToDegrees(2*Math.atan(Math.exp(s))-Math.PI/2);return new google.maps.LatLng(r,a)},MercatorProjection.prototype.fromDivPixelToSphericalMercator=function(e,t){var i=this,n=i.fromDivPixelToLatLng(e,t),o=6378137,a=o*degreesToRadians(n.lng()),s=degreesToRadians(n.lat()),r=o/2*Math.log((1+Math.sin(s))/(1-Math.sin(s)));return new google.maps.Point(a,r)},function(e){function t(t){var i=t||window.event,n=[].slice.call(arguments,1),o=0,a=0,s=0;return t=e.event.fix(i),t.type="mousewheel",i.wheelDelta&&(o=i.wheelDelta/120),i.detail&&(o=-i.detail/3),s=o,void 0!==i.axis&&i.axis===i.HORIZONTAL_AXIS&&(s=0,a=-1*o),void 0!==i.wheelDeltaY&&(s=i.wheelDeltaY/120),void 0!==i.wheelDeltaX&&(a=-1*i.wheelDeltaX/120),n.unshift(t,o,a,s),(e.event.dispatch||e.event.handle).apply(this,n)}var i=["DOMMouseScroll","mousewheel"];if(e.event.fixHooks)for(var n=i.length;n;)e.event.fixHooks[i[--n]]=e.event.mouseHooks;e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=i.length;e;)this.addEventListener(i[--e],t,!1);else this.onmousewheel=t},teardown:function(){if(this.removeEventListener)for(var e=i.length;e;)this.removeEventListener(i[--e],t,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}(jQuery),window.apf.öffneUri=function(){"use strict";var e=new Uri($(location).attr("href")),t=e.anchor()||null,i=e.getQueryParamValue("ap");if(i){if(window.apf.setzeWindowAp(i),$("#ap_waehlen").val(i),e.getQueryParamValue("tpop")){window.apf.setzeWindowPop(e.getQueryParamValue("pop")),window.apf.setzeWindowTpop(e.getQueryParamValue("tpop"));var n=e.getQueryParamValue("tpopfeldkontr");n?(window.apf.setzeWindowTpopfeldkontr(n),window.apf.tpopfeldkontr_zeigen=!0,window.apf.initiiere_tpopfeldkontr()):e.getQueryParamValue("tpopfreiwkontr")?(window.apf.setzeWindowTpopfeldkontr(e.getQueryParamValue("tpopfreiwkontr")),window.apf.tpopfreiwkontr_zeigen=!0,localStorage.tpopfreiwkontr=!0,window.apf.initiiere_tpopfeldkontr()):e.getQueryParamValue("tpopmassn")?(window.apf.setzeWindowTpopmassn(e.getQueryParamValue("tpopmassn")),window.apf.tpopmassn_zeigen=!0,window.apf.initiiere_tpopmassn()):e.getQueryParamValue("tpopber")?(window.apf.setzeWindowTpopber(e.getQueryParamValue("tpopber")),window.apf.tpopber_zeigen=!0,window.apf.initiiereTpopber()):e.getQueryParamValue("beob_zugeordnet")?window.apf.beob_zugeordnet_zeigen=!0:e.getQueryParamValue("tpopmassnber")?(window.apf.setzeWindowTpopmassnber(e.getQueryParamValue("tpopmassnber")),window.apf.tpopmassnber_zeigen=!0,window.apf.initiiere_tpopmassnber()):(window.apf.tpop_zeigen=!0,window.apf.initiiere_tpop())}else e.getQueryParamValue("pop")?(window.apf.setzeWindowPop(e.getQueryParamValue("pop")),e.getQueryParamValue("popber")?(window.apf.setzeWindowPopber(e.getQueryParamValue("popber")),window.apf.popber_zeigen=!0,window.apf.initiiere_popber()):e.getQueryParamValue("popmassnber")?(window.apf.setzeWindowPopmassnber(e.getQueryParamValue("popmassnber")),window.apf.popmassnber_zeigen=!0,window.apf.initiiere_popmassnber()):(window.apf.pop_zeigen=!0,localStorage.pop_id=e.getQueryParamValue("pop"),window.apf.initiiere_pop())):e.getQueryParamValue("apziel")?(window.apf.setzeWindowApziel(e.getQueryParamValue("apziel")),e.getQueryParamValue("zielber")?(window.apf.setzeWindowZielber(e.getQueryParamValue("zielber")),window.apf.zielber_zeigen=!0,window.apf.initiiere_zielber()):(window.apf.apziel_zeigen=!0,localStorage.apziel_id=e.getQueryParamValue("apziel"),window.apf.initiiere_apziel())):e.getQueryParamValue("erfkrit")?(window.apf.setzeWindowErfkrit(e.getQueryParamValue("erfkrit")),window.apf.erfkrit_zeigen=!0):e.getQueryParamValue("jber")?(window.apf.setzeWindowJber(e.getQueryParamValue("jber")),window.apf.jber_zeigen=!0,window.apf.initiiere_jber()):e.getQueryParamValue("jber_uebersicht")?(window.apf.setzeWindowJberUebersicht(e.getQueryParamValue("jber_uebersicht")),window.apf.jber_übersicht_zeigen=!0,window.apf.initiiere_jber_uebersicht()):e.getQueryParamValue("ber")?(window.apf.setzeWindowBer(e.getQueryParamValue("ber")),window.apf.ber_zeigen=!0,window.apf.initiiere_ber()):e.getQueryParamValue("idealbiotop")?(window.apf.setzeWindowIdealbiotop(e.getQueryParamValue("idealbiotop")),window.apf.idealbiotop_zeigen=!0,window.apf.initiiere_idealbiotop()):e.getQueryParamValue("assozarten")?(window.apf.setzeWindowAssozarten(e.getQueryParamValue("assozarten")),window.apf.assozarten_zeigen=!0):e.getQueryParamValue("beob_nicht_beurteilt")?window.apf.beob_nicht_beurteilt_zeigen=!0:e.getQueryParamValue("beob_nicht_zuzuordnen")?window.apf.beob_nicht_zuzuordnen_zeigen=!0:(window.apf.ap_zeigen=!0,localStorage.ap_id=i,window.apf.initiiere_ap());window.apf.erstelle_tree(i),$("#ap_waehlen_label").hide()}else{var o=e.getQueryParamValue("exporte");o&&window.apf.initiiere_exporte(t)}},window.apf.getInternetExplorerVersion=function(){"use strict";var e=-1;if("Microsoft Internet Explorer"==navigator.appName){var t=navigator.userAgent,i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=i.exec(t)&&(e=parseFloat(RegExp.$1))}return e},window.apf.olmap.createLayersForOlmap=function(){"use strict";var e={Aerial:"Bing Luftbild",AerialWithLabels:"Bing Luftbild beschriftet",Road:"Bing Strassenkarte"},t=_.keys(e),i=[];_.each(t,function(t){i.push(new ol.layer.Tile({title:e[t],kategorie:"Welt Hintergrund",visible:!1,preload:1/0,source:new ol.source.BingMaps({projection:"EPSG:21781",key:"AjGOtB_ygBplpxXtKiiHtm-GERjSg9TFEoCmuBI_Yz4VWy0unRGUDo9GOZHA46Pf",imagerySet:t})}))});var n=ga.layer.create("ch.swisstopo.swissimage");n.set("title","Luftbild"),n.set("visible",!1),n.set("kategorie","CH Hintergrund");var o=ga.layer.create("ch.swisstopo.pixelkarte-grau");o.set("title","Landeskarten grau"),o.set("visible",!1),o.set("kategorie","CH Hintergrund");var a=ga.layer.create("ch.swisstopo.pixelkarte-farbe");a.set("title","Landeskarten farbig"),a.set("visible",!0),a.set("kategorie","CH Hintergrund");var s=ga.layer.create("ch.swisstopo.hiks-siegfried");s.set("title","Siegfriedkarte 1881"),s.set("visible",!1),s.set("kategorie","CH Hintergrund");var r=ga.layer.create("ch.swisstopo-vd.geometa-gemeinde");r.set("title","Gemeinden"),r.set("visible",!1),r.set("kategorie","CH Sachinformationen");var l=ga.layer.create("ch.swisstopo.swissboundaries3d-kanton-flaeche.fill");l.set("title","Kantone"),l.set("visible",!1),l.set("kategorie","CH Sachinformationen");var p=ga.layer.create("ch.kantone.cadastralwebmap-farbe");p.set("title","Parzellen"),p.set("visible",!1),p.set("kategorie","CH Sachinformationen");var h=ga.layer.create("ch.bafu.bundesinventare-amphibien");h.set("title","Amphibien"),h.set("visible",!1),h.set("kategorie","CH Biotopinventare");var d=ga.layer.create("ch.bafu.bundesinventare-amphibien_wanderobjekte");d.set("title","Amphibien Wanderobjekte"),d.set("visible",!1),d.set("kategorie","CH Biotopinventare");var c=ga.layer.create("ch.bafu.bundesinventare-auen");c.set("title","Auen"),c.set("visible",!1),c.set("kategorie","CH Biotopinventare");var u=ga.layer.create("ch.bafu.bundesinventare-flachmoore");u.set("title","Flachmoore"),u.set("visible",!1),u.set("kategorie","CH Biotopinventare");var f=ga.layer.create("ch.bafu.bundesinventare-hochmoore");f.set("title","Hochchmoore"),f.set("visible",!1),f.set("kategorie","CH Biotopinventare");var g=ga.layer.create("ch.bafu.bundesinventare-trockenwiesen_trockenweiden");g.set("title","Trockenwiesen und -weiden"),g.set("visible",!1),g.set("kategorie","CH Biotopinventare");var m=ga.layer.create("ch.bafu.bundesinventare-vogelreservate");m.set("title","Vogelreservate"),m.set("visible",!1),m.set("kategorie","CH Biotopinventare");var w=new ol.source.GeoJSON({url:"geojson/detailplaene.geojson"}),b=new ol.layer.Vector({title:"Detailpläne",opacity:1,visible:!1,kategorie:"AP Flora",selectable:!0,source:w,style:window.apf.olmap.detailplanStyle()}),v=new ol.layer.Tile({title:"SVO farbig",opacity:.7,visible:!1,kategorie:"ZH Sachinformationen",source:new ol.source.TileWMS({url:"//wms.zh.ch/FnsSVOZHWMS",params:{layers:"zonen-schutzverordnungen,ueberlagernde-schutzzonen,schutzverordnungsobjekte,svo-zonen-labels,schutzverordnungsobjekt-nr"}})}),y=new ol.layer.Tile({title:"SVO schwarz/weiss",visible:!1,kategorie:"ZH Sachinformationen",source:new ol.source.TileWMS({url:"//wms.zh.ch/FnsSVOZHWMS",params:{layers:"zonen-schutzverordnungen-raster,ueberlagernde-schutzzonen,schutzverordnungsobjekte,svo-zonen-labels,schutzverordnungsobjekt-nr",transparent:!0,visibility:!1,singleTile:!0}})}),k=(new ol.layer.Tile({title:"Lichte Wälder",visible:!1,kategorie:"ZH Sachinformationen",source:new ol.source.TileWMS({url:"//maps.zh.ch/wms/FnsLWZH",crossOrigin:"anonymous",params:{layers:"objekte-lichte-waelder-kanton-zuerich",transparent:!0,visibility:!1,singleTile:!0}})}),new ol.layer.Tile({title:"Luftbild",visible:!1,kategorie:"ZH Hintergrund",source:new ol.source.TileWMS({url:"//agabriel:4zC6MgjM@wms.zh.ch/OrthoZHWMS",crossOrigin:"anonymous",params:{layers:"orthophotos",isBaseLayer:!0,visibility:!1,singleTile:!0}})}),new ol.layer.Tile({title:"Luftbild 2",visible:!1,kategorie:"ZH Hintergrund",source:new ol.source.TileWMS({url:"//maps.zh.ch/wms/OrthoBackgroundZH",crossOrigin:"anonymous",params:{layers:"orthoaktuell",isBaseLayer:!0,visibility:!1,singleTile:!0}})}),new ol.layer.Tile({title:"Höhenmodell",visible:!1,kategorie:"ZH Sachinformationen",source:new ol.source.TileWMS({url:"//maps.zh.ch/wms/DTMBackgroundZH",crossOrigin:"anonymous",params:{layers:"dtm",isBaseLayer:!0,visibility:!1,singleTile:!0}})}),[n,o,a,s,p,r,h,d,c,u,f,g,m,l,v,y,b]),x=k;if(localStorage.olmap_eigene_ebenen){var M={Point:[new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:"rgba(255,255,0,0.5)"}),radius:5,stroke:new ol.style.Stroke({color:"#ff0",width:1})})})],LineString:[new ol.style.Style({stroke:new ol.style.Stroke({color:"#f00",width:3})})],Polygon:[new ol.style.Style({fill:new ol.style.Fill({color:"rgba(0,255,255,0.5)"}),stroke:new ol.style.Stroke({color:"#0ff",width:1})})],MultiPoint:[new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:"rgba(255,0,255,0.5)"}),radius:5,stroke:new ol.style.Stroke({color:"#f0f",width:1})})})],MultiLineString:[new ol.style.Style({stroke:new ol.style.Stroke({color:"#0f0",width:3})})],MultiPolygon:[new ol.style.Style({fill:new ol.style.Fill({color:"rgba(0,0,255,0.5)"}),stroke:new ol.style.Stroke({color:"#00f",width:1})})]},T=function(e,t){var i=e.getStyleFunction();return i?i.call(e,t):M[e.getGeometry().getType()]},P=JSON.parse(localStorage.olmap_eigene_ebenen),S=[];_.each(P,function(e){var t=new ol.format.GeoJSON,i=t.readFeatures(e),n=new ol.source.Vector({features:i}),o=new ol.layer.Vector({guid:e.guid,source:n,style:T,title:e.title,kategorie:e.kategorie});S.push(o)}),window.eigene_ebenen_layers=S,x=x.concat(S)}return x},window.apf.olmap.aktualisiereEbeneInLocalStorage=function(e,t){"use strict";var i=e.get("guid"),n=[];if(localStorage.olmap_eigene_ebenen&&(n=JSON.parse(localStorage.olmap_eigene_ebenen)),i){if(n=_.reject(n,function(e){return e.guid&&e.guid===i}),!t){var o=new ol.format.GeoJSON,a=o.writeFeatures(e.getSource().getFeatures());a.title=e.get("title"),a.guid=i,a.kategorie=e.get("kategorie"),n.push(a)}try{localStorage.olmap_eigene_ebenen=JSON.stringify(n)}catch(s){console.log("Ebene konnte nicht in localStorage gespeichert werden. Fehlermeldung: "+s),$("#eigene_layer_meldung_"+e.get("title").replace(" ","_")).html("Ebene kann nicht im Cache des Browsers gespeichert werden").show()}}},window.apf.initiiereOlmap=function(){"use strict";window.apf.olmap.entferneAlleApfloraLayer(),window.apf.olmap.entferneModifyInteractionFürTpop(),window.apf.olmap.map||(window.apf.olmap.map=new ga.Map({target:"ga_karten_div",layers:window.apf.olmap.createLayersForOlmap(),view:new ol.View2D({resolution:4,center:[693e3,253e3]})}),window.apf.olmap.addDragAndDropGeofiles(),window.apf.olmap.addShowFeatureInfoOnClick(),window.apf.olmap.changeCursorOverFeature(),window.apf.olmap.initiiereLayertree(),window.apf.olmap.addMousePositionControl(),window.apf.olmap.addFullScreenControl(),window.apf.olmap.map.on("change:size",function(){window.apf.olmap.blendeOlmapExportieren()}))},window.apf.olmap.deactivateMenuItems=function(){window.apf.olmap.removeMeasureInteraction(),window.apf.olmap.removeSelectFeaturesInSelectableLayers(),window.apf.olmap.entfernePopupOverlays(),$("div.ga-tooltip").hide(),window.apf.olmap.entferneModifyInteractionFürTpop()},window.apf.olmap.removeSelectFeaturesInSelectableLayers=function(){"use strict";window.apf.olmap.map.olmap_select_interaction&&(window.apf.olmap.map.removeInteraction(window.apf.olmap.map.olmap_select_interaction),delete window.apf.olmap.map.olmap_select_interaction,window.apf.olmap.removeDragBox(),$("#ergebnisAuswahl").hide())},window.apf.olmap.addSelectFeaturesInSelectableLayers=function(){"use strict";window.apf.olmap.map.olmap_select_interaction=new ol.interaction.Select({layerFilter:function(e){return e.get("selectable")===!0},style:function(e,t){switch(e.get("myTyp")){case"pop":return window.apf.olmap.popStyle(e,t,!0);case"tpop":return window.apf.olmap.tpopStyle(e,t,!0);case"Detailplan":return window.apf.olmap.detailplanStyleSelected(e,t)}}}),window.apf.olmap.map.addInteraction(window.apf.olmap.map.olmap_select_interaction),window.apf.olmap.addDragBoxForPopTpop()},window.apf.olmap.getSelectedFeatures=function(){return window.apf.olmap.map.olmap_select_interaction?window.apf.olmap.map.olmap_select_interaction.getFeatures().getArray():[]},window.apf.olmap.getSelectedFeaturesOfType=function(e){var t,i=window.apf.olmap.getSelectedFeatures(),n=[];return 0===i.length?[]:(_.each(i,function(i){t=i.get("myTyp"),t===e&&n.push(i)}),n)},window.apf.olmap.removeDragBox=function(){"use strict";window.apf.olmap.drag_box_interaction&&(window.apf.olmap.map.removeInteraction(window.apf.olmap.drag_box_interaction),delete window.apf.olmap.drag_box_interaction)},window.apf.olmap.addDragBoxForPopTpop=function(){"use strict";window.apf.olmap.drag_box_interaction=new ol.interaction.DragBox({condition:ol.events.condition.altKeyOnly,style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255,0,0,0.1)"}),stroke:new ol.style.Stroke({color:[255,0,0,1],width:3})})}),window.apf.olmap.drag_box_interaction.on("boxend",function(){var e=window.apf.olmap.drag_box_interaction.getGeometry(),t=e.getExtent(),i=window.apf.olmap.map.getLayers().getArray(),n=$("#olmap_layertree_Populationen").val(),o=i[n],a=$("#olmap_layertree_Teilpopulationen").val(),s=i[a],r=o.getSource(),l=s.getSource(),p=window.apf.olmap.map.olmap_select_interaction.getFeatures().getArray();o.get("visible")===!0&&r.forEachFeatureInExtent(t,function(e){p.push(e)}),s.get("visible")===!0&&l.forEachFeatureInExtent(t,function(e){p.push(e)}),setTimeout(function(){window.apf.olmap.prüfeObPopTpopGewähltWurden()},100)}),window.apf.olmap.map.addInteraction(window.apf.olmap.drag_box_interaction)},window.apf.olmap.addShowFeatureInfoOnClick=function(){"use strict";window.apf.olmap.map.on("singleclick",function(e){var t=e.pixel,i=e.coordinate;window.apf.olmap.map.olmap_select_interaction||window.apf.olmap.zeigeFeatureInfo(t,i),setTimeout(function(){window.apf.olmap.prüfeObPopTpopGewähltWurden()},100)})},window.apf.olmap.prüfeObPopTpopGewähltWurden=function(){var e=[],t=[];e=window.apf.olmap.getSelectedFeaturesOfType("pop"),t=window.apf.olmap.getSelectedFeaturesOfType("tpop"),e.length>0||t.length>0?window.apf.olmap.erstelleListeDerAusgewähltenPopTPop(e,t):$("#ergebnisAuswahl").hide()},window.apf.olmap.changeCursorOverFeature=function(){"use strict";$(window.apf.olmap.map.getViewport()).on("mousemove",function(e){var t=window.apf.olmap.map.getEventPixel(e.originalEvent),i=window.apf.olmap.map.forEachFeatureAtPixel(t,function(){return!0});i?$("#ga_karten_div").css("cursor","pointer"):$("#ga_karten_div").css("cursor","")})},window.apf.olmap.addMousePositionControl=function(){"use strict";var e=new ol.control.MousePosition({coordinateFormat:ol.coordinate.createStringXY(0),projection:"EPSG:21781",undefinedHTML:"&nbsp;"});window.apf.olmap.map.addControl(e)},window.apf.olmap.addFullScreenControl=function(){"use strict";var e=new ol.control.FullScreen;window.apf.olmap.map.addControl(e),$("#ga_karten_div").find(".ol-full-screen").find('span[role="tooltip"]').html("Vollbild wechseln")},window.apf.olmap.addDragAndDropGeofiles=function(){"use strict";var e={Point:[new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:"rgba(255,255,0,0.5)"}),radius:5,stroke:new ol.style.Stroke({color:"#ff0",width:1})})})],LineString:[new ol.style.Style({stroke:new ol.style.Stroke({color:"#f00",width:3})})],Polygon:[new ol.style.Style({fill:new ol.style.Fill({color:"rgba(0,255,255,0.5)"}),stroke:new ol.style.Stroke({color:"#0ff",width:1})})],MultiPoint:[new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:"rgba(255,0,255,0.5)"}),radius:5,stroke:new ol.style.Stroke({color:"#f0f",width:1})})})],MultiLineString:[new ol.style.Style({stroke:new ol.style.Stroke({color:"#0f0",width:3})})],MultiPolygon:[new ol.style.Style({fill:new ol.style.Fill({color:"rgba(0,0,255,0.5)"}),stroke:new ol.style.Stroke({color:"#00f",width:1})})]},t=function(t,i){var n=t.getStyleFunction();return n?n.call(t,i):e[t.getGeometry().getType()]},i=new ol.interaction.DragAndDrop({formatConstructors:[ol.format.GPX,ol.format.GeoJSON,ol.format.IGC,ol.format.KML,ol.format.TopoJSON]});window.apf.olmap.map.addInteraction(i),i.on("addfeatures",function(e){var i=new ol.source.Vector({features:e.features}),n=new ol.layer.Vector({guid:window.apf.erstelleGuid(),source:i,style:t,title:"eigene Ebene",kategorie:"Eigene Ebenen"});window.apf.olmap.map.addLayer(n);var o=window.apf.olmap.map.getView();o.fitExtent(i.getExtent(),window.apf.olmap.map.getSize()),window.apf.olmap.initiiereLayertree("Eigene Ebenen"),window.apf.olmap.frageNameFürEbene(n)})},window.apf.olmap.frageNameFürEbene=function(e){"use strict";var t=$.Deferred(),i=$("#eigene_ebene_name"),n=$("#eigene_ebene_name_container");return window.apf.olmap.eigene_ebene=e,n.dialog({title:"Ebene taufen",modal:!0,position:{my:"center",at:"center",of:$("#ga_karten_div")},buttons:[{text:"speichern",click:function(){window.apf.olmap.nenneEbeneUm(e,i.val()),i.val(""),$(this).dialog("close"),t.resolve()}},{text:"abbrechen",click:function(){$(this).dialog("close")}}]}).dialog("open"),i.on("keyup",function(e){13==e.which&&window.apf.olmap.eigene_ebene&&(window.apf.olmap.nenneEbeneUm(window.apf.olmap.eigene_ebene,e.target.value),i.val(""),$("#eigene_ebene_name_container").dialog("close"),$("#GeoAdminKarte").off("keyup","#eigene_ebene_name"),delete window.apf.olmap.eigene_ebene,t.resolve())}),t.promise()},window.apf.olmap.nenneEbeneUm=function(e,t){"use strict";e.set("title",t),window.apf.olmap.initiiereLayertree("Eigene Ebenen"),window.apf.olmap.aktualisiereEbeneInLocalStorage(e)},window.apf.olmap.initiiereLayertree=function(e){"use strict";var t,i,n,o,a,s,r,l="<h3>CH Hintergrund</h3><div>",p="<h3>CH Sachinformationen</h3><div>",h="<h3>CH Biotopinventare</h3><div>",d="<h3>ZH Sachinformationen</h3><div>",c="<h3>ZH AP Flora</h3><div>",u=$("#olmap_layertree_layers"),f=$("#ga_karten_div").find(".accordion"),g=window.apf.olmap.map.getLayers().getArray(),m="<hr>",w=0,b=!1;s="<h3>Eigene Ebenen</h3>",s+="<div>",s+="<p>Einfach eine der folgenden Dateitypen auf die Karte ziehen:</p>",s+="<ul>",s+="<li>GPX</li>",s+="<li>GeoJSON</li>",s+="<li>IGC</li>",s+="<li>KML</li>",s+="<li>TopoJSON</li>",s+="</ul>",s+='<div id="olmap_eigene_ebenen_beta_container">',s+='<p style="font-size:10px; line-height:0.9em;">Open Layers 3 ist noch in der Beta-Phase.<br>Daher funktionieren eigene Layer nicht immer fehlerfrei.</p>',s+="</div>",s+='<div id="olmap_neues_layer_container">',s+='<input type="checkbox" class="neues_layer" id="olmap_neues_layer">',s+='<label for="olmap_neues_layer" class="neues_layer_label">neue Ebene erstellen</label>',s+="</div>",f.accordion({collapsible:!0,active:!1,heightStyle:"content"}).accordion("destroy"),_.each(g,function(e,a){if(t=e.get("title")||"(Ebene ohne Titel)",i=e.get("visible"),n=e.get("kategorie"),"messen"!==t)switch(o='<li><input type="checkbox" class="olmap_layertree_checkbox" id="olmap_layertree_'+t+'" value="'+a+'"',i&&(o+=' checked="checked"'),o+=">",o+='<label for="olmap_layertree_'+t+'">'+t+"</label>","Populationen"===t&&(o+='<div class="layeroptionen">',o+='<label for="layertree_pop_nr" class="layertree_pop_style pop_nr">Nr.</label>',o+='<input type="checkbox" id="layertree_pop_nr" class="layertree_pop_style pop_nr" checked="checked"> ',o+='<label for="layertree_pop_name" class="layertree_pop_style pop_name">Namen</label>',o+='<input type="checkbox" id="layertree_pop_name" class="layertree_pop_style pop_name">',o+="</div>"),"Teilpopulationen"===t&&(o+='<div class="layeroptionen">',o+='<label for="layertree_tpop_nr" class="layertree_tpop_style tpop_nr">Nr.</label>',o+='<input type="checkbox" id="layertree_tpop_nr" class="layertree_tpop_style tpop_nr" checked="checked"> ',o+='<label for="layertree_tpop_name" class="layertree_tpop_style tpop_name">Namen</label>',o+='<input type="checkbox" id="layertree_tpop_name" class="layertree_tpop_style tpop_name">',o+="</div>"),"Eigene Ebenen"===n&&(o+='<div class="layeroptionen">',o+='<input type="checkbox" class="modify_layer" id="modify_layer_'+t.replace(" ","_")+'">',o+='<label for="modify_layer_'+t.replace(" ","_")+'" title="Ebene bearbeiten" class="modify_layer_label"></label>',o+='<select id="modify_layer_geom_type_'+t.replace(" ","_")+'" class="modify_layer_geom_type apf_tooltip" title="Neue Objekte zeichnen oder<br>bestehende Objekte auswählen, um sie zu verändern"><option id="modify_layer_geom_type_leerwert" value="leerwert" selected>Objekt auswählen</option><option value="Point">Punkt zeichnen</option><option value="LineString">Linie zeichnen</option><option value="Polygon">Polygon zeichnen</option></select>',o+='<div class="non_modify_options">',o+='<select id="export2_layer_geom_type_'+t.replace(" ","_")+'" class="export_layer_select apf_tooltip" title="Ebene exportieren<br>Wählen Sie ein Format"><option value="leerwert" selected>exportieren</option><option value="GeoJSON">GeoJSON</option><option value="KML">KML</option><option value="GPX">GPX</option></select>',o+='<input type="checkbox" class="rename_layer" id="rename_layer_'+t.replace(" ","_")+'">',o+='<label for="rename_layer_'+t.replace(" ","_")+'" title="Ebene umbenennen" class="rename_layer_label"></label>',o+='<input type="checkbox" class="entferne_layer" id="entferne_layer_'+t.replace(" ","_")+'">',o+='<label for="entferne_layer_'+t.replace(" ","_")+'" title="Ebene entfernen" class="entferne_layer_label"></label>',o+="</div>",o+='<div id="eigene_layer_meldung_'+t.replace(" ","_")+'" class="eigene_layer_meldung"></div>',o+="</div>",b=!0),o+="</li>",o+="<hr>",n){case"CH Hintergrund":l+=o;break;case"CH Sachinformationen":p+=o;break;case"CH Biotopinventare":h+=o;break;case"ZH Sachinformationen":d+=o;break;case"AP Flora":c+=o;break;case"Eigene Ebenen":m+=o,w++}}),l=l.substring(0,l.length-4),p=p.substring(0,p.length-4),h=h.substring(0,h.length-4),d=d.substring(0,d.length-4),w>0&&(m=m.substring(0,m.length-4)),c="<h3>ZH AP Flora</h3><div>"!==c?c.substring(0,c.length-4):"",l+="</div>",p+="</div>",h+="</div>",d+="</div>",c+="</div>",w>0&&(s+=m),s+="</div>",a=l+p+h+d+c+s,u.html(a),e?(f.accordion({collapsible:!0,active:!1,heightStyle:"content"}),f.accordion({collapsible:!0,active:0,heightStyle:"content"}),"Eigene Ebenen"===e&&(r=5),$("#olmap_layertree_layers").accordion({collapsible:!0,active:r,heightStyle:"content"})):f.accordion({collapsible:!0,active:!1,heightStyle:"content"}),u.css("max-height",window.apf.berechneOlmapLayertreeMaxhöhe),$(".neues_layer").button({icons:{primary:"ui-icon-plusthick"}}).button("refresh"),$(".export_layer_select").selectmenu(),b&&($(".modify_layer").button({icons:{primary:"ui-icon-locked"},text:!1}).button("refresh"),$(".modify_layer_label, .export_layer_select_label, .rename_layer_label, .entferne_layer_label, .apf_tooltip").tooltip({tooltipClass:"tooltip-styling-hinterlegt",content:function(){return $(this).attr("title")}}),$(".rename_layer").button({icons:{primary:"ui-icon-tag"},text:!1}).button("refresh"),$(".entferne_layer").button({icons:{primary:"ui-icon-closethick"},text:!1}).button("refresh"))},window.apf.öffneFormularAlsPopup=function(e,t){var i,n=$("#"+e);switch(e){case"pop":i="Population";break;case"tpop":i="Teilpopulation";break;case"beob":i="Beobachtung";break;default:i=""}localStorage[e+"_id"]=t,"beob"===e?window.apf["initiiere_"+e]("beob_nicht_beurteilt",t,"nicht_beurteilt",!0):window.apf["initiiere_"+e](!0),n.dialog({close:function(){n.dialog("destroy")},width:600,maxHeight:$("#menu").height(),resizable:!0,position:{my:"left top",at:"left top",of:$("#menu")},title:i}),n.dialog("open")},window.apf.olmap.detailplanStyle=function(){"use strict";return new ol.style.Style({fill:new ol.style.Fill({color:"rgba(250, 58, 15, 0.1)"}),stroke:new ol.style.Stroke({color:"#fa3a0f",width:1})})},window.apf.olmap.detailplanStyleSelected=function(){"use strict";return new ol.style.Style({fill:new ol.style.Fill({color:"rgba(15, 85, 250, 0.1)"}),stroke:new ol.style.Stroke({color:"#0F55FA",width:1})})},window.apf.olmap.popStyle=function(e,t,i){"use strict";var n,o,a,s,r,l,p="img/flora_icon_braun.png",h=(e.get("myId"),"white"),d=$("#layertree_pop_nr");
return i&&(p="img/flora_icon_orange.png",h="red"),o=new ol.style.Icon({anchor:[.5,46],anchorXUnits:"fraction",anchorYUnits:"pixels",opacity:1,src:p}),d.is(":checked")?a=e.get("pop_nr"):$("#layertree_pop_name").is(":checked")&&(a=e.get("pop_name")),s=new ol.style.Text({font:"bold 11px Arial, Verdana, Helvetica, sans-serif",text:a,fill:new ol.style.Fill({color:"black"}),stroke:new ol.style.Stroke({color:h,width:7})}),r=new ol.style.Style({image:o,text:s}),l=new ol.style.Style({image:o}),n=d.is(":checked")?r:$("#layertree_pop_name").is(":checked")?r:l,[n]},window.apf.olmap.tpopStyle=function(e,t,i,n){"use strict";var o,a,s,r,l,p,h="img/flora_icon.png",d=(e.get("myId"),"white"),c=$("#layertree_tpop_nr");return i&&(h="img/flora_icon_gelb.png",d="red"),n&&(h="img/flora_icon_rot.png"),a=new ol.style.Icon({anchor:[.5,46],anchorXUnits:"fraction",anchorYUnits:"pixels",opacity:1,src:h}),c.is(":checked")?s=e.get("tpop_nr_label"):$("#layertree_tpop_name").is(":checked")&&(s=e.get("tpop_name")),r=new ol.style.Text({font:"bold 11px Arial, Verdana, Helvetica, sans-serif",text:s,fill:new ol.style.Fill({color:"black"}),stroke:new ol.style.Stroke({color:d,width:7})}),l=new ol.style.Style({image:a,text:r}),p=new ol.style.Style({image:a}),o=c.is(":checked")?l:$("#layertree_tpop_name").is(":checked")?l:p,[o]},window.apf.olmap.messe=function(e){"use strict";window.apf.olmap.deactivateMenuItems(),"line"===e.value&&e.checked?window.apf.olmap.addMeasureInteraction("LineString"):"polygon"===e.value&&e.checked?window.apf.olmap.addMeasureInteraction("Polygon"):window.apf.olmap.removeMeasureInteraction()},window.apf.olmap.removeMeasureInteraction=function(){window.apf.olmap.entferneLayerNachName("messen"),window.apf.olmap.map.removeInteraction(window.apf.olmap.drawMeasure),delete window.apf.olmap.drawMeasure,$("#ergebnisMessung").text(""),$(window.apf.olmap.map.getViewport()).off("mousemove")},window.apf.olmap.addMeasureInteraction=function(e){window.apf.olmap.removeMeasureInteraction();var t=new ol.source.Vector,i=new ol.layer.Vector({title:"messen",source:t,style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"rgba(255, 0, 0, 1)",width:3,lineDash:[2,2],lineCap:"square"}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ffcc33"})})})});window.apf.olmap.map.addLayer(i);var n,o=null,a=function(){if(o){var e,t=o.getGeometry();t instanceof ol.geom.Polygon?e=window.apf.olmap.formatArea(t):t instanceof ol.geom.LineString&&(e=window.apf.olmap.formatLength(t)),n.innerHTML=e}};$(window.apf.olmap.map.getViewport()).on("mousemove",a),window.apf.olmap.drawMeasure=new ol.interaction.Draw({source:t,type:e}),window.apf.olmap.map.addInteraction(window.apf.olmap.drawMeasure),window.apf.olmap.drawMeasure.on("drawstart",function(e){o=e.feature,n=document.createElement("li");var t=document.getElementById("ergebnisMessung");t.childNodes?t.insertBefore(n,t.firstChild):t.appendChild(n)},this),window.apf.olmap.drawMeasure.on("drawend",function(){o=null,n=null},this)},window.apf.olmap.formatLength=function(e){var t,i=Math.round(100*e.getLength())/100;return t=i>100?Math.round(i/1e3*100)/100+" km":Math.round(100*i)/100+" m"},window.apf.olmap.formatArea=function(e){var t,i=e.getArea();return t=i>1e4?Math.round(i/1e6*100)/100+" km<sup>2</sup>":Math.round(100*i)/100+" m<sup>2</sup>"},window.apf.olmap.wähleAus=function(){window.apf.olmap.deactivateMenuItems(),window.apf.olmap.addSelectFeaturesInSelectableLayers()},window.apf.olmap.schliesseLayeroptionen=function(){"use strict";$("#olmap_layertree").accordion("option","active",!1)},window.apf.erstelleGemeindeliste=function(){"use strict";if(!window.Gemeinden){var e=$.ajax({type:"get",url:"php/gemeinden.php",dataType:"json"});e.always(function(e){if(e){var t=_.map(e.rows,function(e){return e.GmdName?e.GmdName:void 0});window.Gemeinden=t,$("#TPopGemeinde").autocomplete({source:t,delay:0,change:function(e){window.apf.speichern(e.target)}})}}),e.fail(function(){console.log("Fehler: Die Liste der Gemeinden konnte nicht bereitgestellt werden")})}},window.apf.wähleAp=function(e){"use strict";if(e)if($("#ap_waehlen_label").hide(),localStorage.ap_id=e,"programm_neu"===$("[name='programm_wahl']:checked").attr("id")){var t=$.ajax({type:"post",url:"php/ap_insert.php",dataType:"json",data:{id:localStorage.ap_id,user:sessionStorage.User}});t.always(function(){$("#programm_neu").attr("checked",!1),$("#programm_alle").attr("checked",!0),$("#programm_wahl").buttonset(),$.when(window.apf.wähleApListe("programm_alle")).then(function(){$.when(window.apf.erstelle_tree(localStorage.ap_id)).then(function(){$("#ap_waehlen").val(localStorage.ap_id),$("#ap_waehlen option[value ="+localStorage.ap_id+"]").attr("selected",!0),$("#ApArtId").val(localStorage.ap_id),window.apf.initiiere_ap()})})}),t.fail(function(){console.log("Fehler: Keine Daten für Programme erhalten")})}else window.apf.erstelle_tree(e),$("#ap").show(),window.apf.initiiere_ap();else $("#ap_waehlen_label").html("Artförderprogramm wählen:").show(),$("#tree").hide(),$("#suchen").hide(),$("#exportieren_2").hide(),$("#hilfe").hide(),$("#ap_loeschen").hide(),$("#exportieren_1").show(),$("#ap").hide(),window.apf.zeigeFormular(),history.replaceState({ap:"ap"},"ap","index.html")},window.apf.kopiereKoordinatenInPop=function(e,t){"use strict";if(e>1e5&&t>1e5){var i=$.ajax({type:"post",url:"php/pop_update.php",dataType:"json",data:{id:localStorage.pop_id,Feld:"PopXKoord",Wert:e,user:sessionStorage.User}});i.always(function(){var e=$.ajax({type:"post",url:"php/pop_update.php",dataType:"json",data:{id:localStorage.pop_id,Feld:"PopYKoord",Wert:t,user:sessionStorage.User}});e.always(function(){$("#kopiereKoordinatenInPopRueckmeldung").fadeIn("slow"),setTimeout(function(){$("#kopiereKoordinatenInPopRueckmeldung").fadeOut("slow")},3e3)}),e.fail(function(){console.log("Fehler: Y-Koordinate wurde nicht kopiert (die X-Koordinate offenbar schon)")})}),i.fail(function(){console.log("Fehler: Koordinaten wurden nicht kopiert")})}else window.apf.melde("Sie müssen zuerst Koordinaten erfassen","Koordinaten nicht kopiert")},window.apf.prüfeAnmeldung=function(){"use strict";if(delete sessionStorage.NurLesen,$("#anmeldung_name").val()&&$("#anmeldung_passwort").val()){var e=$.ajax({type:"get",url:"php/anmeldung.php",dataType:"json",data:{Name:$("#anmeldung_name").val(),pwd:$("#anmeldung_passwort").val()}});e.always(function(e){e&&e.anzUser>0?(sessionStorage.User=$("#anmeldung_name").val(),e.NurLesen&&-1===e.NurLesen&&(sessionStorage.NurLesen=!0),$("#anmeldung_rueckmeldung").html("Willkommen "+$("#anmeldung_name").val()).addClass("ui-state-highlight"),setTimeout(function(){$("#anmelde_dialog").dialog("close",2e3)},1e3)):(alert("Anmeldung gescheitert"),$("#anmeldung_rueckmeldung").html("Anmeldung gescheitert").addClass("ui-state-highlight"),setTimeout(function(){$("#anmeldung_rueckmeldung").removeClass("ui-state-highlight",1500)},500))}),e.fail(function(){window.apf.melde("Anmeldung gescheitert","Oops!")})}else $("#anmeldung_rueckmeldung").html("Bitte Name und Passwort ausfüllen").addClass("ui-state-highlight"),setTimeout(function(){$("#anmeldung_rueckmeldung").removeClass("ui-state-highlight",1500)},500)},window.apf.erstelleLabelFürFeldkontrolle=function(e,t){"use strict";return"undefined"==typeof e&&(e="(kein Jahr)"),"undefined"==typeof t&&(t="(kein Typ)"),e+": "+t},window.apf.erstelleLabelFürMassnahme=function(e,t){"use strict";return"undefined"==typeof e&&(e="(kein Jahr)"),"undefined"==typeof t&&(t="(keine Beurteilung)"),e+": "+t},window.apf.erstelleFelderFürBeob=function(e,t){"use strict";var i="<h1>Informationen aus ";i+="infospezies"===t?"Info Spezies":"EvAB",i+=" (nicht veränderbar)</h1>";var n,o="<table>",a=["NO_ISFS","ESPECE","CUSTOM_TEXT_5_","OBJECTID","FNS_GISLAYER","FNS_ISFS","ID","FNS_JAHR","NOM_COMPLET","FAMILLE"];return $.each(e,function(e,t){!t&&0!==t||-1!==a.indexOf(e)||(n='<tr class="fieldcontain"><td class="label" style="padding-bottom:3px;"><label for="beobfelder_',n+=e,n+='">',n+=e,n+=':</label></td><td class="Datenfelder" style="padding-bottom:3px;"><input id="beobfelder_',n+=e,n+='" class="Datenfelder" type="text" readonly="readonly" value="',n+=t,n+='""></td></tr>',o+=n)}),o+="</table>",i+o},window.apf.erstelleIdAusDomAttributId=function(e){"use strict";var t=e.replace("ap_ordner_pop","").replace("ap_ordner_apziel","").replace("ap_ordner_erfkrit","").replace("ap_ordner_jber","").replace("ap_ordner_ber","").replace("ap_ordner_beob_nicht_beurteilt","").replace("ap_ordner_beob_nicht_zuzuordnen","").replace("idealbiotop","").replace("ap_ordner_assozarten","").replace("tpop_ordner_massnber","").replace("tpop_ordner_massn","").replace("tpopmassnber","").replace("pop_ordner_massnber","").replace("popmassnber","").replace("tpop_ordner_feldkontr","").replace("tpop_ordner_freiwkontr","").replace("tpop_ordner_tpopber","").replace("tpopber","").replace("pop_ordner_popber","").replace("popber","").replace("tpop_ordner_beob_zugeordnet","").replace("beob","").replace("ber","");return e==t&&parseInt(t)&&parseInt(t)!=t&&console.log("window.apf.erstelleIdAusDomAttributId meldet: erhalten "+e+", zurückgegeben: "+t+". Die Regel in der function muss wohl angepasst werden"),t},window.apf.zeigeBeobKoordinatenImGisBrowser=function(){"use strict";var e,t,i=$("#beobfelder_FNS_XGIS"),n=$("#beobfelder_FNS_YGIS"),o=$("#beobfelder_COORDONNEE_FED_E"),a=$("#beobfelder_COORDONNEE_FED_N"),s=$("#TPopXKoord"),r=$("#TPopYKoord"),l=$("#PopXKoord"),p=$("#PopYKoord");i.val()&&n.val()?(e="//www.maps.zh.ch/?x="+i.val()+"&y="+n.val()+"&scale=3000&markers=ring",window.open(e,t="_blank")):o.val()&&a.val()?(e="//www.maps.zh.ch/?x="+o.val()+"&y="+a.val()+"&scale=3000&markers=ring",window.open(e,t="_blank")):s.val()&&r.val()?(e="//www.maps.zh.ch/?x="+s.val()+"&y="+r.val()+"&scale=3000&markers=ring",window.open(e,t="_blank")):l.val()&&p.val()?(e="//www.maps.zh.ch/?x="+l.val()+"&y="+p.val()+"&scale=3000&markers=ring",window.open(e,t="_blank")):window.apf.melde("Fehler: Keine Koordinaten zum Anzeigen","Aktion abgebrochen")},window.apf.beschrifteTPopMitNrFürKarte=function(e,t){"use strict";var i;return e=e||"?",i=t?e+"/"+t:e+"/?"},window.apf.melde=function(e,t){"use strict";var t=t||" ";$("#Meldung").html(e).attr("title",t).dialog({modal:!0,buttons:{Ok:function(){$(this).dialog("close")}}})},window.apf.frageObAktionRückgängigGemachtWerdenSoll=function(e){"use strict";$("#undelete_div").html(e+" <a href='#' id='undelete'>Rückgängig machen?</a>"),$(".undelete").show(),$(window).width()>1e3&&$("#forms").css("top","37px"),setTimeout(function(){$("#undelete_div").html(""),$(".undelete").hide(),$("#forms").css("top","")},3e4)},window.apf.insertNeuenNodeAufGleicherHierarchiestufe=function(e,t,i,n,o){"use strict";var a;if(localStorage[i+"_id"]=n,delete window.apf[i],a=$.jstree._reference(t).create_node(t,"last",{data:o,attr:{id:n,typ:i}}),"pop"===i&&window.apf.insertOrdnerVonPop(a,n),"tpop"===i&&window.apf.insertOrdnerVonTPop(a,n),"apziel"===i&&$.jstree._reference(a).create_node(a,"last",{data:"0 Ziel-Berichte",attr:{id:n,typ:"zielber_ordner"}}),"apziel"===i){var s=$.jstree._reference(t)._get_parent(t);window.apf.beschrifte_ordner_apziel(s),"neue AP-Ziele"!==$.jstree._reference(t).get_text(t)&&window.apf.beschrifte_ordner_apzieljahr(t)}else window.apf["beschrifte_ordner_"+i](t);$.jstree._reference(e).deselect_all(),$.jstree._reference(a).select_node(a),"tpopfreiwkontr"===i?(localStorage.tpopfreiwkontr=!0,window.apf.initiiere_tpopfeldkontr()):window.apf["initiiere_"+i]()},window.apf.insertNeuenNodeEineHierarchiestufeTiefer=function(e,t,i,n,o){"use strict";var a;if(localStorage[i+"_id"]=n,delete window.apf[i],"apziel"===i&&localStorage.apziel_von_ordner_apziel){var s=$.jstree._reference(e).create_node(e,"last",{data:"neue AP-Ziele",attr:{id:window.apf.erstelleIdAusDomAttributId($(e).attr("id")),typ:"apzieljahr"}});a=$.jstree._reference(s).create_node(s,"last",{data:o,attr:{id:n,typ:i}}),delete localStorage.apziel_von_ordner_apziel}else a=$.jstree._reference(e).create_node(e,"last",{data:o,attr:{id:n,typ:i}});"pop"===i&&window.apf.insertOrdnerVonPop(a,n),"tpop"===i&&window.apf.insertOrdnerVonTPop(a,n),"apziel"===i&&$.jstree._reference(a).create_node(a,"last",{data:"0 Ziel-Berichte",attr:{id:n,typ:"zielber_ordner"}}),"apziel"===i&&localStorage.apziel_von_apzieljahr?("neue AP-Ziele"!==$.jstree._reference(t).get_text(t)&&window.apf.beschrifte_ordner_apziel(t),window.apf.beschrifte_ordner_apzieljahr(e),delete localStorage.apziel_von_apzieljahr):"jber_uebersicht"!==i&&window.apf["beschrifte_ordner_"+i](e),$.jstree._reference(e).deselect_all(),$.jstree._reference(a).select_node(a),"tpopfreiwkontr"===i?(localStorage.tpopfreiwkontr=!0,window.apf.initiiere_tpopfeldkontr()):window.apf["initiiere_"+i]()},window.apf.insertOrdnerVonPop=function(e,t){"use strict";$.jstree._reference(e).create_node(e,"last",{data:"Teilpopulationen",attr:{id:t,typ:"pop_ordner_tpop"}}),$.jstree._reference(e).create_node(e,"last",{data:"Populations-Berichte",attr:{id:t,typ:"pop_ordner_popber"}}),$.jstree._reference(e).create_node(e,"last",{data:"Massnahmen-Berichte",attr:{id:t,typ:"pop_ordner_massnber"}})},window.apf.insertOrdnerVonTPop=function(e,t){"use strict";$.jstree._reference(e).create_node(e,"last",{data:"Massnahmen",attr:{id:t,typ:"tpop_ordner_massn"}}),$.jstree._reference(e).create_node(e,"last",{data:"Massnahmen-Berichte",attr:{id:t,typ:"tpop_ordner_massnber"}}),$.jstree._reference(e).create_node(e,"last",{data:"Feldkontrollen",attr:{id:t,typ:"tpop_ordner_feldkontr"}}),$.jstree._reference(e).create_node(e,"last",{data:"Freiwilligen-Kontrollen",attr:{id:t,typ:"tpop_ordner_freiwkontr"}}),$.jstree._reference(e).create_node(e,"last",{data:"Teilpopulations-Berichte",attr:{id:t,typ:"tpop_ordner_tpopber"}}),$.jstree._reference(e).create_node(e,"last",{data:"Beobachtungen",attr:{id:t,typ:"tpop_ordner_beob_zugeordnet"}})},window.apf.löscheAp=function(e){"use strict";window.apf.deleted=window.apf,window.apf.deleted.typ="ap",window.apf.deleted.Artname=$("#ap_waehlen option[value='"+$("#ap_waehlen").val()+"']").text();var t=$.ajax({type:"post",url:"php/ap_delete.php",dataType:"json",data:{id:e}});t.always(function(){var e=$("#exportieren_2");delete localStorage.ap_id,delete window.apf.ap,delete localStorage.ap,$("#programm_neu").attr("checked",!1),$("#programm_alle").attr("checked",!0),$("#programm_wahl").buttonset(),window.apf.erstelle_ap_liste("programm_alle"),$("#ap_waehlen").val(""),$("#ap_waehlen_label").html("Artförderprogramm wählen:").show(),$("#tree").hide(),$("#suchen").hide(),e.hide(),$("#hilfe").hide(),$("#ap_loeschen").hide(),e.show(),$("#ap").hide(),$("#forms").hide(),window.apf.frageObAktionRückgängigGemachtWerdenSoll("Das Programm der Art '"+window.apf.deleted.Artname+"' wurde gelöscht."),delete window.apf.deleted.Artname,window.apf.zeigeFormular("keines")}),t.fail(function(){console.log("Fehler: Das Programm wurde nicht gelöscht")})},window.apf.undeleteDatensatz=function(){"use strict";var e,t,i,n={};if(!window.apf.deleted)return window.apf.melde("Wiederherstellung gescheitert","Fehler"),!1;switch(delete window.apf.deleted.Artname,t=window.apf.deleted.typ,delete window.apf.deleted.typ,t){case"ap":e="tblAktionsplan",i=window.apf.deleted.ApArtId,delete window.apf.deleted.Artname;break;case"apziel":e="tblZiel",i=window.apf.deleted.ZielId;break;case"zielber":e="tblZielBericht",i=window.apf.deleted.ZielBerId;break;case"erfkrit":e="tblErfKrit",i=window.apf.deleted.ErfkritId;break;case"pop":e="tblPopulation",i=window.apf.deleted.PopId;break;case"popber":e="tblPopBericht",i=window.apf.deleted.PopBerId;break;case"popmassnber":e="tblPopMassnBericht",i=window.apf.deleted.PopMassnBerId;break;case"tpop":e="tblTeilpopulation",i=window.apf.deleted.TPopId;break;case"tpopmassn":e="tblTeilPopMassnahme",i=window.apf.deleted.TPopMassnId;break;case"tpopmassnber":e="tblTeilPopMassnBericht",i=window.apf.deleted.TPopMassnBerId;break;case"tpopber":e="tblTeilPopBericht",i=window.apf.deleted.TPopBerId;break;case"tpopfeldkontr":case"tpopfreiwkontr":e="tblTeilPopFeldkontrolle",i=window.apf.deleted.TPopKontrId;break;case"jber":e="tblJBer",i=window.apf.deleted.JBerId;break;case"jber_uebersicht":e="tblJBerUebersicht",i=window.apf.deleted.JbuJahr;break;case"ber":e="tblBer",i=window.apf.deleted.BerId;break;case"assozarten":e="tblAssozArten",i=window.apf.deleted.AaId;break;default:window.apf.melde("Wiederherstellung gescheitert","Fehler")}n.tabelle=e,_.each(window.apf.deleted,function(e,t){e&&(n[t]=e)});var o=$.ajax({type:"post",url:"php/insert_multiple.php",dataType:"json",data:n});o.always(function(){$(".undelete").hide(),$("#forms").css("top",""),"ap"===t?(window.apf.zeigeFormular(),window.apf.initiiere_index(),window.apf.zeigeFormular("ap"),history.replaceState({ap:"ap"},"ap","index.html?ap="+i)):$.when(window.apf.erstelle_tree(window.apf.olmap.erstellePopLayer)).then(function(){$("#tree").jstree("select_node","[typ='"+t+"']#"+i)})}),o.fail(function(){console.log("Fehler: Wiederherstellung gescheitert")})},window.apf.olmap.exportiereKarte=function(){"use strict";var e=document.getElementById("olmap_exportieren");if("download"in e)e.addEventListener("click",function(){window.apf.olmap.map.once("postcompose",function(t){var i=t.context.canvas;e.href=i.toDataURL("image/png")}),window.apf.olmap.map.renderSync()},!1),window.apf.olmap.recentlyClicked||(window.apf.olmap.recentlyClicked=!0,setTimeout(function(){e.click()},200));else{var t='Der Download ist nur möglich, wenn Ihr Browser das moderne Download-Attribut unterstützt <a href="http://caniuse.com/#feat=download">(hier eine aktuelle Liste der unterstützenden Browser)</a>';window.apf.melde(t,"Export abgebrochen")}},function(e){e.fn.extend({limiter:function(t,i){function n(e,i){var n=e.value.length;n>t&&(e.value=e.value.substr(0,t),n=t),i.html(t-n)}e(this).on("keyup focus",function(){n(this,i)}),n(e(this)[0],i)}})}(jQuery),window.apf.erstelleGuid=function(){"use strict";return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,i="x"==e?t:3&t|8;return i.toString(16)})},function(){var e=this,t=e._,i={},n=Array.prototype,o=Object.prototype,a=Function.prototype,s=n.push,r=n.slice,l=n.concat,p=o.toString,h=o.hasOwnProperty,d=n.forEach,c=n.map,u=n.reduce,f=n.reduceRight,g=n.filter,m=n.every,_=n.some,w=n.indexOf,b=n.lastIndexOf,v=Array.isArray,y=Object.keys,k=a.bind,x=function(e){return e instanceof x?e:this instanceof x?void(this._wrapped=e):new x(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.4.4";var M=x.each=x.forEach=function(e,t,n){if(null!=e)if(d&&e.forEach===d)e.forEach(t,n);else if(e.length===+e.length){for(var o=0,a=e.length;a>o;o++)if(t.call(n,e[o],o,e)===i)return}else for(var s in e)if(x.has(e,s)&&t.call(n,e[s],s,e)===i)return};x.map=x.collect=function(e,t,i){var n=[];return null==e?n:c&&e.map===c?e.map(t,i):(M(e,function(e,o,a){n[n.length]=t.call(i,e,o,a)}),n)};var T="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,i,n){var o=arguments.length>2;if(null==e&&(e=[]),u&&e.reduce===u)return n&&(t=x.bind(t,n)),o?e.reduce(t,i):e.reduce(t);if(M(e,function(e,a,s){o?i=t.call(n,i,e,a,s):(i=e,o=!0)}),!o)throw new TypeError(T);return i},x.reduceRight=x.foldr=function(e,t,i,n){var o=arguments.length>2;if(null==e&&(e=[]),f&&e.reduceRight===f)return n&&(t=x.bind(t,n)),o?e.reduceRight(t,i):e.reduceRight(t);var a=e.length;if(a!==+a){var s=x.keys(e);a=s.length}if(M(e,function(r,l,p){l=s?s[--a]:--a,o?i=t.call(n,i,e[l],l,p):(i=e[l],o=!0)}),!o)throw new TypeError(T);return i},x.find=x.detect=function(e,t,i){var n;return P(e,function(e,o,a){return t.call(i,e,o,a)?(n=e,!0):void 0}),n},x.filter=x.select=function(e,t,i){var n=[];return null==e?n:g&&e.filter===g?e.filter(t,i):(M(e,function(e,o,a){t.call(i,e,o,a)&&(n[n.length]=e)}),n)},x.reject=function(e,t,i){return x.filter(e,function(e,n,o){return!t.call(i,e,n,o)},i)},x.every=x.all=function(e,t,n){t||(t=x.identity);var o=!0;return null==e?o:m&&e.every===m?e.every(t,n):(M(e,function(e,a,s){return(o=o&&t.call(n,e,a,s))?void 0:i}),!!o)};var P=x.some=x.any=function(e,t,n){t||(t=x.identity);var o=!1;return null==e?o:_&&e.some===_?e.some(t,n):(M(e,function(e,a,s){return o||(o=t.call(n,e,a,s))?i:void 0}),!!o)};x.contains=x.include=function(e,t){return null==e?!1:w&&e.indexOf===w?-1!=e.indexOf(t):P(e,function(e){return e===t})},x.invoke=function(e,t){var i=r.call(arguments,2),n=x.isFunction(t);return x.map(e,function(e){return(n?t:e[t]).apply(e,i)})},x.pluck=function(e,t){return x.map(e,function(e){return e[t]})},x.where=function(e,t,i){return x.isEmpty(t)?i?null:[]:x[i?"find":"filter"](e,function(e){for(var i in t)if(t[i]!==e[i])return!1;return!0})},x.findWhere=function(e,t){return x.where(e,t,!0)},x.max=function(e,t,i){if(!t&&x.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.max.apply(Math,e);if(!t&&x.isEmpty(e))return-1/0;var n={computed:-1/0,value:-1/0};return M(e,function(e,o,a){var s=t?t.call(i,e,o,a):e;s>=n.computed&&(n={value:e,computed:s})}),n.value},x.min=function(e,t,i){if(!t&&x.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.min.apply(Math,e);if(!t&&x.isEmpty(e))return 1/0;var n={computed:1/0,value:1/0};return M(e,function(e,o,a){var s=t?t.call(i,e,o,a):e;n.computed>s&&(n={value:e,computed:s})}),n.value},x.shuffle=function(e){var t,i=0,n=[];return M(e,function(e){t=x.random(i++),n[i-1]=n[t],n[t]=e}),n};var S=function(e){return x.isFunction(e)?e:function(t){return t[e]}};x.sortBy=function(e,t,i){var n=S(t);return x.pluck(x.map(e,function(e,t,o){return{value:e,index:t,criteria:n.call(i,e,t,o)}}).sort(function(e,t){var i=e.criteria,n=t.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return e.index<t.index?-1:1}),"value")};var I=function(e,t,i,n){var o={},a=S(t||x.identity);return M(e,function(t,s){var r=a.call(i,t,s,e);n(o,r,t)}),o};x.groupBy=function(e,t,i){return I(e,t,i,function(e,t,i){(x.has(e,t)?e[t]:e[t]=[]).push(i)})},x.countBy=function(e,t,i){return I(e,t,i,function(e,t){x.has(e,t)||(e[t]=0),e[t]++})},x.sortedIndex=function(e,t,i,n){i=null==i?x.identity:S(i);for(var o=i.call(n,t),a=0,s=e.length;s>a;){var r=a+s>>>1;o>i.call(n,e[r])?a=r+1:s=r}return a},x.toArray=function(e){return e?x.isArray(e)?r.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return null==e?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,i){return null==e?void 0:null==t||i?e[0]:r.call(e,0,t)},x.initial=function(e,t,i){return r.call(e,0,e.length-(null==t||i?1:t))},x.last=function(e,t,i){return null==e?void 0:null==t||i?e[e.length-1]:r.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,i){return r.call(e,null==t||i?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var z=function(e,t,i){return M(e,function(e){x.isArray(e)?t?s.apply(i,e):z(e,t,i):i.push(e)}),i};x.flatten=function(e,t){return z(e,t,[])},x.without=function(e){return x.difference(e,r.call(arguments,1))},x.uniq=x.unique=function(e,t,i,n){x.isFunction(t)&&(n=i,i=t,t=!1);var o=i?x.map(e,i,n):e,a=[],s=[];return M(o,function(i,n){(t?n&&s[s.length-1]===i:x.contains(s,i))||(s.push(i),a.push(e[n]))}),a},x.union=function(){return x.uniq(l.apply(n,arguments))},x.intersection=function(e){var t=r.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.indexOf(t,e)>=0})})},x.difference=function(e){var t=l.apply(n,r.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){for(var e=r.call(arguments),t=x.max(x.pluck(e,"length")),i=Array(t),n=0;t>n;n++)i[n]=x.pluck(e,""+n);return i},x.object=function(e,t){if(null==e)return{};for(var i={},n=0,o=e.length;o>n;n++)t?i[e[n]]=t[n]:i[e[n][0]]=e[n][1];return i},x.indexOf=function(e,t,i){if(null==e)return-1;var n=0,o=e.length;if(i){if("number"!=typeof i)return n=x.sortedIndex(e,t),e[n]===t?n:-1;n=0>i?Math.max(0,o+i):i}if(w&&e.indexOf===w)return e.indexOf(t,i);for(;o>n;n++)if(e[n]===t)return n;return-1},x.lastIndexOf=function(e,t,i){if(null==e)return-1;var n=null!=i;if(b&&e.lastIndexOf===b)return n?e.lastIndexOf(t,i):e.lastIndexOf(t);for(var o=n?i:e.length;o--;)if(e[o]===t)return o;return-1},x.range=function(e,t,i){1>=arguments.length&&(t=e||0,e=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((t-e)/i),0),o=0,a=Array(n);n>o;)a[o++]=e,e+=i;return a},x.bind=function(e,t){if(e.bind===k&&k)return k.apply(e,r.call(arguments,1));var i=r.call(arguments,2);return function(){return e.apply(t,i.concat(r.call(arguments)))}},x.partial=function(e){var t=r.call(arguments,1);return function(){return e.apply(this,t.concat(r.call(arguments)))}},x.bindAll=function(e){var t=r.call(arguments,1);return 0===t.length&&(t=x.functions(e)),M(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var i={};return t||(t=x.identity),function(){var n=t.apply(this,arguments);return x.has(i,n)?i[n]:i[n]=e.apply(this,arguments)}},x.delay=function(e,t){var i=r.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(r.call(arguments,1)))},x.throttle=function(e,t){var i,n,o,a,s=0,r=function(){s=new Date,o=null,a=e.apply(i,n)};return function(){var l=new Date,p=t-(l-s);return i=this,n=arguments,0>=p?(clearTimeout(o),o=null,s=l,a=e.apply(i,n)):o||(o=setTimeout(r,p)),a}},x.debounce=function(e,t,i){var n,o;return function(){var a=this,s=arguments,r=function(){n=null,i||(o=e.apply(a,s))},l=i&&!n;return clearTimeout(n),n=setTimeout(r,t),l&&(o=e.apply(a,s)),o}},x.once=function(e){var t,i=!1;return function(){return i?t:(i=!0,t=e.apply(this,arguments),e=null,t)}},x.wrap=function(e,t){return function(){var i=[e];return s.apply(i,arguments),t.apply(this,i)}},x.compose=function(){var e=arguments;return function(){for(var t=arguments,i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},x.after=function(e,t){return 0>=e?t():function(){return 1>--e?t.apply(this,arguments):void 0}},x.keys=y||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var i in e)x.has(e,i)&&(t[t.length]=i);return t},x.values=function(e){var t=[];for(var i in e)x.has(e,i)&&t.push(e[i]);return t},x.pairs=function(e){var t=[];for(var i in e)x.has(e,i)&&t.push([i,e[i]]);return t},x.invert=function(e){var t={};for(var i in e)x.has(e,i)&&(t[e[i]]=i);return t},x.functions=x.methods=function(e){var t=[];for(var i in e)x.isFunction(e[i])&&t.push(i);return t.sort()},x.extend=function(e){return M(r.call(arguments,1),function(t){if(t)for(var i in t)e[i]=t[i]}),e},x.pick=function(e){var t={},i=l.apply(n,r.call(arguments,1));return M(i,function(i){i in e&&(t[i]=e[i])}),t},x.omit=function(e){var t={},i=l.apply(n,r.call(arguments,1));for(var o in e)x.contains(i,o)||(t[o]=e[o]);return t},x.defaults=function(e){return M(r.call(arguments,1),function(t){if(t)for(var i in t)null==e[i]&&(e[i]=t[i])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var C=function(e,t,i,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var o=p.call(e);if(o!=p.call(t))return!1;switch(o){case"[object String]":return e==t+"";case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var a=i.length;a--;)if(i[a]==e)return n[a]==t;i.push(e),n.push(t);var s=0,r=!0;if("[object Array]"==o){if(s=e.length,r=s==t.length)for(;s--&&(r=C(e[s],t[s],i,n)););}else{var l=e.constructor,h=t.constructor;if(l!==h&&!(x.isFunction(l)&&l instanceof l&&x.isFunction(h)&&h instanceof h))return!1;for(var d in e)if(x.has(e,d)&&(s++,!(r=x.has(t,d)&&C(e[d],t[d],i,n))))break;if(r){for(d in t)if(x.has(t,d)&&!s--)break;r=!s}}return i.pop(),n.pop(),r};x.isEqual=function(e,t){return C(e,t,[],[])},x.isEmpty=function(e){if(null==e)return!0;if(x.isArray(e)||x.isString(e))return 0===e.length;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!(!e||1!==e.nodeType)},x.isArray=v||function(e){return"[object Array]"==p.call(e)},x.isObject=function(e){return e===Object(e)},M(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return p.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!(!e||!x.has(e,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(e){return"function"==typeof e}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==p.call(e)},x.isNull=function(e){return null===e},x.isUndefined=function(e){return void 0===e},x.has=function(e,t){return h.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.times=function(e,t,i){for(var n=Array(e),o=0;e>o;o++)n[o]=t.call(i,o);return n},x.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var $={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};$.unescape=x.invert($.escape);var D={escape:RegExp("["+x.keys($.escape).join("")+"]","g"),unescape:RegExp("("+x.keys($.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return null==t?"":(""+t).replace(D[e],function(t){return $[e][t]})}}),x.result=function(e,t){if(null==e)return null;var i=e[t];return x.isFunction(i)?i.call(e):i},x.mixin=function(e){M(x.functions(e),function(t){var i=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return s.apply(e,arguments),N.call(this,i.apply(x,e))}})};var j=0;x.uniqueId=function(e){var t=++j+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var A=/(.)^/,E={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},F=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,i){var n;i=x.defaults({},i,x.templateSettings);var o=RegExp([(i.escape||A).source,(i.interpolate||A).source,(i.evaluate||A).source].join("|")+"|$","g"),a=0,s="__p+='";e.replace(o,function(t,i,n,o,r){return s+=e.slice(a,r).replace(F,function(e){return"\\"+E[e]}),i&&(s+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(s+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),o&&(s+="';\n"+o+"\n__p+='"),a=r+t.length,t}),s+="';\n",i.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{n=Function(i.variable||"obj","_",s)}catch(r){throw r.source=s,r}if(t)return n(t,x);var l=function(e){return n.call(this,e,x)};return l.source="function("+(i.variable||"obj")+"){\n"+s+"}",l},x.chain=function(e){return x(e).chain()};var N=function(e){return this._chain?x(e).chain():e};x.mixin(x),M(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];x.prototype[e]=function(){var i=this._wrapped;return t.apply(i,arguments),"shift"!=e&&"splice"!=e||0!==i.length||delete i[0],N.call(this,i)}}),M(["concat","join","slice"],function(e){var t=n[e];x.prototype[e]=function(){return N.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this);