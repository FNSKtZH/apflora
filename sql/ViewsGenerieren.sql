CREATE OR REPLACE VIEW vPopBerMassnJahre AS
SELECT apflora.tblPop.PopId, apflora.tblPopBer.PopBerJahr as "Jahr"
FROM apflora.tblPop INNER JOIN apflora.tblPopBer ON apflora.tblPop.PopId = apflora.tblPopBer.PopId
UNION DISTINCT SELECT apflora.tblPop.PopId, apflora.tblPopMassnBer.PopMassnBerJahr as "Jahr"
FROM apflora.tblPop INNER JOIN apflora.tblPopMassnBer ON apflora.tblPop.PopId = apflora.tblPopMassnBer.PopId
ORDER BY Jahr;

#im Gebrauch durch exportPopMitMassnberAnzMassn.php:
CREATE OR REPLACE VIEW vPopMassnberAnzMassn0 AS
SELECT apflora.tblPopMassnBer.PopId, apflora.tblPopMassnBer.PopMassnBerJahr, Count(apflora.tblTPopMassn.TPopMassnId) AS AnzahlvonTPopMassnId
FROM apflora.tblPopMassnBer INNER JOIN (apflora.tblTPop LEFT JOIN apflora.tblTPopMassn ON apflora.tblTPop.TPopId = apflora.tblTPopMassn.TPopId) ON apflora.tblPopMassnBer.PopId = apflora.tblTPop.PopId
WHERE apflora.tblTPopMassn.TPopMassnJahr=apflora.tblPopMassnBer.PopMassnBerJahr Or apflora.tblTPopMassn.TPopMassnJahr Is Null
GROUP BY apflora.tblPopMassnBer.PopId, apflora.tblPopMassnBer.PopMassnBerJahr
ORDER BY apflora.tblPopMassnBer.PopId, apflora.tblPopMassnBer.PopMassnBerJahr;

CREATE OR REPLACE VIEW vMassnJahre AS
SELECT apflora.tblTPopMassn.TPopMassnJahr 
FROM apflora.tblTPopMassn 
GROUP BY apflora.tblTPopMassn.TPopMassnJahr 
HAVING apflora.tblTPopMassn.TPopMassnJahr Between 1900 And 2100 ORDER BY apflora.tblTPopMassn.TPopMassnJahr;

CREATE OR REPLACE VIEW vApAnzMassnProJahr0 AS 
SELECT apflora.tblAp.ApArtId, apflora.tblTPopMassn.TPopMassnJahr, Count(apflora.tblTPopMassn.TPopMassnId) AS AnzahlvonTPopMassnId
FROM apflora.tblAp INNER JOIN ((apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN apflora.tblTPopMassn ON apflora.tblTPop.TPopId = apflora.tblTPopMassn.TPopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId
WHERE (apflora.tblAp.ApStatus Between 1 And 3) AND apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300
GROUP BY apflora.tblAp.ApArtId, apflora.tblTPopMassn.TPopMassnJahr
HAVING apflora.tblTPopMassn.TPopMassnJahr Is Not Null
ORDER BY apflora.tblAp.ApArtId, apflora.tblTPopMassn.TPopMassnJahr;

CREATE OR REPLACE VIEW vApApBerichtRelevant AS
SELECT apflora.tblAp.ApArtId
FROM apflora.tblAp INNER JOIN (apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId
WHERE apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300
GROUP BY apflora.tblAp.ApArtId;

#wird von vBerJb benutzt. Dieses Wiederum in Access:
CREATE OR REPLACE VIEW vErsteMassnahmeProArt AS 
SELECT apflora.tblAp.ApArtId, Min(apflora.tblTPopMassn.TPopMassnJahr) AS MinvonTPopMassnJahr
FROM ((apflora.tblAp INNER JOIN apflora.tblPop ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN apflora.tblTPopMassn ON apflora.tblTPop.TPopId = apflora.tblTPopMassn.TPopId
GROUP BY apflora.tblAp.ApArtId;

CREATE OR REPLACE VIEW vTPopOhnePop AS
SELECT apflora.tblTPop.TPopGuid AS "TPop Guid", apflora.tblTPop.TPopNr AS "TPop Nr", apflora.tblTPop.TPopGemeinde AS "TPop Gemeinde", apflora.tblTPop.TPopFlurname AS "TPop Flurname", domPopHerkunft_1.HerkunftTxt AS "TPop Status", apflora.tblTPop.TPopBekanntSeit AS "TPop bekannt seit", apflora.tblTPop.TPopHerkunftUnklar AS "TPop Status unklar", apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "TPop Begruendung fuer unklaren Status", apflora.tblTPop.TPopXKoord AS "TPop X-Koordinaten", apflora.tblTPop.TPopYKoord AS "TPop Y-Koordinaten", apflora.tblTPop.TPopRadius AS "TPop Radius (m)", apflora.tblTPop.TPopHoehe AS "TPop Hoehe ueM", apflora.tblTPop.TPopExposition AS "TPop Exposition", apflora.tblTPop.TPopKlima AS "TPop Klima", apflora.tblTPop.TPopNeigung AS "TPop Hangneigung", apflora.tblTPop.TPopBeschr AS "TPop Beschreibung", apflora.tblTPop.TPopKatNr AS "TPop Kataster-Nr", apflora.tblTPop.TPopApBerichtRelevant AS "TPop fuer AP-Bericht relevant", apflora.tblTPop.TPopEigen AS "TPop EigentuemerIn", apflora.tblTPop.TPopKontakt AS "TPop Kontakt vor Ort", apflora.tblTPop.TPopNutzungszone AS "TPop Nutzungszone", apflora.tblTPop.TPopBewirtschafterIn AS "TPop BewirtschafterIn", apflora.tblTPop.TPopBewirtschaftung AS "TPop Bewirtschaftung", apflora.tblTPop.MutWann AS "Datensatz zuletzt geaendert", apflora.tblTPop.MutWann AS "Datensatz zuletzt geaendert von"
FROM (apflora.tblPop RIGHT JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) LEFT JOIN apflora.domPopHerkunft AS domPopHerkunft_1 ON apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId
WHERE apflora.tblPop.PopId Is Null
ORDER BY apflora.tblTPop.TPopGemeinde, apflora.tblTPop.TPopFlurname, apflora.tblTPop.TPopNr;

CREATE OR REPLACE VIEW vMassn AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Familie, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "AP Art", apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", apflora.tblAp.ApJahr AS "AP Start im Jahr", apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", apflora.tblPop.PopGuid AS "Pop Guid", apflora.tblPop.PopNr AS "Pop Nr", apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begruendung fuer unklaren Status", apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", apflora.tblTPop.TPopId AS "TPop ID", apflora.tblTPop.TPopGuid AS "TPop Guid", apflora.tblTPop.TPopNr AS "TPop Nr", apflora.tblTPop.TPopGemeinde AS "TPop Gemeinde", apflora.tblTPop.TPopFlurname AS "TPop Flurname", domPopHerkunft_1.HerkunftTxt AS "TPop Status", apflora.tblTPop.TPopBekanntSeit AS "TPop bekannt seit", apflora.tblTPop.TPopHerkunftUnklar AS "TPop Status unklar", apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "TPop Begruendung fuer unklaren Status", apflora.tblTPop.TPopXKoord AS "TPop X-Koordinaten", apflora.tblTPop.TPopYKoord AS "TPop Y-Koordinaten", apflora.tblTPop.TPopRadius AS "TPop Radius (m)", apflora.tblTPop.TPopHoehe AS "TPop Hoehe", apflora.tblTPop.TPopExposition AS "TPop Exposition", apflora.tblTPop.TPopKlima AS "TPop Klima", apflora.tblTPop.TPopNeigung AS "TPop Hangneigung", apflora.tblTPop.TPopBeschr AS "TPop Beschreibung", apflora.tblTPop.TPopKatNr AS "TPop Kataster-Nr", apflora.tblTPop.TPopApBerichtRelevant AS "TPop fuer AP-Bericht relevant", apflora.tblTPop.TPopEigen AS "TPop EigentuemerIn", apflora.tblTPop.TPopKontakt AS "TPop Kontakt vor Ort", apflora.tblTPop.TPopNutzungszone AS "TPop Nutzungszone", apflora.tblTPop.TPopBewirtschafterIn AS "TPop BewirtschafterIn", apflora.tblTPop.TPopBewirtschaftung AS "TPop Bewirtschaftung", apflora.tblTPopMassn.TPopMassnGuid AS "Massn Guid", apflora.tblTPopMassn.TPopMassnJahr AS "Massn Jahr", apflora.tblTPopMassn.TPopMassnDatum AS "Massn Datum", domTPopMassnTyp.MassnTypTxt AS "Massn Typ", apflora.tblTPopMassn.TPopMassnTxt AS "Massn Massnahme", apflora.tblAdresse.AdrName AS "Massn BearbeiterIn", CAST(apflora.tblTPopMassn.TPopMassnBemTxt AS CHAR) AS "Massn Bemerkungen", apflora.tblTPopMassn.TPopMassnPlan AS "Massn Plan vorhanden", apflora.tblTPopMassn.TPopMassnPlanBez AS "Massn Plan Bezeichnung", apflora.tblTPopMassn.TPopMassnFlaeche AS "Massn Flaeche m2", apflora.tblTPopMassn.TPopMassnAnsiedForm AS "Massn Form der Ansiedlung", apflora.tblTPopMassn.TPopMassnAnsiedPflanzanordnung AS "Massn Pflanzanordnung", apflora.tblTPopMassn.TPopMassnMarkierung AS "Massn Markierung",  apflora.tblTPopMassn.TPopMassnAnsiedAnzTriebe AS "Massn Anz Triebe", apflora.tblTPopMassn.TPopMassnAnsiedAnzPfl AS "Massn Pflanzen", apflora.tblTPopMassn.TPopMassnAnzPflanzstellen AS "Massn Anz Pflanzstellen", apflora.tblTPopMassn.TPopMassnAnsiedWirtspfl AS "Massn Wirtspflanze", apflora.tblTPopMassn.TPopMassnAnsiedHerkunftPop AS "Massn Herkunftspopulation", apflora.tblTPopMassn.TPopMassnAnsiedDatSamm AS "Massn Sammeldatum", apflora.tblTPopMassn.MutWann AS "Datensatz zuletzt geaendert", apflora.tblTPopMassn.MutWer AS "Datensatz zuletzt geaendert von"
FROM ((((((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN ((apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN (apflora.tblTPopMassn LEFT JOIN apflora.domTPopMassnTyp ON apflora.tblTPopMassn.TPopMassnTyp = domTPopMassnTyp.MassnTypCode) ON apflora.tblTPop.TPopId = apflora.tblTPopMassn.TPopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN apflora.domPopHerkunft AS domPopHerkunft_1 ON apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId) LEFT JOIN apflora.tblAdresse ON apflora.tblTPopMassn.TPopMassnBearb = apflora.tblAdresse.AdrId
WHERE apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId NOT IN (100, 150)
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr, apflora.tblTPop.TPopNr, apflora.tblTPopMassn.TPopMassnJahr, apflora.tblTPopMassn.TPopMassnDatum, domTPopMassnTyp.MassnTypTxt;

CREATE OR REPLACE VIEW vMassnFuerGis AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "ApArt", apflora.domApBearbeitungsstand.DomainTxt AS "ApStatus", apflora.tblAp.ApJahr AS "ApStartImJahr", apflora.domApUmsetzung.DomainTxt AS "ApStandUmsetzung", apflora.tblPop.PopGuid AS "PopGuid", apflora.tblPop.PopNr AS "PopNr", apflora.tblPop.PopName AS "PopName", domPopHerkunft.HerkunftTxt AS "PopStatus", apflora.tblPop.PopBekanntSeit AS "PopBekanntSeit", apflora.tblPop.PopXKoord AS "PopXKoordinaten", apflora.tblPop.PopYKoord AS "PopYKoordinaten", apflora.tblTPop.TPopGuid AS "TPopGuid", apflora.tblTPop.TPopNr AS "TPopNr", apflora.tblTPop.TPopGemeinde AS "TPopGemeinde", apflora.tblTPop.TPopFlurname AS "TPopFlurname", domPopHerkunft_1.HerkunftTxt AS "TPopStatus", apflora.tblTPop.TPopHerkunftUnklar AS "TPopStatusUnklar", apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "TPopBegruendungFuerUnklarenStatus", apflora.tblTPop.TPopXKoord AS "TPopXKoordinaten", apflora.tblTPop.TPopYKoord AS "TPopYKoordinaten", apflora.tblTPop.TPopRadius AS "TPopRadius", apflora.tblTPop.TPopHoehe AS "TPopHoehe", apflora.tblTPop.TPopExposition AS "TPopExposition", apflora.tblTPop.TPopKlima AS "TPopKlima", apflora.tblTPop.TPopNeigung AS "TPopHangneigung", apflora.tblTPop.TPopBeschr AS "TPopBeschreibung", apflora.tblTPop.TPopKatNr AS "TPopKatasterNr", apflora.tblAdresse.AdrName AS "TPopVerantwortlich", apflora.tblTPop.TPopApBerichtRelevant AS "TPopFuerApBerichtRelevant", apflora.tblTPop.TPopBekanntSeit AS "TPopBekanntSeit", apflora.tblTPop.TPopEigen AS "TPopEigentuemerIn", apflora.tblTPop.TPopKontakt AS "TPopKontaktVorOrt", apflora.tblTPop.TPopNutzungszone AS "TPopNutzungszone", apflora.tblTPop.TPopBewirtschafterIn AS "TPopBewirtschafterIn", apflora.tblTPop.TPopBewirtschaftung AS "TPopBewirtschaftung", apflora.tblTPopMassn.TPopMassnGuid AS "MassnGuid", apflora.tblTPopMassn.TPopMassnJahr AS "MassnJahr", apflora.tblTPopMassn.TPopMassnDatum AS "MassnDatum", domTPopMassnTyp.MassnTypTxt AS "MassnTyp", apflora.tblTPopMassn.TPopMassnTxt AS "MassnMassnahme", apflora.tblAdresse.AdrName AS "MassnBearbeiterIn", apflora.tblTPopMassn.TPopMassnPlan AS "MassnPlanVorhanden", apflora.tblTPopMassn.TPopMassnPlanBez AS "MassnPlanBezeichnung", apflora.tblTPopMassn.TPopMassnFlaeche AS "MassnFlaeche", apflora.tblTPopMassn.TPopMassnAnsiedForm AS "MassnFormDerAnsiedlung", apflora.tblTPopMassn.TPopMassnAnsiedPflanzanordnung AS "MassnPflanzanordnung", apflora.tblTPopMassn.TPopMassnMarkierung AS "MassnMarkierung",  apflora.tblTPopMassn.TPopMassnAnsiedAnzTriebe AS "MassnAnzTriebe", apflora.tblTPopMassn.TPopMassnAnsiedAnzPfl AS "MassnPflanzen", apflora.tblTPopMassn.TPopMassnAnzPflanzstellen AS "MassnAnzPflanzstellen", apflora.tblTPopMassn.TPopMassnAnsiedWirtspfl AS "MassnWirtspflanze", apflora.tblTPopMassn.TPopMassnAnsiedHerkunftPop AS "MassnHerkunftspopulation", apflora.tblTPopMassn.TPopMassnAnsiedDatSamm AS "MassnSammeldatum", apflora.tblTPopMassn.MutWann AS "MassnMutWann", apflora.tblTPopMassn.MutWer AS "MassnMutWer"
FROM ((((((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN ((apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN (apflora.tblTPopMassn LEFT JOIN apflora.domTPopMassnTyp ON apflora.tblTPopMassn.TPopMassnTyp = domTPopMassnTyp.MassnTypCode) ON apflora.tblTPop.TPopId = apflora.tblTPopMassn.TPopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN apflora.domPopHerkunft AS domPopHerkunft_1 ON apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId) LEFT JOIN apflora.tblAdresse ON apflora.tblTPopMassn.TPopMassnBearb = apflora.tblAdresse.AdrId
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr, apflora.tblTPop.TPopNr, apflora.tblTPopMassn.TPopMassnJahr, apflora.tblTPopMassn.TPopMassnDatum, domTPopMassnTyp.MassnTypTxt;

CREATE OR REPLACE VIEW vTPopAnzMassn AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Familie, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "AP Art", apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", apflora.tblAp.ApJahr AS "AP Start im Jahr", apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", apflora.tblPop.PopGuid AS "Pop Guid", apflora.tblPop.PopNr AS "Pop Nr", apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begruendung fuer unklaren Status", apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", apflora.tblTPop.TPopGuid AS "TPop Guid", apflora.tblTPop.TPopNr AS "TPop Nr", apflora.tblTPop.TPopGemeinde AS "TPop Gemeinde", apflora.tblTPop.TPopFlurname AS "TPop Flurname", domPopHerkunft_1.HerkunftTxt AS "TPop Status", apflora.tblTPop.TPopBekanntSeit AS "TPop bekannt seit", apflora.tblTPop.TPopHerkunftUnklar AS "TPop Status unklar", apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "TPop Begruendung fuer unklaren Status", apflora.tblTPop.TPopXKoord AS "TPop X-Koordinaten", apflora.tblTPop.TPopYKoord AS "TPop Y-Koordinaten", apflora.tblTPop.TPopRadius AS "TPop Radius (m)", apflora.tblTPop.TPopHoehe AS "TPop Hoehe", apflora.tblTPop.TPopExposition AS "TPop Exposition", apflora.tblTPop.TPopKlima AS "TPop Klima", apflora.tblTPop.TPopNeigung AS "TPop Hangneigung", apflora.tblTPop.TPopBeschr AS "TPop Beschreibung", apflora.tblTPop.TPopKatNr AS "TPop Kataster-Nr", apflora.tblTPop.TPopApBerichtRelevant AS "TPop fuer AP-Bericht relevant", apflora.tblTPop.TPopEigen AS "TPop EigentuemerIn", apflora.tblTPop.TPopKontakt AS "TPop Kontakt vor Ort", apflora.tblTPop.TPopNutzungszone AS "TPop Nutzungszone", apflora.tblTPop.TPopBewirtschafterIn AS "TPop BewirtschafterIn", apflora.tblTPop.TPopBewirtschaftung AS "TPop Bewirtschaftung", Count(apflora.tblTPopMassn.TPopMassnId) AS "Anzahl Massnahmen"
FROM (((((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN ((apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) LEFT JOIN apflora.tblTPopMassn ON apflora.tblTPop.TPopId = apflora.tblTPopMassn.TPopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN apflora.domPopHerkunft AS domPopHerkunft_1 ON apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId
GROUP BY apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId, apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.domApBearbeitungsstand.DomainTxt, apflora.tblAp.ApJahr, apflora.domApUmsetzung.DomainTxt, apflora.tblPop.PopGuid, apflora.tblPop.PopNr, apflora.tblPop.PopName, domPopHerkunft.HerkunftTxt, apflora.tblPop.PopHerkunftUnklar, apflora.tblPop.PopHerkunftUnklarBegruendung, apflora.tblPop.PopBekanntSeit, apflora.tblPop.PopXKoord, apflora.tblPop.PopYKoord, apflora.tblTPop.TPopGuid, apflora.tblTPop.TPopNr, apflora.tblTPop.TPopGemeinde, apflora.tblTPop.TPopFlurname, domPopHerkunft_1.HerkunftTxt, apflora.tblTPop.TPopHerkunftUnklar, apflora.tblTPop.TPopHerkunftUnklarBegruendung, apflora.tblTPop.TPopXKoord, apflora.tblTPop.TPopYKoord, apflora.tblTPop.TPopRadius, apflora.tblTPop.TPopHoehe, apflora.tblTPop.TPopExposition, apflora.tblTPop.TPopKlima, apflora.tblTPop.TPopNeigung, apflora.tblTPop.TPopBeschr, apflora.tblTPop.TPopKatNr, apflora.tblTPop.TPopApBerichtRelevant, apflora.tblTPop.TPopBekanntSeit, apflora.tblTPop.TPopEigen, apflora.tblTPop.TPopKontakt, apflora.tblTPop.TPopNutzungszone, apflora.tblTPop.TPopBewirtschafterIn, apflora.tblTPop.TPopBewirtschaftung
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr, apflora.tblTPop.TPopNr;

CREATE OR REPLACE VIEW vPopAnzMassn AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "AP Art", apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", apflora.tblAp.ApJahr AS "AP Start im Jahr", apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", apflora.tblPop.PopGuid AS "Pop Guid", apflora.tblPop.PopNr AS "Pop Nr", apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begruendung fuer unklaren Status", apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", Count(apflora.tblTPopMassn.TPopMassnId) AS "Anzahl Massnahmen"
FROM ((((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN ((apflora.tblPop LEFT JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) LEFT JOIN apflora.tblTPopMassn ON apflora.tblTPop.TPopId = apflora.tblTPopMassn.TPopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId
GROUP BY apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId, apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.domApBearbeitungsstand.DomainTxt, apflora.tblAp.ApJahr, apflora.domApUmsetzung.DomainTxt, apflora.tblPop.PopGuid, apflora.tblPop.PopNr, apflora.tblPop.PopName, domPopHerkunft.HerkunftTxt, apflora.tblPop.PopHerkunftUnklar, apflora.tblPop.PopHerkunftUnklarBegruendung, apflora.tblPop.PopBekanntSeit, apflora.tblPop.PopXKoord, apflora.tblPop.PopYKoord
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr;

CREATE OR REPLACE VIEW vPopAnzKontr AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "AP Art", apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", apflora.tblAp.ApJahr AS "AP Start im Jahr", apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", apflora.tblPop.PopGuid AS "Pop Guid", apflora.tblPop.PopNr AS "Pop Nr", apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begruendung fuer unklaren Status", apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", Count(apflora.tblTPopKontr.TPopKontrId) AS "Anzahl Kontrollen"
FROM ((((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN ((apflora.tblPop LEFT JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) LEFT JOIN apflora.tblTPopKontr ON apflora.tblTPop.TPopId = apflora.tblTPopKontr.TPopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId
GROUP BY apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId, apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.domApBearbeitungsstand.DomainTxt, apflora.tblAp.ApJahr, apflora.domApUmsetzung.DomainTxt, apflora.tblPop.PopGuid, apflora.tblPop.PopNr, apflora.tblPop.PopName, domPopHerkunft.HerkunftTxt, apflora.tblPop.PopHerkunftUnklar, apflora.tblPop.PopHerkunftUnklarBegruendung, apflora.tblPop.PopBekanntSeit, apflora.tblPop.PopXKoord, apflora.tblPop.PopYKoord
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr;

CREATE OR REPLACE VIEW vApAnzMassn AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "AP Art", apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", apflora.tblAp.ApJahr AS "AP Start im Jahr", apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", Count(apflora.tblTPopMassn.TPopMassnId) AS "Anzahl Massnahmen"
FROM (((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) LEFT JOIN ((apflora.tblPop LEFT JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) LEFT JOIN apflora.tblTPopMassn ON apflora.tblTPop.TPopId = apflora.tblTPopMassn.TPopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode
GROUP BY apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId, apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.domApBearbeitungsstand.DomainTxt, apflora.tblAp.ApJahr, apflora.domApUmsetzung.DomainTxt
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vApAnzKontr AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "AP Art", apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", apflora.tblAp.ApJahr AS "AP Start im Jahr", apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", Count(apflora.tblTPopKontr.TPopKontrId) AS "Anzahl Kontrollen"
FROM (((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) LEFT JOIN ((apflora.tblPop LEFT JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) LEFT JOIN apflora.tblTPopKontr ON apflora.tblTPop.TPopId = apflora.tblTPopKontr.TPopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode
GROUP BY apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId, apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.domApBearbeitungsstand.DomainTxt, apflora.tblAp.ApJahr, apflora.domApUmsetzung.DomainTxt
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vPop AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "AP Art", apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", apflora.tblAp.ApJahr AS "AP Start im Jahr", apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", apflora.tblPop.PopId, apflora.tblPop.PopGuid AS "Pop Guid", apflora.tblPop.PopNr AS "Pop Nr", apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begruendung fuer unklaren Status", apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", apflora.tblPop.MutWann AS "Datensatz zuletzt geaendert", apflora.tblPop.MutWer AS "Datensatz zuletzt geaendert von"
FROM ((((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN apflora.tblPop ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr;

CREATE OR REPLACE VIEW vPopOhneKoord AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "AP Art", apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", apflora.tblAp.ApJahr AS "AP Start im Jahr", apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", apflora.tblPop.PopId, apflora.tblPop.PopGuid AS "Pop Guid", apflora.tblPop.PopNr AS "Pop Nr", apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begruendung fuer unklaren Status", apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", apflora.tblPop.MutWann AS "Datensatz zuletzt geaendert", apflora.tblPop.MutWer AS "Datensatz zuletzt geaendert von"
FROM ((((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN apflora.tblPop ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId
WHERE apflora.tblPop.PopXKoord IS NULL OR apflora.tblPop.PopYKoord IS NULL 
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr;

CREATE OR REPLACE VIEW vPopFuerGis AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "AP Art", apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", apflora.tblAp.ApJahr AS "AP Start im Jahr", apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", apflora.tblPop.PopGuid AS "Pop Guid", apflora.tblPop.PopNr AS "Pop Nr", apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begruendung fuer unklaren Status", apflora.tblPop.PopXKoord AS "XKoordinaten", apflora.tblPop.PopYKoord AS "YKoordinaten", apflora.tblPop.MutWann AS "Datensatz zuletzt geaendert", apflora.tblPop.MutWer AS "Datensatz zuletzt geaendert von"
FROM ((((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN apflora.tblPop ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId
WHERE apflora.tblPop.PopXKoord > 0 AND apflora.tblPop.PopYKoord > 0
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr;

#im Gebrauch (Access):
CREATE OR REPLACE VIEW vPopOhneAp AS
SELECT apflora.tblPop.PopGuid AS "Pop Guid", apflora.tblPop.PopNr AS "Pop Nr", apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begruendung fuer unklaren Status", apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", apflora.tblPop.MutWann AS "Datensatz zuletzt geaendert", apflora.tblPop.MutWer AS "Datensatz zuletzt geaendert von", apflora.tblAp.ApArtId
FROM (apflora.tblAp RIGHT JOIN apflora.tblPop ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId
WHERE apflora.tblAp.ApArtId Is Null
ORDER BY apflora.tblPop.PopName, apflora.tblPop.PopNr;

CREATE OR REPLACE VIEW vPopOhneTPop AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "AP Art", apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", apflora.tblAp.ApJahr AS "AP Start im Jahr", apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", apflora.tblPop.PopGuid AS "Pop Guid", apflora.tblPop.PopNr AS "Pop Nr", apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begruendung fuer unklaren Status", apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", apflora.tblPop.MutWann AS "Datensatz zuletzt geaendert", apflora.tblPop.MutWer AS "Datensatz zuletzt geaendert von"
FROM (((((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN apflora.tblPop ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE apflora.tblTPop.TPopId Is Null
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr;

CREATE OR REPLACE VIEW vPopBer AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "AP Art", apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", apflora.tblAp.ApJahr AS "AP Start im Jahr", apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", apflora.tblPop.PopGuid AS "Pop Guid", apflora.tblPop.PopNr AS "Pop Nr", apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begruendung fuer unklaren Status", apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", apflora.tblPopBer.PopBerId AS "PopBer Id", apflora.tblPopBer.PopBerJahr AS "PopBer Jahr", domPopEntwicklung.EntwicklungTxt AS "PopBer Entwicklung", apflora.tblPopBer.PopBerTxt AS "PopBer Bemerkungen", apflora.tblPopBer.MutWann AS "PopBer MutWann", apflora.tblPopBer.MutWer AS "PopBer MutWer"
FROM ((((((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN apflora.tblPop ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) INNER JOIN apflora.tblPopBer ON apflora.tblPop.PopId = apflora.tblPopBer.PopId) LEFT JOIN apflora.domPopEntwicklung ON apflora.tblPopBer.PopBerEntwicklung = domPopEntwicklung.EntwicklungId
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr, apflora.tblPopBer.PopBerJahr, domPopEntwicklung.EntwicklungTxt;

#im Gebrauch (Access):
CREATE OR REPLACE VIEW vPopBerOhnePop AS
SELECT apflora.tblPopBer.PopBerId AS "PopBer Id", apflora.tblPopBer.PopId AS "PopBer PopId", apflora.tblPopBer.PopBerJahr AS "PopBer Jahr", domPopEntwicklung.EntwicklungTxt AS "PopBer Entwicklung", apflora.tblPopBer.PopBerTxt AS "PopBer Bemerkungen", apflora.tblPopBer.MutWann AS "PopBer MutWann", apflora.tblPopBer.MutWer AS "PopBer MutWer"
FROM (apflora.tblPop RIGHT JOIN apflora.tblPopBer ON apflora.tblPop.PopId = apflora.tblPopBer.PopId) LEFT JOIN apflora.domPopEntwicklung ON apflora.tblPopBer.PopBerEntwicklung = domPopEntwicklung.EntwicklungId
WHERE apflora.tblPop.PopId Is Null
ORDER BY apflora.tblPopBer.PopBerJahr, domPopEntwicklung.EntwicklungTxt;

CREATE OR REPLACE VIEW vPopMassnBer AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId AS "AP ApArtId", apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "AP Art", apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", apflora.tblAp.ApJahr AS "AP Start im Jahr", apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", apflora.tblPop.PopGuid AS "Pop Guid", apflora.tblPop.PopNr AS "Pop Nr", apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begruendung fuer unklaren Status", apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", apflora.tblPop.MutWann AS "Datensatz zuletzt geaendert", apflora.tblPop.MutWer AS "Datensatz zuletzt geaendert von", apflora.tblPopMassnBer.PopMassnBerId AS "PopMassnBer Id", apflora.tblPopMassnBer.PopMassnBerJahr AS "PopMassnBer Jahr", domTPopMassnErfolgsbeurteilung.BeurteilTxt AS "PopMassnBer Entwicklung", apflora.tblPopMassnBer.PopMassnBerTxt AS "PopMassnBer Interpretation", apflora.tblPopMassnBer.MutWann AS "PopMassnBer MutWann", apflora.tblPopMassnBer.MutWer AS "PopMassnBer MutWer"
FROM ((((((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN apflora.tblPop ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) INNER JOIN apflora.tblPopMassnBer ON apflora.tblPop.PopId = apflora.tblPopMassnBer.PopId) LEFT JOIN apflora.domTPopMassnErfolgsbeurteilung ON apflora.tblPopMassnBer.PopMassnBerErfolgsbeurteilung = domTPopMassnErfolgsbeurteilung.BeurteilId
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr;

#im Gebrauch (Access):
CREATE OR REPLACE VIEW vPopMassnBerOhnePop AS
SELECT apflora.tblPopMassnBer.PopMassnBerId AS "PopMassnBer Id", apflora.tblPopMassnBer.PopId AS "PopMassnBer PopId", apflora.tblPopMassnBer.PopMassnBerJahr AS "PopMassnBer Jahr", domTPopMassnErfolgsbeurteilung.BeurteilTxt AS "PopMassnBer Entwicklung", apflora.tblPopMassnBer.PopMassnBerTxt AS "PopMassnBer Interpretation", apflora.tblPopMassnBer.MutWann AS "PopMassnBer MutWann", apflora.tblPopMassnBer.MutWer AS "PopMassnBer MutWer"
FROM (apflora.tblPop RIGHT JOIN apflora.tblPopMassnBer ON apflora.tblPop.PopId = apflora.tblPopMassnBer.PopId) LEFT JOIN apflora.domTPopMassnErfolgsbeurteilung ON apflora.tblPopMassnBer.PopMassnBerErfolgsbeurteilung = domTPopMassnErfolgsbeurteilung.BeurteilId
WHERE apflora.tblPop.PopId Is Null
ORDER BY apflora.tblPopMassnBer.PopMassnBerJahr, domTPopMassnErfolgsbeurteilung.BeurteilTxt;

CREATE OR REPLACE VIEW vTPop AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Familie, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "AP Art", apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", apflora.tblAp.ApJahr AS "AP Start im Jahr", apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", apflora.tblPop.PopGuid AS "Pop Guid", apflora.tblPop.PopNr AS "Pop Nr", apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begruendung fuer unklaren Status", apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", apflora.tblTPop.TPopId AS "TPop ID", apflora.tblTPop.TPopGuid AS "TPop Guid", apflora.tblTPop.TPopNr AS "TPop Nr", apflora.tblTPop.TPopGemeinde AS "TPop Gemeinde", apflora.tblTPop.TPopFlurname AS "TPop Flurname", domPopHerkunft_1.HerkunftTxt AS "TPop Status", apflora.tblTPop.TPopBekanntSeit AS "TPop bekannt seit", apflora.tblTPop.TPopHerkunftUnklar AS "TPop Status unklar", apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "TPop Begruendung fuer unklaren Status", apflora.tblTPop.TPopXKoord AS "TPop X-Koordinaten", apflora.tblTPop.TPopYKoord AS "TPop Y-Koordinaten", apflora.tblTPop.TPopRadius AS "TPop Radius (m)", apflora.tblTPop.TPopHoehe AS "TPop Hoehe", apflora.tblTPop.TPopExposition AS "TPop Exposition", apflora.tblTPop.TPopKlima AS "TPop Klima", apflora.tblTPop.TPopNeigung AS "TPop Hangneigung", apflora.tblTPop.TPopBeschr AS "TPop Beschreibung", apflora.tblTPop.TPopKatNr AS "TPop Kataster-Nr", apflora.tblTPop.TPopApBerichtRelevant AS "TPop fuer AP-Bericht relevant", apflora.tblTPop.TPopEigen AS "TPop EigentuemerIn", apflora.tblTPop.TPopKontakt AS "TPop Kontakt vor Ort", apflora.tblTPop.TPopNutzungszone AS "TPop Nutzungszone", apflora.tblTPop.TPopBewirtschafterIn AS "TPop BewirtschafterIn", apflora.tblTPop.TPopBewirtschaftung AS "TPop Bewirtschaftung", apflora.tblTPop.MutWann AS "Teilpopulation zuletzt geaendert", apflora.tblTPop.MutWer AS "Teilpopulation zuletzt geaendert von"
FROM (((((apfloraBeob.ArtenDb_Arteigenschaften RIGHT JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) RIGHT JOIN (apflora.tblPop RIGHT JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN apflora.domPopHerkunft AS domPopHerkunft_1 ON apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId
WHERE apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId NOT IN (100, 150)
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr, apflora.tblTPop.TPopNr;

CREATE OR REPLACE VIEW vTPopFuerGis AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "AP Art", apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", apflora.tblAp.ApJahr AS "AP Start im Jahr", apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", apflora.tblPop.PopGuid AS "Pop Guid", apflora.tblPop.PopNr AS "Pop Nr", apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begruendung fuer unklaren Status", apflora.tblTPop.TPopGuid AS "TPop Guid", apflora.tblTPop.TPopNr AS "TPop Nr", apflora.tblTPop.TPopGemeinde AS "TPop Gemeinde", apflora.tblTPop.TPopFlurname AS "TPop Flurname", domPopHerkunft_1.HerkunftTxt AS "TPop Status", apflora.tblTPop.TPopBekanntSeit AS "TPop bekannt seit", apflora.tblTPop.TPopHerkunftUnklar AS "TPop Status unklar", apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "TPop Begruendung fuer unklaren Status", apflora.tblTPop.TPopXKoord AS "TPopXKoordinaten", apflora.tblTPop.TPopYKoord AS "TPopYKoordinaten", apflora.tblTPop.TPopRadius AS "TPop Radius (m)", apflora.tblTPop.TPopHoehe AS "TPop Hoehe", apflora.tblTPop.TPopExposition AS "TPop Exposition", apflora.tblTPop.TPopKlima AS "TPop Klima", apflora.tblTPop.TPopNeigung AS "TPop Hangneigung", apflora.tblTPop.TPopBeschr AS "TPop Beschreibung", apflora.tblTPop.TPopKatNr AS "TPop Kataster-Nr", apflora.tblTPop.TPopApBerichtRelevant AS "TPop fuer AP-Bericht relevant", apflora.tblTPop.TPopEigen AS "TPop EigentuemerIn", apflora.tblTPop.TPopKontakt AS "TPop Kontakt vor Ort", apflora.tblTPop.TPopNutzungszone AS "TPop Nutzungszone", apflora.tblTPop.TPopBewirtschafterIn AS "TPop BewirtschafterIn", apflora.tblTPop.TPopBewirtschaftung AS "TPop Bewirtschaftung", apflora.tblTPop.MutWann AS "Datensatz zuletzt geaendert", apflora.tblTPop.MutWann AS "Datensatz zuletzt geaendert von"
FROM (((((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN (apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN apflora.domPopHerkunft AS domPopHerkunft_1 ON apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId
WHERE apflora.tblTPop.TPopYKoord > 0 AND apflora.tblTPop.TPopXKoord > 0
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr, apflora.tblTPop.TPopNr;

#im Gebrauch durch exportPopVonApOhneStatus.php:
CREATE OR REPLACE VIEW vPopVonApOhneStatus AS 
SELECT apfloraBeob.ArtenDb_Arteigenschaften.Artname AS Art, apflora.tblAp.ApStatus AS "Bearbeitungsstand AP", apflora.tblPop.PopNr, apflora.tblPop.PopName, apflora.tblPop.PopHerkunft AS Status
FROM apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN (apflora.tblAp INNER JOIN apflora.tblPop ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId
WHERE ((apflora.tblAp.ApStatus=3) AND (apflora.tblPop.PopHerkunft Is Null))
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr;

CREATE OR REPLACE VIEW vBerJbZielBer AS 
SELECT apflora.tblZielBer.*
FROM apflora.tblZielBer INNER JOIN apflora.tblKonstanten ON apflora.tblZielBer.ZielBerJahr = apflora.tblKonstanten.JBerJahr;

CREATE OR REPLACE VIEW vBerJbZiel AS
SELECT apflora.tblZiel.*, domZielTyp.ZieltypTxt
FROM apflora.tblKonstanten INNER JOIN (apflora.tblZiel INNER JOIN apflora.domZielTyp ON apflora.tblZiel.ZielTyp = domZielTyp.ZieltypId) ON apflora.tblKonstanten.JBerJahr = apflora.tblZiel.ZielJahr
WHERE (apflora.tblZiel.ZielTyp=1 Or apflora.tblZiel.ZielTyp=2) OR (apflora.tblZiel.ZielTyp=1170775556)
ORDER BY apflora.tblZiel.ZielTyp, apflora.tblZiel.ZielBezeichnung;

CREATE OR REPLACE VIEW vJBerOhneAp AS
SELECT apflora.tblJBer.JBerId AS "JBer Id", apflora.tblJBer.ApArtId AS "JBer ApArtId", apflora.tblJBer.JBerJahr AS "JBer Jahr", apflora.tblJBer.JBerSituation AS "JBer Situation", apflora.tblJBer.JBerVergleichVorjahrGesamtziel AS "JBer Vergleich Vorjahr-Gesamtziel", domApErfKrit.BeurteilTxt AS "JBer Beurteilung", apflora.tblJBer.JBerVeraenGegenVorjahr AS "JBer Veraend zum Vorjahr", apflora.tblJBer.JBerAnalyse AS "JBer Analyse", apflora.tblJBer.JBerUmsetzung AS "JBer Konsequenzen Umsetzung", apflora.tblJBer.JBerErfko AS "JBer Konsequenzen Erfolgskontrolle", apflora.tblJBer.JBerATxt AS "JBer Bemerkungen zu A", apflora.tblJBer.JBerBTxt AS "JBer Bemerkungen zu B", apflora.tblJBer.JBerCTxt AS "JBer Bemerkungen zu C", apflora.tblJBer.JBerDTxt AS "JBer Bemerkungen zu D", apflora.tblJBer.JBerDatum AS "JBer Datum", apflora.tblAdresse.AdrName AS "JBer BearbeiterIn", apflora.tblJBer.MutWann AS "JBer MutWann", apflora.tblJBer.MutWer AS "JBer MutWer"
FROM ((apflora.tblAp RIGHT JOIN apflora.tblJBer ON apflora.tblAp.ApArtId = apflora.tblJBer.ApArtId) LEFT JOIN apflora.tblAdresse ON apflora.tblJBer.JBerBearb = apflora.tblAdresse.AdrId) LEFT JOIN apflora.domApErfKrit ON apflora.tblJBer.JBerBeurteilung = domApErfKrit.BeurteilId
WHERE apflora.tblAp.ApArtId Is Null
ORDER BY apflora.tblJBer.ApArtId, apflora.tblJBer.JBerJahr, apflora.tblJBer.JBerDatum;

CREATE OR REPLACE VIEW vBerJbArtD AS 
SELECT apflora.tblAp.*, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS Art, apflora.tblJBer.JBerId, apflora.tblJBer.JBerJahr, apflora.tblJBer.JBerSituation, apflora.tblJBer.JBerVergleichVorjahrGesamtziel, apflora.tblJBer.JBerBeurteilung, apflora.tblJBer.JBerAnalyse, apflora.tblJBer.JBerUmsetzung, apflora.tblJBer.JBerErfko, apflora.tblJBer.JBerATxt, apflora.tblJBer.JBerBTxt, apflora.tblJBer.JBerCTxt, apflora.tblJBer.JBerDTxt, apflora.tblJBer.JBerDatum, apflora.tblJBer.JBerBearb, apflora.tblAdresse.AdrName AS Bearbeiter, domApErfKrit.BeurteilTxt
FROM (apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId=apflora.tblAp.ApArtId) INNER JOIN (((apflora.tblJBer LEFT JOIN apflora.tblAdresse ON apflora.tblJBer.JBerBearb=apflora.tblAdresse.AdrId) LEFT JOIN apflora.domApErfKrit ON apflora.tblJBer.JBerBeurteilung=apflora.domApErfKrit.BeurteilId) INNER JOIN apflora.tblKonstanten ON apflora.tblJBer.JBerJahr=apflora.tblKonstanten.JBerJahr) ON apflora.tblAp.ApArtId=apflora.tblJBer.ApArtId;

CREATE OR REPLACE VIEW vFnsKef AS 
SELECT apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId, IF(apfloraBeob.ArtenDb_Arteigenschaften.KefArt="-1","Ja","") AS FnsKefArt2, IF(Round((apflora.tblKonstanten.JBerJahr- apfloraBeob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,0)=(apflora.tblKonstanten.JBerJahr-apfloraBeob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,"Ja","") AS FnsKefKontrJahr2
FROM apfloraBeob.ArtenDb_Arteigenschaften, apflora.tblKonstanten
ORDER BY  apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId;

CREATE OR REPLACE VIEW vPopMassnSeitBeginnAp AS 
SELECT apflora.tblTPopMassn.TPopId
FROM apflora.tblAp INNER JOIN ((apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN apflora.tblTPopMassn ON apflora.tblTPop.TPopId = apflora.tblTPopMassn.TPopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId
WHERE (((apflora.tblTPopMassn.TPopMassnJahr)>=apflora.tblAp.ApJahr))
GROUP BY apflora.tblTPopMassn.TPopId;

CREATE OR REPLACE VIEW vApJahresberichte AS 
select apflora.tblAp.ApArtId AS ApArtId, apflora.tblJBer.JBerId AS JBerId, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS Name, apflora.tblJBer.JBerJahr AS JBerJahr, apflora.tblJBer.JBerSituation AS JBerSituation, apflora.tblJBer.JBerVergleichVorjahrGesamtziel AS JBerVergleichVorjahrGesamtziel, domApErfKrit.BeurteilTxt AS JBerBeurteilung, apflora.tblJBer.JBerVeraenGegenVorjahr AS JBerVeraenGegenVorjahr, apflora.tblJBer.JBerAnalyse AS JBerAnalyse, apflora.tblJBer.JBerUmsetzung AS JBerUmsetzung, apflora.tblJBer.JBerErfko AS JBerErfko, apflora.tblJBer.JBerATxt AS JBerATxt, apflora.tblJBer.JBerBTxt AS JBerBTxt, apflora.tblJBer.JBerCTxt AS JBerCTxt, apflora.tblJBer.JBerDTxt AS JBerDTxt, apflora.tblJBer.JBerDatum AS JBerDatum,apflora.tblAdresse.AdrName AS JBerBearb 
FROM apflora.tblAp INNER JOIN apfloraBeob.ArtenDb_Arteigenschaften ON (apflora.tblAp.ApArtId=apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId) JOIN ((apflora.tblJBer LEFT JOIN apflora.domApErfKrit ON (apflora.tblJBer.JBerBeurteilung=domApErfKrit.BeurteilId)) LEFT JOIN apflora.tblAdresse ON (apflora.tblJBer.JBerBearb=apflora.tblAdresse.AdrId)) ON apflora.tblAp.ApArtId=apflora.tblJBer.ApArtId
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vLetzterTPopMassnBericht0 AS 
SELECT apflora.tblPop.ApArtId, apflora.tblTPop.TPopId, apflora.tblTPopMassnBer.TPopMassnBerJahr
FROM apflora.tblKonstanten, ((apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN apflora.tblTPopMassnBer ON apflora.tblTPop.TPopId = apflora.tblTPopMassnBer.TPopId) INNER JOIN apflora.tblTPopMassn ON apflora.tblTPop.TPopId = apflora.tblTPopMassn.TPopId
WHERE apflora.tblTPopMassnBer.TPopMassnBerJahr<=apflora.tblKonstanten.JBerJahr AND apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblTPopMassn.TPopMassnJahr<=apflora.tblKonstanten.JBerJahr AND apflora.tblPop.PopHerkunft <> 300;

CREATE OR REPLACE VIEW vLetzterTPopBericht0 AS
SELECT apflora.tblPop.ApArtId, apflora.tblTPop.TPopId, apflora.tblTPopBer.TPopBerJahr
FROM apflora.tblKonstanten, apflora.tblAp INNER JOIN (apflora.tblPop INNER JOIN (apflora.tblTPop INNER JOIN apflora.tblTPopBer ON apflora.tblTPop.TPopId = apflora.tblTPopBer.TPopId) ON apflora.tblPop.PopId = apflora.tblTPop.PopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId
WHERE apflora.tblTPopBer.TPopBerJahr<=apflora.tblKonstanten.JBerJahr And apflora.tblTPopBer.TPopBerJahr>=apflora.tblAp.ApJahr AND apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300;

CREATE OR REPLACE VIEW vLetzterPopMassnBericht0 AS 
SELECT apflora.tblPop.ApArtId, apflora.tblPop.PopId, apflora.tblPopMassnBer.PopMassnBerJahr
FROM apflora.tblKonstanten, ((apflora.tblPop INNER JOIN apflora.tblPopMassnBer ON apflora.tblPop.PopId = apflora.tblPopMassnBer.PopId) INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN apflora.tblTPopMassn ON apflora.tblTPop.TPopId = apflora.tblTPopMassn.TPopId
WHERE apflora.tblPopMassnBer.PopMassnBerJahr<=apflora.tblKonstanten.JBerJahr AND apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblTPopMassn.TPopMassnJahr<=apflora.tblKonstanten.JBerJahr AND apflora.tblPop.PopHerkunft <> 300;

CREATE OR REPLACE VIEW vLetzterPopBericht0 AS
SELECT apflora.tblPop.ApArtId, apflora.tblPop.PopId, apflora.tblPopBer.PopBerJahr
FROM apflora.tblKonstanten, (apflora.tblPop INNER JOIN apflora.tblPopBer ON apflora.tblPop.PopId = apflora.tblPopBer.PopId) INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE apflora.tblPopBer.PopBerJahr<=apflora.tblKonstanten.JBerJahr AND apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300;

CREATE OR REPLACE VIEW vKontrApArtTPopOhneStatus AS 
SELECT apfloraBeob.ArtenDb_Arteigenschaften.Artname AS Art, apflora.domApBearbeitungsstand.DomainTxt AS "Bearbeitungsstand AP", apflora.tblPop.PopNr, apflora.tblPop.PopName, domPopHerkunft.HerkunftTxt AS "Status Population", apflora.tblTPop.TPopNr, apflora.tblTPop.TPopFlurname, apflora.tblTPop.TPopHerkunft AS "Status Teilpopulation"
FROM (apflora.domApBearbeitungsstand INNER JOIN (apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) ON apflora.domApBearbeitungsstand.DomainCode = apflora.tblAp.ApStatus) INNER JOIN ((apflora.tblPop INNER JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId
WHERE apflora.tblTPop.TPopHerkunft Is Null AND apflora.tblAp.ApStatus=3
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr;

CREATE OR REPLACE VIEW vTPopOhneBekanntSeit AS 
SELECT apfloraBeob.ArtenDb_Arteigenschaften.Artname AS Art, apflora.domApBearbeitungsstand.DomainTxt AS ApStatus_, apflora.tblPop.PopNr, apflora.tblPop.PopName, apflora.tblTPop.TPopNr, apflora.tblTPop.TPopGemeinde, apflora.tblTPop.TPopFlurname, apflora.tblTPop.TPopBekanntSeit
FROM ((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) INNER JOIN (apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId
WHERE apflora.tblTPop.TPopBekanntSeit Is Null AND apflora.tblAp.ApStatus Between 1 And 3
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr, apflora.tblPop.PopName, apflora.tblTPop.TPopNr, apflora.tblTPop.TPopGemeinde, apflora.tblTPop.TPopFlurname;

CREATE OR REPLACE VIEW vKontrTPopKoorLeer AS 
SELECT apfloraBeob.ArtenDb_Arteigenschaften.Artname AS Art, apflora.domApBearbeitungsstand.DomainTxt AS ApStatus_, apflora.tblPop.PopNr, apflora.tblPop.PopName, apflora.tblTPop.TPopNr, apflora.tblTPop.TPopGemeinde, apflora.tblTPop.TPopFlurname, apflora.tblTPop.TPopXKoord, apflora.tblTPop.TPopYKoord
FROM ((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) INNER JOIN (apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId
WHERE (apflora.tblTPop.TPopXKoord Is Null AND apflora.tblAp.ApStatus Between 1 And 3) OR (apflora.tblTPop.TPopYKoord Is Null AND apflora.tblAp.ApStatus Between 1 And 3)
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr, apflora.tblPop.PopName, apflora.tblTPop.TPopNr, apflora.tblTPop.TPopGemeinde, apflora.tblTPop.TPopFlurname;

CREATE OR REPLACE VIEW vTPopBerLetzterBericht AS 
SELECT apflora.tblTPopBer.TPopId, Max(apflora.tblTPopBer.TPopBerJahr) AS MaxvonTPopBerJahr
FROM apflora.tblTPopBer
GROUP BY apflora.tblTPopBer.TPopId;

CREATE OR REPLACE VIEW vAuswAp AS 
SELECT apflora.tblAp.ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS Art, apflora.domApBearbeitungsstand.DomainTxt AS "Bearbeitungsstand AP", apflora.tblAp.ApJahr AS "Start AP im Jahr", apflora.domApUmsetzung.DomainTxt AS "Stand Umsetzung AP", apflora.tblAdresse.AdrName AS "Verantwortlich", apflora.tblAp.MutWann AS "Letzte Aenderung", apflora.tblAp.MutWer AS "Letzte(r) Bearbeiter(in)"
FROM (((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.tblAdresse ON apflora.tblAp.ApBearb = apflora.tblAdresse.AdrId
WHERE (((apflora.tblAp.ApStatus) Between 1 And 3))
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vProgramme AS 
SELECT apflora.tblAp.ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "AP Art", apflora.domApBearbeitungsstand.DomainTxt AS "AP Bearbeitungsstand", apflora.tblAp.ApJahr AS "AP Start im Jahr", apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", apflora.tblAdresse.AdrName AS "AP verantwortlich", apflora.tblAp.MutWann AS "AP Letzte Aenderung", apflora.tblAp.MutWer AS "AP Letzte(r) Bearbeiter(in)"
FROM (((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.tblAdresse ON apflora.tblAp.ApBearb = apflora.tblAdresse.AdrId
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vIdealbiotop AS 
SELECT apflora.tblAp.ApArtId AS "AP ApArtId", apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "AP Art", apflora.domApBearbeitungsstand.DomainTxt AS "AP Bearbeitungsstand", apflora.tblAp.ApJahr AS "AP Start im Jahr", apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", apflora.tblAdresse.AdrName AS "AP verantwortlich", apflora.tblAp.MutWann AS "AP Letzte Aenderung", apflora.tblAp.MutWer AS "AP Letzte(r) Bearbeiter(in)", apflora.tblIdealbiotop.IbApArtId AS "Ib ApArtId", apflora.tblIdealbiotop.IbErstelldatum AS "Ib Erstelldatum", apflora.tblIdealbiotop.IbHoehenlage AS "Ib Hoehenlage", apflora.tblIdealbiotop.IbRegion AS "Ib Region", apflora.tblIdealbiotop.IbExposition AS "Ib Exposition", apflora.tblIdealbiotop.IbBesonnung AS "Ib Besonnung", apflora.tblIdealbiotop.IbHangneigung AS "Ib Hangneigung", apflora.tblIdealbiotop.IbBodenTyp AS "Ib Bodentyp", apflora.tblIdealbiotop.IbBodenKalkgehalt AS "Ib Boden Kalkgehalt", apflora.tblIdealbiotop.IbBodenDurchlaessigkeit AS "Ib Boden Durchlaessigkeit", apflora.tblIdealbiotop.IbBodenHumus AS "Ib Boden Humus", apflora.tblIdealbiotop.IbBodenNaehrstoffgehalt AS "Ib Boden Naehrstoffgehalt", apflora.tblIdealbiotop.IbWasserhaushalt AS "Ib Wasserhaushalt", apflora.tblIdealbiotop.IbKonkurrenz AS "Ib Konkurrenz", apflora.tblIdealbiotop.IbMoosschicht AS "Ib Moosschicht", apflora.tblIdealbiotop.IbKrautschicht AS "Ib Krautschicht", apflora.tblIdealbiotop.IbStrauchschicht AS "Ib Strauchschicht", apflora.tblIdealbiotop.IbBaumschicht AS "Ib Baumschicht", apflora.tblIdealbiotop.IbBemerkungen AS "Ib Bemerkungen", apflora.tblIdealbiotop.MutWann AS "Ib MutWann", apflora.tblIdealbiotop.MutWer AS "Ib MutWer"
FROM apflora.tblIdealbiotop LEFT JOIN ((((apfloraBeob.ArtenDb_Arteigenschaften RIGHT JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.tblAdresse ON apflora.tblAp.ApBearb = apflora.tblAdresse.AdrId) ON apflora.tblIdealbiotop.IbApArtId = apflora.tblAp.ApArtId
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblIdealbiotop.IbErstelldatum;

CREATE OR REPLACE VIEW vIdealbiotopOhneAp AS 
SELECT apflora.tblAp.ApArtId AS "AP ApArtId", apflora.tblIdealbiotop.IbApArtId AS "Ib ApArtId", apflora.tblIdealbiotop.IbErstelldatum AS "Ib Erstelldatum", apflora.tblIdealbiotop.IbHoehenlage AS "Ib Hoehenlage", apflora.tblIdealbiotop.IbRegion AS "Ib Region", apflora.tblIdealbiotop.IbExposition AS "Ib Exposition", apflora.tblIdealbiotop.IbBesonnung AS "Ib Besonnung", apflora.tblIdealbiotop.IbHangneigung AS "Ib Hangneigung", apflora.tblIdealbiotop.IbBodenTyp AS "Ib Bodentyp", apflora.tblIdealbiotop.IbBodenKalkgehalt AS "Ib Boden Kalkgehalt", apflora.tblIdealbiotop.IbBodenDurchlaessigkeit AS "Ib Boden Durchlaessigkeit", apflora.tblIdealbiotop.IbBodenHumus AS "Ib Boden Humus", apflora.tblIdealbiotop.IbBodenNaehrstoffgehalt AS "Ib Boden Naehrstoffgehalt", apflora.tblIdealbiotop.IbWasserhaushalt AS "Ib Wasserhaushalt", apflora.tblIdealbiotop.IbKonkurrenz AS "Ib Konkurrenz", apflora.tblIdealbiotop.IbMoosschicht AS "Ib Moosschicht", apflora.tblIdealbiotop.IbKrautschicht AS "Ib Krautschicht", apflora.tblIdealbiotop.IbStrauchschicht AS "Ib Strauchschicht", apflora.tblIdealbiotop.IbBaumschicht AS "Ib Baumschicht", apflora.tblIdealbiotop.IbBemerkungen AS "Ib Bemerkungen", apflora.tblIdealbiotop.MutWann AS "Ib MutWann", apflora.tblIdealbiotop.MutWer AS "Ib MutWer"
FROM apflora.tblIdealbiotop LEFT JOIN ((((apfloraBeob.ArtenDb_Arteigenschaften RIGHT JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.tblAdresse ON apflora.tblAp.ApBearb = apflora.tblAdresse.AdrId) ON apflora.tblIdealbiotop.IbApArtId = apflora.tblAp.ApArtId
WHERE apflora.tblAp.ApArtId is Null
ORDER BY apflora.tblIdealbiotop.IbErstelldatum;

CREATE OR REPLACE VIEW vBer AS
SELECT apflora.tblAp.ApArtId AS "AP Id", apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "AP Art", apflora.domApBearbeitungsstand.DomainTxt AS "AP Bearbeitungsstand", apflora.tblAp.ApJahr AS "AP Start im Jahr", apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", apflora.tblAdresse.AdrName AS "AP verantwortlich", apflora.tblBer.BerId AS "Ber Id", apflora.tblBer.ApArtId AS "Ber ApId", apflora.tblBer.BerAutor AS "Ber Autor", apflora.tblBer.BerJahr AS "Ber Jahr", apflora.tblBer.BerTitel AS "Ber Titel", apflora.tblBer.BerURL AS "Ber URL", apflora.tblBer.MutWann AS "Ber MutWann", apflora.tblBer.MutWer AS "Ber MutWer"
FROM ((((apfloraBeob.ArtenDb_Arteigenschaften RIGHT JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.tblAdresse ON apflora.tblAp.ApBearb = apflora.tblAdresse.AdrId) RIGHT JOIN apflora.tblBer ON apflora.tblAp.ApArtId = apflora.tblBer.ApArtId
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vBerOhneAp AS
SELECT apflora.tblAp.ApArtId AS "AP Id", apflora.tblBer.BerId AS "Ber Id", apflora.tblBer.ApArtId AS "Ber ApId", apflora.tblBer.BerAutor AS "Ber Autor", apflora.tblBer.BerJahr AS "Ber Jahr", apflora.tblBer.BerTitel AS "Ber Titel", apflora.tblBer.BerURL AS "Ber URL", apflora.tblBer.MutWann AS "Ber MutWann", apflora.tblBer.MutWer AS "Ber MutWer"
FROM ((((apfloraBeob.ArtenDb_Arteigenschaften RIGHT JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.tblAdresse ON apflora.tblAp.ApBearb = apflora.tblAdresse.AdrId) RIGHT JOIN apflora.tblBer ON apflora.tblAp.ApArtId = apflora.tblBer.ApArtId
WHERE apflora.tblAp.ApArtId is Null
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vAssozArten AS
SELECT apflora.tblAp.ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "AP Art", apflora.domApBearbeitungsstand.DomainTxt AS "AP Bearbeitungsstand", apflora.tblAp.ApJahr AS "AP Start im Jahr", apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", apflora.tblAdresse.AdrName AS "AP verantwortlich", apflora.tblAssozArten.AaId AS "AA Id", ArtenDb_Arteigenschaften_1.Artname AS "AA Art", apflora.tblAssozArten.AaBem AS "AA Bemerkungen", apflora.tblAssozArten.MutWann AS "AA MutWann", apflora.tblAssozArten.MutWer AS "AA MutWer"
FROM apfloraBeob.ArtenDb_Arteigenschaften AS ArtenDb_Arteigenschaften_1 RIGHT JOIN (((((apfloraBeob.ArtenDb_Arteigenschaften RIGHT JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.tblAdresse ON apflora.tblAp.ApBearb = apflora.tblAdresse.AdrId) RIGHT JOIN apflora.tblAssozArten ON apflora.tblAp.ApArtId = apflora.tblAssozArten.AaApArtId) ON ArtenDb_Arteigenschaften_1.TaxonomieId = apflora.tblAssozArten.AaSisfNr
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vAssozArtenOhneAp AS
SELECT apflora.tblAp.ApArtId AS "AP ApArtId", apflora.tblAssozArten.AaId AS "AA Id", apflora.tblAssozArten.AaApArtId AS "AA ApArtId", ArtenDb_Arteigenschaften_1.Artname AS "AA Art", apflora.tblAssozArten.AaBem AS "AA Bemerkungen", apflora.tblAssozArten.MutWann AS "AA MutWann", apflora.tblAssozArten.MutWer AS "AA MutWer"
FROM apfloraBeob.ArtenDb_Arteigenschaften AS ArtenDb_Arteigenschaften_1 RIGHT JOIN (((((apfloraBeob.ArtenDb_Arteigenschaften RIGHT JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.tblAdresse ON apflora.tblAp.ApBearb = apflora.tblAdresse.AdrId) RIGHT JOIN apflora.tblAssozArten ON apflora.tblAp.ApArtId = apflora.tblAssozArten.AaApArtId) ON ArtenDb_Arteigenschaften_1.TaxonomieId = apflora.tblAssozArten.AaSisfNr
WHERE apflora.tblAp.ApArtId is Null
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vApOhnePop AS 
SELECT apflora.tblAp.ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS Art, apflora.domApBearbeitungsstand.DomainTxt AS "Bearbeitungsstand AP", apflora.tblAp.ApJahr AS "Start AP im Jahr", apflora.domApUmsetzung.DomainTxt AS "Stand Umsetzung AP", apflora.tblAdresse.AdrName AS "Verantwortlich", apflora.tblPop.ApArtId AS "Population"
FROM ((((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.tblAdresse ON apflora.tblAp.ApBearb = apflora.tblAdresse.AdrId) LEFT JOIN apflora.tblPop ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId
WHERE (((apflora.tblPop.ApArtId) Is Null))
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vApArtenAnzKontrInJahr AS
SELECT apflora.tblAp.ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblTPopKontr.TPopKontrId, apflora.tblTPopKontr.TPopKontrJahr
FROM (apflora.tblAp INNER JOIN apfloraBeob.ArtenDb_Arteigenschaften ON apflora.tblAp.ApArtId = apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId) INNER JOIN (apflora.tblPop INNER JOIN (apflora.tblTPop INNER JOIN apflora.tblTPopKontr ON apflora.tblTPop.TPopId = apflora.tblTPopKontr.TPopId) ON apflora.tblPop.PopId = apflora.tblTPop.PopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId
WHERE (((apflora.tblAp.ApStatus) Between 1 And 3))
GROUP BY apflora.tblAp.ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblTPopKontr.TPopKontrId, apflora.tblTPopKontr.TPopKontrJahr;

CREATE OR REPLACE VIEW vErfKrit AS
SELECT apflora.tblAp.ApArtId AS "AP Id", apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "AP Art", apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", apflora.tblAp.ApJahr AS "AP Start im Jahr", apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", apflora.tblAdresse.AdrName AS "AP verantwortlich", apflora.tblErfKrit.ErfkritId AS "ErfKrit Id", apflora.tblErfKrit.ApArtId AS "ErfKrit ApId", domApErfKrit.BeurteilTxt AS "ErfKrit Beurteilung", apflora.tblErfKrit.ErfkritTxt AS "ErfKrit Kriterien", apflora.tblErfKrit.MutWann AS "ErfKrit MutWann", apflora.tblErfKrit.MutWer AS "ErfKrit MutWer"
FROM (((((apfloraBeob.ArtenDb_Arteigenschaften RIGHT JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.tblAdresse ON apflora.tblAp.ApBearb = apflora.tblAdresse.AdrId) RIGHT JOIN apflora.tblErfKrit ON apflora.tblAp.ApArtId = apflora.tblErfKrit.ApArtId) LEFT JOIN apflora.domApErfKrit ON apflora.tblErfKrit.ErfkritErreichungsgrad = domApErfKrit.BeurteilId
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vErfKritOhneAp AS
SELECT apflora.tblAp.ApArtId AS "AP Id", apflora.tblErfKrit.ErfkritId AS "ErfKrit Id", apflora.tblErfKrit.ApArtId AS "ErfKrit ApId", domApErfKrit.BeurteilTxt AS "ErfKrit Beurteilung", apflora.tblErfKrit.ErfkritTxt AS "ErfKrit Kriterien", apflora.tblErfKrit.MutWann AS "ErfKrit MutWann", apflora.tblErfKrit.MutWer AS "ErfKrit MutWer"
FROM (((((apfloraBeob.ArtenDb_Arteigenschaften RIGHT JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.tblAdresse ON apflora.tblAp.ApBearb = apflora.tblAdresse.AdrId) RIGHT JOIN apflora.tblErfKrit ON apflora.tblAp.ApArtId = apflora.tblErfKrit.ApArtId) LEFT JOIN apflora.domApErfKrit ON apflora.tblErfKrit.ErfkritErreichungsgrad = domApErfKrit.BeurteilId
WHERE apflora.tblAp.ApArtId is Null
ORDER BY apflora.domApErfKrit.BeurteilTxt, apflora.tblErfKrit.ErfkritTxt;

CREATE OR REPLACE VIEW vAuswApArtenAnzMassnInJahr0 AS
SELECT apflora.tblAp.ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblTPopMassn.TPopMassnId, apflora.tblTPopMassn.TPopMassnJahr
FROM (apflora.tblAp INNER JOIN apfloraBeob.ArtenDb_Arteigenschaften ON apflora.tblAp.ApArtId = apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId) INNER JOIN ((apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN apflora.tblTPopMassn ON apflora.tblTPop.TPopId = apflora.tblTPopMassn.TPopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId
WHERE (((apflora.tblAp.ApStatus) Between 1 And 3))
GROUP BY apflora.tblAp.ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblTPopMassn.TPopMassnId, apflora.tblTPopMassn.TPopMassnJahr;

CREATE OR REPLACE VIEW vAuswApArtenBearbMassnInJahr0 AS 
SELECT apflora.tblAdresse.AdrName, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS Art, apflora.tblPop.PopNr, apflora.tblPop.PopName, apflora.tblTPop.TPopNr, apflora.tblTPop.TPopGemeinde, apflora.tblTPop.TPopFlurname, apflora.tblTPopMassn.TPopMassnJahr, domTPopMassnTyp.MassnTypTxt AS TPopMassnTyp, apflora.tblTPopMassn.TPopMassnTxt, apflora.tblTPopMassn.TPopMassnDatum, apflora.tblTPopMassn.TPopMassnBemTxt, apflora.tblTPopMassn.TPopMassnPlan, apflora.tblTPopMassn.TPopMassnPlanBez, apflora.tblTPopMassn.TPopMassnFlaeche, apflora.tblTPopMassn.TPopMassnMarkierung, apflora.tblTPopMassn.TPopMassnAnsiedAnzTriebe, apflora.tblTPopMassn.TPopMassnAnsiedAnzPfl, apflora.tblTPopMassn.TPopMassnAnzPflanzstellen, apflora.tblTPopMassn.TPopMassnAnsiedWirtspfl, apflora.tblTPopMassn.TPopMassnAnsiedHerkunftPop, apflora.tblTPopMassn.TPopMassnAnsiedDatSamm, apflora.tblTPopMassn.TPopMassnAnsiedForm, apflora.tblTPopMassn.TPopMassnAnsiedPflanzanordnung
FROM (apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN ((apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN ((apflora.tblTPopMassn LEFT JOIN apflora.tblAdresse ON apflora.tblTPopMassn.TPopMassnBearb = apflora.tblAdresse.AdrId) INNER JOIN apflora.domTPopMassnTyp ON apflora.tblTPopMassn.TPopMassnTyp = domTPopMassnTyp.MassnTypCode) ON apflora.tblTPop.TPopId = apflora.tblTPopMassn.TPopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId
WHERE (((apflora.tblAp.ApStatus) Between 1 And 3))
ORDER BY apflora.tblAdresse.AdrName, apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr, apflora.tblPop.PopName, apflora.tblTPop.TPopNr, apflora.tblTPop.TPopGemeinde, apflora.tblTPop.TPopFlurname;

CREATE OR REPLACE VIEW vAuswApArtenMitMassnInJahr0 AS 
SELECT apfloraBeob.ArtenDb_Arteigenschaften.Artname AS Art, apflora.tblPop.PopNr, apflora.tblPop.PopName, apflora.tblTPop.TPopNr, apflora.tblTPop.TPopGemeinde, apflora.tblTPop.TPopFlurname, apflora.tblTPopMassn.TPopMassnJahr, domTPopMassnTyp.MassnTypTxt AS TPopMassnTyp, apflora.tblTPopMassn.TPopMassnTxt, apflora.tblTPopMassn.TPopMassnDatum, apflora.tblAdresse.AdrName AS TPopMassnBearb, apflora.tblTPopMassn.TPopMassnBemTxt, apflora.tblTPopMassn.TPopMassnPlan, apflora.tblTPopMassn.TPopMassnPlanBez, apflora.tblTPopMassn.TPopMassnFlaeche, apflora.tblTPopMassn.TPopMassnMarkierung, apflora.tblTPopMassn.TPopMassnAnsiedAnzTriebe, apflora.tblTPopMassn.TPopMassnAnsiedAnzPfl, apflora.tblTPopMassn.TPopMassnAnzPflanzstellen, apflora.tblTPopMassn.TPopMassnAnsiedWirtspfl, apflora.tblTPopMassn.TPopMassnAnsiedHerkunftPop, apflora.tblTPopMassn.TPopMassnAnsiedDatSamm, apflora.tblTPopMassn.TPopMassnAnsiedForm, apflora.tblTPopMassn.TPopMassnAnsiedPflanzanordnung
FROM (apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN ((apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN ((apflora.tblTPopMassn INNER JOIN apflora.domTPopMassnTyp ON apflora.tblTPopMassn.TPopMassnTyp = domTPopMassnTyp.MassnTypCode) LEFT JOIN apflora.tblAdresse ON apflora.tblTPopMassn.TPopMassnBearb = apflora.tblAdresse.AdrId) ON apflora.tblTPop.TPopId = apflora.tblTPopMassn.TPopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId
WHERE (((apflora.tblAp.ApStatus) Between 1 And 3))
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr, apflora.tblPop.PopName, apflora.tblTPop.TPopNr, apflora.tblTPop.TPopGemeinde, apflora.tblTPop.TPopFlurname;

CREATE OR REPLACE VIEW vAuswArtPopTPopMassnBerFuerAktArt0 AS
SELECT apflora.tblAp.ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS Art, apflora.domApBearbeitungsstand.DomainTxt AS "Aktionsplan-Status", apflora.tblAp.ApJahr AS "Aktionsplan-Jahr", apflora.domApUmsetzung.DomainTxt AS "Aktionsplan-Umsetzung", apflora.tblPop.PopNr AS "Population-Nr", apflora.tblPop.PopName AS "Population-Name", domPopHerkunft.HerkunftTxt AS "Population-Herkunft", apflora.tblPop.PopBekanntSeit AS "Population - bekannt seit", apflora.tblTPop.TPopNr AS "Teilpopulation-Nr", apflora.tblTPop.TPopGemeinde AS "Teilpopulation-Gemeinde", apflora.tblTPop.TPopFlurname AS "Teilpopulation-Flurname", apflora.tblTPop.TPopXKoord AS "Teilpopulation-X-Koodinate", apflora.tblTPop.TPopYKoord AS "Teilpopulation-Y-Koordinate", apflora.tblTPop.TPopRadius AS "Teilpopulation-Radius", apflora.tblTPop.TPopHoehe AS "Teilpopulation-Hoehe", apflora.tblTPop.TPopBeschr AS "Teilpopulation-Beschreibung", apflora.tblTPop.TPopKatNr AS "Teilpopulation-Kataster-Nr", domPopHerkunft_1.HerkunftTxt AS "Teilpopulation-Herkunft", apflora.tblTPop.TPopHerkunftUnklar AS "Teilpopulation - Herkunft unklar", apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "Teilpopulation - Herkunft unklar Begruendung",apflora.domTPopApBerichtRelevant.DomainTxt AS "Teilpopulation - Fuer Bericht relevant", apflora.tblTPop.TPopBekanntSeit AS "Teilpopulation - bekannt seit", apflora.tblTPop.TPopEigen AS "Teilpopulation-Eigentuemer", apflora.tblTPop.TPopKontakt AS "Teilpopulation-Kontakt", apflora.tblTPop.TPopNutzungszone AS "Teilpopulation-Nutzungszone", apflora.tblTPop.TPopBewirtschafterIn AS "Teilpopulation-Bewirtschafter", apflora.tblTPop.TPopBewirtschaftung AS "Teilpopulation-Bewirtschaftung", apflora.tblTPop.TPopTxt AS "Teilpopulation-Bemerkungen", apflora.tblTPopMassnBer.TPopMassnBerJahr AS "Massnahmenbericht-Jahr", domTPopMassnErfolgsbeurteilung.BeurteilTxt AS "Massnahmenbericht-Erfolgsberuteilung", apflora.tblTPopMassnBer.TPopMassnBerTxt AS "Massnahmenbericht-Interpretation"
FROM (((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) INNER JOIN (((apflora.tblPop LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) INNER JOIN ((apflora.tblTPop LEFT JOIN apflora.domPopHerkunft AS domPopHerkunft_1 ON apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId) LEFT JOIN apflora.domTPopApBerichtRelevant ON apflora.tblTPop.TPopApBerichtRelevant =apflora.domTPopApBerichtRelevant.DomainCode) ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN (apflora.tblTPopMassnBer INNER JOIN apflora.domTPopMassnErfolgsbeurteilung ON apflora.tblTPopMassnBer.TPopMassnBerErfolgsbeurteilung = domTPopMassnErfolgsbeurteilung.BeurteilId) ON apflora.tblTPop.TPopId = apflora.tblTPopMassnBer.TPopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr, apflora.tblTPop.TPopNr, apflora.tblTPopMassnBer.TPopMassnBerJahr;

CREATE OR REPLACE VIEW vAuswArtPopTPopMassn0 AS 
SELECT apflora.tblAp.ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS Art, apflora.domApBearbeitungsstand.DomainTxt AS "Aktionsplan Bearbeitungsstand", apflora.tblPop.PopId, apflora.tblPop.PopNr, apflora.tblPop.PopName, apflora.tblTPop.TPopId, apflora.tblTPop.TPopNr, apflora.tblTPop.TPopFlurname, apflora.tblTPopMassn.TPopMassnId, apflora.tblTPopMassn.TPopMassnJahr AS Jahr, domTPopMassnTyp.MassnTypTxt AS Massnahme, apflora.tblTPopMassn.TPopMassnTxt, apflora.tblTPopMassn.TPopMassnDatum, apflora.tblAdresse.AdrName AS TPopMassnBearb, apflora.tblTPopMassn.TPopMassnBemTxt, apflora.tblTPopMassn.TPopMassnPlan, apflora.tblTPopMassn.TPopMassnPlanBez, apflora.tblTPopMassn.TPopMassnFlaeche, apflora.tblTPopMassn.TPopMassnMarkierung, apflora.tblTPopMassn.TPopMassnAnsiedAnzTriebe, apflora.tblTPopMassn.TPopMassnAnsiedAnzPfl, apflora.tblTPopMassn.TPopMassnAnzPflanzstellen, apflora.tblTPopMassn.TPopMassnAnsiedWirtspfl, apflora.tblTPopMassn.TPopMassnAnsiedHerkunftPop, apflora.tblTPopMassn.TPopMassnAnsiedDatSamm, apflora.tblTPopMassn.TPopMassnAnsiedForm, apflora.tblTPopMassn.TPopMassnAnsiedPflanzanordnung
FROM ((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) INNER JOIN ((apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN ((apflora.tblTPopMassn LEFT JOIN apflora.domTPopMassnTyp ON apflora.tblTPopMassn.TPopMassnTyp = domTPopMassnTyp.MassnTypCode) LEFT JOIN apflora.tblAdresse ON apflora.tblTPopMassn.TPopMassnBearb = apflora.tblAdresse.AdrId) ON apflora.tblTPop.TPopId = apflora.tblTPopMassn.TPopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr, apflora.tblTPop.TPopNr, apflora.tblTPopMassn.TPopMassnJahr, domTPopMassnTyp.MassnTypTxt;

CREATE OR REPLACE VIEW vAuswArtPopTPopMassnFuerAktArt0 AS 
SELECT apflora.tblAp.ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS Art, apflora.domApBearbeitungsstand.DomainTxt AS "Aktionsplan-Status", apflora.tblAp.ApJahr AS "Aktionsplan-Jahr", apflora.domApUmsetzung.DomainTxt AS "Aktionsplan-Umsetzung", apflora.tblPop.PopId, apflora.tblPop.PopNr AS "Population-Nr", apflora.tblPop.PopName AS "Population-Name", domPopHerkunft.HerkunftTxt AS "Population-Herkunft", apflora.tblPop.PopBekanntSeit AS "Population - bekannt seit", apflora.tblTPop.TPopId, apflora.tblTPop.TPopNr AS "Teilpopulation-Nr", apflora.tblTPop.TPopGemeinde AS "Teilpopulation-Gemeinde", apflora.tblTPop.TPopFlurname AS "Teilpopulation-Flurname", apflora.tblTPop.TPopXKoord AS "Teilpopulation-X-Koodinate", apflora.tblTPop.TPopYKoord AS "Teilpopulation-Y-Koordinate", apflora.tblTPop.TPopRadius AS "Teilpopulation-Radius", apflora.tblTPop.TPopHoehe AS "Teilpopulation-Höhe", apflora.tblTPop.TPopBeschr AS "Teilpopulation-Beschreibung", apflora.tblTPop.TPopKatNr AS "Teilpopulation-Kataster-Nr", domPopHerkunft_1.HerkunftTxt AS "Teilpopulation-Herkunft", apflora.tblTPop.TPopHerkunftUnklar AS "Teilpopulation - Herkunft unklar", apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "Teilpopulation - Herkunft unklar Begruendung",apflora.domTPopApBerichtRelevant.DomainTxt AS "Teilpopulation - Fuer Bericht relevant", apflora.tblTPop.TPopBekanntSeit AS "Teilpopulation - bekannt seit", apflora.tblTPop.TPopEigen AS "Teilpopulation-Eigentuemer", apflora.tblTPop.TPopKontakt AS "Teilpopulation-Kontakt", apflora.tblTPop.TPopNutzungszone AS "Teilpopulation-Nutzungszone", apflora.tblTPop.TPopBewirtschafterIn AS "Teilpopulation-Bewirtschafter", apflora.tblTPop.TPopBewirtschaftung AS "Teilpopulation-Bewirtschaftung", apflora.tblTPop.TPopTxt AS "Teilpopulation-Bemerkungen", apflora.tblTPopMassn.TPopMassnId, domTPopMassnTyp.MassnTypTxt AS "Massnahme-Typ", apflora.tblTPopMassn.TPopMassnTxt AS "Massnahme-Beschreibung", apflora.tblTPopMassn.TPopMassnDatum AS "Massnahme-Datum", apflora.tblAdresse.AdrName AS "Massnahme-BearbeiterIn", apflora.tblTPopMassn.TPopMassnBemTxt AS "Massnahme-Bemerkungen", apflora.tblTPopMassn.TPopMassnPlan AS "Massnahme-Plan", apflora.tblTPopMassn.TPopMassnPlanBez AS "Massnahme-Planbezeichnung", apflora.tblTPopMassn.TPopMassnFlaeche AS "Massnahme-Flaeche", apflora.tblTPopMassn.TPopMassnMarkierung AS "Massnahme-Markierung", apflora.tblTPopMassn.TPopMassnAnsiedAnzTriebe AS "Massnahme - Ansiedlung Anzahl Triebe", apflora.tblTPopMassn.TPopMassnAnsiedAnzPfl AS "Massnahme - Ansiedlung Anzahl Pflanzen", apflora.tblTPopMassn.TPopMassnAnzPflanzstellen AS "Massnahme - Ansiedlung Anzahl Pflanzstellen", apflora.tblTPopMassn.TPopMassnAnsiedWirtspfl AS "Massnahme - Ansiedlung Wirtspflanzen", apflora.tblTPopMassn.TPopMassnAnsiedHerkunftPop AS "Massnahme - Ansiedlung Herkunftspopulation", apflora.tblTPopMassn.TPopMassnAnsiedDatSamm AS "Massnahme - Ansiedlung Sammeldatum", apflora.tblTPopMassn.TPopMassnAnsiedForm AS "Massnahme - Ansiedlung Form", apflora.tblTPopMassn.TPopMassnAnsiedPflanzanordnung AS "Massnahme - Ansiedlung Pflanzordnung"
FROM (apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN ((apflora.tblAp LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN (((apflora.tblPop LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) INNER JOIN ((apflora.tblTPop LEFT JOIN apflora.domPopHerkunft AS domPopHerkunft_1 ON apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId) LEFT JOIN apflora.domTPopApBerichtRelevant ON apflora.tblTPop.TPopApBerichtRelevant =apflora.domTPopApBerichtRelevant.DomainCode) ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN ((apflora.tblTPopMassn LEFT JOIN apflora.domTPopMassnTyp ON apflora.tblTPopMassn.TPopMassnTyp = domTPopMassnTyp.MassnTypCode) LEFT JOIN apflora.tblAdresse ON apflora.tblTPopMassn.TPopMassnBearb = apflora.tblAdresse.AdrId) ON apflora.tblTPop.TPopId = apflora.tblTPopMassn.TPopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr, apflora.tblTPop.TPopNr, domTPopMassnTyp.MassnTypTxt;

CREATE OR REPLACE VIEW vAuswFlurnameArtKontrolle AS
SELECT apflora.tblAp.ApArtId, apflora.tblPop.PopId, apflora.tblTPop.TPopId, apflora.tblTPop.TPopGemeinde AS Gemeinde, apflora.tblTPop.TPopFlurname AS "Flurname aus Teilpopulation", apflora.domApBearbeitungsstand.DomainTxt AS "Bearbeitungsstand AP", apfloraBeob.ArtenDb_Arteigenschaften.Artname AS Art, apflora.tblPop.PopNr, apflora.tblTPop.TPopNr, apflora.tblTPopKontr.TPopKontrJahr AS Jahr, apflora.tblTPopKontr.TPopKontrTyp AS Kontrolltyp, apflora.tblTPopKontr.TPopKontrDatum, apflora.tblAdresse.AdrName AS TPopKontrBearb, apflora.tblTPopKontr.TPopKontrJungpfl, apflora.tblTPopKontr.TPopKontrVitalitaet, apflora.tblTPopKontr.TPopKontrUeberleb, apflora.tblTPopKontr.TPopKontrEntwicklung, apflora.tblTPopKontr.TPopKontrUrsach, apflora.tblTPopKontr.TPopKontrUrteil, apflora.tblTPopKontr.TPopKontrAendUms, apflora.tblTPopKontr.TPopKontrAendKontr, apflora.tblTPopKontr.TPopKontrTxt, apflora.tblTPopKontr.TPopKontrLeb, apflora.tblTPopKontr.TPopKontrFlaeche, apflora.tblTPopKontr.TPopKontrLebUmg, apflora.tblTPopKontr.TPopKontrStrauchschicht, apflora.tblTPopKontr.TPopKontrBodenTyp, apflora.tblTPopKontr.TPopKontrBodenAbtrag, apflora.tblTPopKontr.TPopKontrWasserhaushalt, apflora.tblTPopKontr.TPopKontrHandlungsbedarf, apflora.tblTPopKontr.TPopKontrUebFlaeche, apflora.tblTPopKontr.TPopKontrPlan, apflora.tblTPopKontr.TPopKontrVeg, apflora.tblTPopKontr.TPopKontrNaBo, apflora.tblTPopKontr.TPopKontrUebPfl, apflora.tblTPopKontr.TPopKontrJungPflJN, apflora.tblTPopKontr.TPopKontrVegHoeMax, apflora.tblTPopKontr.TPopKontrVegHoeMit, apflora.tblTPopKontr.TPopKontrGefaehrdung, apflora.tblTPopKontrZaehl.TPopKontrZaehlId, apflora.tblTPopKontrZaehl.TPopKontrId, apflora.tblTPopKontrZaehl.Anzahl, apflora.domTPopKontrZaehleinheit.ZaehleinheitTxt AS Zaehleinheit, apflora.domTPopKontrMethode.BeurteilTxt AS Methode
FROM ((((((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN (apflora.tblPop INNER JOIN (apflora.tblTPop INNER JOIN apflora.tblTPopKontr ON apflora.tblTPop.TPopId = apflora.tblTPopKontr.TPopId) ON apflora.tblPop.PopId = apflora.tblTPop.PopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.tblAdresse ON apflora.tblTPopKontr.TPopKontrBearb = apflora.tblAdresse.AdrId) LEFT JOIN apflora.tblTPopKontrZaehl ON apflora.tblTPopKontr.TPopKontrId = apflora.tblTPopKontrZaehl.TPopKontrId) LEFT JOIN apflora.domTPopKontrZaehleinheit ON apflora.tblTPopKontrZaehl.Zaehleinheit = apflora.domTPopKontrZaehleinheit.ZaehleinheitCode) LEFT JOIN apflora.domTPopKontrMethode ON apflora.tblTPopKontrZaehl.Methode = apflora.domTPopKontrMethode.BeurteilCode
WHERE apflora.tblTPopKontr.TPopKontrTyp Not Like "Ziel"
ORDER BY apflora.tblTPop.TPopGemeinde, apflora.tblTPop.TPopFlurname, apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr, apflora.tblTPop.TPopNr, apflora.tblTPopKontr.TPopKontrJahr, apflora.tblTPopKontr.TPopKontrTyp;


CREATE OR REPLACE VIEW vJbA1rPop AS 
SELECT apflora.tblPop.ApArtId, apflora.tblPop.PopId
FROM apflora.tblAp INNER JOIN (apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId
WHERE (apflora.tblPop.PopHerkunft=100 Or apflora.tblPop.PopHerkunft=101 Or apflora.tblPop.PopHerkunft=210) AND apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300
GROUP BY apflora.tblPop.ApArtId, apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbA2rPop AS 
SELECT apflora.tblPop.ApArtId, apflora.tblPop.PopId
FROM apflora.tblAp INNER JOIN (apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId
WHERE (apflora.tblPop.PopHerkunft=100 Or apflora.tblPop.PopHerkunft=101) AND apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300
GROUP BY apflora.tblPop.ApArtId, apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbA3rPop AS 
SELECT apflora.tblPop.ApArtId, apflora.tblPop.PopId
FROM apflora.tblAp INNER JOIN (apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId
WHERE apflora.tblPop.PopHerkunft=210 AND apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300 AND (apflora.tblPop.PopBekanntSeit<apflora.tblAp.ApJahr Or apflora.tblPop.PopBekanntSeit Is Null)
GROUP BY apflora.tblPop.ApArtId, apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbA1rTPop AS
SELECT apflora.tblPop.ApArtId, apflora.tblTPop.TPopId
FROM apflora.tblAp INNER JOIN (apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId
WHERE (apflora.tblTPop.TPopHerkunft=100 Or apflora.tblTPop.TPopHerkunft=101 Or apflora.tblTPop.TPopHerkunft=210) AND apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300
GROUP BY apflora.tblPop.ApArtId, apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbA2rTPop AS 
SELECT apflora.tblPop.ApArtId, apflora.tblTPop.TPopId
FROM apflora.tblAp INNER JOIN (apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId
WHERE (apflora.tblTPop.TPopHerkunft=100 Or apflora.tblTPop.TPopHerkunft=101) AND apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300
GROUP BY apflora.tblPop.ApArtId, apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbA3rTPop AS 
SELECT apflora.tblPop.ApArtId, apflora.tblTPop.TPopId
FROM apflora.tblAp INNER JOIN (apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId
WHERE apflora.tblTPop.TPopHerkunft=210 AND apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300 AND (apflora.tblPop.PopBekanntSeit<apflora.tblAp.ApJahr Or apflora.tblPop.PopBekanntSeit Is Null)
GROUP BY apflora.tblPop.ApArtId, apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbB1rPop AS 
SELECT apflora.tblPop.ApArtId, apflora.tblPop.PopId
FROM apflora.tblKonstanten, (apflora.tblPop INNER JOIN apflora.tblPopBer ON apflora.tblPop.PopId = apflora.tblPopBer.PopId) INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300 AND apflora.tblPopBer.PopBerJahr<=apflora.tblKonstanten.JBerJahr
GROUP BY apflora.tblPop.ApArtId, apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbB1rTPop AS 
SELECT apflora.tblPop.ApArtId, apflora.tblTPopBer.TPopId
FROM apflora.tblKonstanten, apflora.tblPop INNER JOIN (apflora.tblTPop INNER JOIN apflora.tblTPopBer ON apflora.tblTPop.TPopId = apflora.tblTPopBer.TPopId) ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300 AND apflora.tblTPopBer.TPopBerJahr<=apflora.tblKonstanten.JBerJahr
GROUP BY apflora.tblPop.ApArtId, apflora.tblTPopBer.TPopId;

CREATE OR REPLACE VIEW vJbC1rTPop AS 
SELECT apflora.tblPop.ApArtId, apflora.tblTPop.TPopId
FROM apflora.tblKonstanten, (apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN apflora.tblTPopMassn ON apflora.tblTPop.TPopId = apflora.tblTPopMassn.TPopId
WHERE apflora.tblTPopMassn.TPopMassnJahr<=apflora.tblKonstanten.JBerJahr AND apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300
GROUP BY apflora.tblPop.ApArtId, apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbA3lPop AS 
SELECT apflora.tblPop.ApArtId, apflora.tblPop.PopId
FROM (apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN apflora.tblAp ON apflora.tblPop.ApArtId = apflora.tblAp.ApArtId
WHERE (apflora.tblPop.PopHerkunft=210 AND apflora.tblTPop.TPopApBerichtRelevant=1 AND (apflora.tblPop.PopBekanntSeit<apflora.tblAp.ApJahr Or apflora.tblPop.PopBekanntSeit Is Null))
GROUP BY apflora.tblPop.ApArtId, apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbA4lPop AS
SELECT apflora.tblPop.ApArtId, apflora.tblPop.PopId
FROM (apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN apflora.tblAp ON apflora.tblPop.ApArtId = apflora.tblAp.ApArtId
WHERE apflora.tblPop.PopHerkunft=200 AND apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopBekanntSeit>=apflora.tblAp.ApJahr
GROUP BY apflora.tblPop.ApArtId, apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbA5lPop AS 
SELECT apflora.tblPop.ApArtId, apflora.tblPop.PopId
FROM apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE apflora.tblPop.PopHerkunft=201 AND apflora.tblTPop.TPopApBerichtRelevant=1
GROUP BY apflora.tblPop.ApArtId, apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbA8lPop AS
SELECT apflora.tblPop.ApArtId, apflora.tblPop.PopId
FROM apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE (apflora.tblPop.PopHerkunft=101 Or apflora.tblPop.PopHerkunft=211) AND apflora.tblTPop.TPopApBerichtRelevant=1
GROUP BY apflora.tblPop.ApArtId, apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbA9lPop AS 
SELECT apflora.tblPop.ApArtId, apflora.tblPop.PopId
FROM apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE apflora.tblPop.PopHerkunft=202 AND apflora.tblTPop.TPopApBerichtRelevant=1
GROUP BY apflora.tblPop.ApArtId, apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbA1lTPop AS
SELECT apflora.tblPop.ApArtId, apflora.tblTPop.TPopId
FROM apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300
GROUP BY apflora.tblPop.ApArtId, apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbA2lTPop AS 
SELECT apflora.tblPop.ApArtId, apflora.tblTPop.TPopId
FROM apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE apflora.tblTPop.TPopHerkunft=100 AND apflora.tblTPop.TPopApBerichtRelevant=1
GROUP BY apflora.tblPop.ApArtId, apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbA3lTPop AS
SELECT apflora.tblPop.ApArtId, apflora.tblTPop.TPopId
FROM (apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN apflora.tblAp ON apflora.tblPop.ApArtId = apflora.tblAp.ApArtId
WHERE apflora.tblTPop.TPopHerkunft=210 AND apflora.tblTPop.TPopApBerichtRelevant=1 AND (apflora.tblPop.PopBekanntSeit<apflora.tblAp.ApJahr Or apflora.tblPop.PopBekanntSeit Is Null)
GROUP BY apflora.tblPop.ApArtId, apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbA4lTPop AS 
SELECT apflora.tblPop.ApArtId, apflora.tblTPop.TPopId
FROM (apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN apflora.tblAp ON apflora.tblPop.ApArtId = apflora.tblAp.ApArtId
WHERE apflora.tblTPop.TPopHerkunft=200 AND apflora.tblTPop.TPopApBerichtRelevant=1 AND (apflora.tblPop.PopBekanntSeit>=apflora.tblAp.ApJahr)
GROUP BY apflora.tblPop.ApArtId, apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbA5lTPop AS
SELECT apflora.tblPop.ApArtId, apflora.tblTPop.TPopId
FROM apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE apflora.tblTPop.TPopHerkunft=201 AND apflora.tblTPop.TPopApBerichtRelevant=1
GROUP BY apflora.tblPop.ApArtId, apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbA8lTPop AS 
SELECT apflora.tblPop.ApArtId, apflora.tblTPop.TPopId
FROM apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE (apflora.tblTPop.TPopHerkunft=101 Or apflora.tblTPop.TPopHerkunft=211) AND apflora.tblTPop.TPopApBerichtRelevant=1
GROUP BY apflora.tblPop.ApArtId, apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbA9lTPop AS
SELECT apflora.tblPop.ApArtId, apflora.tblTPop.TPopId
FROM apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE apflora.tblTPop.TPopHerkunft=202 AND apflora.tblTPop.TPopApBerichtRelevant=1
GROUP BY apflora.tblPop.ApArtId, apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbB1lPop AS 
SELECT apflora.tblPop.ApArtId, apflora.tblPop.PopId
FROM (apflora.tblPop INNER JOIN (apflora.tblPopBer INNER JOIN apflora.tblKonstanten ON apflora.tblPopBer.PopBerJahr = apflora.tblKonstanten.JBerJahr) ON apflora.tblPop.PopId = apflora.tblPopBer.PopId) INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300
GROUP BY apflora.tblPop.ApArtId, apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbB2lPop AS
SELECT apflora.tblPop.ApArtId, apflora.tblPop.PopId
FROM (apflora.tblPop INNER JOIN (apflora.tblPopBer INNER JOIN apflora.tblKonstanten ON apflora.tblPopBer.PopBerJahr = apflora.tblKonstanten.JBerJahr) ON apflora.tblPop.PopId = apflora.tblPopBer.PopId) INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE apflora.tblPopBer.PopBerEntwicklung=3 AND apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300
GROUP BY apflora.tblPop.ApArtId, apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbB3lPop AS 
SELECT apflora.tblPop.ApArtId, apflora.tblPop.PopId
FROM (apflora.tblPop INNER JOIN (apflora.tblPopBer INNER JOIN apflora.tblKonstanten ON apflora.tblPopBer.PopBerJahr = apflora.tblKonstanten.JBerJahr) ON apflora.tblPop.PopId = apflora.tblPopBer.PopId) INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE apflora.tblPopBer.PopBerEntwicklung=2 AND apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300
GROUP BY apflora.tblPop.ApArtId, apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbB4lPop AS
SELECT apflora.tblPop.ApArtId, apflora.tblPop.PopId
FROM (apflora.tblPop INNER JOIN (apflora.tblPopBer INNER JOIN apflora.tblKonstanten ON apflora.tblPopBer.PopBerJahr = apflora.tblKonstanten.JBerJahr) ON apflora.tblPop.PopId = apflora.tblPopBer.PopId) INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE apflora.tblPopBer.PopBerEntwicklung=1 AND apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300
GROUP BY apflora.tblPop.ApArtId, apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbB5lPop AS 
SELECT apflora.tblPop.ApArtId, apflora.tblPop.PopId
FROM (apflora.tblPop INNER JOIN (apflora.tblPopBer INNER JOIN apflora.tblKonstanten ON apflora.tblPopBer.PopBerJahr = apflora.tblKonstanten.JBerJahr) ON apflora.tblPop.PopId = apflora.tblPopBer.PopId) INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE apflora.tblPopBer.PopBerEntwicklung=4 AND apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300
GROUP BY apflora.tblPop.ApArtId, apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbB6lPop AS
SELECT apflora.tblPop.ApArtId, apflora.tblPop.PopId
FROM (apflora.tblPop INNER JOIN (apflora.tblPopBer INNER JOIN apflora.tblKonstanten ON apflora.tblPopBer.PopBerJahr = apflora.tblKonstanten.JBerJahr) ON apflora.tblPop.PopId = apflora.tblPopBer.PopId) INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE apflora.tblPopBer.PopBerEntwicklung=8 AND apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300
GROUP BY apflora.tblPop.ApArtId, apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbB7lPop AS 
SELECT apflora.tblPop.ApArtId, apflora.tblPop.PopId
FROM apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300
GROUP BY apflora.tblPop.ApArtId, apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbB1lTPop AS
SELECT apflora.tblPop.ApArtId, apflora.tblTPop.TPopId
FROM apflora.tblPop INNER JOIN (apflora.tblTPop INNER JOIN (apflora.tblTPopBer INNER JOIN apflora.tblKonstanten ON apflora.tblTPopBer.TPopBerJahr = apflora.tblKonstanten.JBerJahr) ON apflora.tblTPop.TPopId = apflora.tblTPopBer.TPopId) ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300
GROUP BY apflora.tblPop.ApArtId, apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbB2lTPop AS 
SELECT apflora.tblPop.ApArtId, apflora.tblTPop.TPopId
FROM apflora.tblPop INNER JOIN (apflora.tblTPop INNER JOIN (apflora.tblTPopBer INNER JOIN apflora.tblKonstanten ON apflora.tblTPopBer.TPopBerJahr = apflora.tblKonstanten.JBerJahr) ON apflora.tblTPop.TPopId = apflora.tblTPopBer.TPopId) ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE apflora.tblTPopBer.TPopBerEntwicklung=3 AND apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300
GROUP BY apflora.tblPop.ApArtId, apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbB3lTPop AS
SELECT apflora.tblPop.ApArtId, apflora.tblTPop.TPopId
FROM apflora.tblPop INNER JOIN (apflora.tblTPop INNER JOIN (apflora.tblTPopBer INNER JOIN apflora.tblKonstanten ON apflora.tblTPopBer.TPopBerJahr = apflora.tblKonstanten.JBerJahr) ON apflora.tblTPop.TPopId = apflora.tblTPopBer.TPopId) ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE apflora.tblTPopBer.TPopBerEntwicklung=2 AND apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300
GROUP BY apflora.tblPop.ApArtId, apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbB4lTPop AS 
SELECT apflora.tblPop.ApArtId, apflora.tblTPop.TPopId
FROM apflora.tblPop INNER JOIN (apflora.tblTPop INNER JOIN (apflora.tblTPopBer INNER JOIN apflora.tblKonstanten ON apflora.tblTPopBer.TPopBerJahr = apflora.tblKonstanten.JBerJahr) ON apflora.tblTPop.TPopId = apflora.tblTPopBer.TPopId) ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE apflora.tblTPopBer.TPopBerEntwicklung=1 AND apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300
GROUP BY apflora.tblPop.ApArtId, apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbB5lTPop AS
SELECT apflora.tblPop.ApArtId, apflora.tblTPop.TPopId
FROM apflora.tblPop INNER JOIN (apflora.tblTPop INNER JOIN (apflora.tblTPopBer INNER JOIN apflora.tblKonstanten ON apflora.tblTPopBer.TPopBerJahr = apflora.tblKonstanten.JBerJahr) ON apflora.tblTPop.TPopId = apflora.tblTPopBer.TPopId) ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE apflora.tblTPopBer.TPopBerEntwicklung=4 AND apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300
GROUP BY apflora.tblPop.ApArtId, apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbB6lTPop AS 
SELECT apflora.tblPop.ApArtId, apflora.tblTPop.TPopId
FROM apflora.tblPop INNER JOIN (apflora.tblTPop INNER JOIN (apflora.tblTPopBer INNER JOIN apflora.tblKonstanten ON apflora.tblTPopBer.TPopBerJahr = apflora.tblKonstanten.JBerJahr) ON apflora.tblTPop.TPopId = apflora.tblTPopBer.TPopId) ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE apflora.tblTPopBer.TPopBerEntwicklung=8 AND apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300
GROUP BY apflora.tblPop.ApArtId, apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbB7lTPop AS
SELECT apflora.tblPop.ApArtId, apflora.tblTPop.TPopId
FROM apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId
WHERE apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300
GROUP BY apflora.tblPop.ApArtId, apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbC1lPop AS 
SELECT apflora.tblPop.ApArtId, apflora.tblPop.PopId
FROM (apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN (apflora.tblTPopMassn INNER JOIN apflora.tblKonstanten ON apflora.tblTPopMassn.TPopMassnJahr = apflora.tblKonstanten.JBerJahr) ON apflora.tblTPop.TPopId = apflora.tblTPopMassn.TPopId
WHERE apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300
GROUP BY apflora.tblPop.ApArtId, apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbC1lTPop AS
SELECT apflora.tblPop.ApArtId, apflora.tblTPop.TPopId
FROM ((apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN apflora.tblTPopMassn ON apflora.tblTPop.TPopId = apflora.tblTPopMassn.TPopId) INNER JOIN apflora.tblKonstanten ON apflora.tblTPopMassn.TPopMassnJahr = apflora.tblKonstanten.JBerJahr
WHERE apflora.tblTPop.TPopApBerichtRelevant=1 AND apflora.tblPop.PopHerkunft <> 300
GROUP BY apflora.tblPop.ApArtId, apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vAuswAnzProTPopAngezArtBestJahr0 AS 
SELECT apflora.tblAp.ApArtId, apflora.tblPop.PopId, apflora.tblTPop.TPopId, apflora.tblTPopKontr.TPopKontrId, apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr, apflora.tblPop.PopName, apflora.domPopHerkunft.HerkunftTxt AS PopHerkunft, apflora.tblTPop.TPopNr, apflora.tblTPop.TPopGemeinde, apflora.tblTPop.TPopFlurname, domPopHerkunft_1.HerkunftTxt AS TPopHerkunft, apflora.tblTPopKontr.TPopKontrTyp, apflora.tblTPopKontr.TPopKontrJahr, apflora.tblTPopKontr.TPopKontrDatum, apflora.tblAdresse.AdrName AS TPopKontrBearb, apflora.tblTPopKontrZaehl.Anzahl, apflora.domTPopKontrZaehleinheit.ZaehleinheitTxt AS Zaehleinheit, apflora.domTPopKontrMethode.BeurteilTxt AS Methode, apflora.tblTPopKontr.TPopKontrJungpfl, apflora.tblTPopKontr.TPopKontrVitalitaet, apflora.tblTPopKontr.TPopKontrUeberleb, apflora.domTPopEntwicklung.EntwicklungTxt AS TPopKontrEntwicklung, apflora.tblTPopKontr.TPopKontrUrsach, apflora.tblTPopKontr.TPopKontrUrteil, apflora.tblTPopKontr.TPopKontrAendUms, apflora.tblTPopKontr.TPopKontrAendKontr, apflora.tblTPopKontr.TPopKontrTxt, apflora.tblTPopKontr.TPopKontrLeb, apflora.tblTPopKontr.TPopKontrFlaeche, apflora.tblTPopKontr.TPopKontrLebUmg, apflora.tblTPopKontr.TPopKontrStrauchschicht, apflora.tblTPopKontr.TPopKontrBodenTyp, apflora.tblTPopKontr.TPopKontrBodenAbtrag, apflora.tblTPopKontr.TPopKontrWasserhaushalt, apflora.tblTPopKontr.TPopKontrHandlungsbedarf, apflora.tblTPopKontr.TPopKontrUebFlaeche, apflora.tblTPopKontr.TPopKontrPlan, apflora.tblTPopKontr.TPopKontrVeg, apflora.tblTPopKontr.TPopKontrNaBo, apflora.tblTPopKontr.TPopKontrUebPfl, apflora.tblTPopKontr.TPopKontrJungPflJN, apflora.tblTPopKontr.TPopKontrVegHoeMax, apflora.tblTPopKontr.TPopKontrVegHoeMit, apflora.tblTPopKontr.TPopKontrGefaehrdung, apflora.tblTPopKontr.TPopKontrMutDat
FROM (((((((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN (((apflora.tblAp INNER JOIN apflora.tblPop ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN apflora.tblTPopKontr ON apflora.tblTPop.TPopId = apflora.tblTPopKontr.TPopId) ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = apflora.domPopHerkunft.HerkunftId) LEFT JOIN apflora.domPopHerkunft AS domPopHerkunft_1 ON apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId) LEFT JOIN apflora.tblAdresse ON apflora.tblTPopKontr.TPopKontrBearb = apflora.tblAdresse.AdrId) LEFT JOIN apflora.domTPopEntwicklung ON apflora.tblTPopKontr.TPopKontrEntwicklung = apflora.domTPopEntwicklung.EntwicklungCode) INNER JOIN apflora.tblTPopKontrZaehl ON apflora.tblTPopKontr.TPopKontrId = apflora.tblTPopKontrZaehl.TPopKontrId) INNER JOIN apflora.domTPopKontrMethode ON apflora.tblTPopKontrZaehl.Methode = apflora.domTPopKontrMethode.BeurteilCode) LEFT JOIN apflora.domTPopKontrZaehleinheit ON apflora.tblTPopKontrZaehl.Zaehleinheit = apflora.domTPopKontrZaehleinheit.ZaehleinheitCode;

CREATE OR REPLACE VIEW vAuswPopBerAngezArtBestJahr0 AS
SELECT apflora.tblAp.ApArtId, apflora.tblPop.PopId, apflora.tblPopBer.PopBerId, apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr, apflora.tblPop.PopName, domPopHerkunft.HerkunftTxt AS PopHerkunft, apflora.tblPopBer.PopBerJahr, domPopEntwicklung.EntwicklungTxt AS PopBerEntwicklung, apflora.tblPopBer.PopBerTxt
FROM ((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN ((apflora.tblAp INNER JOIN apflora.tblPop ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) INNER JOIN apflora.tblPopBer ON apflora.tblPop.PopId = apflora.tblPopBer.PopId) ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN apflora.domPopEntwicklung ON apflora.tblPopBer.PopBerEntwicklung = domPopEntwicklung.EntwicklungId;
 
CREATE OR REPLACE VIEW vApZiele AS 
SELECT apflora.tblAp.ApArtId AS "AP Id", apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "AP Art", apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", apflora.tblAp.ApJahr AS "AP Start im Jahr", apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", apflora.tblAdresse.AdrName AS "AP verantwortlich", apflora.tblZiel.ZielId AS "Ziel Id", apflora.tblZiel.ApArtId AS "Ziel ApId", apflora.tblZiel.ZielJahr AS "Ziel Jahr", domZielTyp.ZieltypTxt AS "Ziel Typ", apflora.tblZiel.ZielBezeichnung AS "Ziel Beschreibung"
FROM (((((apfloraBeob.ArtenDb_Arteigenschaften RIGHT JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.tblAdresse ON apflora.tblAp.ApBearb = apflora.tblAdresse.AdrId) RIGHT JOIN apflora.tblZiel ON apflora.tblAp.ApArtId = apflora.tblZiel.ApArtId) LEFT JOIN apflora.domZielTyp ON apflora.tblZiel.ZielTyp = domZielTyp.ZieltypId
WHERE apflora.tblZiel.ZielTyp=1 Or apflora.tblZiel.ZielTyp=2 Or apflora.tblZiel.ZielTyp=1170775556
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblZiel.ZielJahr, domZielTyp.ZieltypTxt, apflora.tblZiel.ZielTyp;

CREATE OR REPLACE VIEW vApZieleOhneAp AS 
SELECT apflora.tblAp.ApArtId AS "AP Id", apflora.tblZiel.ZielId AS "Ziel Id", apflora.tblZiel.ApArtId AS "Ziel ApId", apflora.tblZiel.ZielJahr AS "Ziel Jahr", domZielTyp.ZieltypTxt AS "Ziel Typ", apflora.tblZiel.ZielBezeichnung AS "Ziel Beschreibung"
FROM (((((apfloraBeob.ArtenDb_Arteigenschaften RIGHT JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.tblAdresse ON apflora.tblAp.ApBearb = apflora.tblAdresse.AdrId) RIGHT JOIN apflora.tblZiel ON apflora.tblAp.ApArtId = apflora.tblZiel.ApArtId) LEFT JOIN apflora.domZielTyp ON apflora.tblZiel.ZielTyp = domZielTyp.ZieltypId
WHERE apflora.tblAp.ApArtId is Null
ORDER BY apflora.tblZiel.ZielJahr, domZielTyp.ZieltypTxt, apflora.tblZiel.ZielTyp;

CREATE OR REPLACE VIEW vZielBer AS
SELECT apflora.tblAp.ApArtId AS "AP Id", apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "AP Art", apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", apflora.tblAp.ApJahr AS "AP Start im Jahr", apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", apflora.tblAdresse.AdrName AS "AP verantwortlich", apflora.tblZiel.ZielId AS "Ziel Id", apflora.tblZiel.ZielJahr AS "Ziel Jahr", domZielTyp.ZieltypTxt AS "Ziel Typ", apflora.tblZiel.ZielBezeichnung AS "Ziel Beschreibung", apflora.tblZielBer.ZielBerId AS "ZielBer Id", apflora.tblZielBer.ZielId AS "ZielBer ZielId", apflora.tblZielBer.ZielBerJahr AS "ZielBer Jahr", apflora.tblZielBer.ZielBerErreichung AS "ZielBer Erreichung", apflora.tblZielBer.ZielBerTxt AS "ZielBer Bemerkungen", apflora.tblZielBer.MutWann AS "ZielBer MutWann", apflora.tblZielBer.MutWer AS "ZielBer MutWer"
FROM ((((((apfloraBeob.ArtenDb_Arteigenschaften RIGHT JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.tblAdresse ON apflora.tblAp.ApBearb = apflora.tblAdresse.AdrId) RIGHT JOIN apflora.tblZiel ON apflora.tblAp.ApArtId = apflora.tblZiel.ApArtId) LEFT JOIN apflora.domZielTyp ON apflora.tblZiel.ZielTyp = domZielTyp.ZieltypId) RIGHT JOIN apflora.tblZielBer ON apflora.tblZiel.ZielId = apflora.tblZielBer.ZielId
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblZiel.ZielJahr, domZielTyp.ZieltypTxt, apflora.tblZiel.ZielTyp, apflora.tblZielBer.ZielBerJahr;

CREATE OR REPLACE VIEW vZielBerOhneZiel AS
SELECT apflora.tblAp.ApArtId AS "AP Id", apflora.tblZiel.ZielId AS "Ziel Id", apflora.tblZielBer.ZielBerId AS "ZielBer Id", apflora.tblZielBer.ZielId AS "ZielBer ZielId", apflora.tblZielBer.ZielBerJahr AS "ZielBer Jahr", apflora.tblZielBer.ZielBerErreichung AS "ZielBer Erreichung", apflora.tblZielBer.ZielBerTxt AS "ZielBer Bemerkungen", apflora.tblZielBer.MutWann AS "ZielBer MutWann", apflora.tblZielBer.MutWer AS "ZielBer MutWer"
FROM ((((((apfloraBeob.ArtenDb_Arteigenschaften RIGHT JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.tblAdresse ON apflora.tblAp.ApBearb = apflora.tblAdresse.AdrId) RIGHT JOIN apflora.tblZiel ON apflora.tblAp.ApArtId = apflora.tblZiel.ApArtId) LEFT JOIN apflora.domZielTyp ON apflora.tblZiel.ZielTyp = domZielTyp.ZieltypId) RIGHT JOIN apflora.tblZielBer ON apflora.tblZiel.ZielId = apflora.tblZielBer.ZielId
WHERE apflora.tblZiel.ZielId is Null
ORDER BY apflora.tblZiel.ZielTyp, apflora.tblZielBer.ZielBerJahr;

CREATE OR REPLACE VIEW vBerTPopFuerAngezeigteArt0 AS
SELECT apflora.tblAp.ApArtId, apflora.tblPop.PopId, apflora.tblTPop.TPopId, apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.domApBearbeitungsstand.DomainTxt AS ApStatus, apflora.tblAp.ApJahr, apflora.domApUmsetzung.DomainTxt AS ApUmsetzung, apflora.tblPop.PopNr, apflora.tblPop.PopName, domPopHerkunft.HerkunftTxt AS PopHerkunft, apflora.tblPop.PopBekanntSeit, apflora.tblTPop.TPopNr, apflora.tblTPop.TPopGemeinde, apflora.tblTPop.TPopFlurname, apflora.tblTPop.TPopXKoord, apflora.tblTPop.TPopYKoord, apflora.tblTPop.TPopBekanntSeit, domPopHerkunft_1.HerkunftTxt AS TPopHerkunft, apflora.tblTPop.TPopApBerichtRelevant
FROM ((((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN ((apflora.tblAp INNER JOIN apflora.tblPop ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN apflora.domPopHerkunft AS domPopHerkunft_1 ON apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId;

CREATE OR REPLACE VIEW vKontr AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Familie, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "AP Art", apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", apflora.tblAp.ApJahr AS "AP Start im Jahr", apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", tblAdresse_1.AdrName AS "AP verantwortlich", apflora.tblPop.PopGuid AS "Pop Guid", apflora.tblPop.PopNr AS "Pop Nr", apflora.tblPop.PopName AS "Pop Name", apflora.domPopHerkunft.HerkunftTxt AS "Pop Herkunft", apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", apflora.tblTPop.TPopId AS "TPop ID", apflora.tblTPop.TPopGuid AS "TPop Guid", apflora.tblTPop.TPopNr AS "TPop Nr", apflora.tblTPop.TPopGemeinde AS "TPop Gemeinde", apflora.tblTPop.TPopFlurname AS "TPop Flurname", domPopHerkunft_1.HerkunftTxt AS "TPop Status", apflora.tblTPop.TPopBekanntSeit AS "TPop bekannt seit", apflora.tblTPop.TPopHerkunftUnklar AS "TPop Status unklar", apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "TPop Begruendung fuer unklaren Status", apflora.tblTPop.TPopXKoord AS "TPop X-Koordinaten", apflora.tblTPop.TPopYKoord AS "TPop Y-Koordinaten", apflora.tblTPop.TPopRadius AS "TPop Radius m", apflora.tblTPop.TPopHoehe AS "TPop Hoehe", apflora.tblTPop.TPopExposition AS "TPop Exposition", apflora.tblTPop.TPopKlima AS "TPop Klima", apflora.tblTPop.TPopNeigung AS "TPop Hangneigung", apflora.tblTPop.TPopBeschr AS "TPop Beschreibung", apflora.tblTPop.TPopKatNr AS "TPop Kataster-Nr", apflora.tblTPop.TPopApBerichtRelevant AS "TPop fuer AP-Bericht relevant", apflora.tblTPop.TPopEigen AS "TPop EigentuemerIn", apflora.tblTPop.TPopKontakt AS "TPop Kontakt vor Ort", apflora.tblTPop.TPopNutzungszone AS "TPop Nutzungszone", apflora.tblTPop.TPopBewirtschafterIn AS "TPop BewirtschafterIn", apflora.tblTPop.TPopBewirtschaftung AS "TPop Bewirtschaftung", apflora.tblTPopKontr.TPopKontrId, apflora.tblTPopKontr.TPopId, apflora.tblTPopKontr.TPopKontrGuid AS "Kontr Guid", apflora.tblTPopKontr.TPopKontrJahr AS "Kontr Jahr", apflora.tblTPopKontr.TPopKontrDatum AS "Kontr Datum", apflora.domTPopFeldkontrTyp.DomainTxt AS "Kontr Typ", apflora.tblAdresse.AdrName AS "Kontr BearbeiterIn", apflora.tblTPopKontr.TPopKontrUeberleb AS "Kontr Ueberlebensrate", apflora.tblTPopKontr.TPopKontrVitalitaet AS "Kontr Vitalitaet", apflora.domPopEntwicklung.EntwicklungTxt AS "Kontr Entwicklung", apflora.tblTPopKontr.TPopKontrUrsach AS "Kontr Ursachen", apflora.tblTPopKontr.TPopKontrUrteil AS "Kontr Erfolgsbeurteilung", apflora.tblTPopKontr.TPopKontrAendUms AS "Kontr Aenderungs-Vorschlaege Umsetzung", apflora.tblTPopKontr.TPopKontrAendKontr AS "Kontr Aenderungs-Vorschlaege Kontrolle", apflora.tblTPop.TPopXKoord AS "Kontr X-Koord", apflora.tblTPop.TPopYKoord AS "Kontr Y-Koord", apflora.tblTPopKontr.TPopKontrTxt AS "Kontr Bemerkungen", apflora.tblTPopKontr.TPopKontrLeb AS "Kontr Lebensraum Delarze", apflora.tblTPopKontr.TPopKontrLebUmg AS "Kontr angrenzender Lebensraum Delarze", apflora.tblTPopKontr.TPopKontrVegTyp AS "Kontr Vegetationstyp", apflora.tblTPopKontr.TPopKontrKonkurrenz AS "Kontr Konkurrenz", apflora.tblTPopKontr.TPopKontrMoosschicht AS "Kontr Moosschicht", apflora.tblTPopKontr.TPopKontrKrautschicht AS "Kontr Krautschicht", apflora.tblTPopKontr.TPopKontrStrauchschicht AS "Kontr Strauchschicht", apflora.tblTPopKontr.TPopKontrBaumschicht AS "Kontr Baumschicht", apflora.tblTPopKontr.TPopKontrBodenTyp AS "Kontr Bodentyp", apflora.tblTPopKontr.TPopKontrBodenKalkgehalt AS "Kontr Boden Kalkgehalt", apflora.tblTPopKontr.TPopKontrBodenDurchlaessigkeit AS "Kontr Boden Durchlaessigkeit", apflora.tblTPopKontr.TPopKontrBodenHumus AS "Kontr Boden Humusgehalt", apflora.tblTPopKontr.TPopKontrBodenNaehrstoffgehalt AS "Kontr Boden Naehrstoffgehalt", apflora.tblTPopKontr.TPopKontrBodenAbtrag AS "Kontr Oberbodenabtrag", apflora.tblTPopKontr.TPopKontrWasserhaushalt AS "Kontr Wasserhaushalt", apflora.domTPopKontrIdBiotUebereinst.DomainTxt AS "Kontr Uebereinstimmung mit Idealbiotop", apflora.tblTPopKontr.TPopKontrHandlungsbedarf AS "Kontr Handlungsbedarf", apflora.tblTPopKontr.TPopKontrUebFlaeche AS "Kontr Ueberpruefte Flaeche", apflora.tblTPopKontr.TPopKontrFlaeche AS "Kontr Flaeche der Teilpopulation m2", apflora.tblTPopKontr.TPopKontrPlan AS "Kontr auf Plan eingezeichnet", apflora.tblTPopKontr.TPopKontrVeg AS "Kontr Deckung durch Vegetation", apflora.tblTPopKontr.TPopKontrNaBo AS "Kontr Deckung nackter Boden", apflora.tblTPopKontr.TPopKontrUebPfl AS "Kontr Deckung durch ueberpruefte Art", apflora.tblTPopKontr.TPopKontrJungPflJN AS "Kontr auch junge Pflanzen", apflora.tblTPopKontr.TPopKontrVegHoeMax AS "Kontr maximale Veg-hoehe cm", apflora.tblTPopKontr.TPopKontrVegHoeMit AS "Kontr mittlere Veg-hoehe cm", apflora.tblTPopKontr.TPopKontrGefaehrdung AS "Kontr Gefaehrdung", apflora.tblTPopKontr.MutWann AS "Kontrolle zuletzt geaendert", apflora.tblTPopKontr.MutWer AS "Kontrolle zuletzt geaendert von"
FROM apflora.domPopHerkunft AS domPopHerkunft_1 RIGHT JOIN (((((((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN (apflora.tblPop INNER JOIN (apflora.tblTPop INNER JOIN (((apflora.tblTPopKontr LEFT JOIN apflora.domTPopFeldkontrTyp ON apflora.tblTPopKontr.TPopKontrTyp = apflora.domTPopFeldkontrTyp.DomainTxt) LEFT JOIN apflora.tblAdresse ON apflora.tblTPopKontr.TPopKontrBearb = apflora.tblAdresse.AdrId) LEFT JOIN apflora.domPopEntwicklung ON apflora.tblTPopKontr.TPopKontrEntwicklung = apflora.domPopEntwicklung.EntwicklungId) ON apflora.tblTPop.TPopId = apflora.tblTPopKontr.TPopId) ON apflora.tblPop.PopId = apflora.tblTPop.PopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = apflora.domPopHerkunft.HerkunftId) LEFT JOIN apflora.domTPopKontrIdBiotUebereinst ON apflora.tblTPopKontr.TPopKontrIdealBiotopUebereinst = apflora.domTPopKontrIdBiotUebereinst.DomainCode) LEFT JOIN apflora.tblAdresse AS tblAdresse_1 ON apflora.tblAp.ApBearb = tblAdresse_1.AdrId) ON domPopHerkunft_1.HerkunftId = apflora.tblTPop.TPopHerkunft
WHERE apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId Not In (100,150)
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr, apflora.tblTPop.TPopNr;

CREATE OR REPLACE VIEW vKontrLetztesJahr AS
SELECT apflora.tblTPop.TPopId, Max(apflora.tblTPopKontr.TPopKontrJahr) AS MaxTPopKontrJahr, Count(apflora.tblTPopKontr.TPopKontrId) AS AnzTPopKontr
FROM apflora.tblTPop INNER JOIN apflora.tblTPopKontr ON apflora.tblTPop.TPopId = apflora.tblTPopKontr.TPopId
WHERE apflora.tblTPopKontr.TPopKontrTyp Not Like "Ziel" And apflora.tblTPopKontr.TPopKontrTyp Not Like "Zwischenziel" AND apflora.tblTPopKontr.TPopKontrJahr IS NOT NULL
GROUP BY apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vKontrLetzteId AS
SELECT apfloraViews.vKontrLetztesJahr.TPopId, Max(apflora.tblTPopKontr.TPopKontrId) AS MaxTPopKontrId, Max(apfloraViews.vKontrLetztesJahr.AnzTPopKontr) AS AnzTPopKontr
FROM apflora.tblTPopKontr INNER JOIN apfloraViews.vKontrLetztesJahr ON (apfloraViews.vKontrLetztesJahr.MaxTPopKontrJahr = apflora.tblTPopKontr.TPopKontrJahr) AND (apflora.tblTPopKontr.TPopId = apfloraViews.vKontrLetztesJahr.TPopId)
GROUP BY apfloraViews.vKontrLetztesJahr.TPopId;

CREATE OR REPLACE VIEW vTPopBerLetztesJahr AS
SELECT apflora.tblTPopKontr.TPopId, Max(apflora.tblTPopBer.TPopBerJahr) AS MaxTPopBerJahr, Count(apflora.tblTPopBer.TPopBerId) AS AnzTPopBer
FROM apflora.tblTPopKontr INNER JOIN apflora.tblTPopBer ON apflora.tblTPopKontr.TPopId = apflora.tblTPopBer.TPopId
WHERE apflora.tblTPopKontr.TPopKontrTyp Not Like "Ziel" And apflora.tblTPopKontr.TPopKontrTyp Not Like "Zwischenziel" AND apflora.tblTPopBer.TPopBerJahr IS NOT NULL
GROUP BY apflora.tblTPopKontr.TPopId;

CREATE OR REPLACE VIEW vTPopBerLetzteId AS
SELECT apfloraViews.vTPopBerLetztesJahr.TPopId, Max(apflora.tblTPopBer.TPopBerId) AS MaxTPopBerId, Avg(apfloraViews.vTPopBerLetztesJahr.AnzTPopBer) AS AnzTPopBer
FROM apflora.tblTPopBer INNER JOIN apfloraViews.vTPopBerLetztesJahr ON (apfloraViews.vTPopBerLetztesJahr.MaxTPopBerJahr = apflora.tblTPopBer.TPopBerJahr) AND (apflora.tblTPopBer.TPopId = apfloraViews.vTPopBerLetztesJahr.TPopId)
GROUP BY apfloraViews.vTPopBerLetztesJahr.TPopId;

CREATE OR REPLACE VIEW vKontrFuerGis AS
SELECT apflora.tblAp.ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS Artname, apflora.domApBearbeitungsstand.DomainTxt AS ApStatus, apflora.tblAp.ApJahr, apflora.domApUmsetzung.DomainTxt AS ApUmsetzung, apflora.tblPop.PopGuid, apflora.tblPop.PopNr, apflora.tblPop.PopName, apflora.domPopHerkunft.HerkunftTxt AS PopHerkunft, apflora.tblPop.PopBekanntSeit, apflora.tblTPop.TPopGuid, apflora.tblTPop.TPopNr, apflora.tblTPop.TPopGemeinde, apflora.tblTPop.TPopFlurname, apflora.tblTPop.TPopXKoord, apflora.tblTPop.TPopYKoord, apflora.tblTPop.TPopBekanntSeit, apflora.tblTPopKontr.TPopKontrGuid, apflora.tblTPopKontr.TPopKontrJahr, apflora.tblTPopKontr.TPopKontrDatum, apflora.domTPopFeldkontrTyp.DomainTxt AS TPopKontrTyp, apflora.tblAdresse.AdrName AS TPopKontrBearb, apflora.tblTPopKontr.TPopKontrUeberleb, apflora.tblTPopKontr.TPopKontrVitalitaet, apflora.domPopEntwicklung.EntwicklungTxt AS TPopKontrEntwicklung, apflora.tblTPopKontr.TPopKontrUrsach, apflora.tblTPopKontr.TPopKontrUrteil, apflora.tblTPopKontr.TPopKontrAendUms, apflora.tblTPopKontr.TPopKontrAendKontr, apflora.tblTPop.TPopXKoord AS X, apflora.tblTPop.TPopYKoord AS Y, apflora.tblTPopKontr.TPopKontrLeb, apflora.tblTPopKontr.TPopKontrFlaeche, apflora.tblTPopKontr.TPopKontrLebUmg, apflora.tblTPopKontr.TPopKontrVegTyp, apflora.tblTPopKontr.TPopKontrKonkurrenz, apflora.tblTPopKontr.TPopKontrMoosschicht, apflora.tblTPopKontr.TPopKontrKrautschicht, apflora.tblTPopKontr.TPopKontrStrauchschicht, apflora.tblTPopKontr.TPopKontrBaumschicht, apflora.tblTPopKontr.TPopKontrBodenTyp, apflora.tblTPopKontr.TPopKontrBodenKalkgehalt, apflora.tblTPopKontr.TPopKontrBodenDurchlaessigkeit, apflora.tblTPopKontr.TPopKontrBodenHumus, apflora.tblTPopKontr.TPopKontrBodenNaehrstoffgehalt, apflora.tblTPopKontr.TPopKontrBodenAbtrag, apflora.tblTPopKontr.TPopKontrWasserhaushalt, apflora.domTPopKontrIdBiotUebereinst.DomainTxt AS TPopKontrIdealBiotopUebereinst, apflora.tblTPopKontr.TPopKontrUebFlaeche, apflora.tblTPopKontr.TPopKontrPlan, apflora.tblTPopKontr.TPopKontrVeg, apflora.tblTPopKontr.TPopKontrNaBo, apflora.tblTPopKontr.TPopKontrUebPfl, apflora.tblTPopKontr.TPopKontrJungPflJN, apflora.tblTPopKontr.TPopKontrVegHoeMax, apflora.tblTPopKontr.TPopKontrVegHoeMit, apflora.tblTPopKontr.TPopKontrGefaehrdung, apflora.tblTPopKontr.MutWann, apflora.tblTPopKontr.MutWer
FROM (((((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN (apflora.tblPop INNER JOIN (apflora.tblTPop INNER JOIN (((apflora.tblTPopKontr LEFT JOIN apflora.domTPopFeldkontrTyp ON apflora.tblTPopKontr.TPopKontrTyp = apflora.domTPopFeldkontrTyp.DomainTxt) LEFT JOIN apflora.tblAdresse ON apflora.tblTPopKontr.TPopKontrBearb = apflora.tblAdresse.AdrId) LEFT JOIN apflora.domPopEntwicklung ON apflora.tblTPopKontr.TPopKontrEntwicklung = apflora.domPopEntwicklung.EntwicklungId) ON apflora.tblTPop.TPopId = apflora.tblTPopKontr.TPopId) ON apflora.tblPop.PopId = apflora.tblTPop.PopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = apflora.domPopHerkunft.HerkunftId) LEFT JOIN apflora.domTPopKontrIdBiotUebereinst ON apflora.tblTPopKontr.TPopKontrIdealBiotopUebereinst = apflora.domTPopKontrIdBiotUebereinst.DomainCode
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr, apflora.tblTPop.TPopNr, apflora.tblTPopKontr.TPopKontrJahr, apflora.tblTPopKontr.TPopKontrDatum;


CREATE OR REPLACE VIEW vKontrOhneTPop AS
SELECT apflora.tblTPopKontr.TPopKontrGuid AS "Kontr Guid", apflora.tblTPopKontr.TPopKontrJahr AS "Kontr Jahr", apflora.tblTPopKontr.TPopKontrDatum AS "Kontr Datum", apflora.domTPopFeldkontrTyp.DomainTxt AS "Kontr Typ", apflora.tblAdresse.AdrName AS "Kontr BearbeiterIn", apflora.tblTPopKontr.TPopKontrUeberleb AS "Kontr Ueberlebensrate", apflora.tblTPopKontr.TPopKontrVitalitaet AS "Kontr Vitalitaet", apflora.domPopEntwicklung.EntwicklungTxt AS "Kontr Entwicklung", apflora.tblTPopKontr.TPopKontrUrsach AS "Kontr Ursachen", apflora.tblTPopKontr.TPopKontrUrteil AS "Kontr Erfolgsbeurteilung", apflora.tblTPopKontr.TPopKontrAendUms AS "Kontr Aenderungs-Vorschlaege Umsetzung", apflora.tblTPopKontr.TPopKontrAendKontr AS "Kontr Aenderungs-Vorschlaege Kontrolle", apflora.tblTPop.TPopXKoord AS "Kontr X-Koord", apflora.tblTPop.TPopYKoord AS "Kontr Y-Koord", apflora.tblTPopKontr.TPopKontrTxt AS "Kontr Bemerkungen", apflora.tblTPopKontr.TPopKontrLeb AS "Kontr Lebensraum Delarze", apflora.tblTPopKontr.TPopKontrLebUmg AS "Kontr angrenzender Lebensraum Delarze", apflora.tblTPopKontr.TPopKontrVegTyp AS "Kontr Vegetationstyp", apflora.tblTPopKontr.TPopKontrKonkurrenz AS "Kontr Konkurrenz", apflora.tblTPopKontr.TPopKontrMoosschicht AS "Kontr Moosschicht", apflora.tblTPopKontr.TPopKontrKrautschicht AS "Kontr Krautschicht", apflora.tblTPopKontr.TPopKontrStrauchschicht AS "Kontr Strauchschicht", apflora.tblTPopKontr.TPopKontrBaumschicht AS "Kontr Baumschicht", apflora.tblTPopKontr.TPopKontrBodenTyp AS "Kontr Bodentyp", apflora.tblTPopKontr.TPopKontrBodenKalkgehalt AS "Kontr Boden Kalkgehalt", apflora.tblTPopKontr.TPopKontrBodenDurchlaessigkeit AS "Kontr Boden Durchlaessigkeit", apflora.tblTPopKontr.TPopKontrBodenHumus AS "Kontr Boden Humusgehalt", apflora.tblTPopKontr.TPopKontrBodenNaehrstoffgehalt AS "Kontr Boden Naehrstoffgehalt", apflora.tblTPopKontr.TPopKontrBodenAbtrag AS "Kontr Oberbodenabtrag", apflora.tblTPopKontr.TPopKontrWasserhaushalt AS "Kontr Wasserhaushalt", apflora.domTPopKontrIdBiotUebereinst.DomainTxt AS "Kontr Uebereinstimmung mit Idealbiotop", apflora.tblTPopKontr.TPopKontrHandlungsbedarf AS "Kontr Handlungsbedarf", apflora.tblTPopKontr.TPopKontrUebFlaeche AS "Kontr Ueberpruefte Flaeche", apflora.tblTPopKontr.TPopKontrFlaeche AS "Kontr Flaeche der Teilpopulation m2", apflora.tblTPopKontr.TPopKontrPlan AS "Kontr auf Plan eingezeichnet", apflora.tblTPopKontr.TPopKontrVeg AS "Kontr Deckung durch Vegetation", apflora.tblTPopKontr.TPopKontrNaBo AS "Kontr Deckung nackter Boden", apflora.tblTPopKontr.TPopKontrUebPfl AS "Kontr Deckung durch ueberpruefte Art", apflora.tblTPopKontr.TPopKontrJungPflJN AS "Kontr auch junge Pflanzen", apflora.tblTPopKontr.TPopKontrVegHoeMax AS "Kontr maximale Veg-hoehe cm", apflora.tblTPopKontr.TPopKontrVegHoeMit AS "Kontr mittlere Veg-hoehe cm", apflora.tblTPopKontr.TPopKontrGefaehrdung AS "Kontr Gefaehrdung", apflora.tblTPopKontr.MutWann AS "Datensatz zuletzt geaendert", apflora.tblTPopKontr.MutWer AS "Datensatz zuletzt geaendert von"
FROM (apflora.tblTPop RIGHT JOIN (((apflora.tblTPopKontr LEFT JOIN apflora.domTPopFeldkontrTyp ON apflora.tblTPopKontr.TPopKontrTyp = apflora.domTPopFeldkontrTyp.DomainTxt) LEFT JOIN apflora.tblAdresse ON apflora.tblTPopKontr.TPopKontrBearb = apflora.tblAdresse.AdrId) LEFT JOIN apflora.domPopEntwicklung ON apflora.tblTPopKontr.TPopKontrEntwicklung = apflora.domPopEntwicklung.EntwicklungId) ON apflora.tblTPop.TPopId = apflora.tblTPopKontr.TPopId) LEFT JOIN apflora.domTPopKontrIdBiotUebereinst ON apflora.tblTPopKontr.TPopKontrIdealBiotopUebereinst = apflora.domTPopKontrIdBiotUebereinst.DomainCode
WHERE apflora.tblTPop.TPopId Is Null;

CREATE OR REPLACE VIEW vBeob AS
SELECT apfloraBeob.tblBeobInfospezies.NO_NOTE, "" AS "ID_EVAB", apfloraBeob.tblBeobInfospezies.NO_ISFS, apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopGuid, apflora.tblPop.PopNr, apflora.tblTPop.TPopGuid, apflora.tblTPop.TPopNr, apfloraBeob.tblBeobInfospezies.PROJET, apfloraBeob.tblBeobInfospezies.NOM_COMMUNE, apfloraBeob.tblBeobInfospezies.DESC_LOCALITE, apfloraBeob.tblBeobInfospezies.FNS_XGIS AS X, apfloraBeob.tblBeobInfospezies.FNS_YGIS AS Y, IF (apfloraBeob.tblBeobInfospezies.FNS_XGIS>0 AND apflora.tblTPop.TPopXKoord>0 AND apfloraBeob.tblBeobInfospezies.FNS_YGIS>0 AND apflora.tblTPop.TPopYKoord>0, ROUND(SQRT((apfloraBeob.tblBeobInfospezies.FNS_XGIS-apflora.tblTPop.TPopXKoord)*(apfloraBeob.tblBeobInfospezies.FNS_XGIS-apflora.tblTPop.TPopXKoord)+(apfloraBeob.tblBeobInfospezies.FNS_YGIS-apflora.tblTPop.TPopYKoord)*(apfloraBeob.tblBeobInfospezies.FNS_YGIS-apflora.tblTPop.TPopYKoord)), 0), null) AS "Distanz zur Teilpopulation (m)"
, apfloraBeob.tblBeobBereitgestellt.Datum, apfloraBeob.tblBeobBereitgestellt.Autor, apflora.tblBeobZuordnung.beobNichtZuordnen, apflora.tblBeobZuordnung.BeobBemerkungen, apflora.tblBeobZuordnung.BeobMutWann, apflora.tblBeobZuordnung.BeobMutWer 
FROM ((apfloraBeob.tblBeobInfospezies INNER JOIN apfloraBeob.tblBeobBereitgestellt ON apfloraBeob.tblBeobInfospezies.NO_NOTE = apfloraBeob.tblBeobBereitgestellt.NO_NOTE) INNER JOIN apfloraBeob.ArtenDb_Arteigenschaften ON apfloraBeob.tblBeobInfospezies.NO_ISFS = apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId) INNER JOIN ((apflora.tblPop RIGHT JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) RIGHT JOIN apflora.tblBeobZuordnung ON apflora.tblTPop.TPopId = apflora.tblBeobZuordnung.TPopId) ON apfloraBeob.tblBeobInfospezies.NO_NOTE = apflora.tblBeobZuordnung.NO_NOTE 
UNION SELECT "" AS "NO_NOTE", apfloraBeob.tblBeobEvab.NO_NOTE_PROJET AS "ID_EVAB", apfloraBeob.tblBeobEvab.NO_ISFS, apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopGuid, apflora.tblPop.PopNr, apflora.tblTPop.TPopGuid, apflora.tblTPop.TPopNr, apfloraBeob.tblBeobEvab.Projekt_ZH AS PROJET, apfloraBeob.tblBeobEvab.NOM_COMMUNE, apfloraBeob.tblBeobEvab.DESC_LOCALITE_ AS DESC_LOCALITE, apfloraBeob.tblBeobEvab.COORDONNEE_FED_E AS X, apfloraBeob.tblBeobEvab.COORDONNEE_FED_N AS Y, IF (apfloraBeob.tblBeobEvab.COORDONNEE_FED_E>0 AND apflora.tblTPop.TPopXKoord>0 AND apfloraBeob.tblBeobEvab.COORDONNEE_FED_N>0 AND apflora.tblTPop.TPopYKoord>0, ROUND(SQRT((apfloraBeob.tblBeobEvab.COORDONNEE_FED_E-apflora.tblTPop.TPopXKoord)*(apfloraBeob.tblBeobEvab.COORDONNEE_FED_E-apflora.tblTPop.TPopXKoord)+(apfloraBeob.tblBeobEvab.COORDONNEE_FED_N-apflora.tblTPop.TPopYKoord)*(apfloraBeob.tblBeobEvab.COORDONNEE_FED_N-apflora.tblTPop.TPopYKoord)), 0), null) AS "Distanz zur Teilpopulation (m)", apfloraBeob.tblBeobBereitgestellt.Datum, apfloraBeob.tblBeobBereitgestellt.Autor, apflora.tblBeobZuordnung.beobNichtZuordnen, apflora.tblBeobZuordnung.BeobBemerkungen, apflora.tblBeobZuordnung.BeobMutWann, apflora.tblBeobZuordnung.BeobMutWer 
FROM ((apfloraBeob.tblBeobBereitgestellt INNER JOIN apfloraBeob.tblBeobEvab ON apfloraBeob.tblBeobBereitgestellt.NO_NOTE_PROJET = apfloraBeob.tblBeobEvab.NO_NOTE_PROJET) INNER JOIN ((apflora.tblPop RIGHT JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) RIGHT JOIN apflora.tblBeobZuordnung ON apflora.tblTPop.TPopId = apflora.tblBeobZuordnung.TPopId) ON apfloraBeob.tblBeobEvab.NO_NOTE_PROJET = apflora.tblBeobZuordnung.NO_NOTE) INNER JOIN apfloraBeob.ArtenDb_Arteigenschaften ON apfloraBeob.tblBeobEvab.NO_ISFS = apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId 
ORDER BY Artname ASC, PopNr ASC, TPopNr ASC, Datum DESC;

CREATE OR REPLACE VIEW vExportNachEvab_Alle AS 
SELECT apfloraBeob.ArtenDb_Arteigenschaften.GUID AS "Projekt_Id", CONCAT("AP Flora ZH: ", apfloraBeob.ArtenDb_Arteigenschaften.Artname) AS "Projekt_Name", CAST(IF(apflora.tblAp.ApJahr Is Not Null,CONCAT("01.01.", apflora.tblAp.ApJahr),"") AS CHAR) AS "Projekt_Eroeffnung", "Topos" AS "Projekt_Autor", CAST(CONCAT("Aktionsplan: ", apflora.domApBearbeitungsstand.DomainTxt, IF(apflora.tblAp.ApJahr Is Not Null,CONCAT("; Start im Jahr: ", apflora.tblAp.ApJahr),""), IF(apflora.tblAp.ApUmsetzung Is Not Null,CONCAT("; Stand Umsetzung: ", apflora.domApUmsetzung.DomainTxt),"")) AS CHAR) AS "Projekt_Bemerkungen", apflora.tblPop.PopGuid AS "Raum_Id", CAST(CONCAT(apflora.tblPop.PopName, IF(apflora.tblPop.PopNr Is Not Null,CONCAT(" (Nr. ", apflora.tblPop.PopNr, ")"),"")) AS CHAR) AS "Raum_Name", CAST(IF(apflora.tblPop.PopHerkunft Is Not Null,CONCAT("Status: ", domPopHerkunft.HerkunftTxt, IF(apflora.tblPop.PopBekanntSeit Is Not Null,CONCAT("; Bekannt seit: ", apflora.tblPop.PopBekanntSeit),"")),"") AS CHAR) AS "Raum_Bemerkungen", apflora.tblTPop.TPopGuid AS "Ort_Id", CAST(CONCAT(apflora.tblTPop.TPopFlurname, IF(apflora.tblTPop.TPopNr Is Not Null,CONCAT(" (Nr. ", apflora.tblTPop.TPopNr, ")"),"")) AS CHAR) AS "Ort_Name", apflora.tblTPop.TPopHoehe AS "Ort_ObergrenzeHoehe", apflora.tblTPop.TPopXKoord AS "Ort_X", apflora.tblTPop.TPopYKoord AS "Ort_Y", "+-20m" AS "Ort_Genauigkeit", apflora.tblTPop.TPopGemeinde AS "Ort_Gemeinde", apflora.tblTPop.TPopFlurname AS "Ort_Flurname", apflora.tblTPop.TPopExposition AS "Ort_Exposition", apflora.tblTPop.TPopNeigung AS "Ort_Hangneigung", apflora.tblTPopKontr.TPopKontrLeb AS "Ort_Lebensraum", apflora.tblTPopKontr.TPopKontrLebUmg AS "Ort_UmgebungDelarze", apflora.tblTPopKontr.ZeitGuid AS "Zeit_Id", CAST(IF(apflora.tblTPopKontr.TPopKontrDatum Is Not Null,CONCAT(apflora.tblTPopKontr.TPopKontrDatum,"01.01.", apflora.tblTPopKontr.TPopKontrJahr),"") AS CHAR) AS "Zeit_Datum", CAST(IF(apflora.tblTPopKontr.TPopKontrDatum Is Not Null,"Tag","Jahr") AS CHAR) AS "Zeit_GenauigkeitDatum", apflora.tblTPopKontr.TPopKontrMoosschicht AS "Zeit_DeckungMoose", apflora.tblTPopKontr.TPopKontrKrautschicht AS "Zeit_DeckungKraeuter", apflora.tblTPopKontr.TPopKontrStrauchschicht AS "Zeit_DeckungStraeucher", apflora.tblTPopKontr.TPopKontrBaumschicht AS "Zeit_DeckungBaeume", apflora.tblTPopKontr.TPopKontrGuid AS "Beob_Id", apflora.tblAdresse.AdrName AS "Beob_BeobachterinName", apflora.tblAp.ApArtId AS "Beob_NR", apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "Beob_WissenschArtname", apfloraBeob.ArtenDb_Arteigenschaften.NameDeutsch AS "Beob_DeutscherArtname", "Feldbeobachtung" AS "Beob_TypDerMeldung", domPopHerkunft_1.ZdsfHerkunft AS "Beob_Herkunft", domPopHerkunft_1.ZdsfVorhanden AS "Beob_Vorhandensein", apflora.tblTPopKontr.TPopKontrGefaehrdung AS "Beob_Gefaehrdung", apflora.tblTPopKontr.TPopKontrVitalitaet AS "Beob_VitalitaetPflanze", apflora.tblTPop.TPopBeschr AS "Beob_BeschreibungStandort"
FROM ((((((((apflora.tblAp INNER JOIN apflora.tblPop ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN apflora.tblTPopKontr ON apflora.tblTPop.TPopId = apflora.tblTPopKontr.TPopId) INNER JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) INNER JOIN apfloraBeob.ArtenDb_Arteigenschaften ON apflora.tblAp.ApArtId = apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN apflora.tblAdresse ON apflora.tblTPopKontr.TPopKontrBearb = apflora.tblAdresse.AdrId) LEFT JOIN apflora.domPopHerkunft AS domPopHerkunft_1 ON apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId
WHERE ((apflora.tblTPop.TPopXKoord Is Not Null) AND (apflora.tblTPop.TPopYKoord Is Not Null) AND (apflora.tblTPopKontr.TPopKontrDatum Is Not Null) AND (apflora.tblTPopKontr.TPopKontrTyp="Zwischenbeurteilung" Or apflora.tblTPopKontr.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (apflora.tblTPop.TPopHerkunft<>201)) OR ((apflora.tblTPop.TPopXKoord Is Not Null) AND (apflora.tblTPop.TPopYKoord Is Not Null) AND (apflora.tblTPopKontr.TPopKontrTyp="Zwischenbeurteilung" Or apflora.tblTPopKontr.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (apflora.tblTPop.TPopHerkunft<>201) AND (apflora.tblTPopKontr.TPopKontrJahr Is Not Null))
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, CONCAT(apflora.tblPop.PopName, IF(apflora.tblPop.PopNr Is Not Null,CONCAT(" (Nr. ", apflora.tblPop.PopNr, ")"),"")), CONCAT(apflora.tblTPop.TPopFlurname, IF(apflora.tblTPop.TPopNr Is Not Null,CONCAT(" (Nr. ", apflora.tblTPop.TPopNr, ")"),"")), IF(apflora.tblTPopKontr.TPopKontrDatum Is Not Null, apflora.tblTPopKontr.TPopKontrDatum,CONCAT("01.01.", apflora.tblTPopKontr.TPopKontrJahr)), apfloraBeob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vExportNachEvab_Beob AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.GUID AS Projekt_Id, apflora.tblPop.PopGuid AS Raum_Id, apflora.tblTPop.TPopGuid AS Ort_Id, apflora.tblTPopKontr.ZeitGuid AS Zeit_Id, apflora.tblTPopKontr.TPopKontrGuid AS Beob_Id, apflora.tblAdresse.AdrName AS Beob_BeobachterinName, apflora.tblAp.ApArtId AS Beob_NR, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS Beob_WissenschArtname, apfloraBeob.ArtenDb_Arteigenschaften.NameDeutsch AS Beob_DeutscherArtname, "Feldbeobachtung" AS Beob_TypDerMeldung, domPopHerkunft_1.ZdsfHerkunft AS Beob_Herkunft, domPopHerkunft_1.ZdsfVorhanden AS Beob_Vorhandensein, apflora.tblTPopKontr.TPopKontrGefaehrdung AS Beob_Gefaehrdung, apflora.tblTPopKontr.TPopKontrVitalitaet AS Beob_VitalitaetPflanze, apflora.tblTPop.TPopBeschr AS Beob_BeschreibungStandort
FROM ((((((((apflora.tblAp INNER JOIN apflora.tblPop ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN apflora.tblTPopKontr ON apflora.tblTPop.TPopId = apflora.tblTPopKontr.TPopId) INNER JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) INNER JOIN apfloraBeob.ArtenDb_Arteigenschaften ON apflora.tblAp.ApArtId = apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN apflora.tblAdresse ON apflora.tblTPopKontr.TPopKontrBearb = apflora.tblAdresse.AdrId) LEFT JOIN apflora.domPopHerkunft AS domPopHerkunft_1 ON apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId
WHERE (((apflora.tblTPop.TPopXKoord) Is Not Null) AND ((apflora.tblTPop.TPopYKoord) Is Not Null)) OR (((apflora.tblTPop.TPopXKoord) Is Not Null) AND ((apflora.tblTPop.TPopYKoord) Is Not Null))
GROUP BY apfloraBeob.ArtenDb_Arteigenschaften.GUID, apflora.tblPop.PopGuid, apflora.tblTPop.TPopGuid, apflora.tblTPopKontr.ZeitGuid, apflora.tblTPopKontr.TPopKontrGuid, apflora.tblAdresse.AdrName, apflora.tblAp.ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname, apfloraBeob.ArtenDb_Arteigenschaften.NameDeutsch, "Feldbeobachtung", domPopHerkunft_1.ZdsfHerkunft, domPopHerkunft_1.ZdsfVorhanden, apflora.tblTPopKontr.TPopKontrGefaehrdung, apflora.tblTPopKontr.TPopKontrVitalitaet, apflora.tblTPop.TPopBeschr, apflora.tblTPopKontr.TPopKontrDatum, apflora.tblTPopKontr.TPopKontrTyp, apflora.tblTPop.TPopHerkunft, apflora.tblTPopKontr.TPopKontrJahr
HAVING (((apflora.tblTPopKontr.TPopKontrDatum) Is Not Null) AND ((apflora.tblTPopKontr.TPopKontrTyp)="Zwischenbeurteilung" Or (apflora.tblTPopKontr.TPopKontrTyp)="Freiwilligen-Erfolgskontrolle") AND (apflora.tblTPop.TPopHerkunft<>201)) OR ((apflora.tblTPopKontr.TPopKontrTyp="Zwischenbeurteilung" Or apflora.tblTPopKontr.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (apflora.tblTPop.TPopHerkunft<>201) AND (apflora.tblTPopKontr.TPopKontrJahr Is Not Null))
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vExportNachEvab_Zeit AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.GUID AS Projekt_Id, apflora.tblPop.PopGuid AS Raum_Id, apflora.tblTPop.TPopGuid AS Ort_Id, apflora.tblTPopKontr.ZeitGuid AS Zeit_Id, CAST(IF(apflora.tblTPopKontr.TPopKontrDatum Is Not Null, apflora.tblTPopKontr.TPopKontrDatum,CONCAT("01.01." + apflora.tblTPopKontr.TPopKontrJahr)) AS CHAR) AS Zeit_Datum, IF(apflora.tblTPopKontr.TPopKontrDatum Is Not Null,"Tag","Jahr") AS Zeit_GenauigkeitDatum, apflora.tblTPopKontr.TPopKontrMoosschicht AS Zeit_DeckungMoose, apflora.tblTPopKontr.TPopKontrKrautschicht AS Zeit_DeckungKraeuter, apflora.tblTPopKontr.TPopKontrStrauchschicht AS Zeit_DeckungStraeucher, apflora.tblTPopKontr.TPopKontrBaumschicht AS Zeit_DeckungBaeume
FROM ((((((((apflora.tblAp INNER JOIN apflora.tblPop ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN apflora.tblTPopKontr ON apflora.tblTPop.TPopId = apflora.tblTPopKontr.TPopId) INNER JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) INNER JOIN apfloraBeob.ArtenDb_Arteigenschaften ON apflora.tblAp.ApArtId = apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN apflora.tblAdresse ON apflora.tblTPopKontr.TPopKontrBearb = apflora.tblAdresse.AdrId) LEFT JOIN apflora.domPopHerkunft AS domPopHerkunft_1 ON apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId
WHERE ((apflora.tblTPop.TPopXKoord Is Not Null) AND (apflora.tblTPop.TPopYKoord Is Not Null) AND (apflora.tblTPopKontr.TPopKontrDatum Is Not Null) AND (apflora.tblTPopKontr.TPopKontrTyp="Zwischenbeurteilung" Or apflora.tblTPopKontr.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (apflora.tblTPop.TPopHerkunft<>201)) OR ((apflora.tblTPop.TPopXKoord Is Not Null) AND (apflora.tblTPop.TPopYKoord Is Not Null) AND (apflora.tblTPopKontr.TPopKontrTyp="Zwischenbeurteilung" Or apflora.tblTPopKontr.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (apflora.tblTPop.TPopHerkunft<>201) AND (apflora.tblTPopKontr.TPopKontrJahr Is Not Null))
GROUP BY apfloraBeob.ArtenDb_Arteigenschaften.GUID, apflora.tblPop.PopGuid, apflora.tblTPop.TPopGuid, apflora.tblTPopKontr.ZeitGuid, IF(apflora.tblTPopKontr.TPopKontrDatum Is Not Null, apflora.tblTPopKontr.TPopKontrDatum,CONCAT("01.01." + apflora.tblTPopKontr.TPopKontrJahr)), IF(apflora.tblTPopKontr.TPopKontrDatum Is Not Null,"Tag","Jahr"), apflora.tblTPopKontr.TPopKontrMoosschicht, apflora.tblTPopKontr.TPopKontrKrautschicht, apflora.tblTPopKontr.TPopKontrStrauchschicht, apflora.tblTPopKontr.TPopKontrBaumschicht
ORDER BY IF(apflora.tblTPopKontr.TPopKontrDatum Is Not Null, apflora.tblTPopKontr.TPopKontrDatum, apflora.tblTPopKontr.TPopKontrJahr);

CREATE OR REPLACE VIEW vExportNachEvab_Ort AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.GUID AS Projekt_Id, apflora.tblPop.PopGuid AS Raum_Id, apflora.tblTPop.TPopGuid AS Ort_Id, CAST(CONCAT(apflora.tblTPop.TPopFlurname, IF(apflora.tblTPop.TPopNr Is Not Null,CONCAT(" (Nr. ", apflora.tblTPop.TPopNr, ")"),"")) AS CHAR) AS Ort_Name, apflora.tblTPop.TPopHoehe AS Ort_ObergrenzeHoehe, apflora.tblTPop.TPopXKoord AS Ort_X, apflora.tblTPop.TPopYKoord AS Ort_Y, "+-20m" AS Ort_Genauigkeit, apflora.tblTPop.TPopGemeinde AS Ort_Gemeinde, apflora.tblTPop.TPopFlurname AS Ort_Flurname, apflora.tblTPop.TPopExposition AS Ort_Exposition, apflora.tblTPop.TPopNeigung AS Ort_Hangneigung, apflora.tblTPopKontr.TPopKontrLeb AS Ort_Lebensraum, apflora.tblTPopKontr.TPopKontrLebUmg AS Ort_UmgebungDelarze
FROM ((((((((apflora.tblAp INNER JOIN apflora.tblPop ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN apflora.tblTPopKontr ON apflora.tblTPop.TPopId = apflora.tblTPopKontr.TPopId) INNER JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) INNER JOIN apfloraBeob.ArtenDb_Arteigenschaften ON apflora.tblAp.ApArtId = apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN apflora.tblAdresse ON apflora.tblTPopKontr.TPopKontrBearb = apflora.tblAdresse.AdrId) LEFT JOIN apflora.domPopHerkunft AS domPopHerkunft_1 ON apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId
WHERE (apflora.tblTPopKontr.TPopKontrDatum Is Not Null AND (apflora.tblTPopKontr.TPopKontrTyp="Zwischenbeurteilung" Or apflora.tblTPopKontr.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND apflora.tblTPop.TPopHerkunft<>201) OR ((apflora.tblTPopKontr.TPopKontrTyp="Zwischenbeurteilung" Or apflora.tblTPopKontr.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND apflora.tblTPop.TPopHerkunft<>201 AND apflora.tblTPopKontr.TPopKontrJahr Is Not Null)
GROUP BY apfloraBeob.ArtenDb_Arteigenschaften.GUID, apflora.tblPop.PopGuid, apflora.tblTPop.TPopGuid, CONCAT(apflora.tblTPop.TPopFlurname, IF(apflora.tblTPop.TPopNr Is Not Null,CONCAT(" (Nr. ", apflora.tblTPop.TPopNr, ")"),"")), apflora.tblTPop.TPopHoehe, apflora.tblTPop.TPopXKoord, apflora.tblTPop.TPopYKoord, "+-20m", apflora.tblTPop.TPopGemeinde, apflora.tblTPop.TPopFlurname, apflora.tblTPop.TPopExposition, apflora.tblTPop.TPopNeigung, apflora.tblTPopKontr.TPopKontrLeb, apflora.tblTPopKontr.TPopKontrLebUmg
HAVING (apflora.tblTPop.TPopXKoord Is Not Null AND apflora.tblTPop.TPopYKoord Is Not Null) OR (apflora.tblTPop.TPopXKoord Is Not Null AND apflora.tblTPop.TPopYKoord Is Not Null)
ORDER BY apflora.tblTPop.TPopFlurname, apflora.tblTPop.TPopNr;

CREATE OR REPLACE VIEW vExportNachEvab_Raum AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.GUID AS Projekt_Id, apflora.tblPop.PopGuid AS Raum_Id, CAST(CONCAT(apflora.tblPop.PopName, IF(apflora.tblPop.PopNr Is Not Null,CONCAT(" (Nr. ", apflora.tblPop.PopNr, ")"),"")) AS CHAR) AS Raum_Name, CAST(IF(apflora.tblPop.PopHerkunft Is Not Null,CONCAT("Status: ", domPopHerkunft.HerkunftTxt, IF(apflora.tblPop.PopBekanntSeit Is Not Null,CONCAT("; Bekannt seit: ", apflora.tblPop.PopBekanntSeit),"")),"") AS CHAR) AS Raum_Bemerkungen
FROM ((((((((apflora.tblAp INNER JOIN apflora.tblPop ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN apflora.tblTPopKontr ON apflora.tblTPop.TPopId = apflora.tblTPopKontr.TPopId) INNER JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) INNER JOIN apfloraBeob.ArtenDb_Arteigenschaften ON apflora.tblAp.ApArtId = apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN apflora.tblAdresse ON apflora.tblTPopKontr.TPopKontrBearb = apflora.tblAdresse.AdrId) LEFT JOIN apflora.domPopHerkunft AS domPopHerkunft_1 ON apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId
WHERE ((apflora.tblTPopKontr.TPopKontrDatum Is Not Null) AND (apflora.tblTPopKontr.TPopKontrTyp="Zwischenbeurteilung" Or apflora.tblTPopKontr.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (apflora.tblTPop.TPopHerkunft<>201) AND (apflora.tblTPop.TPopXKoord Is Not Null) AND (apflora.tblTPop.TPopYKoord Is Not Null)) OR ((apflora.tblTPopKontr.TPopKontrTyp="Zwischenbeurteilung" Or apflora.tblTPopKontr.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (apflora.tblTPop.TPopHerkunft<>201) AND (apflora.tblTPop.TPopXKoord Is Not Null) AND (apflora.tblTPop.TPopYKoord Is Not Null) AND (apflora.tblTPopKontr.TPopKontrJahr Is Not Null))
GROUP BY apfloraBeob.ArtenDb_Arteigenschaften.GUID, apflora.tblPop.PopGuid, CONCAT(apflora.tblPop.PopName, IF(apflora.tblPop.PopNr Is Not Null,CONCAT(" (Nr. ", apflora.tblPop.PopNr, ")"),"")), IF(apflora.tblPop.PopHerkunft Is Not Null,CONCAT("Status: ", domPopHerkunft.HerkunftTxt, IF(apflora.tblPop.PopBekanntSeit Is Not Null,CONCAT("; Bekannt seit: ", apflora.tblPop.PopBekanntSeit), "")),"")
ORDER BY apflora.tblPop.PopName, apflora.tblPop.PopNr;

CREATE OR REPLACE VIEW vExportNachEvab_Projekt AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.GUID AS Projekt_Id, CONCAT("AP Flora ZH: ", apfloraBeob.ArtenDb_Arteigenschaften.Artname) AS Projekt_Name, CAST(IF(apflora.tblAp.ApJahr Is Not Null,CONCAT("01.01.", apflora.tblAp.ApJahr),"") AS CHAR) AS Projekt_Eroeffnung, "Topos" AS Projekt_Autor, CAST(CONCAT("Aktionsplan: ", apflora.domApBearbeitungsstand.DomainTxt, IF(apflora.tblAp.ApJahr Is Not Null,CONCAT("; Start im Jahr: ", apflora.tblAp.ApJahr),""), IF(apflora.tblAp.ApUmsetzung Is Not Null,CONCAT("; Stand Umsetzung: ", apflora.domApUmsetzung.DomainTxt),""),"") AS CHAR) AS Projekt_Bemerkungen
FROM ((((((((apflora.tblAp INNER JOIN apflora.tblPop ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) INNER JOIN apflora.tblTPopKontr ON apflora.tblTPop.TPopId = apflora.tblTPopKontr.TPopId) INNER JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) INNER JOIN apfloraBeob.ArtenDb_Arteigenschaften ON apflora.tblAp.ApArtId = apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN apflora.tblAdresse ON apflora.tblTPopKontr.TPopKontrBearb = apflora.tblAdresse.AdrId) LEFT JOIN apflora.domPopHerkunft AS domPopHerkunft_1 ON apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId
WHERE ((apflora.tblTPopKontr.TPopKontrDatum Is Not Null) AND (apflora.tblTPopKontr.TPopKontrTyp="Zwischenbeurteilung" Or apflora.tblTPopKontr.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (apflora.tblTPop.TPopHerkunft<>201) AND (apflora.tblTPop.TPopXKoord Is Not Null) AND (apflora.tblTPop.TPopYKoord Is Not Null)) OR ((apflora.tblTPopKontr.TPopKontrTyp="Zwischenbeurteilung" Or apflora.tblTPopKontr.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (apflora.tblTPop.TPopHerkunft<>201) AND (apflora.tblTPop.TPopXKoord Is Not Null) AND (apflora.tblTPop.TPopYKoord Is Not Null) AND (apflora.tblTPopKontr.TPopKontrJahr Is Not Null))
GROUP BY apfloraBeob.ArtenDb_Arteigenschaften.GUID, CONCAT("AP Flora ZH: ", apfloraBeob.ArtenDb_Arteigenschaften.Artname), IF(apflora.tblAp.ApJahr Is Not Null,CONCAT("01.01.", apflora.tblAp.ApJahr),""), "Topos", CONCAT("Aktionsplan: ", apflora.domApBearbeitungsstand.DomainTxt, IF(apflora.tblAp.ApJahr Is Not Null,CONCAT("; Start im Jahr: ", apflora.tblAp.ApJahr),""), IF(apflora.tblAp.ApUmsetzung Is Not Null,CONCAT("; Stand Umsetzung: ", apflora.domApUmsetzung.DomainTxt), ""))
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vTPopMassnBer AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "AP Art", apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", apflora.tblAp.ApJahr AS "AP Start im Jahr", apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", apflora.tblPop.PopGuid AS "Pop Guid", apflora.tblPop.PopNr AS "Pop Nr", apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begruendung fuer unklaren Status", apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", apflora.tblTPop.TPopId AS "TPop ID", apflora.tblTPop.TPopGuid AS "TPop Guid", apflora.tblTPop.TPopNr AS "TPop Nr", apflora.tblTPop.TPopGemeinde AS "TPop Gemeinde", apflora.tblTPop.TPopFlurname AS "TPop Flurname", domPopHerkunft_1.HerkunftTxt AS "TPop Status", apflora.tblTPop.TPopBekanntSeit AS "TPop bekannt seit", apflora.tblTPop.TPopHerkunftUnklar AS "TPop Status unklar", apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "TPop Begruendung fuer unklaren Status", apflora.tblTPop.TPopXKoord AS "TPop X-Koordinaten", apflora.tblTPop.TPopYKoord AS "TPop Y-Koordinaten", apflora.tblTPop.TPopRadius AS "TPop Radius (m)", apflora.tblTPop.TPopHoehe AS "TPop Hoehe", apflora.tblTPop.TPopExposition AS "TPop Exposition", apflora.tblTPop.TPopKlima AS "TPop Klima", apflora.tblTPop.TPopNeigung AS "TPop Hangneigung", apflora.tblTPop.TPopBeschr AS "TPop Beschreibung", apflora.tblTPop.TPopKatNr AS "TPop Kataster-Nr", apflora.tblTPop.TPopApBerichtRelevant AS "TPop fuer AP-Bericht relevant", apflora.tblTPop.TPopEigen AS "TPop EigentuemerIn", apflora.tblTPop.TPopKontakt AS "TPop Kontakt vor Ort", apflora.tblTPop.TPopNutzungszone AS "TPop Nutzungszone", apflora.tblTPop.TPopBewirtschafterIn AS "TPop BewirtschafterIn", apflora.tblTPop.TPopBewirtschaftung AS "TPop Bewirtschaftung", apflora.tblTPopMassnBer.TPopMassnBerId AS "TPopMassnBer Id", apflora.tblTPopMassnBer.TPopMassnBerJahr AS "TPopMassnBer Jahr", domTPopMassnErfolgsbeurteilung.BeurteilTxt AS "TPopMassnBer Entwicklung", apflora.tblTPopMassnBer.TPopMassnBerTxt AS "TPopMassnBer Interpretation", apflora.tblTPopMassnBer.MutWann AS "TPopMassnBer MutWann", apflora.tblTPopMassnBer.MutWer AS "TPopMassnBer MutWer"
FROM (((((((apfloraBeob.ArtenDb_Arteigenschaften RIGHT JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) RIGHT JOIN (apflora.tblPop RIGHT JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN apflora.domPopHerkunft AS domPopHerkunft_1 ON apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId)INNER JOIN apflora.tblTPopMassnBer ON apflora.tblTPop.TPopId = apflora.tblTPopMassnBer.TPopId) LEFT JOIN apflora.domTPopMassnErfolgsbeurteilung ON apflora.tblTPopMassnBer.TPopMassnBerErfolgsbeurteilung = domTPopMassnErfolgsbeurteilung.BeurteilId
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr, apflora.tblTPop.TPopNr, apflora.tblTPopMassnBer.TPopMassnBerJahr;

CREATE OR REPLACE VIEW vTPopFuerKml AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.Artname AS Art, CAST(CONCAT(apflora.tblPop.PopNr,'/', apflora.tblTPop.TPopNr) AS CHAR) AS Label, CAST(LEFT(CONCAT('Population: ', apflora.tblPop.PopNr, ' ', apflora.tblPop.PopName, '<br /> Teilpopulation: ', apflora.tblTPop.TPopNr, ' ', apflora.tblTPop.TPopGemeinde, ' ', apflora.tblTPop.TPopFlurname),225) AS CHAR) AS Inhalte, (2.6779094+(4.728982*((apflora.tblTPop.TPopXKoord-600000)/1000000))+(0.791484*((apflora.tblTPop.TPopXKoord-600000)/1000000)*((apflora.tblTPop.TPopYKoord-200000)/1000000))+(0.1306*((apflora.tblTPop.TPopXKoord-600000)/1000000)*((apflora.tblTPop.TPopYKoord-200000)/1000000)*((apflora.tblTPop.TPopYKoord-200000)/1000000))-(0.0436*((apflora.tblTPop.TPopXKoord-600000)/1000000)*((apflora.tblTPop.TPopXKoord-600000)/1000000)*((apflora.tblTPop.TPopXKoord-600000)/1000000)))*100/36 AS Laengengrad, (16.9023892+(3.238272*((apflora.tblTPop.TPopYKoord-200000)/1000000))-(0.270978*((apflora.tblTPop.TPopXKoord-600000)/1000000)*((apflora.tblTPop.TPopXKoord-600000)/1000000))-(0.002528*((apflora.tblTPop.TPopYKoord-200000)/1000000)*((apflora.tblTPop.TPopYKoord-200000)/1000000))-(0.0447*((apflora.tblTPop.TPopXKoord-600000)/1000000)*((apflora.tblTPop.TPopXKoord-600000)/1000000)*((apflora.tblTPop.TPopYKoord-200000)/1000000))-(0.014*((apflora.tblTPop.TPopYKoord-200000)/1000000)*((apflora.tblTPop.TPopYKoord-200000)/1000000)*((apflora.tblTPop.TPopYKoord-200000)/1000000)))*100/36 AS Breitengrad, CAST(CONCAT('http://apflora.ch/index.html?ap=', apflora.tblAp.ApArtId, '&pop=', apflora.tblTPop.TPopId) AS CHAR) AS URL
FROM (apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN (apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId
WHERE apflora.tblTPop.TPopYKoord > 0 AND apflora.tblTPop.TPopXKoord > 0
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr, apflora.tblPop.PopName, apflora.tblTPop.TPopNr, apflora.tblTPop.TPopGemeinde, apflora.tblTPop.TPopFlurname;

CREATE OR REPLACE VIEW vTPopFuerKmlNamen AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.Artname AS Art, CAST(CONCAT(apfloraBeob.ArtenDb_Arteigenschaften.Artname, ' ', apflora.tblPop.PopNr,'/', apflora.tblTPop.TPopNr) AS CHAR) AS Label, CAST(LEFT(CONCAT('Population: ', apflora.tblPop.PopNr, ' ', apflora.tblPop.PopName, '<br /> Teilpopulation: ', apflora.tblTPop.TPopNr, ' ', apflora.tblTPop.TPopGemeinde, ' ', apflora.tblTPop.TPopFlurname),225) AS CHAR) AS Inhalte, (2.6779094+(4.728982*((apflora.tblTPop.TPopXKoord-600000)/1000000))+(0.791484*((apflora.tblTPop.TPopXKoord-600000)/1000000)*((apflora.tblTPop.TPopYKoord-200000)/1000000))+(0.1306*((apflora.tblTPop.TPopXKoord-600000)/1000000)*((apflora.tblTPop.TPopYKoord-200000)/1000000)*((apflora.tblTPop.TPopYKoord-200000)/1000000))-(0.0436*((apflora.tblTPop.TPopXKoord-600000)/1000000)*((apflora.tblTPop.TPopXKoord-600000)/1000000)*((apflora.tblTPop.TPopXKoord-600000)/1000000)))*100/36 AS Laengengrad, (16.9023892+(3.238272*((apflora.tblTPop.TPopYKoord-200000)/1000000))-(0.270978*((apflora.tblTPop.TPopXKoord-600000)/1000000)*((apflora.tblTPop.TPopXKoord-600000)/1000000))-(0.002528*((apflora.tblTPop.TPopYKoord-200000)/1000000)*((apflora.tblTPop.TPopYKoord-200000)/1000000))-(0.0447*((apflora.tblTPop.TPopXKoord-600000)/1000000)*((apflora.tblTPop.TPopXKoord-600000)/1000000)*((apflora.tblTPop.TPopYKoord-200000)/1000000))-(0.014*((apflora.tblTPop.TPopYKoord-200000)/1000000)*((apflora.tblTPop.TPopYKoord-200000)/1000000)*((apflora.tblTPop.TPopYKoord-200000)/1000000)))*100/36 AS Breitengrad, CAST(CONCAT('http://www.apflora.ch/index.html?ap=', apflora.tblAp.ApArtId, '&pop=', apflora.tblTPop.TPopId) AS CHAR) AS URL
FROM (apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN (apflora.tblPop INNER JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId
WHERE apflora.tblTPop.TPopYKoord > 0 AND apflora.tblTPop.TPopXKoord > 0
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr, apflora.tblPop.PopName, apflora.tblTPop.TPopNr, apflora.tblTPop.TPopGemeinde, apflora.tblTPop.TPopFlurname;

CREATE OR REPLACE VIEW vPopFuerKml AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.Artname AS Art, apflora.tblPop.PopNr AS Label, CAST(LEFT(CONCAT('Population: ', apflora.tblPop.PopNr, ' ', apflora.tblPop.PopName),225) AS CHAR) AS Inhalte, (2.6779094+(4.728982*((apflora.tblPop.PopXKoord-600000)/1000000))+(0.791484*((apflora.tblPop.PopXKoord-600000)/1000000)*((apflora.tblPop.PopYKoord-200000)/1000000))+(0.1306*((apflora.tblPop.PopXKoord-600000)/1000000)*((apflora.tblPop.PopYKoord-200000)/1000000)*((apflora.tblPop.PopYKoord-200000)/1000000))-(0.0436*((apflora.tblPop.PopXKoord-600000)/1000000)*((apflora.tblPop.PopXKoord-600000)/1000000)*((apflora.tblPop.PopXKoord-600000)/1000000)))*100/36 AS Laengengrad, (16.9023892+(3.238272*((apflora.tblPop.PopYKoord-200000)/1000000))-(0.270978*((apflora.tblPop.PopXKoord-600000)/1000000)*((apflora.tblPop.PopXKoord-600000)/1000000))-(0.002528*((apflora.tblPop.PopYKoord-200000)/1000000)*((apflora.tblPop.PopYKoord-200000)/1000000))-(0.0447*((apflora.tblPop.PopXKoord-600000)/1000000)*((apflora.tblPop.PopXKoord-600000)/1000000)*((apflora.tblPop.PopYKoord-200000)/1000000))-(0.014*((apflora.tblPop.PopYKoord-200000)/1000000)*((apflora.tblPop.PopYKoord-200000)/1000000)*((apflora.tblPop.PopYKoord-200000)/1000000)))*100/36 AS Breitengrad, CAST(CONCAT('http://www.apflora.ch/index.html?ap=', apflora.tblAp.ApArtId, '&pop=', apflora.tblPop.PopId) AS CHAR) AS URL
FROM (apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN apflora.tblPop ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId
WHERE apflora.tblPop.PopYKoord > 0 AND apflora.tblPop.PopXKoord > 0
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr, apflora.tblPop.PopName;

CREATE OR REPLACE VIEW vPopFuerKmlNamen AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.Artname AS Art, CAST(CONCAT(apfloraBeob.ArtenDb_Arteigenschaften.Artname, ' ', apflora.tblPop.PopNr) AS CHAR) AS Label, CAST(LEFT(CONCAT('Population: ', apflora.tblPop.PopNr, ' ', apflora.tblPop.PopName),225) AS CHAR) AS Inhalte, (2.6779094+(4.728982*((apflora.tblPop.PopXKoord-600000)/1000000))+(0.791484*((apflora.tblPop.PopXKoord-600000)/1000000)*((apflora.tblPop.PopYKoord-200000)/1000000))+(0.1306*((apflora.tblPop.PopXKoord-600000)/1000000)*((apflora.tblPop.PopYKoord-200000)/1000000)*((apflora.tblPop.PopYKoord-200000)/1000000))-(0.0436*((apflora.tblPop.PopXKoord-600000)/1000000)*((apflora.tblPop.PopXKoord-600000)/1000000)*((apflora.tblPop.PopXKoord-600000)/1000000)))*100/36 AS Laengengrad, (16.9023892+(3.238272*((apflora.tblPop.PopYKoord-200000)/1000000))-(0.270978*((apflora.tblPop.PopXKoord-600000)/1000000)*((apflora.tblPop.PopXKoord-600000)/1000000))-(0.002528*((apflora.tblPop.PopYKoord-200000)/1000000)*((apflora.tblPop.PopYKoord-200000)/1000000))-(0.0447*((apflora.tblPop.PopXKoord-600000)/1000000)*((apflora.tblPop.PopXKoord-600000)/1000000)*((apflora.tblPop.PopYKoord-200000)/1000000))-(0.014*((apflora.tblPop.PopYKoord-200000)/1000000)*((apflora.tblPop.PopYKoord-200000)/1000000)*((apflora.tblPop.PopYKoord-200000)/1000000)))*100/36 AS Breitengrad, CAST(CONCAT('http://www.apflora.ch/index.html?ap=', apflora.tblAp.ApArtId, '&pop=', apflora.tblPop.PopId) AS CHAR) AS URL
FROM (apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN apflora.tblPop ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId
WHERE apflora.tblPop.PopYKoord > 0 AND apflora.tblPop.PopXKoord > 0
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr, apflora.tblPop.PopName;

DROP VIEW IF EXISTS vKontrAnzProZaehleinheit0;

CREATE OR REPLACE VIEW vKontrAnzProZaehleinheit AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "AP Art", apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", apflora.tblAp.ApJahr AS "AP Start im Jahr", apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", tblAdresse_1.AdrName AS "AP verantwortlich", apflora.tblPop.PopGuid AS "Pop Guid", apflora.tblPop.PopNr AS "Pop Nr", apflora.tblPop.PopName AS "Pop Name", apflora.domPopHerkunft.HerkunftTxt AS "Pop Herkunft", apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", apflora.tblTPop.TPopId AS "TPop ID", apflora.tblTPop.TPopGuid AS "TPop Guid", apflora.tblTPop.TPopNr AS "TPop Nr", apflora.tblTPop.TPopGemeinde AS "TPop Gemeinde", apflora.tblTPop.TPopFlurname AS "TPop Flurname", domPopHerkunft_1.HerkunftTxt AS "TPop Status", apflora.tblTPop.TPopBekanntSeit AS "TPop bekannt seit", apflora.tblTPop.TPopHerkunftUnklar AS "TPop Status unklar", apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "TPop Begruendung fuer unklaren Status", apflora.tblTPop.TPopXKoord AS "TPop X-Koordinaten", apflora.tblTPop.TPopYKoord AS "TPop Y-Koordinaten", apflora.tblTPop.TPopRadius AS "TPop Radius m", apflora.tblTPop.TPopHoehe AS "TPop Hoehe", apflora.tblTPop.TPopExposition AS "TPop Exposition", apflora.tblTPop.TPopKlima AS "TPop Klima", apflora.tblTPop.TPopNeigung AS "TPop Hangneigung", apflora.tblTPop.TPopBeschr AS "TPop Beschreibung", apflora.tblTPop.TPopKatNr AS "TPop Kataster-Nr", apflora.tblTPop.TPopApBerichtRelevant AS "TPop fuer AP-Bericht relevant", apflora.tblTPop.TPopEigen AS "TPop EigentuemerIn", apflora.tblTPop.TPopKontakt AS "TPop Kontakt vor Ort", apflora.tblTPop.TPopNutzungszone AS "TPop Nutzungszone", apflora.tblTPop.TPopBewirtschafterIn AS "TPop BewirtschafterIn", apflora.tblTPop.TPopBewirtschaftung AS "TPop Bewirtschaftung", apflora.tblTPopKontr.TPopKontrId, apflora.tblTPopKontr.TPopId, apflora.tblTPopKontr.TPopKontrGuid AS "Kontr Guid", apflora.tblTPopKontr.TPopKontrJahr AS "Kontr Jahr", apflora.tblTPopKontr.TPopKontrDatum AS "Kontr Datum", apflora.domTPopFeldkontrTyp.DomainTxt AS "Kontr Typ", apflora.tblAdresse.AdrName AS "Kontr BearbeiterIn", apflora.tblTPopKontrZaehl.Anzahl, apflora.domTPopKontrZaehleinheit.ZaehleinheitTxt AS Zaehleinheit, apflora.domTPopKontrMethode.BeurteilTxt AS Methode, apflora.tblTPopKontr.TPopKontrUeberleb AS "Kontr Ueberlebensrate", apflora.tblTPopKontr.TPopKontrVitalitaet AS "Kontr Vitalitaet", apflora.domPopEntwicklung.EntwicklungTxt AS "Kontr Entwicklung", apflora.tblTPopKontr.TPopKontrUrsach AS "Kontr Ursachen", apflora.tblTPopKontr.TPopKontrUrteil AS "Kontr Erfolgsbeurteilung", apflora.tblTPopKontr.TPopKontrAendUms AS "Kontr Aenderungs-Vorschlaege Umsetzung", apflora.tblTPopKontr.TPopKontrAendKontr AS "Kontr Aenderungs-Vorschlaege Kontrolle", apflora.tblTPop.TPopXKoord AS "Kontr X-Koord", apflora.tblTPop.TPopYKoord AS "Kontr Y-Koord", apflora.tblTPopKontr.TPopKontrTxt AS "Kontr Bemerkungen", apflora.tblTPopKontr.TPopKontrLeb AS "Kontr Lebensraum Delarze", apflora.tblTPopKontr.TPopKontrLebUmg AS "Kontr angrenzender Lebensraum Delarze", apflora.tblTPopKontr.TPopKontrVegTyp AS "Kontr Vegetationstyp", apflora.tblTPopKontr.TPopKontrKonkurrenz AS "Kontr Konkurrenz", apflora.tblTPopKontr.TPopKontrMoosschicht AS "Kontr Moosschicht", apflora.tblTPopKontr.TPopKontrKrautschicht AS "Kontr Krautschicht", apflora.tblTPopKontr.TPopKontrStrauchschicht AS "Kontr Strauchschicht", apflora.tblTPopKontr.TPopKontrBaumschicht AS "Kontr Baumschicht", apflora.tblTPopKontr.TPopKontrBodenTyp AS "Kontr Bodentyp", apflora.tblTPopKontr.TPopKontrBodenKalkgehalt AS "Kontr Boden Kalkgehalt", apflora.tblTPopKontr.TPopKontrBodenDurchlaessigkeit AS "Kontr Boden Durchlaessigkeit", apflora.tblTPopKontr.TPopKontrBodenHumus AS "Kontr Boden Humusgehalt", apflora.tblTPopKontr.TPopKontrBodenNaehrstoffgehalt AS "Kontr Boden Naehrstoffgehalt", apflora.tblTPopKontr.TPopKontrBodenAbtrag AS "Kontr Oberbodenabtrag", apflora.tblTPopKontr.TPopKontrWasserhaushalt AS "Kontr Wasserhaushalt", apflora.domTPopKontrIdBiotUebereinst.DomainTxt AS "Kontr Uebereinstimmung mit Idealbiotop", apflora.tblTPopKontr.TPopKontrHandlungsbedarf AS "Kontr Handlungsbedarf", apflora.tblTPopKontr.TPopKontrUebFlaeche AS "Kontr Ueberpruefte Flaeche", apflora.tblTPopKontr.TPopKontrFlaeche AS "Kontr Flaeche der Teilpopulation m2", apflora.tblTPopKontr.TPopKontrPlan AS "Kontr auf Plan eingezeichnet", apflora.tblTPopKontr.TPopKontrVeg AS "Kontr Deckung durch Vegetation", apflora.tblTPopKontr.TPopKontrNaBo AS "Kontr Deckung nackter Boden", apflora.tblTPopKontr.TPopKontrUebPfl AS "Kontr Deckung durch ueberpruefte Art", apflora.tblTPopKontr.TPopKontrJungPflJN AS "Kontr auch junge Pflanzen", apflora.tblTPopKontr.TPopKontrVegHoeMax AS "Kontr maximale Veg-hoehe cm", apflora.tblTPopKontr.TPopKontrVegHoeMit AS "Kontr mittlere Veg-hoehe cm", apflora.tblTPopKontr.TPopKontrGefaehrdung AS "Kontr Gefaehrdung", apflora.tblTPopKontr.MutWann AS "Kontrolle zuletzt geaendert", apflora.tblTPopKontr.MutWer AS "Kontrolle zuletzt geaendert von", apflora.tblTPopKontrZaehl.TPopKontrZaehlId
FROM (((apflora.domPopHerkunft AS domPopHerkunft_1 RIGHT JOIN (((((((apfloraBeob.ArtenDb_Arteigenschaften INNER JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) INNER JOIN (apflora.tblPop INNER JOIN (apflora.tblTPop INNER JOIN (((apflora.tblTPopKontr LEFT JOIN apflora.domTPopFeldkontrTyp ON apflora.tblTPopKontr.TPopKontrTyp = apflora.domTPopFeldkontrTyp.DomainTxt) LEFT JOIN apflora.tblAdresse ON apflora.tblTPopKontr.TPopKontrBearb = apflora.tblAdresse.AdrId) LEFT JOIN apflora.domPopEntwicklung ON apflora.tblTPopKontr.TPopKontrEntwicklung = apflora.domPopEntwicklung.EntwicklungId) ON apflora.tblTPop.TPopId = apflora.tblTPopKontr.TPopId) ON apflora.tblPop.PopId = apflora.tblTPop.PopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = apflora.domPopHerkunft.HerkunftId) LEFT JOIN apflora.domTPopKontrIdBiotUebereinst ON apflora.tblTPopKontr.TPopKontrIdealBiotopUebereinst = apflora.domTPopKontrIdBiotUebereinst.DomainCode) LEFT JOIN apflora.tblAdresse AS tblAdresse_1 ON apflora.tblAp.ApBearb = tblAdresse_1.AdrId) ON domPopHerkunft_1.HerkunftId = apflora.tblTPop.TPopHerkunft) INNER JOIN apflora.tblTPopKontrZaehl ON apflora.tblTPopKontr.TPopKontrId = apflora.tblTPopKontrZaehl.TPopKontrId) LEFT JOIN apflora.domTPopKontrZaehleinheit ON apflora.tblTPopKontrZaehl.Zaehleinheit = apflora.domTPopKontrZaehleinheit.ZaehleinheitCode) LEFT JOIN apflora.domTPopKontrMethode ON apflora.tblTPopKontrZaehl.Methode = apflora.domTPopKontrMethode.BeurteilCode
WHERE apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId Not In (100,150)
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr, apflora.tblTPop.TPopNr, apflora.tblTPopKontr.TPopKontrJahr, apflora.tblTPopKontr.TPopKontrDatum;

CREATE OR REPLACE VIEW vTPopBer AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, apfloraBeob.ArtenDb_Arteigenschaften.Artname AS "AP Art", apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", apflora.tblAp.ApJahr AS "AP Start im Jahr", apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", apflora.tblPop.PopGuid AS "Pop Guid", apflora.tblPop.PopNr AS "Pop Nr", apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begruendung fuer unklaren Status", apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", apflora.tblTPop.TPopId AS "TPop ID", apflora.tblTPop.TPopGuid AS "TPop Guid", apflora.tblTPop.TPopNr AS "TPop Nr", apflora.tblTPop.TPopGemeinde AS "TPop Gemeinde", apflora.tblTPop.TPopFlurname AS "TPop Flurname", domPopHerkunft_1.HerkunftTxt AS "TPop Status", apflora.tblTPop.TPopBekanntSeit AS "TPop bekannt seit", apflora.tblTPop.TPopHerkunftUnklar AS "TPop Status unklar", apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "TPop Begruendung fuer unklaren Status", apflora.tblTPop.TPopXKoord AS "TPop X-Koordinaten", apflora.tblTPop.TPopYKoord AS "TPop Y-Koordinaten", apflora.tblTPop.TPopRadius AS "TPop Radius (m)", apflora.tblTPop.TPopHoehe AS "TPop Hoehe", apflora.tblTPop.TPopExposition AS "TPop Exposition", apflora.tblTPop.TPopKlima AS "TPop Klima", apflora.tblTPop.TPopNeigung AS "TPop Hangneigung", apflora.tblTPop.TPopBeschr AS "TPop Beschreibung", apflora.tblTPop.TPopKatNr AS "TPop Kataster-Nr", apflora.tblTPop.TPopApBerichtRelevant AS "TPop fuer AP-Bericht relevant", apflora.tblTPop.TPopEigen AS "TPop EigentuemerIn", apflora.tblTPop.TPopKontakt AS "TPop Kontakt vor Ort", apflora.tblTPop.TPopNutzungszone AS "TPop Nutzungszone", apflora.tblTPop.TPopBewirtschafterIn AS "TPop BewirtschafterIn", apflora.tblTPop.TPopBewirtschaftung AS "TPop Bewirtschaftung", apflora.tblTPopBer.TPopBerId AS "TPopBer Id", apflora.tblTPopBer.TPopBerJahr AS "TPopBer Jahr", domPopEntwicklung.EntwicklungTxt AS "TPopBer Entwicklung", apflora.tblTPopBer.TPopBerTxt AS "TPopBer Bemerkungen", apflora.tblTPopBer.MutWann AS "TPopBer MutWann", apflora.tblTPopBer.MutWer AS "TPopBer MutWer"
FROM (((((((apfloraBeob.ArtenDb_Arteigenschaften RIGHT JOIN apflora.tblAp ON apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId = apflora.tblAp.ApArtId) RIGHT JOIN (apflora.tblPop RIGHT JOIN apflora.tblTPop ON apflora.tblPop.PopId = apflora.tblTPop.PopId) ON apflora.tblAp.ApArtId = apflora.tblPop.ApArtId) LEFT JOIN apflora.domApBearbeitungsstand ON apflora.tblAp.ApStatus = apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN apflora.domApUmsetzung ON apflora.tblAp.ApUmsetzung = apflora.domApUmsetzung.DomainCode) LEFT JOIN apflora.domPopHerkunft ON apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN apflora.domPopHerkunft AS domPopHerkunft_1 ON apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId) RIGHT JOIN apflora.tblTPopBer ON apflora.tblTPop.TPopId = apflora.tblTPopBer.TPopId) LEFT JOIN apflora.domPopEntwicklung ON apflora.tblTPopBer.TPopBerEntwicklung = domPopEntwicklung.EntwicklungId
ORDER BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblPop.PopNr, apflora.tblTPop.TPopNr, apflora.tblTPopBer.TPopBerJahr, domPopEntwicklung.EntwicklungTxt;

CREATE OR REPLACE VIEW vTPopBerMassnJahre AS
SELECT apflora.tblTPop.TPopId, apflora.tblTPopBer.TPopBerJahr as "Jahr"
FROM apflora.tblTPop INNER JOIN apflora.tblTPopBer ON apflora.tblTPop.TPopId = apflora.tblTPopBer.TPopId
UNION DISTINCT SELECT apflora.tblTPop.TPopId, apflora.tblTPopMassnBer.TPopMassnBerJahr as "Jahr"
FROM apflora.tblTPop INNER JOIN apflora.tblTPopMassnBer ON apflora.tblTPop.TPopId = apflora.tblTPopMassnBer.TPopId
ORDER BY Jahr;

CREATE OR REPLACE VIEW vTPopKontrBerMassnJahre AS
SELECT apflora.tblTPop.TPopId, apflora.tblTPopBer.TPopBerJahr AS "Jahr" 
FROM apflora.tblTPop INNER JOIN apflora.tblTPopBer ON apflora.tblTPop.TPopId = apflora.tblTPopBer.TPopId
UNION DISTINCT SELECT apflora.tblTPop.TPopId, apflora.tblTPopMassnBer.TPopMassnBerJahr AS "Jahr"
FROM apflora.tblTPop INNER JOIN apflora.tblTPopMassnBer ON apflora.tblTPop.TPopId = apflora.tblTPopMassnBer.TPopId
UNION DISTINCT SELECT apflora.tblTPop.TPopId, apflora.tblTPopKontr.TPopKontrJahr AS "Jahr"
FROM apflora.tblTPop INNER JOIN apflora.tblTPopKontr ON apflora.tblTPop.TPopId = apflora.tblTPopKontr.TPopId
ORDER BY Jahr;

/*diese Abfrage noetig, weil in Access die NO_NOTE zw. tblBeobZuordnung (Text) und tblBeobInfospezies (Zahl) nicht verbunden werden kann*/
CREATE OR REPLACE VIEW vBeobZuordnungInfospeziesArtAnzMut AS
SELECT apfloraBeob.ArtenDb_Arteigenschaften.Artname AS Art, apflora.tblBeobZuordnung.BeobMutWer, apflora.tblBeobZuordnung.BeobMutWann, Count(apflora.tblBeobZuordnung.NO_NOTE) AS AnzMut, "tblBeobZuordnung_Infospezies" AS Tabelle
FROM ((apflora.tblAp INNER JOIN apfloraBeob.ArtenDb_Arteigenschaften ON apflora.tblAp.ApArtId = apfloraBeob.ArtenDb_Arteigenschaften.TaxonomieId) INNER JOIN apfloraBeob.tblBeobInfospezies ON apflora.tblAp.ApArtId = apfloraBeob.tblBeobInfospezies.NO_ISFS) INNER JOIN apflora.tblBeobZuordnung ON apfloraBeob.tblBeobInfospezies.NO_NOTE = apflora.tblBeobZuordnung.NO_NOTE
WHERE apflora.tblAp.ApArtId NOT IN (100, 150)
GROUP BY apfloraBeob.ArtenDb_Arteigenschaften.Artname, apflora.tblBeobZuordnung.BeobMutWer, apflora.tblBeobZuordnung.BeobMutWann;

CREATE OR REPLACE VIEW vDatenstruktur AS
SELECT TABLES.TABLE_NAME AS "Tabelle: Name", TABLES.TABLE_ROWS AS "Tabelle: Anzahl Datensaetze", TABLES.TABLE_COMMENT AS "Tabelle: Bemerkungen", COLUMNS.COLUMN_NAME AS "Feld: Name",  COLUMNS.COLUMN_TYPE AS "Feld: Datentyp", COLUMNS.IS_NULLABLE AS "Feld: Nullwerte", COLUMNS.COLUMN_COMMENT AS "Feld: Bemerkungen" FROM information_schema.COLUMNS INNER JOIN information_schema.TABLES ON information_schema.TABLES.TABLE_NAME = information_schema.COLUMNS.TABLE_NAME WHERE information_schema.COLUMNS.TABLE_NAME IN (SELECT TABLE_NAME FROM information_schema.TABLES WHERE TABLE_SCHEMA='apflora');