CREATE OR REPLACE VIEW vApApBerichtRelevant AS
SELECT alexande_apflora.tblAktionsplan.ApArtId
FROM alexande_apflora.tblAktionsplan INNER JOIN (alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
WHERE alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblAktionsplan.ApArtId;

CREATE OR REPLACE VIEW vKontrLetztesJahr AS
SELECT alexande_apflora.tblAktionsplan.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopId, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblTeilpopulation.TPopId, alexande_apflora.tblTeilpopulation.TPopNr, Max(alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr) AS MaxvonTPopKontrJahr
FROM alexande_beob.ArtenDb_Arteigenschaften INNER JOIN (((alexande_apflora.tblAktionsplan INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN alexande_apflora.tblTeilPopFeldkontrolle ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopFeldkontrolle.TPopId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId
WHERE alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp Not Like "Ziel" And alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp Not Like "Zwischenziel"
GROUP BY alexande_apflora.tblAktionsplan.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopId, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblTeilpopulation.TPopId, alexande_apflora.tblTeilpopulation.TPopNr
HAVING Max(alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr) Is Not Null
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblTeilpopulation.TPopNr;

CREATE OR REPLACE VIEW vKontrLetzteId AS
SELECT Max(alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrId) AS MaxTPopKontrId
FROM alexande_apflora.tblTeilpopulation INNER JOIN alexande_apflora.tblTeilPopFeldkontrolle ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopFeldkontrolle.TPopId
GROUP BY alexande_apflora.tblTeilpopulation.TPopId;

#wird von vBerJb benutzt. Dieses Wiederum in Access:
CREATE OR REPLACE VIEW vErsteMassnahmeProArt AS 
SELECT alexande_apflora.tblAktionsplan.ApArtId, Min(alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr) AS MinvonTPopMassnJahr
FROM ((alexande_apflora.tblAktionsplan INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN alexande_apflora.tblTeilPopMassnahme ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnahme.TPopId
GROUP BY alexande_apflora.tblAktionsplan.ApArtId;

CREATE OR REPLACE VIEW vTPopOhnePop AS
SELECT alexande_apflora.tblTeilpopulation.TPopGuid AS "TPop Guid", alexande_apflora.tblTeilpopulation.TPopNr AS "TPop Nr", alexande_apflora.tblTeilpopulation.TPopGemeinde AS "TPop Gemeinde", alexande_apflora.tblTeilpopulation.TPopFlurname AS "TPop Flurname", DomainPopHerkunft_1.HerkunftTxt AS "TPop Status", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklar AS "TPop Status unklar", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklarBegruendung AS "TPop Begründung für unklaren Status", alexande_apflora.tblTeilpopulation.TPopXKoord AS "TPop X-Koordinaten", alexande_apflora.tblTeilpopulation.TPopYKoord AS "TPop Y-Koordinaten", alexande_apflora.tblTeilpopulation.TPopRadius AS "TPop Radius (m)", alexande_apflora.tblTeilpopulation.TPopHoehe AS "TPop Höhe üM", alexande_apflora.tblTeilpopulation.TPopExposition AS "TPop Exposition", alexande_apflora.tblTeilpopulation.TPopKlima AS "TPop Klima", alexande_apflora.tblTeilpopulation.TPopNeigung AS "TPop Hangneigung", alexande_apflora.tblTeilpopulation.TPopBeschr AS "TPop Beschreibung", alexande_apflora.tblTeilpopulation.TPopKatNr AS "TPop Kataster-Nr", alexande_apflora.tblAdresse.AdrName AS "TPop Verantwortlich", alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant AS "TPop für AP-Bericht relevant", alexande_apflora.tblTeilpopulation.TPopBekanntSeit AS "TPop bekannt seit", alexande_apflora.tblTeilpopulation.TPopEigen AS "TPop EigentümerIn", alexande_apflora.tblTeilpopulation.TPopKontakt AS "TPop Kontakt vor Ort", alexande_apflora.tblTeilpopulation.TPopNutzungszone AS "TPop Nutzungszone", alexande_apflora.tblTeilpopulation.TPopBewirtschafterIn AS "TPop BewirtschafterIn", alexande_apflora.tblTeilpopulation.TPopBewirtschaftung AS "TPop Bewirtschaftung", alexande_apflora.tblTeilpopulation.MutWann AS "Datensatz zuletzt geändert", alexande_apflora.tblTeilpopulation.MutWann AS "Datensatz zuletzt geändert von"
FROM ((alexande_apflora.tblPopulation RIGHT JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) LEFT JOIN alexande_apflora.DomainPopHerkunft AS DomainPopHerkunft_1 ON alexande_apflora.tblTeilpopulation.TPopHerkunft = DomainPopHerkunft_1.HerkunftId) INNER JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilpopulation.TPopVerantw = alexande_apflora.tblAdresse.AdrId
WHERE alexande_apflora.tblPopulation.PopId Is Null
ORDER BY alexande_apflora.tblTeilpopulation.TPopGemeinde, alexande_apflora.tblTeilpopulation.TPopFlurname, alexande_apflora.tblTeilpopulation.TPopNr;

CREATE OR REPLACE VIEW vMassn AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPopulation.PopGuid AS "Pop Guid", alexande_apflora.tblPopulation.PopNr AS "Pop Nr", alexande_apflora.tblPopulation.PopName AS "Pop Name", DomainPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPopulation.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPopulation.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPopulation.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPopulation.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPopulation.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblTeilpopulation.TPopId AS "TPop ID", alexande_apflora.tblTeilpopulation.TPopGuid AS "TPop Guid", alexande_apflora.tblTeilpopulation.TPopNr AS "TPop Nr", alexande_apflora.tblTeilpopulation.TPopGemeinde AS "TPop Gemeinde", alexande_apflora.tblTeilpopulation.TPopFlurname AS "TPop Flurname", DomainPopHerkunft_1.HerkunftTxt AS "TPop Status", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklar AS "TPop Status unklar", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklarBegruendung AS "TPop Begründung für unklaren Status", alexande_apflora.tblTeilpopulation.TPopXKoord AS "TPop X-Koordinaten", alexande_apflora.tblTeilpopulation.TPopYKoord AS "TPop Y-Koordinaten", alexande_apflora.tblTeilpopulation.TPopRadius AS "TPop Radius (m)", alexande_apflora.tblTeilpopulation.TPopHoehe AS "TPop Höhe", alexande_apflora.tblTeilpopulation.TPopExposition AS "TPop Exposition", alexande_apflora.tblTeilpopulation.TPopKlima AS "TPop Klima", alexande_apflora.tblTeilpopulation.TPopNeigung AS "TPop Hangneigung", alexande_apflora.tblTeilpopulation.TPopBeschr AS "TPop Beschreibung", alexande_apflora.tblTeilpopulation.TPopKatNr AS "TPop Kataster-Nr", alexande_apflora.tblAdresse.AdrName AS "TPop Verantwortlich", alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant AS "TPop für AP-Bericht relevant", alexande_apflora.tblTeilpopulation.TPopBekanntSeit AS "TPop bekannt seit", alexande_apflora.tblTeilpopulation.TPopEigen AS "TPop EigentümerIn", alexande_apflora.tblTeilpopulation.TPopKontakt AS "TPop Kontakt vor Ort", alexande_apflora.tblTeilpopulation.TPopNutzungszone AS "TPop Nutzungszone", alexande_apflora.tblTeilpopulation.TPopBewirtschafterIn AS "TPop BewirtschafterIn", alexande_apflora.tblTeilpopulation.TPopBewirtschaftung AS "TPop Bewirtschaftung", alexande_apflora.tblTeilPopMassnahme.TPopMassnGuid AS "Massn Guid", alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr AS "Massn Jahr", alexande_apflora.tblTeilPopMassnahme.TPopMassnDatum AS "Massn Datum", DomainTPopMassnTyp.MassnTypTxt AS "Massn Typ", alexande_apflora.tblTeilPopMassnahme.TPopMassnTxt AS "Massn Massnahme", alexande_apflora.tblAdresse.AdrName AS "Massn BearbeiterIn", CAST(alexande_apflora.tblTeilPopMassnahme.TPopMassnBemTxt AS CHAR) AS "Massn Bemerkungen", alexande_apflora.tblTeilPopMassnahme.TPopMassnPlan AS "Massn Plan vorhanden", alexande_apflora.tblTeilPopMassnahme.TPopMassnPlanBez AS "Massn Plan Bezeichnung", alexande_apflora.tblTeilPopMassnahme.TPopMassnFlaeche AS "Massn Fläche m2", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedForm AS "Massn Form der Ansiedlung", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedPflanzanordnung AS "Massn Pflanzanordnung", alexande_apflora.tblTeilPopMassnahme.TPopMassnMarkierung AS "Massn Markierung",  alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedAnzTriebe AS "Massn Anz Triebe", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedAnzPfl AS "Massn Pflanzen", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnzPflanzstellen AS "Massn Anz Pflanzstellen", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedWirtspfl AS "Massn Wirtspflanze", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedHerkunftPop AS "Massn Herkunftspopulation", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedDatSamm AS "Massn Sammeldatum", alexande_apflora.tblTeilPopMassnahme.MutWann AS "Datensatz zuletzt geändert", alexande_apflora.tblTeilPopMassnahme.MutWer AS "Datensatz zuletzt geändert von"
FROM ((((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN ((alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN (alexande_apflora.tblTeilPopMassnahme LEFT JOIN alexande_apflora.DomainTPopMassnTyp ON alexande_apflora.tblTeilPopMassnahme.TPopMassnTyp = DomainTPopMassnTyp.MassnTypCode) ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnahme.TPopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.DomainPopHerkunft AS DomainPopHerkunft_1 ON alexande_apflora.tblTeilpopulation.TPopHerkunft = DomainPopHerkunft_1.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilPopMassnahme.TPopMassnBearb = alexande_apflora.tblAdresse.AdrId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr, alexande_apflora.tblTeilPopMassnahme.TPopMassnDatum, DomainTPopMassnTyp.MassnTypTxt;

CREATE OR REPLACE VIEW vMassnFuerGis AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "ApArt", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "ApStatus", alexande_apflora.tblAktionsplan.ApJahr AS "ApStartImJahr", DomainApUmsetzung.DomainTxt AS "ApStandUmsetzung", alexande_apflora.tblPopulation.PopGuid AS "PopGuid", alexande_apflora.tblPopulation.PopNr AS "PopNr", alexande_apflora.tblPopulation.PopName AS "PopName", DomainPopHerkunft.HerkunftTxt AS "PopStatus", alexande_apflora.tblPopulation.PopBekanntSeit AS "PopBekanntSeit", alexande_apflora.tblPopulation.PopXKoord AS "PopXKoordinaten", alexande_apflora.tblPopulation.PopYKoord AS "PopYKoordinaten", alexande_apflora.tblTeilpopulation.TPopGuid AS "TPopGuid", alexande_apflora.tblTeilpopulation.TPopNr AS "TPopNr", alexande_apflora.tblTeilpopulation.TPopGemeinde AS "TPopGemeinde", alexande_apflora.tblTeilpopulation.TPopFlurname AS "TPopFlurname", DomainPopHerkunft_1.HerkunftTxt AS "TPopStatus", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklar AS "TPopStatusUnklar", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklarBegruendung AS "TPopBegründungFuerUnklarenStatus", alexande_apflora.tblTeilpopulation.TPopXKoord AS "TPopXKoordinaten", alexande_apflora.tblTeilpopulation.TPopYKoord AS "TPopYKoordinaten", alexande_apflora.tblTeilpopulation.TPopRadius AS "TPopRadius", alexande_apflora.tblTeilpopulation.TPopHoehe AS "TPopHoehe", alexande_apflora.tblTeilpopulation.TPopExposition AS "TPopExposition", alexande_apflora.tblTeilpopulation.TPopKlima AS "TPopKlima", alexande_apflora.tblTeilpopulation.TPopNeigung AS "TPopHangneigung", alexande_apflora.tblTeilpopulation.TPopBeschr AS "TPopBeschreibung", alexande_apflora.tblTeilpopulation.TPopKatNr AS "TPopKatasterNr", alexande_apflora.tblAdresse.AdrName AS "TPopVerantwortlich", alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant AS "TPopFuerApBerichtRelevant", alexande_apflora.tblTeilpopulation.TPopBekanntSeit AS "TPopBekanntSeit", alexande_apflora.tblTeilpopulation.TPopEigen AS "TPopEigentümerIn", alexande_apflora.tblTeilpopulation.TPopKontakt AS "TPopKontaktVorOrt", alexande_apflora.tblTeilpopulation.TPopNutzungszone AS "TPopNutzungszone", alexande_apflora.tblTeilpopulation.TPopBewirtschafterIn AS "TPopBewirtschafterIn", alexande_apflora.tblTeilpopulation.TPopBewirtschaftung AS "TPopBewirtschaftung", alexande_apflora.tblTeilPopMassnahme.TPopMassnGuid AS "MassnGuid", alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr AS "MassnJahr", alexande_apflora.tblTeilPopMassnahme.TPopMassnDatum AS "MassnDatum", DomainTPopMassnTyp.MassnTypTxt AS "MassnTyp", alexande_apflora.tblTeilPopMassnahme.TPopMassnTxt AS "MassnMassnahme", alexande_apflora.tblAdresse.AdrName AS "MassnBearbeiterIn", alexande_apflora.tblTeilPopMassnahme.TPopMassnPlan AS "MassnPlanVorhanden", alexande_apflora.tblTeilPopMassnahme.TPopMassnPlanBez AS "MassnPlanBezeichnung", alexande_apflora.tblTeilPopMassnahme.TPopMassnFlaeche AS "MassnFlaeche", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedForm AS "MassnFormDerAnsiedlung", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedPflanzanordnung AS "MassnPflanzanordnung", alexande_apflora.tblTeilPopMassnahme.TPopMassnMarkierung AS "MassnMarkierung",  alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedAnzTriebe AS "MassnAnzTriebe", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedAnzPfl AS "MassnPflanzen", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnzPflanzstellen AS "MassnAnzPflanzstellen", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedWirtspfl AS "MassnWirtspflanze", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedHerkunftPop AS "MassnHerkunftspopulation", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedDatSamm AS "MassnSammeldatum", alexande_apflora.tblTeilPopMassnahme.MutWann AS "MassnMutWann", alexande_apflora.tblTeilPopMassnahme.MutWer AS "MassnMutWer"
FROM ((((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN ((alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN (alexande_apflora.tblTeilPopMassnahme LEFT JOIN alexande_apflora.DomainTPopMassnTyp ON alexande_apflora.tblTeilPopMassnahme.TPopMassnTyp = DomainTPopMassnTyp.MassnTypCode) ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnahme.TPopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.DomainPopHerkunft AS DomainPopHerkunft_1 ON alexande_apflora.tblTeilpopulation.TPopHerkunft = DomainPopHerkunft_1.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilPopMassnahme.TPopMassnBearb = alexande_apflora.tblAdresse.AdrId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr, alexande_apflora.tblTeilPopMassnahme.TPopMassnDatum, DomainTPopMassnTyp.MassnTypTxt;

CREATE OR REPLACE VIEW vMassnPolygon AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "ApArt", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "ApStatus", alexande_apflora.tblAktionsplan.ApJahr AS "ApStartImJahr", DomainApUmsetzung.DomainTxt AS "ApStandUmsetzung", alexande_apflora.tblPopulation.PopGuid AS "PopGuid", alexande_apflora.tblPopulation.PopNr AS "PopNr", alexande_apflora.tblPopulation.PopName AS "PopName", DomainPopHerkunft.HerkunftTxt AS "PopStatus", alexande_apflora.tblPopulation.PopBekanntSeit AS "PopBekanntSeit", alexande_apflora.tblPopulation.PopXKoord AS "PopXKoordinaten", alexande_apflora.tblPopulation.PopYKoord AS "PopYKoordinaten", alexande_apflora.tblTeilpopulation.TPopGuid AS "TPopGuid", alexande_apflora.tblTeilpopulation.TPopNr AS "TPopNr", alexande_apflora.tblTeilpopulation.TPopGemeinde AS "TPopGemeinde", alexande_apflora.tblTeilpopulation.TPopFlurname AS "TPopFlurname", DomainPopHerkunft_1.HerkunftTxt AS "TPopStatus", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklar AS "TPopStatusUnklar", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklarBegruendung AS "TPopBegründungFuerUnklarenStatus", alexande_apflora.tblTeilpopulation.TPopXKoord AS "TPopXKoordinaten", alexande_apflora.tblTeilpopulation.TPopYKoord AS "TPopYKoordinaten", tpm_polygon.TpmPolyPolygon, alexande_apflora.tblTeilpopulation.TPopRadius AS "TPopRadius", alexande_apflora.tblTeilpopulation.TPopHoehe AS "TPopHoehe", alexande_apflora.tblTeilpopulation.TPopExposition AS "TPopExposition", alexande_apflora.tblTeilpopulation.TPopKlima AS "TPopKlima", alexande_apflora.tblTeilpopulation.TPopNeigung AS "TPopHangneigung", alexande_apflora.tblTeilpopulation.TPopBeschr AS "TPopBeschreibung", alexande_apflora.tblTeilpopulation.TPopKatNr AS "TPopKatasterNr", alexande_apflora.tblAdresse.AdrName AS "TPopVerantwortlich", alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant AS "TPopFuerApBerichtRelevant", alexande_apflora.tblTeilpopulation.TPopBekanntSeit AS "TPopBekanntSeit", alexande_apflora.tblTeilpopulation.TPopEigen AS "TPopEigentümerIn", alexande_apflora.tblTeilpopulation.TPopKontakt AS "TPopKontaktVorOrt", alexande_apflora.tblTeilpopulation.TPopNutzungszone AS "TPopNutzungszone", alexande_apflora.tblTeilpopulation.TPopBewirtschafterIn AS "TPopBewirtschafterIn", alexande_apflora.tblTeilpopulation.TPopBewirtschaftung AS "TPopBewirtschaftung", alexande_apflora.tblTeilPopMassnahme.TPopMassnGuid AS "MassnGuid", alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr AS "MassnJahr", alexande_apflora.tblTeilPopMassnahme.TPopMassnDatum AS "MassnDatum", DomainTPopMassnTyp.MassnTypTxt AS "MassnTyp", alexande_apflora.tblTeilPopMassnahme.TPopMassnTxt AS "MassnMassnahme", alexande_apflora.tblAdresse.AdrName AS "MassnBearbeiterIn", alexande_apflora.tblTeilPopMassnahme.TPopMassnPlan AS "MassnPlanVorhanden", alexande_apflora.tblTeilPopMassnahme.TPopMassnPlanBez AS "MassnPlanBezeichnung", alexande_apflora.tblTeilPopMassnahme.TPopMassnFlaeche AS "MassnFlaeche", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedForm AS "MassnFormDerAnsiedlung", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedPflanzanordnung AS "MassnPflanzanordnung", alexande_apflora.tblTeilPopMassnahme.TPopMassnMarkierung AS "MassnMarkierung",  alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedAnzTriebe AS "MassnAnzTriebe", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedAnzPfl AS "MassnPflanzen", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnzPflanzstellen AS "MassnAnzPflanzstellen", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedWirtspfl AS "MassnWirtspflanze", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedHerkunftPop AS "MassnHerkunftspopulation", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedDatSamm AS "MassnSammeldatum", alexande_apflora.tblTeilPopMassnahme.MutWann AS "MassnMutWann", alexande_apflora.tblTeilPopMassnahme.MutWer AS "MassnMutWer"
FROM (((((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN ((alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN (alexande_apflora.tblTeilPopMassnahme LEFT JOIN alexande_apflora.DomainTPopMassnTyp ON alexande_apflora.tblTeilPopMassnahme.TPopMassnTyp = DomainTPopMassnTyp.MassnTypCode) ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnahme.TPopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.DomainPopHerkunft AS DomainPopHerkunft_1 ON alexande_apflora.tblTeilpopulation.TPopHerkunft = DomainPopHerkunft_1.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilPopMassnahme.TPopMassnBearb = alexande_apflora.tblAdresse.AdrId) INNER JOIN alexande_apflora.tpm_polygon ON alexande_apflora.tblTeilPopMassnahme.TPopMassnGuid = tpm_polygon.TPopMassnGuid
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr, alexande_apflora.tblTeilPopMassnahme.TPopMassnDatum, DomainTPopMassnTyp.MassnTypTxt;

CREATE OR REPLACE VIEW vTPopAnzMassn AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPopulation.PopGuid AS "Pop Guid", alexande_apflora.tblPopulation.PopNr AS "Pop Nr", alexande_apflora.tblPopulation.PopName AS "Pop Name", DomainPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPopulation.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPopulation.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPopulation.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPopulation.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPopulation.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblTeilpopulation.TPopGuid AS "TPop Guid", alexande_apflora.tblTeilpopulation.TPopNr AS "TPop Nr", alexande_apflora.tblTeilpopulation.TPopGemeinde AS "TPop Gemeinde", alexande_apflora.tblTeilpopulation.TPopFlurname AS "TPop Flurname", DomainPopHerkunft_1.HerkunftTxt AS "TPop Status", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklar AS "TPop Status unklar", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklarBegruendung AS "TPop Begründung für unklaren Status", alexande_apflora.tblTeilpopulation.TPopXKoord AS "TPop X-Koordinaten", alexande_apflora.tblTeilpopulation.TPopYKoord AS "TPop Y-Koordinaten", alexande_apflora.tblTeilpopulation.TPopRadius AS "TPop Radius (m)", alexande_apflora.tblTeilpopulation.TPopHoehe AS "TPop Höhe", alexande_apflora.tblTeilpopulation.TPopExposition AS "TPop Exposition", alexande_apflora.tblTeilpopulation.TPopKlima AS "TPop Klima", alexande_apflora.tblTeilpopulation.TPopNeigung AS "TPop Hangneigung", alexande_apflora.tblTeilpopulation.TPopBeschr AS "TPop Beschreibung", alexande_apflora.tblTeilpopulation.TPopKatNr AS "TPop Kataster-Nr", alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant AS "TPop für AP-Bericht relevant", alexande_apflora.tblTeilpopulation.TPopBekanntSeit AS "TPop bekannt seit", alexande_apflora.tblTeilpopulation.TPopEigen AS "TPop EigentümerIn", alexande_apflora.tblTeilpopulation.TPopKontakt AS "TPop Kontakt vor Ort", alexande_apflora.tblTeilpopulation.TPopNutzungszone AS "TPop Nutzungszone", alexande_apflora.tblTeilpopulation.TPopBewirtschafterIn AS "TPop BewirtschafterIn", alexande_apflora.tblTeilpopulation.TPopBewirtschaftung AS "TPop Bewirtschaftung", Count(alexande_apflora.tblTeilPopMassnahme.TPopMassnId) AS "Anzahl Massnahmen"
FROM (((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN ((alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) LEFT JOIN alexande_apflora.tblTeilPopMassnahme ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnahme.TPopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.DomainPopHerkunft AS DomainPopHerkunft_1 ON alexande_apflora.tblTeilpopulation.TPopHerkunft = DomainPopHerkunft_1.HerkunftId
GROUP BY alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.DomainApBearbeitungsstand.DomainTxt, alexande_apflora.tblAktionsplan.ApJahr, DomainApUmsetzung.DomainTxt, alexande_apflora.tblPopulation.PopGuid, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, DomainPopHerkunft.HerkunftTxt, alexande_apflora.tblPopulation.PopHerkunftUnklar, alexande_apflora.tblPopulation.PopHerkunftUnklarBegruendung, alexande_apflora.tblPopulation.PopBekanntSeit, alexande_apflora.tblPopulation.PopXKoord, alexande_apflora.tblPopulation.PopYKoord, alexande_apflora.tblTeilpopulation.TPopGuid, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilpopulation.TPopGemeinde, alexande_apflora.tblTeilpopulation.TPopFlurname, DomainPopHerkunft_1.HerkunftTxt, alexande_apflora.tblTeilpopulation.TPopHerkunftUnklar, alexande_apflora.tblTeilpopulation.TPopHerkunftUnklarBegruendung, alexande_apflora.tblTeilpopulation.TPopXKoord, alexande_apflora.tblTeilpopulation.TPopYKoord, alexande_apflora.tblTeilpopulation.TPopRadius, alexande_apflora.tblTeilpopulation.TPopHoehe, alexande_apflora.tblTeilpopulation.TPopExposition, alexande_apflora.tblTeilpopulation.TPopKlima, alexande_apflora.tblTeilpopulation.TPopNeigung, alexande_apflora.tblTeilpopulation.TPopBeschr, alexande_apflora.tblTeilpopulation.TPopKatNr, alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant, alexande_apflora.tblTeilpopulation.TPopBekanntSeit, alexande_apflora.tblTeilpopulation.TPopEigen, alexande_apflora.tblTeilpopulation.TPopKontakt, alexande_apflora.tblTeilpopulation.TPopNutzungszone, alexande_apflora.tblTeilpopulation.TPopBewirtschafterIn, alexande_apflora.tblTeilpopulation.TPopBewirtschaftung
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblTeilpopulation.TPopNr;

CREATE OR REPLACE VIEW vPopAnzMassn AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPopulation.PopGuid AS "Pop Guid", alexande_apflora.tblPopulation.PopNr AS "Pop Nr", alexande_apflora.tblPopulation.PopName AS "Pop Name", DomainPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPopulation.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPopulation.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPopulation.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPopulation.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPopulation.PopYKoord AS "Pop Y-Koordinaten", Count(alexande_apflora.tblTeilPopMassnahme.TPopMassnId) AS "Anzahl Massnahmen"
FROM ((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN ((alexande_apflora.tblPopulation LEFT JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) LEFT JOIN alexande_apflora.tblTeilPopMassnahme ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnahme.TPopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId
GROUP BY alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.DomainApBearbeitungsstand.DomainTxt, alexande_apflora.tblAktionsplan.ApJahr, DomainApUmsetzung.DomainTxt, alexande_apflora.tblPopulation.PopGuid, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, DomainPopHerkunft.HerkunftTxt, alexande_apflora.tblPopulation.PopHerkunftUnklar, alexande_apflora.tblPopulation.PopHerkunftUnklarBegruendung, alexande_apflora.tblPopulation.PopBekanntSeit, alexande_apflora.tblPopulation.PopXKoord, alexande_apflora.tblPopulation.PopYKoord
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr;

CREATE OR REPLACE VIEW vPopAnzKontr AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPopulation.PopGuid AS "Pop Guid", alexande_apflora.tblPopulation.PopNr AS "Pop Nr", alexande_apflora.tblPopulation.PopName AS "Pop Name", DomainPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPopulation.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPopulation.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPopulation.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPopulation.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPopulation.PopYKoord AS "Pop Y-Koordinaten", Count(alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrId) AS "Anzahl Kontrollen"
FROM ((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN ((alexande_apflora.tblPopulation LEFT JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) LEFT JOIN alexande_apflora.tblTeilPopFeldkontrolle ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopFeldkontrolle.TPopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId
GROUP BY alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.DomainApBearbeitungsstand.DomainTxt, alexande_apflora.tblAktionsplan.ApJahr, DomainApUmsetzung.DomainTxt, alexande_apflora.tblPopulation.PopGuid, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, DomainPopHerkunft.HerkunftTxt, alexande_apflora.tblPopulation.PopHerkunftUnklar, alexande_apflora.tblPopulation.PopHerkunftUnklarBegruendung, alexande_apflora.tblPopulation.PopBekanntSeit, alexande_apflora.tblPopulation.PopXKoord, alexande_apflora.tblPopulation.PopYKoord
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr;

CREATE OR REPLACE VIEW vApAnzMassn AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", Count(alexande_apflora.tblTeilPopMassnahme.TPopMassnId) AS "Anzahl Massnahmen"
FROM (((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) LEFT JOIN ((alexande_apflora.tblPopulation LEFT JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) LEFT JOIN alexande_apflora.tblTeilPopMassnahme ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnahme.TPopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode
GROUP BY alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.DomainApBearbeitungsstand.DomainTxt, alexande_apflora.tblAktionsplan.ApJahr, DomainApUmsetzung.DomainTxt
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vApAnzKontr AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", Count(alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrId) AS "Anzahl Kontrollen"
FROM (((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) LEFT JOIN ((alexande_apflora.tblPopulation LEFT JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) LEFT JOIN alexande_apflora.tblTeilPopFeldkontrolle ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopFeldkontrolle.TPopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode
GROUP BY alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.DomainApBearbeitungsstand.DomainTxt, alexande_apflora.tblAktionsplan.ApJahr, DomainApUmsetzung.DomainTxt
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vPop AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPopulation.PopId, alexande_apflora.tblPopulation.PopGuid AS "Pop Guid", alexande_apflora.tblPopulation.PopNr AS "Pop Nr", alexande_apflora.tblPopulation.PopName AS "Pop Name", DomainPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPopulation.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPopulation.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPopulation.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPopulation.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPopulation.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblPopulation.MutWann AS "Datensatz zuletzt geändert", alexande_apflora.tblPopulation.MutWer AS "Datensatz zuletzt geändert von"
FROM ((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr;

CREATE OR REPLACE VIEW vPopOhneKoord AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPopulation.PopId, alexande_apflora.tblPopulation.PopGuid AS "Pop Guid", alexande_apflora.tblPopulation.PopNr AS "Pop Nr", alexande_apflora.tblPopulation.PopName AS "Pop Name", DomainPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPopulation.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPopulation.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPopulation.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPopulation.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPopulation.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblPopulation.MutWann AS "Datensatz zuletzt geändert", alexande_apflora.tblPopulation.MutWer AS "Datensatz zuletzt geändert von"
FROM ((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId
WHERE alexande_apflora.tblPopulation.PopXKoord IS NULL OR alexande_apflora.tblPopulation.PopYKoord IS NULL 
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr;

CREATE OR REPLACE VIEW vPopFuerGis AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPopulation.PopGuid AS "Pop Guid", alexande_apflora.tblPopulation.PopNr AS "Pop Nr", alexande_apflora.tblPopulation.PopName AS "Pop Name", DomainPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPopulation.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPopulation.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPopulation.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPopulation.PopXKoord AS "XKoordinaten", alexande_apflora.tblPopulation.PopYKoord AS "YKoordinaten", alexande_apflora.tblPopulation.MutWann AS "Datensatz zuletzt geändert", alexande_apflora.tblPopulation.MutWer AS "Datensatz zuletzt geändert von"
FROM ((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId
WHERE alexande_apflora.tblPopulation.PopXKoord > 0 AND alexande_apflora.tblPopulation.PopYKoord > 0
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr;

#im Gebrauch (Access):
CREATE OR REPLACE VIEW vPopOhneAp AS
SELECT alexande_apflora.tblPopulation.PopGuid AS "Pop Guid", alexande_apflora.tblPopulation.PopNr AS "Pop Nr", alexande_apflora.tblPopulation.PopName AS "Pop Name", DomainPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPopulation.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPopulation.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPopulation.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPopulation.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPopulation.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblPopulation.MutWann AS "Datensatz zuletzt geändert", alexande_apflora.tblPopulation.MutWer AS "Datensatz zuletzt geändert von", alexande_apflora.tblAktionsplan.ApArtId
FROM (alexande_apflora.tblAktionsplan RIGHT JOIN alexande_apflora.tblPopulation ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId
WHERE alexande_apflora.tblAktionsplan.ApArtId Is Null
ORDER BY alexande_apflora.tblPopulation.PopName, alexande_apflora.tblPopulation.PopNr;

CREATE OR REPLACE VIEW vPopOhneTPop AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPopulation.PopGuid AS "Pop Guid", alexande_apflora.tblPopulation.PopNr AS "Pop Nr", alexande_apflora.tblPopulation.PopName AS "Pop Name", DomainPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPopulation.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPopulation.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPopulation.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPopulation.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPopulation.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblPopulation.MutWann AS "Datensatz zuletzt geändert", alexande_apflora.tblPopulation.MutWer AS "Datensatz zuletzt geändert von"
FROM (((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblTeilpopulation.TPopId Is Null
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr;

CREATE OR REPLACE VIEW vPopBer AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPopulation.PopGuid AS "Pop Guid", alexande_apflora.tblPopulation.PopNr AS "Pop Nr", alexande_apflora.tblPopulation.PopName AS "Pop Name", DomainPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPopulation.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPopulation.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPopulation.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPopulation.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPopulation.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblPopBericht.PopBerId AS "PopBer Id", alexande_apflora.tblPopBericht.PopBerJahr AS "PopBer Jahr", DomainPopEntwicklung.EntwicklungTxt AS "PopBer Entwicklung", alexande_apflora.tblPopBericht.PopBerTxt AS "PopBer Bemerkungen", alexande_apflora.tblPopBericht.MutWann AS "PopBer MutWann", alexande_apflora.tblPopBericht.MutWer AS "PopBer MutWer"
FROM ((((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) INNER JOIN alexande_apflora.tblPopBericht ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopBericht.PopId) LEFT JOIN alexande_apflora.DomainPopEntwicklung ON alexande_apflora.tblPopBericht.PopBerEntwicklung = DomainPopEntwicklung.EntwicklungId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopBericht.PopBerJahr, DomainPopEntwicklung.EntwicklungTxt;

#im Gebrauch (Access):
CREATE OR REPLACE VIEW vPopBerOhnePop AS
SELECT alexande_apflora.tblPopBericht.PopBerId AS "PopBer Id", alexande_apflora.tblPopBericht.PopId AS "PopBer PopId", alexande_apflora.tblPopBericht.PopBerJahr AS "PopBer Jahr", DomainPopEntwicklung.EntwicklungTxt AS "PopBer Entwicklung", alexande_apflora.tblPopBericht.PopBerTxt AS "PopBer Bemerkungen", alexande_apflora.tblPopBericht.MutWann AS "PopBer MutWann", alexande_apflora.tblPopBericht.MutWer AS "PopBer MutWer"
FROM (alexande_apflora.tblPopulation RIGHT JOIN alexande_apflora.tblPopBericht ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopBericht.PopId) LEFT JOIN alexande_apflora.DomainPopEntwicklung ON alexande_apflora.tblPopBericht.PopBerEntwicklung = DomainPopEntwicklung.EntwicklungId
WHERE alexande_apflora.tblPopulation.PopId Is Null
ORDER BY alexande_apflora.tblPopBericht.PopBerJahr, DomainPopEntwicklung.EntwicklungTxt;

CREATE OR REPLACE VIEW vPopMassnBer AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS "AP ApArtId", alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPopulation.PopGuid AS "Pop Guid", alexande_apflora.tblPopulation.PopNr AS "Pop Nr", alexande_apflora.tblPopulation.PopName AS "Pop Name", DomainPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPopulation.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPopulation.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPopulation.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPopulation.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPopulation.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblPopulation.MutWann AS "Datensatz zuletzt geändert", alexande_apflora.tblPopulation.MutWer AS "Datensatz zuletzt geändert von", alexande_apflora.tblPopMassnBericht.PopMassnBerId AS "PopMassnBer Id", alexande_apflora.tblPopMassnBericht.PopMassnBerJahr AS "PopMassnBer Jahr", DomainTPopMassnErfolgsbeurteilung.BeurteilTxt AS "PopMassnBer Entwicklung", alexande_apflora.tblPopMassnBericht.PopMassnBerTxt AS "PopMassnBer Interpretation", alexande_apflora.tblPopMassnBericht.MutWann AS "PopMassnBer MutWann", alexande_apflora.tblPopMassnBericht.MutWer AS "PopMassnBer MutWer"
FROM ((((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) INNER JOIN alexande_apflora.tblPopMassnBericht ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopMassnBericht.PopId) LEFT JOIN alexande_apflora.DomainTPopMassnErfolgsbeurteilung ON alexande_apflora.tblPopMassnBericht.PopMassnBerErfolgsbeurteilung = DomainTPopMassnErfolgsbeurteilung.BeurteilId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr;

#im Gebrauch (Access):
CREATE OR REPLACE VIEW vPopMassnBerOhnePop AS
SELECT alexande_apflora.tblPopMassnBericht.PopMassnBerId AS "PopMassnBer Id", alexande_apflora.tblPopMassnBericht.PopId AS "PopMassnBer PopId", alexande_apflora.tblPopMassnBericht.PopMassnBerJahr AS "PopMassnBer Jahr", DomainTPopMassnErfolgsbeurteilung.BeurteilTxt AS "PopMassnBer Entwicklung", alexande_apflora.tblPopMassnBericht.PopMassnBerTxt AS "PopMassnBer Interpretation", alexande_apflora.tblPopMassnBericht.MutWann AS "PopMassnBer MutWann", alexande_apflora.tblPopMassnBericht.MutWer AS "PopMassnBer MutWer"
FROM (alexande_apflora.tblPopulation RIGHT JOIN alexande_apflora.tblPopMassnBericht ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopMassnBericht.PopId) LEFT JOIN alexande_apflora.DomainTPopMassnErfolgsbeurteilung ON alexande_apflora.tblPopMassnBericht.PopMassnBerErfolgsbeurteilung = DomainTPopMassnErfolgsbeurteilung.BeurteilId
WHERE alexande_apflora.tblPopulation.PopId Is Null
ORDER BY alexande_apflora.tblPopMassnBericht.PopMassnBerJahr, DomainTPopMassnErfolgsbeurteilung.BeurteilTxt;

CREATE OR REPLACE VIEW vTPop AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPopulation.PopGuid AS "Pop Guid", alexande_apflora.tblPopulation.PopNr AS "Pop Nr", alexande_apflora.tblPopulation.PopName AS "Pop Name", DomainPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPopulation.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPopulation.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPopulation.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPopulation.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPopulation.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblTeilpopulation.TPopId AS "TPop ID", alexande_apflora.tblTeilpopulation.TPopGuid AS "TPop Guid", alexande_apflora.tblTeilpopulation.TPopNr AS "TPop Nr", alexande_apflora.tblTeilpopulation.TPopGemeinde AS "TPop Gemeinde", alexande_apflora.tblTeilpopulation.TPopFlurname AS "TPop Flurname", DomainPopHerkunft_1.HerkunftTxt AS "TPop Status", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklar AS "TPop Status unklar", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklarBegruendung AS "TPop Begründung für unklaren Status", alexande_apflora.tblTeilpopulation.TPopXKoord AS "TPop X-Koordinaten", alexande_apflora.tblTeilpopulation.TPopYKoord AS "TPop Y-Koordinaten", alexande_apflora.tblTeilpopulation.TPopRadius AS "TPop Radius (m)", alexande_apflora.tblTeilpopulation.TPopHoehe AS "TPop Höhe", alexande_apflora.tblTeilpopulation.TPopExposition AS "TPop Exposition", alexande_apflora.tblTeilpopulation.TPopKlima AS "TPop Klima", alexande_apflora.tblTeilpopulation.TPopNeigung AS "TPop Hangneigung", alexande_apflora.tblTeilpopulation.TPopBeschr AS "TPop Beschreibung", alexande_apflora.tblTeilpopulation.TPopKatNr AS "TPop Kataster-Nr", alexande_apflora.tblAdresse.AdrName AS "TPop Verantwortlich", alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant AS "TPop für AP-Bericht relevant", alexande_apflora.tblTeilpopulation.TPopBekanntSeit AS "TPop bekannt seit", alexande_apflora.tblTeilpopulation.TPopEigen AS "TPop EigentümerIn", alexande_apflora.tblTeilpopulation.TPopKontakt AS "TPop Kontakt vor Ort", alexande_apflora.tblTeilpopulation.TPopNutzungszone AS "TPop Nutzungszone", alexande_apflora.tblTeilpopulation.TPopBewirtschafterIn AS "TPop BewirtschafterIn", alexande_apflora.tblTeilpopulation.TPopBewirtschaftung AS "TPop Bewirtschaftung", alexande_apflora.tblTeilpopulation.MutWann AS "Teilpopulation zuletzt geändert", alexande_apflora.tblTeilpopulation.MutWann AS "Teilpopulation zuletzt geändert von"
FROM ((((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) RIGHT JOIN (alexande_apflora.tblPopulation RIGHT JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.DomainPopHerkunft AS DomainPopHerkunft_1 ON alexande_apflora.tblTeilpopulation.TPopHerkunft = DomainPopHerkunft_1.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilpopulation.TPopVerantw = alexande_apflora.tblAdresse.AdrId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblTeilpopulation.TPopNr;

CREATE OR REPLACE VIEW vTPopFuerGis AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPopulation.PopGuid AS "Pop Guid", alexande_apflora.tblPopulation.PopNr AS "Pop Nr", alexande_apflora.tblPopulation.PopName AS "Pop Name", DomainPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPopulation.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPopulation.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPopulation.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblTeilpopulation.TPopGuid AS "TPop Guid", alexande_apflora.tblTeilpopulation.TPopNr AS "TPop Nr", alexande_apflora.tblTeilpopulation.TPopGemeinde AS "TPop Gemeinde", alexande_apflora.tblTeilpopulation.TPopFlurname AS "TPop Flurname", DomainPopHerkunft_1.HerkunftTxt AS "TPop Status", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklar AS "TPop Status unklar", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklarBegruendung AS "TPop Begründung für unklaren Status", alexande_apflora.tblTeilpopulation.TPopXKoord AS "TPopXKoordinaten", alexande_apflora.tblTeilpopulation.TPopYKoord AS "TPopYKoordinaten", alexande_apflora.tblTeilpopulation.TPopRadius AS "TPop Radius (m)", alexande_apflora.tblTeilpopulation.TPopHoehe AS "TPop Höhe", alexande_apflora.tblTeilpopulation.TPopExposition AS "TPop Exposition", alexande_apflora.tblTeilpopulation.TPopKlima AS "TPop Klima", alexande_apflora.tblTeilpopulation.TPopNeigung AS "TPop Hangneigung", alexande_apflora.tblTeilpopulation.TPopBeschr AS "TPop Beschreibung", alexande_apflora.tblTeilpopulation.TPopKatNr AS "TPop Kataster-Nr", alexande_apflora.tblAdresse.AdrName AS "TPop Verantwortlich", alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant AS "TPop für AP-Bericht relevant", alexande_apflora.tblTeilpopulation.TPopBekanntSeit AS "TPop bekannt seit", alexande_apflora.tblTeilpopulation.TPopEigen AS "TPop EigentümerIn", alexande_apflora.tblTeilpopulation.TPopKontakt AS "TPop Kontakt vor Ort", alexande_apflora.tblTeilpopulation.TPopNutzungszone AS "TPop Nutzungszone", alexande_apflora.tblTeilpopulation.TPopBewirtschafterIn AS "TPop BewirtschafterIn", alexande_apflora.tblTeilpopulation.TPopBewirtschaftung AS "TPop Bewirtschaftung", alexande_apflora.tblTeilpopulation.MutWann AS "Datensatz zuletzt geändert", alexande_apflora.tblTeilpopulation.MutWann AS "Datensatz zuletzt geändert von"
FROM ((((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN (alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.DomainPopHerkunft AS DomainPopHerkunft_1 ON alexande_apflora.tblTeilpopulation.TPopHerkunft = DomainPopHerkunft_1.HerkunftId) INNER JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilpopulation.TPopVerantw = alexande_apflora.tblAdresse.AdrId
WHERE alexande_apflora.tblTeilpopulation.TPopYKoord > 0 AND alexande_apflora.tblTeilpopulation.TPopXKoord > 0
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblTeilpopulation.TPopNr;

#im Gebrauch durch export_pop_von_ap_ohne_status.php:
CREATE OR REPLACE VIEW vPopVonApOhneStatus AS 
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.tblAktionsplan.ApStatus AS "Bearbeitungsstand AP", alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, alexande_apflora.tblPopulation.PopHerkunft AS Status
FROM alexande_beob.ArtenDb_Arteigenschaften INNER JOIN (alexande_apflora.tblAktionsplan INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId
WHERE ((alexande_apflora.tblAktionsplan.ApStatus=3) AND (alexande_apflora.tblPopulation.PopHerkunft Is Null))
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr;

#im Gebrauch durch export_pop_mit_massnber_anz_massn.php:
CREATE OR REPLACE VIEW vPopMassnberAnzMassn0 AS
SELECT alexande_apflora.tblPopMassnBericht.PopId, alexande_apflora.tblPopMassnBericht.PopMassnBerJahr, Count(alexande_apflora.tblTeilPopMassnahme.TPopMassnId) AS AnzahlvonTPopMassnId
FROM alexande_apflora.tblPopMassnBericht INNER JOIN (alexande_apflora.tblTeilpopulation LEFT JOIN alexande_apflora.tblTeilPopMassnahme ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnahme.TPopId) ON alexande_apflora.tblPopMassnBericht.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr=alexande_apflora.tblPopMassnBericht.PopMassnBerJahr Or alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr Is Null
GROUP BY alexande_apflora.tblPopMassnBericht.PopId, alexande_apflora.tblPopMassnBericht.PopMassnBerJahr
ORDER BY alexande_apflora.tblPopMassnBericht.PopId, alexande_apflora.tblPopMassnBericht.PopMassnBerJahr;

#im Gebrauch durch export_pop_mit_massnber_anz_massn.php:
CREATE OR REPLACE VIEW vPopMassnberAnzMassn AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPopulation.PopGuid AS "Pop Guid", alexande_apflora.tblPopulation.PopNr AS "Pop Nr", alexande_apflora.tblPopulation.PopName AS "Pop Name", DomainPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPopulation.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPopulation.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPopulation.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora_views.vPopMassnberAnzMassn0.PopMassnBerJahr AS "MassnBer Jahr", alexande_apflora_views.vPopMassnberAnzMassn0.AnzahlvonTPopMassnId AS "Anz Massnahmen in diesem Jahr"
FROM (((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) INNER JOIN alexande_apflora_views.vPopMassnberAnzMassn0 ON alexande_apflora.tblPopulation.PopId = alexande_apflora_views.vPopMassnberAnzMassn0.PopId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora_views.vPopMassnberAnzMassn0.PopMassnBerJahr;

CREATE OR REPLACE VIEW vBerJbZielBer AS 
SELECT alexande_apflora.tblZielBericht.*
FROM alexande_apflora.tblZielBericht INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblZielBericht.ZielBerJahr = alexande_apflora.tblKonstanten.JBerJahr;

CREATE OR REPLACE VIEW vBerJbZiel AS
SELECT alexande_apflora.tblZiel.*, DomainZielTyp.ZieltypTxt
FROM alexande_apflora.tblKonstanten INNER JOIN (alexande_apflora.tblZiel INNER JOIN alexande_apflora.DomainZielTyp ON alexande_apflora.tblZiel.ZielTyp = DomainZielTyp.ZieltypId) ON alexande_apflora.tblKonstanten.JBerJahr = alexande_apflora.tblZiel.ZielJahr
WHERE (alexande_apflora.tblZiel.ZielTyp=1 Or alexande_apflora.tblZiel.ZielTyp=2) OR (alexande_apflora.tblZiel.ZielTyp=1170775556)
ORDER BY alexande_apflora.tblZiel.ZielTyp, alexande_apflora.tblZiel.ZielBezeichnung;

CREATE OR REPLACE VIEW vJBerOhneAp AS
SELECT alexande_apflora.tblJBer.JBerId AS "JBer Id", alexande_apflora.tblJBer.ApArtId AS "JBer ApArtId", alexande_apflora.tblJBer.JBerJahr AS "JBer Jahr", alexande_apflora.tblJBer.JBerSituation AS "JBer Situation", alexande_apflora.tblJBer.JBerVergleichVorjahrGesamtziel AS "JBer Vergleich Vorjahr-Gesamtziel", DomainApErfKrit.BeurteilTxt AS "JBer Beurteilung", alexande_apflora.tblJBer.JBerVeraenGegenVorjahr AS "JBer Veraend zum Vorjahr", alexande_apflora.tblJBer.JBerAnalyse AS "JBer Analyse", alexande_apflora.tblJBer.JBerUmsetzung AS "JBer Konsequenzen Umsetzung", alexande_apflora.tblJBer.JBerErfko AS "JBer Konsequenzen Erfolgskontrolle", alexande_apflora.tblJBer.JBerATxt AS "JBer Bemerkungen zu A", alexande_apflora.tblJBer.JBerBTxt AS "JBer Bemerkungen zu B", alexande_apflora.tblJBer.JBerCTxt AS "JBer Bemerkungen zu C", alexande_apflora.tblJBer.JBerDTxt AS "JBer Bemerkungen zu D", alexande_apflora.tblJBer.JBerDatum AS "JBer Datum", alexande_apflora.tblAdresse.AdrName AS "JBer BearbeiterIn", alexande_apflora.tblJBer.MutWann AS "JBer MutWann", alexande_apflora.tblJBer.MutWer AS "JBer MutWer"
FROM ((alexande_apflora.tblAktionsplan RIGHT JOIN alexande_apflora.tblJBer ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblJBer.ApArtId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblJBer.JBerBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.DomainApErfKrit ON alexande_apflora.tblJBer.JBerBeurteilung = DomainApErfKrit.BeurteilId
WHERE alexande_apflora.tblAktionsplan.ApArtId Is Null
ORDER BY alexande_apflora.tblJBer.ApArtId, alexande_apflora.tblJBer.JBerJahr, alexande_apflora.tblJBer.JBerDatum;

CREATE OR REPLACE VIEW vBerJbArtD AS 
SELECT alexande_apflora.tblAktionsplan.*, alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.tblJBer.JBerId, alexande_apflora.tblJBer.JBerJahr, alexande_apflora.tblJBer.JBerSituation, alexande_apflora.tblJBer.JBerVergleichVorjahrGesamtziel, alexande_apflora.tblJBer.JBerBeurteilung, alexande_apflora.tblJBer.JBerAnalyse, alexande_apflora.tblJBer.JBerUmsetzung, alexande_apflora.tblJBer.JBerErfko, alexande_apflora.tblJBer.JBerATxt, alexande_apflora.tblJBer.JBerBTxt, alexande_apflora.tblJBer.JBerCTxt, alexande_apflora.tblJBer.JBerDTxt, alexande_apflora.tblJBer.JBerDatum, alexande_apflora.tblJBer.JBerBearb, alexande_apflora.tblAdresse.AdrName AS Bearbeiter, DomainApErfKrit.BeurteilTxt
FROM (alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId=alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN (((alexande_apflora.tblJBer LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblJBer.JBerBearb=alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.DomainApErfKrit ON alexande_apflora.tblJBer.JBerBeurteilung=alexande_apflora.DomainApErfKrit.BeurteilId) INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblJBer.JBerJahr=alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblAktionsplan.ApArtId=alexande_apflora.tblJBer.ApArtId;

CREATE OR REPLACE VIEW vFnsKef AS 
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId, IF(alexande_beob.ArtenDb_Arteigenschaften.KefArt="-1","Ja","") AS FnsKefArt2, IF(Round((alexande_apflora.tblKonstanten.JBerJahr- alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,0)=(alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,"Ja","") AS FnsKefKontrJahr2
FROM alexande_beob.ArtenDb_Arteigenschaften, alexande_apflora.tblKonstanten
ORDER BY  alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId;

CREATE OR REPLACE VIEW vPopMassnSeitBeginnAp AS 
SELECT alexande_apflora.tblTeilPopMassnahme.TPopId
FROM alexande_apflora.tblAktionsplan INNER JOIN ((alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN alexande_apflora.tblTeilPopMassnahme ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnahme.TPopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
WHERE (((alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr)>=alexande_apflora.tblAktionsplan.ApJahr))
GROUP BY alexande_apflora.tblTeilPopMassnahme.TPopId;

CREATE OR REPLACE VIEW vApAnzMassnProJahr0 AS 
SELECT alexande_apflora.tblAktionsplan.ApArtId, alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr, Count(alexande_apflora.tblTeilPopMassnahme.TPopMassnId) AS AnzahlvonTPopMassnId
FROM alexande_apflora.tblAktionsplan INNER JOIN ((alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN alexande_apflora.tblTeilPopMassnahme ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnahme.TPopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
WHERE (alexande_apflora.tblAktionsplan.ApStatus Between 1 And 3) AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblAktionsplan.ApArtId, alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr
HAVING alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr Is Not Null
ORDER BY alexande_apflora.tblAktionsplan.ApArtId, alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr;

CREATE OR REPLACE VIEW vMassnJahre AS
SELECT alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr 
FROM alexande_apflora.tblTeilPopMassnahme 
GROUP BY alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr 
HAVING alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr Between 1900 And 2100 ORDER BY alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr;

CREATE OR REPLACE VIEW vApMassnJahre AS
SELECT alexande_apflora.tblAktionsplan.ApArtId, alexande_apflora_views.vMassnJahre.TPopMassnJahr 
FROM alexande_apflora.tblAktionsplan, alexande_apflora_views.vMassnJahre 
WHERE alexande_apflora.tblAktionsplan.ApArtId>0 AND alexande_apflora.tblAktionsplan.ApStatus Between 1 And 3 
ORDER BY alexande_apflora.tblAktionsplan.ApArtId, alexande_apflora_views.vMassnJahre.TPopMassnJahr;

CREATE OR REPLACE VIEW vApAnzMassnProJahr AS 
SELECT alexande_apflora_views.vApMassnJahre.ApArtId, alexande_apflora_views.vApMassnJahre.TPopMassnJahr, IF(alexande_apflora_views.vApAnzMassnProJahr0.AnzahlvonTPopMassnId Is Not Null, alexande_apflora_views.vApAnzMassnProJahr0.AnzahlvonTPopMassnId,0) AS "AnzahlMassnahmen" 
FROM alexande_apflora_views.vApMassnJahre LEFT JOIN alexande_apflora_views.vApAnzMassnProJahr0 ON (alexande_apflora_views.vApMassnJahre.TPopMassnJahr = alexande_apflora_views.vApAnzMassnProJahr0.TPopMassnJahr) AND (alexande_apflora_views.vApMassnJahre.ApArtId = alexande_apflora_views.vApAnzMassnProJahr0.ApArtId) 
ORDER BY alexande_apflora_views.vApMassnJahre.ApArtId, alexande_apflora_views.vApMassnJahre.TPopMassnJahr;

CREATE OR REPLACE VIEW vApAnzMassnBisJahr AS
SELECT alexande_apflora_views.vApMassnJahre.ApArtId, alexande_apflora_views.vApMassnJahre.TPopMassnJahr, Sum(alexande_apflora_views.vApAnzMassnProJahr.AnzahlMassnahmen) AS "AnzahlMassnahmen" 
FROM alexande_apflora_views.vApMassnJahre INNER JOIN alexande_apflora_views.vApAnzMassnProJahr ON alexande_apflora_views.vApMassnJahre.ApArtId = alexande_apflora_views.vApAnzMassnProJahr.ApArtId 
WHERE alexande_apflora_views.vApAnzMassnProJahr.TPopMassnJahr<=alexande_apflora_views.vApMassnJahre.TPopMassnJahr 
GROUP BY alexande_apflora_views.vApMassnJahre.ApArtId, alexande_apflora_views.vApMassnJahre.TPopMassnJahr 
ORDER BY alexande_apflora_views.vApMassnJahre.ApArtId, alexande_apflora_views.vApMassnJahre.TPopMassnJahr;

CREATE OR REPLACE VIEW vApJahresberichte AS 
select alexande_apflora.tblAktionsplan.ApArtId AS ApArtId, alexande_apflora.tblJBer.JBerId AS JBerId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS Name, alexande_apflora.tblJBer.JBerJahr AS JBerJahr, alexande_apflora.tblJBer.JBerSituation AS JBerSituation, alexande_apflora.tblJBer.JBerVergleichVorjahrGesamtziel AS JBerVergleichVorjahrGesamtziel, DomainApErfKrit.BeurteilTxt AS JBerBeurteilung, alexande_apflora.tblJBer.JBerVeraenGegenVorjahr AS JBerVeraenGegenVorjahr, alexande_apflora.tblJBer.JBerAnalyse AS JBerAnalyse, alexande_apflora.tblJBer.JBerUmsetzung AS JBerUmsetzung, alexande_apflora.tblJBer.JBerErfko AS JBerErfko, alexande_apflora.tblJBer.JBerATxt AS JBerATxt, alexande_apflora.tblJBer.JBerBTxt AS JBerBTxt, alexande_apflora.tblJBer.JBerCTxt AS JBerCTxt, alexande_apflora.tblJBer.JBerDTxt AS JBerDTxt, alexande_apflora.tblJBer.JBerDatum AS JBerDatum,alexande_apflora.tblAdresse.AdrName AS JBerBearb 
FROM alexande_apflora.tblAktionsplan INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON (alexande_apflora.tblAktionsplan.ApArtId=alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId) JOIN ((alexande_apflora.tblJBer LEFT JOIN alexande_apflora.DomainApErfKrit ON (alexande_apflora.tblJBer.JBerBeurteilung=DomainApErfKrit.BeurteilId)) LEFT JOIN alexande_apflora.tblAdresse ON (alexande_apflora.tblJBer.JBerBearb=alexande_apflora.tblAdresse.AdrId)) ON alexande_apflora.tblAktionsplan.ApArtId=alexande_apflora.tblJBer.ApArtId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vApJahresberichteUndMassnahmen AS
SELECT alexande_apflora.tblAktionsplan.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblAdresse.AdrName AS "AP Verantwortlich", alexande_apflora.tblAktionsplan.ApArtwert AS Artwert, alexande_apflora_views.vApAnzMassnProJahr.TPopMassnJahr AS Jahr, alexande_apflora_views.vApAnzMassnProJahr.AnzahlMassnahmen AS "Anzahl Massnahmen", alexande_apflora_views.vApAnzMassnBisJahr.AnzahlMassnahmen AS "Anzahl Massnahmen bisher", IF(alexande_apflora.tblJBer.JBerJahr>0,"Ja","Nein") AS "Bericht erstellt"
FROM ((((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAktionsplan.ApBearb = alexande_apflora.tblAdresse.AdrId) INNER JOIN alexande_apflora_views.vApAnzMassnProJahr ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora_views.vApAnzMassnProJahr.ApArtId) INNER JOIN alexande_apflora_views.vApAnzMassnBisJahr ON (alexande_apflora_views.vApAnzMassnProJahr.TPopMassnJahr = alexande_apflora_views.vApAnzMassnBisJahr.TPopMassnJahr) AND (alexande_apflora_views.vApAnzMassnProJahr.ApArtId = alexande_apflora_views.vApAnzMassnBisJahr.ApArtId)) LEFT JOIN alexande_apflora.tblJBer ON (alexande_apflora_views.vApAnzMassnBisJahr.TPopMassnJahr = alexande_apflora.tblJBer.JBerJahr) AND (alexande_apflora_views.vApAnzMassnBisJahr.ApArtId = alexande_apflora.tblJBer.ApArtId)
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora_views.vApAnzMassnProJahr.TPopMassnJahr;

CREATE OR REPLACE VIEW vLetzterTPopMassnBericht0 AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId, alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerJahr
FROM alexande_apflora.tblKonstanten, ((alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN alexande_apflora.tblTeilPopMassnBericht ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnBericht.TPopId) INNER JOIN alexande_apflora.tblTeilPopMassnahme ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnahme.TPopId
WHERE alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerJahr<=alexande_apflora.tblKonstanten.JBerJahr AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr<=alexande_apflora.tblKonstanten.JBerJahr AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11;

CREATE OR REPLACE VIEW vLetzterTPopMassnBericht AS
SELECT alexande_apflora_views.vLetzterTPopMassnBericht0.ApArtId, alexande_apflora_views.vLetzterTPopMassnBericht0.TPopId, Max(alexande_apflora_views.vLetzterTPopMassnBericht0.TPopMassnBerJahr) AS MaxvonTPopMassnBerJahr
FROM alexande_apflora_views.vLetzterTPopMassnBericht0
GROUP BY alexande_apflora_views.vLetzterTPopMassnBericht0.ApArtId, alexande_apflora_views.vLetzterTPopMassnBericht0.TPopId;

CREATE OR REPLACE VIEW vLetzterTPopBericht0 AS
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId, alexande_apflora.tblTeilPopBericht.TPopBerJahr
FROM alexande_apflora.tblKonstanten, alexande_apflora.tblAktionsplan INNER JOIN (alexande_apflora.tblPopulation INNER JOIN (alexande_apflora.tblTeilpopulation INNER JOIN alexande_apflora.tblTeilPopBericht ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopBericht.TPopId) ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
WHERE alexande_apflora.tblTeilPopBericht.TPopBerJahr<=alexande_apflora.tblKonstanten.JBerJahr And alexande_apflora.tblTeilPopBericht.TPopBerJahr>=alexande_apflora.tblAktionsplan.ApJahr AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11;

CREATE OR REPLACE VIEW vLetzterTPopBericht AS 
SELECT alexande_apflora_views.vLetzterTPopBericht0.ApArtId, alexande_apflora_views.vLetzterTPopBericht0.TPopId, Max(alexande_apflora_views.vLetzterTPopBericht0.TPopBerJahr) AS MaxvonTPopBerJahr
FROM alexande_apflora_views.vLetzterTPopBericht0
GROUP BY alexande_apflora_views.vLetzterTPopBericht0.ApArtId, alexande_apflora_views.vLetzterTPopBericht0.TPopId;

CREATE OR REPLACE VIEW vLetzterPopMassnBericht0 AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId, alexande_apflora.tblPopMassnBericht.PopMassnBerJahr
FROM alexande_apflora.tblKonstanten, ((alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblPopMassnBericht ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopMassnBericht.PopId) INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN alexande_apflora.tblTeilPopMassnahme ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnahme.TPopId
WHERE alexande_apflora.tblPopMassnBericht.PopMassnBerJahr<=alexande_apflora.tblKonstanten.JBerJahr AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr<=alexande_apflora.tblKonstanten.JBerJahr AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11;

CREATE OR REPLACE VIEW vLetzterPopMassnBericht AS 
SELECT alexande_apflora_views.vLetzterPopMassnBericht0.ApArtId, alexande_apflora_views.vLetzterPopMassnBericht0.PopId, Max(alexande_apflora_views.vLetzterPopMassnBericht0.PopMassnBerJahr) AS MaxvonPopMassnBerJahr
FROM alexande_apflora_views.vLetzterPopMassnBericht0
GROUP BY alexande_apflora_views.vLetzterPopMassnBericht0.ApArtId, alexande_apflora_views.vLetzterPopMassnBericht0.PopId;

CREATE OR REPLACE VIEW vLetzterPopBericht0 AS
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId, alexande_apflora.tblPopBericht.PopBerJahr
FROM alexande_apflora.tblKonstanten, (alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblPopBericht ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopBericht.PopId) INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblPopBericht.PopBerJahr<=alexande_apflora.tblKonstanten.JBerJahr AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11;

CREATE OR REPLACE VIEW vLetzterPopBericht AS
SELECT alexande_apflora_views.vLetzterPopBericht0.ApArtId, alexande_apflora_views.vLetzterPopBericht0.PopId, Max(alexande_apflora_views.vLetzterPopBericht0.PopBerJahr) AS MaxvonPopBerJahr
FROM alexande_apflora_views.vLetzterPopBericht0
GROUP BY alexande_apflora_views.vLetzterPopBericht0.ApArtId, alexande_apflora_views.vLetzterPopBericht0.PopId;

CREATE OR REPLACE VIEW vJbUebE AS 
SELECT alexande_apflora.tblJBer.*, alexande_beob.ArtenDb_Arteigenschaften.Artname, IF(alexande_beob.ArtenDb_Arteigenschaften.KefArt=-1,"Ja","") AS FnsKefArt2, alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr, IF(Round((alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,0)=(alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,"Ja","") AS FnsKefKontrJahr2, alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr AS FnsJahrespflanze, IF(alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr=alexande_apflora.tblKonstanten.JBerJahr,"Ja","") AS FnsJahrespflanze2, alexande_apflora_views.vApAnzMassnBisJahr.AnzahlMassnahmen
FROM alexande_apflora.tblKonstanten AS tblKonstanten_1 INNER JOIN ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN (alexande_apflora.tblAktionsplan INNER JOIN alexande_apflora_views.vApApBerichtRelevant ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora_views.vApApBerichtRelevant.ApArtId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN (alexande_apflora.tblKonstanten INNER JOIN (alexande_apflora.tblJBer INNER JOIN alexande_apflora_views.vApAnzMassnBisJahr ON alexande_apflora.tblJBer.ApArtId = alexande_apflora_views.vApAnzMassnBisJahr.ApArtId) ON alexande_apflora.tblKonstanten.JBerJahr = alexande_apflora.tblJBer.JBerJahr) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblJBer.ApArtId) ON tblKonstanten_1.JBerJahr = alexande_apflora_views.vApAnzMassnBisJahr.TPopMassnJahr 
WHERE alexande_apflora_views.vApAnzMassnBisJahr.AnzahlMassnahmen>0 AND alexande_apflora.tblJBer.JBerBeurteilung=1 AND alexande_apflora.tblAktionsplan.ApStatus Between 1 And 3
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vJbUebKm AS 
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname, IF(alexande_beob.ArtenDb_Arteigenschaften.KefArt=-1,"Ja","") AS FnsKefArt2, IF(Round((alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,0)=(alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,"Ja","") AS FnsKefKontrJahr2, alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr AS FnsJahrespflanze, IF(alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr=alexande_apflora.tblKonstanten.JBerJahr,"Ja","") AS FnsJahrespflanze2
FROM (alexande_beob.ArtenDb_Arteigenschaften INNER JOIN ((alexande_apflora_views.vApAnzMassnBisJahr AS vApAnzMassnBisJahr_1 INNER JOIN alexande_apflora.tblAktionsplan ON vApAnzMassnBisJahr_1.ApArtId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN alexande_apflora_views.vApApBerichtRelevant ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora_views.vApApBerichtRelevant.ApArtId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN (alexande_apflora.tblJBer INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblJBer.JBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON (alexande_apflora.tblKonstanten.JBerJahr = vApAnzMassnBisJahr_1.TPopMassnJahr) AND (alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblJBer.ApArtId)
WHERE alexande_apflora.tblAktionsplan.ApStatus Between 1 And 3 AND vApAnzMassnBisJahr_1.AnzahlMassnahmen="0"
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vJbUebMa AS 
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora_views.vApAnzMassnBisJahr.AnzahlMassnahmen
FROM alexande_apflora.tblKonstanten INNER JOIN ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN (alexande_apflora.tblAktionsplan INNER JOIN alexande_apflora_views.vApApBerichtRelevant ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora_views.vApApBerichtRelevant.ApArtId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN alexande_apflora_views.vApAnzMassnBisJahr ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora_views.vApAnzMassnBisJahr.ApArtId) ON alexande_apflora.tblKonstanten.JBerJahr = alexande_apflora_views.vApAnzMassnBisJahr.TPopMassnJahr
WHERE alexande_apflora_views.vApAnzMassnBisJahr.AnzahlMassnahmen>0 AND alexande_apflora.tblAktionsplan.ApStatus Between 1 And 3
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vJbUebMe AS
SELECT alexande_apflora.tblJBer.*, alexande_beob.ArtenDb_Arteigenschaften.Artname, IF("KefArt"=-1,"Ja","") AS FnsKefArt2, IF(Round((alexande_apflora.tblKonstanten.JBerJahr-"KefKontrolljahr")/4,0)=(alexande_apflora.tblKonstanten.JBerJahr-"KefKontrolljahr")/4,"Ja","") AS FnsKefKontrJahr2, alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr AS FnsJahrespflanze, IF(alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr=alexande_apflora.tblKonstanten.JBerJahr,"Ja","") AS FnsJahrespflanze2
FROM alexande_apflora.tblKonstanten AS tblKonstanten_1 INNER JOIN ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN (alexande_apflora.tblAktionsplan INNER JOIN alexande_apflora_views.vApApBerichtRelevant ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora_views.vApApBerichtRelevant.ApArtId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN ((alexande_apflora.tblJBer INNER JOIN alexande_apflora_views.vApAnzMassnBisJahr ON alexande_apflora.tblJBer.ApArtId = alexande_apflora_views.vApAnzMassnBisJahr.ApArtId) INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblJBer.JBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblJBer.ApArtId) ON tblKonstanten_1.JBerJahr = alexande_apflora_views.vApAnzMassnBisJahr.TPopMassnJahr
WHERE alexande_apflora.tblJBer.JBerBeurteilung=5 AND alexande_apflora_views.vApAnzMassnBisJahr.AnzahlMassnahmen>0 AND alexande_apflora.tblAktionsplan.ApStatus Between 1 And 3
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vJbUebNe AS
SELECT alexande_apflora.tblJBer.*, alexande_beob.ArtenDb_Arteigenschaften.Artname, IF(alexande_beob.ArtenDb_Arteigenschaften.KefArt=-1,"Ja","") AS FnsKefArt2, IF(Round((alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,0)=(alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,"Ja","") AS FnsKefKontrJahr2, alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr AS FnsJahrespflanze, IF(alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr=alexande_apflora.tblKonstanten.JBerJahr,"Ja","") AS FnsJahrespflanze2
FROM alexande_apflora.tblKonstanten AS tblKonstanten_1 INNER JOIN ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN (alexande_apflora.tblAktionsplan INNER JOIN alexande_apflora_views.vApApBerichtRelevant ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora_views.vApApBerichtRelevant.ApArtId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN ((alexande_apflora.tblJBer INNER JOIN alexande_apflora_views.vApAnzMassnBisJahr ON alexande_apflora.tblJBer.ApArtId = alexande_apflora_views.vApAnzMassnBisJahr.ApArtId) INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblJBer.JBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblJBer.ApArtId) ON tblKonstanten_1.JBerJahr = alexande_apflora_views.vApAnzMassnBisJahr.TPopMassnJahr
WHERE alexande_apflora.tblJBer.JBerBeurteilung=3 AND alexande_apflora.tblAktionsplan.ApStatus Between 1 And 3 AND alexande_apflora_views.vApAnzMassnBisJahr.AnzahlMassnahmen>0
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vJbUebSe AS 
SELECT alexande_apflora.tblJBer.*, alexande_beob.ArtenDb_Arteigenschaften.Artname, IF(alexande_beob.ArtenDb_Arteigenschaften.KefArt=-1,"Ja","") AS FnsKefArt2, IF(Round((alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,0)=(alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,"Ja","") AS FnsKefKontrJahr2, alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr AS FnsJahrespflanze, IF(alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr=alexande_apflora.tblKonstanten.JBerJahr,"Ja","") AS FnsJahrespflanze2
FROM alexande_apflora.tblKonstanten AS tblKonstanten_1 INNER JOIN ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN (alexande_apflora.tblAktionsplan INNER JOIN alexande_apflora_views.vApApBerichtRelevant ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora_views.vApApBerichtRelevant.ApArtId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN ((alexande_apflora.tblJBer INNER JOIN alexande_apflora_views.vApAnzMassnBisJahr ON alexande_apflora.tblJBer.ApArtId = alexande_apflora_views.vApAnzMassnBisJahr.ApArtId) INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblJBer.JBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblJBer.ApArtId) ON tblKonstanten_1.JBerJahr = alexande_apflora_views.vApAnzMassnBisJahr.TPopMassnJahr
WHERE alexande_apflora.tblJBer.JBerBeurteilung=4 AND alexande_apflora_views.vApAnzMassnBisJahr.AnzahlMassnahmen>0 AND alexande_apflora.tblAktionsplan.ApStatus Between 1 And 3
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vJbUebUn AS
SELECT alexande_apflora.tblJBer.*, alexande_beob.ArtenDb_Arteigenschaften.Artname, IF(alexande_beob.ArtenDb_Arteigenschaften.KefArt=-1,"Ja","") AS FnsKefArt2, IF(Round((alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,0)=(alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,"Ja","") AS FnsKefKontrJahr2, alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr AS FnsJahrespflanze, IF(alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr=alexande_apflora.tblKonstanten.JBerJahr,"Ja","") AS FnsJahrespflanze2
FROM alexande_apflora.tblKonstanten AS tblKonstanten_1 INNER JOIN ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN (alexande_apflora.tblAktionsplan INNER JOIN alexande_apflora_views.vApApBerichtRelevant ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora_views.vApApBerichtRelevant.ApArtId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN ((alexande_apflora.tblJBer INNER JOIN alexande_apflora_views.vApAnzMassnBisJahr ON alexande_apflora.tblJBer.ApArtId = alexande_apflora_views.vApAnzMassnBisJahr.ApArtId) INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblJBer.JBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblJBer.ApArtId) ON tblKonstanten_1.JBerJahr = alexande_apflora_views.vApAnzMassnBisJahr.TPopMassnJahr
WHERE alexande_apflora.tblJBer.JBerBeurteilung=1168274204 AND alexande_apflora_views.vApAnzMassnBisJahr.AnzahlMassnahmen>0 AND alexande_apflora.tblAktionsplan.ApStatus Between 1 And 3
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vJbUebWe AS 
SELECT alexande_apflora.tblJBer.*, alexande_beob.ArtenDb_Arteigenschaften.Artname, IF(alexande_beob.ArtenDb_Arteigenschaften.KefArt=-1,"Ja","") AS FnsKefArt2, IF(Round((alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,0)=(alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,"Ja","") AS FnsKefKontrJahr2, alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr AS FnsJahrespflanze, IF(alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr=alexande_apflora.tblKonstanten.JBerJahr,"Ja","") AS FnsJahrespflanze2
FROM alexande_apflora.tblKonstanten AS tblKonstanten_1 INNER JOIN ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN (alexande_apflora.tblAktionsplan INNER JOIN alexande_apflora_views.vApApBerichtRelevant ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora_views.vApApBerichtRelevant.ApArtId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN ((alexande_apflora.tblJBer INNER JOIN alexande_apflora_views.vApAnzMassnBisJahr ON alexande_apflora.tblJBer.ApArtId = alexande_apflora_views.vApAnzMassnBisJahr.ApArtId) INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblJBer.JBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblJBer.ApArtId) ON tblKonstanten_1.JBerJahr = alexande_apflora_views.vApAnzMassnBisJahr.TPopMassnJahr
WHERE alexande_apflora.tblJBer.JBerBeurteilung=6 AND alexande_apflora_views.vApAnzMassnBisJahr.AnzahlMassnahmen>0 AND alexande_apflora.tblAktionsplan.ApStatus Between 1 And 3
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vJbUebNichtBeurteilt000 AS 
SELECT alexande_apflora.tblAktionsplan.ApArtId, alexande_apflora.tblJBer.JBerJahr
FROM (((alexande_apflora.tblAktionsplan INNER JOIN alexande_apflora_views.vApAnzMassnBisJahr ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora_views.vApAnzMassnBisJahr.ApArtId) INNER JOIN alexande_apflora_views.vApApBerichtRelevant ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora_views.vApApBerichtRelevant.ApArtId) LEFT JOIN alexande_apflora.tblJBer ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblJBer.ApArtId) INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora_views.vApAnzMassnBisJahr.TPopMassnJahr = alexande_apflora.tblKonstanten.JBerJahr
WHERE alexande_apflora.tblJBer.ApArtId Is Null AND alexande_apflora.tblAktionsplan.ApStatus Between 1 And 3;

CREATE OR REPLACE VIEW vJbUebNichtBeurteilt00 AS 
SELECT alexande_apflora.tblAktionsplan.ApArtId, alexande_apflora.tblJBer.JBerJahr
FROM alexande_apflora.tblKonstanten AS tblKonstanten_1 INNER JOIN (((alexande_apflora.tblAktionsplan INNER JOIN alexande_apflora_views.vApAnzMassnBisJahr ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora_views.vApAnzMassnBisJahr.ApArtId) INNER JOIN alexande_apflora_views.vApApBerichtRelevant ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora_views.vApApBerichtRelevant.ApArtId) INNER JOIN (alexande_apflora.tblJBer INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblJBer.JBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblJBer.ApArtId) ON tblKonstanten_1.JBerJahr = alexande_apflora_views.vApAnzMassnBisJahr.TPopMassnJahr
WHERE alexande_apflora.tblAktionsplan.ApStatus Between 1 And 3 AND alexande_apflora.tblJBer.JBerBeurteilung Is Null;

CREATE OR REPLACE VIEW vJbUebNichtBeurteilt0 AS 
select ApArtId, JBerJahr from alexande_apflora_views.vJbUebNichtBeurteilt000
UNION select ApArtId, JBerJahr from alexande_apflora_views.vJbUebNichtBeurteilt00;

CREATE OR REPLACE VIEW vJbUebNichtBeurteilt AS 
SELECT alexande_apflora.tblAktionsplan.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora_views.vFnsKef.FnsKefArt2, alexande_apflora_views.vFnsKef.FnsKefKontrJahr2, alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr AS FnsJahrespflanze, IF(alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr=alexande_apflora_views.vJbUebNichtBeurteilt0.JBerJahr,"Ja","") AS FnsJahrespflanze2
FROM ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) LEFT JOIN alexande_apflora_views.vFnsKef ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora_views.vFnsKef.TaxonomieId) INNER JOIN alexande_apflora_views.vJbUebNichtBeurteilt0 ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora_views.vJbUebNichtBeurteilt0.ApArtId
WHERE alexande_apflora.tblAktionsplan.ApStatus Between 1 And 3
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vJbUeT01 AS 
SELECT alexande_apflora.tblAktionsplan.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname
FROM ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN (alexande_apflora.tblAktionsplan INNER JOIN alexande_apflora_views.vApApBerichtRelevant ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora_views.vApApBerichtRelevant.ApArtId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN alexande_apflora_views.vApAnzMassnBisJahr ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora_views.vApAnzMassnBisJahr.ApArtId) INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora_views.vApAnzMassnBisJahr.TPopMassnJahr = alexande_apflora.tblKonstanten.JBerJahr
WHERE alexande_apflora.tblAktionsplan.ApStatus Between 1 And 3 AND alexande_apflora_views.vApAnzMassnBisJahr.AnzahlMassnahmen>"0"
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vKontrApArtTPopOhneStatus AS 
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "Bearbeitungsstand AP", alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, DomainPopHerkunft.HerkunftTxt AS "Status Population", alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilpopulation.TPopFlurname, alexande_apflora.tblTeilpopulation.TPopHerkunft AS "Status Teilpopulation"
FROM (alexande_apflora.DomainApBearbeitungsstand INNER JOIN (alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) ON alexande_apflora.DomainApBearbeitungsstand.DomainCode = alexande_apflora.tblAktionsplan.ApStatus) INNER JOIN ((alexande_apflora.tblPopulation INNER JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
WHERE alexande_apflora.tblTeilpopulation.TPopHerkunft Is Null AND alexande_apflora.tblAktionsplan.ApStatus=3
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr;

CREATE OR REPLACE VIEW vTPopOhneBekanntSeit AS 
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS ApStatus_, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilpopulation.TPopGemeinde, alexande_apflora.tblTeilpopulation.TPopFlurname, alexande_apflora.tblTeilpopulation.TPopBekanntSeit
FROM ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) INNER JOIN (alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
WHERE alexande_apflora.tblTeilpopulation.TPopBekanntSeit Is Null AND alexande_apflora.tblAktionsplan.ApStatus Between 1 And 3
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilpopulation.TPopGemeinde, alexande_apflora.tblTeilpopulation.TPopFlurname;

CREATE OR REPLACE VIEW vKontrTPopKoorLeer AS 
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS ApStatus_, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilpopulation.TPopGemeinde, alexande_apflora.tblTeilpopulation.TPopFlurname, alexande_apflora.tblTeilpopulation.TPopXKoord, alexande_apflora.tblTeilpopulation.TPopYKoord
FROM ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) INNER JOIN (alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
WHERE (alexande_apflora.tblTeilpopulation.TPopXKoord Is Null AND alexande_apflora.tblAktionsplan.ApStatus Between 1 And 3) OR (alexande_apflora.tblTeilpopulation.TPopYKoord Is Null AND alexande_apflora.tblAktionsplan.ApStatus Between 1 And 3)
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilpopulation.TPopGemeinde, alexande_apflora.tblTeilpopulation.TPopFlurname;

CREATE OR REPLACE VIEW vTPopBerLetzterBericht AS 
SELECT alexande_apflora.tblTeilPopBericht.TPopId, Max(alexande_apflora.tblTeilPopBericht.TPopBerJahr) AS MaxvonTPopBerJahr
FROM alexande_apflora.tblTeilPopBericht
GROUP BY alexande_apflora.tblTeilPopBericht.TPopId;

CREATE OR REPLACE VIEW vKontrTPopStatusErloschen AS 
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "Bearbeitungsstand AP", alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilpopulation.TPopGemeinde, alexande_apflora.tblTeilpopulation.TPopFlurname, alexande_apflora.tblTeilpopulation.TPopHerkunft, alexande_apflora.tblTeilPopBericht.TPopBerEntwicklung, alexande_apflora.tblTeilPopBericht.TPopBerJahr
FROM ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN (alexande_apflora.tblPopulation INNER JOIN (alexande_apflora.tblTeilpopulation INNER JOIN (alexande_apflora.tblTeilPopBericht INNER JOIN alexande_apflora_views.vTPopBerLetzterBericht ON (alexande_apflora.tblTeilPopBericht.TPopId = alexande_apflora_views.vTPopBerLetzterBericht.TPopId) AND (alexande_apflora.tblTeilPopBericht.TPopBerJahr = alexande_apflora_views.vTPopBerLetzterBericht.MaxvonTPopBerJahr)) ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopBericht.TPopId) ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode
WHERE ((alexande_apflora.tblAktionsplan.ApStatus Between 1 And 3) AND ((alexande_apflora.tblTeilpopulation.TPopHerkunft)=4 Or (alexande_apflora.tblTeilpopulation.TPopHerkunft)=7) AND ((alexande_apflora.tblTeilPopBericht.TPopBerEntwicklung)<>8)) OR (((alexande_apflora.tblAktionsplan.ApStatus) Between 1 And 3) AND ((alexande_apflora.tblTeilpopulation.TPopHerkunft) Not Like 4 And (alexande_apflora.tblTeilpopulation.TPopHerkunft) Not Like 7) AND ((alexande_apflora.tblTeilPopBericht.TPopBerEntwicklung)=8))
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilpopulation.TPopGemeinde, alexande_apflora.tblTeilpopulation.TPopFlurname;

#im Gebrauch (Access):
CREATE OR REPLACE VIEW vBerJb AS 
SELECT alexande_apflora.tblAktionsplan.*, alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.tblJBer.JBerId, alexande_apflora.tblJBer.JBerJahr, alexande_apflora.tblJBer.JBerSituation, alexande_apflora.tblJBer.JBerVergleichVorjahrGesamtziel, alexande_apflora.tblJBer.JBerBeurteilung, alexande_apflora.tblJBer.JBerAnalyse, alexande_apflora.tblJBer.JBerUmsetzung, alexande_apflora.tblJBer.JBerErfko, alexande_apflora.tblJBer.JBerATxt, alexande_apflora.tblJBer.JBerBTxt, alexande_apflora.tblJBer.JBerCTxt, alexande_apflora.tblJBer.JBerDTxt, alexande_apflora.tblJBer.JBerDatum, alexande_apflora.tblJBer.JBerBearb, alexande_apflora.tblAdresse.AdrName & ", " & alexande_apflora.tblAdresse.AdrAdresse AS Bearbeiter, alexande_apflora.tblJBerUebersicht.JbuJahr, alexande_apflora.tblJBerUebersicht.JbuBemerkungen, alexande_apflora_views.vErsteMassnahmeProArt.MinvonTPopMassnJahr AS ErsteMassnahmeImJahr
FROM (alexande_beob.ArtenDb_Arteigenschaften INNER JOIN (alexande_apflora.tblAktionsplan LEFT JOIN alexande_apflora_views.vErsteMassnahmeProArt ON alexande_apflora.tblAktionsplan.ApArtId=alexande_apflora_views.vErsteMassnahmeProArt.ApArtId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId=alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN (((alexande_apflora.tblJBer LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblJBer.JBerBearb=alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.tblJBerUebersicht ON alexande_apflora.tblJBer.JBerJahr=alexande_apflora.tblJBerUebersicht.JbuJahr) INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblJBer.JBerJahr=alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblAktionsplan.ApArtId=alexande_apflora.tblJBer.ApArtId
WHERE alexande_apflora.tblAktionsplan.ApStatus Between 1 And 3
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vAuswAp AS 
SELECT alexande_apflora.tblAktionsplan.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "Bearbeitungsstand AP", alexande_apflora.tblAktionsplan.ApJahr AS "Start AP im Jahr", DomainApUmsetzung.DomainTxt AS "Stand Umsetzung AP", alexande_apflora.tblAdresse.AdrName AS "Verantwortlich", alexande_apflora.tblAktionsplan.MutWann AS "Letzte Änderung", alexande_apflora.tblAktionsplan.MutWer AS "Letzte(r) Bearbeiter(in)"
FROM (((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAktionsplan.ApBearb = alexande_apflora.tblAdresse.AdrId
WHERE (((alexande_apflora.tblAktionsplan.ApStatus) Between 1 And 3))
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vProgramme AS 
SELECT alexande_apflora.tblAktionsplan.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Bearbeitungsstand", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblAdresse.AdrName AS "AP verantwortlich", alexande_apflora.tblAktionsplan.MutWann AS "AP Letzte Änderung", alexande_apflora.tblAktionsplan.MutWer AS "AP Letzte(r) Bearbeiter(in)"
FROM (((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAktionsplan.ApBearb = alexande_apflora.tblAdresse.AdrId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vIdealbiotop AS 
SELECT alexande_apflora.tblAktionsplan.ApArtId AS "AP ApArtId", alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Bearbeitungsstand", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblAdresse.AdrName AS "AP verantwortlich", alexande_apflora.tblAktionsplan.MutWann AS "AP Letzte Änderung", alexande_apflora.tblAktionsplan.MutWer AS "AP Letzte(r) Bearbeiter(in)", alexande_apflora.tblIdealbiotop.IbApArtId AS "Ib ApArtId", alexande_apflora.tblIdealbiotop.IbErstelldatum AS "Ib Erstelldatum", alexande_apflora.tblIdealbiotop.IbHoehenlage AS "Ib Hoehenlage", alexande_apflora.tblIdealbiotop.IbRegion AS "Ib Region", alexande_apflora.tblIdealbiotop.IbExposition AS "Ib Exposition", alexande_apflora.tblIdealbiotop.IbBesonnung AS "Ib Besonnung", alexande_apflora.tblIdealbiotop.IbHangneigung AS "Ib Hangneigung", alexande_apflora.tblIdealbiotop.IbBodenTyp AS "Ib Bodentyp", alexande_apflora.tblIdealbiotop.IbBodenKalkgehalt AS "Ib Boden Kalkgehalt", alexande_apflora.tblIdealbiotop.IbBodenDurchlaessigkeit AS "Ib Boden Durchlaessigkeit", alexande_apflora.tblIdealbiotop.IbBodenHumus AS "Ib Boden Humus", alexande_apflora.tblIdealbiotop.IbBodenNaehrstoffgehalt AS "Ib Boden Naehrstoffgehalt", alexande_apflora.tblIdealbiotop.IbWasserhaushalt AS "Ib Wasserhaushalt", alexande_apflora.tblIdealbiotop.IbKonkurrenz AS "Ib Konkurrenz", alexande_apflora.tblIdealbiotop.IbMoosschicht AS "Ib Moosschicht", alexande_apflora.tblIdealbiotop.IbKrautschicht AS "Ib Krautschicht", alexande_apflora.tblIdealbiotop.IbStrauchschicht AS "Ib Strauchschicht", alexande_apflora.tblIdealbiotop.IbBaumschicht AS "Ib Baumschicht", alexande_apflora.tblIdealbiotop.IbBemerkungen AS "Ib Bemerkungen", alexande_apflora.tblIdealbiotop.MutWann AS "Ib MutWann", alexande_apflora.tblIdealbiotop.MutWer AS "Ib MutWer"
FROM alexande_apflora.tblIdealbiotop LEFT JOIN ((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAktionsplan.ApBearb = alexande_apflora.tblAdresse.AdrId) ON alexande_apflora.tblIdealbiotop.IbApArtId = alexande_apflora.tblAktionsplan.ApArtId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblIdealbiotop.IbErstelldatum;

CREATE OR REPLACE VIEW vIdealbiotopOhneAp AS 
SELECT alexande_apflora.tblAktionsplan.ApArtId AS "AP ApArtId", alexande_apflora.tblIdealbiotop.IbApArtId AS "Ib ApArtId", alexande_apflora.tblIdealbiotop.IbErstelldatum AS "Ib Erstelldatum", alexande_apflora.tblIdealbiotop.IbHoehenlage AS "Ib Hoehenlage", alexande_apflora.tblIdealbiotop.IbRegion AS "Ib Region", alexande_apflora.tblIdealbiotop.IbExposition AS "Ib Exposition", alexande_apflora.tblIdealbiotop.IbBesonnung AS "Ib Besonnung", alexande_apflora.tblIdealbiotop.IbHangneigung AS "Ib Hangneigung", alexande_apflora.tblIdealbiotop.IbBodenTyp AS "Ib Bodentyp", alexande_apflora.tblIdealbiotop.IbBodenKalkgehalt AS "Ib Boden Kalkgehalt", alexande_apflora.tblIdealbiotop.IbBodenDurchlaessigkeit AS "Ib Boden Durchlaessigkeit", alexande_apflora.tblIdealbiotop.IbBodenHumus AS "Ib Boden Humus", alexande_apflora.tblIdealbiotop.IbBodenNaehrstoffgehalt AS "Ib Boden Naehrstoffgehalt", alexande_apflora.tblIdealbiotop.IbWasserhaushalt AS "Ib Wasserhaushalt", alexande_apflora.tblIdealbiotop.IbKonkurrenz AS "Ib Konkurrenz", alexande_apflora.tblIdealbiotop.IbMoosschicht AS "Ib Moosschicht", alexande_apflora.tblIdealbiotop.IbKrautschicht AS "Ib Krautschicht", alexande_apflora.tblIdealbiotop.IbStrauchschicht AS "Ib Strauchschicht", alexande_apflora.tblIdealbiotop.IbBaumschicht AS "Ib Baumschicht", alexande_apflora.tblIdealbiotop.IbBemerkungen AS "Ib Bemerkungen", alexande_apflora.tblIdealbiotop.MutWann AS "Ib MutWann", alexande_apflora.tblIdealbiotop.MutWer AS "Ib MutWer"
FROM alexande_apflora.tblIdealbiotop LEFT JOIN ((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAktionsplan.ApBearb = alexande_apflora.tblAdresse.AdrId) ON alexande_apflora.tblIdealbiotop.IbApArtId = alexande_apflora.tblAktionsplan.ApArtId
WHERE alexande_apflora.tblAktionsplan.ApArtId is Null
ORDER BY alexande_apflora.tblIdealbiotop.IbErstelldatum;

CREATE OR REPLACE VIEW vBer AS
SELECT alexande_apflora.tblAktionsplan.ApArtId AS "AP Id", alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Bearbeitungsstand", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblAdresse.AdrName AS "AP verantwortlich", alexande_apflora.tblBer.BerId AS "Ber Id", alexande_apflora.tblBer.ApArtId AS "Ber ApId", alexande_apflora.tblBer.BerAutor AS "Ber Autor", alexande_apflora.tblBer.BerJahr AS "Ber Jahr", alexande_apflora.tblBer.BerTitel AS "Ber Titel", alexande_apflora.tblBer.BerURL AS "Ber URL", alexande_apflora.tblBer.MutWann AS "Ber MutWann", alexande_apflora.tblBer.MutWer AS "Ber MutWer"
FROM ((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAktionsplan.ApBearb = alexande_apflora.tblAdresse.AdrId) RIGHT JOIN alexande_apflora.tblBer ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblBer.ApArtId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vBerOhneAp AS
SELECT alexande_apflora.tblAktionsplan.ApArtId AS "AP Id", alexande_apflora.tblBer.BerId AS "Ber Id", alexande_apflora.tblBer.ApArtId AS "Ber ApId", alexande_apflora.tblBer.BerAutor AS "Ber Autor", alexande_apflora.tblBer.BerJahr AS "Ber Jahr", alexande_apflora.tblBer.BerTitel AS "Ber Titel", alexande_apflora.tblBer.BerURL AS "Ber URL", alexande_apflora.tblBer.MutWann AS "Ber MutWann", alexande_apflora.tblBer.MutWer AS "Ber MutWer"
FROM ((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAktionsplan.ApBearb = alexande_apflora.tblAdresse.AdrId) RIGHT JOIN alexande_apflora.tblBer ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblBer.ApArtId
WHERE alexande_apflora.tblAktionsplan.ApArtId is Null
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vAssozArten AS
SELECT alexande_apflora.tblAktionsplan.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Bearbeitungsstand", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblAdresse.AdrName AS "AP verantwortlich", alexande_apflora.tblAssozArten.AaId AS "AA Id", ArtenDb_Arteigenschaften_1.Artname AS "AA Art", alexande_apflora.tblAssozArten.AaBem AS "AA Bemerkungen", alexande_apflora.tblAssozArten.MutWann AS "AA MutWann", alexande_apflora.tblAssozArten.MutWer AS "AA MutWer"
FROM alexande_beob.ArtenDb_Arteigenschaften AS ArtenDb_Arteigenschaften_1 RIGHT JOIN (((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAktionsplan.ApBearb = alexande_apflora.tblAdresse.AdrId) RIGHT JOIN alexande_apflora.tblAssozArten ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblAssozArten.AaApArtId) ON ArtenDb_Arteigenschaften_1.TaxonomieId = alexande_apflora.tblAssozArten.AaSisfNr
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vAssozArtenOhneAp AS
SELECT alexande_apflora.tblAktionsplan.ApArtId AS "AP ApArtId", alexande_apflora.tblAssozArten.AaId AS "AA Id", alexande_apflora.tblAssozArten.AaApArtId AS "AA ApArtId", ArtenDb_Arteigenschaften_1.Artname AS "AA Art", alexande_apflora.tblAssozArten.AaBem AS "AA Bemerkungen", alexande_apflora.tblAssozArten.MutWann AS "AA MutWann", alexande_apflora.tblAssozArten.MutWer AS "AA MutWer"
FROM alexande_beob.ArtenDb_Arteigenschaften AS ArtenDb_Arteigenschaften_1 RIGHT JOIN (((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAktionsplan.ApBearb = alexande_apflora.tblAdresse.AdrId) RIGHT JOIN alexande_apflora.tblAssozArten ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblAssozArten.AaApArtId) ON ArtenDb_Arteigenschaften_1.TaxonomieId = alexande_apflora.tblAssozArten.AaSisfNr
WHERE alexande_apflora.tblAktionsplan.ApArtId is Null
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vApOhnePop AS 
SELECT alexande_apflora.tblAktionsplan.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "Bearbeitungsstand AP", alexande_apflora.tblAktionsplan.ApJahr AS "Start AP im Jahr", DomainApUmsetzung.DomainTxt AS "Stand Umsetzung AP", alexande_apflora.tblAdresse.AdrName AS "Verantwortlich", alexande_apflora.tblPopulation.ApArtId AS "Population"
FROM ((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAktionsplan.ApBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.tblPopulation ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
WHERE (((alexande_apflora.tblPopulation.ApArtId) Is Null))
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vApArtenAnzKontrInJahr AS
SELECT alexande_apflora.tblAktionsplan.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrId, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr
FROM (alexande_apflora.tblAktionsplan INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON alexande_apflora.tblAktionsplan.ApArtId = alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId) INNER JOIN (alexande_apflora.tblPopulation INNER JOIN (alexande_apflora.tblTeilpopulation INNER JOIN alexande_apflora.tblTeilPopFeldkontrolle ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopFeldkontrolle.TPopId) ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
WHERE (((alexande_apflora.tblAktionsplan.ApStatus) Between 1 And 3))
GROUP BY alexande_apflora.tblAktionsplan.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrId, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr;

CREATE OR REPLACE VIEW vErfKrit AS
SELECT alexande_apflora.tblAktionsplan.ApArtId AS "AP Id", alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblAdresse.AdrName AS "AP verantwortlich", alexande_apflora.tblErfKrit.ErfkritId AS "ErfKrit Id", alexande_apflora.tblErfKrit.ApArtId AS "ErfKrit ApId", DomainApErfKrit.BeurteilTxt AS "ErfKrit Beurteilung", alexande_apflora.tblErfKrit.ErfkritTxt AS "ErfKrit Kriterien", alexande_apflora.tblErfKrit.MutWann AS "ErfKrit MutWann", alexande_apflora.tblErfKrit.MutWer AS "ErfKrit MutWer"
FROM (((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAktionsplan.ApBearb = alexande_apflora.tblAdresse.AdrId) RIGHT JOIN alexande_apflora.tblErfKrit ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblErfKrit.ApArtId) LEFT JOIN alexande_apflora.DomainApErfKrit ON alexande_apflora.tblErfKrit.ErfkritErreichungsgrad = DomainApErfKrit.BeurteilId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vErfKritOhneAp AS
SELECT alexande_apflora.tblAktionsplan.ApArtId AS "AP Id", alexande_apflora.tblErfKrit.ErfkritId AS "ErfKrit Id", alexande_apflora.tblErfKrit.ApArtId AS "ErfKrit ApId", DomainApErfKrit.BeurteilTxt AS "ErfKrit Beurteilung", alexande_apflora.tblErfKrit.ErfkritTxt AS "ErfKrit Kriterien", alexande_apflora.tblErfKrit.MutWann AS "ErfKrit MutWann", alexande_apflora.tblErfKrit.MutWer AS "ErfKrit MutWer"
FROM (((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAktionsplan.ApBearb = alexande_apflora.tblAdresse.AdrId) RIGHT JOIN alexande_apflora.tblErfKrit ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblErfKrit.ApArtId) LEFT JOIN alexande_apflora.DomainApErfKrit ON alexande_apflora.tblErfKrit.ErfkritErreichungsgrad = DomainApErfKrit.BeurteilId
WHERE alexande_apflora.tblAktionsplan.ApArtId is Null
ORDER BY alexande_apflora.DomainApErfKrit.BeurteilTxt, alexande_apflora.tblErfKrit.ErfkritTxt;

CREATE OR REPLACE VIEW vAuswApArtenAnzMassnInJahr0 AS
SELECT alexande_apflora.tblAktionsplan.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblTeilPopMassnahme.TPopMassnId, alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr
FROM (alexande_apflora.tblAktionsplan INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON alexande_apflora.tblAktionsplan.ApArtId = alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId) INNER JOIN ((alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN alexande_apflora.tblTeilPopMassnahme ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnahme.TPopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
WHERE (((alexande_apflora.tblAktionsplan.ApStatus) Between 1 And 3))
GROUP BY alexande_apflora.tblAktionsplan.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblTeilPopMassnahme.TPopMassnId, alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr;

CREATE OR REPLACE VIEW vAuswApArtenBearbMassnInJahr0 AS 
SELECT alexande_apflora.tblAdresse.AdrName, alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilpopulation.TPopGemeinde, alexande_apflora.tblTeilpopulation.TPopFlurname, alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr, DomainTPopMassnTyp.MassnTypTxt AS TPopMassnTyp, alexande_apflora.tblTeilPopMassnahme.TPopMassnTxt, alexande_apflora.tblTeilPopMassnahme.TPopMassnDatum, alexande_apflora.tblTeilPopMassnahme.TPopMassnBemTxt, alexande_apflora.tblTeilPopMassnahme.TPopMassnPlan, alexande_apflora.tblTeilPopMassnahme.TPopMassnPlanBez, alexande_apflora.tblTeilPopMassnahme.TPopMassnFlaeche, alexande_apflora.tblTeilPopMassnahme.TPopMassnMarkierung, alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedAnzTriebe, alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedAnzPfl, alexande_apflora.tblTeilPopMassnahme.TPopMassnAnzPflanzstellen, alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedWirtspfl, alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedHerkunftPop, alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedDatSamm, alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedForm, alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedPflanzanordnung
FROM (alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN ((alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN ((alexande_apflora.tblTeilPopMassnahme LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilPopMassnahme.TPopMassnBearb = alexande_apflora.tblAdresse.AdrId) INNER JOIN alexande_apflora.DomainTPopMassnTyp ON alexande_apflora.tblTeilPopMassnahme.TPopMassnTyp = DomainTPopMassnTyp.MassnTypCode) ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnahme.TPopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
WHERE (((alexande_apflora.tblAktionsplan.ApStatus) Between 1 And 3))
ORDER BY alexande_apflora.tblAdresse.AdrName, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilpopulation.TPopGemeinde, alexande_apflora.tblTeilpopulation.TPopFlurname;

CREATE OR REPLACE VIEW vAuswApArtenMitMassnInJahr0 AS 
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilpopulation.TPopGemeinde, alexande_apflora.tblTeilpopulation.TPopFlurname, alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr, DomainTPopMassnTyp.MassnTypTxt AS TPopMassnTyp, alexande_apflora.tblTeilPopMassnahme.TPopMassnTxt, alexande_apflora.tblTeilPopMassnahme.TPopMassnDatum, alexande_apflora.tblAdresse.AdrName AS TPopMassnBearb, alexande_apflora.tblTeilPopMassnahme.TPopMassnBemTxt, alexande_apflora.tblTeilPopMassnahme.TPopMassnPlan, alexande_apflora.tblTeilPopMassnahme.TPopMassnPlanBez, alexande_apflora.tblTeilPopMassnahme.TPopMassnFlaeche, alexande_apflora.tblTeilPopMassnahme.TPopMassnMarkierung, alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedAnzTriebe, alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedAnzPfl, alexande_apflora.tblTeilPopMassnahme.TPopMassnAnzPflanzstellen, alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedWirtspfl, alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedHerkunftPop, alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedDatSamm, alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedForm, alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedPflanzanordnung
FROM (alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN ((alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN ((alexande_apflora.tblTeilPopMassnahme INNER JOIN alexande_apflora.DomainTPopMassnTyp ON alexande_apflora.tblTeilPopMassnahme.TPopMassnTyp = DomainTPopMassnTyp.MassnTypCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilPopMassnahme.TPopMassnBearb = alexande_apflora.tblAdresse.AdrId) ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnahme.TPopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
WHERE (((alexande_apflora.tblAktionsplan.ApStatus) Between 1 And 3))
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilpopulation.TPopGemeinde, alexande_apflora.tblTeilpopulation.TPopFlurname;

CREATE OR REPLACE VIEW vAuswArtPopTPopMassnBerFuerAktArt0 AS
SELECT alexande_apflora.tblAktionsplan.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "Aktionsplan-Status", alexande_apflora.tblAktionsplan.ApJahr AS "Aktionsplan-Jahr", DomainApUmsetzung.DomainTxt AS "Aktionsplan-Umsetzung", alexande_apflora.tblPopulation.PopNr AS "Population-Nr", alexande_apflora.tblPopulation.PopName AS "Population-Name", DomainPopHerkunft.HerkunftTxt AS "Population-Herkunft", alexande_apflora.tblPopulation.PopBekanntSeit AS "Population - bekannt seit", alexande_apflora.tblTeilpopulation.TPopNr AS "Teilpopulation-Nr", alexande_apflora.tblTeilpopulation.TPopGemeinde AS "Teilpopulation-Gemeinde", alexande_apflora.tblTeilpopulation.TPopFlurname AS "Teilpopulation-Flurname", alexande_apflora.tblTeilpopulation.TPopXKoord AS "Teilpopulation-X-Koodinate", alexande_apflora.tblTeilpopulation.TPopYKoord AS "Teilpopulation-Y-Koordinate", alexande_apflora.tblTeilpopulation.TPopRadius AS "Teilpopulation-Radius", alexande_apflora.tblTeilpopulation.TPopHoehe AS "Teilpopulation-Hoehe", alexande_apflora.tblTeilpopulation.TPopBeschr AS "Teilpopulation-Beschreibung", alexande_apflora.tblTeilpopulation.TPopKatNr AS "Teilpopulation-Kataster-Nr", alexande_apflora.tblAdresse.AdrName AS "Teilpopulation-Verantwortlich", DomainPopHerkunft_1.HerkunftTxt AS "Teilpopulation-Herkunft", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklar AS "Teilpopulation - Herkunft unklar", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklarBegruendung AS "Teilpopulation - Herkunft unklar Begründung",alexande_apflora.DomainTPopApBerichtRelevant.DomainTxt AS "Teilpopulation - Für Bericht relevant", alexande_apflora.tblTeilpopulation.TPopBekanntSeit AS "Teilpopulation - bekannt seit", alexande_apflora.tblTeilpopulation.TPopEigen AS "Teilpopulation-Eigentümer", alexande_apflora.tblTeilpopulation.TPopKontakt AS "Teilpopulation-Kontakt", alexande_apflora.tblTeilpopulation.TPopNutzungszone AS "Teilpopulation-Nutzungszone", alexande_apflora.tblTeilpopulation.TPopBewirtschafterIn AS "Teilpopulation-Bewirtschafter", alexande_apflora.tblTeilpopulation.TPopBewirtschaftung AS "Teilpopulation-Bewirtschaftung", alexande_apflora.tblTeilpopulation.TPopTxt AS "Teilpopulation-Bemerkungen", alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerJahr AS "Massnahmenbericht-Jahr", DomainTPopMassnErfolgsbeurteilung.BeurteilTxt AS "Massnahmenbericht-Erfolgsberuteilung", alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerTxt AS "Massnahmenbericht-Interpretation"
FROM (((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) INNER JOIN (((alexande_apflora.tblPopulation LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) INNER JOIN (((alexande_apflora.tblTeilpopulation LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilpopulation.TPopVerantw = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.DomainPopHerkunft AS DomainPopHerkunft_1 ON alexande_apflora.tblTeilpopulation.TPopHerkunft = DomainPopHerkunft_1.HerkunftId) LEFT JOIN alexande_apflora.DomainTPopApBerichtRelevant ON alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant =alexande_apflora.DomainTPopApBerichtRelevant.DomainCode) ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN (alexande_apflora.tblTeilPopMassnBericht INNER JOIN alexande_apflora.DomainTPopMassnErfolgsbeurteilung ON alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerErfolgsbeurteilung = DomainTPopMassnErfolgsbeurteilung.BeurteilId) ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnBericht.TPopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerJahr;

CREATE OR REPLACE VIEW vAuswArtPopTPopMassn0 AS 
SELECT alexande_apflora.tblAktionsplan.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "Aktionsplan Bearbeitungsstand", alexande_apflora.tblPopulation.PopId, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, alexande_apflora.tblTeilpopulation.TPopId, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilpopulation.TPopFlurname, alexande_apflora.tblTeilPopMassnahme.TPopMassnId, alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr AS Jahr, DomainTPopMassnTyp.MassnTypTxt AS Massnahme, alexande_apflora.tblTeilPopMassnahme.TPopMassnTxt, alexande_apflora.tblTeilPopMassnahme.TPopMassnDatum, alexande_apflora.tblAdresse.AdrName AS TPopMassnBearb, alexande_apflora.tblTeilPopMassnahme.TPopMassnBemTxt, alexande_apflora.tblTeilPopMassnahme.TPopMassnPlan, alexande_apflora.tblTeilPopMassnahme.TPopMassnPlanBez, alexande_apflora.tblTeilPopMassnahme.TPopMassnFlaeche, alexande_apflora.tblTeilPopMassnahme.TPopMassnMarkierung, alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedAnzTriebe, alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedAnzPfl, alexande_apflora.tblTeilPopMassnahme.TPopMassnAnzPflanzstellen, alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedWirtspfl, alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedHerkunftPop, alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedDatSamm, alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedForm, alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedPflanzanordnung
FROM ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) INNER JOIN ((alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN ((alexande_apflora.tblTeilPopMassnahme LEFT JOIN alexande_apflora.DomainTPopMassnTyp ON alexande_apflora.tblTeilPopMassnahme.TPopMassnTyp = DomainTPopMassnTyp.MassnTypCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilPopMassnahme.TPopMassnBearb = alexande_apflora.tblAdresse.AdrId) ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnahme.TPopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr, DomainTPopMassnTyp.MassnTypTxt;

CREATE OR REPLACE VIEW vAuswArtPopTPopMassnFuerAktArt0 AS 
SELECT alexande_apflora.tblAktionsplan.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "Aktionsplan-Status", alexande_apflora.tblAktionsplan.ApJahr AS "Aktionsplan-Jahr", DomainApUmsetzung.DomainTxt AS "Aktionsplan-Umsetzung", alexande_apflora.tblPopulation.PopId, alexande_apflora.tblPopulation.PopNr AS "Population-Nr", alexande_apflora.tblPopulation.PopName AS "Population-Name", DomainPopHerkunft.HerkunftTxt AS "Population-Herkunft", alexande_apflora.tblPopulation.PopBekanntSeit AS "Population - bekannt seit", alexande_apflora.tblTeilpopulation.TPopId, alexande_apflora.tblTeilpopulation.TPopNr AS "Teilpopulation-Nr", alexande_apflora.tblTeilpopulation.TPopGemeinde AS "Teilpopulation-Gemeinde", alexande_apflora.tblTeilpopulation.TPopFlurname AS "Teilpopulation-Flurname", alexande_apflora.tblTeilpopulation.TPopXKoord AS "Teilpopulation-X-Koodinate", alexande_apflora.tblTeilpopulation.TPopYKoord AS "Teilpopulation-Y-Koordinate", alexande_apflora.tblTeilpopulation.TPopRadius AS "Teilpopulation-Radius", alexande_apflora.tblTeilpopulation.TPopHoehe AS "Teilpopulation-Höhe", alexande_apflora.tblTeilpopulation.TPopBeschr AS "Teilpopulation-Beschreibung", alexande_apflora.tblTeilpopulation.TPopKatNr AS "Teilpopulation-Kataster-Nr", tblAdresse_1.AdrName AS "Teilpopulation-Verantwortlich", DomainPopHerkunft_1.HerkunftTxt AS "Teilpopulation-Herkunft", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklar AS "Teilpopulation - Herkunft unklar", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklarBegruendung AS "Teilpopulation - Herkunft unklar Begründung",alexande_apflora.DomainTPopApBerichtRelevant.DomainTxt AS "Teilpopulation - Für Bericht relevant", alexande_apflora.tblTeilpopulation.TPopBekanntSeit AS "Teilpopulation - bekannt seit", alexande_apflora.tblTeilpopulation.TPopEigen AS "Teilpopulation-Eigentümer", alexande_apflora.tblTeilpopulation.TPopKontakt AS "Teilpopulation-Kontakt", alexande_apflora.tblTeilpopulation.TPopNutzungszone AS "Teilpopulation-Nutzungszone", alexande_apflora.tblTeilpopulation.TPopBewirtschafterIn AS "Teilpopulation-Bewirtschafter", alexande_apflora.tblTeilpopulation.TPopBewirtschaftung AS "Teilpopulation-Bewirtschaftung", alexande_apflora.tblTeilpopulation.TPopTxt AS "Teilpopulation-Bemerkungen", alexande_apflora.tblTeilPopMassnahme.TPopMassnId, DomainTPopMassnTyp.MassnTypTxt AS "Massnahme-Typ", alexande_apflora.tblTeilPopMassnahme.TPopMassnTxt AS "Massnahme-Beschreibung", alexande_apflora.tblTeilPopMassnahme.TPopMassnDatum AS "Massnahme-Datum", alexande_apflora.tblAdresse.AdrName AS "Massnahme-BearbeiterIn", alexande_apflora.tblTeilPopMassnahme.TPopMassnBemTxt AS "Massnahme-Bemerkungen", alexande_apflora.tblTeilPopMassnahme.TPopMassnPlan AS "Massnahme-Plan", alexande_apflora.tblTeilPopMassnahme.TPopMassnPlanBez AS "Massnahme-Planbezeichnung", alexande_apflora.tblTeilPopMassnahme.TPopMassnFlaeche AS "Massnahme-Fläche", alexande_apflora.tblTeilPopMassnahme.TPopMassnMarkierung AS "Massnahme-Markierung", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedAnzTriebe AS "Massnahme - Ansiedlung Anzahl Triebe", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedAnzPfl AS "Massnahme - Ansiedlung Anzahl Pflanzen", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnzPflanzstellen AS "Massnahme - Ansiedlung Anzahl Pflanzstellen", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedWirtspfl AS "Massnahme - Ansiedlung Wirtspflanzen", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedHerkunftPop AS "Massnahme - Ansiedlung Herkunftspopulation", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedDatSamm AS "Massnahme - Ansiedlung Sammeldatum", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedForm AS "Massnahme - Ansiedlung Form", alexande_apflora.tblTeilPopMassnahme.TPopMassnAnsiedPflanzanordnung AS "Massnahme - Ansiedlung Pflanzordnung"
FROM (alexande_beob.ArtenDb_Arteigenschaften INNER JOIN ((alexande_apflora.tblAktionsplan LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN (((alexande_apflora.tblPopulation LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) INNER JOIN (((alexande_apflora.tblTeilpopulation LEFT JOIN alexande_apflora.tblAdresse AS tblAdresse_1 ON alexande_apflora.tblTeilpopulation.TPopVerantw = tblAdresse_1.AdrId) LEFT JOIN alexande_apflora.DomainPopHerkunft AS DomainPopHerkunft_1 ON alexande_apflora.tblTeilpopulation.TPopHerkunft = DomainPopHerkunft_1.HerkunftId) LEFT JOIN alexande_apflora.DomainTPopApBerichtRelevant ON alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant =alexande_apflora.DomainTPopApBerichtRelevant.DomainCode) ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN ((alexande_apflora.tblTeilPopMassnahme LEFT JOIN alexande_apflora.DomainTPopMassnTyp ON alexande_apflora.tblTeilPopMassnahme.TPopMassnTyp = DomainTPopMassnTyp.MassnTypCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilPopMassnahme.TPopMassnBearb = alexande_apflora.tblAdresse.AdrId) ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnahme.TPopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblTeilpopulation.TPopNr, DomainTPopMassnTyp.MassnTypTxt;

CREATE OR REPLACE VIEW vAuswFlurnameArtKontrolle AS
SELECT alexande_apflora.tblAktionsplan.ApArtId, alexande_apflora.tblPopulation.PopId, alexande_apflora.tblTeilpopulation.TPopId, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrId, alexande_apflora.tblTeilpopulation.TPopGemeinde AS Gemeinde, alexande_apflora.tblTeilpopulation.TPopFlurname AS "Flurname aus Teilpopulation", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "Bearbeitungsstand AP", alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr AS Jahr, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp AS Kontrolltyp, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum, alexande_apflora.tblAdresse.AdrName AS TPopKontrBearb, DomainTPopKontrZaehleinheit.ZaehleinheitTxt AS TPopKontrZaehleinheit1, DomainTPopKontrMethode.BeurteilTxt AS TPopKontrMethode1, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz1, DomainTPopKontrZaehleinheit_1.ZaehleinheitTxt AS TPopKontrZaehleinheit2, DomainTPopKontrMethode_1.BeurteilTxt AS TPopKontrMethode2, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz2, DomainTPopKontrZaehleinheit_2.ZaehleinheitTxt AS TPopKontrZaehleinheit3, DomainTPopKontrMethode_2.BeurteilTxt AS TPopKontrMethode3, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz3, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJungpfl, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVitalitaet, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUeberleb, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrEntwicklung, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUrsach, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUrteil, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAendUms, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAendKontr, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTxt, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrLeb, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrFlaeche, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrLebUmg, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrStrauchschicht, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenTyp, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenAbtrag, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrWasserhaushalt, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrHandlungsbedarf, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUebFlaeche, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrPlan, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVeg, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrNaBo, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUebPfl, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJungPflJN, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVegHoeMax, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVegHoeMit, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrGefaehrdung
FROM (((((((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN (alexande_apflora.tblPopulation INNER JOIN (alexande_apflora.tblTeilpopulation INNER JOIN alexande_apflora.tblTeilPopFeldkontrolle ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopFeldkontrolle.TPopId) ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode1 = DomainTPopKontrZaehleinheit.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode1 = DomainTPopKontrMethode.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit2 = DomainTPopKontrZaehleinheit_1.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode2 = DomainTPopKontrMethode_1.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit3 = DomainTPopKontrZaehleinheit_2.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode3 = DomainTPopKontrMethode_2.BeurteilCode
WHERE (((alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp) Not Like "Ziel"))
ORDER BY alexande_apflora.tblTeilpopulation.TPopGemeinde, alexande_apflora.tblTeilpopulation.TPopFlurname, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp;

CREATE OR REPLACE VIEW vJbA1rPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM alexande_apflora.tblAktionsplan INNER JOIN (alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
WHERE (alexande_apflora.tblPopulation.PopHerkunft=1 Or alexande_apflora.tblPopulation.PopHerkunft=4 Or alexande_apflora.tblPopulation.PopHerkunft=8) AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbA2rPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM alexande_apflora.tblAktionsplan INNER JOIN (alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
WHERE (alexande_apflora.tblPopulation.PopHerkunft=1 Or alexande_apflora.tblPopulation.PopHerkunft=4) AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbA3rPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM alexande_apflora.tblAktionsplan INNER JOIN (alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
WHERE alexande_apflora.tblPopulation.PopHerkunft=8 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbA1rTPop AS
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM alexande_apflora.tblAktionsplan INNER JOIN (alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
WHERE (alexande_apflora.tblTeilpopulation.TPopHerkunft=1 Or alexande_apflora.tblTeilpopulation.TPopHerkunft=4 Or alexande_apflora.tblTeilpopulation.TPopHerkunft=8) AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbA2rTPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM alexande_apflora.tblAktionsplan INNER JOIN (alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
WHERE (alexande_apflora.tblTeilpopulation.TPopHerkunft=1 Or alexande_apflora.tblTeilpopulation.TPopHerkunft=4) AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbA3rTPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM alexande_apflora.tblAktionsplan INNER JOIN (alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
WHERE alexande_apflora.tblTeilpopulation.TPopHerkunft=8 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbB1rPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM alexande_apflora.tblKonstanten, (alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblPopBericht ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopBericht.PopId) INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11 AND alexande_apflora.tblPopBericht.PopBerJahr<=alexande_apflora.tblKonstanten.JBerJahr
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbB2rPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM ((alexande_apflora_views.vLetzterPopBericht INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora_views.vLetzterPopBericht.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblPopBericht ON (alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopBericht.PopId) AND (alexande_apflora_views.vLetzterPopBericht.PopId = alexande_apflora.tblPopBericht.PopId) AND (alexande_apflora_views.vLetzterPopBericht.MaxvonPopBerJahr = alexande_apflora.tblPopBericht.PopBerJahr)) INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblPopBericht.PopBerEntwicklung=3 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbB3rPop AS
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM ((alexande_apflora_views.vLetzterPopBericht INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora_views.vLetzterPopBericht.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblPopBericht ON (alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopBericht.PopId) AND (alexande_apflora_views.vLetzterPopBericht.PopId = alexande_apflora.tblPopBericht.PopId) AND (alexande_apflora_views.vLetzterPopBericht.MaxvonPopBerJahr = alexande_apflora.tblPopBericht.PopBerJahr)) INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblPopBericht.PopBerEntwicklung=2 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbB4rPop AS
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM ((alexande_apflora_views.vLetzterPopBericht INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora_views.vLetzterPopBericht.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblPopBericht ON (alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopBericht.PopId) AND (alexande_apflora_views.vLetzterPopBericht.PopId = alexande_apflora.tblPopBericht.PopId) AND (alexande_apflora_views.vLetzterPopBericht.MaxvonPopBerJahr = alexande_apflora.tblPopBericht.PopBerJahr)) INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblPopBericht.PopBerEntwicklung=1 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbB5rPop AS
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM ((alexande_apflora_views.vLetzterPopBericht INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora_views.vLetzterPopBericht.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblPopBericht ON (alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopBericht.PopId) AND (alexande_apflora_views.vLetzterPopBericht.PopId = alexande_apflora.tblPopBericht.PopId) AND (alexande_apflora_views.vLetzterPopBericht.MaxvonPopBerJahr = alexande_apflora.tblPopBericht.PopBerJahr)) INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE (alexande_apflora.tblPopBericht.PopBerEntwicklung=4 Or alexande_apflora.tblPopBericht.PopBerEntwicklung=9) AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbB6rPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM ((alexande_apflora_views.vLetzterPopBericht INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora_views.vLetzterPopBericht.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblPopBericht ON (alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopBericht.PopId) AND (alexande_apflora_views.vLetzterPopBericht.PopId = alexande_apflora.tblPopBericht.PopId) AND (alexande_apflora_views.vLetzterPopBericht.MaxvonPopBerJahr = alexande_apflora.tblPopBericht.PopBerJahr)) INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblPopBericht.PopBerEntwicklung=8 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbB1rTPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilPopBericht.TPopId
FROM alexande_apflora.tblKonstanten, alexande_apflora.tblPopulation INNER JOIN (alexande_apflora.tblTeilpopulation INNER JOIN alexande_apflora.tblTeilPopBericht ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopBericht.TPopId) ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11 AND alexande_apflora.tblTeilPopBericht.TPopBerJahr<=alexande_apflora.tblKonstanten.JBerJahr
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilPopBericht.TPopId;

CREATE OR REPLACE VIEW vJbB2rTPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM alexande_apflora.tblTeilpopulation INNER JOIN (alexande_apflora.tblTeilPopBericht INNER JOIN (alexande_apflora.tblPopulation INNER JOIN alexande_apflora_views.vLetzterTPopBericht ON alexande_apflora.tblPopulation.ApArtId = alexande_apflora_views.vLetzterTPopBericht.ApArtId) ON (alexande_apflora.tblTeilPopBericht.TPopId = alexande_apflora_views.vLetzterTPopBericht.TPopId) AND (alexande_apflora.tblTeilPopBericht.TPopBerJahr = alexande_apflora_views.vLetzterTPopBericht.MaxvonTPopBerJahr)) ON (alexande_apflora.tblTeilpopulation.PopId = alexande_apflora.tblPopulation.PopId) AND (alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopBericht.TPopId)
WHERE alexande_apflora.tblTeilPopBericht.TPopBerEntwicklung=3 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbB3rTPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM alexande_apflora.tblTeilpopulation INNER JOIN (alexande_apflora.tblTeilPopBericht INNER JOIN (alexande_apflora.tblPopulation INNER JOIN alexande_apflora_views.vLetzterTPopBericht ON alexande_apflora.tblPopulation.ApArtId = alexande_apflora_views.vLetzterTPopBericht.ApArtId) ON (alexande_apflora.tblTeilPopBericht.TPopId = alexande_apflora_views.vLetzterTPopBericht.TPopId) AND (alexande_apflora.tblTeilPopBericht.TPopBerJahr = alexande_apflora_views.vLetzterTPopBericht.MaxvonTPopBerJahr)) ON (alexande_apflora.tblTeilpopulation.PopId = alexande_apflora.tblPopulation.PopId) AND (alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopBericht.TPopId)
WHERE alexande_apflora.tblTeilPopBericht.TPopBerEntwicklung=2 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbB4rTPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM alexande_apflora.tblTeilpopulation INNER JOIN (alexande_apflora.tblTeilPopBericht INNER JOIN (alexande_apflora.tblPopulation INNER JOIN alexande_apflora_views.vLetzterTPopBericht ON alexande_apflora.tblPopulation.ApArtId = alexande_apflora_views.vLetzterTPopBericht.ApArtId) ON (alexande_apflora.tblTeilPopBericht.TPopId = alexande_apflora_views.vLetzterTPopBericht.TPopId) AND (alexande_apflora.tblTeilPopBericht.TPopBerJahr = alexande_apflora_views.vLetzterTPopBericht.MaxvonTPopBerJahr)) ON (alexande_apflora.tblTeilpopulation.PopId = alexande_apflora.tblPopulation.PopId) AND (alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopBericht.TPopId)
WHERE alexande_apflora.tblTeilPopBericht.TPopBerEntwicklung=1 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbB5rTPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM alexande_apflora.tblTeilpopulation INNER JOIN (alexande_apflora.tblTeilPopBericht INNER JOIN (alexande_apflora.tblPopulation INNER JOIN alexande_apflora_views.vLetzterTPopBericht ON alexande_apflora.tblPopulation.ApArtId = alexande_apflora_views.vLetzterTPopBericht.ApArtId) ON (alexande_apflora.tblTeilPopBericht.TPopId = alexande_apflora_views.vLetzterTPopBericht.TPopId) AND (alexande_apflora.tblTeilPopBericht.TPopBerJahr = alexande_apflora_views.vLetzterTPopBericht.MaxvonTPopBerJahr)) ON (alexande_apflora.tblTeilpopulation.PopId = alexande_apflora.tblPopulation.PopId) AND (alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopBericht.TPopId)
WHERE (alexande_apflora.tblTeilPopBericht.TPopBerEntwicklung=4 Or alexande_apflora.tblTeilPopBericht.TPopBerEntwicklung=9) AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbB6rTPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM alexande_apflora.tblTeilpopulation INNER JOIN (alexande_apflora.tblTeilPopBericht INNER JOIN (alexande_apflora.tblPopulation INNER JOIN alexande_apflora_views.vLetzterTPopBericht ON alexande_apflora.tblPopulation.ApArtId = alexande_apflora_views.vLetzterTPopBericht.ApArtId) ON (alexande_apflora.tblTeilPopBericht.TPopId = alexande_apflora_views.vLetzterTPopBericht.TPopId) AND (alexande_apflora.tblTeilPopBericht.TPopBerJahr = alexande_apflora_views.vLetzterTPopBericht.MaxvonTPopBerJahr)) ON (alexande_apflora.tblTeilpopulation.PopId = alexande_apflora.tblPopulation.PopId) AND (alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopBericht.TPopId)
WHERE alexande_apflora.tblTeilPopBericht.TPopBerEntwicklung=8 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbC1rPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM alexande_apflora.tblKonstanten, (alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN alexande_apflora.tblTeilPopMassnahme ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnahme.TPopId
WHERE alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr<=alexande_apflora.tblKonstanten.JBerJahr AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbC3rPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM (alexande_apflora_views.vLetzterPopMassnBericht INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora_views.vLetzterPopMassnBericht.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblPopMassnBericht ON (alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopMassnBericht.PopId) AND (alexande_apflora_views.vLetzterPopMassnBericht.MaxvonPopMassnBerJahr = alexande_apflora.tblPopMassnBericht.PopMassnBerJahr) AND (alexande_apflora_views.vLetzterPopMassnBericht.PopId = alexande_apflora.tblPopMassnBericht.PopId)
WHERE alexande_apflora.tblPopMassnBericht.PopMassnBerErfolgsbeurteilung=1
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbC4rPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM (alexande_apflora_views.vLetzterPopMassnBericht INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora_views.vLetzterPopMassnBericht.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblPopMassnBericht ON (alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopMassnBericht.PopId) AND (alexande_apflora_views.vLetzterPopMassnBericht.MaxvonPopMassnBerJahr = alexande_apflora.tblPopMassnBericht.PopMassnBerJahr) AND (alexande_apflora_views.vLetzterPopMassnBericht.PopId = alexande_apflora.tblPopMassnBericht.PopId)
WHERE (((alexande_apflora.tblPopMassnBericht.PopMassnBerErfolgsbeurteilung)=2))
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbC5rPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM (alexande_apflora_views.vLetzterPopMassnBericht INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora_views.vLetzterPopMassnBericht.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblPopMassnBericht ON (alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopMassnBericht.PopId) AND (alexande_apflora_views.vLetzterPopMassnBericht.MaxvonPopMassnBerJahr = alexande_apflora.tblPopMassnBericht.PopMassnBerJahr) AND (alexande_apflora_views.vLetzterPopMassnBericht.PopId = alexande_apflora.tblPopMassnBericht.PopId)
WHERE alexande_apflora.tblPopMassnBericht.PopMassnBerErfolgsbeurteilung=3
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbC6rPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM (alexande_apflora_views.vLetzterPopMassnBericht INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora_views.vLetzterPopMassnBericht.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblPopMassnBericht ON (alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopMassnBericht.PopId) AND (alexande_apflora_views.vLetzterPopMassnBericht.PopId = alexande_apflora.tblPopMassnBericht.PopId) AND (alexande_apflora_views.vLetzterPopMassnBericht.MaxvonPopMassnBerJahr = alexande_apflora.tblPopMassnBericht.PopMassnBerJahr)
WHERE alexande_apflora.tblPopMassnBericht.PopMassnBerErfolgsbeurteilung=4
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbC7rPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM (alexande_apflora_views.vLetzterPopMassnBericht INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora_views.vLetzterPopMassnBericht.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblPopMassnBericht ON (alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopMassnBericht.PopId) AND (alexande_apflora_views.vLetzterPopMassnBericht.PopId = alexande_apflora.tblPopMassnBericht.PopId) AND (alexande_apflora_views.vLetzterPopMassnBericht.MaxvonPopMassnBerJahr = alexande_apflora.tblPopMassnBericht.PopMassnBerJahr)
WHERE alexande_apflora.tblPopMassnBericht.PopMassnBerErfolgsbeurteilung=5
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbC1rTPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM alexande_apflora.tblKonstanten, (alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN alexande_apflora.tblTeilPopMassnahme ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnahme.TPopId
WHERE alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr<=alexande_apflora.tblKonstanten.JBerJahr AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbC3rTPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM ((alexande_apflora_views.vLetzterTPopMassnBericht INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora_views.vLetzterTPopMassnBericht.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblTeilPopMassnBericht ON (alexande_apflora_views.vLetzterTPopMassnBericht.MaxvonTPopMassnBerJahr = alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerJahr) AND (alexande_apflora_views.vLetzterTPopMassnBericht.TPopId = alexande_apflora.tblTeilPopMassnBericht.TPopId)) INNER JOIN alexande_apflora.tblTeilpopulation ON (alexande_apflora.tblTeilPopMassnBericht.TPopId = alexande_apflora.tblTeilpopulation.TPopId) AND (alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId)
WHERE alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerErfolgsbeurteilung=1
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbC4rTPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM ((alexande_apflora_views.vLetzterTPopMassnBericht INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora_views.vLetzterTPopMassnBericht.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblTeilPopMassnBericht ON (alexande_apflora_views.vLetzterTPopMassnBericht.MaxvonTPopMassnBerJahr = alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerJahr) AND (alexande_apflora_views.vLetzterTPopMassnBericht.TPopId = alexande_apflora.tblTeilPopMassnBericht.TPopId)) INNER JOIN alexande_apflora.tblTeilpopulation ON (alexande_apflora.tblTeilPopMassnBericht.TPopId = alexande_apflora.tblTeilpopulation.TPopId) AND (alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId)
WHERE (alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerErfolgsbeurteilung=2)
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbC5rTPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM ((alexande_apflora_views.vLetzterTPopMassnBericht INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora_views.vLetzterTPopMassnBericht.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblTeilPopMassnBericht ON (alexande_apflora_views.vLetzterTPopMassnBericht.MaxvonTPopMassnBerJahr = alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerJahr) AND (alexande_apflora_views.vLetzterTPopMassnBericht.TPopId = alexande_apflora.tblTeilPopMassnBericht.TPopId)) INNER JOIN alexande_apflora.tblTeilpopulation ON (alexande_apflora.tblTeilPopMassnBericht.TPopId = alexande_apflora.tblTeilpopulation.TPopId) AND (alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId)
WHERE alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerErfolgsbeurteilung=3
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbC6rTPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM ((alexande_apflora_views.vLetzterTPopMassnBericht INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora_views.vLetzterTPopMassnBericht.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblTeilPopMassnBericht ON (alexande_apflora_views.vLetzterTPopMassnBericht.MaxvonTPopMassnBerJahr = alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerJahr) AND (alexande_apflora_views.vLetzterTPopMassnBericht.TPopId = alexande_apflora.tblTeilPopMassnBericht.TPopId)) INNER JOIN alexande_apflora.tblTeilpopulation ON (alexande_apflora.tblTeilPopMassnBericht.TPopId = alexande_apflora.tblTeilpopulation.TPopId) AND (alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId)
WHERE alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerErfolgsbeurteilung=4
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbC7rTPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM ((alexande_apflora_views.vLetzterTPopMassnBericht INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora_views.vLetzterTPopMassnBericht.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblTeilPopMassnBericht ON (alexande_apflora_views.vLetzterTPopMassnBericht.TPopId = alexande_apflora.tblTeilPopMassnBericht.TPopId) AND (alexande_apflora_views.vLetzterTPopMassnBericht.MaxvonTPopMassnBerJahr = alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerJahr)) INNER JOIN alexande_apflora.tblTeilpopulation ON (alexande_apflora.tblTeilPopMassnBericht.TPopId = alexande_apflora.tblTeilpopulation.TPopId) AND (alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId)
WHERE alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerErfolgsbeurteilung=5
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW alexande_apflora_views.vJbA1lPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW alexande_apflora_views.vJbA2lPop AS
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblPopulation.PopHerkunft=1 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbA3lPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblPopulation.PopHerkunft=8 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbA4lPop AS
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblPopulation.PopHerkunft=2 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbA5lPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblPopulation.PopHerkunft=1198167213 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbA6lPop AS
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblPopulation.PopHerkunft=6 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbA7lPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblPopulation.PopHerkunft=9 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbA8lPop AS
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE (alexande_apflora.tblPopulation.PopHerkunft=4 Or alexande_apflora.tblPopulation.PopHerkunft=1200498803) AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbA9lPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblPopulation.PopHerkunft=7 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbA1lTPop AS
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbA2lTPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblTeilpopulation.TPopHerkunft=1 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbA3lTPop AS
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblTeilpopulation.TPopHerkunft=8 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbA4lTPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblTeilpopulation.TPopHerkunft=2 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbA5lTPop AS
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblTeilpopulation.TPopHerkunft=1198167213 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbA6lTPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblTeilpopulation.TPopHerkunft=6 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbA7lTPop AS
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblTeilpopulation.TPopHerkunft=9 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbA8lTPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE (alexande_apflora.tblTeilpopulation.TPopHerkunft=4 Or alexande_apflora.tblTeilpopulation.TPopHerkunft=1200498803) AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbA9lTPop AS
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblTeilpopulation.TPopHerkunft=7 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbB1lPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM (alexande_apflora.tblPopulation INNER JOIN (alexande_apflora.tblPopBericht INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblPopBericht.PopBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopBericht.PopId) INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbB2lPop AS
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM (alexande_apflora.tblPopulation INNER JOIN (alexande_apflora.tblPopBericht INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblPopBericht.PopBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopBericht.PopId) INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblPopBericht.PopBerEntwicklung=3 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbB3lPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM (alexande_apflora.tblPopulation INNER JOIN (alexande_apflora.tblPopBericht INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblPopBericht.PopBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopBericht.PopId) INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblPopBericht.PopBerEntwicklung=2 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbB4lPop AS
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM (alexande_apflora.tblPopulation INNER JOIN (alexande_apflora.tblPopBericht INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblPopBericht.PopBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopBericht.PopId) INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblPopBericht.PopBerEntwicklung=1 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbB5lPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM (alexande_apflora.tblPopulation INNER JOIN (alexande_apflora.tblPopBericht INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblPopBericht.PopBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopBericht.PopId) INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE (alexande_apflora.tblPopBericht.PopBerEntwicklung=4 Or alexande_apflora.tblPopBericht.PopBerEntwicklung=9) AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbB6lPop AS
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM (alexande_apflora.tblPopulation INNER JOIN (alexande_apflora.tblPopBericht INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblPopBericht.PopBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopBericht.PopId) INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblPopBericht.PopBerEntwicklung=8 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbB7lPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbB1lTPop AS
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM alexande_apflora.tblPopulation INNER JOIN (alexande_apflora.tblTeilpopulation INNER JOIN (alexande_apflora.tblTeilPopBericht INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblTeilPopBericht.TPopBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopBericht.TPopId) ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbB2lTPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM alexande_apflora.tblPopulation INNER JOIN (alexande_apflora.tblTeilpopulation INNER JOIN (alexande_apflora.tblTeilPopBericht INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblTeilPopBericht.TPopBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopBericht.TPopId) ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblTeilPopBericht.TPopBerEntwicklung=3 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbB3lTPop AS
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM alexande_apflora.tblPopulation INNER JOIN (alexande_apflora.tblTeilpopulation INNER JOIN (alexande_apflora.tblTeilPopBericht INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblTeilPopBericht.TPopBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopBericht.TPopId) ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblTeilPopBericht.TPopBerEntwicklung=2 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbB4lTPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM alexande_apflora.tblPopulation INNER JOIN (alexande_apflora.tblTeilpopulation INNER JOIN (alexande_apflora.tblTeilPopBericht INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblTeilPopBericht.TPopBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopBericht.TPopId) ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblTeilPopBericht.TPopBerEntwicklung=1 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbB5lTPop AS
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM alexande_apflora.tblPopulation INNER JOIN (alexande_apflora.tblTeilpopulation INNER JOIN (alexande_apflora.tblTeilPopBericht INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblTeilPopBericht.TPopBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopBericht.TPopId) ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE (alexande_apflora.tblTeilPopBericht.TPopBerEntwicklung=4 Or alexande_apflora.tblTeilPopBericht.TPopBerEntwicklung=9) AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbB6lTPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM alexande_apflora.tblPopulation INNER JOIN (alexande_apflora.tblTeilpopulation INNER JOIN (alexande_apflora.tblTeilPopBericht INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblTeilPopBericht.TPopBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopBericht.TPopId) ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblTeilPopBericht.TPopBerEntwicklung=8 AND alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbB7lTPop AS
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId
WHERE alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vJbC1lPop AS 
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId
FROM (alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN (alexande_apflora.tblTeilPopMassnahme INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnahme.TPopId
WHERE alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblPopulation.PopId;

CREATE OR REPLACE VIEW vJbC1lTPop AS
SELECT alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId
FROM ((alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN alexande_apflora.tblTeilPopMassnahme ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnahme.TPopId) INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblTeilPopMassnahme.TPopMassnJahr = alexande_apflora.tblKonstanten.JBerJahr
WHERE alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant=1 AND alexande_apflora.tblPopulation.PopHerkunft <> 10 AND alexande_apflora.tblPopulation.PopHerkunft <> 11
GROUP BY alexande_apflora.tblPopulation.ApArtId, alexande_apflora.tblTeilpopulation.TPopId;

CREATE OR REPLACE VIEW vAuswAnzProTPopAngezArtBestJahr0 AS 
SELECT alexande_apflora.tblAktionsplan.ApArtId, alexande_apflora.tblPopulation.PopId, alexande_apflora.tblTeilpopulation.TPopId, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, DomainPopHerkunft.HerkunftTxt AS PopHerkunft, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilpopulation.TPopGemeinde, alexande_apflora.tblTeilpopulation.TPopFlurname, DomainPopHerkunft_1.HerkunftTxt AS TPopHerkunft, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum, alexande_apflora.tblAdresse.AdrName AS TPopKontrBearb, DomainTPopKontrZaehleinheit.ZaehleinheitTxt AS TPopKontrZaehleinheit1, DomainTPopKontrMethode.BeurteilTxt AS TPopKontrMethode1, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz1, DomainTPopKontrZaehleinheit_1.ZaehleinheitTxt AS TPopKontrZaehleinheit2, DomainTPopKontrMethode_1.BeurteilTxt AS TPopKontrMethode2, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz2, DomainTPopKontrZaehleinheit_2.ZaehleinheitTxt AS TPopKontrZaehleinheit3, DomainTPopKontrMethode_2.BeurteilTxt AS TPopKontrMethode3, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz3, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJungpfl, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVitalitaet, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUeberleb, alexande_apflora.DomainTPopEntwicklung.EntwicklungTxt AS TPopKontrEntwicklung, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUrsach, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUrteil, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAendUms, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAendKontr, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTxt, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrLeb, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrFlaeche, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrLebUmg, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrStrauchschicht, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenTyp, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenAbtrag, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrWasserhaushalt, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrHandlungsbedarf, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUebFlaeche, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrPlan, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVeg, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrNaBo, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUebPfl, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJungPflJN, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVegHoeMax, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVegHoeMit, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrGefaehrdung, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMutDat
FROM ((((((((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN (((alexande_apflora.tblAktionsplan INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN alexande_apflora.tblTeilPopFeldkontrolle ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopFeldkontrolle.TPopId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.DomainPopHerkunft AS DomainPopHerkunft_1 ON alexande_apflora.tblTeilpopulation.TPopHerkunft = DomainPopHerkunft_1.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit1 = DomainTPopKontrZaehleinheit.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit2 = DomainTPopKontrZaehleinheit_1.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit3 = DomainTPopKontrZaehleinheit_2.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode1 = DomainTPopKontrMethode.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode2 = DomainTPopKontrMethode_1.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode3 = DomainTPopKontrMethode_2.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopEntwicklung ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrEntwicklung = alexande_apflora.DomainTPopEntwicklung.EntwicklungCode;

CREATE OR REPLACE VIEW vAuswPopBerAngezArtBestJahr0 AS
SELECT alexande_apflora.tblAktionsplan.ApArtId, alexande_apflora.tblPopulation.PopId, alexande_apflora.tblPopBericht.PopBerId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, DomainPopHerkunft.HerkunftTxt AS PopHerkunft, alexande_apflora.tblPopBericht.PopBerJahr, DomainPopEntwicklung.EntwicklungTxt AS PopBerEntwicklung, alexande_apflora.tblPopBericht.PopBerTxt
FROM ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN ((alexande_apflora.tblAktionsplan INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblPopBericht ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopBericht.PopId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.DomainPopEntwicklung ON alexande_apflora.tblPopBericht.PopBerEntwicklung = DomainPopEntwicklung.EntwicklungId;
 
CREATE OR REPLACE VIEW vApZiele AS 
SELECT alexande_apflora.tblAktionsplan.ApArtId AS "AP Id", alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblAdresse.AdrName AS "AP verantwortlich", alexande_apflora.tblZiel.ZielId AS "Ziel Id", alexande_apflora.tblZiel.ApArtId AS "Ziel ApId", alexande_apflora.tblZiel.ZielJahr AS "Ziel Jahr", DomainZielTyp.ZieltypTxt AS "Ziel Typ", alexande_apflora.tblZiel.ZielBezeichnung AS "Ziel Beschreibung"
FROM (((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAktionsplan.ApBearb = alexande_apflora.tblAdresse.AdrId) RIGHT JOIN alexande_apflora.tblZiel ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblZiel.ApArtId) LEFT JOIN alexande_apflora.DomainZielTyp ON alexande_apflora.tblZiel.ZielTyp = DomainZielTyp.ZieltypId
WHERE alexande_apflora.tblZiel.ZielTyp=1 Or alexande_apflora.tblZiel.ZielTyp=2 Or alexande_apflora.tblZiel.ZielTyp=1170775556
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblZiel.ZielJahr, DomainZielTyp.ZieltypTxt, alexande_apflora.tblZiel.ZielTyp;

CREATE OR REPLACE VIEW vApZieleOhneAp AS 
SELECT alexande_apflora.tblAktionsplan.ApArtId AS "AP Id", alexande_apflora.tblZiel.ZielId AS "Ziel Id", alexande_apflora.tblZiel.ApArtId AS "Ziel ApId", alexande_apflora.tblZiel.ZielJahr AS "Ziel Jahr", DomainZielTyp.ZieltypTxt AS "Ziel Typ", alexande_apflora.tblZiel.ZielBezeichnung AS "Ziel Beschreibung"
FROM (((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAktionsplan.ApBearb = alexande_apflora.tblAdresse.AdrId) RIGHT JOIN alexande_apflora.tblZiel ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblZiel.ApArtId) LEFT JOIN alexande_apflora.DomainZielTyp ON alexande_apflora.tblZiel.ZielTyp = DomainZielTyp.ZieltypId
WHERE alexande_apflora.tblAktionsplan.ApArtId is Null
ORDER BY alexande_apflora.tblZiel.ZielJahr, DomainZielTyp.ZieltypTxt, alexande_apflora.tblZiel.ZielTyp;

CREATE OR REPLACE VIEW vZielBer AS
SELECT alexande_apflora.tblAktionsplan.ApArtId AS "AP Id", alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblAdresse.AdrName AS "AP verantwortlich", alexande_apflora.tblZiel.ZielId AS "Ziel Id", alexande_apflora.tblZiel.ZielJahr AS "Ziel Jahr", DomainZielTyp.ZieltypTxt AS "Ziel Typ", alexande_apflora.tblZiel.ZielBezeichnung AS "Ziel Beschreibung", alexande_apflora.tblZielBericht.ZielBerId AS "ZielBer Id", alexande_apflora.tblZielBericht.ZielId AS "ZielBer ZielId", alexande_apflora.tblZielBericht.ZielBerJahr AS "ZielBer Jahr", alexande_apflora.tblZielBericht.ZielBerErreichung AS "ZielBer Erreichung", alexande_apflora.tblZielBericht.ZielBerTxt AS "ZielBer Bemerkungen", alexande_apflora.tblZielBericht.MutWann AS "ZielBer MutWann", alexande_apflora.tblZielBericht.MutWer AS "ZielBer MutWer"
FROM ((((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAktionsplan.ApBearb = alexande_apflora.tblAdresse.AdrId) RIGHT JOIN alexande_apflora.tblZiel ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblZiel.ApArtId) LEFT JOIN alexande_apflora.DomainZielTyp ON alexande_apflora.tblZiel.ZielTyp = DomainZielTyp.ZieltypId) RIGHT JOIN alexande_apflora.tblZielBericht ON alexande_apflora.tblZiel.ZielId = alexande_apflora.tblZielBericht.ZielId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblZiel.ZielJahr, DomainZielTyp.ZieltypTxt, alexande_apflora.tblZiel.ZielTyp, alexande_apflora.tblZielBericht.ZielBerJahr;

CREATE OR REPLACE VIEW vZielBerOhneZiel AS
SELECT alexande_apflora.tblAktionsplan.ApArtId AS "AP Id", alexande_apflora.tblZiel.ZielId AS "Ziel Id", alexande_apflora.tblZielBericht.ZielBerId AS "ZielBer Id", alexande_apflora.tblZielBericht.ZielId AS "ZielBer ZielId", alexande_apflora.tblZielBericht.ZielBerJahr AS "ZielBer Jahr", alexande_apflora.tblZielBericht.ZielBerErreichung AS "ZielBer Erreichung", alexande_apflora.tblZielBericht.ZielBerTxt AS "ZielBer Bemerkungen", alexande_apflora.tblZielBericht.MutWann AS "ZielBer MutWann", alexande_apflora.tblZielBericht.MutWer AS "ZielBer MutWer"
FROM ((((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAktionsplan.ApBearb = alexande_apflora.tblAdresse.AdrId) RIGHT JOIN alexande_apflora.tblZiel ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblZiel.ApArtId) LEFT JOIN alexande_apflora.DomainZielTyp ON alexande_apflora.tblZiel.ZielTyp = DomainZielTyp.ZieltypId) RIGHT JOIN alexande_apflora.tblZielBericht ON alexande_apflora.tblZiel.ZielId = alexande_apflora.tblZielBericht.ZielId
WHERE alexande_apflora.tblZiel.ZielId is Null
ORDER BY alexande_apflora.tblZiel.ZielTyp, alexande_apflora.tblZielBericht.ZielBerJahr;

CREATE OR REPLACE VIEW vBerTPopFuerAngezeigteArt0 AS
SELECT alexande_apflora.tblAktionsplan.ApArtId, alexande_apflora.tblPopulation.PopId, alexande_apflora.tblTeilpopulation.TPopId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS ApStatus, alexande_apflora.tblAktionsplan.ApJahr, DomainApUmsetzung.DomainTxt AS ApUmsetzung, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, DomainPopHerkunft.HerkunftTxt AS PopHerkunft, alexande_apflora.tblPopulation.PopBekanntSeit, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilpopulation.TPopGemeinde, alexande_apflora.tblTeilpopulation.TPopFlurname, alexande_apflora.tblTeilpopulation.TPopXKoord, alexande_apflora.tblTeilpopulation.TPopYKoord, alexande_apflora.tblTeilpopulation.TPopBekanntSeit, DomainPopHerkunft_1.HerkunftTxt AS TPopHerkunft, alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant
FROM ((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN ((alexande_apflora.tblAktionsplan INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.DomainPopHerkunft AS DomainPopHerkunft_1 ON alexande_apflora.tblTeilpopulation.TPopHerkunft = DomainPopHerkunft_1.HerkunftId;

CREATE OR REPLACE VIEW vKontr AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", tblAdresse_1.AdrName AS "AP verantwortlich", alexande_apflora.tblPopulation.PopGuid AS "Pop Guid", alexande_apflora.tblPopulation.PopNr AS "Pop Nr", alexande_apflora.tblPopulation.PopName AS "Pop Name", DomainPopHerkunft.HerkunftTxt AS "Pop Herkunft", alexande_apflora.tblPopulation.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblTeilpopulation.TPopId AS "TPop ID", alexande_apflora.tblTeilpopulation.TPopGuid AS "TPop Guid", alexande_apflora.tblTeilpopulation.TPopNr AS "TPop Nr", alexande_apflora.tblTeilpopulation.TPopGemeinde AS "TPop Gemeinde", alexande_apflora.tblTeilpopulation.TPopFlurname AS "TPop Flurname", DomainPopHerkunft_1.HerkunftTxt AS "TPop Status", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklar AS "TPop Status unklar", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklarBegruendung AS "TPop Begründung für unklaren Status", alexande_apflora.tblTeilpopulation.TPopXKoord AS "TPop X-Koordinaten", alexande_apflora.tblTeilpopulation.TPopYKoord AS "TPop Y-Koordinaten", alexande_apflora.tblTeilpopulation.TPopRadius AS "TPop Radius m", alexande_apflora.tblTeilpopulation.TPopHoehe AS "TPop Höhe", alexande_apflora.tblTeilpopulation.TPopExposition AS "TPop Exposition", alexande_apflora.tblTeilpopulation.TPopKlima AS "TPop Klima", alexande_apflora.tblTeilpopulation.TPopNeigung AS "TPop Hangneigung", alexande_apflora.tblTeilpopulation.TPopBeschr AS "TPop Beschreibung", alexande_apflora.tblTeilpopulation.TPopKatNr AS "TPop Kataster-Nr", tblAdresse_2.AdrName AS "TPop verantwortlich", alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant AS "TPop für AP-Bericht relevant", alexande_apflora.tblTeilpopulation.TPopBekanntSeit AS "TPop bekannt seit", alexande_apflora.tblTeilpopulation.TPopEigen AS "TPop EigentümerIn", alexande_apflora.tblTeilpopulation.TPopKontakt AS "TPop Kontakt vor Ort", alexande_apflora.tblTeilpopulation.TPopNutzungszone AS "TPop Nutzungszone", alexande_apflora.tblTeilpopulation.TPopBewirtschafterIn AS "TPop BewirtschafterIn", alexande_apflora.tblTeilpopulation.TPopBewirtschaftung AS "TPop Bewirtschaftung", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrId, alexande_apflora.tblTeilPopFeldkontrolle.TPopId, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrGuid AS "Kontr Guid", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr AS "Kontr Jahr", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum AS "Kontr Datum", alexande_apflora.DomainTPopFeldkontrTyp.DomainTxt AS "Kontr Typ", alexande_apflora.tblAdresse.AdrName AS "Kontr BearbeiterIn", DomainTPopKontrZaehleinheit.ZaehleinheitTxt AS "Kontr Zähleinheit 1", DomainTPopKontrMethode.BeurteilTxt AS "Kontr Methode 1", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz1 AS "Kontr Anzahl 1", DomainTPopKontrZaehleinheit_1.ZaehleinheitTxt AS "Kontr Zähleinheit 2", DomainTPopKontrMethode_2.BeurteilTxt AS "Kontr Methode 2", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz2 AS "Kontr Anzahl 2", DomainTPopKontrZaehleinheit_2.ZaehleinheitTxt AS "Kontr Zähleinheit 3", DomainTPopKontrMethode_1.BeurteilTxt AS "Kontr Methode 3", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz3 AS "Kontr Anzahl 3", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUeberleb AS "Kontr Überlebensrate", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVitalitaet AS "Kontr Vitalität", DomainPopEntwicklung.EntwicklungTxt AS "Kontr Entwicklung", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUrsach AS "Kontr Ursachen", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUrteil AS "Kontr Erfolgsbeurteilung", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAendUms AS "Kontr Änderungs-Vorschläge Umsetzung", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAendKontr AS "Kontr Änderungs-Vorschläge Kontrolle", alexande_apflora.tblTeilpopulation.TPopXKoord AS "Kontr X-Koord", alexande_apflora.tblTeilpopulation.TPopYKoord AS "Kontr Y-Koord", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTxt AS "Kontr Bemerkungen", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrLeb AS "Kontr Lebensraum Delarze", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrLebUmg AS "Kontr angrenzender Lebensraum Delarze", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVegTyp AS "Kontr Vegetationstyp", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrKonkurrenz AS "Kontr Konkurrenz", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMoosschicht AS "Kontr Moosschicht", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrKrautschicht AS "Kontr Krautschicht", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrStrauchschicht AS "Kontr Strauchschicht", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBaumschicht AS "Kontr Baumschicht", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenTyp AS "Kontr Bodentyp", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenKalkgehalt AS "Kontr Boden Kalkgehalt", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenDurchlaessigkeit AS "Kontr Boden Durchlässigkeit", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenHumus AS "Kontr Boden Humusgehalt", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenNaehrstoffgehalt AS "Kontr Boden Nährstoffgehalt", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenAbtrag AS "Kontr Oberbodenabtrag", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrWasserhaushalt AS "Kontr Wasserhaushalt", DomainTPopKontrIdBiotUebereinst.DomainTxt AS "Kontr Übereinstimmung mit Idealbiotop", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrHandlungsbedarf AS "Kontr Handlungsbedarf", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUebFlaeche AS "Kontr ÜberprÜfte Fläche", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrFlaeche AS "Kontr Fläche der Teilpopulation m2", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrPlan AS "Kontr auf Plan eingezeichnet", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVeg AS "Kontr Deckung durch Vegetation", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrNaBo AS "Kontr Deckung nackter Boden", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUebPfl AS "Kontr Deckung durch überprüfte Art", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJungPflJN AS "Kontr auch junge Pflanzen", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVegHoeMax AS "Kontr maximale Veg-höhe cm", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVegHoeMit AS "Kontr mittlere Veg-höhe cm", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrGefaehrdung AS "Kontr Gefährdung", alexande_apflora.tblTeilPopFeldkontrolle.MutWann AS "Kontrolle zuletzt geändert", alexande_apflora.tblTeilPopFeldkontrolle.MutWer AS "Kontrolle zuletzt geändert von"
FROM alexande_apflora.DomainPopHerkunft AS DomainPopHerkunft_1 RIGHT JOIN (alexande_apflora.tblAdresse AS tblAdresse_2 RIGHT JOIN ((((((((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN (alexande_apflora.tblPopulation INNER JOIN (alexande_apflora.tblTeilpopulation INNER JOIN ((((((alexande_apflora.tblTeilPopFeldkontrolle LEFT JOIN alexande_apflora.DomainTPopFeldkontrTyp ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp = alexande_apflora.DomainTPopFeldkontrTyp.DomainTxt) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit1 = DomainTPopKontrZaehleinheit.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit2 = DomainTPopKontrZaehleinheit_1.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit3 = DomainTPopKontrZaehleinheit_2.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainPopEntwicklung ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrEntwicklung = DomainPopEntwicklung.EntwicklungId) ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopFeldkontrolle.TPopId) ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.DomainTPopKontrMethode ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode1 = DomainTPopKontrMethode.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode2 = DomainTPopKontrMethode_2.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode3 = DomainTPopKontrMethode_1.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrIdBiotUebereinst ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrIdealBiotopUebereinst = DomainTPopKontrIdBiotUebereinst.DomainCode) LEFT JOIN alexande_apflora.tblAdresse AS tblAdresse_1 ON alexande_apflora.tblAktionsplan.ApBearb = tblAdresse_1.AdrId) ON tblAdresse_2.AdrId = alexande_apflora.tblTeilpopulation.TPopVerantw) ON DomainPopHerkunft_1.HerkunftId = alexande_apflora.tblTeilpopulation.TPopHerkunft
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblTeilpopulation.TPopNr;

CREATE OR REPLACE VIEW vKontrLetzte AS
SELECT * FROM alexande_apflora_views.vKontr INNER JOIN alexande_apflora_views.vKontrLetzteId ON alexande_apflora_views.vKontr.TPopKontrId = alexande_apflora_views.vKontrLetzteId.MaxTPopKontrId;

#funktioniert nicht, wenn letzeKontrolle als Unterabfrage eingebunden wird. Grund: Unterabfragen in der FROM-Klausel dürfen keine korrelierten Unterabfragen sein
CREATE OR REPLACE VIEW vTPopAnzKontrInklLetzteKontr AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPopulation.PopGuid AS "Pop Guid", alexande_apflora.tblPopulation.PopNr AS "Pop Nr", alexande_apflora.tblPopulation.PopName AS "Pop Name", DomainPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPopulation.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPopulation.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPopulation.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPopulation.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPopulation.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblTeilpopulation.TPopId AS "TPop ID", alexande_apflora.tblTeilpopulation.TPopGuid AS "TPop Guid", alexande_apflora.tblTeilpopulation.TPopNr AS "TPop Nr", alexande_apflora.tblTeilpopulation.TPopGemeinde AS "TPop Gemeinde", alexande_apflora.tblTeilpopulation.TPopFlurname AS "TPop Flurname", DomainPopHerkunft_1.HerkunftTxt AS "TPop Status", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklar AS "TPop Status unklar", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklarBegruendung AS "TPop Begründung für unklaren Status", alexande_apflora.tblTeilpopulation.TPopXKoord AS "TPop X-Koordinaten", alexande_apflora.tblTeilpopulation.TPopYKoord AS "TPop Y-Koordinaten", alexande_apflora.tblTeilpopulation.TPopRadius AS "TPop Radius (m)", alexande_apflora.tblTeilpopulation.TPopHoehe AS "TPop Höhe", alexande_apflora.tblTeilpopulation.TPopExposition AS "TPop Exposition", alexande_apflora.tblTeilpopulation.TPopKlima AS "TPop Klima", alexande_apflora.tblTeilpopulation.TPopNeigung AS "TPop Hangneigung", alexande_apflora.tblTeilpopulation.TPopBeschr AS "TPop Beschreibung", alexande_apflora.tblTeilpopulation.TPopKatNr AS "TPop Kataster-Nr", alexande_apflora.tblAdresse.AdrName AS "TPop Verantwortlich", alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant AS "TPop für AP-Bericht relevant", alexande_apflora.tblTeilpopulation.TPopBekanntSeit AS "TPop bekannt seit", alexande_apflora.tblTeilpopulation.TPopEigen AS "TPop EigentümerIn", alexande_apflora.tblTeilpopulation.TPopKontakt AS "TPop Kontakt vor Ort", alexande_apflora.tblTeilpopulation.TPopNutzungszone AS "TPop Nutzungszone", alexande_apflora.tblTeilpopulation.TPopBewirtschafterIn AS "TPop BewirtschafterIn", alexande_apflora.tblTeilpopulation.TPopBewirtschaftung AS "TPop Bewirtschaftung", alexande_apflora.tblTeilpopulation.MutWann AS "Teilpopulation zuletzt geändert", alexande_apflora.tblTeilpopulation.MutWann AS "Teilpopulation zuletzt geändert von", (SELECT Count(*) FROM alexande_apflora.tblTeilPopFeldkontrolle WHERE alexande_apflora.tblTeilPopFeldkontrolle.TPopId = alexande_apflora.tblTeilpopulation.TPopId) AS "Anzahl Kontrollen", (SELECT Count(*) FROM alexande_apflora.tblTeilPopFeldkontrolle WHERE alexande_apflora.tblTeilPopFeldkontrolle.TPopId = alexande_apflora.tblTeilpopulation.TPopId AND alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp<>"Freiwilligen-Erfolgskontrolle") AS "Anzahl Feld-Kontrollen", (SELECT Count(*) FROM alexande_apflora.tblTeilPopFeldkontrolle WHERE alexande_apflora.tblTeilPopFeldkontrolle.TPopId = alexande_apflora.tblTeilpopulation.TPopId AND alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AS "Anzahl Freiwilligen-Kontrollen", vKontrLetzte.`Kontr Guid`, vKontrLetzte.`Kontr Jahr`, vKontrLetzte.`Kontr Datum`, vKontrLetzte.`Kontr Typ`, vKontrLetzte.`Kontr BearbeiterIn`, vKontrLetzte.`Kontr Zähleinheit 1`, vKontrLetzte.`Kontr Methode 1`, vKontrLetzte.`Kontr Anzahl 1`, vKontrLetzte.`Kontr Zähleinheit 2`, vKontrLetzte.`Kontr Methode 2`, vKontrLetzte.`Kontr Anzahl 2`, vKontrLetzte.`Kontr Zähleinheit 3`, vKontrLetzte.`Kontr Methode 3`, vKontrLetzte.`Kontr Anzahl 3`, vKontrLetzte.`Kontr Überlebensrate`, vKontrLetzte.`Kontr Vitalität`, vKontrLetzte.`Kontr Entwicklung`, vKontrLetzte.`Kontr Ursachen`, vKontrLetzte.`Kontr Erfolgsbeurteilung`, vKontrLetzte.`Kontr Änderungs-Vorschläge Umsetzung`, vKontrLetzte.`Kontr Änderungs-Vorschläge Kontrolle`, vKontrLetzte.`Kontr X-Koord`, vKontrLetzte.`Kontr Y-Koord`, vKontrLetzte.`Kontr Bemerkungen`, vKontrLetzte.`Kontr Lebensraum Delarze`, vKontrLetzte.`Kontr angrenzender Lebensraum Delarze`, vKontrLetzte.`Kontr Vegetationstyp`, vKontrLetzte.`Kontr Konkurrenz`, vKontrLetzte.`Kontr Moosschicht`, vKontrLetzte.`Kontr Krautschicht`, vKontrLetzte.`Kontr Strauchschicht`, vKontrLetzte.`Kontr Baumschicht`, vKontrLetzte.`Kontr Bodentyp`, vKontrLetzte.`Kontr Boden Kalkgehalt`, vKontrLetzte.`Kontr Boden Durchlässigkeit`, vKontrLetzte.`Kontr Boden Humusgehalt`, vKontrLetzte.`Kontr Boden Nährstoffgehalt`, vKontrLetzte.`Kontr Oberbodenabtrag`, vKontrLetzte.`Kontr Wasserhaushalt`, vKontrLetzte.`Kontr Übereinstimmung mit Idealbiotop`, vKontrLetzte.`Kontr Handlungsbedarf`, vKontrLetzte.`Kontr ÜberprÜfte Fläche`, vKontrLetzte.`Kontr Fläche der Teilpopulation m2`, vKontrLetzte.`Kontr auf Plan eingezeichnet`, vKontrLetzte.`Kontr Deckung durch Vegetation`, vKontrLetzte.`Kontr Deckung nackter Boden`, vKontrLetzte.`Kontr Deckung durch überprüfte Art`, vKontrLetzte.`Kontr auch junge Pflanzen`, vKontrLetzte.`Kontr maximale Veg-höhe cm`, vKontrLetzte.`Kontr mittlere Veg-höhe cm`, vKontrLetzte.`Kontr Gefährdung`, vKontrLetzte.`Kontrolle zuletzt geändert`, vKontrLetzte.`Kontrolle zuletzt geändert von`
FROM ((((((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) RIGHT JOIN alexande_apflora.tblPopulation ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) RIGHT JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = alexande_apflora.DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = alexande_apflora.DomainPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.DomainPopHerkunft AS DomainPopHerkunft_1 ON alexande_apflora.tblTeilpopulation.TPopHerkunft = DomainPopHerkunft_1.HerkunftId) LEFT JOIN alexande_apflora_views.vKontrLetzte ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora_views.vKontrLetzte.TPopId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilpopulation.TPopVerantw = alexande_apflora.tblAdresse.AdrId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblTeilpopulation.TPopNr;

CREATE OR REPLACE VIEW vKontrFuerGis AS
SELECT alexande_apflora.tblAktionsplan.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS Artname, alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS ApStatus, alexande_apflora.tblAktionsplan.ApJahr, DomainApUmsetzung.DomainTxt AS ApUmsetzung, alexande_apflora.tblPopulation.PopGuid, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, DomainPopHerkunft.HerkunftTxt AS PopHerkunft, alexande_apflora.tblPopulation.PopBekanntSeit, alexande_apflora.tblTeilpopulation.TPopGuid, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilpopulation.TPopGemeinde, alexande_apflora.tblTeilpopulation.TPopFlurname, alexande_apflora.tblTeilpopulation.TPopXKoord, alexande_apflora.tblTeilpopulation.TPopYKoord, alexande_apflora.tblTeilpopulation.TPopBekanntSeit, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrGuid, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum, alexande_apflora.DomainTPopFeldkontrTyp.DomainTxt AS TPopKontrTyp, alexande_apflora.tblAdresse.AdrName AS TPopKontrBearb, DomainTPopKontrZaehleinheit.ZaehleinheitTxt AS TPopKontrZaehleinheit1, DomainTPopKontrMethode.BeurteilTxt AS TPopKontrMethode1, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz1, DomainTPopKontrZaehleinheit_1.ZaehleinheitTxt AS TPopKontrZaehleinheit2, DomainTPopKontrMethode_2.BeurteilTxt AS TPopKontrMethode2, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz2, DomainTPopKontrZaehleinheit_2.ZaehleinheitTxt AS TPopKontrZaehleinheit3, DomainTPopKontrMethode_1.BeurteilTxt AS TPopKontrMethode3, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz3, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUeberleb, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVitalitaet, DomainPopEntwicklung.EntwicklungTxt AS TPopKontrEntwicklung, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUrsach, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUrteil, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAendUms, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAendKontr, alexande_apflora.tblTeilpopulation.TPopXKoord AS X, alexande_apflora.tblTeilpopulation.TPopYKoord AS Y, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrLeb, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrFlaeche, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrLebUmg, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVegTyp, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrKonkurrenz, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMoosschicht, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrKrautschicht, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrStrauchschicht, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBaumschicht, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenTyp, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenKalkgehalt, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenDurchlaessigkeit, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenHumus, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenNaehrstoffgehalt, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenAbtrag, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrWasserhaushalt, DomainTPopKontrIdBiotUebereinst.DomainTxt AS TPopKontrIdealBiotopUebereinst, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUebFlaeche, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrPlan, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVeg, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrNaBo, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUebPfl, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJungPflJN, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVegHoeMax, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVegHoeMit, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrGefaehrdung, alexande_apflora.tblTeilPopFeldkontrolle.MutWann, alexande_apflora.tblTeilPopFeldkontrolle.MutWer
FROM ((((((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN (alexande_apflora.tblPopulation INNER JOIN (alexande_apflora.tblTeilpopulation INNER JOIN ((((((alexande_apflora.tblTeilPopFeldkontrolle LEFT JOIN alexande_apflora.DomainTPopFeldkontrTyp ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp = alexande_apflora.DomainTPopFeldkontrTyp.DomainTxt) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit1 = DomainTPopKontrZaehleinheit.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit2 = DomainTPopKontrZaehleinheit_1.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit3 = DomainTPopKontrZaehleinheit_2.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainPopEntwicklung ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrEntwicklung = DomainPopEntwicklung.EntwicklungId) ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopFeldkontrolle.TPopId) ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.DomainTPopKontrMethode ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode1 = DomainTPopKontrMethode.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode2 = DomainTPopKontrMethode_2.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode3 = DomainTPopKontrMethode_1.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrIdBiotUebereinst ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrIdealBiotopUebereinst = DomainTPopKontrIdBiotUebereinst.DomainCode
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum;

CREATE OR REPLACE VIEW vKontrOhneTPop AS
SELECT alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrGuid AS "Kontr Guid", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr AS "Kontr Jahr", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum AS "Kontr Datum", alexande_apflora.DomainTPopFeldkontrTyp.DomainTxt AS "Kontr Typ", alexande_apflora.tblAdresse.AdrName AS "Kontr BearbeiterIn", DomainTPopKontrZaehleinheit.ZaehleinheitTxt AS "Kontr Zähleinheit 1", DomainTPopKontrMethode.BeurteilTxt AS "Kontr Methode 1", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz1 AS "Kontr Anzahl 1", DomainTPopKontrZaehleinheit_1.ZaehleinheitTxt AS "Kontr Zähleinheit 2", DomainTPopKontrMethode_2.BeurteilTxt AS "Kontr Methode 2", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz2 AS "Kontr Anzahl 2", DomainTPopKontrZaehleinheit_2.ZaehleinheitTxt AS "Kontr Zähleinheit 3", DomainTPopKontrMethode_1.BeurteilTxt AS "Kontr Methode 3", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz3 AS "Kontr Anzahl 3", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUeberleb AS "Kontr Überlebensrate", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVitalitaet AS "Kontr Vitalität", DomainPopEntwicklung.EntwicklungTxt AS "Kontr Entwicklung", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUrsach AS "Kontr Ursachen", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUrteil AS "Kontr Erfolgsbeurteilung", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAendUms AS "Kontr Änderungs-Vorschläge Umsetzung", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAendKontr AS "Kontr Änderungs-Vorschläge Kontrolle", alexande_apflora.tblTeilpopulation.TPopXKoord AS "Kontr X-Koord", alexande_apflora.tblTeilpopulation.TPopYKoord AS "Kontr Y-Koord", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTxt AS "Kontr Bemerkungen", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrLeb AS "Kontr Lebensraum Delarze", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrLebUmg AS "Kontr angrenzender Lebensraum Delarze", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVegTyp AS "Kontr Vegetationstyp", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrKonkurrenz AS "Kontr Konkurrenz", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMoosschicht AS "Kontr Moosschicht", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrKrautschicht AS "Kontr Krautschicht", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrStrauchschicht AS "Kontr Strauchschicht", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBaumschicht AS "Kontr Baumschicht", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenTyp AS "Kontr Bodentyp", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenKalkgehalt AS "Kontr Boden Kalkgehalt", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenDurchlaessigkeit AS "Kontr Boden Durchlässigkeit", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenHumus AS "Kontr Boden Humusgehalt", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenNaehrstoffgehalt AS "Kontr Boden Nährstoffgehalt", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenAbtrag AS "Kontr Oberbodenabtrag", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrWasserhaushalt AS "Kontr Wasserhaushalt", DomainTPopKontrIdBiotUebereinst.DomainTxt AS "Kontr Übereinstimmung mit Idealbiotop", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrHandlungsbedarf AS "Kontr Handlungsbedarf", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUebFlaeche AS "Kontr ÜberprÜfte Fläche", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrFlaeche AS "Kontr Fläche der Teilpopulation m2", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrPlan AS "Kontr auf Plan eingezeichnet", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVeg AS "Kontr Deckung durch Vegetation", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrNaBo AS "Kontr Deckung nackter Boden", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUebPfl AS "Kontr Deckung durch überprüfte Art", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJungPflJN AS "Kontr auch junge Pflanzen", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVegHoeMax AS "Kontr maximale Veg-höhe cm", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVegHoeMit AS "Kontr mittlere Veg-höhe cm", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrGefaehrdung AS "Kontr Gefährdung", alexande_apflora.tblTeilPopFeldkontrolle.MutWann AS "Datensatz zuletzt geändert", alexande_apflora.tblTeilPopFeldkontrolle.MutWer AS "Datensatz zuletzt geändert von"
FROM ((((alexande_apflora.tblTeilpopulation RIGHT JOIN ((((((alexande_apflora.tblTeilPopFeldkontrolle LEFT JOIN alexande_apflora.DomainTPopFeldkontrTyp ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp = alexande_apflora.DomainTPopFeldkontrTyp.DomainTxt) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit1 = DomainTPopKontrZaehleinheit.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit2 = DomainTPopKontrZaehleinheit_1.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit3 = DomainTPopKontrZaehleinheit_2.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainPopEntwicklung ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrEntwicklung = DomainPopEntwicklung.EntwicklungId) ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopFeldkontrolle.TPopId) LEFT JOIN alexande_apflora.DomainTPopKontrMethode ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode1 = DomainTPopKontrMethode.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode2 = DomainTPopKontrMethode_2.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode3 = DomainTPopKontrMethode_1.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrIdBiotUebereinst ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrIdealBiotopUebereinst = DomainTPopKontrIdBiotUebereinst.DomainCode
WHERE alexande_apflora.tblTeilpopulation.TPopId Is Null;

CREATE OR REPLACE VIEW vBeob AS
SELECT alexande_beob.tblBeobInfospezies.NO_NOTE, "" AS "ID_EVAB", alexande_beob.tblBeobInfospezies.NO_ISFS, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopGuid, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblTeilpopulation.TPopGuid, alexande_apflora.tblTeilpopulation.TPopNr, alexande_beob.tblBeobInfospezies.PROJET, alexande_beob.tblBeobInfospezies.NOM_COMMUNE, alexande_beob.tblBeobInfospezies.DESC_LOCALITE, alexande_beob.tblBeobInfospezies.FNS_XGIS AS X, alexande_beob.tblBeobInfospezies.FNS_YGIS AS Y, IF (alexande_beob.tblBeobInfospezies.FNS_XGIS>0 AND alexande_apflora.tblTeilpopulation.TPopXKoord>0 AND alexande_beob.tblBeobInfospezies.FNS_YGIS>0 AND alexande_apflora.tblTeilpopulation.TPopYKoord>0, ROUND(SQRT((alexande_beob.tblBeobInfospezies.FNS_XGIS-alexande_apflora.tblTeilpopulation.TPopXKoord)*(alexande_beob.tblBeobInfospezies.FNS_XGIS-alexande_apflora.tblTeilpopulation.TPopXKoord)+(alexande_beob.tblBeobInfospezies.FNS_YGIS-alexande_apflora.tblTeilpopulation.TPopYKoord)*(alexande_beob.tblBeobInfospezies.FNS_YGIS-alexande_apflora.tblTeilpopulation.TPopYKoord)), 0), null) AS "Distanz zur Teilpopulation (m)"
, alexande_beob.tblBeobBereitgestellt.Datum, alexande_beob.tblBeobBereitgestellt.Autor, alexande_apflora.tblBeobZuordnung.BeobNichtZuordnen, alexande_apflora.tblBeobZuordnung.BeobBemerkungen, alexande_apflora.tblBeobZuordnung.BeobMutWann, alexande_apflora.tblBeobZuordnung.BeobMutWer 
FROM ((alexande_beob.tblBeobInfospezies INNER JOIN alexande_beob.tblBeobBereitgestellt ON alexande_beob.tblBeobInfospezies.NO_NOTE = alexande_beob.tblBeobBereitgestellt.NO_NOTE) INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON alexande_beob.tblBeobInfospezies.NO_ISFS = alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId) INNER JOIN ((alexande_apflora.tblPopulation RIGHT JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) RIGHT JOIN alexande_apflora.tblBeobZuordnung ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblBeobZuordnung.TPopId) ON alexande_beob.tblBeobInfospezies.NO_NOTE = alexande_apflora.tblBeobZuordnung.NO_NOTE 
UNION SELECT "" AS "NO_NOTE", alexande_beob.tblBeobEvab.NO_NOTE_PROJET AS "ID_EVAB", alexande_beob.tblBeobEvab.NO_ISFS, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopGuid, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblTeilpopulation.TPopGuid, alexande_apflora.tblTeilpopulation.TPopNr, alexande_beob.tblBeobEvab.Projekt_ZH AS PROJET, alexande_beob.tblBeobEvab.NOM_COMMUNE, alexande_beob.tblBeobEvab.DESC_LOCALITE_ AS DESC_LOCALITE, alexande_beob.tblBeobEvab.COORDONNEE_FED_E AS X, alexande_beob.tblBeobEvab.COORDONNEE_FED_N AS Y, IF (alexande_beob.tblBeobEvab.COORDONNEE_FED_E>0 AND alexande_apflora.tblTeilpopulation.TPopXKoord>0 AND alexande_beob.tblBeobEvab.COORDONNEE_FED_N>0 AND alexande_apflora.tblTeilpopulation.TPopYKoord>0, ROUND(SQRT((alexande_beob.tblBeobEvab.COORDONNEE_FED_E-alexande_apflora.tblTeilpopulation.TPopXKoord)*(alexande_beob.tblBeobEvab.COORDONNEE_FED_E-alexande_apflora.tblTeilpopulation.TPopXKoord)+(alexande_beob.tblBeobEvab.COORDONNEE_FED_N-alexande_apflora.tblTeilpopulation.TPopYKoord)*(alexande_beob.tblBeobEvab.COORDONNEE_FED_N-alexande_apflora.tblTeilpopulation.TPopYKoord)), 0), null) AS "Distanz zur Teilpopulation (m)", alexande_beob.tblBeobBereitgestellt.Datum, alexande_beob.tblBeobBereitgestellt.Autor, alexande_apflora.tblBeobZuordnung.BeobNichtZuordnen, alexande_apflora.tblBeobZuordnung.BeobBemerkungen, alexande_apflora.tblBeobZuordnung.BeobMutWann, alexande_apflora.tblBeobZuordnung.BeobMutWer 
FROM ((alexande_beob.tblBeobBereitgestellt INNER JOIN alexande_beob.tblBeobEvab ON alexande_beob.tblBeobBereitgestellt.NO_NOTE_PROJET = alexande_beob.tblBeobEvab.NO_NOTE_PROJET) INNER JOIN ((alexande_apflora.tblPopulation RIGHT JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) RIGHT JOIN alexande_apflora.tblBeobZuordnung ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblBeobZuordnung.TPopId) ON alexande_beob.tblBeobEvab.NO_NOTE_PROJET = alexande_apflora.tblBeobZuordnung.NO_NOTE) INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON alexande_beob.tblBeobEvab.NO_ISFS = alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId 
ORDER BY Artname ASC, PopNr ASC, TPopNr ASC, Datum DESC;

CREATE OR REPLACE VIEW vExportNachEvab_Alle AS 
SELECT alexande_beob.ArtenDb_Arteigenschaften.GUID AS "Projekt_Id", CONCAT("AP Flora ZH: ", alexande_beob.ArtenDb_Arteigenschaften.Artname) AS "Projekt_Name", CAST(IF(alexande_apflora.tblAktionsplan.ApJahr Is Not Null,CONCAT("01.01.", alexande_apflora.tblAktionsplan.ApJahr),"") AS CHAR) AS "Projekt_Eröffnung", "Topos" AS "Projekt_Autor", CAST(CONCAT("Aktionsplan: ", alexande_apflora.DomainApBearbeitungsstand.DomainTxt, IF(alexande_apflora.tblAktionsplan.ApJahr Is Not Null,CONCAT("; Start im Jahr: ", alexande_apflora.tblAktionsplan.ApJahr),""), IF(alexande_apflora.tblAktionsplan.ApUmsetzung Is Not Null,CONCAT("; Stand Umsetzung: ", DomainApUmsetzung.DomainTxt),"")) AS CHAR) AS "Projekt_Bemerkungen", alexande_apflora.tblPopulation.PopGuid AS "Raum_Id", CAST(CONCAT(alexande_apflora.tblPopulation.PopName, IF(alexande_apflora.tblPopulation.PopNr Is Not Null,CONCAT(" (Nr. ", alexande_apflora.tblPopulation.PopNr, ")"),"")) AS CHAR) AS "Raum_Name", CAST(IF(alexande_apflora.tblPopulation.PopHerkunft Is Not Null,CONCAT("Status: ", DomainPopHerkunft.HerkunftTxt, IF(alexande_apflora.tblPopulation.PopBekanntSeit Is Not Null,CONCAT("; Bekannt seit: ", alexande_apflora.tblPopulation.PopBekanntSeit),"")),"") AS CHAR) AS "Raum_Bemerkungen", alexande_apflora.tblTeilpopulation.TPopGuid AS "Ort_Id", CAST(CONCAT(alexande_apflora.tblTeilpopulation.TPopFlurname, IF(alexande_apflora.tblTeilpopulation.TPopNr Is Not Null,CONCAT(" (Nr. ", alexande_apflora.tblTeilpopulation.TPopNr, ")"),"")) AS CHAR) AS "Ort_Name", alexande_apflora.tblTeilpopulation.TPopHoehe AS "Ort_ObergrenzeHöhe", alexande_apflora.tblTeilpopulation.TPopXKoord AS "Ort_X", alexande_apflora.tblTeilpopulation.TPopYKoord AS "Ort_Y", "+-20m" AS "Ort_Genauigkeit", alexande_apflora.tblTeilpopulation.TPopGemeinde AS "Ort_Gemeinde", alexande_apflora.tblTeilpopulation.TPopFlurname AS "Ort_Flurname", alexande_apflora.tblTeilpopulation.TPopExposition AS "Ort_Exposition", alexande_apflora.tblTeilpopulation.TPopNeigung AS "Ort_Hangneigung", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrLeb AS "Ort_Lebensraum", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrLebUmg AS "Ort_UmgebungDelarze", alexande_apflora.tblTeilPopFeldkontrolle.ZeitGuid AS "Zeit_Id", CAST(IF(alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum Is Not Null,CONCAT(alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum,"01.01.", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr),"") AS CHAR) AS "Zeit_Datum", CAST(IF(alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum Is Not Null,"Tag","Jahr") AS CHAR) AS "Zeit_GenauigkeitDatum", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMoosschicht AS "Zeit_DeckungMoose", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrKrautschicht AS "Zeit_DeckungKräuter", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrStrauchschicht AS "Zeit_DeckungSträucher", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBaumschicht AS "Zeit_DeckungBäume", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrGuid AS "Beob_Id", alexande_apflora.tblAdresse.AdrName AS "Beob_BeobachterinName", alexande_apflora.tblAktionsplan.ApArtId AS "Beob_NR", alexande_beob.ArtenDb_Arteigenschaften.Artname AS "Beob_WissenschArtname", alexande_beob.ArtenDb_Arteigenschaften.NameDeutsch AS "Beob_DeutscherArtname", "Feldbeobachtung" AS "Beob_TypDerMeldung", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz1 AS "Beob_Anzahl1", DomainTPopKontrZaehleinheit.ZaehleinheitTxt AS "Beob_Einheit1", DomainTPopKontrMethode.BeurteilTxt AS "Beob_Genauigkeit1", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz2 AS "Beob_Anzahl2", DomainTPopKontrZaehleinheit_1.ZaehleinheitTxt AS "Beob_Einheit2", DomainTPopKontrMethode_1.BeurteilTxt AS "Beob_Genauigkeit2", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz3 AS "Beob_Anzahl3", DomainTPopKontrZaehleinheit_2.ZaehleinheitTxt AS "Beob_Einheit3", DomainTPopKontrMethode_2.BeurteilTxt AS "Beob_Genauigkeit3", DomainPopHerkunft_1.ZdsfHerkunft AS "Beob_Herkunft", DomainPopHerkunft_1.ZdsfVorhanden AS "Beob_Vorhandensein", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrGefaehrdung AS "Beob_Gefährdung", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVitalitaet AS "Beob_VitalitätPflanze", alexande_apflora.tblTeilpopulation.TPopBeschr AS "Beob_BeschreibungStandort"
FROM ((((((((((((((alexande_apflora.tblAktionsplan INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN alexande_apflora.tblTeilPopFeldkontrolle ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopFeldkontrolle.TPopId) INNER JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON alexande_apflora.tblAktionsplan.ApArtId = alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit3 = DomainTPopKontrZaehleinheit_2.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit2 = DomainTPopKontrZaehleinheit_1.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit1 = DomainTPopKontrZaehleinheit.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode1 = DomainTPopKontrMethode.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode2 = DomainTPopKontrMethode_1.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode3 = DomainTPopKontrMethode_2.BeurteilCode) LEFT JOIN alexande_apflora.DomainPopHerkunft AS DomainPopHerkunft_1 ON alexande_apflora.tblTeilpopulation.TPopHerkunft = DomainPopHerkunft_1.HerkunftId
WHERE ((alexande_apflora.tblTeilpopulation.TPopXKoord Is Not Null) AND (alexande_apflora.tblTeilpopulation.TPopYKoord Is Not Null) AND (alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum Is Not Null) AND (alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp="Zwischenbeurteilung" Or alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (alexande_apflora.tblTeilpopulation.TPopHerkunft<>1198167213)) OR ((alexande_apflora.tblTeilpopulation.TPopXKoord Is Not Null) AND (alexande_apflora.tblTeilpopulation.TPopYKoord Is Not Null) AND (alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp="Zwischenbeurteilung" Or alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (alexande_apflora.tblTeilpopulation.TPopHerkunft<>1198167213) AND (alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr Is Not Null))
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, CONCAT(alexande_apflora.tblPopulation.PopName, IF(alexande_apflora.tblPopulation.PopNr Is Not Null,CONCAT(" (Nr. ", alexande_apflora.tblPopulation.PopNr, ")"),"")), CONCAT(alexande_apflora.tblTeilpopulation.TPopFlurname, IF(alexande_apflora.tblTeilpopulation.TPopNr Is Not Null,CONCAT(" (Nr. ", alexande_apflora.tblTeilpopulation.TPopNr, ")"),"")), IF(alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum Is Not Null, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum,CONCAT("01.01.", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr)), alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vExportNachEvab_Beob AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.GUID AS Projekt_Id, alexande_apflora.tblPopulation.PopGuid AS Raum_Id, alexande_apflora.tblTeilpopulation.TPopGuid AS Ort_Id, alexande_apflora.tblTeilPopFeldkontrolle.ZeitGuid AS Zeit_Id, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrGuid AS Beob_Id, alexande_apflora.tblAdresse.AdrName AS Beob_BeobachterinName, alexande_apflora.tblAktionsplan.ApArtId AS Beob_NR, alexande_beob.ArtenDb_Arteigenschaften.Artname AS Beob_WissenschArtname, alexande_beob.ArtenDb_Arteigenschaften.NameDeutsch AS Beob_DeutscherArtname, "Feldbeobachtung" AS Beob_TypDerMeldung, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz1 AS Beob_Anzahl1, DomainTPopKontrZaehleinheit.ZaehleinheitTxt AS Beob_Einheit1, DomainTPopKontrMethode.BeurteilTxt AS Beob_Genauigkeit1, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz2 AS Beob_Anzahl2, DomainTPopKontrZaehleinheit_1.ZaehleinheitTxt AS Beob_Einheit2, DomainTPopKontrMethode_1.BeurteilTxt AS Beob_Genauigkeit2, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz3 AS Beob_Anzahl3, DomainTPopKontrZaehleinheit_2.ZaehleinheitTxt AS Beob_Einheit3, DomainTPopKontrMethode_2.BeurteilTxt AS Beob_Genauigkeit3, DomainPopHerkunft_1.ZdsfHerkunft AS Beob_Herkunft, DomainPopHerkunft_1.ZdsfVorhanden AS Beob_Vorhandensein, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrGefaehrdung AS Beob_Gefährdung, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVitalitaet AS Beob_VitalitätPflanze, alexande_apflora.tblTeilpopulation.TPopBeschr AS Beob_BeschreibungStandort
FROM ((((((((((((((alexande_apflora.tblAktionsplan INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN alexande_apflora.tblTeilPopFeldkontrolle ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopFeldkontrolle.TPopId) INNER JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON alexande_apflora.tblAktionsplan.ApArtId = alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit3 = DomainTPopKontrZaehleinheit_2.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit2 = DomainTPopKontrZaehleinheit_1.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit1 = DomainTPopKontrZaehleinheit.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode1 = DomainTPopKontrMethode.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode2 = DomainTPopKontrMethode_1.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode3 = DomainTPopKontrMethode_2.BeurteilCode) LEFT JOIN alexande_apflora.DomainPopHerkunft AS DomainPopHerkunft_1 ON alexande_apflora.tblTeilpopulation.TPopHerkunft = DomainPopHerkunft_1.HerkunftId
WHERE (((alexande_apflora.tblTeilpopulation.TPopXKoord) Is Not Null) AND ((alexande_apflora.tblTeilpopulation.TPopYKoord) Is Not Null)) OR (((alexande_apflora.tblTeilpopulation.TPopXKoord) Is Not Null) AND ((alexande_apflora.tblTeilpopulation.TPopYKoord) Is Not Null))
GROUP BY alexande_beob.ArtenDb_Arteigenschaften.GUID, alexande_apflora.tblPopulation.PopGuid, alexande_apflora.tblTeilpopulation.TPopGuid, alexande_apflora.tblTeilPopFeldkontrolle.ZeitGuid, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrGuid, alexande_apflora.tblAdresse.AdrName, alexande_apflora.tblAktionsplan.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_beob.ArtenDb_Arteigenschaften.NameDeutsch, "Feldbeobachtung", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz1, DomainTPopKontrZaehleinheit.ZaehleinheitTxt, DomainTPopKontrMethode.BeurteilTxt, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz2, DomainTPopKontrZaehleinheit_1.ZaehleinheitTxt, DomainTPopKontrMethode_1.BeurteilTxt, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz3, DomainTPopKontrZaehleinheit_2.ZaehleinheitTxt, DomainTPopKontrMethode_2.BeurteilTxt, DomainPopHerkunft_1.ZdsfHerkunft, DomainPopHerkunft_1.ZdsfVorhanden, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrGefaehrdung, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVitalitaet, alexande_apflora.tblTeilpopulation.TPopBeschr, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp, alexande_apflora.tblTeilpopulation.TPopHerkunft, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr
HAVING (((alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum) Is Not Null) AND ((alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp)="Zwischenbeurteilung" Or (alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp)="Freiwilligen-Erfolgskontrolle") AND ((alexande_apflora.tblTeilpopulation.TPopHerkunft)<>1198167213)) OR (((alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp)="Zwischenbeurteilung" Or (alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp)="Freiwilligen-Erfolgskontrolle") AND ((alexande_apflora.tblTeilpopulation.TPopHerkunft)<>1198167213) AND ((alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr) Is Not Null))
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vExportNachEvab_Zeit AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.GUID AS Projekt_Id, alexande_apflora.tblPopulation.PopGuid AS Raum_Id, alexande_apflora.tblTeilpopulation.TPopGuid AS Ort_Id, alexande_apflora.tblTeilPopFeldkontrolle.ZeitGuid AS Zeit_Id, CAST(IF(alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum Is Not Null, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum,CONCAT("01.01." + alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr)) AS CHAR) AS Zeit_Datum, IF(alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum Is Not Null,"Tag","Jahr") AS Zeit_GenauigkeitDatum, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMoosschicht AS Zeit_DeckungMoose, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrKrautschicht AS Zeit_DeckungKräuter, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrStrauchschicht AS Zeit_DeckungSträucher, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBaumschicht AS Zeit_DeckungBäume
FROM ((((((((((((((alexande_apflora.tblAktionsplan INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN alexande_apflora.tblTeilPopFeldkontrolle ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopFeldkontrolle.TPopId) INNER JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON alexande_apflora.tblAktionsplan.ApArtId = alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit3 = DomainTPopKontrZaehleinheit_2.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit2 = DomainTPopKontrZaehleinheit_1.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit1 = DomainTPopKontrZaehleinheit.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode1 = DomainTPopKontrMethode.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode2 = DomainTPopKontrMethode_1.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode3 = DomainTPopKontrMethode_2.BeurteilCode) LEFT JOIN alexande_apflora.DomainPopHerkunft AS DomainPopHerkunft_1 ON alexande_apflora.tblTeilpopulation.TPopHerkunft = DomainPopHerkunft_1.HerkunftId
WHERE ((alexande_apflora.tblTeilpopulation.TPopXKoord Is Not Null) AND (alexande_apflora.tblTeilpopulation.TPopYKoord Is Not Null) AND (alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum Is Not Null) AND (alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp="Zwischenbeurteilung" Or alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (alexande_apflora.tblTeilpopulation.TPopHerkunft<>1198167213)) OR ((alexande_apflora.tblTeilpopulation.TPopXKoord Is Not Null) AND (alexande_apflora.tblTeilpopulation.TPopYKoord Is Not Null) AND (alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp="Zwischenbeurteilung" Or alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (alexande_apflora.tblTeilpopulation.TPopHerkunft<>1198167213) AND (alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr Is Not Null))
GROUP BY alexande_beob.ArtenDb_Arteigenschaften.GUID, alexande_apflora.tblPopulation.PopGuid, alexande_apflora.tblTeilpopulation.TPopGuid, alexande_apflora.tblTeilPopFeldkontrolle.ZeitGuid, IF(alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum Is Not Null, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum,CONCAT("01.01." + alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr)), IF(alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum Is Not Null,"Tag","Jahr"), alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMoosschicht, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrKrautschicht, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrStrauchschicht, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBaumschicht
ORDER BY IF(alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum Is Not Null, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr);

CREATE OR REPLACE VIEW vExportNachEvab_Ort AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.GUID AS Projekt_Id, alexande_apflora.tblPopulation.PopGuid AS Raum_Id, alexande_apflora.tblTeilpopulation.TPopGuid AS Ort_Id, CAST(CONCAT(alexande_apflora.tblTeilpopulation.TPopFlurname, IF(alexande_apflora.tblTeilpopulation.TPopNr Is Not Null,CONCAT(" (Nr. ", alexande_apflora.tblTeilpopulation.TPopNr, ")"),"")) AS CHAR) AS Ort_Name, alexande_apflora.tblTeilpopulation.TPopHoehe AS Ort_ObergrenzeHöhe, alexande_apflora.tblTeilpopulation.TPopXKoord AS Ort_X, alexande_apflora.tblTeilpopulation.TPopYKoord AS Ort_Y, "+-20m" AS Ort_Genauigkeit, alexande_apflora.tblTeilpopulation.TPopGemeinde AS Ort_Gemeinde, alexande_apflora.tblTeilpopulation.TPopFlurname AS Ort_Flurname, alexande_apflora.tblTeilpopulation.TPopExposition AS Ort_Exposition, alexande_apflora.tblTeilpopulation.TPopNeigung AS Ort_Hangneigung, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrLeb AS Ort_Lebensraum, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrLebUmg AS Ort_UmgebungDelarze
FROM ((((((((((((((alexande_apflora.tblAktionsplan INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN alexande_apflora.tblTeilPopFeldkontrolle ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopFeldkontrolle.TPopId) INNER JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON alexande_apflora.tblAktionsplan.ApArtId = alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit3 = DomainTPopKontrZaehleinheit_2.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit2 = DomainTPopKontrZaehleinheit_1.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit1 = DomainTPopKontrZaehleinheit.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode1 = DomainTPopKontrMethode.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode2 = DomainTPopKontrMethode_1.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode3 = DomainTPopKontrMethode_2.BeurteilCode) LEFT JOIN alexande_apflora.DomainPopHerkunft AS DomainPopHerkunft_1 ON alexande_apflora.tblTeilpopulation.TPopHerkunft = DomainPopHerkunft_1.HerkunftId
WHERE (alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum Is Not Null AND (alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp="Zwischenbeurteilung" Or alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND alexande_apflora.tblTeilpopulation.TPopHerkunft<>1198167213) OR ((alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp="Zwischenbeurteilung" Or alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND alexande_apflora.tblTeilpopulation.TPopHerkunft<>1198167213 AND alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr Is Not Null)
GROUP BY alexande_beob.ArtenDb_Arteigenschaften.GUID, alexande_apflora.tblPopulation.PopGuid, alexande_apflora.tblTeilpopulation.TPopGuid, CONCAT(alexande_apflora.tblTeilpopulation.TPopFlurname, IF(alexande_apflora.tblTeilpopulation.TPopNr Is Not Null,CONCAT(" (Nr. ", alexande_apflora.tblTeilpopulation.TPopNr, ")"),"")), alexande_apflora.tblTeilpopulation.TPopHoehe, alexande_apflora.tblTeilpopulation.TPopXKoord, alexande_apflora.tblTeilpopulation.TPopYKoord, "+-20m", alexande_apflora.tblTeilpopulation.TPopGemeinde, alexande_apflora.tblTeilpopulation.TPopFlurname, alexande_apflora.tblTeilpopulation.TPopExposition, alexande_apflora.tblTeilpopulation.TPopNeigung, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrLeb, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrLebUmg
HAVING (alexande_apflora.tblTeilpopulation.TPopXKoord Is Not Null AND alexande_apflora.tblTeilpopulation.TPopYKoord Is Not Null) OR (alexande_apflora.tblTeilpopulation.TPopXKoord Is Not Null AND alexande_apflora.tblTeilpopulation.TPopYKoord Is Not Null)
ORDER BY alexande_apflora.tblTeilpopulation.TPopFlurname, alexande_apflora.tblTeilpopulation.TPopNr;

CREATE OR REPLACE VIEW vExportNachEvab_Raum AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.GUID AS Projekt_Id, alexande_apflora.tblPopulation.PopGuid AS Raum_Id, CAST(CONCAT(alexande_apflora.tblPopulation.PopName, IF(alexande_apflora.tblPopulation.PopNr Is Not Null,CONCAT(" (Nr. ", alexande_apflora.tblPopulation.PopNr, ")"),"")) AS CHAR) AS Raum_Name, CAST(IF(alexande_apflora.tblPopulation.PopHerkunft Is Not Null,CONCAT("Status: ", DomainPopHerkunft.HerkunftTxt, IF(alexande_apflora.tblPopulation.PopBekanntSeit Is Not Null,CONCAT("; Bekannt seit: ", alexande_apflora.tblPopulation.PopBekanntSeit),"")),"") AS CHAR) AS Raum_Bemerkungen
FROM ((((((((((((((alexande_apflora.tblAktionsplan INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN alexande_apflora.tblTeilPopFeldkontrolle ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopFeldkontrolle.TPopId) INNER JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON alexande_apflora.tblAktionsplan.ApArtId = alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit3 = DomainTPopKontrZaehleinheit_2.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit2 = DomainTPopKontrZaehleinheit_1.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit1 = DomainTPopKontrZaehleinheit.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode1 = DomainTPopKontrMethode.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode2 = DomainTPopKontrMethode_1.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode3 = DomainTPopKontrMethode_2.BeurteilCode) LEFT JOIN alexande_apflora.DomainPopHerkunft AS DomainPopHerkunft_1 ON alexande_apflora.tblTeilpopulation.TPopHerkunft = DomainPopHerkunft_1.HerkunftId
WHERE ((alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum Is Not Null) AND (alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp="Zwischenbeurteilung" Or alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (alexande_apflora.tblTeilpopulation.TPopHerkunft<>1198167213) AND (alexande_apflora.tblTeilpopulation.TPopXKoord Is Not Null) AND (alexande_apflora.tblTeilpopulation.TPopYKoord Is Not Null)) OR ((alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp="Zwischenbeurteilung" Or alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (alexande_apflora.tblTeilpopulation.TPopHerkunft<>1198167213) AND (alexande_apflora.tblTeilpopulation.TPopXKoord Is Not Null) AND (alexande_apflora.tblTeilpopulation.TPopYKoord Is Not Null) AND (alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr Is Not Null))
GROUP BY alexande_beob.ArtenDb_Arteigenschaften.GUID, alexande_apflora.tblPopulation.PopGuid, CONCAT(alexande_apflora.tblPopulation.PopName, IF(alexande_apflora.tblPopulation.PopNr Is Not Null,CONCAT(" (Nr. ", alexande_apflora.tblPopulation.PopNr, ")"),"")), IF(alexande_apflora.tblPopulation.PopHerkunft Is Not Null,CONCAT("Status: ", DomainPopHerkunft.HerkunftTxt, IF(alexande_apflora.tblPopulation.PopBekanntSeit Is Not Null,CONCAT("; Bekannt seit: ", alexande_apflora.tblPopulation.PopBekanntSeit), "")),"")
ORDER BY alexande_apflora.tblPopulation.PopName, alexande_apflora.tblPopulation.PopNr;

CREATE OR REPLACE VIEW vExportNachEvab_Projekt AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.GUID AS Projekt_Id, CONCAT("AP Flora ZH: ", alexande_beob.ArtenDb_Arteigenschaften.Artname) AS Projekt_Name, CAST(IF(alexande_apflora.tblAktionsplan.ApJahr Is Not Null,CONCAT("01.01.", alexande_apflora.tblAktionsplan.ApJahr),"") AS CHAR) AS Projekt_Eröffnung, "Topos" AS Projekt_Autor, CAST(CONCAT("Aktionsplan: ", alexande_apflora.DomainApBearbeitungsstand.DomainTxt, IF(alexande_apflora.tblAktionsplan.ApJahr Is Not Null,CONCAT("; Start im Jahr: ", alexande_apflora.tblAktionsplan.ApJahr),""), IF(alexande_apflora.tblAktionsplan.ApUmsetzung Is Not Null,CONCAT("; Stand Umsetzung: ", DomainApUmsetzung.DomainTxt),""),"") AS CHAR) AS Projekt_Bemerkungen
FROM ((((((((((((((alexande_apflora.tblAktionsplan INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN alexande_apflora.tblTeilPopFeldkontrolle ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopFeldkontrolle.TPopId) INNER JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON alexande_apflora.tblAktionsplan.ApArtId = alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit3 = DomainTPopKontrZaehleinheit_2.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit2 = DomainTPopKontrZaehleinheit_1.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit1 = DomainTPopKontrZaehleinheit.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode1 = DomainTPopKontrMethode.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode2 = DomainTPopKontrMethode_1.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode3 = DomainTPopKontrMethode_2.BeurteilCode) LEFT JOIN alexande_apflora.DomainPopHerkunft AS DomainPopHerkunft_1 ON alexande_apflora.tblTeilpopulation.TPopHerkunft = DomainPopHerkunft_1.HerkunftId
WHERE ((alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum Is Not Null) AND (alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp="Zwischenbeurteilung" Or alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (alexande_apflora.tblTeilpopulation.TPopHerkunft<>1198167213) AND (alexande_apflora.tblTeilpopulation.TPopXKoord Is Not Null) AND (alexande_apflora.tblTeilpopulation.TPopYKoord Is Not Null)) OR ((alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp="Zwischenbeurteilung" Or alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (alexande_apflora.tblTeilpopulation.TPopHerkunft<>1198167213) AND (alexande_apflora.tblTeilpopulation.TPopXKoord Is Not Null) AND (alexande_apflora.tblTeilpopulation.TPopYKoord Is Not Null) AND (alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr Is Not Null))
GROUP BY alexande_beob.ArtenDb_Arteigenschaften.GUID, CONCAT("AP Flora ZH: ", alexande_beob.ArtenDb_Arteigenschaften.Artname), IF(alexande_apflora.tblAktionsplan.ApJahr Is Not Null,CONCAT("01.01.", alexande_apflora.tblAktionsplan.ApJahr),""), "Topos", CONCAT("Aktionsplan: ", alexande_apflora.DomainApBearbeitungsstand.DomainTxt, IF(alexande_apflora.tblAktionsplan.ApJahr Is Not Null,CONCAT("; Start im Jahr: ", alexande_apflora.tblAktionsplan.ApJahr),""), IF(alexande_apflora.tblAktionsplan.ApUmsetzung Is Not Null,CONCAT("; Stand Umsetzung: ", DomainApUmsetzung.DomainTxt), ""))
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vTPopMassnBer AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPopulation.PopGuid AS "Pop Guid", alexande_apflora.tblPopulation.PopNr AS "Pop Nr", alexande_apflora.tblPopulation.PopName AS "Pop Name", DomainPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPopulation.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPopulation.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPopulation.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPopulation.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPopulation.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblTeilpopulation.TPopId AS "TPop ID", alexande_apflora.tblTeilpopulation.TPopGuid AS "TPop Guid", alexande_apflora.tblTeilpopulation.TPopNr AS "TPop Nr", alexande_apflora.tblTeilpopulation.TPopGemeinde AS "TPop Gemeinde", alexande_apflora.tblTeilpopulation.TPopFlurname AS "TPop Flurname", DomainPopHerkunft_1.HerkunftTxt AS "TPop Status", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklar AS "TPop Status unklar", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklarBegruendung AS "TPop Begründung für unklaren Status", alexande_apflora.tblTeilpopulation.TPopXKoord AS "TPop X-Koordinaten", alexande_apflora.tblTeilpopulation.TPopYKoord AS "TPop Y-Koordinaten", alexande_apflora.tblTeilpopulation.TPopRadius AS "TPop Radius (m)", alexande_apflora.tblTeilpopulation.TPopHoehe AS "TPop Höhe", alexande_apflora.tblTeilpopulation.TPopExposition AS "TPop Exposition", alexande_apflora.tblTeilpopulation.TPopKlima AS "TPop Klima", alexande_apflora.tblTeilpopulation.TPopNeigung AS "TPop Hangneigung", alexande_apflora.tblTeilpopulation.TPopBeschr AS "TPop Beschreibung", alexande_apflora.tblTeilpopulation.TPopKatNr AS "TPop Kataster-Nr", alexande_apflora.tblAdresse.AdrName AS "TPop Verantwortlich", alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant AS "TPop für AP-Bericht relevant", alexande_apflora.tblTeilpopulation.TPopBekanntSeit AS "TPop bekannt seit", alexande_apflora.tblTeilpopulation.TPopEigen AS "TPop EigentümerIn", alexande_apflora.tblTeilpopulation.TPopKontakt AS "TPop Kontakt vor Ort", alexande_apflora.tblTeilpopulation.TPopNutzungszone AS "TPop Nutzungszone", alexande_apflora.tblTeilpopulation.TPopBewirtschafterIn AS "TPop BewirtschafterIn", alexande_apflora.tblTeilpopulation.TPopBewirtschaftung AS "TPop Bewirtschaftung", alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerId AS "TPopMassnBer Id", alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerJahr AS "TPopMassnBer Jahr", DomainTPopMassnErfolgsbeurteilung.BeurteilTxt AS "TPopMassnBer Entwicklung", alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerTxt AS "TPopMassnBer Interpretation", alexande_apflora.tblTeilPopMassnBericht.MutWann AS "TPopMassnBer MutWann", alexande_apflora.tblTeilPopMassnBericht.MutWer AS "TPopMassnBer MutWer"
FROM ((((((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) RIGHT JOIN (alexande_apflora.tblPopulation RIGHT JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.DomainPopHerkunft AS DomainPopHerkunft_1 ON alexande_apflora.tblTeilpopulation.TPopHerkunft = DomainPopHerkunft_1.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilpopulation.TPopVerantw = alexande_apflora.tblAdresse.AdrId) INNER JOIN alexande_apflora.tblTeilPopMassnBericht ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnBericht.TPopId) LEFT JOIN alexande_apflora.DomainTPopMassnErfolgsbeurteilung ON alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerErfolgsbeurteilung = DomainTPopMassnErfolgsbeurteilung.BeurteilId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerJahr;

CREATE OR REPLACE VIEW vTPopFuerKml AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, CAST(CONCAT(alexande_apflora.tblPopulation.PopNr,'/', alexande_apflora.tblTeilpopulation.TPopNr) AS CHAR) AS Label, CAST(LEFT(CONCAT('Population: ', alexande_apflora.tblPopulation.PopNr, ' ', alexande_apflora.tblPopulation.PopName, '<br /> Teilpopulation: ', alexande_apflora.tblTeilpopulation.TPopNr, ' ', alexande_apflora.tblTeilpopulation.TPopGemeinde, ' ', alexande_apflora.tblTeilpopulation.TPopFlurname),225) AS CHAR) AS Inhalte, (2.6779094+(4.728982*((alexande_apflora.tblTeilpopulation.TPopXKoord-600000)/1000000))+(0.791484*((alexande_apflora.tblTeilpopulation.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTeilpopulation.TPopYKoord-200000)/1000000))+(0.1306*((alexande_apflora.tblTeilpopulation.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTeilpopulation.TPopYKoord-200000)/1000000)*((alexande_apflora.tblTeilpopulation.TPopYKoord-200000)/1000000))-(0.0436*((alexande_apflora.tblTeilpopulation.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTeilpopulation.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTeilpopulation.TPopXKoord-600000)/1000000)))*100/36 AS Laengengrad, (16.9023892+(3.238272*((alexande_apflora.tblTeilpopulation.TPopYKoord-200000)/1000000))-(0.270978*((alexande_apflora.tblTeilpopulation.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTeilpopulation.TPopXKoord-600000)/1000000))-(0.002528*((alexande_apflora.tblTeilpopulation.TPopYKoord-200000)/1000000)*((alexande_apflora.tblTeilpopulation.TPopYKoord-200000)/1000000))-(0.0447*((alexande_apflora.tblTeilpopulation.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTeilpopulation.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTeilpopulation.TPopYKoord-200000)/1000000))-(0.014*((alexande_apflora.tblTeilpopulation.TPopYKoord-200000)/1000000)*((alexande_apflora.tblTeilpopulation.TPopYKoord-200000)/1000000)*((alexande_apflora.tblTeilpopulation.TPopYKoord-200000)/1000000)))*100/36 AS Breitengrad, CAST(CONCAT('http://apflora.ch/index.html?ap=', alexande_apflora.tblAktionsplan.ApArtId, '&pop=', alexande_apflora.tblTeilpopulation.TPopId) AS CHAR) AS URL
FROM (alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN (alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
WHERE alexande_apflora.tblTeilpopulation.TPopYKoord > 0 AND alexande_apflora.tblTeilpopulation.TPopXKoord > 0
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilpopulation.TPopGemeinde, alexande_apflora.tblTeilpopulation.TPopFlurname;

CREATE OR REPLACE VIEW vTPopFuerKmlNamen AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, CAST(CONCAT(alexande_beob.ArtenDb_Arteigenschaften.Artname, ' ', alexande_apflora.tblPopulation.PopNr,'/', alexande_apflora.tblTeilpopulation.TPopNr) AS CHAR) AS Label, CAST(LEFT(CONCAT('Population: ', alexande_apflora.tblPopulation.PopNr, ' ', alexande_apflora.tblPopulation.PopName, '<br /> Teilpopulation: ', alexande_apflora.tblTeilpopulation.TPopNr, ' ', alexande_apflora.tblTeilpopulation.TPopGemeinde, ' ', alexande_apflora.tblTeilpopulation.TPopFlurname),225) AS CHAR) AS Inhalte, (2.6779094+(4.728982*((alexande_apflora.tblTeilpopulation.TPopXKoord-600000)/1000000))+(0.791484*((alexande_apflora.tblTeilpopulation.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTeilpopulation.TPopYKoord-200000)/1000000))+(0.1306*((alexande_apflora.tblTeilpopulation.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTeilpopulation.TPopYKoord-200000)/1000000)*((alexande_apflora.tblTeilpopulation.TPopYKoord-200000)/1000000))-(0.0436*((alexande_apflora.tblTeilpopulation.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTeilpopulation.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTeilpopulation.TPopXKoord-600000)/1000000)))*100/36 AS Laengengrad, (16.9023892+(3.238272*((alexande_apflora.tblTeilpopulation.TPopYKoord-200000)/1000000))-(0.270978*((alexande_apflora.tblTeilpopulation.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTeilpopulation.TPopXKoord-600000)/1000000))-(0.002528*((alexande_apflora.tblTeilpopulation.TPopYKoord-200000)/1000000)*((alexande_apflora.tblTeilpopulation.TPopYKoord-200000)/1000000))-(0.0447*((alexande_apflora.tblTeilpopulation.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTeilpopulation.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTeilpopulation.TPopYKoord-200000)/1000000))-(0.014*((alexande_apflora.tblTeilpopulation.TPopYKoord-200000)/1000000)*((alexande_apflora.tblTeilpopulation.TPopYKoord-200000)/1000000)*((alexande_apflora.tblTeilpopulation.TPopYKoord-200000)/1000000)))*100/36 AS Breitengrad, CAST(CONCAT('http://www.apflora.ch/index.html?ap=', alexande_apflora.tblAktionsplan.ApArtId, '&pop=', alexande_apflora.tblTeilpopulation.TPopId) AS CHAR) AS URL
FROM (alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN (alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
WHERE alexande_apflora.tblTeilpopulation.TPopYKoord > 0 AND alexande_apflora.tblTeilpopulation.TPopXKoord > 0
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilpopulation.TPopGemeinde, alexande_apflora.tblTeilpopulation.TPopFlurname;

CREATE OR REPLACE VIEW vPopFuerKml AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.tblPopulation.PopNr AS Label, CAST(LEFT(CONCAT('Population: ', alexande_apflora.tblPopulation.PopNr, ' ', alexande_apflora.tblPopulation.PopName),225) AS CHAR) AS Inhalte, (2.6779094+(4.728982*((alexande_apflora.tblPopulation.PopXKoord-600000)/1000000))+(0.791484*((alexande_apflora.tblPopulation.PopXKoord-600000)/1000000)*((alexande_apflora.tblPopulation.PopYKoord-200000)/1000000))+(0.1306*((alexande_apflora.tblPopulation.PopXKoord-600000)/1000000)*((alexande_apflora.tblPopulation.PopYKoord-200000)/1000000)*((alexande_apflora.tblPopulation.PopYKoord-200000)/1000000))-(0.0436*((alexande_apflora.tblPopulation.PopXKoord-600000)/1000000)*((alexande_apflora.tblPopulation.PopXKoord-600000)/1000000)*((alexande_apflora.tblPopulation.PopXKoord-600000)/1000000)))*100/36 AS Laengengrad, (16.9023892+(3.238272*((alexande_apflora.tblPopulation.PopYKoord-200000)/1000000))-(0.270978*((alexande_apflora.tblPopulation.PopXKoord-600000)/1000000)*((alexande_apflora.tblPopulation.PopXKoord-600000)/1000000))-(0.002528*((alexande_apflora.tblPopulation.PopYKoord-200000)/1000000)*((alexande_apflora.tblPopulation.PopYKoord-200000)/1000000))-(0.0447*((alexande_apflora.tblPopulation.PopXKoord-600000)/1000000)*((alexande_apflora.tblPopulation.PopXKoord-600000)/1000000)*((alexande_apflora.tblPopulation.PopYKoord-200000)/1000000))-(0.014*((alexande_apflora.tblPopulation.PopYKoord-200000)/1000000)*((alexande_apflora.tblPopulation.PopYKoord-200000)/1000000)*((alexande_apflora.tblPopulation.PopYKoord-200000)/1000000)))*100/36 AS Breitengrad, CAST(CONCAT('http://www.apflora.ch/index.html?ap=', alexande_apflora.tblAktionsplan.ApArtId, '&pop=', alexande_apflora.tblPopulation.PopId) AS CHAR) AS URL
FROM (alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
WHERE alexande_apflora.tblPopulation.PopYKoord > 0 AND alexande_apflora.tblPopulation.PopXKoord > 0
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName;

CREATE OR REPLACE VIEW vPopFuerKmlNamen AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, CAST(CONCAT(alexande_beob.ArtenDb_Arteigenschaften.Artname, ' ', alexande_apflora.tblPopulation.PopNr) AS CHAR) AS Label, CAST(LEFT(CONCAT('Population: ', alexande_apflora.tblPopulation.PopNr, ' ', alexande_apflora.tblPopulation.PopName),225) AS CHAR) AS Inhalte, (2.6779094+(4.728982*((alexande_apflora.tblPopulation.PopXKoord-600000)/1000000))+(0.791484*((alexande_apflora.tblPopulation.PopXKoord-600000)/1000000)*((alexande_apflora.tblPopulation.PopYKoord-200000)/1000000))+(0.1306*((alexande_apflora.tblPopulation.PopXKoord-600000)/1000000)*((alexande_apflora.tblPopulation.PopYKoord-200000)/1000000)*((alexande_apflora.tblPopulation.PopYKoord-200000)/1000000))-(0.0436*((alexande_apflora.tblPopulation.PopXKoord-600000)/1000000)*((alexande_apflora.tblPopulation.PopXKoord-600000)/1000000)*((alexande_apflora.tblPopulation.PopXKoord-600000)/1000000)))*100/36 AS Laengengrad, (16.9023892+(3.238272*((alexande_apflora.tblPopulation.PopYKoord-200000)/1000000))-(0.270978*((alexande_apflora.tblPopulation.PopXKoord-600000)/1000000)*((alexande_apflora.tblPopulation.PopXKoord-600000)/1000000))-(0.002528*((alexande_apflora.tblPopulation.PopYKoord-200000)/1000000)*((alexande_apflora.tblPopulation.PopYKoord-200000)/1000000))-(0.0447*((alexande_apflora.tblPopulation.PopXKoord-600000)/1000000)*((alexande_apflora.tblPopulation.PopXKoord-600000)/1000000)*((alexande_apflora.tblPopulation.PopYKoord-200000)/1000000))-(0.014*((alexande_apflora.tblPopulation.PopYKoord-200000)/1000000)*((alexande_apflora.tblPopulation.PopYKoord-200000)/1000000)*((alexande_apflora.tblPopulation.PopYKoord-200000)/1000000)))*100/36 AS Breitengrad, CAST(CONCAT('http://www.apflora.ch/index.html?ap=', alexande_apflora.tblAktionsplan.ApArtId, '&pop=', alexande_apflora.tblPopulation.PopId) AS CHAR) AS URL
FROM (alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
WHERE alexande_apflora.tblPopulation.PopYKoord > 0 AND alexande_apflora.tblPopulation.PopXKoord > 0
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName;

CREATE OR REPLACE VIEW vKontrAnzProZaehleinheit0 AS
SELECT TPopKontrId, ZaehleinheitTxt AS TPopKontrZaehleinheit, Count(TPopKontrAnz1) AS TPopKontrAnz FROM alexande_apflora.tblTeilPopFeldkontrolle INNER JOIN alexande_apflora.DomainTPopKontrZaehleinheit ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit1 = DomainTPopKontrZaehleinheit.ZaehleinheitCode GROUP BY TPopKontrId, ZaehleinheitTxt
Union SELECT TPopKontrId, ZaehleinheitTxt AS TPopKontrZaehleinheit, Count(TPopKontrAnz2) AS TPopKontrAnz FROM alexande_apflora.tblTeilPopFeldkontrolle INNER JOIN alexande_apflora.DomainTPopKontrZaehleinheit ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit2 = DomainTPopKontrZaehleinheit.ZaehleinheitCode GROUP BY TPopKontrId, ZaehleinheitTxt
Union SELECT TPopKontrId, ZaehleinheitTxt AS TPopKontrZaehleinheit, Count(TPopKontrAnz3) AS TPopKontrAnz FROM alexande_apflora.tblTeilPopFeldkontrolle INNER JOIN alexande_apflora.DomainTPopKontrZaehleinheit ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit3 = DomainTPopKontrZaehleinheit.ZaehleinheitCode GROUP BY TPopKontrId, ZaehleinheitTxt
ORDER BY TPopKontrId, TPopKontrZaehleinheit;

CREATE OR REPLACE VIEW vKontrAnzProZaehleinheit AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", tblAdresse_1.AdrName AS "AP verantwortlich", alexande_apflora.tblPopulation.PopGuid AS "Pop Guid", alexande_apflora.tblPopulation.PopNr AS "Pop Nr", alexande_apflora.tblPopulation.PopName AS "Pop Name", DomainPopHerkunft.HerkunftTxt AS "Pop Herkunft", alexande_apflora.tblPopulation.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblTeilpopulation.TPopGuid AS "TPop Guid", alexande_apflora.tblTeilpopulation.TPopNr AS "TPop Nr", alexande_apflora.tblTeilpopulation.TPopGemeinde AS "TPop Gemeinde", alexande_apflora.tblTeilpopulation.TPopFlurname AS "TPop Flurname", DomainPopHerkunft_1.HerkunftTxt AS "TPop Status", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklar AS "TPop Status unklar", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklarBegruendung AS "TPop Begründung für unklaren Status", alexande_apflora.tblTeilpopulation.TPopXKoord AS "TPop X-Koordinaten", alexande_apflora.tblTeilpopulation.TPopYKoord AS "TPop Y-Koordinaten", alexande_apflora.tblTeilpopulation.TPopRadius AS "TPop Radius m", alexande_apflora.tblTeilpopulation.TPopHoehe AS "TPop Höhe", alexande_apflora.tblTeilpopulation.TPopExposition AS "TPop Exposition", alexande_apflora.tblTeilpopulation.TPopKlima AS "TPop Klima", alexande_apflora.tblTeilpopulation.TPopNeigung AS "TPop Hangneigung", alexande_apflora.tblTeilpopulation.TPopBeschr AS "TPop Beschreibung", alexande_apflora.tblTeilpopulation.TPopKatNr AS "TPop Kataster-Nr", tblAdresse_2.AdrName AS "TPop verantwortlich", DomainPopHerkunft_1.HerkunftTxt AS "TPop Herkunft", alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant AS "TPop für AP-Bericht relevant", alexande_apflora.tblTeilpopulation.TPopBekanntSeit AS "TPop bekannt seit", alexande_apflora.tblTeilpopulation.TPopEigen AS "TPop EigentümerIn", alexande_apflora.tblTeilpopulation.TPopKontakt AS "TPop Kontakt vor Ort", alexande_apflora.tblTeilpopulation.TPopNutzungszone AS "TPop Nutzungszone", alexande_apflora.tblTeilpopulation.TPopBewirtschafterIn AS "TPop BewirtschafterIn", alexande_apflora.tblTeilpopulation.TPopBewirtschaftung AS "TPop Bewirtschaftung", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrGuid AS "Kontr Guid", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr AS "Kontr Jahr", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum AS "Kontr Datum", alexande_apflora.DomainTPopFeldkontrTyp.DomainTxt AS "Kontr Typ", alexande_apflora.tblAdresse.AdrName AS "Kontr BearbeiterIn", alexande_apflora_views.vKontrAnzProZaehleinheit0.TPopKontrZaehleinheit AS "Kontr Zähleinheit", alexande_apflora_views.vKontrAnzProZaehleinheit0.TPopKontrAnz AS "Kontr Anzahl", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUeberleb AS "Kontr Überlebensrate", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVitalitaet AS "Kontr Vitalität", DomainPopEntwicklung.EntwicklungTxt AS "Kontr Entwicklung", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUrsach AS "Kontr Ursachen", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUrteil AS "Kontr Erfolgsbeurteilung", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAendUms AS "Kontr Änderungs-Vorschläge Umsetzung", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAendKontr AS "Kontr Änderungs-Vorschläge Kontrolle", alexande_apflora.tblTeilpopulation.TPopXKoord AS "Kontr X-Koord", alexande_apflora.tblTeilpopulation.TPopYKoord AS "Kontr Y-Koord", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTxt AS "Kontr Bemerkungen", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrLeb AS "Kontr Lebensraum Delarze", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrLebUmg AS "Kontr angrenzender Lebensraum Delarze", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVegTyp AS "Kontr Vegetationstyp", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrKonkurrenz AS "Kontr Konkurrenz", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMoosschicht AS "Kontr Moosschicht", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrKrautschicht AS "Kontr Krautschicht", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrStrauchschicht AS "Kontr Strauchschicht", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBaumschicht AS "Kontr Baumschicht", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenTyp AS "Kontr Bodentyp", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenKalkgehalt AS "Kontr Boden Kalkgehalt", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenDurchlaessigkeit AS "Kontr Boden Durchlässigkeit", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenHumus AS "Kontr Boden Humusgehalt", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenNaehrstoffgehalt AS "Kontr Boden Nährstoffgehalt", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenAbtrag AS "Kontr Oberbodenabtrag", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrWasserhaushalt AS "Kontr Wasserhaushalt", DomainTPopKontrIdBiotUebereinst.DomainTxt AS "Kontr Übereinstimmung mit Idealbiotop", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrHandlungsbedarf AS "Kontr Handlungsbedarf", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUebFlaeche AS "Kontr ÜberprÜfte Fläche", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrFlaeche AS "Kontr Fläche der Teilpopulation m2", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrPlan AS "Kontr auf Plan eingezeichnet", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVeg AS "Kontr Deckung durch Vegetation", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrNaBo AS "Kontr Deckung nackter Boden", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUebPfl AS "Kontr Deckung durch überprüfte Art", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJungPflJN AS "Kontr auch junge Pflanzen", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVegHoeMax AS "Kontr maximale Veg-höhe cm", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVegHoeMit AS "Kontr mittlere Veg-höhe cm", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrGefaehrdung AS "Kontr Gefährdung", alexande_apflora.tblTeilPopFeldkontrolle.MutWann AS "Datensatz zuletzt geändert", alexande_apflora.tblTeilPopFeldkontrolle.MutWer AS "Datensatz zuletzt geändert von"
FROM (alexande_apflora.DomainPopHerkunft AS DomainPopHerkunft_1 RIGHT JOIN (alexande_apflora.tblAdresse AS tblAdresse_2 RIGHT JOIN ((((((((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN (alexande_apflora.tblPopulation INNER JOIN (alexande_apflora.tblTeilpopulation INNER JOIN ((((((alexande_apflora.tblTeilPopFeldkontrolle LEFT JOIN alexande_apflora.DomainTPopFeldkontrTyp ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp = alexande_apflora.DomainTPopFeldkontrTyp.DomainTxt) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit1 = DomainTPopKontrZaehleinheit.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit2 = DomainTPopKontrZaehleinheit_1.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit3 = DomainTPopKontrZaehleinheit_2.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainPopEntwicklung ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrEntwicklung = DomainPopEntwicklung.EntwicklungId) ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopFeldkontrolle.TPopId) ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.DomainTPopKontrMethode ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode1 = DomainTPopKontrMethode.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode2 = DomainTPopKontrMethode_2.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode3 = DomainTPopKontrMethode_1.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrIdBiotUebereinst ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrIdealBiotopUebereinst = DomainTPopKontrIdBiotUebereinst.DomainCode) LEFT JOIN alexande_apflora.tblAdresse AS tblAdresse_1 ON alexande_apflora.tblAktionsplan.ApBearb = tblAdresse_1.AdrId) ON tblAdresse_2.AdrId = alexande_apflora.tblTeilpopulation.TPopVerantw) ON DomainPopHerkunft_1.HerkunftId = alexande_apflora.tblTeilpopulation.TPopHerkunft) INNER JOIN alexande_apflora_views.vKontrAnzProZaehleinheit0 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrId = alexande_apflora_views.vKontrAnzProZaehleinheit0.TPopKontrId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr;

CREATE OR REPLACE VIEW vTPopBer AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPopulation.PopGuid AS "Pop Guid", alexande_apflora.tblPopulation.PopNr AS "Pop Nr", alexande_apflora.tblPopulation.PopName AS "Pop Name", DomainPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPopulation.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPopulation.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPopulation.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPopulation.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPopulation.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblTeilpopulation.TPopId AS "TPop ID", alexande_apflora.tblTeilpopulation.TPopGuid AS "TPop Guid", alexande_apflora.tblTeilpopulation.TPopNr AS "TPop Nr", alexande_apflora.tblTeilpopulation.TPopGemeinde AS "TPop Gemeinde", alexande_apflora.tblTeilpopulation.TPopFlurname AS "TPop Flurname", DomainPopHerkunft_1.HerkunftTxt AS "TPop Status", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklar AS "TPop Status unklar", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklarBegruendung AS "TPop Begründung für unklaren Status", alexande_apflora.tblTeilpopulation.TPopXKoord AS "TPop X-Koordinaten", alexande_apflora.tblTeilpopulation.TPopYKoord AS "TPop Y-Koordinaten", alexande_apflora.tblTeilpopulation.TPopRadius AS "TPop Radius (m)", alexande_apflora.tblTeilpopulation.TPopHoehe AS "TPop Höhe", alexande_apflora.tblTeilpopulation.TPopExposition AS "TPop Exposition", alexande_apflora.tblTeilpopulation.TPopKlima AS "TPop Klima", alexande_apflora.tblTeilpopulation.TPopNeigung AS "TPop Hangneigung", alexande_apflora.tblTeilpopulation.TPopBeschr AS "TPop Beschreibung", alexande_apflora.tblTeilpopulation.TPopKatNr AS "TPop Kataster-Nr", alexande_apflora.tblAdresse.AdrName AS "TPop Verantwortlich", alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant AS "TPop für AP-Bericht relevant", alexande_apflora.tblTeilpopulation.TPopBekanntSeit AS "TPop bekannt seit", alexande_apflora.tblTeilpopulation.TPopEigen AS "TPop EigentümerIn", alexande_apflora.tblTeilpopulation.TPopKontakt AS "TPop Kontakt vor Ort", alexande_apflora.tblTeilpopulation.TPopNutzungszone AS "TPop Nutzungszone", alexande_apflora.tblTeilpopulation.TPopBewirtschafterIn AS "TPop BewirtschafterIn", alexande_apflora.tblTeilpopulation.TPopBewirtschaftung AS "TPop Bewirtschaftung", alexande_apflora.tblTeilPopBericht.TPopBerId AS "TPopBer Id", alexande_apflora.tblTeilPopBericht.TPopBerJahr AS "TPopBer Jahr", DomainPopEntwicklung.EntwicklungTxt AS "TPopBer Entwicklung", alexande_apflora.tblTeilPopBericht.TPopBerTxt AS "TPopBer Bemerkungen", alexande_apflora.tblTeilPopBericht.MutWann AS "TPopBer MutWann", alexande_apflora.tblTeilPopBericht.MutWer AS "TPopBer MutWer"
FROM ((((((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) RIGHT JOIN (alexande_apflora.tblPopulation RIGHT JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.DomainPopHerkunft AS DomainPopHerkunft_1 ON alexande_apflora.tblTeilpopulation.TPopHerkunft = DomainPopHerkunft_1.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilpopulation.TPopVerantw = alexande_apflora.tblAdresse.AdrId) RIGHT JOIN alexande_apflora.tblTeilPopBericht ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopBericht.TPopId) LEFT JOIN alexande_apflora.DomainPopEntwicklung ON alexande_apflora.tblTeilPopBericht.TPopBerEntwicklung = DomainPopEntwicklung.EntwicklungId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilPopBericht.TPopBerJahr, DomainPopEntwicklung.EntwicklungTxt;

CREATE OR REPLACE VIEW vPopBerMassnJahre AS
SELECT alexande_apflora.tblPopulation.PopId, alexande_apflora.tblPopBericht.PopBerJahr as "Jahr"
FROM alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblPopBericht ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopBericht.PopId
UNION DISTINCT SELECT alexande_apflora.tblPopulation.PopId, alexande_apflora.tblPopMassnBericht.PopMassnBerJahr as "Jahr"
FROM alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblPopMassnBericht ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopMassnBericht.PopId
ORDER BY Jahr;

CREATE OR REPLACE VIEW vPop_BerUndMassnBer AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS "AP ApArtId", alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPopulation.PopGuid AS "Pop Guid", alexande_apflora.tblPopulation.PopNr AS "Pop Nr", alexande_apflora.tblPopulation.PopName AS "Pop Name", DomainPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPopulation.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPopulation.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPopulation.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPopulation.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPopulation.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblPopulation.MutWann AS "Datensatz zuletzt geändert", alexande_apflora.tblPopulation.MutWer AS "Datensatz zuletzt geändert von", alexande_apflora_views.vPopBerMassnJahre.Jahr, alexande_apflora.tblPopBericht.PopBerId AS "PopBer Id", alexande_apflora.tblPopBericht.PopBerJahr AS "PopBer Jahr", DomainPopEntwicklung.EntwicklungTxt AS "PopBer Entwicklung", alexande_apflora.tblPopBericht.PopBerTxt AS "PopBer Bemerkungen", alexande_apflora.tblPopBericht.MutWann AS "PopBer MutWann", alexande_apflora.tblPopBericht.MutWer AS "PopBer MutWer", alexande_apflora.tblPopMassnBericht.PopMassnBerId AS "PopMassnBer Id", alexande_apflora.tblPopMassnBericht.PopMassnBerJahr AS "PopMassnBer Jahr", DomainTPopMassnErfolgsbeurteilung.BeurteilTxt AS "PopMassnBer Entwicklung", alexande_apflora.tblPopMassnBericht.PopMassnBerTxt AS "PopMassnBer Interpretation", alexande_apflora.tblPopMassnBericht.MutWann AS "PopMassnBer MutWann", alexande_apflora.tblPopMassnBericht.MutWer AS "PopMassnBer MutWer"
FROM (((((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN alexande_apflora.tblPopulation ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora_views.vPopBerMassnJahre ON alexande_apflora.tblPopulation.PopId = alexande_apflora_views.vPopBerMassnJahre.PopId) LEFT JOIN (alexande_apflora.tblPopMassnBericht LEFT JOIN alexande_apflora.DomainTPopMassnErfolgsbeurteilung ON alexande_apflora.tblPopMassnBericht.PopMassnBerErfolgsbeurteilung = DomainTPopMassnErfolgsbeurteilung.BeurteilId) ON (alexande_apflora_views.vPopBerMassnJahre.Jahr = alexande_apflora.tblPopMassnBericht.PopMassnBerJahr) AND (alexande_apflora_views.vPopBerMassnJahre.PopId = alexande_apflora.tblPopMassnBericht.PopId)) LEFT JOIN (alexande_apflora.tblPopBericht LEFT JOIN alexande_apflora.DomainPopEntwicklung ON alexande_apflora.tblPopBericht.PopBerEntwicklung = DomainPopEntwicklung.EntwicklungId) ON (alexande_apflora_views.vPopBerMassnJahre.Jahr = alexande_apflora.tblPopBericht.PopBerJahr) AND (alexande_apflora_views.vPopBerMassnJahre.PopId = alexande_apflora.tblPopBericht.PopId)
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora_views.vPopBerMassnJahre.Jahr;

CREATE OR REPLACE VIEW vTPopBerMassnJahre AS
SELECT alexande_apflora.tblTeilpopulation.TPopId, alexande_apflora.tblTeilPopBericht.TPopBerJahr as "Jahr"
FROM alexande_apflora.tblTeilpopulation INNER JOIN alexande_apflora.tblTeilPopBericht ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopBericht.TPopId
UNION DISTINCT SELECT alexande_apflora.tblTeilpopulation.TPopId, alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerJahr as "Jahr"
FROM alexande_apflora.tblTeilpopulation INNER JOIN alexande_apflora.tblTeilPopMassnBericht ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnBericht.TPopId
ORDER BY Jahr;

CREATE OR REPLACE VIEW vTPopKontrBerMassnJahre AS
SELECT alexande_apflora.tblTeilpopulation.TPopId, alexande_apflora.tblTeilPopBericht.TPopBerJahr AS "Jahr" 
FROM alexande_apflora.tblTeilpopulation INNER JOIN alexande_apflora.tblTeilPopBericht ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopBericht.TPopId
UNION DISTINCT SELECT alexande_apflora.tblTeilpopulation.TPopId, alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerJahr AS "Jahr"
FROM alexande_apflora.tblTeilpopulation INNER JOIN alexande_apflora.tblTeilPopMassnBericht ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnBericht.TPopId
UNION DISTINCT SELECT alexande_apflora.tblTeilpopulation.TPopId, alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr AS "Jahr"
FROM alexande_apflora.tblTeilpopulation INNER JOIN alexande_apflora.tblTeilPopFeldkontrolle ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopFeldkontrolle.TPopId
ORDER BY Jahr;

CREATE OR REPLACE VIEW vTPop_BerUndMassnBer AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPopulation.PopGuid AS "Pop Guid", alexande_apflora.tblPopulation.PopNr AS "Pop Nr", alexande_apflora.tblPopulation.PopName AS "Pop Name", DomainPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPopulation.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPopulation.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPopulation.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPopulation.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPopulation.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblTeilpopulation.TPopId AS "TPop ID", alexande_apflora.tblTeilpopulation.TPopGuid AS "TPop Guid", alexande_apflora.tblTeilpopulation.TPopNr AS "TPop Nr", alexande_apflora.tblTeilpopulation.TPopGemeinde AS "TPop Gemeinde", alexande_apflora.tblTeilpopulation.TPopFlurname AS "TPop Flurname", DomainPopHerkunft_1.HerkunftTxt AS "TPop Status", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklar AS "TPop Status unklar", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklarBegruendung AS "TPop Begründung für unklaren Status", alexande_apflora.tblTeilpopulation.TPopXKoord AS "TPop X-Koordinaten", alexande_apflora.tblTeilpopulation.TPopYKoord AS "TPop Y-Koordinaten", alexande_apflora.tblTeilpopulation.TPopRadius AS "TPop Radius (m)", alexande_apflora.tblTeilpopulation.TPopHoehe AS "TPop Höhe", alexande_apflora.tblTeilpopulation.TPopExposition AS "TPop Exposition", alexande_apflora.tblTeilpopulation.TPopKlima AS "TPop Klima", alexande_apflora.tblTeilpopulation.TPopNeigung AS "TPop Hangneigung", alexande_apflora.tblTeilpopulation.TPopBeschr AS "TPop Beschreibung", alexande_apflora.tblTeilpopulation.TPopKatNr AS "TPop Kataster-Nr", alexande_apflora.tblAdresse.AdrName AS "TPop Verantwortlich", alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant AS "TPop für AP-Bericht relevant", alexande_apflora.tblTeilpopulation.TPopBekanntSeit AS "TPop bekannt seit", alexande_apflora.tblTeilpopulation.TPopEigen AS "TPop EigentümerIn", alexande_apflora.tblTeilpopulation.TPopKontakt AS "TPop Kontakt vor Ort", alexande_apflora.tblTeilpopulation.TPopNutzungszone AS "TPop Nutzungszone", alexande_apflora.tblTeilpopulation.TPopBewirtschafterIn AS "TPop BewirtschafterIn", alexande_apflora.tblTeilpopulation.TPopBewirtschaftung AS "TPop Bewirtschaftung", alexande_apflora_views.vTPopBerMassnJahre.Jahr, alexande_apflora.tblTeilPopBericht.TPopBerId AS "TPopBer Id", alexande_apflora.tblTeilPopBericht.TPopBerJahr AS "TPopBer Jahr", DomainPopEntwicklung.EntwicklungTxt AS "TPopBer Entwicklung", alexande_apflora.tblTeilPopBericht.TPopBerTxt AS "TPopBer Bemerkungen", alexande_apflora.tblTeilPopBericht.MutWann AS "TPopBer MutWann", alexande_apflora.tblTeilPopBericht.MutWer AS "TPopBer MutWer", alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerJahr AS "TPopMassnBer Jahr", DomainTPopMassnErfolgsbeurteilung.BeurteilTxt AS "TPopMassnBer Entwicklung", alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerTxt AS "TPopMassnBer Interpretation", alexande_apflora.tblTeilPopMassnBericht.MutWann AS "TPopMassnBer MutWann", alexande_apflora.tblTeilPopMassnBericht.MutWer AS "TPopMassnBer MutWer"
FROM (((((((((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) RIGHT JOIN (alexande_apflora.tblPopulation RIGHT JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.DomainPopHerkunft AS DomainPopHerkunft_1 ON alexande_apflora.tblTeilpopulation.TPopHerkunft = DomainPopHerkunft_1.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilpopulation.TPopVerantw = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora_views.vTPopBerMassnJahre ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora_views.vTPopBerMassnJahre.TPopId) LEFT JOIN alexande_apflora.tblTeilPopMassnBericht ON (alexande_apflora_views.vTPopBerMassnJahre.TPopId = alexande_apflora.tblTeilPopMassnBericht.TPopId) AND (alexande_apflora_views.vTPopBerMassnJahre.Jahr = alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerJahr)) LEFT JOIN alexande_apflora.DomainTPopMassnErfolgsbeurteilung ON alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerErfolgsbeurteilung = DomainTPopMassnErfolgsbeurteilung.BeurteilId) LEFT JOIN alexande_apflora.tblTeilPopBericht ON (alexande_apflora_views.vTPopBerMassnJahre.Jahr = alexande_apflora.tblTeilPopBericht.TPopBerJahr) AND (alexande_apflora_views.vTPopBerMassnJahre.TPopId = alexande_apflora.tblTeilPopBericht.TPopId)) LEFT JOIN alexande_apflora.DomainPopEntwicklung ON alexande_apflora.tblTeilPopBericht.TPopBerEntwicklung = DomainPopEntwicklung.EntwicklungId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora_views.vTPopBerMassnJahre.Jahr;

CREATE OR REPLACE VIEW vPop_BerMassnJahreVonTPop AS 
SELECT alexande_apflora.tblTeilpopulation.PopId, alexande_apflora_views.vTPopBerMassnJahre.Jahr
FROM alexande_apflora_views.vTPopBerMassnJahre INNER JOIN alexande_apflora.tblTeilpopulation ON alexande_apflora_views.vTPopBerMassnJahre.TPopId = alexande_apflora.tblTeilpopulation.TPopId
GROUP BY alexande_apflora.tblTeilpopulation.PopId, alexande_apflora_views.vTPopBerMassnJahre.Jahr;

/*diese Abfrage nötig, weil in Access die NO_NOTE zw. tblBeobZuordnung (Text) und tblBeobInfospezies (Zahl) nicht verbunden werden kann*/
CREATE OR REPLACE VIEW vBeobZuordnungInfospeziesArtAnzMut AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.tblBeobZuordnung.BeobMutWer, alexande_apflora.tblBeobZuordnung.BeobMutWann, Count(alexande_apflora.tblBeobZuordnung.NO_NOTE) AS AnzMut, "tblBeobZuordnung_Infospezies" AS Tabelle
FROM ((alexande_apflora.tblAktionsplan INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON alexande_apflora.tblAktionsplan.ApArtId = alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId) INNER JOIN alexande_beob.tblBeobInfospezies ON alexande_apflora.tblAktionsplan.ApArtId = alexande_beob.tblBeobInfospezies.NO_ISFS) INNER JOIN alexande_apflora.tblBeobZuordnung ON alexande_beob.tblBeobInfospezies.NO_NOTE = alexande_apflora.tblBeobZuordnung.NO_NOTE
GROUP BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblBeobZuordnung.BeobMutWer, alexande_apflora.tblBeobZuordnung.BeobMutWann;

/*funktioniert nicht, daher ausgeschaltet
CREATE OR REPLACE VIEW vTPop_KontrBerMassnBer AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", tblAdresse_1.AdrName AS "AP verantwortlich", alexande_apflora.tblPopulation.PopGuid AS "Pop Guid", alexande_apflora.tblPopulation.PopNr AS "Pop Nr", alexande_apflora.tblPopulation.PopName AS "Pop Name", DomainPopHerkunft.HerkunftTxt AS "Pop Herkunft", alexande_apflora.tblPopulation.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblTeilpopulation.TPopId AS "TPop ID", alexande_apflora.tblTeilpopulation.TPopGuid AS "TPop Guid", alexande_apflora.tblTeilpopulation.TPopNr AS "TPop Nr", alexande_apflora.tblTeilpopulation.TPopGemeinde AS "TPop Gemeinde", alexande_apflora.tblTeilpopulation.TPopFlurname AS "TPop Flurname", DomainPopHerkunft_1.HerkunftTxt AS "TPop Status", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklar AS "TPop Status unklar", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklarBegruendung AS "TPop Begründung für unklaren Status", alexande_apflora.tblTeilpopulation.TPopXKoord AS "TPop X-Koordinaten", alexande_apflora.tblTeilpopulation.TPopYKoord AS "TPop Y-Koordinaten", alexande_apflora.tblTeilpopulation.TPopRadius AS "TPop Radius m", alexande_apflora.tblTeilpopulation.TPopHoehe AS "TPop Höhe", alexande_apflora.tblTeilpopulation.TPopExposition AS "TPop Exposition", alexande_apflora.tblTeilpopulation.TPopKlima AS "TPop Klima", alexande_apflora.tblTeilpopulation.TPopNeigung AS "TPop Hangneigung", alexande_apflora.tblTeilpopulation.TPopBeschr AS "TPop Beschreibung", alexande_apflora.tblTeilpopulation.TPopKatNr AS "TPop Kataster-Nr", tblAdresse_2.AdrName AS "TPop verantwortlich", DomainPopHerkunft_1.HerkunftTxt AS "TPop Herkunft", alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant AS "TPop für AP-Bericht relevant", alexande_apflora.tblTeilpopulation.TPopBekanntSeit AS "TPop bekannt seit", alexande_apflora.tblTeilpopulation.TPopEigen AS "TPop EigentümerIn", alexande_apflora.tblTeilpopulation.TPopKontakt AS "TPop Kontakt vor Ort", alexande_apflora.tblTeilpopulation.TPopNutzungszone AS "TPop Nutzungszone", alexande_apflora.tblTeilpopulation.TPopBewirtschafterIn AS "TPop BewirtschafterIn", alexande_apflora.tblTeilpopulation.TPopBewirtschaftung AS "TPop Bewirtschaftung", alexande_apflora_views.vTPopAnzKontr.`Anzahl Kontrollen`, alexande_apflora_views.vTPopAnzFeldkontr.`Anzahl Feld-Kontrollen`, alexande_apflora_views.vTPopAnzFreiwkontr.`Anzahl Freiwilligen-Kontrollen`, alexande_apflora_views.vTPopKontrBerMassnJahre.Jahr, alexande_apflora_views.vPopBer.`PopBer Id`, alexande_apflora_views.vPopBer.`PopBer Jahr`, alexande_apflora_views.vPopBer.`PopBer Entwicklung`, alexande_apflora_views.vPopBer.`PopBer Bemerkungen`, alexande_apflora_views.vPopBer.`PopBer MutWann`, alexande_apflora_views.vPopBer.`PopBer MutWer`, alexande_apflora_views.vPopMassnBer.`PopMassnBer Id`, alexande_apflora_views.vPopMassnBer.`PopMassnBer Jahr`, alexande_apflora_views.vPopMassnBer.`PopMassnBer Entwicklung`, alexande_apflora_views.vPopMassnBer.`PopMassnBer Interpretation`, alexande_apflora_views.vPopMassnBer.`PopMassnBer MutWann`, alexande_apflora_views.vPopMassnBer.`PopMassnBer MutWer`, alexande_apflora.tblTeilPopBericht.TPopBerId AS "TPopBer Id", alexande_apflora.tblTeilPopBericht.TPopBerJahr AS "TPopBer Jahr", DomainPopEntwicklung_1.EntwicklungTxt AS "TPopBer Entwicklung", alexande_apflora.tblTeilPopBericht.TPopBerTxt AS "TPopBer Bemerkungen", alexande_apflora.tblTeilPopBericht.MutWann AS "TPopBer MutWann", alexande_apflora.tblTeilPopBericht.MutWer AS "TPopBer MutWer", alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerId AS "TPopMassnBer Id", alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerJahr AS "TPopMassnBer Jahr", DomainTPopMassnErfolgsbeurteilung.BeurteilTxt AS "TPopMassnBer Beurteilung", alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerTxt AS "TPopMassnBer Bemerkungen", alexande_apflora.tblTeilPopMassnBericht.MutWann AS "TPopMassnBer MutWann", alexande_apflora.tblTeilPopMassnBericht.MutWer AS "TPopMassnBer MutWer", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrGuid AS "Kontr Guid", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr AS "Kontr Jahr", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum AS "Kontr Datum", alexande_apflora.DomainTPopFeldkontrTyp.DomainTxt AS "Kontr Typ", alexande_apflora.tblAdresse.AdrName AS "Kontr BearbeiterIn", DomainTPopKontrZaehleinheit.ZaehleinheitTxt AS "Kontr Zähleinheit 1", DomainTPopKontrMethode.BeurteilTxt AS "Kontr Methode 1", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz1 AS "Kontr Anzahl 1", DomainTPopKontrZaehleinheit_1.ZaehleinheitTxt AS "Kontr Zähleinheit 2", DomainTPopKontrMethode_2.BeurteilTxt AS "Kontr Methode 2", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz2 AS "Kontr Anzahl 2", DomainTPopKontrZaehleinheit_2.ZaehleinheitTxt AS "Kontr Zähleinheit 3", DomainTPopKontrMethode_1.BeurteilTxt AS "Kontr Methode 3", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz3 AS "Kontr Anzahl 3", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUeberleb AS "Kontr Überlebensrate", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVitalitaet AS "Kontr Vitalität", DomainPopEntwicklung.EntwicklungTxt AS "Kontr Entwicklung", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUrsach AS "Kontr Ursachen", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUrteil AS "Kontr Erfolgsbeurteilung", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAendUms AS "Kontr Änderungs-Vorschläge Umsetzung", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAendKontr AS "Kontr Änderungs-Vorschläge Kontrolle", alexande_apflora.tblTeilpopulation.TPopXKoord AS "Kontr X-Koord", alexande_apflora.tblTeilpopulation.TPopYKoord AS "Kontr Y-Koord", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTxt AS "Kontr Bemerkungen", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrLeb AS "Kontr Lebensraum Delarze", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrLebUmg AS "Kontr angrenzender Lebensraum Delarze", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVegTyp AS "Kontr Vegetationstyp", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrKonkurrenz AS "Kontr Konkurrenz", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMoosschicht AS "Kontr Moosschicht", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrKrautschicht AS "Kontr Krautschicht", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrStrauchschicht AS "Kontr Strauchschicht", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBaumschicht AS "Kontr Baumschicht", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenTyp AS "Kontr Bodentyp", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenKalkgehalt AS "Kontr Boden Kalkgehalt", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenDurchlaessigkeit AS "Kontr Boden Durchlässigkeit", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenHumus AS "Kontr Boden Humusgehalt", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenNaehrstoffgehalt AS "Kontr Boden Nährstoffgehalt", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenAbtrag AS "Kontr Oberbodenabtrag", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrWasserhaushalt AS "Kontr Wasserhaushalt", DomainTPopKontrIdBiotUebereinst.DomainTxt AS CREATE OR REPLACE VIEW vKontrLetzte AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.DomainApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAktionsplan.ApJahr AS "AP Start im Jahr", DomainApUmsetzung.DomainTxt AS "AP Stand Umsetzung", tblAdresse_1.AdrName AS "AP verantwortlich", alexande_apflora.tblPopulation.PopGuid AS "Pop Guid", alexande_apflora.tblPopulation.PopNr AS "Pop Nr", alexande_apflora.tblPopulation.PopName AS "Pop Name", alexande_apflora.DomainPopHerkunft.HerkunftTxt AS "Pop Herkunft", alexande_apflora.tblPopulation.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblTeilpopulation.TPopGuid AS "TPop Guid", alexande_apflora.tblTeilpopulation.TPopNr AS "TPop Nr", alexande_apflora.tblTeilpopulation.TPopGemeinde AS "TPop Gemeinde", alexande_apflora.tblTeilpopulation.TPopFlurname AS "TPop Flurname", DomainPopHerkunft_1.HerkunftTxt AS "TPop Status", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklar AS "TPop Status unklar", alexande_apflora.tblTeilpopulation.TPopHerkunftUnklarBegruendung AS "TPop Begründung für unklaren Status", alexande_apflora.tblTeilpopulation.TPopXKoord AS "TPop X-Koordinaten", alexande_apflora.tblTeilpopulation.TPopYKoord AS "TPop Y-Koordinaten", alexande_apflora.tblTeilpopulation.TPopRadius AS "TPop Radius m", alexande_apflora.tblTeilpopulation.TPopHoehe AS "TPop Höhe", alexande_apflora.tblTeilpopulation.TPopExposition AS "TPop Exposition", alexande_apflora.tblTeilpopulation.TPopKlima AS "TPop Klima", alexande_apflora.tblTeilpopulation.TPopNeigung AS "TPop Hangneigung", alexande_apflora.tblTeilpopulation.TPopBeschr AS "TPop Beschreibung", alexande_apflora.tblTeilpopulation.TPopKatNr AS "TPop Kataster-Nr", tblAdresse_2.AdrName AS "TPop verantwortlich", DomainPopHerkunft_1.HerkunftTxt AS "TPop Herkunft", alexande_apflora.tblTeilpopulation.TPopApBerichtRelevant AS "TPop für AP-Bericht relevant", alexande_apflora.tblTeilpopulation.TPopBekanntSeit AS "TPop bekannt seit", alexande_apflora.tblTeilpopulation.TPopEigen AS "TPop EigentümerIn", alexande_apflora.tblTeilpopulation.TPopKontakt AS "TPop Kontakt vor Ort", alexande_apflora.tblTeilpopulation.TPopNutzungszone AS "TPop Nutzungszone", alexande_apflora.tblTeilpopulation.TPopBewirtschafterIn AS "TPop BewirtschafterIn", alexande_apflora.tblTeilpopulation.TPopBewirtschaftung AS "TPop Bewirtschaftung", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrGuid AS "Kontr Guid", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJahr AS "Kontr Jahr", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrDatum AS "Kontr Datum", alexande_apflora.DomainTPopFeldkontrTyp.DomainTxt AS "Kontr Typ", alexande_apflora.tblAdresse.AdrName AS "Kontr BearbeiterIn", DomainTPopKontrZaehleinheit.ZaehleinheitTxt AS "Kontr Zähleinheit 1", DomainTPopKontrMethode.BeurteilTxt AS "Kontr Methode 1", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz1 AS "Kontr Anzahl 1", DomainTPopKontrZaehleinheit_1.ZaehleinheitTxt AS "Kontr Zähleinheit 2", DomainTPopKontrMethode_2.BeurteilTxt AS "Kontr Methode 2", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz2 AS "Kontr Anzahl 2", DomainTPopKontrZaehleinheit_2.ZaehleinheitTxt AS "Kontr Zähleinheit 3", DomainTPopKontrMethode_1.BeurteilTxt AS "Kontr Methode 3", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAnz3 AS "Kontr Anzahl 3", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUeberleb AS "Kontr Überlebensrate", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVitalitaet AS "Kontr Vitalität", alexande_apflora.DomainPopEntwicklung.EntwicklungTxt AS "Kontr Entwicklung", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUrsach AS "Kontr Ursachen", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUrteil AS "Kontr Erfolgsbeurteilung", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAendUms AS "Kontr Änderungs-Vorschläge Umsetzung", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrAendKontr AS "Kontr Änderungs-Vorschläge Kontrolle", alexande_apflora.tblTeilpopulation.TPopXKoord AS "Kontr X-Koord", alexande_apflora.tblTeilpopulation.TPopYKoord AS "Kontr Y-Koord", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTxt AS "Kontr Bemerkungen", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrLeb AS "Kontr Lebensraum Delarze", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrLebUmg AS "Kontr angrenzender Lebensraum Delarze", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVegTyp AS "Kontr Vegetationstyp", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrKonkurrenz AS "Kontr Konkurrenz", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMoosschicht AS "Kontr Moosschicht", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrKrautschicht AS "Kontr Krautschicht", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrStrauchschicht AS "Kontr Strauchschicht", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBaumschicht AS "Kontr Baumschicht", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenTyp AS "Kontr Bodentyp", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenKalkgehalt AS "Kontr Boden Kalkgehalt", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenDurchlaessigkeit AS "Kontr Boden Durchlässigkeit", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenHumus AS "Kontr Boden Humusgehalt", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenNaehrstoffgehalt AS "Kontr Boden Nährstoffgehalt", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBodenAbtrag AS "Kontr Oberbodenabtrag", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrWasserhaushalt AS "Kontr Wasserhaushalt", DomainTPopKontrIdBiotUebereinst.DomainTxt AS "Kontr Übereinstimmung mit Idealbiotop", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrHandlungsbedarf AS "Kontr Handlungsbedarf", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUebFlaeche AS "Kontr ÜberprÜfte Fläche", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrFlaeche AS "Kontr Fläche der Teilpopulation m2", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrPlan AS "Kontr auf Plan eingezeichnet", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVeg AS "Kontr Deckung durch Vegetation", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrNaBo AS "Kontr Deckung nackter Boden", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrUebPfl AS "Kontr Deckung durch überprüfte Art", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrJungPflJN AS "Kontr auch junge Pflanzen", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVegHoeMax AS "Kontr maximale Veg-höhe cm", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrVegHoeMit AS "Kontr mittlere Veg-höhe cm", alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrGefaehrdung AS "Kontr Gefährdung", alexande_apflora.tblTeilPopFeldkontrolle.MutWann, alexande_apflora.tblTeilPopFeldkontrolle.MutWer
FROM alexande_apflora_views.vKontrLetzteId INNER JOIN (alexande_apflora.DomainPopHerkunft AS DomainPopHerkunft_1 RIGHT JOIN (alexande_apflora.tblAdresse AS tblAdresse_2 RIGHT JOIN ((((((((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAktionsplan ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAktionsplan.ApArtId) INNER JOIN (alexande_apflora.tblPopulation INNER JOIN (alexande_apflora.tblTeilpopulation INNER JOIN ((((((alexande_apflora.tblTeilPopFeldkontrolle LEFT JOIN alexande_apflora.DomainTPopFeldkontrTyp ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrTyp = alexande_apflora.DomainTPopFeldkontrTyp.DomainTxt) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit1 = alexande_apflora.DomainTPopKontrZaehleinheit.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit2 = DomainTPopKontrZaehleinheit_1.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainTPopKontrZaehleinheit AS DomainTPopKontrZaehleinheit_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrZaehleinheit3 = DomainTPopKontrZaehleinheit_2.ZaehleinheitCode) LEFT JOIN alexande_apflora.DomainPopEntwicklung ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrEntwicklung = DomainPopEntwicklung.EntwicklungId) ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopFeldkontrolle.TPopId) ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId) LEFT JOIN alexande_apflora.DomainApBearbeitungsstand ON alexande_apflora.tblAktionsplan.ApStatus = alexande_apflora.DomainApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.DomainApUmsetzung ON alexande_apflora.tblAktionsplan.ApUmsetzung = DomainApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.DomainPopHerkunft ON alexande_apflora.tblPopulation.PopHerkunft = DomainPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.DomainTPopKontrMethode ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode1 = DomainTPopKontrMethode.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_2 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode2 = DomainTPopKontrMethode_2.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrMethode AS DomainTPopKontrMethode_1 ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrMethode3 = DomainTPopKontrMethode_1.BeurteilCode) LEFT JOIN alexande_apflora.DomainTPopKontrIdBiotUebereinst ON alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrIdealBiotopUebereinst = DomainTPopKontrIdBiotUebereinst.DomainCode) LEFT JOIN alexande_apflora.tblAdresse AS tblAdresse_1 ON alexande_apflora.tblAktionsplan.ApBearb = tblAdresse_1.AdrId) ON tblAdresse_2.AdrId = alexande_apflora.tblTeilpopulation.TPopVerantw) ON DomainPopHerkunft_1.HerkunftId = alexande_apflora.tblTeilpopulation.TPopHerkunft) ON alexande_apflora_views.vKontrLetzteId.TPopKontrId = alexande_apflora.tblTeilPopFeldkontrolle.TPopKontrId
WHERE alexande_apflora_views.vPopBer.`Pop Guid`=alexande_apflora.tblPopulation.PopGuid AND alexande_apflora_views.vPopMassnBer.`Pop Guid`=alexande_apflora.tblPopulation.PopGuid
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblTeilpopulation.TPopNr;*/

/*reparieren
CREATE OR REPLACE VIEW vPopMassnBerOhneMassahmen AS 
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, alexande_apflora.tblPopMassnBericht.PopMassnBerJahr
FROM (alexande_apflora.tblAktionsplan INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON alexande_apflora.tblAktionsplan.ApArtId = alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId) INNER JOIN ((alexande_apflora.tblPopulation INNER JOIN alexande_apflora.tblPopMassnBericht ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblPopMassnBericht.PopId) LEFT JOIN (alexande_apflora.tblTeilpopulation LEFT JOIN alexande_apflora_views.vPopMassnSeitBeginnAp ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora_views.vPopMassnSeitBeginnAp.TPopId) ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
WHERE (((alexande_apflora.tblPopMassnBericht.PopMassnBerJahr)>=alexande_apflora.tblAktionsplan.ApJahr) AND ((alexande_apflora_views.vPopMassnSeitBeginnAp.TPopId) Is Null) AND ((alexande_apflora.tblAktionsplan.ApStatus) Between 1 And 3))
GROUP BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, alexande_apflora.tblPopMassnBericht.PopMassnBerJahr
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopMassnBericht.PopMassnBerJahr DESC;*/

/*reparieren
CREATE OR REPLACE VIEW vKontrTPopMassnBerichteOhneMassnahme AS 
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerJahr
FROM (alexande_apflora.tblAktionsplan INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON alexande_apflora.tblAktionsplan.ApArtId = alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId) INNER JOIN ((alexande_apflora.tblPopulation INNER JOIN (alexande_apflora.tblTeilpopulation LEFT JOIN alexande_apflora_views.vPopMassnSeitBeginnAp ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora_views.vPopMassnSeitBeginnAp.TPopId) ON alexande_apflora.tblPopulation.PopId = alexande_apflora.tblTeilpopulation.PopId) INNER JOIN alexande_apflora.tblTeilPopMassnBericht ON alexande_apflora.tblTeilpopulation.TPopId = alexande_apflora.tblTeilPopMassnBericht.TPopId) ON alexande_apflora.tblAktionsplan.ApArtId = alexande_apflora.tblPopulation.ApArtId
WHERE (((alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerJahr)>=alexande_apflora.tblAktionsplan.ApJahr) AND ((alexande_apflora_views.vPopMassnSeitBeginnAp.TPopId) Is Null) AND ((alexande_apflora.tblAktionsplan.ApStatus) Between 1 And 3))
GROUP BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblPopulation.PopName, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerJahr
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPopulation.PopNr, alexande_apflora.tblTeilpopulation.TPopNr, alexande_apflora.tblTeilPopMassnBericht.TPopMassnBerJahr DESC;*/