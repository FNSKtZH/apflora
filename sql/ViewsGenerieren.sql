CREATE OR REPLACE VIEW vApApBerichtRelevant AS
SELECT alexande_apflora.tblAp.ApArtId
FROM alexande_apflora.tblAp INNER JOIN (alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId
WHERE alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblAp.ApArtId;

CREATE OR REPLACE VIEW vKontrLetztesJahr AS
SELECT alexande_apflora.tblAp.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopId, alexande_apflora.tblPop.PopNr, alexande_apflora.tblTPop.TPopId, alexande_apflora.tblTPop.TPopNr, Max(alexande_apflora.tblTPopKontr.TPopKontrJahr) AS MaxvonTPopKontrJahr
FROM alexande_beob.ArtenDb_Arteigenschaften INNER JOIN (((alexande_apflora.tblAp INNER JOIN alexande_apflora.tblPop ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN alexande_apflora.tblTPopKontr ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopKontr.TPopId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId
WHERE alexande_apflora.tblTPopKontr.TPopKontrTyp Not Like "Ziel" And alexande_apflora.tblTPopKontr.TPopKontrTyp Not Like "Zwischenziel"
GROUP BY alexande_apflora.tblAp.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopId, alexande_apflora.tblPop.PopNr, alexande_apflora.tblTPop.TPopId, alexande_apflora.tblTPop.TPopNr
HAVING Max(alexande_apflora.tblTPopKontr.TPopKontrJahr) Is Not Null
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblTPop.TPopNr;

#wird von vBerJb benutzt. Dieses Wiederum in Access:
CREATE OR REPLACE VIEW vErsteMassnahmeProArt AS 
SELECT alexande_apflora.tblAp.ApArtId, Min(alexande_apflora.tblTPopMassn.TPopMassnJahr) AS MinvonTPopMassnJahr
FROM ((alexande_apflora.tblAp INNER JOIN alexande_apflora.tblPop ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN alexande_apflora.tblTPopMassn ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopMassn.TPopId
GROUP BY alexande_apflora.tblAp.ApArtId;

CREATE OR REPLACE VIEW vTPopOhnePop AS
SELECT alexande_apflora.tblTPop.TPopGuid AS "TPop Guid", alexande_apflora.tblTPop.TPopNr AS "TPop Nr", alexande_apflora.tblTPop.TPopGemeinde AS "TPop Gemeinde", alexande_apflora.tblTPop.TPopFlurname AS "TPop Flurname", domPopHerkunft_1.HerkunftTxt AS "TPop Status", alexande_apflora.tblTPop.TPopBekanntSeit AS "TPop bekannt seit", alexande_apflora.tblTPop.TPopHerkunftUnklar AS "TPop Status unklar", alexande_apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "TPop Begründung für unklaren Status", alexande_apflora.tblTPop.TPopXKoord AS "TPop X-Koordinaten", alexande_apflora.tblTPop.TPopYKoord AS "TPop Y-Koordinaten", alexande_apflora.tblTPop.TPopRadius AS "TPop Radius (m)", alexande_apflora.tblTPop.TPopHoehe AS "TPop Höhe üM", alexande_apflora.tblTPop.TPopExposition AS "TPop Exposition", alexande_apflora.tblTPop.TPopKlima AS "TPop Klima", alexande_apflora.tblTPop.TPopNeigung AS "TPop Hangneigung", alexande_apflora.tblTPop.TPopBeschr AS "TPop Beschreibung", alexande_apflora.tblTPop.TPopKatNr AS "TPop Kataster-Nr", alexande_apflora.tblAdresse.AdrName AS "TPop Verantwortlich", alexande_apflora.tblTPop.TPopApBerichtRelevant AS "TPop für AP-Bericht relevant", alexande_apflora.tblTPop.TPopEigen AS "TPop EigentümerIn", alexande_apflora.tblTPop.TPopKontakt AS "TPop Kontakt vor Ort", alexande_apflora.tblTPop.TPopNutzungszone AS "TPop Nutzungszone", alexande_apflora.tblTPop.TPopBewirtschafterIn AS "TPop BewirtschafterIn", alexande_apflora.tblTPop.TPopBewirtschaftung AS "TPop Bewirtschaftung", alexande_apflora.tblTPop.MutWann AS "Datensatz zuletzt geändert", alexande_apflora.tblTPop.MutWann AS "Datensatz zuletzt geändert von"
FROM ((alexande_apflora.tblPop RIGHT JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) LEFT JOIN alexande_apflora.domPopHerkunft AS domPopHerkunft_1 ON alexande_apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId) INNER JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPop.TPopVerantw = alexande_apflora.tblAdresse.AdrId
WHERE alexande_apflora.tblPop.PopId Is Null
ORDER BY alexande_apflora.tblTPop.TPopGemeinde, alexande_apflora.tblTPop.TPopFlurname, alexande_apflora.tblTPop.TPopNr;

CREATE OR REPLACE VIEW vMassn AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPop.PopGuid AS "Pop Guid", alexande_apflora.tblPop.PopNr AS "Pop Nr", alexande_apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblTPop.TPopId AS "TPop ID", alexande_apflora.tblTPop.TPopGuid AS "TPop Guid", alexande_apflora.tblTPop.TPopNr AS "TPop Nr", alexande_apflora.tblTPop.TPopGemeinde AS "TPop Gemeinde", alexande_apflora.tblTPop.TPopFlurname AS "TPop Flurname", domPopHerkunft_1.HerkunftTxt AS "TPop Status", alexande_apflora.tblTPop.TPopBekanntSeit AS "TPop bekannt seit", alexande_apflora.tblTPop.TPopHerkunftUnklar AS "TPop Status unklar", alexande_apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "TPop Begründung für unklaren Status", alexande_apflora.tblTPop.TPopXKoord AS "TPop X-Koordinaten", alexande_apflora.tblTPop.TPopYKoord AS "TPop Y-Koordinaten", alexande_apflora.tblTPop.TPopRadius AS "TPop Radius (m)", alexande_apflora.tblTPop.TPopHoehe AS "TPop Höhe", alexande_apflora.tblTPop.TPopExposition AS "TPop Exposition", alexande_apflora.tblTPop.TPopKlima AS "TPop Klima", alexande_apflora.tblTPop.TPopNeigung AS "TPop Hangneigung", alexande_apflora.tblTPop.TPopBeschr AS "TPop Beschreibung", alexande_apflora.tblTPop.TPopKatNr AS "TPop Kataster-Nr", alexande_apflora.tblAdresse.AdrName AS "TPop Verantwortlich", alexande_apflora.tblTPop.TPopApBerichtRelevant AS "TPop für AP-Bericht relevant", alexande_apflora.tblTPop.TPopEigen AS "TPop EigentümerIn", alexande_apflora.tblTPop.TPopKontakt AS "TPop Kontakt vor Ort", alexande_apflora.tblTPop.TPopNutzungszone AS "TPop Nutzungszone", alexande_apflora.tblTPop.TPopBewirtschafterIn AS "TPop BewirtschafterIn", alexande_apflora.tblTPop.TPopBewirtschaftung AS "TPop Bewirtschaftung", alexande_apflora.tblTPopMassn.TPopMassnGuid AS "Massn Guid", alexande_apflora.tblTPopMassn.TPopMassnJahr AS "Massn Jahr", alexande_apflora.tblTPopMassn.TPopMassnDatum AS "Massn Datum", domTPopMassnTyp.MassnTypTxt AS "Massn Typ", alexande_apflora.tblTPopMassn.TPopMassnTxt AS "Massn Massnahme", alexande_apflora.tblAdresse.AdrName AS "Massn BearbeiterIn", CAST(alexande_apflora.tblTPopMassn.TPopMassnBemTxt AS CHAR) AS "Massn Bemerkungen", alexande_apflora.tblTPopMassn.TPopMassnPlan AS "Massn Plan vorhanden", alexande_apflora.tblTPopMassn.TPopMassnPlanBez AS "Massn Plan Bezeichnung", alexande_apflora.tblTPopMassn.TPopMassnFlaeche AS "Massn Fläche m2", alexande_apflora.tblTPopMassn.TPopMassnAnsiedForm AS "Massn Form der Ansiedlung", alexande_apflora.tblTPopMassn.TPopMassnAnsiedPflanzanordnung AS "Massn Pflanzanordnung", alexande_apflora.tblTPopMassn.TPopMassnMarkierung AS "Massn Markierung",  alexande_apflora.tblTPopMassn.TPopMassnAnsiedAnzTriebe AS "Massn Anz Triebe", alexande_apflora.tblTPopMassn.TPopMassnAnsiedAnzPfl AS "Massn Pflanzen", alexande_apflora.tblTPopMassn.TPopMassnAnzPflanzstellen AS "Massn Anz Pflanzstellen", alexande_apflora.tblTPopMassn.TPopMassnAnsiedWirtspfl AS "Massn Wirtspflanze", alexande_apflora.tblTPopMassn.TPopMassnAnsiedHerkunftPop AS "Massn Herkunftspopulation", alexande_apflora.tblTPopMassn.TPopMassnAnsiedDatSamm AS "Massn Sammeldatum", alexande_apflora.tblTPopMassn.MutWann AS "Datensatz zuletzt geändert", alexande_apflora.tblTPopMassn.MutWer AS "Datensatz zuletzt geändert von"
FROM ((((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN ((alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN (alexande_apflora.tblTPopMassn LEFT JOIN alexande_apflora.domTPopMassnTyp ON alexande_apflora.tblTPopMassn.TPopMassnTyp = domTPopMassnTyp.MassnTypCode) ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopMassn.TPopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.domPopHerkunft AS domPopHerkunft_1 ON alexande_apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPopMassn.TPopMassnBearb = alexande_apflora.tblAdresse.AdrId
WHERE alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId NOT IN (100, 150)
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPopMassn.TPopMassnJahr, alexande_apflora.tblTPopMassn.TPopMassnDatum, domTPopMassnTyp.MassnTypTxt;

CREATE OR REPLACE VIEW vMassnFuerGis AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "ApArt", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "ApStatus", alexande_apflora.tblAp.ApJahr AS "ApStartImJahr", domApUmsetzung.DomainTxt AS "ApStandUmsetzung", alexande_apflora.tblPop.PopGuid AS "PopGuid", alexande_apflora.tblPop.PopNr AS "PopNr", alexande_apflora.tblPop.PopName AS "PopName", domPopHerkunft.HerkunftTxt AS "PopStatus", alexande_apflora.tblPop.PopBekanntSeit AS "PopBekanntSeit", alexande_apflora.tblPop.PopXKoord AS "PopXKoordinaten", alexande_apflora.tblPop.PopYKoord AS "PopYKoordinaten", alexande_apflora.tblTPop.TPopGuid AS "TPopGuid", alexande_apflora.tblTPop.TPopNr AS "TPopNr", alexande_apflora.tblTPop.TPopGemeinde AS "TPopGemeinde", alexande_apflora.tblTPop.TPopFlurname AS "TPopFlurname", domPopHerkunft_1.HerkunftTxt AS "TPopStatus", alexande_apflora.tblTPop.TPopHerkunftUnklar AS "TPopStatusUnklar", alexande_apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "TPopBegründungFuerUnklarenStatus", alexande_apflora.tblTPop.TPopXKoord AS "TPopXKoordinaten", alexande_apflora.tblTPop.TPopYKoord AS "TPopYKoordinaten", alexande_apflora.tblTPop.TPopRadius AS "TPopRadius", alexande_apflora.tblTPop.TPopHoehe AS "TPopHoehe", alexande_apflora.tblTPop.TPopExposition AS "TPopExposition", alexande_apflora.tblTPop.TPopKlima AS "TPopKlima", alexande_apflora.tblTPop.TPopNeigung AS "TPopHangneigung", alexande_apflora.tblTPop.TPopBeschr AS "TPopBeschreibung", alexande_apflora.tblTPop.TPopKatNr AS "TPopKatasterNr", alexande_apflora.tblAdresse.AdrName AS "TPopVerantwortlich", alexande_apflora.tblTPop.TPopApBerichtRelevant AS "TPopFuerApBerichtRelevant", alexande_apflora.tblTPop.TPopBekanntSeit AS "TPopBekanntSeit", alexande_apflora.tblTPop.TPopEigen AS "TPopEigentümerIn", alexande_apflora.tblTPop.TPopKontakt AS "TPopKontaktVorOrt", alexande_apflora.tblTPop.TPopNutzungszone AS "TPopNutzungszone", alexande_apflora.tblTPop.TPopBewirtschafterIn AS "TPopBewirtschafterIn", alexande_apflora.tblTPop.TPopBewirtschaftung AS "TPopBewirtschaftung", alexande_apflora.tblTPopMassn.TPopMassnGuid AS "MassnGuid", alexande_apflora.tblTPopMassn.TPopMassnJahr AS "MassnJahr", alexande_apflora.tblTPopMassn.TPopMassnDatum AS "MassnDatum", domTPopMassnTyp.MassnTypTxt AS "MassnTyp", alexande_apflora.tblTPopMassn.TPopMassnTxt AS "MassnMassnahme", alexande_apflora.tblAdresse.AdrName AS "MassnBearbeiterIn", alexande_apflora.tblTPopMassn.TPopMassnPlan AS "MassnPlanVorhanden", alexande_apflora.tblTPopMassn.TPopMassnPlanBez AS "MassnPlanBezeichnung", alexande_apflora.tblTPopMassn.TPopMassnFlaeche AS "MassnFlaeche", alexande_apflora.tblTPopMassn.TPopMassnAnsiedForm AS "MassnFormDerAnsiedlung", alexande_apflora.tblTPopMassn.TPopMassnAnsiedPflanzanordnung AS "MassnPflanzanordnung", alexande_apflora.tblTPopMassn.TPopMassnMarkierung AS "MassnMarkierung",  alexande_apflora.tblTPopMassn.TPopMassnAnsiedAnzTriebe AS "MassnAnzTriebe", alexande_apflora.tblTPopMassn.TPopMassnAnsiedAnzPfl AS "MassnPflanzen", alexande_apflora.tblTPopMassn.TPopMassnAnzPflanzstellen AS "MassnAnzPflanzstellen", alexande_apflora.tblTPopMassn.TPopMassnAnsiedWirtspfl AS "MassnWirtspflanze", alexande_apflora.tblTPopMassn.TPopMassnAnsiedHerkunftPop AS "MassnHerkunftspopulation", alexande_apflora.tblTPopMassn.TPopMassnAnsiedDatSamm AS "MassnSammeldatum", alexande_apflora.tblTPopMassn.MutWann AS "MassnMutWann", alexande_apflora.tblTPopMassn.MutWer AS "MassnMutWer"
FROM ((((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN ((alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN (alexande_apflora.tblTPopMassn LEFT JOIN alexande_apflora.domTPopMassnTyp ON alexande_apflora.tblTPopMassn.TPopMassnTyp = domTPopMassnTyp.MassnTypCode) ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopMassn.TPopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.domPopHerkunft AS domPopHerkunft_1 ON alexande_apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPopMassn.TPopMassnBearb = alexande_apflora.tblAdresse.AdrId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPopMassn.TPopMassnJahr, alexande_apflora.tblTPopMassn.TPopMassnDatum, domTPopMassnTyp.MassnTypTxt;

CREATE OR REPLACE VIEW vTPopAnzMassn AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPop.PopGuid AS "Pop Guid", alexande_apflora.tblPop.PopNr AS "Pop Nr", alexande_apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblTPop.TPopGuid AS "TPop Guid", alexande_apflora.tblTPop.TPopNr AS "TPop Nr", alexande_apflora.tblTPop.TPopGemeinde AS "TPop Gemeinde", alexande_apflora.tblTPop.TPopFlurname AS "TPop Flurname", domPopHerkunft_1.HerkunftTxt AS "TPop Status", alexande_apflora.tblTPop.TPopBekanntSeit AS "TPop bekannt seit", alexande_apflora.tblTPop.TPopHerkunftUnklar AS "TPop Status unklar", alexande_apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "TPop Begründung für unklaren Status", alexande_apflora.tblTPop.TPopXKoord AS "TPop X-Koordinaten", alexande_apflora.tblTPop.TPopYKoord AS "TPop Y-Koordinaten", alexande_apflora.tblTPop.TPopRadius AS "TPop Radius (m)", alexande_apflora.tblTPop.TPopHoehe AS "TPop Höhe", alexande_apflora.tblTPop.TPopExposition AS "TPop Exposition", alexande_apflora.tblTPop.TPopKlima AS "TPop Klima", alexande_apflora.tblTPop.TPopNeigung AS "TPop Hangneigung", alexande_apflora.tblTPop.TPopBeschr AS "TPop Beschreibung", alexande_apflora.tblTPop.TPopKatNr AS "TPop Kataster-Nr", alexande_apflora.tblTPop.TPopApBerichtRelevant AS "TPop für AP-Bericht relevant", alexande_apflora.tblTPop.TPopEigen AS "TPop EigentümerIn", alexande_apflora.tblTPop.TPopKontakt AS "TPop Kontakt vor Ort", alexande_apflora.tblTPop.TPopNutzungszone AS "TPop Nutzungszone", alexande_apflora.tblTPop.TPopBewirtschafterIn AS "TPop BewirtschafterIn", alexande_apflora.tblTPop.TPopBewirtschaftung AS "TPop Bewirtschaftung", Count(alexande_apflora.tblTPopMassn.TPopMassnId) AS "Anzahl Massnahmen"
FROM (((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN ((alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) LEFT JOIN alexande_apflora.tblTPopMassn ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopMassn.TPopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.domPopHerkunft AS domPopHerkunft_1 ON alexande_apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId
GROUP BY alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.domApBearbeitungsstand.DomainTxt, alexande_apflora.tblAp.ApJahr, domApUmsetzung.DomainTxt, alexande_apflora.tblPop.PopGuid, alexande_apflora.tblPop.PopNr, alexande_apflora.tblPop.PopName, domPopHerkunft.HerkunftTxt, alexande_apflora.tblPop.PopHerkunftUnklar, alexande_apflora.tblPop.PopHerkunftUnklarBegruendung, alexande_apflora.tblPop.PopBekanntSeit, alexande_apflora.tblPop.PopXKoord, alexande_apflora.tblPop.PopYKoord, alexande_apflora.tblTPop.TPopGuid, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPop.TPopGemeinde, alexande_apflora.tblTPop.TPopFlurname, domPopHerkunft_1.HerkunftTxt, alexande_apflora.tblTPop.TPopHerkunftUnklar, alexande_apflora.tblTPop.TPopHerkunftUnklarBegruendung, alexande_apflora.tblTPop.TPopXKoord, alexande_apflora.tblTPop.TPopYKoord, alexande_apflora.tblTPop.TPopRadius, alexande_apflora.tblTPop.TPopHoehe, alexande_apflora.tblTPop.TPopExposition, alexande_apflora.tblTPop.TPopKlima, alexande_apflora.tblTPop.TPopNeigung, alexande_apflora.tblTPop.TPopBeschr, alexande_apflora.tblTPop.TPopKatNr, alexande_apflora.tblTPop.TPopApBerichtRelevant, alexande_apflora.tblTPop.TPopBekanntSeit, alexande_apflora.tblTPop.TPopEigen, alexande_apflora.tblTPop.TPopKontakt, alexande_apflora.tblTPop.TPopNutzungszone, alexande_apflora.tblTPop.TPopBewirtschafterIn, alexande_apflora.tblTPop.TPopBewirtschaftung
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblTPop.TPopNr;

CREATE OR REPLACE VIEW vPopAnzMassn AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPop.PopGuid AS "Pop Guid", alexande_apflora.tblPop.PopNr AS "Pop Nr", alexande_apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", Count(alexande_apflora.tblTPopMassn.TPopMassnId) AS "Anzahl Massnahmen"
FROM ((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN ((alexande_apflora.tblPop LEFT JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) LEFT JOIN alexande_apflora.tblTPopMassn ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopMassn.TPopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId
GROUP BY alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.domApBearbeitungsstand.DomainTxt, alexande_apflora.tblAp.ApJahr, domApUmsetzung.DomainTxt, alexande_apflora.tblPop.PopGuid, alexande_apflora.tblPop.PopNr, alexande_apflora.tblPop.PopName, domPopHerkunft.HerkunftTxt, alexande_apflora.tblPop.PopHerkunftUnklar, alexande_apflora.tblPop.PopHerkunftUnklarBegruendung, alexande_apflora.tblPop.PopBekanntSeit, alexande_apflora.tblPop.PopXKoord, alexande_apflora.tblPop.PopYKoord
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr;

CREATE OR REPLACE VIEW vPopAnzKontr AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPop.PopGuid AS "Pop Guid", alexande_apflora.tblPop.PopNr AS "Pop Nr", alexande_apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", Count(alexande_apflora.tblTPopKontr.TPopKontrId) AS "Anzahl Kontrollen"
FROM ((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN ((alexande_apflora.tblPop LEFT JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) LEFT JOIN alexande_apflora.tblTPopKontr ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopKontr.TPopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId
GROUP BY alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.domApBearbeitungsstand.DomainTxt, alexande_apflora.tblAp.ApJahr, domApUmsetzung.DomainTxt, alexande_apflora.tblPop.PopGuid, alexande_apflora.tblPop.PopNr, alexande_apflora.tblPop.PopName, domPopHerkunft.HerkunftTxt, alexande_apflora.tblPop.PopHerkunftUnklar, alexande_apflora.tblPop.PopHerkunftUnklarBegruendung, alexande_apflora.tblPop.PopBekanntSeit, alexande_apflora.tblPop.PopXKoord, alexande_apflora.tblPop.PopYKoord
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr;

CREATE OR REPLACE VIEW vApAnzMassn AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", Count(alexande_apflora.tblTPopMassn.TPopMassnId) AS "Anzahl Massnahmen"
FROM (((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) LEFT JOIN ((alexande_apflora.tblPop LEFT JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) LEFT JOIN alexande_apflora.tblTPopMassn ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopMassn.TPopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode
GROUP BY alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.domApBearbeitungsstand.DomainTxt, alexande_apflora.tblAp.ApJahr, domApUmsetzung.DomainTxt
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vApAnzKontr AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", Count(alexande_apflora.tblTPopKontr.TPopKontrId) AS "Anzahl Kontrollen"
FROM (((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) LEFT JOIN ((alexande_apflora.tblPop LEFT JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) LEFT JOIN alexande_apflora.tblTPopKontr ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopKontr.TPopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode
GROUP BY alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.domApBearbeitungsstand.DomainTxt, alexande_apflora.tblAp.ApJahr, domApUmsetzung.DomainTxt
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vPop AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPop.PopId, alexande_apflora.tblPop.PopGuid AS "Pop Guid", alexande_apflora.tblPop.PopNr AS "Pop Nr", alexande_apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblPop.MutWann AS "Datensatz zuletzt geändert", alexande_apflora.tblPop.MutWer AS "Datensatz zuletzt geändert von"
FROM ((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN alexande_apflora.tblPop ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr;

CREATE OR REPLACE VIEW vPopOhneKoord AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPop.PopId, alexande_apflora.tblPop.PopGuid AS "Pop Guid", alexande_apflora.tblPop.PopNr AS "Pop Nr", alexande_apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblPop.MutWann AS "Datensatz zuletzt geändert", alexande_apflora.tblPop.MutWer AS "Datensatz zuletzt geändert von"
FROM ((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN alexande_apflora.tblPop ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId
WHERE alexande_apflora.tblPop.PopXKoord IS NULL OR alexande_apflora.tblPop.PopYKoord IS NULL 
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr;

CREATE OR REPLACE VIEW vPopFuerGis AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPop.PopGuid AS "Pop Guid", alexande_apflora.tblPop.PopNr AS "Pop Nr", alexande_apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPop.PopXKoord AS "XKoordinaten", alexande_apflora.tblPop.PopYKoord AS "YKoordinaten", alexande_apflora.tblPop.MutWann AS "Datensatz zuletzt geändert", alexande_apflora.tblPop.MutWer AS "Datensatz zuletzt geändert von"
FROM ((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN alexande_apflora.tblPop ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId
WHERE alexande_apflora.tblPop.PopXKoord > 0 AND alexande_apflora.tblPop.PopYKoord > 0
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr;

#im Gebrauch (Access):
CREATE OR REPLACE VIEW vPopOhneAp AS
SELECT alexande_apflora.tblPop.PopGuid AS "Pop Guid", alexande_apflora.tblPop.PopNr AS "Pop Nr", alexande_apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblPop.MutWann AS "Datensatz zuletzt geändert", alexande_apflora.tblPop.MutWer AS "Datensatz zuletzt geändert von", alexande_apflora.tblAp.ApArtId
FROM (alexande_apflora.tblAp RIGHT JOIN alexande_apflora.tblPop ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId
WHERE alexande_apflora.tblAp.ApArtId Is Null
ORDER BY alexande_apflora.tblPop.PopName, alexande_apflora.tblPop.PopNr;

CREATE OR REPLACE VIEW vPopOhneTPop AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPop.PopGuid AS "Pop Guid", alexande_apflora.tblPop.PopNr AS "Pop Nr", alexande_apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblPop.MutWann AS "Datensatz zuletzt geändert", alexande_apflora.tblPop.MutWer AS "Datensatz zuletzt geändert von"
FROM (((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN alexande_apflora.tblPop ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblTPop.TPopId Is Null
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr;

CREATE OR REPLACE VIEW vPopBer AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPop.PopGuid AS "Pop Guid", alexande_apflora.tblPop.PopNr AS "Pop Nr", alexande_apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblPopBer.PopBerId AS "PopBer Id", alexande_apflora.tblPopBer.PopBerJahr AS "PopBer Jahr", domPopEntwicklung.EntwicklungTxt AS "PopBer Entwicklung", alexande_apflora.tblPopBer.PopBerTxt AS "PopBer Bemerkungen", alexande_apflora.tblPopBer.MutWann AS "PopBer MutWann", alexande_apflora.tblPopBer.MutWer AS "PopBer MutWer"
FROM ((((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN alexande_apflora.tblPop ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) INNER JOIN alexande_apflora.tblPopBer ON alexande_apflora.tblPop.PopId = alexande_apflora.tblPopBer.PopId) LEFT JOIN alexande_apflora.domPopEntwicklung ON alexande_apflora.tblPopBer.PopBerEntwicklung = domPopEntwicklung.EntwicklungId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblPopBer.PopBerJahr, domPopEntwicklung.EntwicklungTxt;

#im Gebrauch (Access):
CREATE OR REPLACE VIEW vPopBerOhnePop AS
SELECT alexande_apflora.tblPopBer.PopBerId AS "PopBer Id", alexande_apflora.tblPopBer.PopId AS "PopBer PopId", alexande_apflora.tblPopBer.PopBerJahr AS "PopBer Jahr", domPopEntwicklung.EntwicklungTxt AS "PopBer Entwicklung", alexande_apflora.tblPopBer.PopBerTxt AS "PopBer Bemerkungen", alexande_apflora.tblPopBer.MutWann AS "PopBer MutWann", alexande_apflora.tblPopBer.MutWer AS "PopBer MutWer"
FROM (alexande_apflora.tblPop RIGHT JOIN alexande_apflora.tblPopBer ON alexande_apflora.tblPop.PopId = alexande_apflora.tblPopBer.PopId) LEFT JOIN alexande_apflora.domPopEntwicklung ON alexande_apflora.tblPopBer.PopBerEntwicklung = domPopEntwicklung.EntwicklungId
WHERE alexande_apflora.tblPop.PopId Is Null
ORDER BY alexande_apflora.tblPopBer.PopBerJahr, domPopEntwicklung.EntwicklungTxt;

CREATE OR REPLACE VIEW vPopMassnBer AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS "AP ApArtId", alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPop.PopGuid AS "Pop Guid", alexande_apflora.tblPop.PopNr AS "Pop Nr", alexande_apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblPop.MutWann AS "Datensatz zuletzt geändert", alexande_apflora.tblPop.MutWer AS "Datensatz zuletzt geändert von", alexande_apflora.tblPopMassnBer.PopMassnBerId AS "PopMassnBer Id", alexande_apflora.tblPopMassnBer.PopMassnBerJahr AS "PopMassnBer Jahr", domTPopMassnErfolgsbeurteilung.BeurteilTxt AS "PopMassnBer Entwicklung", alexande_apflora.tblPopMassnBer.PopMassnBerTxt AS "PopMassnBer Interpretation", alexande_apflora.tblPopMassnBer.MutWann AS "PopMassnBer MutWann", alexande_apflora.tblPopMassnBer.MutWer AS "PopMassnBer MutWer"
FROM ((((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN alexande_apflora.tblPop ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) INNER JOIN alexande_apflora.tblPopMassnBer ON alexande_apflora.tblPop.PopId = alexande_apflora.tblPopMassnBer.PopId) LEFT JOIN alexande_apflora.domTPopMassnErfolgsbeurteilung ON alexande_apflora.tblPopMassnBer.PopMassnBerErfolgsbeurteilung = domTPopMassnErfolgsbeurteilung.BeurteilId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr;

#im Gebrauch (Access):
CREATE OR REPLACE VIEW vPopMassnBerOhnePop AS
SELECT alexande_apflora.tblPopMassnBer.PopMassnBerId AS "PopMassnBer Id", alexande_apflora.tblPopMassnBer.PopId AS "PopMassnBer PopId", alexande_apflora.tblPopMassnBer.PopMassnBerJahr AS "PopMassnBer Jahr", domTPopMassnErfolgsbeurteilung.BeurteilTxt AS "PopMassnBer Entwicklung", alexande_apflora.tblPopMassnBer.PopMassnBerTxt AS "PopMassnBer Interpretation", alexande_apflora.tblPopMassnBer.MutWann AS "PopMassnBer MutWann", alexande_apflora.tblPopMassnBer.MutWer AS "PopMassnBer MutWer"
FROM (alexande_apflora.tblPop RIGHT JOIN alexande_apflora.tblPopMassnBer ON alexande_apflora.tblPop.PopId = alexande_apflora.tblPopMassnBer.PopId) LEFT JOIN alexande_apflora.domTPopMassnErfolgsbeurteilung ON alexande_apflora.tblPopMassnBer.PopMassnBerErfolgsbeurteilung = domTPopMassnErfolgsbeurteilung.BeurteilId
WHERE alexande_apflora.tblPop.PopId Is Null
ORDER BY alexande_apflora.tblPopMassnBer.PopMassnBerJahr, domTPopMassnErfolgsbeurteilung.BeurteilTxt;

CREATE OR REPLACE VIEW vTPop AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPop.PopGuid AS "Pop Guid", alexande_apflora.tblPop.PopNr AS "Pop Nr", alexande_apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblTPop.TPopId AS "TPop ID", alexande_apflora.tblTPop.TPopGuid AS "TPop Guid", alexande_apflora.tblTPop.TPopNr AS "TPop Nr", alexande_apflora.tblTPop.TPopGemeinde AS "TPop Gemeinde", alexande_apflora.tblTPop.TPopFlurname AS "TPop Flurname", domPopHerkunft_1.HerkunftTxt AS "TPop Status", alexande_apflora.tblTPop.TPopBekanntSeit AS "TPop bekannt seit", alexande_apflora.tblTPop.TPopHerkunftUnklar AS "TPop Status unklar", alexande_apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "TPop Begründung für unklaren Status", alexande_apflora.tblTPop.TPopXKoord AS "TPop X-Koordinaten", alexande_apflora.tblTPop.TPopYKoord AS "TPop Y-Koordinaten", alexande_apflora.tblTPop.TPopRadius AS "TPop Radius (m)", alexande_apflora.tblTPop.TPopHoehe AS "TPop Höhe", alexande_apflora.tblTPop.TPopExposition AS "TPop Exposition", alexande_apflora.tblTPop.TPopKlima AS "TPop Klima", alexande_apflora.tblTPop.TPopNeigung AS "TPop Hangneigung", alexande_apflora.tblTPop.TPopBeschr AS "TPop Beschreibung", alexande_apflora.tblTPop.TPopKatNr AS "TPop Kataster-Nr", alexande_apflora.tblAdresse.AdrName AS "TPop Verantwortlich", alexande_apflora.tblTPop.TPopApBerichtRelevant AS "TPop für AP-Bericht relevant", alexande_apflora.tblTPop.TPopEigen AS "TPop EigentümerIn", alexande_apflora.tblTPop.TPopKontakt AS "TPop Kontakt vor Ort", alexande_apflora.tblTPop.TPopNutzungszone AS "TPop Nutzungszone", alexande_apflora.tblTPop.TPopBewirtschafterIn AS "TPop BewirtschafterIn", alexande_apflora.tblTPop.TPopBewirtschaftung AS "TPop Bewirtschaftung", alexande_apflora.tblTPop.MutWann AS "Teilpopulation zuletzt geändert", alexande_apflora.tblTPop.MutWann AS "Teilpopulation zuletzt geändert von"
FROM ((((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) RIGHT JOIN (alexande_apflora.tblPop RIGHT JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.domPopHerkunft AS domPopHerkunft_1 ON alexande_apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPop.TPopVerantw = alexande_apflora.tblAdresse.AdrId
WHERE alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId NOT IN (100, 150)
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblTPop.TPopNr;

CREATE OR REPLACE VIEW vTPopFuerGis AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPop.PopGuid AS "Pop Guid", alexande_apflora.tblPop.PopNr AS "Pop Nr", alexande_apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblTPop.TPopGuid AS "TPop Guid", alexande_apflora.tblTPop.TPopNr AS "TPop Nr", alexande_apflora.tblTPop.TPopGemeinde AS "TPop Gemeinde", alexande_apflora.tblTPop.TPopFlurname AS "TPop Flurname", domPopHerkunft_1.HerkunftTxt AS "TPop Status", alexande_apflora.tblTPop.TPopBekanntSeit AS "TPop bekannt seit", alexande_apflora.tblTPop.TPopHerkunftUnklar AS "TPop Status unklar", alexande_apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "TPop Begründung für unklaren Status", alexande_apflora.tblTPop.TPopXKoord AS "TPopXKoordinaten", alexande_apflora.tblTPop.TPopYKoord AS "TPopYKoordinaten", alexande_apflora.tblTPop.TPopRadius AS "TPop Radius (m)", alexande_apflora.tblTPop.TPopHoehe AS "TPop Höhe", alexande_apflora.tblTPop.TPopExposition AS "TPop Exposition", alexande_apflora.tblTPop.TPopKlima AS "TPop Klima", alexande_apflora.tblTPop.TPopNeigung AS "TPop Hangneigung", alexande_apflora.tblTPop.TPopBeschr AS "TPop Beschreibung", alexande_apflora.tblTPop.TPopKatNr AS "TPop Kataster-Nr", alexande_apflora.tblAdresse.AdrName AS "TPop Verantwortlich", alexande_apflora.tblTPop.TPopApBerichtRelevant AS "TPop für AP-Bericht relevant", alexande_apflora.tblTPop.TPopEigen AS "TPop EigentümerIn", alexande_apflora.tblTPop.TPopKontakt AS "TPop Kontakt vor Ort", alexande_apflora.tblTPop.TPopNutzungszone AS "TPop Nutzungszone", alexande_apflora.tblTPop.TPopBewirtschafterIn AS "TPop BewirtschafterIn", alexande_apflora.tblTPop.TPopBewirtschaftung AS "TPop Bewirtschaftung", alexande_apflora.tblTPop.MutWann AS "Datensatz zuletzt geändert", alexande_apflora.tblTPop.MutWann AS "Datensatz zuletzt geändert von"
FROM ((((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN (alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.domPopHerkunft AS domPopHerkunft_1 ON alexande_apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId) INNER JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPop.TPopVerantw = alexande_apflora.tblAdresse.AdrId
WHERE alexande_apflora.tblTPop.TPopYKoord > 0 AND alexande_apflora.tblTPop.TPopXKoord > 0
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblTPop.TPopNr;

#im Gebrauch durch exportPopVonApOhneStatus.php:
CREATE OR REPLACE VIEW vPopVonApOhneStatus AS 
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.tblAp.ApStatus AS "Bearbeitungsstand AP", alexande_apflora.tblPop.PopNr, alexande_apflora.tblPop.PopName, alexande_apflora.tblPop.PopHerkunft AS Status
FROM alexande_beob.ArtenDb_Arteigenschaften INNER JOIN (alexande_apflora.tblAp INNER JOIN alexande_apflora.tblPop ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId
WHERE ((alexande_apflora.tblAp.ApStatus=3) AND (alexande_apflora.tblPop.PopHerkunft Is Null))
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr;

#im Gebrauch durch exportPopMitMassnberAnzMassn.php:
CREATE OR REPLACE VIEW vPopMassnberAnzMassn0 AS
SELECT alexande_apflora.tblPopMassnBer.PopId, alexande_apflora.tblPopMassnBer.PopMassnBerJahr, Count(alexande_apflora.tblTPopMassn.TPopMassnId) AS AnzahlvonTPopMassnId
FROM alexande_apflora.tblPopMassnBer INNER JOIN (alexande_apflora.tblTPop LEFT JOIN alexande_apflora.tblTPopMassn ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopMassn.TPopId) ON alexande_apflora.tblPopMassnBer.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblTPopMassn.TPopMassnJahr=alexande_apflora.tblPopMassnBer.PopMassnBerJahr Or alexande_apflora.tblTPopMassn.TPopMassnJahr Is Null
GROUP BY alexande_apflora.tblPopMassnBer.PopId, alexande_apflora.tblPopMassnBer.PopMassnBerJahr
ORDER BY alexande_apflora.tblPopMassnBer.PopId, alexande_apflora.tblPopMassnBer.PopMassnBerJahr;

#im Gebrauch durch exportPopMitMassnberAnzMassn.php:
CREATE OR REPLACE VIEW vPopMassnberAnzMassn AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPop.PopGuid AS "Pop Guid", alexande_apflora.tblPop.PopNr AS "Pop Nr", alexande_apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora_views.vPopMassnberAnzMassn0.PopMassnBerJahr AS "MassnBer Jahr", alexande_apflora_views.vPopMassnberAnzMassn0.AnzahlvonTPopMassnId AS "Anz Massnahmen in diesem Jahr"
FROM (((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN alexande_apflora.tblPop ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) INNER JOIN alexande_apflora_views.vPopMassnberAnzMassn0 ON alexande_apflora.tblPop.PopId = alexande_apflora_views.vPopMassnberAnzMassn0.PopId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora_views.vPopMassnberAnzMassn0.PopMassnBerJahr;

CREATE OR REPLACE VIEW vBerJbZielBer AS 
SELECT alexande_apflora.tblZielBer.*
FROM alexande_apflora.tblZielBer INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblZielBer.ZielBerJahr = alexande_apflora.tblKonstanten.JBerJahr;

CREATE OR REPLACE VIEW vBerJbZiel AS
SELECT alexande_apflora.tblZiel.*, domZielTyp.ZieltypTxt
FROM alexande_apflora.tblKonstanten INNER JOIN (alexande_apflora.tblZiel INNER JOIN alexande_apflora.domZielTyp ON alexande_apflora.tblZiel.ZielTyp = domZielTyp.ZieltypId) ON alexande_apflora.tblKonstanten.JBerJahr = alexande_apflora.tblZiel.ZielJahr
WHERE (alexande_apflora.tblZiel.ZielTyp=1 Or alexande_apflora.tblZiel.ZielTyp=2) OR (alexande_apflora.tblZiel.ZielTyp=1170775556)
ORDER BY alexande_apflora.tblZiel.ZielTyp, alexande_apflora.tblZiel.ZielBezeichnung;

CREATE OR REPLACE VIEW vJBerOhneAp AS
SELECT alexande_apflora.tblJBer.JBerId AS "JBer Id", alexande_apflora.tblJBer.ApArtId AS "JBer ApArtId", alexande_apflora.tblJBer.JBerJahr AS "JBer Jahr", alexande_apflora.tblJBer.JBerSituation AS "JBer Situation", alexande_apflora.tblJBer.JBerVergleichVorjahrGesamtziel AS "JBer Vergleich Vorjahr-Gesamtziel", domApErfKrit.BeurteilTxt AS "JBer Beurteilung", alexande_apflora.tblJBer.JBerVeraenGegenVorjahr AS "JBer Veraend zum Vorjahr", alexande_apflora.tblJBer.JBerAnalyse AS "JBer Analyse", alexande_apflora.tblJBer.JBerUmsetzung AS "JBer Konsequenzen Umsetzung", alexande_apflora.tblJBer.JBerErfko AS "JBer Konsequenzen Erfolgskontrolle", alexande_apflora.tblJBer.JBerATxt AS "JBer Bemerkungen zu A", alexande_apflora.tblJBer.JBerBTxt AS "JBer Bemerkungen zu B", alexande_apflora.tblJBer.JBerCTxt AS "JBer Bemerkungen zu C", alexande_apflora.tblJBer.JBerDTxt AS "JBer Bemerkungen zu D", alexande_apflora.tblJBer.JBerDatum AS "JBer Datum", alexande_apflora.tblAdresse.AdrName AS "JBer BearbeiterIn", alexande_apflora.tblJBer.MutWann AS "JBer MutWann", alexande_apflora.tblJBer.MutWer AS "JBer MutWer"
FROM ((alexande_apflora.tblAp RIGHT JOIN alexande_apflora.tblJBer ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblJBer.ApArtId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblJBer.JBerBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.domApErfKrit ON alexande_apflora.tblJBer.JBerBeurteilung = domApErfKrit.BeurteilId
WHERE alexande_apflora.tblAp.ApArtId Is Null
ORDER BY alexande_apflora.tblJBer.ApArtId, alexande_apflora.tblJBer.JBerJahr, alexande_apflora.tblJBer.JBerDatum;

CREATE OR REPLACE VIEW vBerJbArtD AS 
SELECT alexande_apflora.tblAp.*, alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.tblJBer.JBerId, alexande_apflora.tblJBer.JBerJahr, alexande_apflora.tblJBer.JBerSituation, alexande_apflora.tblJBer.JBerVergleichVorjahrGesamtziel, alexande_apflora.tblJBer.JBerBeurteilung, alexande_apflora.tblJBer.JBerAnalyse, alexande_apflora.tblJBer.JBerUmsetzung, alexande_apflora.tblJBer.JBerErfko, alexande_apflora.tblJBer.JBerATxt, alexande_apflora.tblJBer.JBerBTxt, alexande_apflora.tblJBer.JBerCTxt, alexande_apflora.tblJBer.JBerDTxt, alexande_apflora.tblJBer.JBerDatum, alexande_apflora.tblJBer.JBerBearb, alexande_apflora.tblAdresse.AdrName AS Bearbeiter, domApErfKrit.BeurteilTxt
FROM (alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId=alexande_apflora.tblAp.ApArtId) INNER JOIN (((alexande_apflora.tblJBer LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblJBer.JBerBearb=alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.domApErfKrit ON alexande_apflora.tblJBer.JBerBeurteilung=alexande_apflora.domApErfKrit.BeurteilId) INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblJBer.JBerJahr=alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblAp.ApArtId=alexande_apflora.tblJBer.ApArtId;

CREATE OR REPLACE VIEW vFnsKef AS 
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId, IF(alexande_beob.ArtenDb_Arteigenschaften.KefArt="-1","Ja","") AS FnsKefArt2, IF(Round((alexande_apflora.tblKonstanten.JBerJahr- alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,0)=(alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,"Ja","") AS FnsKefKontrJahr2
FROM alexande_beob.ArtenDb_Arteigenschaften, alexande_apflora.tblKonstanten
ORDER BY  alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId;

CREATE OR REPLACE VIEW vPopMassnSeitBeginnAp AS 
SELECT alexande_apflora.tblTPopMassn.TPopId
FROM alexande_apflora.tblAp INNER JOIN ((alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN alexande_apflora.tblTPopMassn ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopMassn.TPopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId
WHERE (((alexande_apflora.tblTPopMassn.TPopMassnJahr)>=alexande_apflora.tblAp.ApJahr))
GROUP BY alexande_apflora.tblTPopMassn.TPopId;

CREATE OR REPLACE VIEW vApAnzMassnProJahr0 AS 
SELECT alexande_apflora.tblAp.ApArtId, alexande_apflora.tblTPopMassn.TPopMassnJahr, Count(alexande_apflora.tblTPopMassn.TPopMassnId) AS AnzahlvonTPopMassnId
FROM alexande_apflora.tblAp INNER JOIN ((alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN alexande_apflora.tblTPopMassn ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopMassn.TPopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId
WHERE (alexande_apflora.tblAp.ApStatus Between 1 And 3) AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblAp.ApArtId, alexande_apflora.tblTPopMassn.TPopMassnJahr
HAVING alexande_apflora.tblTPopMassn.TPopMassnJahr Is Not Null
ORDER BY alexande_apflora.tblAp.ApArtId, alexande_apflora.tblTPopMassn.TPopMassnJahr;

CREATE OR REPLACE VIEW vMassnJahre AS
SELECT alexande_apflora.tblTPopMassn.TPopMassnJahr 
FROM alexande_apflora.tblTPopMassn 
GROUP BY alexande_apflora.tblTPopMassn.TPopMassnJahr 
HAVING alexande_apflora.tblTPopMassn.TPopMassnJahr Between 1900 And 2100 ORDER BY alexande_apflora.tblTPopMassn.TPopMassnJahr;

CREATE OR REPLACE VIEW vApMassnJahre AS
SELECT alexande_apflora.tblAp.ApArtId, alexande_apflora_views.vMassnJahre.TPopMassnJahr 
FROM alexande_apflora.tblAp, alexande_apflora_views.vMassnJahre 
WHERE alexande_apflora.tblAp.ApArtId>0 AND alexande_apflora.tblAp.ApStatus Between 1 And 3 
ORDER BY alexande_apflora.tblAp.ApArtId, alexande_apflora_views.vMassnJahre.TPopMassnJahr;

CREATE OR REPLACE VIEW vApAnzMassnProJahr AS 
SELECT alexande_apflora_views.vApMassnJahre.ApArtId, alexande_apflora_views.vApMassnJahre.TPopMassnJahr, IF(alexande_apflora_views.vApAnzMassnProJahr0.AnzahlvonTPopMassnId Is Not Null, alexande_apflora_views.vApAnzMassnProJahr0.AnzahlvonTPopMassnId,0) AS "AnzahlMassnahmen" 
FROM alexande_apflora_views.vApMassnJahre LEFT JOIN alexande_apflora_views.vApAnzMassnProJahr0 ON (alexande_apflora_views.vApMassnJahre.TPopMassnJahr = alexande_apflora_views.vApAnzMassnProJahr0.TPopMassnJahr) AND (alexande_apflora_views.vApMassnJahre.ApArtId = alexande_apflora_views.vApAnzMassnProJahr0.ApArtId) 
ORDER BY alexande_apflora_views.vApMassnJahre.ApArtId, alexande_apflora_views.vApMassnJahre.TPopMassnJahr;

CREATE OR REPLACE VIEW vApAnzMassnBisJahr AS
SELECT alexande_apflora_views.vApMassnJahre.ApArtId, alexande_apflora_views.vApMassnJahre.TPopMassnJahr, Sum(alexande_apflora_views.vApAnzMassnProJahr.AnzahlMassnahmen) AS "AnzahlMassnahmen" 
FROM alexande_apflora_views.vApMassnJahre INNER JOIN alexande_apflora_views.vApAnzMassnProJahr ON alexande_apflora_views.vApMassnJahre.ApArtId = alexande_apflora_views.vApAnzMassnProJahr.ApArtId 
WHERE alexande_apflora_views.vApAnzMassnProJahr.TPopMassnJahr<=alexande_apflora_views.vApMassnJahre.TPopMassnJahr 
GROUP BY alexande_apflora_views.vApMassnJahre.ApArtId, alexande_apflora_views.vApMassnJahre.TPopMassnJahr 
ORDER BY alexande_apflora_views.vApMassnJahre.ApArtId, alexande_apflora_views.vApMassnJahre.TPopMassnJahr;

CREATE OR REPLACE VIEW vApJahresberichte AS 
select alexande_apflora.tblAp.ApArtId AS ApArtId, alexande_apflora.tblJBer.JBerId AS JBerId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS Name, alexande_apflora.tblJBer.JBerJahr AS JBerJahr, alexande_apflora.tblJBer.JBerSituation AS JBerSituation, alexande_apflora.tblJBer.JBerVergleichVorjahrGesamtziel AS JBerVergleichVorjahrGesamtziel, domApErfKrit.BeurteilTxt AS JBerBeurteilung, alexande_apflora.tblJBer.JBerVeraenGegenVorjahr AS JBerVeraenGegenVorjahr, alexande_apflora.tblJBer.JBerAnalyse AS JBerAnalyse, alexande_apflora.tblJBer.JBerUmsetzung AS JBerUmsetzung, alexande_apflora.tblJBer.JBerErfko AS JBerErfko, alexande_apflora.tblJBer.JBerATxt AS JBerATxt, alexande_apflora.tblJBer.JBerBTxt AS JBerBTxt, alexande_apflora.tblJBer.JBerCTxt AS JBerCTxt, alexande_apflora.tblJBer.JBerDTxt AS JBerDTxt, alexande_apflora.tblJBer.JBerDatum AS JBerDatum,alexande_apflora.tblAdresse.AdrName AS JBerBearb 
FROM alexande_apflora.tblAp INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON (alexande_apflora.tblAp.ApArtId=alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId) JOIN ((alexande_apflora.tblJBer LEFT JOIN alexande_apflora.domApErfKrit ON (alexande_apflora.tblJBer.JBerBeurteilung=domApErfKrit.BeurteilId)) LEFT JOIN alexande_apflora.tblAdresse ON (alexande_apflora.tblJBer.JBerBearb=alexande_apflora.tblAdresse.AdrId)) ON alexande_apflora.tblAp.ApArtId=alexande_apflora.tblJBer.ApArtId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vApJahresberichteUndMassnahmen AS
SELECT alexande_apflora.tblAp.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblAdresse.AdrName AS "AP Verantwortlich", alexande_apflora.tblAp.ApArtwert AS Artwert, alexande_apflora_views.vApAnzMassnProJahr.TPopMassnJahr AS Jahr, alexande_apflora_views.vApAnzMassnProJahr.AnzahlMassnahmen AS "Anzahl Massnahmen", alexande_apflora_views.vApAnzMassnBisJahr.AnzahlMassnahmen AS "Anzahl Massnahmen bisher", IF(alexande_apflora.tblJBer.JBerJahr>0,"Ja","Nein") AS "Bericht erstellt"
FROM ((((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAp.ApBearb = alexande_apflora.tblAdresse.AdrId) INNER JOIN alexande_apflora_views.vApAnzMassnProJahr ON alexande_apflora.tblAp.ApArtId = alexande_apflora_views.vApAnzMassnProJahr.ApArtId) INNER JOIN alexande_apflora_views.vApAnzMassnBisJahr ON (alexande_apflora_views.vApAnzMassnProJahr.TPopMassnJahr = alexande_apflora_views.vApAnzMassnBisJahr.TPopMassnJahr) AND (alexande_apflora_views.vApAnzMassnProJahr.ApArtId = alexande_apflora_views.vApAnzMassnBisJahr.ApArtId)) LEFT JOIN alexande_apflora.tblJBer ON (alexande_apflora_views.vApAnzMassnBisJahr.TPopMassnJahr = alexande_apflora.tblJBer.JBerJahr) AND (alexande_apflora_views.vApAnzMassnBisJahr.ApArtId = alexande_apflora.tblJBer.ApArtId)
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora_views.vApAnzMassnProJahr.TPopMassnJahr;

CREATE OR REPLACE VIEW vLetzterTPopMassnBericht0 AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId, alexande_apflora.tblTPopMassnBer.TPopMassnBerJahr
FROM alexande_apflora.tblKonstanten, ((alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN alexande_apflora.tblTPopMassnBer ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopMassnBer.TPopId) INNER JOIN alexande_apflora.tblTPopMassn ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopMassn.TPopId
WHERE alexande_apflora.tblTPopMassnBer.TPopMassnBerJahr<=alexande_apflora.tblKonstanten.JBerJahr AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblTPopMassn.TPopMassnJahr<=alexande_apflora.tblKonstanten.JBerJahr AND alexande_apflora.tblPop.PopHerkunft <> 300;

CREATE OR REPLACE VIEW vLetzterTPopMassnBericht AS
SELECT alexande_apflora_views.vLetzterTPopMassnBericht0.ApArtId, alexande_apflora_views.vLetzterTPopMassnBericht0.TPopId, Max(alexande_apflora_views.vLetzterTPopMassnBericht0.TPopMassnBerJahr) AS MaxvonTPopMassnBerJahr
FROM alexande_apflora_views.vLetzterTPopMassnBericht0
GROUP BY alexande_apflora_views.vLetzterTPopMassnBericht0.ApArtId, alexande_apflora_views.vLetzterTPopMassnBericht0.TPopId;

CREATE OR REPLACE VIEW vLetzterTPopBericht0 AS
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId, alexande_apflora.tblTPopBer.TPopBerJahr
FROM alexande_apflora.tblKonstanten, alexande_apflora.tblAp INNER JOIN (alexande_apflora.tblPop INNER JOIN (alexande_apflora.tblTPop INNER JOIN alexande_apflora.tblTPopBer ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopBer.TPopId) ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId
WHERE alexande_apflora.tblTPopBer.TPopBerJahr<=alexande_apflora.tblKonstanten.JBerJahr And alexande_apflora.tblTPopBer.TPopBerJahr>=alexande_apflora.tblAp.ApJahr AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300;

CREATE OR REPLACE VIEW vLetzterTPopBericht AS 
SELECT alexande_apflora_views.vLetzterTPopBericht0.ApArtId, alexande_apflora_views.vLetzterTPopBericht0.TPopId, Max(alexande_apflora_views.vLetzterTPopBericht0.TPopBerJahr) AS MaxvonTPopBerJahr
FROM alexande_apflora_views.vLetzterTPopBericht0
GROUP BY alexande_apflora_views.vLetzterTPopBericht0.ApArtId, alexande_apflora_views.vLetzterTPopBericht0.TPopId;

CREATE OR REPLACE VIEW vLetzterPopMassnBericht0 AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId, alexande_apflora.tblPopMassnBer.PopMassnBerJahr
FROM alexande_apflora.tblKonstanten, ((alexande_apflora.tblPop INNER JOIN alexande_apflora.tblPopMassnBer ON alexande_apflora.tblPop.PopId = alexande_apflora.tblPopMassnBer.PopId) INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN alexande_apflora.tblTPopMassn ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopMassn.TPopId
WHERE alexande_apflora.tblPopMassnBer.PopMassnBerJahr<=alexande_apflora.tblKonstanten.JBerJahr AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblTPopMassn.TPopMassnJahr<=alexande_apflora.tblKonstanten.JBerJahr AND alexande_apflora.tblPop.PopHerkunft <> 300;

CREATE OR REPLACE VIEW vLetzterPopMassnBericht AS 
SELECT alexande_apflora_views.vLetzterPopMassnBericht0.ApArtId, alexande_apflora_views.vLetzterPopMassnBericht0.PopId, Max(alexande_apflora_views.vLetzterPopMassnBericht0.PopMassnBerJahr) AS MaxvonPopMassnBerJahr
FROM alexande_apflora_views.vLetzterPopMassnBericht0
GROUP BY alexande_apflora_views.vLetzterPopMassnBericht0.ApArtId, alexande_apflora_views.vLetzterPopMassnBericht0.PopId;

CREATE OR REPLACE VIEW vLetzterPopBericht0 AS
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId, alexande_apflora.tblPopBer.PopBerJahr
FROM alexande_apflora.tblKonstanten, (alexande_apflora.tblPop INNER JOIN alexande_apflora.tblPopBer ON alexande_apflora.tblPop.PopId = alexande_apflora.tblPopBer.PopId) INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblPopBer.PopBerJahr<=alexande_apflora.tblKonstanten.JBerJahr AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300;

CREATE OR REPLACE VIEW vLetzterPopBericht AS
SELECT alexande_apflora_views.vLetzterPopBericht0.ApArtId, alexande_apflora_views.vLetzterPopBericht0.PopId, Max(alexande_apflora_views.vLetzterPopBericht0.PopBerJahr) AS MaxvonPopBerJahr
FROM alexande_apflora_views.vLetzterPopBericht0
GROUP BY alexande_apflora_views.vLetzterPopBericht0.ApArtId, alexande_apflora_views.vLetzterPopBericht0.PopId;

CREATE OR REPLACE VIEW vJbUebE AS 
SELECT alexande_apflora.tblJBer.*, alexande_beob.ArtenDb_Arteigenschaften.Artname, IF(alexande_beob.ArtenDb_Arteigenschaften.KefArt=-1,"Ja","") AS FnsKefArt2, alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr, IF(Round((alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,0)=(alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,"Ja","") AS FnsKefKontrJahr2, alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr AS FnsJahrespflanze, IF(alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr=alexande_apflora.tblKonstanten.JBerJahr,"Ja","") AS FnsJahrespflanze2, alexande_apflora_views.vApAnzMassnBisJahr.AnzahlMassnahmen
FROM alexande_apflora.tblKonstanten AS tblKonstanten_1 INNER JOIN ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN (alexande_apflora.tblAp INNER JOIN alexande_apflora_views.vApApBerichtRelevant ON alexande_apflora.tblAp.ApArtId = alexande_apflora_views.vApApBerichtRelevant.ApArtId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN (alexande_apflora.tblKonstanten INNER JOIN (alexande_apflora.tblJBer INNER JOIN alexande_apflora_views.vApAnzMassnBisJahr ON alexande_apflora.tblJBer.ApArtId = alexande_apflora_views.vApAnzMassnBisJahr.ApArtId) ON alexande_apflora.tblKonstanten.JBerJahr = alexande_apflora.tblJBer.JBerJahr) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblJBer.ApArtId) ON tblKonstanten_1.JBerJahr = alexande_apflora_views.vApAnzMassnBisJahr.TPopMassnJahr 
WHERE alexande_apflora_views.vApAnzMassnBisJahr.AnzahlMassnahmen>0 AND alexande_apflora.tblJBer.JBerBeurteilung=1 AND alexande_apflora.tblAp.ApStatus Between 1 And 3
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vJbUebKm AS 
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname, IF(alexande_beob.ArtenDb_Arteigenschaften.KefArt=-1,"Ja","") AS FnsKefArt2, IF(Round((alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,0)=(alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,"Ja","") AS FnsKefKontrJahr2, alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr AS FnsJahrespflanze, IF(alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr=alexande_apflora.tblKonstanten.JBerJahr,"Ja","") AS FnsJahrespflanze2
FROM (alexande_beob.ArtenDb_Arteigenschaften INNER JOIN ((alexande_apflora_views.vApAnzMassnBisJahr AS vApAnzMassnBisJahr_1 INNER JOIN alexande_apflora.tblAp ON vApAnzMassnBisJahr_1.ApArtId = alexande_apflora.tblAp.ApArtId) INNER JOIN alexande_apflora_views.vApApBerichtRelevant ON alexande_apflora.tblAp.ApArtId = alexande_apflora_views.vApApBerichtRelevant.ApArtId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN (alexande_apflora.tblJBer INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblJBer.JBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON (alexande_apflora.tblKonstanten.JBerJahr = vApAnzMassnBisJahr_1.TPopMassnJahr) AND (alexande_apflora.tblAp.ApArtId = alexande_apflora.tblJBer.ApArtId)
WHERE alexande_apflora.tblAp.ApStatus Between 1 And 3 AND vApAnzMassnBisJahr_1.AnzahlMassnahmen="0"
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vJbUebMa AS 
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora_views.vApAnzMassnBisJahr.AnzahlMassnahmen
FROM alexande_apflora.tblKonstanten INNER JOIN ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN (alexande_apflora.tblAp INNER JOIN alexande_apflora_views.vApApBerichtRelevant ON alexande_apflora.tblAp.ApArtId = alexande_apflora_views.vApApBerichtRelevant.ApArtId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN alexande_apflora_views.vApAnzMassnBisJahr ON alexande_apflora.tblAp.ApArtId = alexande_apflora_views.vApAnzMassnBisJahr.ApArtId) ON alexande_apflora.tblKonstanten.JBerJahr = alexande_apflora_views.vApAnzMassnBisJahr.TPopMassnJahr
WHERE alexande_apflora_views.vApAnzMassnBisJahr.AnzahlMassnahmen>0 AND alexande_apflora.tblAp.ApStatus Between 1 And 3
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vJbUebMe AS
SELECT alexande_apflora.tblJBer.*, alexande_beob.ArtenDb_Arteigenschaften.Artname, IF("KefArt"=-1,"Ja","") AS FnsKefArt2, IF(Round((alexande_apflora.tblKonstanten.JBerJahr-"KefKontrolljahr")/4,0)=(alexande_apflora.tblKonstanten.JBerJahr-"KefKontrolljahr")/4,"Ja","") AS FnsKefKontrJahr2, alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr AS FnsJahrespflanze, IF(alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr=alexande_apflora.tblKonstanten.JBerJahr,"Ja","") AS FnsJahrespflanze2
FROM alexande_apflora.tblKonstanten AS tblKonstanten_1 INNER JOIN ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN (alexande_apflora.tblAp INNER JOIN alexande_apflora_views.vApApBerichtRelevant ON alexande_apflora.tblAp.ApArtId = alexande_apflora_views.vApApBerichtRelevant.ApArtId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN ((alexande_apflora.tblJBer INNER JOIN alexande_apflora_views.vApAnzMassnBisJahr ON alexande_apflora.tblJBer.ApArtId = alexande_apflora_views.vApAnzMassnBisJahr.ApArtId) INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblJBer.JBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblJBer.ApArtId) ON tblKonstanten_1.JBerJahr = alexande_apflora_views.vApAnzMassnBisJahr.TPopMassnJahr
WHERE alexande_apflora.tblJBer.JBerBeurteilung=5 AND alexande_apflora_views.vApAnzMassnBisJahr.AnzahlMassnahmen>0 AND alexande_apflora.tblAp.ApStatus Between 1 And 3
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vJbUebNe AS
SELECT alexande_apflora.tblJBer.*, alexande_beob.ArtenDb_Arteigenschaften.Artname, IF(alexande_beob.ArtenDb_Arteigenschaften.KefArt=-1,"Ja","") AS FnsKefArt2, IF(Round((alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,0)=(alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,"Ja","") AS FnsKefKontrJahr2, alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr AS FnsJahrespflanze, IF(alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr=alexande_apflora.tblKonstanten.JBerJahr,"Ja","") AS FnsJahrespflanze2
FROM alexande_apflora.tblKonstanten AS tblKonstanten_1 INNER JOIN ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN (alexande_apflora.tblAp INNER JOIN alexande_apflora_views.vApApBerichtRelevant ON alexande_apflora.tblAp.ApArtId = alexande_apflora_views.vApApBerichtRelevant.ApArtId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN ((alexande_apflora.tblJBer INNER JOIN alexande_apflora_views.vApAnzMassnBisJahr ON alexande_apflora.tblJBer.ApArtId = alexande_apflora_views.vApAnzMassnBisJahr.ApArtId) INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblJBer.JBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblJBer.ApArtId) ON tblKonstanten_1.JBerJahr = alexande_apflora_views.vApAnzMassnBisJahr.TPopMassnJahr
WHERE alexande_apflora.tblJBer.JBerBeurteilung=3 AND alexande_apflora.tblAp.ApStatus Between 1 And 3 AND alexande_apflora_views.vApAnzMassnBisJahr.AnzahlMassnahmen>0
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vJbUebSe AS 
SELECT alexande_apflora.tblJBer.*, alexande_beob.ArtenDb_Arteigenschaften.Artname, IF(alexande_beob.ArtenDb_Arteigenschaften.KefArt=-1,"Ja","") AS FnsKefArt2, IF(Round((alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,0)=(alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,"Ja","") AS FnsKefKontrJahr2, alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr AS FnsJahrespflanze, IF(alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr=alexande_apflora.tblKonstanten.JBerJahr,"Ja","") AS FnsJahrespflanze2
FROM alexande_apflora.tblKonstanten AS tblKonstanten_1 INNER JOIN ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN (alexande_apflora.tblAp INNER JOIN alexande_apflora_views.vApApBerichtRelevant ON alexande_apflora.tblAp.ApArtId = alexande_apflora_views.vApApBerichtRelevant.ApArtId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN ((alexande_apflora.tblJBer INNER JOIN alexande_apflora_views.vApAnzMassnBisJahr ON alexande_apflora.tblJBer.ApArtId = alexande_apflora_views.vApAnzMassnBisJahr.ApArtId) INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblJBer.JBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblJBer.ApArtId) ON tblKonstanten_1.JBerJahr = alexande_apflora_views.vApAnzMassnBisJahr.TPopMassnJahr
WHERE alexande_apflora.tblJBer.JBerBeurteilung=4 AND alexande_apflora_views.vApAnzMassnBisJahr.AnzahlMassnahmen>0 AND alexande_apflora.tblAp.ApStatus Between 1 And 3
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vJbUebUn AS
SELECT alexande_apflora.tblJBer.*, alexande_beob.ArtenDb_Arteigenschaften.Artname, IF(alexande_beob.ArtenDb_Arteigenschaften.KefArt=-1,"Ja","") AS FnsKefArt2, IF(Round((alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,0)=(alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,"Ja","") AS FnsKefKontrJahr2, alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr AS FnsJahrespflanze, IF(alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr=alexande_apflora.tblKonstanten.JBerJahr,"Ja","") AS FnsJahrespflanze2
FROM alexande_apflora.tblKonstanten AS tblKonstanten_1 INNER JOIN ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN (alexande_apflora.tblAp INNER JOIN alexande_apflora_views.vApApBerichtRelevant ON alexande_apflora.tblAp.ApArtId = alexande_apflora_views.vApApBerichtRelevant.ApArtId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN ((alexande_apflora.tblJBer INNER JOIN alexande_apflora_views.vApAnzMassnBisJahr ON alexande_apflora.tblJBer.ApArtId = alexande_apflora_views.vApAnzMassnBisJahr.ApArtId) INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblJBer.JBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblJBer.ApArtId) ON tblKonstanten_1.JBerJahr = alexande_apflora_views.vApAnzMassnBisJahr.TPopMassnJahr
WHERE alexande_apflora.tblJBer.JBerBeurteilung=1168274204 AND alexande_apflora_views.vApAnzMassnBisJahr.AnzahlMassnahmen>0 AND alexande_apflora.tblAp.ApStatus Between 1 And 3
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vJbUebWe AS 
SELECT alexande_apflora.tblJBer.*, alexande_beob.ArtenDb_Arteigenschaften.Artname, IF(alexande_beob.ArtenDb_Arteigenschaften.KefArt=-1,"Ja","") AS FnsKefArt2, IF(Round((alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,0)=(alexande_apflora.tblKonstanten.JBerJahr-alexande_beob.ArtenDb_Arteigenschaften.KefKontrolljahr)/4,"Ja","") AS FnsKefKontrJahr2, alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr AS FnsJahrespflanze, IF(alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr=alexande_apflora.tblKonstanten.JBerJahr,"Ja","") AS FnsJahrespflanze2
FROM alexande_apflora.tblKonstanten AS tblKonstanten_1 INNER JOIN ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN (alexande_apflora.tblAp INNER JOIN alexande_apflora_views.vApApBerichtRelevant ON alexande_apflora.tblAp.ApArtId = alexande_apflora_views.vApApBerichtRelevant.ApArtId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN ((alexande_apflora.tblJBer INNER JOIN alexande_apflora_views.vApAnzMassnBisJahr ON alexande_apflora.tblJBer.ApArtId = alexande_apflora_views.vApAnzMassnBisJahr.ApArtId) INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblJBer.JBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblJBer.ApArtId) ON tblKonstanten_1.JBerJahr = alexande_apflora_views.vApAnzMassnBisJahr.TPopMassnJahr
WHERE alexande_apflora.tblJBer.JBerBeurteilung=6 AND alexande_apflora_views.vApAnzMassnBisJahr.AnzahlMassnahmen>0 AND alexande_apflora.tblAp.ApStatus Between 1 And 3
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vJbUebNichtBeurteilt000 AS 
SELECT alexande_apflora.tblAp.ApArtId, alexande_apflora.tblJBer.JBerJahr
FROM (((alexande_apflora.tblAp INNER JOIN alexande_apflora_views.vApAnzMassnBisJahr ON alexande_apflora.tblAp.ApArtId = alexande_apflora_views.vApAnzMassnBisJahr.ApArtId) INNER JOIN alexande_apflora_views.vApApBerichtRelevant ON alexande_apflora.tblAp.ApArtId = alexande_apflora_views.vApApBerichtRelevant.ApArtId) LEFT JOIN alexande_apflora.tblJBer ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblJBer.ApArtId) INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora_views.vApAnzMassnBisJahr.TPopMassnJahr = alexande_apflora.tblKonstanten.JBerJahr
WHERE alexande_apflora.tblJBer.ApArtId Is Null AND alexande_apflora.tblAp.ApStatus Between 1 And 3;

CREATE OR REPLACE VIEW vJbUebNichtBeurteilt00 AS 
SELECT alexande_apflora.tblAp.ApArtId, alexande_apflora.tblJBer.JBerJahr
FROM alexande_apflora.tblKonstanten AS tblKonstanten_1 INNER JOIN (((alexande_apflora.tblAp INNER JOIN alexande_apflora_views.vApAnzMassnBisJahr ON alexande_apflora.tblAp.ApArtId = alexande_apflora_views.vApAnzMassnBisJahr.ApArtId) INNER JOIN alexande_apflora_views.vApApBerichtRelevant ON alexande_apflora.tblAp.ApArtId = alexande_apflora_views.vApApBerichtRelevant.ApArtId) INNER JOIN (alexande_apflora.tblJBer INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblJBer.JBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblJBer.ApArtId) ON tblKonstanten_1.JBerJahr = alexande_apflora_views.vApAnzMassnBisJahr.TPopMassnJahr
WHERE alexande_apflora.tblAp.ApStatus Between 1 And 3 AND alexande_apflora.tblJBer.JBerBeurteilung Is Null;

CREATE OR REPLACE VIEW vJbUebNichtBeurteilt0 AS 
select ApArtId, JBerJahr from alexande_apflora_views.vJbUebNichtBeurteilt000
UNION select ApArtId, JBerJahr from alexande_apflora_views.vJbUebNichtBeurteilt00;

CREATE OR REPLACE VIEW vJbUebNichtBeurteilt AS 
SELECT alexande_apflora.tblAp.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora_views.vFnsKef.FnsKefArt2, alexande_apflora_views.vFnsKef.FnsKefKontrJahr2, alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr AS FnsJahrespflanze, IF(alexande_beob.ArtenDb_Arteigenschaften.FnsJahresartJahr=alexande_apflora_views.vJbUebNichtBeurteilt0.JBerJahr,"Ja","") AS FnsJahrespflanze2
FROM ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) LEFT JOIN alexande_apflora_views.vFnsKef ON alexande_apflora.tblAp.ApArtId = alexande_apflora_views.vFnsKef.TaxonomieId) INNER JOIN alexande_apflora_views.vJbUebNichtBeurteilt0 ON alexande_apflora.tblAp.ApArtId = alexande_apflora_views.vJbUebNichtBeurteilt0.ApArtId
WHERE alexande_apflora.tblAp.ApStatus Between 1 And 3
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vJbUeT01 AS 
SELECT alexande_apflora.tblAp.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname
FROM ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN (alexande_apflora.tblAp INNER JOIN alexande_apflora_views.vApApBerichtRelevant ON alexande_apflora.tblAp.ApArtId = alexande_apflora_views.vApApBerichtRelevant.ApArtId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN alexande_apflora_views.vApAnzMassnBisJahr ON alexande_apflora.tblAp.ApArtId = alexande_apflora_views.vApAnzMassnBisJahr.ApArtId) INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora_views.vApAnzMassnBisJahr.TPopMassnJahr = alexande_apflora.tblKonstanten.JBerJahr
WHERE alexande_apflora.tblAp.ApStatus Between 1 And 3 AND alexande_apflora_views.vApAnzMassnBisJahr.AnzahlMassnahmen>"0"
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vKontrApArtTPopOhneStatus AS 
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.domApBearbeitungsstand.DomainTxt AS "Bearbeitungsstand AP", alexande_apflora.tblPop.PopNr, alexande_apflora.tblPop.PopName, domPopHerkunft.HerkunftTxt AS "Status Population", alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPop.TPopFlurname, alexande_apflora.tblTPop.TPopHerkunft AS "Status Teilpopulation"
FROM (alexande_apflora.domApBearbeitungsstand INNER JOIN (alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) ON alexande_apflora.domApBearbeitungsstand.DomainCode = alexande_apflora.tblAp.ApStatus) INNER JOIN ((alexande_apflora.tblPop INNER JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId
WHERE alexande_apflora.tblTPop.TPopHerkunft Is Null AND alexande_apflora.tblAp.ApStatus=3
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr;

CREATE OR REPLACE VIEW vTPopOhneBekanntSeit AS 
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.domApBearbeitungsstand.DomainTxt AS ApStatus_, alexande_apflora.tblPop.PopNr, alexande_apflora.tblPop.PopName, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPop.TPopGemeinde, alexande_apflora.tblTPop.TPopFlurname, alexande_apflora.tblTPop.TPopBekanntSeit
FROM ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) INNER JOIN (alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId
WHERE alexande_apflora.tblTPop.TPopBekanntSeit Is Null AND alexande_apflora.tblAp.ApStatus Between 1 And 3
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblPop.PopName, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPop.TPopGemeinde, alexande_apflora.tblTPop.TPopFlurname;

CREATE OR REPLACE VIEW vKontrTPopKoorLeer AS 
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.domApBearbeitungsstand.DomainTxt AS ApStatus_, alexande_apflora.tblPop.PopNr, alexande_apflora.tblPop.PopName, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPop.TPopGemeinde, alexande_apflora.tblTPop.TPopFlurname, alexande_apflora.tblTPop.TPopXKoord, alexande_apflora.tblTPop.TPopYKoord
FROM ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) INNER JOIN (alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId
WHERE (alexande_apflora.tblTPop.TPopXKoord Is Null AND alexande_apflora.tblAp.ApStatus Between 1 And 3) OR (alexande_apflora.tblTPop.TPopYKoord Is Null AND alexande_apflora.tblAp.ApStatus Between 1 And 3)
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblPop.PopName, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPop.TPopGemeinde, alexande_apflora.tblTPop.TPopFlurname;

CREATE OR REPLACE VIEW vTPopBerLetzterBericht AS 
SELECT alexande_apflora.tblTPopBer.TPopId, Max(alexande_apflora.tblTPopBer.TPopBerJahr) AS MaxvonTPopBerJahr
FROM alexande_apflora.tblTPopBer
GROUP BY alexande_apflora.tblTPopBer.TPopId;

CREATE OR REPLACE VIEW vKontrTPopStatusErloschen AS 
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.domApBearbeitungsstand.DomainTxt AS "Bearbeitungsstand AP", alexande_apflora.tblPop.PopNr, alexande_apflora.tblPop.PopName, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPop.TPopGemeinde, alexande_apflora.tblTPop.TPopFlurname, alexande_apflora.tblTPop.TPopHerkunft, alexande_apflora.tblTPopBer.TPopBerEntwicklung, alexande_apflora.tblTPopBer.TPopBerJahr
FROM ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN (alexande_apflora.tblPop INNER JOIN (alexande_apflora.tblTPop INNER JOIN (alexande_apflora.tblTPopBer INNER JOIN alexande_apflora_views.vTPopBerLetzterBericht ON (alexande_apflora.tblTPopBer.TPopId = alexande_apflora_views.vTPopBerLetzterBericht.TPopId) AND (alexande_apflora.tblTPopBer.TPopBerJahr = alexande_apflora_views.vTPopBerLetzterBericht.MaxvonTPopBerJahr)) ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopBer.TPopId) ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode
WHERE ((alexande_apflora.tblAp.ApStatus Between 1 And 3) AND (alexande_apflora.tblTPop.TPopHerkunft=101 Or alexande_apflora.tblTPop.TPopHerkunft=202) AND (alexande_apflora.tblTPopBer.TPopBerEntwicklung<>8)) OR ((alexande_apflora.tblAp.ApStatus Between 1 And 3) AND (alexande_apflora.tblTPop.TPopHerkunft Not Like 101 And alexande_apflora.tblTPop.TPopHerkunft Not Like 202) AND (alexande_apflora.tblTPopBer.TPopBerEntwicklung=8))
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblPop.PopName, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPop.TPopGemeinde, alexande_apflora.tblTPop.TPopFlurname;

#im Gebrauch (Access):
CREATE OR REPLACE VIEW vBerJb AS 
SELECT alexande_apflora.tblAp.*, alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.tblJBer.JBerId, alexande_apflora.tblJBer.JBerJahr, alexande_apflora.tblJBer.JBerSituation, alexande_apflora.tblJBer.JBerVergleichVorjahrGesamtziel, alexande_apflora.tblJBer.JBerBeurteilung, alexande_apflora.tblJBer.JBerAnalyse, alexande_apflora.tblJBer.JBerUmsetzung, alexande_apflora.tblJBer.JBerErfko, alexande_apflora.tblJBer.JBerATxt, alexande_apflora.tblJBer.JBerBTxt, alexande_apflora.tblJBer.JBerCTxt, alexande_apflora.tblJBer.JBerDTxt, alexande_apflora.tblJBer.JBerDatum, alexande_apflora.tblJBer.JBerBearb, alexande_apflora.tblAdresse.AdrName & ", " & alexande_apflora.tblAdresse.AdrAdresse AS Bearbeiter, alexande_apflora.tblJBerUebersicht.JbuJahr, alexande_apflora.tblJBerUebersicht.JbuBemerkungen, alexande_apflora_views.vErsteMassnahmeProArt.MinvonTPopMassnJahr AS ErsteMassnahmeImJahr
FROM (alexande_beob.ArtenDb_Arteigenschaften INNER JOIN (alexande_apflora.tblAp LEFT JOIN alexande_apflora_views.vErsteMassnahmeProArt ON alexande_apflora.tblAp.ApArtId=alexande_apflora_views.vErsteMassnahmeProArt.ApArtId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId=alexande_apflora.tblAp.ApArtId) INNER JOIN (((alexande_apflora.tblJBer LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblJBer.JBerBearb=alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.tblJBerUebersicht ON alexande_apflora.tblJBer.JBerJahr=alexande_apflora.tblJBerUebersicht.JbuJahr) INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblJBer.JBerJahr=alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblAp.ApArtId=alexande_apflora.tblJBer.ApArtId
WHERE alexande_apflora.tblAp.ApStatus Between 1 And 3
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vAuswAp AS 
SELECT alexande_apflora.tblAp.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.domApBearbeitungsstand.DomainTxt AS "Bearbeitungsstand AP", alexande_apflora.tblAp.ApJahr AS "Start AP im Jahr", domApUmsetzung.DomainTxt AS "Stand Umsetzung AP", alexande_apflora.tblAdresse.AdrName AS "Verantwortlich", alexande_apflora.tblAp.MutWann AS "Letzte Änderung", alexande_apflora.tblAp.MutWer AS "Letzte(r) Bearbeiter(in)"
FROM (((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAp.ApBearb = alexande_apflora.tblAdresse.AdrId
WHERE (((alexande_apflora.tblAp.ApStatus) Between 1 And 3))
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vProgramme AS 
SELECT alexande_apflora.tblAp.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Bearbeitungsstand", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblAdresse.AdrName AS "AP verantwortlich", alexande_apflora.tblAp.MutWann AS "AP Letzte Änderung", alexande_apflora.tblAp.MutWer AS "AP Letzte(r) Bearbeiter(in)"
FROM (((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAp.ApBearb = alexande_apflora.tblAdresse.AdrId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vIdealbiotop AS 
SELECT alexande_apflora.tblAp.ApArtId AS "AP ApArtId", alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Bearbeitungsstand", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblAdresse.AdrName AS "AP verantwortlich", alexande_apflora.tblAp.MutWann AS "AP Letzte Änderung", alexande_apflora.tblAp.MutWer AS "AP Letzte(r) Bearbeiter(in)", alexande_apflora.tblIdealbiotop.IbApArtId AS "Ib ApArtId", alexande_apflora.tblIdealbiotop.IbErstelldatum AS "Ib Erstelldatum", alexande_apflora.tblIdealbiotop.IbHoehenlage AS "Ib Hoehenlage", alexande_apflora.tblIdealbiotop.IbRegion AS "Ib Region", alexande_apflora.tblIdealbiotop.IbExposition AS "Ib Exposition", alexande_apflora.tblIdealbiotop.IbBesonnung AS "Ib Besonnung", alexande_apflora.tblIdealbiotop.IbHangneigung AS "Ib Hangneigung", alexande_apflora.tblIdealbiotop.IbBodenTyp AS "Ib Bodentyp", alexande_apflora.tblIdealbiotop.IbBodenKalkgehalt AS "Ib Boden Kalkgehalt", alexande_apflora.tblIdealbiotop.IbBodenDurchlaessigkeit AS "Ib Boden Durchlaessigkeit", alexande_apflora.tblIdealbiotop.IbBodenHumus AS "Ib Boden Humus", alexande_apflora.tblIdealbiotop.IbBodenNaehrstoffgehalt AS "Ib Boden Naehrstoffgehalt", alexande_apflora.tblIdealbiotop.IbWasserhaushalt AS "Ib Wasserhaushalt", alexande_apflora.tblIdealbiotop.IbKonkurrenz AS "Ib Konkurrenz", alexande_apflora.tblIdealbiotop.IbMoosschicht AS "Ib Moosschicht", alexande_apflora.tblIdealbiotop.IbKrautschicht AS "Ib Krautschicht", alexande_apflora.tblIdealbiotop.IbStrauchschicht AS "Ib Strauchschicht", alexande_apflora.tblIdealbiotop.IbBaumschicht AS "Ib Baumschicht", alexande_apflora.tblIdealbiotop.IbBemerkungen AS "Ib Bemerkungen", alexande_apflora.tblIdealbiotop.MutWann AS "Ib MutWann", alexande_apflora.tblIdealbiotop.MutWer AS "Ib MutWer"
FROM alexande_apflora.tblIdealbiotop LEFT JOIN ((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAp.ApBearb = alexande_apflora.tblAdresse.AdrId) ON alexande_apflora.tblIdealbiotop.IbApArtId = alexande_apflora.tblAp.ApArtId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblIdealbiotop.IbErstelldatum;

CREATE OR REPLACE VIEW vIdealbiotopOhneAp AS 
SELECT alexande_apflora.tblAp.ApArtId AS "AP ApArtId", alexande_apflora.tblIdealbiotop.IbApArtId AS "Ib ApArtId", alexande_apflora.tblIdealbiotop.IbErstelldatum AS "Ib Erstelldatum", alexande_apflora.tblIdealbiotop.IbHoehenlage AS "Ib Hoehenlage", alexande_apflora.tblIdealbiotop.IbRegion AS "Ib Region", alexande_apflora.tblIdealbiotop.IbExposition AS "Ib Exposition", alexande_apflora.tblIdealbiotop.IbBesonnung AS "Ib Besonnung", alexande_apflora.tblIdealbiotop.IbHangneigung AS "Ib Hangneigung", alexande_apflora.tblIdealbiotop.IbBodenTyp AS "Ib Bodentyp", alexande_apflora.tblIdealbiotop.IbBodenKalkgehalt AS "Ib Boden Kalkgehalt", alexande_apflora.tblIdealbiotop.IbBodenDurchlaessigkeit AS "Ib Boden Durchlaessigkeit", alexande_apflora.tblIdealbiotop.IbBodenHumus AS "Ib Boden Humus", alexande_apflora.tblIdealbiotop.IbBodenNaehrstoffgehalt AS "Ib Boden Naehrstoffgehalt", alexande_apflora.tblIdealbiotop.IbWasserhaushalt AS "Ib Wasserhaushalt", alexande_apflora.tblIdealbiotop.IbKonkurrenz AS "Ib Konkurrenz", alexande_apflora.tblIdealbiotop.IbMoosschicht AS "Ib Moosschicht", alexande_apflora.tblIdealbiotop.IbKrautschicht AS "Ib Krautschicht", alexande_apflora.tblIdealbiotop.IbStrauchschicht AS "Ib Strauchschicht", alexande_apflora.tblIdealbiotop.IbBaumschicht AS "Ib Baumschicht", alexande_apflora.tblIdealbiotop.IbBemerkungen AS "Ib Bemerkungen", alexande_apflora.tblIdealbiotop.MutWann AS "Ib MutWann", alexande_apflora.tblIdealbiotop.MutWer AS "Ib MutWer"
FROM alexande_apflora.tblIdealbiotop LEFT JOIN ((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAp.ApBearb = alexande_apflora.tblAdresse.AdrId) ON alexande_apflora.tblIdealbiotop.IbApArtId = alexande_apflora.tblAp.ApArtId
WHERE alexande_apflora.tblAp.ApArtId is Null
ORDER BY alexande_apflora.tblIdealbiotop.IbErstelldatum;

CREATE OR REPLACE VIEW vBer AS
SELECT alexande_apflora.tblAp.ApArtId AS "AP Id", alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Bearbeitungsstand", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblAdresse.AdrName AS "AP verantwortlich", alexande_apflora.tblBer.BerId AS "Ber Id", alexande_apflora.tblBer.ApArtId AS "Ber ApId", alexande_apflora.tblBer.BerAutor AS "Ber Autor", alexande_apflora.tblBer.BerJahr AS "Ber Jahr", alexande_apflora.tblBer.BerTitel AS "Ber Titel", alexande_apflora.tblBer.BerURL AS "Ber URL", alexande_apflora.tblBer.MutWann AS "Ber MutWann", alexande_apflora.tblBer.MutWer AS "Ber MutWer"
FROM ((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAp.ApBearb = alexande_apflora.tblAdresse.AdrId) RIGHT JOIN alexande_apflora.tblBer ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblBer.ApArtId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vBerOhneAp AS
SELECT alexande_apflora.tblAp.ApArtId AS "AP Id", alexande_apflora.tblBer.BerId AS "Ber Id", alexande_apflora.tblBer.ApArtId AS "Ber ApId", alexande_apflora.tblBer.BerAutor AS "Ber Autor", alexande_apflora.tblBer.BerJahr AS "Ber Jahr", alexande_apflora.tblBer.BerTitel AS "Ber Titel", alexande_apflora.tblBer.BerURL AS "Ber URL", alexande_apflora.tblBer.MutWann AS "Ber MutWann", alexande_apflora.tblBer.MutWer AS "Ber MutWer"
FROM ((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAp.ApBearb = alexande_apflora.tblAdresse.AdrId) RIGHT JOIN alexande_apflora.tblBer ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblBer.ApArtId
WHERE alexande_apflora.tblAp.ApArtId is Null
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vAssozArten AS
SELECT alexande_apflora.tblAp.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Bearbeitungsstand", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblAdresse.AdrName AS "AP verantwortlich", alexande_apflora.tblAssozArten.AaId AS "AA Id", ArtenDb_Arteigenschaften_1.Artname AS "AA Art", alexande_apflora.tblAssozArten.AaBem AS "AA Bemerkungen", alexande_apflora.tblAssozArten.MutWann AS "AA MutWann", alexande_apflora.tblAssozArten.MutWer AS "AA MutWer"
FROM alexande_beob.ArtenDb_Arteigenschaften AS ArtenDb_Arteigenschaften_1 RIGHT JOIN (((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAp.ApBearb = alexande_apflora.tblAdresse.AdrId) RIGHT JOIN alexande_apflora.tblAssozArten ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblAssozArten.AaApArtId) ON ArtenDb_Arteigenschaften_1.TaxonomieId = alexande_apflora.tblAssozArten.AaSisfNr
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vAssozArtenOhneAp AS
SELECT alexande_apflora.tblAp.ApArtId AS "AP ApArtId", alexande_apflora.tblAssozArten.AaId AS "AA Id", alexande_apflora.tblAssozArten.AaApArtId AS "AA ApArtId", ArtenDb_Arteigenschaften_1.Artname AS "AA Art", alexande_apflora.tblAssozArten.AaBem AS "AA Bemerkungen", alexande_apflora.tblAssozArten.MutWann AS "AA MutWann", alexande_apflora.tblAssozArten.MutWer AS "AA MutWer"
FROM alexande_beob.ArtenDb_Arteigenschaften AS ArtenDb_Arteigenschaften_1 RIGHT JOIN (((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAp.ApBearb = alexande_apflora.tblAdresse.AdrId) RIGHT JOIN alexande_apflora.tblAssozArten ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblAssozArten.AaApArtId) ON ArtenDb_Arteigenschaften_1.TaxonomieId = alexande_apflora.tblAssozArten.AaSisfNr
WHERE alexande_apflora.tblAp.ApArtId is Null
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vApOhnePop AS 
SELECT alexande_apflora.tblAp.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.domApBearbeitungsstand.DomainTxt AS "Bearbeitungsstand AP", alexande_apflora.tblAp.ApJahr AS "Start AP im Jahr", domApUmsetzung.DomainTxt AS "Stand Umsetzung AP", alexande_apflora.tblAdresse.AdrName AS "Verantwortlich", alexande_apflora.tblPop.ApArtId AS "Population"
FROM ((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAp.ApBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.tblPop ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId
WHERE (((alexande_apflora.tblPop.ApArtId) Is Null))
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vApArtenAnzKontrInJahr AS
SELECT alexande_apflora.tblAp.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblTPopKontr.TPopKontrId, alexande_apflora.tblTPopKontr.TPopKontrJahr
FROM (alexande_apflora.tblAp INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON alexande_apflora.tblAp.ApArtId = alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId) INNER JOIN (alexande_apflora.tblPop INNER JOIN (alexande_apflora.tblTPop INNER JOIN alexande_apflora.tblTPopKontr ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopKontr.TPopId) ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId
WHERE (((alexande_apflora.tblAp.ApStatus) Between 1 And 3))
GROUP BY alexande_apflora.tblAp.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblTPopKontr.TPopKontrId, alexande_apflora.tblTPopKontr.TPopKontrJahr;

CREATE OR REPLACE VIEW vErfKrit AS
SELECT alexande_apflora.tblAp.ApArtId AS "AP Id", alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblAdresse.AdrName AS "AP verantwortlich", alexande_apflora.tblErfKrit.ErfkritId AS "ErfKrit Id", alexande_apflora.tblErfKrit.ApArtId AS "ErfKrit ApId", domApErfKrit.BeurteilTxt AS "ErfKrit Beurteilung", alexande_apflora.tblErfKrit.ErfkritTxt AS "ErfKrit Kriterien", alexande_apflora.tblErfKrit.MutWann AS "ErfKrit MutWann", alexande_apflora.tblErfKrit.MutWer AS "ErfKrit MutWer"
FROM (((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAp.ApBearb = alexande_apflora.tblAdresse.AdrId) RIGHT JOIN alexande_apflora.tblErfKrit ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblErfKrit.ApArtId) LEFT JOIN alexande_apflora.domApErfKrit ON alexande_apflora.tblErfKrit.ErfkritErreichungsgrad = domApErfKrit.BeurteilId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vErfKritOhneAp AS
SELECT alexande_apflora.tblAp.ApArtId AS "AP Id", alexande_apflora.tblErfKrit.ErfkritId AS "ErfKrit Id", alexande_apflora.tblErfKrit.ApArtId AS "ErfKrit ApId", domApErfKrit.BeurteilTxt AS "ErfKrit Beurteilung", alexande_apflora.tblErfKrit.ErfkritTxt AS "ErfKrit Kriterien", alexande_apflora.tblErfKrit.MutWann AS "ErfKrit MutWann", alexande_apflora.tblErfKrit.MutWer AS "ErfKrit MutWer"
FROM (((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAp.ApBearb = alexande_apflora.tblAdresse.AdrId) RIGHT JOIN alexande_apflora.tblErfKrit ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblErfKrit.ApArtId) LEFT JOIN alexande_apflora.domApErfKrit ON alexande_apflora.tblErfKrit.ErfkritErreichungsgrad = domApErfKrit.BeurteilId
WHERE alexande_apflora.tblAp.ApArtId is Null
ORDER BY alexande_apflora.domApErfKrit.BeurteilTxt, alexande_apflora.tblErfKrit.ErfkritTxt;

CREATE OR REPLACE VIEW vAuswApArtenAnzMassnInJahr0 AS
SELECT alexande_apflora.tblAp.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblTPopMassn.TPopMassnId, alexande_apflora.tblTPopMassn.TPopMassnJahr
FROM (alexande_apflora.tblAp INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON alexande_apflora.tblAp.ApArtId = alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId) INNER JOIN ((alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN alexande_apflora.tblTPopMassn ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopMassn.TPopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId
WHERE (((alexande_apflora.tblAp.ApStatus) Between 1 And 3))
GROUP BY alexande_apflora.tblAp.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblTPopMassn.TPopMassnId, alexande_apflora.tblTPopMassn.TPopMassnJahr;

CREATE OR REPLACE VIEW vAuswApArtenBearbMassnInJahr0 AS 
SELECT alexande_apflora.tblAdresse.AdrName, alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.tblPop.PopNr, alexande_apflora.tblPop.PopName, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPop.TPopGemeinde, alexande_apflora.tblTPop.TPopFlurname, alexande_apflora.tblTPopMassn.TPopMassnJahr, domTPopMassnTyp.MassnTypTxt AS TPopMassnTyp, alexande_apflora.tblTPopMassn.TPopMassnTxt, alexande_apflora.tblTPopMassn.TPopMassnDatum, alexande_apflora.tblTPopMassn.TPopMassnBemTxt, alexande_apflora.tblTPopMassn.TPopMassnPlan, alexande_apflora.tblTPopMassn.TPopMassnPlanBez, alexande_apflora.tblTPopMassn.TPopMassnFlaeche, alexande_apflora.tblTPopMassn.TPopMassnMarkierung, alexande_apflora.tblTPopMassn.TPopMassnAnsiedAnzTriebe, alexande_apflora.tblTPopMassn.TPopMassnAnsiedAnzPfl, alexande_apflora.tblTPopMassn.TPopMassnAnzPflanzstellen, alexande_apflora.tblTPopMassn.TPopMassnAnsiedWirtspfl, alexande_apflora.tblTPopMassn.TPopMassnAnsiedHerkunftPop, alexande_apflora.tblTPopMassn.TPopMassnAnsiedDatSamm, alexande_apflora.tblTPopMassn.TPopMassnAnsiedForm, alexande_apflora.tblTPopMassn.TPopMassnAnsiedPflanzanordnung
FROM (alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN ((alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN ((alexande_apflora.tblTPopMassn LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPopMassn.TPopMassnBearb = alexande_apflora.tblAdresse.AdrId) INNER JOIN alexande_apflora.domTPopMassnTyp ON alexande_apflora.tblTPopMassn.TPopMassnTyp = domTPopMassnTyp.MassnTypCode) ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopMassn.TPopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId
WHERE (((alexande_apflora.tblAp.ApStatus) Between 1 And 3))
ORDER BY alexande_apflora.tblAdresse.AdrName, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblPop.PopName, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPop.TPopGemeinde, alexande_apflora.tblTPop.TPopFlurname;

CREATE OR REPLACE VIEW vAuswApArtenMitMassnInJahr0 AS 
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.tblPop.PopNr, alexande_apflora.tblPop.PopName, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPop.TPopGemeinde, alexande_apflora.tblTPop.TPopFlurname, alexande_apflora.tblTPopMassn.TPopMassnJahr, domTPopMassnTyp.MassnTypTxt AS TPopMassnTyp, alexande_apflora.tblTPopMassn.TPopMassnTxt, alexande_apflora.tblTPopMassn.TPopMassnDatum, alexande_apflora.tblAdresse.AdrName AS TPopMassnBearb, alexande_apflora.tblTPopMassn.TPopMassnBemTxt, alexande_apflora.tblTPopMassn.TPopMassnPlan, alexande_apflora.tblTPopMassn.TPopMassnPlanBez, alexande_apflora.tblTPopMassn.TPopMassnFlaeche, alexande_apflora.tblTPopMassn.TPopMassnMarkierung, alexande_apflora.tblTPopMassn.TPopMassnAnsiedAnzTriebe, alexande_apflora.tblTPopMassn.TPopMassnAnsiedAnzPfl, alexande_apflora.tblTPopMassn.TPopMassnAnzPflanzstellen, alexande_apflora.tblTPopMassn.TPopMassnAnsiedWirtspfl, alexande_apflora.tblTPopMassn.TPopMassnAnsiedHerkunftPop, alexande_apflora.tblTPopMassn.TPopMassnAnsiedDatSamm, alexande_apflora.tblTPopMassn.TPopMassnAnsiedForm, alexande_apflora.tblTPopMassn.TPopMassnAnsiedPflanzanordnung
FROM (alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN ((alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN ((alexande_apflora.tblTPopMassn INNER JOIN alexande_apflora.domTPopMassnTyp ON alexande_apflora.tblTPopMassn.TPopMassnTyp = domTPopMassnTyp.MassnTypCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPopMassn.TPopMassnBearb = alexande_apflora.tblAdresse.AdrId) ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopMassn.TPopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId
WHERE (((alexande_apflora.tblAp.ApStatus) Between 1 And 3))
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblPop.PopName, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPop.TPopGemeinde, alexande_apflora.tblTPop.TPopFlurname;

CREATE OR REPLACE VIEW vAuswArtPopTPopMassnBerFuerAktArt0 AS
SELECT alexande_apflora.tblAp.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.domApBearbeitungsstand.DomainTxt AS "Aktionsplan-Status", alexande_apflora.tblAp.ApJahr AS "Aktionsplan-Jahr", domApUmsetzung.DomainTxt AS "Aktionsplan-Umsetzung", alexande_apflora.tblPop.PopNr AS "Population-Nr", alexande_apflora.tblPop.PopName AS "Population-Name", domPopHerkunft.HerkunftTxt AS "Population-Herkunft", alexande_apflora.tblPop.PopBekanntSeit AS "Population - bekannt seit", alexande_apflora.tblTPop.TPopNr AS "Teilpopulation-Nr", alexande_apflora.tblTPop.TPopGemeinde AS "Teilpopulation-Gemeinde", alexande_apflora.tblTPop.TPopFlurname AS "Teilpopulation-Flurname", alexande_apflora.tblTPop.TPopXKoord AS "Teilpopulation-X-Koodinate", alexande_apflora.tblTPop.TPopYKoord AS "Teilpopulation-Y-Koordinate", alexande_apflora.tblTPop.TPopRadius AS "Teilpopulation-Radius", alexande_apflora.tblTPop.TPopHoehe AS "Teilpopulation-Hoehe", alexande_apflora.tblTPop.TPopBeschr AS "Teilpopulation-Beschreibung", alexande_apflora.tblTPop.TPopKatNr AS "Teilpopulation-Kataster-Nr", alexande_apflora.tblAdresse.AdrName AS "Teilpopulation-Verantwortlich", domPopHerkunft_1.HerkunftTxt AS "Teilpopulation-Herkunft", alexande_apflora.tblTPop.TPopHerkunftUnklar AS "Teilpopulation - Herkunft unklar", alexande_apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "Teilpopulation - Herkunft unklar Begründung",alexande_apflora.domTPopApBerichtRelevant.DomainTxt AS "Teilpopulation - Für Bericht relevant", alexande_apflora.tblTPop.TPopBekanntSeit AS "Teilpopulation - bekannt seit", alexande_apflora.tblTPop.TPopEigen AS "Teilpopulation-Eigentümer", alexande_apflora.tblTPop.TPopKontakt AS "Teilpopulation-Kontakt", alexande_apflora.tblTPop.TPopNutzungszone AS "Teilpopulation-Nutzungszone", alexande_apflora.tblTPop.TPopBewirtschafterIn AS "Teilpopulation-Bewirtschafter", alexande_apflora.tblTPop.TPopBewirtschaftung AS "Teilpopulation-Bewirtschaftung", alexande_apflora.tblTPop.TPopTxt AS "Teilpopulation-Bemerkungen", alexande_apflora.tblTPopMassnBer.TPopMassnBerJahr AS "Massnahmenbericht-Jahr", domTPopMassnErfolgsbeurteilung.BeurteilTxt AS "Massnahmenbericht-Erfolgsberuteilung", alexande_apflora.tblTPopMassnBer.TPopMassnBerTxt AS "Massnahmenbericht-Interpretation"
FROM (((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) INNER JOIN (((alexande_apflora.tblPop LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) INNER JOIN (((alexande_apflora.tblTPop LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPop.TPopVerantw = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.domPopHerkunft AS domPopHerkunft_1 ON alexande_apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId) LEFT JOIN alexande_apflora.domTPopApBerichtRelevant ON alexande_apflora.tblTPop.TPopApBerichtRelevant =alexande_apflora.domTPopApBerichtRelevant.DomainCode) ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN (alexande_apflora.tblTPopMassnBer INNER JOIN alexande_apflora.domTPopMassnErfolgsbeurteilung ON alexande_apflora.tblTPopMassnBer.TPopMassnBerErfolgsbeurteilung = domTPopMassnErfolgsbeurteilung.BeurteilId) ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopMassnBer.TPopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPopMassnBer.TPopMassnBerJahr;

CREATE OR REPLACE VIEW vAuswArtPopTPopMassn0 AS 
SELECT alexande_apflora.tblAp.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.domApBearbeitungsstand.DomainTxt AS "Aktionsplan Bearbeitungsstand", alexande_apflora.tblPop.PopId, alexande_apflora.tblPop.PopNr, alexande_apflora.tblPop.PopName, alexande_apflora.tblTPop.TPopId, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPop.TPopFlurname, alexande_apflora.tblTPopMassn.TPopMassnId, alexande_apflora.tblTPopMassn.TPopMassnJahr AS Jahr, domTPopMassnTyp.MassnTypTxt AS Massnahme, alexande_apflora.tblTPopMassn.TPopMassnTxt, alexande_apflora.tblTPopMassn.TPopMassnDatum, alexande_apflora.tblAdresse.AdrName AS TPopMassnBearb, alexande_apflora.tblTPopMassn.TPopMassnBemTxt, alexande_apflora.tblTPopMassn.TPopMassnPlan, alexande_apflora.tblTPopMassn.TPopMassnPlanBez, alexande_apflora.tblTPopMassn.TPopMassnFlaeche, alexande_apflora.tblTPopMassn.TPopMassnMarkierung, alexande_apflora.tblTPopMassn.TPopMassnAnsiedAnzTriebe, alexande_apflora.tblTPopMassn.TPopMassnAnsiedAnzPfl, alexande_apflora.tblTPopMassn.TPopMassnAnzPflanzstellen, alexande_apflora.tblTPopMassn.TPopMassnAnsiedWirtspfl, alexande_apflora.tblTPopMassn.TPopMassnAnsiedHerkunftPop, alexande_apflora.tblTPopMassn.TPopMassnAnsiedDatSamm, alexande_apflora.tblTPopMassn.TPopMassnAnsiedForm, alexande_apflora.tblTPopMassn.TPopMassnAnsiedPflanzanordnung
FROM ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) INNER JOIN ((alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN ((alexande_apflora.tblTPopMassn LEFT JOIN alexande_apflora.domTPopMassnTyp ON alexande_apflora.tblTPopMassn.TPopMassnTyp = domTPopMassnTyp.MassnTypCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPopMassn.TPopMassnBearb = alexande_apflora.tblAdresse.AdrId) ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopMassn.TPopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPopMassn.TPopMassnJahr, domTPopMassnTyp.MassnTypTxt;

CREATE OR REPLACE VIEW vAuswArtPopTPopMassnFuerAktArt0 AS 
SELECT alexande_apflora.tblAp.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.domApBearbeitungsstand.DomainTxt AS "Aktionsplan-Status", alexande_apflora.tblAp.ApJahr AS "Aktionsplan-Jahr", domApUmsetzung.DomainTxt AS "Aktionsplan-Umsetzung", alexande_apflora.tblPop.PopId, alexande_apflora.tblPop.PopNr AS "Population-Nr", alexande_apflora.tblPop.PopName AS "Population-Name", domPopHerkunft.HerkunftTxt AS "Population-Herkunft", alexande_apflora.tblPop.PopBekanntSeit AS "Population - bekannt seit", alexande_apflora.tblTPop.TPopId, alexande_apflora.tblTPop.TPopNr AS "Teilpopulation-Nr", alexande_apflora.tblTPop.TPopGemeinde AS "Teilpopulation-Gemeinde", alexande_apflora.tblTPop.TPopFlurname AS "Teilpopulation-Flurname", alexande_apflora.tblTPop.TPopXKoord AS "Teilpopulation-X-Koodinate", alexande_apflora.tblTPop.TPopYKoord AS "Teilpopulation-Y-Koordinate", alexande_apflora.tblTPop.TPopRadius AS "Teilpopulation-Radius", alexande_apflora.tblTPop.TPopHoehe AS "Teilpopulation-Höhe", alexande_apflora.tblTPop.TPopBeschr AS "Teilpopulation-Beschreibung", alexande_apflora.tblTPop.TPopKatNr AS "Teilpopulation-Kataster-Nr", tblAdresse_1.AdrName AS "Teilpopulation-Verantwortlich", domPopHerkunft_1.HerkunftTxt AS "Teilpopulation-Herkunft", alexande_apflora.tblTPop.TPopHerkunftUnklar AS "Teilpopulation - Herkunft unklar", alexande_apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "Teilpopulation - Herkunft unklar Begründung",alexande_apflora.domTPopApBerichtRelevant.DomainTxt AS "Teilpopulation - Für Bericht relevant", alexande_apflora.tblTPop.TPopBekanntSeit AS "Teilpopulation - bekannt seit", alexande_apflora.tblTPop.TPopEigen AS "Teilpopulation-Eigentümer", alexande_apflora.tblTPop.TPopKontakt AS "Teilpopulation-Kontakt", alexande_apflora.tblTPop.TPopNutzungszone AS "Teilpopulation-Nutzungszone", alexande_apflora.tblTPop.TPopBewirtschafterIn AS "Teilpopulation-Bewirtschafter", alexande_apflora.tblTPop.TPopBewirtschaftung AS "Teilpopulation-Bewirtschaftung", alexande_apflora.tblTPop.TPopTxt AS "Teilpopulation-Bemerkungen", alexande_apflora.tblTPopMassn.TPopMassnId, domTPopMassnTyp.MassnTypTxt AS "Massnahme-Typ", alexande_apflora.tblTPopMassn.TPopMassnTxt AS "Massnahme-Beschreibung", alexande_apflora.tblTPopMassn.TPopMassnDatum AS "Massnahme-Datum", alexande_apflora.tblAdresse.AdrName AS "Massnahme-BearbeiterIn", alexande_apflora.tblTPopMassn.TPopMassnBemTxt AS "Massnahme-Bemerkungen", alexande_apflora.tblTPopMassn.TPopMassnPlan AS "Massnahme-Plan", alexande_apflora.tblTPopMassn.TPopMassnPlanBez AS "Massnahme-Planbezeichnung", alexande_apflora.tblTPopMassn.TPopMassnFlaeche AS "Massnahme-Fläche", alexande_apflora.tblTPopMassn.TPopMassnMarkierung AS "Massnahme-Markierung", alexande_apflora.tblTPopMassn.TPopMassnAnsiedAnzTriebe AS "Massnahme - Ansiedlung Anzahl Triebe", alexande_apflora.tblTPopMassn.TPopMassnAnsiedAnzPfl AS "Massnahme - Ansiedlung Anzahl Pflanzen", alexande_apflora.tblTPopMassn.TPopMassnAnzPflanzstellen AS "Massnahme - Ansiedlung Anzahl Pflanzstellen", alexande_apflora.tblTPopMassn.TPopMassnAnsiedWirtspfl AS "Massnahme - Ansiedlung Wirtspflanzen", alexande_apflora.tblTPopMassn.TPopMassnAnsiedHerkunftPop AS "Massnahme - Ansiedlung Herkunftspopulation", alexande_apflora.tblTPopMassn.TPopMassnAnsiedDatSamm AS "Massnahme - Ansiedlung Sammeldatum", alexande_apflora.tblTPopMassn.TPopMassnAnsiedForm AS "Massnahme - Ansiedlung Form", alexande_apflora.tblTPopMassn.TPopMassnAnsiedPflanzanordnung AS "Massnahme - Ansiedlung Pflanzordnung"
FROM (alexande_beob.ArtenDb_Arteigenschaften INNER JOIN ((alexande_apflora.tblAp LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN (((alexande_apflora.tblPop LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) INNER JOIN (((alexande_apflora.tblTPop LEFT JOIN alexande_apflora.tblAdresse AS tblAdresse_1 ON alexande_apflora.tblTPop.TPopVerantw = tblAdresse_1.AdrId) LEFT JOIN alexande_apflora.domPopHerkunft AS domPopHerkunft_1 ON alexande_apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId) LEFT JOIN alexande_apflora.domTPopApBerichtRelevant ON alexande_apflora.tblTPop.TPopApBerichtRelevant =alexande_apflora.domTPopApBerichtRelevant.DomainCode) ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN ((alexande_apflora.tblTPopMassn LEFT JOIN alexande_apflora.domTPopMassnTyp ON alexande_apflora.tblTPopMassn.TPopMassnTyp = domTPopMassnTyp.MassnTypCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPopMassn.TPopMassnBearb = alexande_apflora.tblAdresse.AdrId) ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopMassn.TPopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblTPop.TPopNr, domTPopMassnTyp.MassnTypTxt;

CREATE OR REPLACE VIEW vAuswFlurnameArtKontrolle AS
SELECT alexande_apflora.tblAp.ApArtId, alexande_apflora.tblPop.PopId, alexande_apflora.tblTPop.TPopId, alexande_apflora.tblTPop.TPopGemeinde AS Gemeinde, alexande_apflora.tblTPop.TPopFlurname AS "Flurname aus Teilpopulation", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "Bearbeitungsstand AP", alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.tblPop.PopNr, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPopKontr.TPopKontrJahr AS Jahr, alexande_apflora.tblTPopKontr.TPopKontrTyp AS Kontrolltyp, alexande_apflora.tblTPopKontr.TPopKontrDatum, alexande_apflora.tblAdresse.AdrName AS TPopKontrBearb, alexande_apflora.tblTPopKontr.TPopKontrAnz1, alexande_apflora.tblTPopKontr.TPopKontrAnz2, alexande_apflora.tblTPopKontr.TPopKontrAnz3, alexande_apflora.tblTPopKontr.TPopKontrJungpfl, alexande_apflora.tblTPopKontr.TPopKontrVitalitaet, alexande_apflora.tblTPopKontr.TPopKontrUeberleb, alexande_apflora.tblTPopKontr.TPopKontrEntwicklung, alexande_apflora.tblTPopKontr.TPopKontrUrsach, alexande_apflora.tblTPopKontr.TPopKontrUrteil, alexande_apflora.tblTPopKontr.TPopKontrAendUms, alexande_apflora.tblTPopKontr.TPopKontrAendKontr, alexande_apflora.tblTPopKontr.TPopKontrTxt, alexande_apflora.tblTPopKontr.TPopKontrLeb, alexande_apflora.tblTPopKontr.TPopKontrFlaeche, alexande_apflora.tblTPopKontr.TPopKontrLebUmg, alexande_apflora.tblTPopKontr.TPopKontrStrauchschicht, alexande_apflora.tblTPopKontr.TPopKontrBodenTyp, alexande_apflora.tblTPopKontr.TPopKontrBodenAbtrag, alexande_apflora.tblTPopKontr.TPopKontrWasserhaushalt, alexande_apflora.tblTPopKontr.TPopKontrHandlungsbedarf, alexande_apflora.tblTPopKontr.TPopKontrUebFlaeche, alexande_apflora.tblTPopKontr.TPopKontrPlan, alexande_apflora.tblTPopKontr.TPopKontrVeg, alexande_apflora.tblTPopKontr.TPopKontrNaBo, alexande_apflora.tblTPopKontr.TPopKontrUebPfl, alexande_apflora.tblTPopKontr.TPopKontrJungPflJN, alexande_apflora.tblTPopKontr.TPopKontrVegHoeMax, alexande_apflora.tblTPopKontr.TPopKontrVegHoeMit, alexande_apflora.tblTPopKontr.TPopKontrGefaehrdung, alexande_apflora.tblTPopKontrZaehl.TPopKontrZaehlId, alexande_apflora.tblTPopKontrZaehl.TPopKontrId, alexande_apflora.tblTPopKontrZaehl.Anzahl, alexande_apflora.domTPopKontrZaehleinheit.ZaehleinheitTxt AS Zaehleinheit, alexande_apflora.domTPopKontrMethode.BeurteilTxt AS Methode
FROM ((((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN (alexande_apflora.tblPop INNER JOIN (alexande_apflora.tblTPop INNER JOIN alexande_apflora.tblTPopKontr ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopKontr.TPopId) ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPopKontr.TPopKontrBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.tblTPopKontrZaehl ON alexande_apflora.tblTPopKontr.TPopKontrId = alexande_apflora.tblTPopKontrZaehl.TPopKontrId) LEFT JOIN alexande_apflora.domTPopKontrZaehleinheit ON alexande_apflora.tblTPopKontrZaehl.Zaehleinheit = alexande_apflora.domTPopKontrZaehleinheit.ZaehleinheitCode) LEFT JOIN alexande_apflora.domTPopKontrMethode ON alexande_apflora.tblTPopKontrZaehl.Methode = alexande_apflora.domTPopKontrMethode.BeurteilCode
WHERE alexande_apflora.tblTPopKontr.TPopKontrTyp Not Like "Ziel"
ORDER BY alexande_apflora.tblTPop.TPopGemeinde, alexande_apflora.tblTPop.TPopFlurname, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPopKontr.TPopKontrJahr, alexande_apflora.tblTPopKontr.TPopKontrTyp;


CREATE OR REPLACE VIEW vJbA1rPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM alexande_apflora.tblAp INNER JOIN (alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId
WHERE (alexande_apflora.tblPop.PopHerkunft=100 Or alexande_apflora.tblPop.PopHerkunft=101 Or alexande_apflora.tblPop.PopHerkunft=210) AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbA2rPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM alexande_apflora.tblAp INNER JOIN (alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId
WHERE (alexande_apflora.tblPop.PopHerkunft=100 Or alexande_apflora.tblPop.PopHerkunft=101) AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbA3rPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM alexande_apflora.tblAp INNER JOIN (alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId
WHERE alexande_apflora.tblPop.PopHerkunft=210 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300 AND (alexande_apflora.tblPop.PopBekanntSeit<alexande_apflora.tblAp.ApJahr Or alexande_apflora.tblPop.PopBekanntSeit Is Null)
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbA1rTPop AS
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM alexande_apflora.tblAp INNER JOIN (alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId
WHERE (alexande_apflora.tblTPop.TPopHerkunft=100 Or alexande_apflora.tblTPop.TPopHerkunft=101 Or alexande_apflora.tblTPop.TPopHerkunft=210) AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbA2rTPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM alexande_apflora.tblAp INNER JOIN (alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId
WHERE (alexande_apflora.tblTPop.TPopHerkunft=100 Or alexande_apflora.tblTPop.TPopHerkunft=101) AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbA3rTPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM alexande_apflora.tblAp INNER JOIN (alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId
WHERE alexande_apflora.tblTPop.TPopHerkunft=210 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300 AND (alexande_apflora.tblPop.PopBekanntSeit<alexande_apflora.tblAp.ApJahr Or alexande_apflora.tblPop.PopBekanntSeit Is Null)
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbB1rPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM alexande_apflora.tblKonstanten, (alexande_apflora.tblPop INNER JOIN alexande_apflora.tblPopBer ON alexande_apflora.tblPop.PopId = alexande_apflora.tblPopBer.PopId) INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300 AND alexande_apflora.tblPopBer.PopBerJahr<=alexande_apflora.tblKonstanten.JBerJahr
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbB2rPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM ((alexande_apflora_views.vLetzterPopBericht INNER JOIN alexande_apflora.tblPop ON alexande_apflora_views.vLetzterPopBericht.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblPopBer ON (alexande_apflora.tblPop.PopId = alexande_apflora.tblPopBer.PopId) AND (alexande_apflora_views.vLetzterPopBericht.PopId = alexande_apflora.tblPopBer.PopId) AND (alexande_apflora_views.vLetzterPopBericht.MaxvonPopBerJahr = alexande_apflora.tblPopBer.PopBerJahr)) INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblPopBer.PopBerEntwicklung=3 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbB3rPop AS
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM ((alexande_apflora_views.vLetzterPopBericht INNER JOIN alexande_apflora.tblPop ON alexande_apflora_views.vLetzterPopBericht.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblPopBer ON (alexande_apflora.tblPop.PopId = alexande_apflora.tblPopBer.PopId) AND (alexande_apflora_views.vLetzterPopBericht.PopId = alexande_apflora.tblPopBer.PopId) AND (alexande_apflora_views.vLetzterPopBericht.MaxvonPopBerJahr = alexande_apflora.tblPopBer.PopBerJahr)) INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblPopBer.PopBerEntwicklung=2 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbB4rPop AS
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM ((alexande_apflora_views.vLetzterPopBericht INNER JOIN alexande_apflora.tblPop ON alexande_apflora_views.vLetzterPopBericht.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblPopBer ON (alexande_apflora.tblPop.PopId = alexande_apflora.tblPopBer.PopId) AND (alexande_apflora_views.vLetzterPopBericht.PopId = alexande_apflora.tblPopBer.PopId) AND (alexande_apflora_views.vLetzterPopBericht.MaxvonPopBerJahr = alexande_apflora.tblPopBer.PopBerJahr)) INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblPopBer.PopBerEntwicklung=1 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbB5rPop AS
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM ((alexande_apflora_views.vLetzterPopBericht INNER JOIN alexande_apflora.tblPop ON alexande_apflora_views.vLetzterPopBericht.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblPopBer ON (alexande_apflora.tblPop.PopId = alexande_apflora.tblPopBer.PopId) AND (alexande_apflora_views.vLetzterPopBericht.PopId = alexande_apflora.tblPopBer.PopId) AND (alexande_apflora_views.vLetzterPopBericht.MaxvonPopBerJahr = alexande_apflora.tblPopBer.PopBerJahr)) INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE (alexande_apflora.tblPopBer.PopBerEntwicklung=4 Or alexande_apflora.tblPopBer.PopBerEntwicklung=9) AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbB6rPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM ((alexande_apflora_views.vLetzterPopBericht INNER JOIN alexande_apflora.tblPop ON alexande_apflora_views.vLetzterPopBericht.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblPopBer ON (alexande_apflora.tblPop.PopId = alexande_apflora.tblPopBer.PopId) AND (alexande_apflora_views.vLetzterPopBericht.PopId = alexande_apflora.tblPopBer.PopId) AND (alexande_apflora_views.vLetzterPopBericht.MaxvonPopBerJahr = alexande_apflora.tblPopBer.PopBerJahr)) INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblPopBer.PopBerEntwicklung=8 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbB1rTPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPopBer.TPopId
FROM alexande_apflora.tblKonstanten, alexande_apflora.tblPop INNER JOIN (alexande_apflora.tblTPop INNER JOIN alexande_apflora.tblTPopBer ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopBer.TPopId) ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300 AND alexande_apflora.tblTPopBer.TPopBerJahr<=alexande_apflora.tblKonstanten.JBerJahr
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPopBer.TPopId;

CREATE OR REPLACE VIEW vJbB2rTPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM alexande_apflora.tblTPop INNER JOIN (alexande_apflora.tblTPopBer INNER JOIN (alexande_apflora.tblPop INNER JOIN alexande_apflora_views.vLetzterTPopBericht ON alexande_apflora.tblPop.ApArtId = alexande_apflora_views.vLetzterTPopBericht.ApArtId) ON (alexande_apflora.tblTPopBer.TPopId = alexande_apflora_views.vLetzterTPopBericht.TPopId) AND (alexande_apflora.tblTPopBer.TPopBerJahr = alexande_apflora_views.vLetzterTPopBericht.MaxvonTPopBerJahr)) ON (alexande_apflora.tblTPop.PopId = alexande_apflora.tblPop.PopId) AND (alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopBer.TPopId)
WHERE alexande_apflora.tblTPopBer.TPopBerEntwicklung=3 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbB3rTPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM alexande_apflora.tblTPop INNER JOIN (alexande_apflora.tblTPopBer INNER JOIN (alexande_apflora.tblPop INNER JOIN alexande_apflora_views.vLetzterTPopBericht ON alexande_apflora.tblPop.ApArtId = alexande_apflora_views.vLetzterTPopBericht.ApArtId) ON (alexande_apflora.tblTPopBer.TPopId = alexande_apflora_views.vLetzterTPopBericht.TPopId) AND (alexande_apflora.tblTPopBer.TPopBerJahr = alexande_apflora_views.vLetzterTPopBericht.MaxvonTPopBerJahr)) ON (alexande_apflora.tblTPop.PopId = alexande_apflora.tblPop.PopId) AND (alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopBer.TPopId)
WHERE alexande_apflora.tblTPopBer.TPopBerEntwicklung=2 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbB4rTPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM alexande_apflora.tblTPop INNER JOIN (alexande_apflora.tblTPopBer INNER JOIN (alexande_apflora.tblPop INNER JOIN alexande_apflora_views.vLetzterTPopBericht ON alexande_apflora.tblPop.ApArtId = alexande_apflora_views.vLetzterTPopBericht.ApArtId) ON (alexande_apflora.tblTPopBer.TPopId = alexande_apflora_views.vLetzterTPopBericht.TPopId) AND (alexande_apflora.tblTPopBer.TPopBerJahr = alexande_apflora_views.vLetzterTPopBericht.MaxvonTPopBerJahr)) ON (alexande_apflora.tblTPop.PopId = alexande_apflora.tblPop.PopId) AND (alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopBer.TPopId)
WHERE alexande_apflora.tblTPopBer.TPopBerEntwicklung=1 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbB5rTPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM alexande_apflora.tblTPop INNER JOIN (alexande_apflora.tblTPopBer INNER JOIN (alexande_apflora.tblPop INNER JOIN alexande_apflora_views.vLetzterTPopBericht ON alexande_apflora.tblPop.ApArtId = alexande_apflora_views.vLetzterTPopBericht.ApArtId) ON (alexande_apflora.tblTPopBer.TPopId = alexande_apflora_views.vLetzterTPopBericht.TPopId) AND (alexande_apflora.tblTPopBer.TPopBerJahr = alexande_apflora_views.vLetzterTPopBericht.MaxvonTPopBerJahr)) ON (alexande_apflora.tblTPop.PopId = alexande_apflora.tblPop.PopId) AND (alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopBer.TPopId)
WHERE (alexande_apflora.tblTPopBer.TPopBerEntwicklung=4 Or alexande_apflora.tblTPopBer.TPopBerEntwicklung=9) AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbB6rTPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM alexande_apflora.tblTPop INNER JOIN (alexande_apflora.tblTPopBer INNER JOIN (alexande_apflora.tblPop INNER JOIN alexande_apflora_views.vLetzterTPopBericht ON alexande_apflora.tblPop.ApArtId = alexande_apflora_views.vLetzterTPopBericht.ApArtId) ON (alexande_apflora.tblTPopBer.TPopId = alexande_apflora_views.vLetzterTPopBericht.TPopId) AND (alexande_apflora.tblTPopBer.TPopBerJahr = alexande_apflora_views.vLetzterTPopBericht.MaxvonTPopBerJahr)) ON (alexande_apflora.tblTPop.PopId = alexande_apflora.tblPop.PopId) AND (alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopBer.TPopId)
WHERE alexande_apflora.tblTPopBer.TPopBerEntwicklung=8 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbC1rPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM alexande_apflora.tblKonstanten, (alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN alexande_apflora.tblTPopMassn ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopMassn.TPopId
WHERE alexande_apflora.tblTPopMassn.TPopMassnJahr<=alexande_apflora.tblKonstanten.JBerJahr AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbC3rPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM (alexande_apflora_views.vLetzterPopMassnBericht INNER JOIN alexande_apflora.tblPop ON alexande_apflora_views.vLetzterPopMassnBericht.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblPopMassnBer ON (alexande_apflora.tblPop.PopId = alexande_apflora.tblPopMassnBer.PopId) AND (alexande_apflora_views.vLetzterPopMassnBericht.MaxvonPopMassnBerJahr = alexande_apflora.tblPopMassnBer.PopMassnBerJahr) AND (alexande_apflora_views.vLetzterPopMassnBericht.PopId = alexande_apflora.tblPopMassnBer.PopId)
WHERE alexande_apflora.tblPopMassnBer.PopMassnBerErfolgsbeurteilung=1
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbC4rPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM (alexande_apflora_views.vLetzterPopMassnBericht INNER JOIN alexande_apflora.tblPop ON alexande_apflora_views.vLetzterPopMassnBericht.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblPopMassnBer ON (alexande_apflora.tblPop.PopId = alexande_apflora.tblPopMassnBer.PopId) AND (alexande_apflora_views.vLetzterPopMassnBericht.MaxvonPopMassnBerJahr = alexande_apflora.tblPopMassnBer.PopMassnBerJahr) AND (alexande_apflora_views.vLetzterPopMassnBericht.PopId = alexande_apflora.tblPopMassnBer.PopId)
WHERE (((alexande_apflora.tblPopMassnBer.PopMassnBerErfolgsbeurteilung)=2))
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbC5rPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM (alexande_apflora_views.vLetzterPopMassnBericht INNER JOIN alexande_apflora.tblPop ON alexande_apflora_views.vLetzterPopMassnBericht.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblPopMassnBer ON (alexande_apflora.tblPop.PopId = alexande_apflora.tblPopMassnBer.PopId) AND (alexande_apflora_views.vLetzterPopMassnBericht.MaxvonPopMassnBerJahr = alexande_apflora.tblPopMassnBer.PopMassnBerJahr) AND (alexande_apflora_views.vLetzterPopMassnBericht.PopId = alexande_apflora.tblPopMassnBer.PopId)
WHERE alexande_apflora.tblPopMassnBer.PopMassnBerErfolgsbeurteilung=3
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbC6rPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM (alexande_apflora_views.vLetzterPopMassnBericht INNER JOIN alexande_apflora.tblPop ON alexande_apflora_views.vLetzterPopMassnBericht.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblPopMassnBer ON (alexande_apflora.tblPop.PopId = alexande_apflora.tblPopMassnBer.PopId) AND (alexande_apflora_views.vLetzterPopMassnBericht.PopId = alexande_apflora.tblPopMassnBer.PopId) AND (alexande_apflora_views.vLetzterPopMassnBericht.MaxvonPopMassnBerJahr = alexande_apflora.tblPopMassnBer.PopMassnBerJahr)
WHERE alexande_apflora.tblPopMassnBer.PopMassnBerErfolgsbeurteilung=4
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbC7rPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM (alexande_apflora_views.vLetzterPopMassnBericht INNER JOIN alexande_apflora.tblPop ON alexande_apflora_views.vLetzterPopMassnBericht.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblPopMassnBer ON (alexande_apflora.tblPop.PopId = alexande_apflora.tblPopMassnBer.PopId) AND (alexande_apflora_views.vLetzterPopMassnBericht.PopId = alexande_apflora.tblPopMassnBer.PopId) AND (alexande_apflora_views.vLetzterPopMassnBericht.MaxvonPopMassnBerJahr = alexande_apflora.tblPopMassnBer.PopMassnBerJahr)
WHERE alexande_apflora.tblPopMassnBer.PopMassnBerErfolgsbeurteilung=5
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbC1rTPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM alexande_apflora.tblKonstanten, (alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN alexande_apflora.tblTPopMassn ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopMassn.TPopId
WHERE alexande_apflora.tblTPopMassn.TPopMassnJahr<=alexande_apflora.tblKonstanten.JBerJahr AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbC3rTPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM ((alexande_apflora_views.vLetzterTPopMassnBericht INNER JOIN alexande_apflora.tblPop ON alexande_apflora_views.vLetzterTPopMassnBericht.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblTPopMassnBer ON (alexande_apflora_views.vLetzterTPopMassnBericht.MaxvonTPopMassnBerJahr = alexande_apflora.tblTPopMassnBer.TPopMassnBerJahr) AND (alexande_apflora_views.vLetzterTPopMassnBericht.TPopId = alexande_apflora.tblTPopMassnBer.TPopId)) INNER JOIN alexande_apflora.tblTPop ON (alexande_apflora.tblTPopMassnBer.TPopId = alexande_apflora.tblTPop.TPopId) AND (alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId)
WHERE alexande_apflora.tblTPopMassnBer.TPopMassnBerErfolgsbeurteilung=1
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbC4rTPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM ((alexande_apflora_views.vLetzterTPopMassnBericht INNER JOIN alexande_apflora.tblPop ON alexande_apflora_views.vLetzterTPopMassnBericht.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblTPopMassnBer ON (alexande_apflora_views.vLetzterTPopMassnBericht.MaxvonTPopMassnBerJahr = alexande_apflora.tblTPopMassnBer.TPopMassnBerJahr) AND (alexande_apflora_views.vLetzterTPopMassnBericht.TPopId = alexande_apflora.tblTPopMassnBer.TPopId)) INNER JOIN alexande_apflora.tblTPop ON (alexande_apflora.tblTPopMassnBer.TPopId = alexande_apflora.tblTPop.TPopId) AND (alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId)
WHERE (alexande_apflora.tblTPopMassnBer.TPopMassnBerErfolgsbeurteilung=2)
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbC5rTPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM ((alexande_apflora_views.vLetzterTPopMassnBericht INNER JOIN alexande_apflora.tblPop ON alexande_apflora_views.vLetzterTPopMassnBericht.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblTPopMassnBer ON (alexande_apflora_views.vLetzterTPopMassnBericht.MaxvonTPopMassnBerJahr = alexande_apflora.tblTPopMassnBer.TPopMassnBerJahr) AND (alexande_apflora_views.vLetzterTPopMassnBericht.TPopId = alexande_apflora.tblTPopMassnBer.TPopId)) INNER JOIN alexande_apflora.tblTPop ON (alexande_apflora.tblTPopMassnBer.TPopId = alexande_apflora.tblTPop.TPopId) AND (alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId)
WHERE alexande_apflora.tblTPopMassnBer.TPopMassnBerErfolgsbeurteilung=3
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbC6rTPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM ((alexande_apflora_views.vLetzterTPopMassnBericht INNER JOIN alexande_apflora.tblPop ON alexande_apflora_views.vLetzterTPopMassnBericht.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblTPopMassnBer ON (alexande_apflora_views.vLetzterTPopMassnBericht.MaxvonTPopMassnBerJahr = alexande_apflora.tblTPopMassnBer.TPopMassnBerJahr) AND (alexande_apflora_views.vLetzterTPopMassnBericht.TPopId = alexande_apflora.tblTPopMassnBer.TPopId)) INNER JOIN alexande_apflora.tblTPop ON (alexande_apflora.tblTPopMassnBer.TPopId = alexande_apflora.tblTPop.TPopId) AND (alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId)
WHERE alexande_apflora.tblTPopMassnBer.TPopMassnBerErfolgsbeurteilung=4
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbC7rTPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM ((alexande_apflora_views.vLetzterTPopMassnBericht INNER JOIN alexande_apflora.tblPop ON alexande_apflora_views.vLetzterTPopMassnBericht.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblTPopMassnBer ON (alexande_apflora_views.vLetzterTPopMassnBericht.TPopId = alexande_apflora.tblTPopMassnBer.TPopId) AND (alexande_apflora_views.vLetzterTPopMassnBericht.MaxvonTPopMassnBerJahr = alexande_apflora.tblTPopMassnBer.TPopMassnBerJahr)) INNER JOIN alexande_apflora.tblTPop ON (alexande_apflora.tblTPopMassnBer.TPopId = alexande_apflora.tblTPop.TPopId) AND (alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId)
WHERE alexande_apflora.tblTPopMassnBer.TPopMassnBerErfolgsbeurteilung=5
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW alexande_apflora_views.vJbA1lPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW alexande_apflora_views.vJbA2lPop AS
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblPop.PopHerkunft=100 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbA3lPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM (alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN alexande_apflora.tblAp ON alexande_apflora.tblPop.ApArtId = alexande_apflora.tblAp.ApArtId
WHERE (alexande_apflora.tblPop.PopHerkunft=210 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND (alexande_apflora.tblPop.PopBekanntSeit<alexande_apflora.tblAp.ApJahr Or alexande_apflora.tblPop.PopBekanntSeit Is Null))
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbA4lPop AS
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM (alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN alexande_apflora.tblAp ON alexande_apflora.tblPop.ApArtId = alexande_apflora.tblAp.ApArtId
WHERE alexande_apflora.tblPop.PopHerkunft=200 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopBekanntSeit>=alexande_apflora.tblAp.ApJahr
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbA5lPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblPop.PopHerkunft=201 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbA8lPop AS
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE (alexande_apflora.tblPop.PopHerkunft=101 Or alexande_apflora.tblPop.PopHerkunft=211) AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbA9lPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblPop.PopHerkunft=202 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbA1lTPop AS
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbA2lTPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblTPop.TPopHerkunft=100 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbA3lTPop AS
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM (alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN alexande_apflora.tblAp ON alexande_apflora.tblPop.ApArtId = alexande_apflora.tblAp.ApArtId
WHERE alexande_apflora.tblTPop.TPopHerkunft=210 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND (alexande_apflora.tblPop.PopBekanntSeit<alexande_apflora.tblAp.ApJahr Or alexande_apflora.tblPop.PopBekanntSeit Is Null)
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbA4lTPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM (alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN alexande_apflora.tblAp ON alexande_apflora.tblPop.ApArtId = alexande_apflora.tblAp.ApArtId
WHERE alexande_apflora.tblTPop.TPopHerkunft=200 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND (alexande_apflora.tblPop.PopBekanntSeit>=alexande_apflora.tblAp.ApJahr)
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbA5lTPop AS
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblTPop.TPopHerkunft=201 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbA8lTPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE (alexande_apflora.tblTPop.TPopHerkunft=101 Or alexande_apflora.tblTPop.TPopHerkunft=211) AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbA9lTPop AS
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblTPop.TPopHerkunft=202 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbB1lPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM (alexande_apflora.tblPop INNER JOIN (alexande_apflora.tblPopBer INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblPopBer.PopBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblPop.PopId = alexande_apflora.tblPopBer.PopId) INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbB2lPop AS
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM (alexande_apflora.tblPop INNER JOIN (alexande_apflora.tblPopBer INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblPopBer.PopBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblPop.PopId = alexande_apflora.tblPopBer.PopId) INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblPopBer.PopBerEntwicklung=3 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbB3lPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM (alexande_apflora.tblPop INNER JOIN (alexande_apflora.tblPopBer INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblPopBer.PopBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblPop.PopId = alexande_apflora.tblPopBer.PopId) INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblPopBer.PopBerEntwicklung=2 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbB4lPop AS
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM (alexande_apflora.tblPop INNER JOIN (alexande_apflora.tblPopBer INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblPopBer.PopBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblPop.PopId = alexande_apflora.tblPopBer.PopId) INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblPopBer.PopBerEntwicklung=1 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbB5lPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM (alexande_apflora.tblPop INNER JOIN (alexande_apflora.tblPopBer INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblPopBer.PopBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblPop.PopId = alexande_apflora.tblPopBer.PopId) INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE (alexande_apflora.tblPopBer.PopBerEntwicklung=4 Or alexande_apflora.tblPopBer.PopBerEntwicklung=9) AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbB6lPop AS
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM (alexande_apflora.tblPop INNER JOIN (alexande_apflora.tblPopBer INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblPopBer.PopBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblPop.PopId = alexande_apflora.tblPopBer.PopId) INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblPopBer.PopBerEntwicklung=8 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbB7lPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbB1lTPop AS
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM alexande_apflora.tblPop INNER JOIN (alexande_apflora.tblTPop INNER JOIN (alexande_apflora.tblTPopBer INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblTPopBer.TPopBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopBer.TPopId) ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbB2lTPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM alexande_apflora.tblPop INNER JOIN (alexande_apflora.tblTPop INNER JOIN (alexande_apflora.tblTPopBer INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblTPopBer.TPopBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopBer.TPopId) ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblTPopBer.TPopBerEntwicklung=3 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbB3lTPop AS
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM alexande_apflora.tblPop INNER JOIN (alexande_apflora.tblTPop INNER JOIN (alexande_apflora.tblTPopBer INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblTPopBer.TPopBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopBer.TPopId) ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblTPopBer.TPopBerEntwicklung=2 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbB4lTPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM alexande_apflora.tblPop INNER JOIN (alexande_apflora.tblTPop INNER JOIN (alexande_apflora.tblTPopBer INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblTPopBer.TPopBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopBer.TPopId) ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblTPopBer.TPopBerEntwicklung=1 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbB5lTPop AS
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM alexande_apflora.tblPop INNER JOIN (alexande_apflora.tblTPop INNER JOIN (alexande_apflora.tblTPopBer INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblTPopBer.TPopBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopBer.TPopId) ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE (alexande_apflora.tblTPopBer.TPopBerEntwicklung=4 Or alexande_apflora.tblTPopBer.TPopBerEntwicklung=9) AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbB6lTPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM alexande_apflora.tblPop INNER JOIN (alexande_apflora.tblTPop INNER JOIN (alexande_apflora.tblTPopBer INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblTPopBer.TPopBerJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopBer.TPopId) ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblTPopBer.TPopBerEntwicklung=8 AND alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbB7lTPop AS
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId
WHERE alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vJbC1lPop AS 
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId
FROM (alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN (alexande_apflora.tblTPopMassn INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblTPopMassn.TPopMassnJahr = alexande_apflora.tblKonstanten.JBerJahr) ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopMassn.TPopId
WHERE alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblPop.PopId;

CREATE OR REPLACE VIEW vJbC1lTPop AS
SELECT alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId
FROM ((alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN alexande_apflora.tblTPopMassn ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopMassn.TPopId) INNER JOIN alexande_apflora.tblKonstanten ON alexande_apflora.tblTPopMassn.TPopMassnJahr = alexande_apflora.tblKonstanten.JBerJahr
WHERE alexande_apflora.tblTPop.TPopApBerichtRelevant=1 AND alexande_apflora.tblPop.PopHerkunft <> 300
GROUP BY alexande_apflora.tblPop.ApArtId, alexande_apflora.tblTPop.TPopId;

CREATE OR REPLACE VIEW vAuswAnzProTPopAngezArtBestJahr0 AS 
SELECT alexande_apflora.tblAp.ApArtId, alexande_apflora.tblPop.PopId, alexande_apflora.tblTPop.TPopId, alexande_apflora.tblTPopKontr.TPopKontrId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblPop.PopName, alexande_apflora.domPopHerkunft.HerkunftTxt AS PopHerkunft, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPop.TPopGemeinde, alexande_apflora.tblTPop.TPopFlurname, domPopHerkunft_1.HerkunftTxt AS TPopHerkunft, alexande_apflora.tblTPopKontr.TPopKontrTyp, alexande_apflora.tblTPopKontr.TPopKontrJahr, alexande_apflora.tblTPopKontr.TPopKontrDatum, alexande_apflora.tblAdresse.AdrName AS TPopKontrBearb, alexande_apflora.tblTPopKontrZaehl.Anzahl, alexande_apflora.domTPopKontrZaehleinheit.ZaehleinheitTxt AS Zaehleinheit, alexande_apflora.domTPopKontrMethode.BeurteilTxt AS Methode, alexande_apflora.tblTPopKontr.TPopKontrJungpfl, alexande_apflora.tblTPopKontr.TPopKontrVitalitaet, alexande_apflora.tblTPopKontr.TPopKontrUeberleb, alexande_apflora.domTPopEntwicklung.EntwicklungTxt AS TPopKontrEntwicklung, alexande_apflora.tblTPopKontr.TPopKontrUrsach, alexande_apflora.tblTPopKontr.TPopKontrUrteil, alexande_apflora.tblTPopKontr.TPopKontrAendUms, alexande_apflora.tblTPopKontr.TPopKontrAendKontr, alexande_apflora.tblTPopKontr.TPopKontrTxt, alexande_apflora.tblTPopKontr.TPopKontrLeb, alexande_apflora.tblTPopKontr.TPopKontrFlaeche, alexande_apflora.tblTPopKontr.TPopKontrLebUmg, alexande_apflora.tblTPopKontr.TPopKontrStrauchschicht, alexande_apflora.tblTPopKontr.TPopKontrBodenTyp, alexande_apflora.tblTPopKontr.TPopKontrBodenAbtrag, alexande_apflora.tblTPopKontr.TPopKontrWasserhaushalt, alexande_apflora.tblTPopKontr.TPopKontrHandlungsbedarf, alexande_apflora.tblTPopKontr.TPopKontrUebFlaeche, alexande_apflora.tblTPopKontr.TPopKontrPlan, alexande_apflora.tblTPopKontr.TPopKontrVeg, alexande_apflora.tblTPopKontr.TPopKontrNaBo, alexande_apflora.tblTPopKontr.TPopKontrUebPfl, alexande_apflora.tblTPopKontr.TPopKontrJungPflJN, alexande_apflora.tblTPopKontr.TPopKontrVegHoeMax, alexande_apflora.tblTPopKontr.TPopKontrVegHoeMit, alexande_apflora.tblTPopKontr.TPopKontrGefaehrdung, alexande_apflora.tblTPopKontr.TPopKontrMutDat
FROM (((((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN (((alexande_apflora.tblAp INNER JOIN alexande_apflora.tblPop ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN alexande_apflora.tblTPopKontr ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopKontr.TPopId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = alexande_apflora.domPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.domPopHerkunft AS domPopHerkunft_1 ON alexande_apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPopKontr.TPopKontrBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.domTPopEntwicklung ON alexande_apflora.tblTPopKontr.TPopKontrEntwicklung = alexande_apflora.domTPopEntwicklung.EntwicklungCode) INNER JOIN alexande_apflora.tblTPopKontrZaehl ON alexande_apflora.tblTPopKontr.TPopKontrId = alexande_apflora.tblTPopKontrZaehl.TPopKontrId) INNER JOIN alexande_apflora.domTPopKontrMethode ON alexande_apflora.tblTPopKontrZaehl.Methode = alexande_apflora.domTPopKontrMethode.BeurteilCode) LEFT JOIN alexande_apflora.domTPopKontrZaehleinheit ON alexande_apflora.tblTPopKontrZaehl.Zaehleinheit = alexande_apflora.domTPopKontrZaehleinheit.ZaehleinheitCode;

CREATE OR REPLACE VIEW vAuswPopBerAngezArtBestJahr0 AS
SELECT alexande_apflora.tblAp.ApArtId, alexande_apflora.tblPop.PopId, alexande_apflora.tblPopBer.PopBerId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblPop.PopName, domPopHerkunft.HerkunftTxt AS PopHerkunft, alexande_apflora.tblPopBer.PopBerJahr, domPopEntwicklung.EntwicklungTxt AS PopBerEntwicklung, alexande_apflora.tblPopBer.PopBerTxt
FROM ((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN ((alexande_apflora.tblAp INNER JOIN alexande_apflora.tblPop ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblPopBer ON alexande_apflora.tblPop.PopId = alexande_apflora.tblPopBer.PopId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.domPopEntwicklung ON alexande_apflora.tblPopBer.PopBerEntwicklung = domPopEntwicklung.EntwicklungId;
 
CREATE OR REPLACE VIEW vApZiele AS 
SELECT alexande_apflora.tblAp.ApArtId AS "AP Id", alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblAdresse.AdrName AS "AP verantwortlich", alexande_apflora.tblZiel.ZielId AS "Ziel Id", alexande_apflora.tblZiel.ApArtId AS "Ziel ApId", alexande_apflora.tblZiel.ZielJahr AS "Ziel Jahr", domZielTyp.ZieltypTxt AS "Ziel Typ", alexande_apflora.tblZiel.ZielBezeichnung AS "Ziel Beschreibung"
FROM (((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAp.ApBearb = alexande_apflora.tblAdresse.AdrId) RIGHT JOIN alexande_apflora.tblZiel ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblZiel.ApArtId) LEFT JOIN alexande_apflora.domZielTyp ON alexande_apflora.tblZiel.ZielTyp = domZielTyp.ZieltypId
WHERE alexande_apflora.tblZiel.ZielTyp=1 Or alexande_apflora.tblZiel.ZielTyp=2 Or alexande_apflora.tblZiel.ZielTyp=1170775556
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblZiel.ZielJahr, domZielTyp.ZieltypTxt, alexande_apflora.tblZiel.ZielTyp;

CREATE OR REPLACE VIEW vApZieleOhneAp AS 
SELECT alexande_apflora.tblAp.ApArtId AS "AP Id", alexande_apflora.tblZiel.ZielId AS "Ziel Id", alexande_apflora.tblZiel.ApArtId AS "Ziel ApId", alexande_apflora.tblZiel.ZielJahr AS "Ziel Jahr", domZielTyp.ZieltypTxt AS "Ziel Typ", alexande_apflora.tblZiel.ZielBezeichnung AS "Ziel Beschreibung"
FROM (((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAp.ApBearb = alexande_apflora.tblAdresse.AdrId) RIGHT JOIN alexande_apflora.tblZiel ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblZiel.ApArtId) LEFT JOIN alexande_apflora.domZielTyp ON alexande_apflora.tblZiel.ZielTyp = domZielTyp.ZieltypId
WHERE alexande_apflora.tblAp.ApArtId is Null
ORDER BY alexande_apflora.tblZiel.ZielJahr, domZielTyp.ZieltypTxt, alexande_apflora.tblZiel.ZielTyp;

CREATE OR REPLACE VIEW vZielBer AS
SELECT alexande_apflora.tblAp.ApArtId AS "AP Id", alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblAdresse.AdrName AS "AP verantwortlich", alexande_apflora.tblZiel.ZielId AS "Ziel Id", alexande_apflora.tblZiel.ZielJahr AS "Ziel Jahr", domZielTyp.ZieltypTxt AS "Ziel Typ", alexande_apflora.tblZiel.ZielBezeichnung AS "Ziel Beschreibung", alexande_apflora.tblZielBer.ZielBerId AS "ZielBer Id", alexande_apflora.tblZielBer.ZielId AS "ZielBer ZielId", alexande_apflora.tblZielBer.ZielBerJahr AS "ZielBer Jahr", alexande_apflora.tblZielBer.ZielBerErreichung AS "ZielBer Erreichung", alexande_apflora.tblZielBer.ZielBerTxt AS "ZielBer Bemerkungen", alexande_apflora.tblZielBer.MutWann AS "ZielBer MutWann", alexande_apflora.tblZielBer.MutWer AS "ZielBer MutWer"
FROM ((((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAp.ApBearb = alexande_apflora.tblAdresse.AdrId) RIGHT JOIN alexande_apflora.tblZiel ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblZiel.ApArtId) LEFT JOIN alexande_apflora.domZielTyp ON alexande_apflora.tblZiel.ZielTyp = domZielTyp.ZieltypId) RIGHT JOIN alexande_apflora.tblZielBer ON alexande_apflora.tblZiel.ZielId = alexande_apflora.tblZielBer.ZielId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblZiel.ZielJahr, domZielTyp.ZieltypTxt, alexande_apflora.tblZiel.ZielTyp, alexande_apflora.tblZielBer.ZielBerJahr;

CREATE OR REPLACE VIEW vZielBerOhneZiel AS
SELECT alexande_apflora.tblAp.ApArtId AS "AP Id", alexande_apflora.tblZiel.ZielId AS "Ziel Id", alexande_apflora.tblZielBer.ZielBerId AS "ZielBer Id", alexande_apflora.tblZielBer.ZielId AS "ZielBer ZielId", alexande_apflora.tblZielBer.ZielBerJahr AS "ZielBer Jahr", alexande_apflora.tblZielBer.ZielBerErreichung AS "ZielBer Erreichung", alexande_apflora.tblZielBer.ZielBerTxt AS "ZielBer Bemerkungen", alexande_apflora.tblZielBer.MutWann AS "ZielBer MutWann", alexande_apflora.tblZielBer.MutWer AS "ZielBer MutWer"
FROM ((((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblAp.ApBearb = alexande_apflora.tblAdresse.AdrId) RIGHT JOIN alexande_apflora.tblZiel ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblZiel.ApArtId) LEFT JOIN alexande_apflora.domZielTyp ON alexande_apflora.tblZiel.ZielTyp = domZielTyp.ZieltypId) RIGHT JOIN alexande_apflora.tblZielBer ON alexande_apflora.tblZiel.ZielId = alexande_apflora.tblZielBer.ZielId
WHERE alexande_apflora.tblZiel.ZielId is Null
ORDER BY alexande_apflora.tblZiel.ZielTyp, alexande_apflora.tblZielBer.ZielBerJahr;

CREATE OR REPLACE VIEW vBerTPopFuerAngezeigteArt0 AS
SELECT alexande_apflora.tblAp.ApArtId, alexande_apflora.tblPop.PopId, alexande_apflora.tblTPop.TPopId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.domApBearbeitungsstand.DomainTxt AS ApStatus, alexande_apflora.tblAp.ApJahr, domApUmsetzung.DomainTxt AS ApUmsetzung, alexande_apflora.tblPop.PopNr, alexande_apflora.tblPop.PopName, domPopHerkunft.HerkunftTxt AS PopHerkunft, alexande_apflora.tblPop.PopBekanntSeit, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPop.TPopGemeinde, alexande_apflora.tblTPop.TPopFlurname, alexande_apflora.tblTPop.TPopXKoord, alexande_apflora.tblTPop.TPopYKoord, alexande_apflora.tblTPop.TPopBekanntSeit, domPopHerkunft_1.HerkunftTxt AS TPopHerkunft, alexande_apflora.tblTPop.TPopApBerichtRelevant
FROM ((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN ((alexande_apflora.tblAp INNER JOIN alexande_apflora.tblPop ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.domPopHerkunft AS domPopHerkunft_1 ON alexande_apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId;

CREATE OR REPLACE VIEW vKontr AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", alexande_apflora.domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", tblAdresse_1.AdrName AS "AP verantwortlich", alexande_apflora.tblPop.PopGuid AS "Pop Guid", alexande_apflora.tblPop.PopNr AS "Pop Nr", alexande_apflora.tblPop.PopName AS "Pop Name", alexande_apflora.domPopHerkunft.HerkunftTxt AS "Pop Herkunft", alexande_apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblTPop.TPopId AS "TPop ID", alexande_apflora.tblTPop.TPopGuid AS "TPop Guid", alexande_apflora.tblTPop.TPopNr AS "TPop Nr", alexande_apflora.tblTPop.TPopGemeinde AS "TPop Gemeinde", alexande_apflora.tblTPop.TPopFlurname AS "TPop Flurname", domPopHerkunft_1.HerkunftTxt AS "TPop Status", alexande_apflora.tblTPop.TPopBekanntSeit AS "TPop bekannt seit", alexande_apflora.tblTPop.TPopHerkunftUnklar AS "TPop Status unklar", alexande_apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "TPop Begründung für unklaren Status", alexande_apflora.tblTPop.TPopXKoord AS "TPop X-Koordinaten", alexande_apflora.tblTPop.TPopYKoord AS "TPop Y-Koordinaten", alexande_apflora.tblTPop.TPopRadius AS "TPop Radius m", alexande_apflora.tblTPop.TPopHoehe AS "TPop Höhe", alexande_apflora.tblTPop.TPopExposition AS "TPop Exposition", alexande_apflora.tblTPop.TPopKlima AS "TPop Klima", alexande_apflora.tblTPop.TPopNeigung AS "TPop Hangneigung", alexande_apflora.tblTPop.TPopBeschr AS "TPop Beschreibung", alexande_apflora.tblTPop.TPopKatNr AS "TPop Kataster-Nr", tblAdresse_2.AdrName AS "TPop verantwortlich", alexande_apflora.tblTPop.TPopApBerichtRelevant AS "TPop für AP-Bericht relevant", alexande_apflora.tblTPop.TPopEigen AS "TPop EigentümerIn", alexande_apflora.tblTPop.TPopKontakt AS "TPop Kontakt vor Ort", alexande_apflora.tblTPop.TPopNutzungszone AS "TPop Nutzungszone", alexande_apflora.tblTPop.TPopBewirtschafterIn AS "TPop BewirtschafterIn", alexande_apflora.tblTPop.TPopBewirtschaftung AS "TPop Bewirtschaftung", alexande_apflora.tblTPopKontr.TPopKontrId, alexande_apflora.tblTPopKontr.TPopId, alexande_apflora.tblTPopKontr.TPopKontrGuid AS "Kontr Guid", alexande_apflora.tblTPopKontr.TPopKontrJahr AS "Kontr Jahr", alexande_apflora.tblTPopKontr.TPopKontrDatum AS "Kontr Datum", alexande_apflora.domTPopFeldkontrTyp.DomainTxt AS "Kontr Typ", alexande_apflora.tblAdresse.AdrName AS "Kontr BearbeiterIn", alexande_apflora.tblTPopKontr.TPopKontrUeberleb AS "Kontr Überlebensrate", alexande_apflora.tblTPopKontr.TPopKontrVitalitaet AS "Kontr Vitalität", alexande_apflora.domPopEntwicklung.EntwicklungTxt AS "Kontr Entwicklung", alexande_apflora.tblTPopKontr.TPopKontrUrsach AS "Kontr Ursachen", alexande_apflora.tblTPopKontr.TPopKontrUrteil AS "Kontr Erfolgsbeurteilung", alexande_apflora.tblTPopKontr.TPopKontrAendUms AS "Kontr Änderungs-Vorschläge Umsetzung", alexande_apflora.tblTPopKontr.TPopKontrAendKontr AS "Kontr Änderungs-Vorschläge Kontrolle", alexande_apflora.tblTPop.TPopXKoord AS "Kontr X-Koord", alexande_apflora.tblTPop.TPopYKoord AS "Kontr Y-Koord", alexande_apflora.tblTPopKontr.TPopKontrTxt AS "Kontr Bemerkungen", alexande_apflora.tblTPopKontr.TPopKontrLeb AS "Kontr Lebensraum Delarze", alexande_apflora.tblTPopKontr.TPopKontrLebUmg AS "Kontr angrenzender Lebensraum Delarze", alexande_apflora.tblTPopKontr.TPopKontrVegTyp AS "Kontr Vegetationstyp", alexande_apflora.tblTPopKontr.TPopKontrKonkurrenz AS "Kontr Konkurrenz", alexande_apflora.tblTPopKontr.TPopKontrMoosschicht AS "Kontr Moosschicht", alexande_apflora.tblTPopKontr.TPopKontrKrautschicht AS "Kontr Krautschicht", alexande_apflora.tblTPopKontr.TPopKontrStrauchschicht AS "Kontr Strauchschicht", alexande_apflora.tblTPopKontr.TPopKontrBaumschicht AS "Kontr Baumschicht", alexande_apflora.tblTPopKontr.TPopKontrBodenTyp AS "Kontr Bodentyp", alexande_apflora.tblTPopKontr.TPopKontrBodenKalkgehalt AS "Kontr Boden Kalkgehalt", alexande_apflora.tblTPopKontr.TPopKontrBodenDurchlaessigkeit AS "Kontr Boden Durchlässigkeit", alexande_apflora.tblTPopKontr.TPopKontrBodenHumus AS "Kontr Boden Humusgehalt", alexande_apflora.tblTPopKontr.TPopKontrBodenNaehrstoffgehalt AS "Kontr Boden Nährstoffgehalt", alexande_apflora.tblTPopKontr.TPopKontrBodenAbtrag AS "Kontr Oberbodenabtrag", alexande_apflora.tblTPopKontr.TPopKontrWasserhaushalt AS "Kontr Wasserhaushalt", alexande_apflora.domTPopKontrIdBiotUebereinst.DomainTxt AS "Kontr Übereinstimmung mit Idealbiotop", alexande_apflora.tblTPopKontr.TPopKontrHandlungsbedarf AS "Kontr Handlungsbedarf", alexande_apflora.tblTPopKontr.TPopKontrUebFlaeche AS "Kontr ÜberprÜfte Fläche", alexande_apflora.tblTPopKontr.TPopKontrFlaeche AS "Kontr Fläche der Teilpopulation m2", alexande_apflora.tblTPopKontr.TPopKontrPlan AS "Kontr auf Plan eingezeichnet", alexande_apflora.tblTPopKontr.TPopKontrVeg AS "Kontr Deckung durch Vegetation", alexande_apflora.tblTPopKontr.TPopKontrNaBo AS "Kontr Deckung nackter Boden", alexande_apflora.tblTPopKontr.TPopKontrUebPfl AS "Kontr Deckung durch überprüfte Art", alexande_apflora.tblTPopKontr.TPopKontrJungPflJN AS "Kontr auch junge Pflanzen", alexande_apflora.tblTPopKontr.TPopKontrVegHoeMax AS "Kontr maximale Veg-höhe cm", alexande_apflora.tblTPopKontr.TPopKontrVegHoeMit AS "Kontr mittlere Veg-höhe cm", alexande_apflora.tblTPopKontr.TPopKontrGefaehrdung AS "Kontr Gefährdung", alexande_apflora.tblTPopKontr.MutWann AS "Kontrolle zuletzt geändert", alexande_apflora.tblTPopKontr.MutWer AS "Kontrolle zuletzt geändert von"
FROM alexande_apflora.domPopHerkunft AS domPopHerkunft_1 RIGHT JOIN (alexande_apflora.tblAdresse AS tblAdresse_2 RIGHT JOIN (((((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN (alexande_apflora.tblPop INNER JOIN (alexande_apflora.tblTPop INNER JOIN (((alexande_apflora.tblTPopKontr LEFT JOIN alexande_apflora.domTPopFeldkontrTyp ON alexande_apflora.tblTPopKontr.TPopKontrTyp = alexande_apflora.domTPopFeldkontrTyp.DomainTxt) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPopKontr.TPopKontrBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.domPopEntwicklung ON alexande_apflora.tblTPopKontr.TPopKontrEntwicklung = alexande_apflora.domPopEntwicklung.EntwicklungId) ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopKontr.TPopId) ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = alexande_apflora.domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = alexande_apflora.domPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.domTPopKontrIdBiotUebereinst ON alexande_apflora.tblTPopKontr.TPopKontrIdealBiotopUebereinst = alexande_apflora.domTPopKontrIdBiotUebereinst.DomainCode) LEFT JOIN alexande_apflora.tblAdresse AS tblAdresse_1 ON alexande_apflora.tblAp.ApBearb = tblAdresse_1.AdrId) ON tblAdresse_2.AdrId = alexande_apflora.tblTPop.TPopVerantw) ON domPopHerkunft_1.HerkunftId = alexande_apflora.tblTPop.TPopHerkunft
WHERE alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId Not In (100,150)
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblTPop.TPopNr;

CREATE OR REPLACE VIEW vKontrLetzte AS
SELECT * FROM alexande_apflora_views.vKontr INNER JOIN alexande_apflora_views.vKontrLetzteId ON alexande_apflora_views.vKontr.TPopKontrId = alexande_apflora_views.vKontrLetzteId.MaxTPopKontrId;

#funktioniert nicht, wenn letzeKontrolle als Unterabfrage eingebunden wird. Grund: Unterabfragen in der FROM-Klausel dürfen keine korrelierten Unterabfragen sein
CREATE OR REPLACE VIEW vTPopAnzKontrInklLetzteKontr AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPop.PopGuid AS "Pop Guid", alexande_apflora.tblPop.PopNr AS "Pop Nr", alexande_apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblTPop.TPopId AS "TPop ID", alexande_apflora.tblTPop.TPopGuid AS "TPop Guid", alexande_apflora.tblTPop.TPopNr AS "TPop Nr", alexande_apflora.tblTPop.TPopGemeinde AS "TPop Gemeinde", alexande_apflora.tblTPop.TPopFlurname AS "TPop Flurname", domPopHerkunft_1.HerkunftTxt AS "TPop Status", alexande_apflora.tblTPop.TPopBekanntSeit AS "TPop bekannt seit", alexande_apflora.tblTPop.TPopHerkunftUnklar AS "TPop Status unklar", alexande_apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "TPop Begründung für unklaren Status", alexande_apflora.tblTPop.TPopXKoord AS "TPop X-Koordinaten", alexande_apflora.tblTPop.TPopYKoord AS "TPop Y-Koordinaten", alexande_apflora.tblTPop.TPopRadius AS "TPop Radius (m)", alexande_apflora.tblTPop.TPopHoehe AS "TPop Höhe", alexande_apflora.tblTPop.TPopExposition AS "TPop Exposition", alexande_apflora.tblTPop.TPopKlima AS "TPop Klima", alexande_apflora.tblTPop.TPopNeigung AS "TPop Hangneigung", alexande_apflora.tblTPop.TPopBeschr AS "TPop Beschreibung", alexande_apflora.tblTPop.TPopKatNr AS "TPop Kataster-Nr", alexande_apflora.tblAdresse.AdrName AS "TPop Verantwortlich", alexande_apflora.tblTPop.TPopApBerichtRelevant AS "TPop für AP-Bericht relevant", alexande_apflora.tblTPop.TPopEigen AS "TPop EigentümerIn", alexande_apflora.tblTPop.TPopKontakt AS "TPop Kontakt vor Ort", alexande_apflora.tblTPop.TPopNutzungszone AS "TPop Nutzungszone", alexande_apflora.tblTPop.TPopBewirtschafterIn AS "TPop BewirtschafterIn", alexande_apflora.tblTPop.TPopBewirtschaftung AS "TPop Bewirtschaftung", alexande_apflora.tblTPop.MutWann AS "Teilpopulation zuletzt geändert", alexande_apflora.tblTPop.MutWann AS "Teilpopulation zuletzt geändert von", (SELECT Count(*) FROM alexande_apflora.tblTPopKontr WHERE alexande_apflora.tblTPopKontr.TPopId = alexande_apflora.tblTPop.TPopId) AS "Anzahl Kontrollen", (SELECT Count(*) FROM alexande_apflora.tblTPopKontr WHERE alexande_apflora.tblTPopKontr.TPopId = alexande_apflora.tblTPop.TPopId AND alexande_apflora.tblTPopKontr.TPopKontrTyp<>"Freiwilligen-Erfolgskontrolle") AS "Anzahl Feld-Kontrollen", (SELECT Count(*) FROM alexande_apflora.tblTPopKontr WHERE alexande_apflora.tblTPopKontr.TPopId = alexande_apflora.tblTPop.TPopId AND alexande_apflora.tblTPopKontr.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AS "Anzahl Freiwilligen-Kontrollen", vKontrLetzte.`Kontr Guid`, vKontrLetzte.`Kontr Jahr`, vKontrLetzte.`Kontr Datum`, vKontrLetzte.`Kontr Typ`, vKontrLetzte.`Kontr BearbeiterIn`, vKontrLetzte.`Kontr Zähleinheit 1`, vKontrLetzte.`Kontr Methode 1`, vKontrLetzte.`Kontr Anzahl 1`, vKontrLetzte.`Kontr Zähleinheit 2`, vKontrLetzte.`Kontr Methode 2`, vKontrLetzte.`Kontr Anzahl 2`, vKontrLetzte.`Kontr Zähleinheit 3`, vKontrLetzte.`Kontr Methode 3`, vKontrLetzte.`Kontr Anzahl 3`, vKontrLetzte.`Kontr Überlebensrate`, vKontrLetzte.`Kontr Vitalität`, vKontrLetzte.`Kontr Entwicklung`, vKontrLetzte.`Kontr Ursachen`, vKontrLetzte.`Kontr Erfolgsbeurteilung`, vKontrLetzte.`Kontr Änderungs-Vorschläge Umsetzung`, vKontrLetzte.`Kontr Änderungs-Vorschläge Kontrolle`, vKontrLetzte.`Kontr X-Koord`, vKontrLetzte.`Kontr Y-Koord`, vKontrLetzte.`Kontr Bemerkungen`, vKontrLetzte.`Kontr Lebensraum Delarze`, vKontrLetzte.`Kontr angrenzender Lebensraum Delarze`, vKontrLetzte.`Kontr Vegetationstyp`, vKontrLetzte.`Kontr Konkurrenz`, vKontrLetzte.`Kontr Moosschicht`, vKontrLetzte.`Kontr Krautschicht`, vKontrLetzte.`Kontr Strauchschicht`, vKontrLetzte.`Kontr Baumschicht`, vKontrLetzte.`Kontr Bodentyp`, vKontrLetzte.`Kontr Boden Kalkgehalt`, vKontrLetzte.`Kontr Boden Durchlässigkeit`, vKontrLetzte.`Kontr Boden Humusgehalt`, vKontrLetzte.`Kontr Boden Nährstoffgehalt`, vKontrLetzte.`Kontr Oberbodenabtrag`, vKontrLetzte.`Kontr Wasserhaushalt`, vKontrLetzte.`Kontr Übereinstimmung mit Idealbiotop`, vKontrLetzte.`Kontr Handlungsbedarf`, vKontrLetzte.`Kontr ÜberprÜfte Fläche`, vKontrLetzte.`Kontr Fläche der Teilpopulation m2`, vKontrLetzte.`Kontr auf Plan eingezeichnet`, vKontrLetzte.`Kontr Deckung durch Vegetation`, vKontrLetzte.`Kontr Deckung nackter Boden`, vKontrLetzte.`Kontr Deckung durch überprüfte Art`, vKontrLetzte.`Kontr auch junge Pflanzen`, vKontrLetzte.`Kontr maximale Veg-höhe cm`, vKontrLetzte.`Kontr mittlere Veg-höhe cm`, vKontrLetzte.`Kontr Gefährdung`, vKontrLetzte.`Kontrolle zuletzt geändert`, vKontrLetzte.`Kontrolle zuletzt geändert von`
FROM ((((((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) RIGHT JOIN alexande_apflora.tblPop ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) RIGHT JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = alexande_apflora.domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = alexande_apflora.domPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.domPopHerkunft AS domPopHerkunft_1 ON alexande_apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId) LEFT JOIN alexande_apflora_views.vKontrLetzte ON alexande_apflora.tblTPop.TPopId = alexande_apflora_views.vKontrLetzte.TPopId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPop.TPopVerantw = alexande_apflora.tblAdresse.AdrId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblTPop.TPopNr;

CREATE OR REPLACE VIEW vKontrFuerGis AS
SELECT alexande_apflora.tblAp.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS Artname, alexande_apflora.domApBearbeitungsstand.DomainTxt AS ApStatus, alexande_apflora.tblAp.ApJahr, alexande_apflora.domApUmsetzung.DomainTxt AS ApUmsetzung, alexande_apflora.tblPop.PopGuid, alexande_apflora.tblPop.PopNr, alexande_apflora.tblPop.PopName, alexande_apflora.domPopHerkunft.HerkunftTxt AS PopHerkunft, alexande_apflora.tblPop.PopBekanntSeit, alexande_apflora.tblTPop.TPopGuid, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPop.TPopGemeinde, alexande_apflora.tblTPop.TPopFlurname, alexande_apflora.tblTPop.TPopXKoord, alexande_apflora.tblTPop.TPopYKoord, alexande_apflora.tblTPop.TPopBekanntSeit, alexande_apflora.tblTPopKontr.TPopKontrGuid, alexande_apflora.tblTPopKontr.TPopKontrJahr, alexande_apflora.tblTPopKontr.TPopKontrDatum, alexande_apflora.domTPopFeldkontrTyp.DomainTxt AS TPopKontrTyp, alexande_apflora.tblAdresse.AdrName AS TPopKontrBearb, alexande_apflora.tblTPopKontr.TPopKontrUeberleb, alexande_apflora.tblTPopKontr.TPopKontrVitalitaet, alexande_apflora.domPopEntwicklung.EntwicklungTxt AS TPopKontrEntwicklung, alexande_apflora.tblTPopKontr.TPopKontrUrsach, alexande_apflora.tblTPopKontr.TPopKontrUrteil, alexande_apflora.tblTPopKontr.TPopKontrAendUms, alexande_apflora.tblTPopKontr.TPopKontrAendKontr, alexande_apflora.tblTPop.TPopXKoord AS X, alexande_apflora.tblTPop.TPopYKoord AS Y, alexande_apflora.tblTPopKontr.TPopKontrLeb, alexande_apflora.tblTPopKontr.TPopKontrFlaeche, alexande_apflora.tblTPopKontr.TPopKontrLebUmg, alexande_apflora.tblTPopKontr.TPopKontrVegTyp, alexande_apflora.tblTPopKontr.TPopKontrKonkurrenz, alexande_apflora.tblTPopKontr.TPopKontrMoosschicht, alexande_apflora.tblTPopKontr.TPopKontrKrautschicht, alexande_apflora.tblTPopKontr.TPopKontrStrauchschicht, alexande_apflora.tblTPopKontr.TPopKontrBaumschicht, alexande_apflora.tblTPopKontr.TPopKontrBodenTyp, alexande_apflora.tblTPopKontr.TPopKontrBodenKalkgehalt, alexande_apflora.tblTPopKontr.TPopKontrBodenDurchlaessigkeit, alexande_apflora.tblTPopKontr.TPopKontrBodenHumus, alexande_apflora.tblTPopKontr.TPopKontrBodenNaehrstoffgehalt, alexande_apflora.tblTPopKontr.TPopKontrBodenAbtrag, alexande_apflora.tblTPopKontr.TPopKontrWasserhaushalt, alexande_apflora.domTPopKontrIdBiotUebereinst.DomainTxt AS TPopKontrIdealBiotopUebereinst, alexande_apflora.tblTPopKontr.TPopKontrUebFlaeche, alexande_apflora.tblTPopKontr.TPopKontrPlan, alexande_apflora.tblTPopKontr.TPopKontrVeg, alexande_apflora.tblTPopKontr.TPopKontrNaBo, alexande_apflora.tblTPopKontr.TPopKontrUebPfl, alexande_apflora.tblTPopKontr.TPopKontrJungPflJN, alexande_apflora.tblTPopKontr.TPopKontrVegHoeMax, alexande_apflora.tblTPopKontr.TPopKontrVegHoeMit, alexande_apflora.tblTPopKontr.TPopKontrGefaehrdung, alexande_apflora.tblTPopKontr.MutWann, alexande_apflora.tblTPopKontr.MutWer
FROM (((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN (alexande_apflora.tblPop INNER JOIN (alexande_apflora.tblTPop INNER JOIN (((alexande_apflora.tblTPopKontr LEFT JOIN alexande_apflora.domTPopFeldkontrTyp ON alexande_apflora.tblTPopKontr.TPopKontrTyp = alexande_apflora.domTPopFeldkontrTyp.DomainTxt) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPopKontr.TPopKontrBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.domPopEntwicklung ON alexande_apflora.tblTPopKontr.TPopKontrEntwicklung = alexande_apflora.domPopEntwicklung.EntwicklungId) ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopKontr.TPopId) ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = alexande_apflora.domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = alexande_apflora.domPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.domTPopKontrIdBiotUebereinst ON alexande_apflora.tblTPopKontr.TPopKontrIdealBiotopUebereinst = alexande_apflora.domTPopKontrIdBiotUebereinst.DomainCode
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPopKontr.TPopKontrJahr, alexande_apflora.tblTPopKontr.TPopKontrDatum;


CREATE OR REPLACE VIEW vKontrOhneTPop AS
SELECT alexande_apflora.tblTPopKontr.TPopKontrGuid AS "Kontr Guid", alexande_apflora.tblTPopKontr.TPopKontrJahr AS "Kontr Jahr", alexande_apflora.tblTPopKontr.TPopKontrDatum AS "Kontr Datum", alexande_apflora.domTPopFeldkontrTyp.DomainTxt AS "Kontr Typ", alexande_apflora.tblAdresse.AdrName AS "Kontr BearbeiterIn", alexande_apflora.tblTPopKontr.TPopKontrUeberleb AS "Kontr Überlebensrate", alexande_apflora.tblTPopKontr.TPopKontrVitalitaet AS "Kontr Vitalität", alexande_apflora.domPopEntwicklung.EntwicklungTxt AS "Kontr Entwicklung", alexande_apflora.tblTPopKontr.TPopKontrUrsach AS "Kontr Ursachen", alexande_apflora.tblTPopKontr.TPopKontrUrteil AS "Kontr Erfolgsbeurteilung", alexande_apflora.tblTPopKontr.TPopKontrAendUms AS "Kontr Änderungs-Vorschläge Umsetzung", alexande_apflora.tblTPopKontr.TPopKontrAendKontr AS "Kontr Änderungs-Vorschläge Kontrolle", alexande_apflora.tblTPop.TPopXKoord AS "Kontr X-Koord", alexande_apflora.tblTPop.TPopYKoord AS "Kontr Y-Koord", alexande_apflora.tblTPopKontr.TPopKontrTxt AS "Kontr Bemerkungen", alexande_apflora.tblTPopKontr.TPopKontrLeb AS "Kontr Lebensraum Delarze", alexande_apflora.tblTPopKontr.TPopKontrLebUmg AS "Kontr angrenzender Lebensraum Delarze", alexande_apflora.tblTPopKontr.TPopKontrVegTyp AS "Kontr Vegetationstyp", alexande_apflora.tblTPopKontr.TPopKontrKonkurrenz AS "Kontr Konkurrenz", alexande_apflora.tblTPopKontr.TPopKontrMoosschicht AS "Kontr Moosschicht", alexande_apflora.tblTPopKontr.TPopKontrKrautschicht AS "Kontr Krautschicht", alexande_apflora.tblTPopKontr.TPopKontrStrauchschicht AS "Kontr Strauchschicht", alexande_apflora.tblTPopKontr.TPopKontrBaumschicht AS "Kontr Baumschicht", alexande_apflora.tblTPopKontr.TPopKontrBodenTyp AS "Kontr Bodentyp", alexande_apflora.tblTPopKontr.TPopKontrBodenKalkgehalt AS "Kontr Boden Kalkgehalt", alexande_apflora.tblTPopKontr.TPopKontrBodenDurchlaessigkeit AS "Kontr Boden Durchlässigkeit", alexande_apflora.tblTPopKontr.TPopKontrBodenHumus AS "Kontr Boden Humusgehalt", alexande_apflora.tblTPopKontr.TPopKontrBodenNaehrstoffgehalt AS "Kontr Boden Nährstoffgehalt", alexande_apflora.tblTPopKontr.TPopKontrBodenAbtrag AS "Kontr Oberbodenabtrag", alexande_apflora.tblTPopKontr.TPopKontrWasserhaushalt AS "Kontr Wasserhaushalt", alexande_apflora.domTPopKontrIdBiotUebereinst.DomainTxt AS "Kontr Übereinstimmung mit Idealbiotop", alexande_apflora.tblTPopKontr.TPopKontrHandlungsbedarf AS "Kontr Handlungsbedarf", alexande_apflora.tblTPopKontr.TPopKontrUebFlaeche AS "Kontr ÜberprÜfte Fläche", alexande_apflora.tblTPopKontr.TPopKontrFlaeche AS "Kontr Fläche der Teilpopulation m2", alexande_apflora.tblTPopKontr.TPopKontrPlan AS "Kontr auf Plan eingezeichnet", alexande_apflora.tblTPopKontr.TPopKontrVeg AS "Kontr Deckung durch Vegetation", alexande_apflora.tblTPopKontr.TPopKontrNaBo AS "Kontr Deckung nackter Boden", alexande_apflora.tblTPopKontr.TPopKontrUebPfl AS "Kontr Deckung durch überprüfte Art", alexande_apflora.tblTPopKontr.TPopKontrJungPflJN AS "Kontr auch junge Pflanzen", alexande_apflora.tblTPopKontr.TPopKontrVegHoeMax AS "Kontr maximale Veg-höhe cm", alexande_apflora.tblTPopKontr.TPopKontrVegHoeMit AS "Kontr mittlere Veg-höhe cm", alexande_apflora.tblTPopKontr.TPopKontrGefaehrdung AS "Kontr Gefährdung", alexande_apflora.tblTPopKontr.MutWann AS "Datensatz zuletzt geändert", alexande_apflora.tblTPopKontr.MutWer AS "Datensatz zuletzt geändert von"
FROM (alexande_apflora.tblTPop RIGHT JOIN (((alexande_apflora.tblTPopKontr LEFT JOIN alexande_apflora.domTPopFeldkontrTyp ON alexande_apflora.tblTPopKontr.TPopKontrTyp = alexande_apflora.domTPopFeldkontrTyp.DomainTxt) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPopKontr.TPopKontrBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.domPopEntwicklung ON alexande_apflora.tblTPopKontr.TPopKontrEntwicklung = alexande_apflora.domPopEntwicklung.EntwicklungId) ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopKontr.TPopId) LEFT JOIN alexande_apflora.domTPopKontrIdBiotUebereinst ON alexande_apflora.tblTPopKontr.TPopKontrIdealBiotopUebereinst = alexande_apflora.domTPopKontrIdBiotUebereinst.DomainCode
WHERE alexande_apflora.tblTPop.TPopId Is Null;

CREATE OR REPLACE VIEW vBeob AS
SELECT alexande_beob.tblBeobInfospezies.NO_NOTE, "" AS "ID_EVAB", alexande_beob.tblBeobInfospezies.NO_ISFS, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopGuid, alexande_apflora.tblPop.PopNr, alexande_apflora.tblTPop.TPopGuid, alexande_apflora.tblTPop.TPopNr, alexande_beob.tblBeobInfospezies.PROJET, alexande_beob.tblBeobInfospezies.NOM_COMMUNE, alexande_beob.tblBeobInfospezies.DESC_LOCALITE, alexande_beob.tblBeobInfospezies.FNS_XGIS AS X, alexande_beob.tblBeobInfospezies.FNS_YGIS AS Y, IF (alexande_beob.tblBeobInfospezies.FNS_XGIS>0 AND alexande_apflora.tblTPop.TPopXKoord>0 AND alexande_beob.tblBeobInfospezies.FNS_YGIS>0 AND alexande_apflora.tblTPop.TPopYKoord>0, ROUND(SQRT((alexande_beob.tblBeobInfospezies.FNS_XGIS-alexande_apflora.tblTPop.TPopXKoord)*(alexande_beob.tblBeobInfospezies.FNS_XGIS-alexande_apflora.tblTPop.TPopXKoord)+(alexande_beob.tblBeobInfospezies.FNS_YGIS-alexande_apflora.tblTPop.TPopYKoord)*(alexande_beob.tblBeobInfospezies.FNS_YGIS-alexande_apflora.tblTPop.TPopYKoord)), 0), null) AS "Distanz zur Teilpopulation (m)"
, alexande_beob.tblBeobBereitgestellt.Datum, alexande_beob.tblBeobBereitgestellt.Autor, alexande_apflora.tblBeobZuordnung.beobNichtZuordnen, alexande_apflora.tblBeobZuordnung.BeobBemerkungen, alexande_apflora.tblBeobZuordnung.BeobMutWann, alexande_apflora.tblBeobZuordnung.BeobMutWer 
FROM ((alexande_beob.tblBeobInfospezies INNER JOIN alexande_beob.tblBeobBereitgestellt ON alexande_beob.tblBeobInfospezies.NO_NOTE = alexande_beob.tblBeobBereitgestellt.NO_NOTE) INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON alexande_beob.tblBeobInfospezies.NO_ISFS = alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId) INNER JOIN ((alexande_apflora.tblPop RIGHT JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) RIGHT JOIN alexande_apflora.tblBeobZuordnung ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblBeobZuordnung.TPopId) ON alexande_beob.tblBeobInfospezies.NO_NOTE = alexande_apflora.tblBeobZuordnung.NO_NOTE 
UNION SELECT "" AS "NO_NOTE", alexande_beob.tblBeobEvab.NO_NOTE_PROJET AS "ID_EVAB", alexande_beob.tblBeobEvab.NO_ISFS, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopGuid, alexande_apflora.tblPop.PopNr, alexande_apflora.tblTPop.TPopGuid, alexande_apflora.tblTPop.TPopNr, alexande_beob.tblBeobEvab.Projekt_ZH AS PROJET, alexande_beob.tblBeobEvab.NOM_COMMUNE, alexande_beob.tblBeobEvab.DESC_LOCALITE_ AS DESC_LOCALITE, alexande_beob.tblBeobEvab.COORDONNEE_FED_E AS X, alexande_beob.tblBeobEvab.COORDONNEE_FED_N AS Y, IF (alexande_beob.tblBeobEvab.COORDONNEE_FED_E>0 AND alexande_apflora.tblTPop.TPopXKoord>0 AND alexande_beob.tblBeobEvab.COORDONNEE_FED_N>0 AND alexande_apflora.tblTPop.TPopYKoord>0, ROUND(SQRT((alexande_beob.tblBeobEvab.COORDONNEE_FED_E-alexande_apflora.tblTPop.TPopXKoord)*(alexande_beob.tblBeobEvab.COORDONNEE_FED_E-alexande_apflora.tblTPop.TPopXKoord)+(alexande_beob.tblBeobEvab.COORDONNEE_FED_N-alexande_apflora.tblTPop.TPopYKoord)*(alexande_beob.tblBeobEvab.COORDONNEE_FED_N-alexande_apflora.tblTPop.TPopYKoord)), 0), null) AS "Distanz zur Teilpopulation (m)", alexande_beob.tblBeobBereitgestellt.Datum, alexande_beob.tblBeobBereitgestellt.Autor, alexande_apflora.tblBeobZuordnung.beobNichtZuordnen, alexande_apflora.tblBeobZuordnung.BeobBemerkungen, alexande_apflora.tblBeobZuordnung.BeobMutWann, alexande_apflora.tblBeobZuordnung.BeobMutWer 
FROM ((alexande_beob.tblBeobBereitgestellt INNER JOIN alexande_beob.tblBeobEvab ON alexande_beob.tblBeobBereitgestellt.NO_NOTE_PROJET = alexande_beob.tblBeobEvab.NO_NOTE_PROJET) INNER JOIN ((alexande_apflora.tblPop RIGHT JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) RIGHT JOIN alexande_apflora.tblBeobZuordnung ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblBeobZuordnung.TPopId) ON alexande_beob.tblBeobEvab.NO_NOTE_PROJET = alexande_apflora.tblBeobZuordnung.NO_NOTE) INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON alexande_beob.tblBeobEvab.NO_ISFS = alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId 
ORDER BY Artname ASC, PopNr ASC, TPopNr ASC, Datum DESC;

CREATE OR REPLACE VIEW vExportNachEvab_Alle AS 
SELECT alexande_beob.ArtenDb_Arteigenschaften.GUID AS "Projekt_Id", CONCAT("AP Flora ZH: ", alexande_beob.ArtenDb_Arteigenschaften.Artname) AS "Projekt_Name", CAST(IF(alexande_apflora.tblAp.ApJahr Is Not Null,CONCAT("01.01.", alexande_apflora.tblAp.ApJahr),"") AS CHAR) AS "Projekt_Eröffnung", "Topos" AS "Projekt_Autor", CAST(CONCAT("Aktionsplan: ", alexande_apflora.domApBearbeitungsstand.DomainTxt, IF(alexande_apflora.tblAp.ApJahr Is Not Null,CONCAT("; Start im Jahr: ", alexande_apflora.tblAp.ApJahr),""), IF(alexande_apflora.tblAp.ApUmsetzung Is Not Null,CONCAT("; Stand Umsetzung: ", domApUmsetzung.DomainTxt),"")) AS CHAR) AS "Projekt_Bemerkungen", alexande_apflora.tblPop.PopGuid AS "Raum_Id", CAST(CONCAT(alexande_apflora.tblPop.PopName, IF(alexande_apflora.tblPop.PopNr Is Not Null,CONCAT(" (Nr. ", alexande_apflora.tblPop.PopNr, ")"),"")) AS CHAR) AS "Raum_Name", CAST(IF(alexande_apflora.tblPop.PopHerkunft Is Not Null,CONCAT("Status: ", domPopHerkunft.HerkunftTxt, IF(alexande_apflora.tblPop.PopBekanntSeit Is Not Null,CONCAT("; Bekannt seit: ", alexande_apflora.tblPop.PopBekanntSeit),"")),"") AS CHAR) AS "Raum_Bemerkungen", alexande_apflora.tblTPop.TPopGuid AS "Ort_Id", CAST(CONCAT(alexande_apflora.tblTPop.TPopFlurname, IF(alexande_apflora.tblTPop.TPopNr Is Not Null,CONCAT(" (Nr. ", alexande_apflora.tblTPop.TPopNr, ")"),"")) AS CHAR) AS "Ort_Name", alexande_apflora.tblTPop.TPopHoehe AS "Ort_ObergrenzeHöhe", alexande_apflora.tblTPop.TPopXKoord AS "Ort_X", alexande_apflora.tblTPop.TPopYKoord AS "Ort_Y", "+-20m" AS "Ort_Genauigkeit", alexande_apflora.tblTPop.TPopGemeinde AS "Ort_Gemeinde", alexande_apflora.tblTPop.TPopFlurname AS "Ort_Flurname", alexande_apflora.tblTPop.TPopExposition AS "Ort_Exposition", alexande_apflora.tblTPop.TPopNeigung AS "Ort_Hangneigung", alexande_apflora.tblTPopKontr.TPopKontrLeb AS "Ort_Lebensraum", alexande_apflora.tblTPopKontr.TPopKontrLebUmg AS "Ort_UmgebungDelarze", alexande_apflora.tblTPopKontr.ZeitGuid AS "Zeit_Id", CAST(IF(alexande_apflora.tblTPopKontr.TPopKontrDatum Is Not Null,CONCAT(alexande_apflora.tblTPopKontr.TPopKontrDatum,"01.01.", alexande_apflora.tblTPopKontr.TPopKontrJahr),"") AS CHAR) AS "Zeit_Datum", CAST(IF(alexande_apflora.tblTPopKontr.TPopKontrDatum Is Not Null,"Tag","Jahr") AS CHAR) AS "Zeit_GenauigkeitDatum", alexande_apflora.tblTPopKontr.TPopKontrMoosschicht AS "Zeit_DeckungMoose", alexande_apflora.tblTPopKontr.TPopKontrKrautschicht AS "Zeit_DeckungKräuter", alexande_apflora.tblTPopKontr.TPopKontrStrauchschicht AS "Zeit_DeckungSträucher", alexande_apflora.tblTPopKontr.TPopKontrBaumschicht AS "Zeit_DeckungBäume", alexande_apflora.tblTPopKontr.TPopKontrGuid AS "Beob_Id", alexande_apflora.tblAdresse.AdrName AS "Beob_BeobachterinName", alexande_apflora.tblAp.ApArtId AS "Beob_NR", alexande_beob.ArtenDb_Arteigenschaften.Artname AS "Beob_WissenschArtname", alexande_beob.ArtenDb_Arteigenschaften.NameDeutsch AS "Beob_DeutscherArtname", "Feldbeobachtung" AS "Beob_TypDerMeldung", domPopHerkunft_1.ZdsfHerkunft AS "Beob_Herkunft", domPopHerkunft_1.ZdsfVorhanden AS "Beob_Vorhandensein", alexande_apflora.tblTPopKontr.TPopKontrGefaehrdung AS "Beob_Gefährdung", alexande_apflora.tblTPopKontr.TPopKontrVitalitaet AS "Beob_VitalitätPflanze", alexande_apflora.tblTPop.TPopBeschr AS "Beob_BeschreibungStandort"
FROM ((((((((alexande_apflora.tblAp INNER JOIN alexande_apflora.tblPop ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN alexande_apflora.tblTPopKontr ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopKontr.TPopId) INNER JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON alexande_apflora.tblAp.ApArtId = alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPopKontr.TPopKontrBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.domPopHerkunft AS domPopHerkunft_1 ON alexande_apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId
WHERE ((alexande_apflora.tblTPop.TPopXKoord Is Not Null) AND (alexande_apflora.tblTPop.TPopYKoord Is Not Null) AND (alexande_apflora.tblTPopKontr.TPopKontrDatum Is Not Null) AND (alexande_apflora.tblTPopKontr.TPopKontrTyp="Zwischenbeurteilung" Or alexande_apflora.tblTPopKontr.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (alexande_apflora.tblTPop.TPopHerkunft<>201)) OR ((alexande_apflora.tblTPop.TPopXKoord Is Not Null) AND (alexande_apflora.tblTPop.TPopYKoord Is Not Null) AND (alexande_apflora.tblTPopKontr.TPopKontrTyp="Zwischenbeurteilung" Or alexande_apflora.tblTPopKontr.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (alexande_apflora.tblTPop.TPopHerkunft<>201) AND (alexande_apflora.tblTPopKontr.TPopKontrJahr Is Not Null))
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, CONCAT(alexande_apflora.tblPop.PopName, IF(alexande_apflora.tblPop.PopNr Is Not Null,CONCAT(" (Nr. ", alexande_apflora.tblPop.PopNr, ")"),"")), CONCAT(alexande_apflora.tblTPop.TPopFlurname, IF(alexande_apflora.tblTPop.TPopNr Is Not Null,CONCAT(" (Nr. ", alexande_apflora.tblTPop.TPopNr, ")"),"")), IF(alexande_apflora.tblTPopKontr.TPopKontrDatum Is Not Null, alexande_apflora.tblTPopKontr.TPopKontrDatum,CONCAT("01.01.", alexande_apflora.tblTPopKontr.TPopKontrJahr)), alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vExportNachEvab_Beob AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.GUID AS Projekt_Id, alexande_apflora.tblPop.PopGuid AS Raum_Id, alexande_apflora.tblTPop.TPopGuid AS Ort_Id, alexande_apflora.tblTPopKontr.ZeitGuid AS Zeit_Id, alexande_apflora.tblTPopKontr.TPopKontrGuid AS Beob_Id, alexande_apflora.tblAdresse.AdrName AS Beob_BeobachterinName, alexande_apflora.tblAp.ApArtId AS Beob_NR, alexande_beob.ArtenDb_Arteigenschaften.Artname AS Beob_WissenschArtname, alexande_beob.ArtenDb_Arteigenschaften.NameDeutsch AS Beob_DeutscherArtname, "Feldbeobachtung" AS Beob_TypDerMeldung, domPopHerkunft_1.ZdsfHerkunft AS Beob_Herkunft, domPopHerkunft_1.ZdsfVorhanden AS Beob_Vorhandensein, alexande_apflora.tblTPopKontr.TPopKontrGefaehrdung AS Beob_Gefaehrdung, alexande_apflora.tblTPopKontr.TPopKontrVitalitaet AS Beob_VitalitaetPflanze, alexande_apflora.tblTPop.TPopBeschr AS Beob_BeschreibungStandort
FROM ((((((((alexande_apflora.tblAp INNER JOIN alexande_apflora.tblPop ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN alexande_apflora.tblTPopKontr ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopKontr.TPopId) INNER JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON alexande_apflora.tblAp.ApArtId = alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPopKontr.TPopKontrBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.domPopHerkunft AS domPopHerkunft_1 ON alexande_apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId
WHERE (((alexande_apflora.tblTPop.TPopXKoord) Is Not Null) AND ((alexande_apflora.tblTPop.TPopYKoord) Is Not Null)) OR (((alexande_apflora.tblTPop.TPopXKoord) Is Not Null) AND ((alexande_apflora.tblTPop.TPopYKoord) Is Not Null))
GROUP BY alexande_beob.ArtenDb_Arteigenschaften.GUID, alexande_apflora.tblPop.PopGuid, alexande_apflora.tblTPop.TPopGuid, alexande_apflora.tblTPopKontr.ZeitGuid, alexande_apflora.tblTPopKontr.TPopKontrGuid, alexande_apflora.tblAdresse.AdrName, alexande_apflora.tblAp.ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_beob.ArtenDb_Arteigenschaften.NameDeutsch, "Feldbeobachtung", domPopHerkunft_1.ZdsfHerkunft, domPopHerkunft_1.ZdsfVorhanden, alexande_apflora.tblTPopKontr.TPopKontrGefaehrdung, alexande_apflora.tblTPopKontr.TPopKontrVitalitaet, alexande_apflora.tblTPop.TPopBeschr, alexande_apflora.tblTPopKontr.TPopKontrDatum, alexande_apflora.tblTPopKontr.TPopKontrTyp, alexande_apflora.tblTPop.TPopHerkunft, alexande_apflora.tblTPopKontr.TPopKontrJahr
HAVING (((alexande_apflora.tblTPopKontr.TPopKontrDatum) Is Not Null) AND ((alexande_apflora.tblTPopKontr.TPopKontrTyp)="Zwischenbeurteilung" Or (alexande_apflora.tblTPopKontr.TPopKontrTyp)="Freiwilligen-Erfolgskontrolle") AND (alexande_apflora.tblTPop.TPopHerkunft<>201)) OR ((alexande_apflora.tblTPopKontr.TPopKontrTyp="Zwischenbeurteilung" Or alexande_apflora.tblTPopKontr.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (alexande_apflora.tblTPop.TPopHerkunft<>201) AND (alexande_apflora.tblTPopKontr.TPopKontrJahr Is Not Null))
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vExportNachEvab_Zeit AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.GUID AS Projekt_Id, alexande_apflora.tblPop.PopGuid AS Raum_Id, alexande_apflora.tblTPop.TPopGuid AS Ort_Id, alexande_apflora.tblTPopKontr.ZeitGuid AS Zeit_Id, CAST(IF(alexande_apflora.tblTPopKontr.TPopKontrDatum Is Not Null, alexande_apflora.tblTPopKontr.TPopKontrDatum,CONCAT("01.01." + alexande_apflora.tblTPopKontr.TPopKontrJahr)) AS CHAR) AS Zeit_Datum, IF(alexande_apflora.tblTPopKontr.TPopKontrDatum Is Not Null,"Tag","Jahr") AS Zeit_GenauigkeitDatum, alexande_apflora.tblTPopKontr.TPopKontrMoosschicht AS Zeit_DeckungMoose, alexande_apflora.tblTPopKontr.TPopKontrKrautschicht AS Zeit_DeckungKraeuter, alexande_apflora.tblTPopKontr.TPopKontrStrauchschicht AS Zeit_DeckungStraeucher, alexande_apflora.tblTPopKontr.TPopKontrBaumschicht AS Zeit_DeckungBaeume
FROM ((((((((alexande_apflora.tblAp INNER JOIN alexande_apflora.tblPop ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN alexande_apflora.tblTPopKontr ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopKontr.TPopId) INNER JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON alexande_apflora.tblAp.ApArtId = alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPopKontr.TPopKontrBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.domPopHerkunft AS domPopHerkunft_1 ON alexande_apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId
WHERE ((alexande_apflora.tblTPop.TPopXKoord Is Not Null) AND (alexande_apflora.tblTPop.TPopYKoord Is Not Null) AND (alexande_apflora.tblTPopKontr.TPopKontrDatum Is Not Null) AND (alexande_apflora.tblTPopKontr.TPopKontrTyp="Zwischenbeurteilung" Or alexande_apflora.tblTPopKontr.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (alexande_apflora.tblTPop.TPopHerkunft<>201)) OR ((alexande_apflora.tblTPop.TPopXKoord Is Not Null) AND (alexande_apflora.tblTPop.TPopYKoord Is Not Null) AND (alexande_apflora.tblTPopKontr.TPopKontrTyp="Zwischenbeurteilung" Or alexande_apflora.tblTPopKontr.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (alexande_apflora.tblTPop.TPopHerkunft<>201) AND (alexande_apflora.tblTPopKontr.TPopKontrJahr Is Not Null))
GROUP BY alexande_beob.ArtenDb_Arteigenschaften.GUID, alexande_apflora.tblPop.PopGuid, alexande_apflora.tblTPop.TPopGuid, alexande_apflora.tblTPopKontr.ZeitGuid, IF(alexande_apflora.tblTPopKontr.TPopKontrDatum Is Not Null, alexande_apflora.tblTPopKontr.TPopKontrDatum,CONCAT("01.01." + alexande_apflora.tblTPopKontr.TPopKontrJahr)), IF(alexande_apflora.tblTPopKontr.TPopKontrDatum Is Not Null,"Tag","Jahr"), alexande_apflora.tblTPopKontr.TPopKontrMoosschicht, alexande_apflora.tblTPopKontr.TPopKontrKrautschicht, alexande_apflora.tblTPopKontr.TPopKontrStrauchschicht, alexande_apflora.tblTPopKontr.TPopKontrBaumschicht
ORDER BY IF(alexande_apflora.tblTPopKontr.TPopKontrDatum Is Not Null, alexande_apflora.tblTPopKontr.TPopKontrDatum, alexande_apflora.tblTPopKontr.TPopKontrJahr);

CREATE OR REPLACE VIEW vExportNachEvab_Ort AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.GUID AS Projekt_Id, alexande_apflora.tblPop.PopGuid AS Raum_Id, alexande_apflora.tblTPop.TPopGuid AS Ort_Id, CAST(CONCAT(alexande_apflora.tblTPop.TPopFlurname, IF(alexande_apflora.tblTPop.TPopNr Is Not Null,CONCAT(" (Nr. ", alexande_apflora.tblTPop.TPopNr, ")"),"")) AS CHAR) AS Ort_Name, alexande_apflora.tblTPop.TPopHoehe AS Ort_ObergrenzeHoehe, alexande_apflora.tblTPop.TPopXKoord AS Ort_X, alexande_apflora.tblTPop.TPopYKoord AS Ort_Y, "+-20m" AS Ort_Genauigkeit, alexande_apflora.tblTPop.TPopGemeinde AS Ort_Gemeinde, alexande_apflora.tblTPop.TPopFlurname AS Ort_Flurname, alexande_apflora.tblTPop.TPopExposition AS Ort_Exposition, alexande_apflora.tblTPop.TPopNeigung AS Ort_Hangneigung, alexande_apflora.tblTPopKontr.TPopKontrLeb AS Ort_Lebensraum, alexande_apflora.tblTPopKontr.TPopKontrLebUmg AS Ort_UmgebungDelarze
FROM ((((((((alexande_apflora.tblAp INNER JOIN alexande_apflora.tblPop ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN alexande_apflora.tblTPopKontr ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopKontr.TPopId) INNER JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON alexande_apflora.tblAp.ApArtId = alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPopKontr.TPopKontrBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.domPopHerkunft AS domPopHerkunft_1 ON alexande_apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId
WHERE (alexande_apflora.tblTPopKontr.TPopKontrDatum Is Not Null AND (alexande_apflora.tblTPopKontr.TPopKontrTyp="Zwischenbeurteilung" Or alexande_apflora.tblTPopKontr.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND alexande_apflora.tblTPop.TPopHerkunft<>201) OR ((alexande_apflora.tblTPopKontr.TPopKontrTyp="Zwischenbeurteilung" Or alexande_apflora.tblTPopKontr.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND alexande_apflora.tblTPop.TPopHerkunft<>201 AND alexande_apflora.tblTPopKontr.TPopKontrJahr Is Not Null)
GROUP BY alexande_beob.ArtenDb_Arteigenschaften.GUID, alexande_apflora.tblPop.PopGuid, alexande_apflora.tblTPop.TPopGuid, CONCAT(alexande_apflora.tblTPop.TPopFlurname, IF(alexande_apflora.tblTPop.TPopNr Is Not Null,CONCAT(" (Nr. ", alexande_apflora.tblTPop.TPopNr, ")"),"")), alexande_apflora.tblTPop.TPopHoehe, alexande_apflora.tblTPop.TPopXKoord, alexande_apflora.tblTPop.TPopYKoord, "+-20m", alexande_apflora.tblTPop.TPopGemeinde, alexande_apflora.tblTPop.TPopFlurname, alexande_apflora.tblTPop.TPopExposition, alexande_apflora.tblTPop.TPopNeigung, alexande_apflora.tblTPopKontr.TPopKontrLeb, alexande_apflora.tblTPopKontr.TPopKontrLebUmg
HAVING (alexande_apflora.tblTPop.TPopXKoord Is Not Null AND alexande_apflora.tblTPop.TPopYKoord Is Not Null) OR (alexande_apflora.tblTPop.TPopXKoord Is Not Null AND alexande_apflora.tblTPop.TPopYKoord Is Not Null)
ORDER BY alexande_apflora.tblTPop.TPopFlurname, alexande_apflora.tblTPop.TPopNr;

CREATE OR REPLACE VIEW vExportNachEvab_Raum AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.GUID AS Projekt_Id, alexande_apflora.tblPop.PopGuid AS Raum_Id, CAST(CONCAT(alexande_apflora.tblPop.PopName, IF(alexande_apflora.tblPop.PopNr Is Not Null,CONCAT(" (Nr. ", alexande_apflora.tblPop.PopNr, ")"),"")) AS CHAR) AS Raum_Name, CAST(IF(alexande_apflora.tblPop.PopHerkunft Is Not Null,CONCAT("Status: ", domPopHerkunft.HerkunftTxt, IF(alexande_apflora.tblPop.PopBekanntSeit Is Not Null,CONCAT("; Bekannt seit: ", alexande_apflora.tblPop.PopBekanntSeit),"")),"") AS CHAR) AS Raum_Bemerkungen
FROM ((((((((alexande_apflora.tblAp INNER JOIN alexande_apflora.tblPop ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN alexande_apflora.tblTPopKontr ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopKontr.TPopId) INNER JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON alexande_apflora.tblAp.ApArtId = alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPopKontr.TPopKontrBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.domPopHerkunft AS domPopHerkunft_1 ON alexande_apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId
WHERE ((alexande_apflora.tblTPopKontr.TPopKontrDatum Is Not Null) AND (alexande_apflora.tblTPopKontr.TPopKontrTyp="Zwischenbeurteilung" Or alexande_apflora.tblTPopKontr.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (alexande_apflora.tblTPop.TPopHerkunft<>201) AND (alexande_apflora.tblTPop.TPopXKoord Is Not Null) AND (alexande_apflora.tblTPop.TPopYKoord Is Not Null)) OR ((alexande_apflora.tblTPopKontr.TPopKontrTyp="Zwischenbeurteilung" Or alexande_apflora.tblTPopKontr.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (alexande_apflora.tblTPop.TPopHerkunft<>201) AND (alexande_apflora.tblTPop.TPopXKoord Is Not Null) AND (alexande_apflora.tblTPop.TPopYKoord Is Not Null) AND (alexande_apflora.tblTPopKontr.TPopKontrJahr Is Not Null))
GROUP BY alexande_beob.ArtenDb_Arteigenschaften.GUID, alexande_apflora.tblPop.PopGuid, CONCAT(alexande_apflora.tblPop.PopName, IF(alexande_apflora.tblPop.PopNr Is Not Null,CONCAT(" (Nr. ", alexande_apflora.tblPop.PopNr, ")"),"")), IF(alexande_apflora.tblPop.PopHerkunft Is Not Null,CONCAT("Status: ", domPopHerkunft.HerkunftTxt, IF(alexande_apflora.tblPop.PopBekanntSeit Is Not Null,CONCAT("; Bekannt seit: ", alexande_apflora.tblPop.PopBekanntSeit), "")),"")
ORDER BY alexande_apflora.tblPop.PopName, alexande_apflora.tblPop.PopNr;

CREATE OR REPLACE VIEW vExportNachEvab_Projekt AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.GUID AS Projekt_Id, CONCAT("AP Flora ZH: ", alexande_beob.ArtenDb_Arteigenschaften.Artname) AS Projekt_Name, CAST(IF(alexande_apflora.tblAp.ApJahr Is Not Null,CONCAT("01.01.", alexande_apflora.tblAp.ApJahr),"") AS CHAR) AS Projekt_Eroeffnung, "Topos" AS Projekt_Autor, CAST(CONCAT("Aktionsplan: ", alexande_apflora.domApBearbeitungsstand.DomainTxt, IF(alexande_apflora.tblAp.ApJahr Is Not Null,CONCAT("; Start im Jahr: ", alexande_apflora.tblAp.ApJahr),""), IF(alexande_apflora.tblAp.ApUmsetzung Is Not Null,CONCAT("; Stand Umsetzung: ", domApUmsetzung.DomainTxt),""),"") AS CHAR) AS Projekt_Bemerkungen
FROM ((((((((alexande_apflora.tblAp INNER JOIN alexande_apflora.tblPop ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) INNER JOIN alexande_apflora.tblTPopKontr ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopKontr.TPopId) INNER JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON alexande_apflora.tblAp.ApArtId = alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPopKontr.TPopKontrBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.domPopHerkunft AS domPopHerkunft_1 ON alexande_apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId
WHERE ((alexande_apflora.tblTPopKontr.TPopKontrDatum Is Not Null) AND (alexande_apflora.tblTPopKontr.TPopKontrTyp="Zwischenbeurteilung" Or alexande_apflora.tblTPopKontr.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (alexande_apflora.tblTPop.TPopHerkunft<>201) AND (alexande_apflora.tblTPop.TPopXKoord Is Not Null) AND (alexande_apflora.tblTPop.TPopYKoord Is Not Null)) OR ((alexande_apflora.tblTPopKontr.TPopKontrTyp="Zwischenbeurteilung" Or alexande_apflora.tblTPopKontr.TPopKontrTyp="Freiwilligen-Erfolgskontrolle") AND (alexande_apflora.tblTPop.TPopHerkunft<>201) AND (alexande_apflora.tblTPop.TPopXKoord Is Not Null) AND (alexande_apflora.tblTPop.TPopYKoord Is Not Null) AND (alexande_apflora.tblTPopKontr.TPopKontrJahr Is Not Null))
GROUP BY alexande_beob.ArtenDb_Arteigenschaften.GUID, CONCAT("AP Flora ZH: ", alexande_beob.ArtenDb_Arteigenschaften.Artname), IF(alexande_apflora.tblAp.ApJahr Is Not Null,CONCAT("01.01.", alexande_apflora.tblAp.ApJahr),""), "Topos", CONCAT("Aktionsplan: ", alexande_apflora.domApBearbeitungsstand.DomainTxt, IF(alexande_apflora.tblAp.ApJahr Is Not Null,CONCAT("; Start im Jahr: ", alexande_apflora.tblAp.ApJahr),""), IF(alexande_apflora.tblAp.ApUmsetzung Is Not Null,CONCAT("; Stand Umsetzung: ", domApUmsetzung.DomainTxt), ""))
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname;

CREATE OR REPLACE VIEW vTPopMassnBer AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPop.PopGuid AS "Pop Guid", alexande_apflora.tblPop.PopNr AS "Pop Nr", alexande_apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblTPop.TPopId AS "TPop ID", alexande_apflora.tblTPop.TPopGuid AS "TPop Guid", alexande_apflora.tblTPop.TPopNr AS "TPop Nr", alexande_apflora.tblTPop.TPopGemeinde AS "TPop Gemeinde", alexande_apflora.tblTPop.TPopFlurname AS "TPop Flurname", domPopHerkunft_1.HerkunftTxt AS "TPop Status", alexande_apflora.tblTPop.TPopBekanntSeit AS "TPop bekannt seit", alexande_apflora.tblTPop.TPopHerkunftUnklar AS "TPop Status unklar", alexande_apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "TPop Begründung für unklaren Status", alexande_apflora.tblTPop.TPopXKoord AS "TPop X-Koordinaten", alexande_apflora.tblTPop.TPopYKoord AS "TPop Y-Koordinaten", alexande_apflora.tblTPop.TPopRadius AS "TPop Radius (m)", alexande_apflora.tblTPop.TPopHoehe AS "TPop Höhe", alexande_apflora.tblTPop.TPopExposition AS "TPop Exposition", alexande_apflora.tblTPop.TPopKlima AS "TPop Klima", alexande_apflora.tblTPop.TPopNeigung AS "TPop Hangneigung", alexande_apflora.tblTPop.TPopBeschr AS "TPop Beschreibung", alexande_apflora.tblTPop.TPopKatNr AS "TPop Kataster-Nr", alexande_apflora.tblAdresse.AdrName AS "TPop Verantwortlich", alexande_apflora.tblTPop.TPopApBerichtRelevant AS "TPop für AP-Bericht relevant", alexande_apflora.tblTPop.TPopEigen AS "TPop EigentümerIn", alexande_apflora.tblTPop.TPopKontakt AS "TPop Kontakt vor Ort", alexande_apflora.tblTPop.TPopNutzungszone AS "TPop Nutzungszone", alexande_apflora.tblTPop.TPopBewirtschafterIn AS "TPop BewirtschafterIn", alexande_apflora.tblTPop.TPopBewirtschaftung AS "TPop Bewirtschaftung", alexande_apflora.tblTPopMassnBer.TPopMassnBerId AS "TPopMassnBer Id", alexande_apflora.tblTPopMassnBer.TPopMassnBerJahr AS "TPopMassnBer Jahr", domTPopMassnErfolgsbeurteilung.BeurteilTxt AS "TPopMassnBer Entwicklung", alexande_apflora.tblTPopMassnBer.TPopMassnBerTxt AS "TPopMassnBer Interpretation", alexande_apflora.tblTPopMassnBer.MutWann AS "TPopMassnBer MutWann", alexande_apflora.tblTPopMassnBer.MutWer AS "TPopMassnBer MutWer"
FROM ((((((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) RIGHT JOIN (alexande_apflora.tblPop RIGHT JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.domPopHerkunft AS domPopHerkunft_1 ON alexande_apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPop.TPopVerantw = alexande_apflora.tblAdresse.AdrId) INNER JOIN alexande_apflora.tblTPopMassnBer ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopMassnBer.TPopId) LEFT JOIN alexande_apflora.domTPopMassnErfolgsbeurteilung ON alexande_apflora.tblTPopMassnBer.TPopMassnBerErfolgsbeurteilung = domTPopMassnErfolgsbeurteilung.BeurteilId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPopMassnBer.TPopMassnBerJahr;

CREATE OR REPLACE VIEW vTPopFuerKml AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, CAST(CONCAT(alexande_apflora.tblPop.PopNr,'/', alexande_apflora.tblTPop.TPopNr) AS CHAR) AS Label, CAST(LEFT(CONCAT('Population: ', alexande_apflora.tblPop.PopNr, ' ', alexande_apflora.tblPop.PopName, '<br /> Teilpopulation: ', alexande_apflora.tblTPop.TPopNr, ' ', alexande_apflora.tblTPop.TPopGemeinde, ' ', alexande_apflora.tblTPop.TPopFlurname),225) AS CHAR) AS Inhalte, (2.6779094+(4.728982*((alexande_apflora.tblTPop.TPopXKoord-600000)/1000000))+(0.791484*((alexande_apflora.tblTPop.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTPop.TPopYKoord-200000)/1000000))+(0.1306*((alexande_apflora.tblTPop.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTPop.TPopYKoord-200000)/1000000)*((alexande_apflora.tblTPop.TPopYKoord-200000)/1000000))-(0.0436*((alexande_apflora.tblTPop.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTPop.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTPop.TPopXKoord-600000)/1000000)))*100/36 AS Laengengrad, (16.9023892+(3.238272*((alexande_apflora.tblTPop.TPopYKoord-200000)/1000000))-(0.270978*((alexande_apflora.tblTPop.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTPop.TPopXKoord-600000)/1000000))-(0.002528*((alexande_apflora.tblTPop.TPopYKoord-200000)/1000000)*((alexande_apflora.tblTPop.TPopYKoord-200000)/1000000))-(0.0447*((alexande_apflora.tblTPop.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTPop.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTPop.TPopYKoord-200000)/1000000))-(0.014*((alexande_apflora.tblTPop.TPopYKoord-200000)/1000000)*((alexande_apflora.tblTPop.TPopYKoord-200000)/1000000)*((alexande_apflora.tblTPop.TPopYKoord-200000)/1000000)))*100/36 AS Breitengrad, CAST(CONCAT('http://apflora.ch/index.html?ap=', alexande_apflora.tblAp.ApArtId, '&pop=', alexande_apflora.tblTPop.TPopId) AS CHAR) AS URL
FROM (alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN (alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId
WHERE alexande_apflora.tblTPop.TPopYKoord > 0 AND alexande_apflora.tblTPop.TPopXKoord > 0
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblPop.PopName, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPop.TPopGemeinde, alexande_apflora.tblTPop.TPopFlurname;

CREATE OR REPLACE VIEW vTPopFuerKmlNamen AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, CAST(CONCAT(alexande_beob.ArtenDb_Arteigenschaften.Artname, ' ', alexande_apflora.tblPop.PopNr,'/', alexande_apflora.tblTPop.TPopNr) AS CHAR) AS Label, CAST(LEFT(CONCAT('Population: ', alexande_apflora.tblPop.PopNr, ' ', alexande_apflora.tblPop.PopName, '<br /> Teilpopulation: ', alexande_apflora.tblTPop.TPopNr, ' ', alexande_apflora.tblTPop.TPopGemeinde, ' ', alexande_apflora.tblTPop.TPopFlurname),225) AS CHAR) AS Inhalte, (2.6779094+(4.728982*((alexande_apflora.tblTPop.TPopXKoord-600000)/1000000))+(0.791484*((alexande_apflora.tblTPop.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTPop.TPopYKoord-200000)/1000000))+(0.1306*((alexande_apflora.tblTPop.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTPop.TPopYKoord-200000)/1000000)*((alexande_apflora.tblTPop.TPopYKoord-200000)/1000000))-(0.0436*((alexande_apflora.tblTPop.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTPop.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTPop.TPopXKoord-600000)/1000000)))*100/36 AS Laengengrad, (16.9023892+(3.238272*((alexande_apflora.tblTPop.TPopYKoord-200000)/1000000))-(0.270978*((alexande_apflora.tblTPop.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTPop.TPopXKoord-600000)/1000000))-(0.002528*((alexande_apflora.tblTPop.TPopYKoord-200000)/1000000)*((alexande_apflora.tblTPop.TPopYKoord-200000)/1000000))-(0.0447*((alexande_apflora.tblTPop.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTPop.TPopXKoord-600000)/1000000)*((alexande_apflora.tblTPop.TPopYKoord-200000)/1000000))-(0.014*((alexande_apflora.tblTPop.TPopYKoord-200000)/1000000)*((alexande_apflora.tblTPop.TPopYKoord-200000)/1000000)*((alexande_apflora.tblTPop.TPopYKoord-200000)/1000000)))*100/36 AS Breitengrad, CAST(CONCAT('http://www.apflora.ch/index.html?ap=', alexande_apflora.tblAp.ApArtId, '&pop=', alexande_apflora.tblTPop.TPopId) AS CHAR) AS URL
FROM (alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN (alexande_apflora.tblPop INNER JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId
WHERE alexande_apflora.tblTPop.TPopYKoord > 0 AND alexande_apflora.tblTPop.TPopXKoord > 0
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblPop.PopName, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPop.TPopGemeinde, alexande_apflora.tblTPop.TPopFlurname;

CREATE OR REPLACE VIEW vPopFuerKml AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.tblPop.PopNr AS Label, CAST(LEFT(CONCAT('Population: ', alexande_apflora.tblPop.PopNr, ' ', alexande_apflora.tblPop.PopName),225) AS CHAR) AS Inhalte, (2.6779094+(4.728982*((alexande_apflora.tblPop.PopXKoord-600000)/1000000))+(0.791484*((alexande_apflora.tblPop.PopXKoord-600000)/1000000)*((alexande_apflora.tblPop.PopYKoord-200000)/1000000))+(0.1306*((alexande_apflora.tblPop.PopXKoord-600000)/1000000)*((alexande_apflora.tblPop.PopYKoord-200000)/1000000)*((alexande_apflora.tblPop.PopYKoord-200000)/1000000))-(0.0436*((alexande_apflora.tblPop.PopXKoord-600000)/1000000)*((alexande_apflora.tblPop.PopXKoord-600000)/1000000)*((alexande_apflora.tblPop.PopXKoord-600000)/1000000)))*100/36 AS Laengengrad, (16.9023892+(3.238272*((alexande_apflora.tblPop.PopYKoord-200000)/1000000))-(0.270978*((alexande_apflora.tblPop.PopXKoord-600000)/1000000)*((alexande_apflora.tblPop.PopXKoord-600000)/1000000))-(0.002528*((alexande_apflora.tblPop.PopYKoord-200000)/1000000)*((alexande_apflora.tblPop.PopYKoord-200000)/1000000))-(0.0447*((alexande_apflora.tblPop.PopXKoord-600000)/1000000)*((alexande_apflora.tblPop.PopXKoord-600000)/1000000)*((alexande_apflora.tblPop.PopYKoord-200000)/1000000))-(0.014*((alexande_apflora.tblPop.PopYKoord-200000)/1000000)*((alexande_apflora.tblPop.PopYKoord-200000)/1000000)*((alexande_apflora.tblPop.PopYKoord-200000)/1000000)))*100/36 AS Breitengrad, CAST(CONCAT('http://www.apflora.ch/index.html?ap=', alexande_apflora.tblAp.ApArtId, '&pop=', alexande_apflora.tblPop.PopId) AS CHAR) AS URL
FROM (alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN alexande_apflora.tblPop ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId
WHERE alexande_apflora.tblPop.PopYKoord > 0 AND alexande_apflora.tblPop.PopXKoord > 0
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblPop.PopName;

CREATE OR REPLACE VIEW vPopFuerKmlNamen AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, CAST(CONCAT(alexande_beob.ArtenDb_Arteigenschaften.Artname, ' ', alexande_apflora.tblPop.PopNr) AS CHAR) AS Label, CAST(LEFT(CONCAT('Population: ', alexande_apflora.tblPop.PopNr, ' ', alexande_apflora.tblPop.PopName),225) AS CHAR) AS Inhalte, (2.6779094+(4.728982*((alexande_apflora.tblPop.PopXKoord-600000)/1000000))+(0.791484*((alexande_apflora.tblPop.PopXKoord-600000)/1000000)*((alexande_apflora.tblPop.PopYKoord-200000)/1000000))+(0.1306*((alexande_apflora.tblPop.PopXKoord-600000)/1000000)*((alexande_apflora.tblPop.PopYKoord-200000)/1000000)*((alexande_apflora.tblPop.PopYKoord-200000)/1000000))-(0.0436*((alexande_apflora.tblPop.PopXKoord-600000)/1000000)*((alexande_apflora.tblPop.PopXKoord-600000)/1000000)*((alexande_apflora.tblPop.PopXKoord-600000)/1000000)))*100/36 AS Laengengrad, (16.9023892+(3.238272*((alexande_apflora.tblPop.PopYKoord-200000)/1000000))-(0.270978*((alexande_apflora.tblPop.PopXKoord-600000)/1000000)*((alexande_apflora.tblPop.PopXKoord-600000)/1000000))-(0.002528*((alexande_apflora.tblPop.PopYKoord-200000)/1000000)*((alexande_apflora.tblPop.PopYKoord-200000)/1000000))-(0.0447*((alexande_apflora.tblPop.PopXKoord-600000)/1000000)*((alexande_apflora.tblPop.PopXKoord-600000)/1000000)*((alexande_apflora.tblPop.PopYKoord-200000)/1000000))-(0.014*((alexande_apflora.tblPop.PopYKoord-200000)/1000000)*((alexande_apflora.tblPop.PopYKoord-200000)/1000000)*((alexande_apflora.tblPop.PopYKoord-200000)/1000000)))*100/36 AS Breitengrad, CAST(CONCAT('http://www.apflora.ch/index.html?ap=', alexande_apflora.tblAp.ApArtId, '&pop=', alexande_apflora.tblPop.PopId) AS CHAR) AS URL
FROM (alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN alexande_apflora.tblPop ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId
WHERE alexande_apflora.tblPop.PopYKoord > 0 AND alexande_apflora.tblPop.PopXKoord > 0
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblPop.PopName;

DROP VIEW vKontrAnzProZaehleinheit0 IF EXISTS;

CREATE OR REPLACE VIEW vKontrAnzProZaehleinheit AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", tblAdresse_1.AdrName AS "AP verantwortlich", alexande_apflora.tblPop.PopGuid AS "Pop Guid", alexande_apflora.tblPop.PopNr AS "Pop Nr", alexande_apflora.tblPop.PopName AS "Pop Name", alexande_apflora.domPopHerkunft.HerkunftTxt AS "Pop Herkunft", alexande_apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblTPop.TPopId AS "TPop ID", alexande_apflora.tblTPop.TPopGuid AS "TPop Guid", alexande_apflora.tblTPop.TPopNr AS "TPop Nr", alexande_apflora.tblTPop.TPopGemeinde AS "TPop Gemeinde", alexande_apflora.tblTPop.TPopFlurname AS "TPop Flurname", domPopHerkunft_1.HerkunftTxt AS "TPop Status", alexande_apflora.tblTPop.TPopBekanntSeit AS "TPop bekannt seit", alexande_apflora.tblTPop.TPopHerkunftUnklar AS "TPop Status unklar", alexande_apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "TPop Begründung für unklaren Status", alexande_apflora.tblTPop.TPopXKoord AS "TPop X-Koordinaten", alexande_apflora.tblTPop.TPopYKoord AS "TPop Y-Koordinaten", alexande_apflora.tblTPop.TPopRadius AS "TPop Radius m", alexande_apflora.tblTPop.TPopHoehe AS "TPop Höhe", alexande_apflora.tblTPop.TPopExposition AS "TPop Exposition", alexande_apflora.tblTPop.TPopKlima AS "TPop Klima", alexande_apflora.tblTPop.TPopNeigung AS "TPop Hangneigung", alexande_apflora.tblTPop.TPopBeschr AS "TPop Beschreibung", alexande_apflora.tblTPop.TPopKatNr AS "TPop Kataster-Nr", tblAdresse_2.AdrName AS "TPop verantwortlich", alexande_apflora.tblTPop.TPopApBerichtRelevant AS "TPop für AP-Bericht relevant", alexande_apflora.tblTPop.TPopEigen AS "TPop EigentümerIn", alexande_apflora.tblTPop.TPopKontakt AS "TPop Kontakt vor Ort", alexande_apflora.tblTPop.TPopNutzungszone AS "TPop Nutzungszone", alexande_apflora.tblTPop.TPopBewirtschafterIn AS "TPop BewirtschafterIn", alexande_apflora.tblTPop.TPopBewirtschaftung AS "TPop Bewirtschaftung", alexande_apflora.tblTPopKontr.TPopKontrId, alexande_apflora.tblTPopKontr.TPopId, alexande_apflora.tblTPopKontr.TPopKontrGuid AS "Kontr Guid", alexande_apflora.tblTPopKontr.TPopKontrJahr AS "Kontr Jahr", alexande_apflora.tblTPopKontr.TPopKontrDatum AS "Kontr Datum", alexande_apflora.domTPopFeldkontrTyp.DomainTxt AS "Kontr Typ", alexande_apflora.tblAdresse.AdrName AS "Kontr BearbeiterIn", alexande_apflora.tblTPopKontrZaehl.Anzahl, alexande_apflora.domTPopKontrZaehleinheit.ZaehleinheitTxt AS Zaehleinheit, alexande_apflora.domTPopKontrMethode.BeurteilTxt AS Methode, alexande_apflora.tblTPopKontr.TPopKontrUeberleb AS "Kontr Überlebensrate", alexande_apflora.tblTPopKontr.TPopKontrVitalitaet AS "Kontr Vitalität", alexande_apflora.domPopEntwicklung.EntwicklungTxt AS "Kontr Entwicklung", alexande_apflora.tblTPopKontr.TPopKontrUrsach AS "Kontr Ursachen", alexande_apflora.tblTPopKontr.TPopKontrUrteil AS "Kontr Erfolgsbeurteilung", alexande_apflora.tblTPopKontr.TPopKontrAendUms AS "Kontr Änderungs-Vorschläge Umsetzung", alexande_apflora.tblTPopKontr.TPopKontrAendKontr AS "Kontr Änderungs-Vorschläge Kontrolle", alexande_apflora.tblTPop.TPopXKoord AS "Kontr X-Koord", alexande_apflora.tblTPop.TPopYKoord AS "Kontr Y-Koord", alexande_apflora.tblTPopKontr.TPopKontrTxt AS "Kontr Bemerkungen", alexande_apflora.tblTPopKontr.TPopKontrLeb AS "Kontr Lebensraum Delarze", alexande_apflora.tblTPopKontr.TPopKontrLebUmg AS "Kontr angrenzender Lebensraum Delarze", alexande_apflora.tblTPopKontr.TPopKontrVegTyp AS "Kontr Vegetationstyp", alexande_apflora.tblTPopKontr.TPopKontrKonkurrenz AS "Kontr Konkurrenz", alexande_apflora.tblTPopKontr.TPopKontrMoosschicht AS "Kontr Moosschicht", alexande_apflora.tblTPopKontr.TPopKontrKrautschicht AS "Kontr Krautschicht", alexande_apflora.tblTPopKontr.TPopKontrStrauchschicht AS "Kontr Strauchschicht", alexande_apflora.tblTPopKontr.TPopKontrBaumschicht AS "Kontr Baumschicht", alexande_apflora.tblTPopKontr.TPopKontrBodenTyp AS "Kontr Bodentyp", alexande_apflora.tblTPopKontr.TPopKontrBodenKalkgehalt AS "Kontr Boden Kalkgehalt", alexande_apflora.tblTPopKontr.TPopKontrBodenDurchlaessigkeit AS "Kontr Boden Durchlässigkeit", alexande_apflora.tblTPopKontr.TPopKontrBodenHumus AS "Kontr Boden Humusgehalt", alexande_apflora.tblTPopKontr.TPopKontrBodenNaehrstoffgehalt AS "Kontr Boden Nährstoffgehalt", alexande_apflora.tblTPopKontr.TPopKontrBodenAbtrag AS "Kontr Oberbodenabtrag", alexande_apflora.tblTPopKontr.TPopKontrWasserhaushalt AS "Kontr Wasserhaushalt", alexande_apflora.domTPopKontrIdBiotUebereinst.DomainTxt AS "Kontr Übereinstimmung mit Idealbiotop", alexande_apflora.tblTPopKontr.TPopKontrHandlungsbedarf AS "Kontr Handlungsbedarf", alexande_apflora.tblTPopKontr.TPopKontrUebFlaeche AS "Kontr ÜberprÜfte Fläche", alexande_apflora.tblTPopKontr.TPopKontrFlaeche AS "Kontr Fläche der Teilpopulation m2", alexande_apflora.tblTPopKontr.TPopKontrPlan AS "Kontr auf Plan eingezeichnet", alexande_apflora.tblTPopKontr.TPopKontrVeg AS "Kontr Deckung durch Vegetation", alexande_apflora.tblTPopKontr.TPopKontrNaBo AS "Kontr Deckung nackter Boden", alexande_apflora.tblTPopKontr.TPopKontrUebPfl AS "Kontr Deckung durch überprüfte Art", alexande_apflora.tblTPopKontr.TPopKontrJungPflJN AS "Kontr auch junge Pflanzen", alexande_apflora.tblTPopKontr.TPopKontrVegHoeMax AS "Kontr maximale Veg-höhe cm", alexande_apflora.tblTPopKontr.TPopKontrVegHoeMit AS "Kontr mittlere Veg-höhe cm", alexande_apflora.tblTPopKontr.TPopKontrGefaehrdung AS "Kontr Gefährdung", alexande_apflora.tblTPopKontr.MutWann AS "Kontrolle zuletzt geändert", alexande_apflora.tblTPopKontr.MutWer AS "Kontrolle zuletzt geändert von", alexande_apflora.tblTPopKontrZaehl.TPopKontrZaehlId
FROM (((alexande_apflora.domPopHerkunft AS domPopHerkunft_1 RIGHT JOIN (alexande_apflora.tblAdresse AS tblAdresse_2 RIGHT JOIN (((((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = tblAp.ApArtId) INNER JOIN (alexande_apflora.tblPop INNER JOIN (alexande_apflora.tblTPop INNER JOIN (((alexande_apflora.tblTPopKontr LEFT JOIN alexande_apflora.domTPopFeldkontrTyp ON alexande_apflora.tblTPopKontr.TPopKontrTyp = alexande_apflora.domTPopFeldkontrTyp.DomainTxt) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPopKontr.TPopKontrBearb = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora.domPopEntwicklung ON alexande_apflora.tblTPopKontr.TPopKontrEntwicklung = alexande_apflora.domPopEntwicklung.EntwicklungId) ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopKontr.TPopId) ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) ON tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN domApUmsetzung ON tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = alexande_apflora.domPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.domTPopKontrIdBiotUebereinst ON alexande_apflora.tblTPopKontr.TPopKontrIdealBiotopUebereinst = alexande_apflora.domTPopKontrIdBiotUebereinst.DomainCode) LEFT JOIN alexande_apflora.tblAdresse AS tblAdresse_1 ON tblAp.ApBearb = tblAdresse_1.AdrId) ON tblAdresse_2.AdrId = alexande_apflora.tblTPop.TPopVerantw) ON domPopHerkunft_1.HerkunftId = alexande_apflora.tblTPop.TPopHerkunft) INNER JOIN alexande_apflora.tblTPopKontrZaehl ON alexande_apflora.tblTPopKontr.TPopKontrId = alexande_apflora.tblTPopKontrZaehl.TPopKontrId) LEFT JOIN alexande_apflora.domTPopKontrZaehleinheit ON alexande_apflora.tblTPopKontrZaehl.Zaehleinheit = alexande_apflora.domTPopKontrZaehleinheit.ZaehleinheitCode) LEFT JOIN alexande_apflora.domTPopKontrMethode ON alexande_apflora.tblTPopKontrZaehl.Methode = alexande_apflora.domTPopKontrMethode.BeurteilCode
WHERE alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId Not In (100,150)
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPopKontr.TPopKontrJahr, alexande_apflora.tblTPopKontr.TPopKontrDatum;

CREATE OR REPLACE VIEW vTPopBer AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPop.PopGuid AS "Pop Guid", alexande_apflora.tblPop.PopNr AS "Pop Nr", alexande_apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblTPop.TPopId AS "TPop ID", alexande_apflora.tblTPop.TPopGuid AS "TPop Guid", alexande_apflora.tblTPop.TPopNr AS "TPop Nr", alexande_apflora.tblTPop.TPopGemeinde AS "TPop Gemeinde", alexande_apflora.tblTPop.TPopFlurname AS "TPop Flurname", domPopHerkunft_1.HerkunftTxt AS "TPop Status", alexande_apflora.tblTPop.TPopBekanntSeit AS "TPop bekannt seit", alexande_apflora.tblTPop.TPopHerkunftUnklar AS "TPop Status unklar", alexande_apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "TPop Begründung für unklaren Status", alexande_apflora.tblTPop.TPopXKoord AS "TPop X-Koordinaten", alexande_apflora.tblTPop.TPopYKoord AS "TPop Y-Koordinaten", alexande_apflora.tblTPop.TPopRadius AS "TPop Radius (m)", alexande_apflora.tblTPop.TPopHoehe AS "TPop Höhe", alexande_apflora.tblTPop.TPopExposition AS "TPop Exposition", alexande_apflora.tblTPop.TPopKlima AS "TPop Klima", alexande_apflora.tblTPop.TPopNeigung AS "TPop Hangneigung", alexande_apflora.tblTPop.TPopBeschr AS "TPop Beschreibung", alexande_apflora.tblTPop.TPopKatNr AS "TPop Kataster-Nr", alexande_apflora.tblAdresse.AdrName AS "TPop Verantwortlich", alexande_apflora.tblTPop.TPopApBerichtRelevant AS "TPop für AP-Bericht relevant", alexande_apflora.tblTPop.TPopEigen AS "TPop EigentümerIn", alexande_apflora.tblTPop.TPopKontakt AS "TPop Kontakt vor Ort", alexande_apflora.tblTPop.TPopNutzungszone AS "TPop Nutzungszone", alexande_apflora.tblTPop.TPopBewirtschafterIn AS "TPop BewirtschafterIn", alexande_apflora.tblTPop.TPopBewirtschaftung AS "TPop Bewirtschaftung", alexande_apflora.tblTPopBer.TPopBerId AS "TPopBer Id", alexande_apflora.tblTPopBer.TPopBerJahr AS "TPopBer Jahr", domPopEntwicklung.EntwicklungTxt AS "TPopBer Entwicklung", alexande_apflora.tblTPopBer.TPopBerTxt AS "TPopBer Bemerkungen", alexande_apflora.tblTPopBer.MutWann AS "TPopBer MutWann", alexande_apflora.tblTPopBer.MutWer AS "TPopBer MutWer"
FROM ((((((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) RIGHT JOIN (alexande_apflora.tblPop RIGHT JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.domPopHerkunft AS domPopHerkunft_1 ON alexande_apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPop.TPopVerantw = alexande_apflora.tblAdresse.AdrId) RIGHT JOIN alexande_apflora.tblTPopBer ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopBer.TPopId) LEFT JOIN alexande_apflora.domPopEntwicklung ON alexande_apflora.tblTPopBer.TPopBerEntwicklung = domPopEntwicklung.EntwicklungId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblTPop.TPopNr, alexande_apflora.tblTPopBer.TPopBerJahr, domPopEntwicklung.EntwicklungTxt;

CREATE OR REPLACE VIEW vPopBerMassnJahre AS
SELECT alexande_apflora.tblPop.PopId, alexande_apflora.tblPopBer.PopBerJahr as "Jahr"
FROM alexande_apflora.tblPop INNER JOIN alexande_apflora.tblPopBer ON alexande_apflora.tblPop.PopId = alexande_apflora.tblPopBer.PopId
UNION DISTINCT SELECT alexande_apflora.tblPop.PopId, alexande_apflora.tblPopMassnBer.PopMassnBerJahr as "Jahr"
FROM alexande_apflora.tblPop INNER JOIN alexande_apflora.tblPopMassnBer ON alexande_apflora.tblPop.PopId = alexande_apflora.tblPopMassnBer.PopId
ORDER BY Jahr;

CREATE OR REPLACE VIEW vPop_BerUndMassnBer AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS "AP ApArtId", alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPop.PopGuid AS "Pop Guid", alexande_apflora.tblPop.PopNr AS "Pop Nr", alexande_apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblPop.MutWann AS "Datensatz zuletzt geändert", alexande_apflora.tblPop.MutWer AS "Datensatz zuletzt geändert von", alexande_apflora_views.vPopBerMassnJahre.Jahr, alexande_apflora.tblPopBer.PopBerId AS "PopBer Id", alexande_apflora.tblPopBer.PopBerJahr AS "PopBer Jahr", domPopEntwicklung.EntwicklungTxt AS "PopBer Entwicklung", alexande_apflora.tblPopBer.PopBerTxt AS "PopBer Bemerkungen", alexande_apflora.tblPopBer.MutWann AS "PopBer MutWann", alexande_apflora.tblPopBer.MutWer AS "PopBer MutWer", alexande_apflora.tblPopMassnBer.PopMassnBerId AS "PopMassnBer Id", alexande_apflora.tblPopMassnBer.PopMassnBerJahr AS "PopMassnBer Jahr", domTPopMassnErfolgsbeurteilung.BeurteilTxt AS "PopMassnBer Entwicklung", alexande_apflora.tblPopMassnBer.PopMassnBerTxt AS "PopMassnBer Interpretation", alexande_apflora.tblPopMassnBer.MutWann AS "PopMassnBer MutWann", alexande_apflora.tblPopMassnBer.MutWer AS "PopMassnBer MutWer"
FROM (((((((alexande_beob.ArtenDb_Arteigenschaften INNER JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) INNER JOIN alexande_apflora.tblPop ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora_views.vPopBerMassnJahre ON alexande_apflora.tblPop.PopId = alexande_apflora_views.vPopBerMassnJahre.PopId) LEFT JOIN (alexande_apflora.tblPopMassnBer LEFT JOIN alexande_apflora.domTPopMassnErfolgsbeurteilung ON alexande_apflora.tblPopMassnBer.PopMassnBerErfolgsbeurteilung = domTPopMassnErfolgsbeurteilung.BeurteilId) ON (alexande_apflora_views.vPopBerMassnJahre.Jahr = alexande_apflora.tblPopMassnBer.PopMassnBerJahr) AND (alexande_apflora_views.vPopBerMassnJahre.PopId = alexande_apflora.tblPopMassnBer.PopId)) LEFT JOIN (alexande_apflora.tblPopBer LEFT JOIN alexande_apflora.domPopEntwicklung ON alexande_apflora.tblPopBer.PopBerEntwicklung = domPopEntwicklung.EntwicklungId) ON (alexande_apflora_views.vPopBerMassnJahre.Jahr = alexande_apflora.tblPopBer.PopBerJahr) AND (alexande_apflora_views.vPopBerMassnJahre.PopId = alexande_apflora.tblPopBer.PopId)
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora_views.vPopBerMassnJahre.Jahr;

CREATE OR REPLACE VIEW vTPopBerMassnJahre AS
SELECT alexande_apflora.tblTPop.TPopId, alexande_apflora.tblTPopBer.TPopBerJahr as "Jahr"
FROM alexande_apflora.tblTPop INNER JOIN alexande_apflora.tblTPopBer ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopBer.TPopId
UNION DISTINCT SELECT alexande_apflora.tblTPop.TPopId, alexande_apflora.tblTPopMassnBer.TPopMassnBerJahr as "Jahr"
FROM alexande_apflora.tblTPop INNER JOIN alexande_apflora.tblTPopMassnBer ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopMassnBer.TPopId
ORDER BY Jahr;

CREATE OR REPLACE VIEW vTPopKontrBerMassnJahre AS
SELECT alexande_apflora.tblTPop.TPopId, alexande_apflora.tblTPopBer.TPopBerJahr AS "Jahr" 
FROM alexande_apflora.tblTPop INNER JOIN alexande_apflora.tblTPopBer ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopBer.TPopId
UNION DISTINCT SELECT alexande_apflora.tblTPop.TPopId, alexande_apflora.tblTPopMassnBer.TPopMassnBerJahr AS "Jahr"
FROM alexande_apflora.tblTPop INNER JOIN alexande_apflora.tblTPopMassnBer ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopMassnBer.TPopId
UNION DISTINCT SELECT alexande_apflora.tblTPop.TPopId, alexande_apflora.tblTPopKontr.TPopKontrJahr AS "Jahr"
FROM alexande_apflora.tblTPop INNER JOIN alexande_apflora.tblTPopKontr ON alexande_apflora.tblTPop.TPopId = alexande_apflora.tblTPopKontr.TPopId
ORDER BY Jahr;

CREATE OR REPLACE VIEW vTPop_BerUndMassnBer AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId AS ApArtId, alexande_beob.ArtenDb_Arteigenschaften.Artname AS "AP Art", alexande_apflora.domApBearbeitungsstand.DomainTxt AS "AP Status", alexande_apflora.tblAp.ApJahr AS "AP Start im Jahr", domApUmsetzung.DomainTxt AS "AP Stand Umsetzung", alexande_apflora.tblPop.PopGuid AS "Pop Guid", alexande_apflora.tblPop.PopNr AS "Pop Nr", alexande_apflora.tblPop.PopName AS "Pop Name", domPopHerkunft.HerkunftTxt AS "Pop Status", alexande_apflora.tblPop.PopBekanntSeit AS "Pop bekannt seit", alexande_apflora.tblPop.PopHerkunftUnklar AS "Pop Status unklar", alexande_apflora.tblPop.PopHerkunftUnklarBegruendung AS "Pop Begründung für unklaren Status", alexande_apflora.tblPop.PopXKoord AS "Pop X-Koordinaten", alexande_apflora.tblPop.PopYKoord AS "Pop Y-Koordinaten", alexande_apflora.tblTPop.TPopId AS "TPop ID", alexande_apflora.tblTPop.TPopGuid AS "TPop Guid", alexande_apflora.tblTPop.TPopNr AS "TPop Nr", alexande_apflora.tblTPop.TPopGemeinde AS "TPop Gemeinde", alexande_apflora.tblTPop.TPopFlurname AS "TPop Flurname", domPopHerkunft_1.HerkunftTxt AS "TPop Status", alexande_apflora.tblTPop.TPopBekanntSeit AS "TPop bekannt seit", alexande_apflora.tblTPop.TPopHerkunftUnklar AS "TPop Status unklar", alexande_apflora.tblTPop.TPopHerkunftUnklarBegruendung AS "TPop Begründung für unklaren Status", alexande_apflora.tblTPop.TPopXKoord AS "TPop X-Koordinaten", alexande_apflora.tblTPop.TPopYKoord AS "TPop Y-Koordinaten", alexande_apflora.tblTPop.TPopRadius AS "TPop Radius (m)", alexande_apflora.tblTPop.TPopHoehe AS "TPop Höhe", alexande_apflora.tblTPop.TPopExposition AS "TPop Exposition", alexande_apflora.tblTPop.TPopKlima AS "TPop Klima", alexande_apflora.tblTPop.TPopNeigung AS "TPop Hangneigung", alexande_apflora.tblTPop.TPopBeschr AS "TPop Beschreibung", alexande_apflora.tblTPop.TPopKatNr AS "TPop Kataster-Nr", alexande_apflora.tblAdresse.AdrName AS "TPop Verantwortlich", alexande_apflora.tblTPop.TPopApBerichtRelevant AS "TPop für AP-Bericht relevant", alexande_apflora.tblTPop.TPopEigen AS "TPop EigentümerIn", alexande_apflora.tblTPop.TPopKontakt AS "TPop Kontakt vor Ort", alexande_apflora.tblTPop.TPopNutzungszone AS "TPop Nutzungszone", alexande_apflora.tblTPop.TPopBewirtschafterIn AS "TPop BewirtschafterIn", alexande_apflora.tblTPop.TPopBewirtschaftung AS "TPop Bewirtschaftung", alexande_apflora_views.vTPopBerMassnJahre.Jahr, alexande_apflora.tblTPopBer.TPopBerId AS "TPopBer Id", alexande_apflora.tblTPopBer.TPopBerJahr AS "TPopBer Jahr", domPopEntwicklung.EntwicklungTxt AS "TPopBer Entwicklung", alexande_apflora.tblTPopBer.TPopBerTxt AS "TPopBer Bemerkungen", alexande_apflora.tblTPopBer.MutWann AS "TPopBer MutWann", alexande_apflora.tblTPopBer.MutWer AS "TPopBer MutWer", alexande_apflora.tblTPopMassnBer.TPopMassnBerJahr AS "TPopMassnBer Jahr", domTPopMassnErfolgsbeurteilung.BeurteilTxt AS "TPopMassnBer Entwicklung", alexande_apflora.tblTPopMassnBer.TPopMassnBerTxt AS "TPopMassnBer Interpretation", alexande_apflora.tblTPopMassnBer.MutWann AS "TPopMassnBer MutWann", alexande_apflora.tblTPopMassnBer.MutWer AS "TPopMassnBer MutWer"
FROM (((((((((((alexande_beob.ArtenDb_Arteigenschaften RIGHT JOIN alexande_apflora.tblAp ON alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId = alexande_apflora.tblAp.ApArtId) RIGHT JOIN (alexande_apflora.tblPop RIGHT JOIN alexande_apflora.tblTPop ON alexande_apflora.tblPop.PopId = alexande_apflora.tblTPop.PopId) ON alexande_apflora.tblAp.ApArtId = alexande_apflora.tblPop.ApArtId) LEFT JOIN alexande_apflora.domApBearbeitungsstand ON alexande_apflora.tblAp.ApStatus = alexande_apflora.domApBearbeitungsstand.DomainCode) LEFT JOIN alexande_apflora.domApUmsetzung ON alexande_apflora.tblAp.ApUmsetzung = domApUmsetzung.DomainCode) LEFT JOIN alexande_apflora.domPopHerkunft ON alexande_apflora.tblPop.PopHerkunft = domPopHerkunft.HerkunftId) LEFT JOIN alexande_apflora.domPopHerkunft AS domPopHerkunft_1 ON alexande_apflora.tblTPop.TPopHerkunft = domPopHerkunft_1.HerkunftId) LEFT JOIN alexande_apflora.tblAdresse ON alexande_apflora.tblTPop.TPopVerantw = alexande_apflora.tblAdresse.AdrId) LEFT JOIN alexande_apflora_views.vTPopBerMassnJahre ON alexande_apflora.tblTPop.TPopId = alexande_apflora_views.vTPopBerMassnJahre.TPopId) LEFT JOIN alexande_apflora.tblTPopMassnBer ON (alexande_apflora_views.vTPopBerMassnJahre.TPopId = alexande_apflora.tblTPopMassnBer.TPopId) AND (alexande_apflora_views.vTPopBerMassnJahre.Jahr = alexande_apflora.tblTPopMassnBer.TPopMassnBerJahr)) LEFT JOIN alexande_apflora.domTPopMassnErfolgsbeurteilung ON alexande_apflora.tblTPopMassnBer.TPopMassnBerErfolgsbeurteilung = domTPopMassnErfolgsbeurteilung.BeurteilId) LEFT JOIN alexande_apflora.tblTPopBer ON (alexande_apflora_views.vTPopBerMassnJahre.Jahr = alexande_apflora.tblTPopBer.TPopBerJahr) AND (alexande_apflora_views.vTPopBerMassnJahre.TPopId = alexande_apflora.tblTPopBer.TPopId)) LEFT JOIN alexande_apflora.domPopEntwicklung ON alexande_apflora.tblTPopBer.TPopBerEntwicklung = domPopEntwicklung.EntwicklungId
ORDER BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblPop.PopNr, alexande_apflora.tblTPop.TPopNr, alexande_apflora_views.vTPopBerMassnJahre.Jahr;

CREATE OR REPLACE VIEW vPop_BerMassnJahreVonTPop AS 
SELECT alexande_apflora.tblTPop.PopId, alexande_apflora_views.vTPopBerMassnJahre.Jahr
FROM alexande_apflora_views.vTPopBerMassnJahre INNER JOIN alexande_apflora.tblTPop ON alexande_apflora_views.vTPopBerMassnJahre.TPopId = alexande_apflora.tblTPop.TPopId
GROUP BY alexande_apflora.tblTPop.PopId, alexande_apflora_views.vTPopBerMassnJahre.Jahr;

/*diese Abfrage nötig, weil in Access die NO_NOTE zw. tblBeobZuordnung (Text) und tblBeobInfospezies (Zahl) nicht verbunden werden kann*/
CREATE OR REPLACE VIEW vBeobZuordnungInfospeziesArtAnzMut AS
SELECT alexande_beob.ArtenDb_Arteigenschaften.Artname AS Art, alexande_apflora.tblBeobZuordnung.BeobMutWer, alexande_apflora.tblBeobZuordnung.BeobMutWann, Count(alexande_apflora.tblBeobZuordnung.NO_NOTE) AS AnzMut, "tblBeobZuordnung_Infospezies" AS Tabelle
FROM ((alexande_apflora.tblAp INNER JOIN alexande_beob.ArtenDb_Arteigenschaften ON alexande_apflora.tblAp.ApArtId = alexande_beob.ArtenDb_Arteigenschaften.TaxonomieId) INNER JOIN alexande_beob.tblBeobInfospezies ON alexande_apflora.tblAp.ApArtId = alexande_beob.tblBeobInfospezies.NO_ISFS) INNER JOIN alexande_apflora.tblBeobZuordnung ON alexande_beob.tblBeobInfospezies.NO_NOTE = alexande_apflora.tblBeobZuordnung.NO_NOTE
GROUP BY alexande_beob.ArtenDb_Arteigenschaften.Artname, alexande_apflora.tblBeobZuordnung.BeobMutWer, alexande_apflora.tblBeobZuordnung.BeobMutWann;

CREATE OR REPLACE VIEW vDatenstruktur AS
SELECT TABLES.TABLE_NAME AS "Tabelle: Name", TABLES.TABLE_ROWS AS "Tabelle: Anzahl Datensätze", TABLES.TABLE_COMMENT AS "Tabelle: Bemerkungen", COLUMNS.COLUMN_NAME AS "Feld: Name",  COLUMNS.COLUMN_TYPE AS "Feld: Datentyp", COLUMNS.IS_NULLABLE AS "Feld: Nullwerte", COLUMNS.COLUMN_COMMENT AS "Feld: Bemerkungen" FROM information_schema.COLUMNS INNER JOIN information_schema.TABLES ON information_schema.TABLES.TABLE_NAME = information_schema.COLUMNS.TABLE_NAME WHERE information_schema.COLUMNS.TABLE_NAME IN (SELECT TABLE_NAME FROM information_schema.TABLES WHERE TABLE_SCHEMA='alexande_apflora');